diff -Nur cctools-877.5/Makefile cctools-877.5-AnV/Makefile
--- cctools-877.5/Makefile	2015-09-15 01:35:14 +0000
+++ cctools-877.5-AnV/Makefile	2015-11-19 09:03:05 +0000
@@ -15,6 +15,8 @@
 OLD_LIBKLD = NO
 BUILD_DYLIBS = YES
 LTO = -DLTO_SUPPORT
+# apply otool-ng patches
+OTOOL_NG = -DOTOOL_NG_SUPPORT
 
 
 ifeq "macos" "$(RC_OS)"
@@ -27,6 +29,7 @@
 else
   TRIE =
 endif
+TRIE =
 
 ifneq "" "$(wildcard /bin/mkdirs)"
   MKDIRS = /bin/mkdirs
@@ -47,7 +50,7 @@
 			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
 			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
 			EFITOOLS="$(EFITOOLS)" 				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
+			TRIE="$(TRIE)" LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)" DSTROOT=$$DSTROOT	\
 			SRCROOT=$(SRCROOT)/$$i				\
 			OBJROOT=$(OBJROOT)/$$i				\
 			SYMROOT=$(SYMROOT)/$$i $@) || exit 1 ;		\
@@ -67,7 +70,7 @@
 			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
 			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
 			EFITOOLS="$(EFITOOLS)" 				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
+			TRIE="$(TRIE)" LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)" DSTROOT=$$DSTROOT	\
 			SRCROOT=$(SRCROOT)/$$i				\
 			OBJROOT=$(OBJROOT)/$$i				\
 			SYMROOT=$(SYMROOT)/$$i $@) || exit 1 ;		\
@@ -81,7 +84,7 @@
 		    (cd $$i; $(MAKE) RC_CFLAGS="$(RC_CFLAGS) $(HIDE)"	\
 			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
 			EFITOOLS="$(EFITOOLS)" 				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT 	\
+			TRIE="$(TRIE)" LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)" DSTROOT=$$DSTROOT 	\
 			$@) || exit 1 ; 				\
 	      done;							\
 	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
@@ -98,7 +101,7 @@
 		    (cd $$i; $(MAKE) RC_CFLAGS="$$SED_RC_CFLAGS"	\
 			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
 			EFITOOLS="$(EFITOOLS)"				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
+			TRIE="$(TRIE)" LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)" DSTROOT=$$DSTROOT	\
 			$@) || exit 1 ; 				\
 	        done;							\
 	    fi								\
@@ -128,7 +131,7 @@
 		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
 		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
 		EFITOOLS="$(EFITOOLS)" TRIE="$(TRIE)"			\
-		LTO="$(LTO)" DSTROOT=$$DSTROOT/$(INSTALL_LOCATION)	\
+		LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)" DSTROOT=$$DSTROOT/$(INSTALL_LOCATION)	\
 		SRCROOT=$(SRCROOT)					\
 		OBJROOT=$(OBJROOT)					\
 		SYMROOT=$(SYMROOT) $$target;				\
@@ -140,7 +143,7 @@
 		SUBDIRS_32="$(SUBDIRS_32)"				\
 		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
 		EFITOOLS="$(EFITOOLS)" TRIE="$(TRIE)"			\
-		LTO="$(LTO)" DSTROOT=$$DSTROOT install_tools 		\
+		LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)" DSTROOT=$$DSTROOT install_tools 		\
 		lib_ofiles_install;					\
 	fi
 
@@ -155,7 +158,7 @@
 			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
 			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
 			EFITOOLS="$(EFITOOLS)" 				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
+			TRIE="$(TRIE)" LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)" DSTROOT=$$DSTROOT	\
 			SRCROOT=$(SRCROOT)/$$i				\
 			OBJROOT=$(OBJROOT)/$$i				\
 			SYMROOT=$(SYMROOT)/$$i install) || exit 1;	\
@@ -175,7 +178,7 @@
 			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
 			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
 			EFITOOLS="$(EFITOOLS)"				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
+			TRIE="$(TRIE)" LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)" DSTROOT=$$DSTROOT	\
 			SRCROOT=$(SRCROOT)/$$i				\
 			OBJROOT=$(OBJROOT)/$$i				\
 			SYMROOT=$(SYMROOT)/$$i install) || exit 1;	\
@@ -190,7 +193,7 @@
 			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
 			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
 			EFITOOLS="$(EFITOOLS)"				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT 	\
+			TRIE="$(TRIE)" LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)" DSTROOT=$$DSTROOT 	\
 			install) || exit 1;				\
 	      done;							\
 	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
@@ -208,7 +211,7 @@
 			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
 			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
 			EFITOOLS="$(EFITOOLS)"				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT 	\
+			TRIE="$(TRIE)" LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)" DSTROOT=$$DSTROOT 	\
 			install) || exit 1;				\
 	        done;							\
 	    fi								\
@@ -224,7 +227,7 @@
 		OBJROOT=$(OBJROOT)					\
 		SYMROOT=$(SYMROOT)					\
 		EFITOOLS="$(EFITOOLS)" TRIE="$(TRIE)"			\
-		LTO="$(LTO)" lib_ofiles_install
+		LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)" lib_ofiles_install
 
 lib_ofiles lib_ofiles_install: installhdrs
 	@if [ $(SRCROOT) ];						\
@@ -272,7 +275,7 @@
 	    echo =========== $(MAKE) $@ for misc =============;		\
 	    (cd misc; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS) $(HIDE)"		\
 		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		TRIE="$(TRIE)" LTO="$(LTO)"				\
+		TRIE="$(TRIE)" LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)"				\
 		DSTROOT=$$DSTROOT					\
 		SRCROOT=$(SRCROOT)/misc					\
 		OBJROOT=$(OBJROOT)/misc					\
@@ -314,7 +317,7 @@
 	    echo =========== $(MAKE) $@ for misc =============;		\
 	    (cd misc; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS) $(HIDE)"		\
 		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		TRIE="$(TRIE)" LTO="$(LTO)"				\
+		TRIE="$(TRIE)" LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)"				\
 		DSTROOT=$$DSTROOT $@) || exit 1;			\
 	    (cd cbtlibs; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS) $(HIDE)"	\
 		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
@@ -332,7 +335,7 @@
 		OBJROOT=$(OBJROOT)					\
 		SYMROOT=$(SYMROOT)					\
 		EFITOOLS="$(EFITOOLS)" TRIE="$(TRIE)"			\
-		LTO="$(LTO)" install
+		LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)" install
 
 install_os_tools: installhdrs
 	@if [ $(SRCROOT) ];						\
@@ -349,7 +352,7 @@
 	    echo =========== $(MAKE) $@ for misc =============;	\
 	    (cd misc; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS) $(HIDE)"		\
 		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		TRIE="$(TRIE)" LTO="$(LTO)"				\
+		TRIE="$(TRIE)" LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)"				\
 		DSTROOT=$$DSTROOT					\
 		SRCROOT=$(SRCROOT)/misc					\
 		OBJROOT=$(OBJROOT)/misc					\
@@ -370,7 +373,7 @@
 	    echo =========== $(MAKE) $@ for misc =============;		\
 	    (cd misc; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS) $(HIDE)"		\
 		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		TRIE="$(TRIE)" LTO="$(LTO)"				\
+		TRIE="$(TRIE)" LTO="$(LTO)" OTOOL_NG="$(OTOOL_NG)"				\
 		DSTROOT=$$DSTROOT $@) || exit 1;			\
 	    echo =========== $(MAKE) $@ for man =============;		\
 	    (cd man; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS) $(HIDE)"		\
diff -Nur cctools-877.5/ar/Makefile cctools-877.5-AnV/ar/Makefile
--- cctools-877.5/ar/Makefile	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ar/Makefile	2015-11-19 09:03:05 +0000
@@ -1,13 +1,14 @@
 ifneq "" "$(SDKROOT)"
   SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
   DSYMUTIL = $(shell xcrun -find -sdk ${SDKROOT} dsymutil)
 else
   DSYMUTIL = dsymutil
 endif
 
-OFLAG = -Os
-CFLAGS = -g $(OFLAG) -Wall -I$(SRCROOT)/../include $(SDK)
+CC = clang
+
+OFLAG = -Ofast
+CFLAGS = -arch i386 -arch x86_64 -g0 $(OFLAG) -Wall -I$(SRCROOT)/../include $(SDK)
 LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
 MKDIRS = /bin/mkdir -p
 SRCROOT = .
diff -Nur cctools-877.5/as/Makefile cctools-877.5-AnV/as/Makefile
--- cctools-877.5/as/Makefile	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/as/Makefile	2015-11-19 09:03:05 +0000
@@ -2,14 +2,15 @@
 
 ifneq "" "$(SDKROOT)"
   SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
   DSYMUTIL = $(shell xcrun -find -sdk ${SDKROOT} dsymutil)
 else
   DSYMUTIL = dsymutil
 endif
 
-OFLAG = -Os
-CFLAGS = $(OFLAG) -g -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) \
+CC = clang
+
+OFLAG = -Ofast
+CFLAGS = -arch i386 -arch x86_64 $(OFLAG) -g0 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) \
 	-Wall -DNeXT_MOD $(SDK)
 LIBSTUFF_DIR = -L$(SYMROOT)/../../libstuff
 LIBSTUFF = -lstuff
diff -Nur cctools-877.5/cbtlibs/Makefile cctools-877.5-AnV/cbtlibs/Makefile
--- cctools-877.5/cbtlibs/Makefile	2013-12-10 19:28:11 +0000
+++ cctools-877.5-AnV/cbtlibs/Makefile	2015-11-19 09:03:05 +0000
@@ -1,5 +1,6 @@
+CC=clang
 RC_OS = macos
-OFLAG = -Os
+OFLAG = -Ofast
 ifneq "" "$(SDKROOT)"
   SDK = -isysroot $(SDKROOT)
   CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
@@ -10,7 +11,7 @@
   RANLIB = ranlib
 endif
 	
-CFLAGS = $(OFLAG) -g -I$(SRCROOT)/../include -Wall $(SDK)
+CFLAGS = -arch i386 -arch x86_64 $(OFLAG) -g0 -I$(SRCROOT)/../include -Wall $(SDK)
 MKDIRS = /bin/mkdir -p
 SRCROOT = .
 SYMROOT = .
diff -Nur cctools-877.5/efitools/Makefile cctools-877.5-AnV/efitools/Makefile
--- cctools-877.5/efitools/Makefile	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/efitools/Makefile	2015-11-19 09:03:05 +0000
@@ -1,3 +1,4 @@
+CC=clang
 export USE_APPLE_PB_SUPPORT = all
 RC_OS = macos
 ifneq "" "$(SDKROOT)"
@@ -8,8 +9,8 @@
   DSYMUTIL = dsymutil
 endif
 
-OFLAG = -Os
-CFLAGS = $(OFLAG) -g -Wall \
+OFLAG = -Ofast
+CFLAGS = -arch i386 -arch x86_64 $(OFLAG) -g0 -Wall \
 	 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
 LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
 MKDIRS = /bin/mkdir -p
diff -Nur cctools-877.5/efitools/mtoc.c cctools-877.5-AnV/efitools/mtoc.c
--- cctools-877.5/efitools/mtoc.c	2014-06-10 20:13:10 +0000
+++ cctools-877.5-AnV/efitools/mtoc.c	2015-11-19 09:03:05 +0000
@@ -46,6 +46,7 @@
 #include "coff/base_relocs.h"
 #include "mach-o/x86_64/reloc.h"
 #include "mach-o/arm64/reloc.h"
+#include "mach-o/ppc/reloc.h"
 
 /* used by error routines as the name of this program */
 char *progname = NULL;
@@ -111,6 +112,19 @@
     { "rtdrv",			IMAGE_SUBSYSTEM_EFI_RUNTIME_DRIVER },
     { "DXE_RUNTIME_DRIVER",	IMAGE_SUBSYSTEM_EFI_RUNTIME_DRIVER },
 
+    /* AnV - Extra subsystem fields */
+    { "UNKNOWN",        IMAGE_SUBSYSTEM_UNKNOWN },
+    { "NATIVE",         IMAGE_SUBSYSTEM_NATIVE },
+    { "WINDOWS",        IMAGE_SUBSYSTEM_WINDOWS_GUI },
+    { "CONSOLE",        IMAGE_SUBSYSTEM_WINDOWS_CUI },
+    { "OS2",            IMAGE_SUBSYSTEM_OS2_CUI },
+    { "POSIX",          IMAGE_SUBSYSTEM_OS2_CUI },
+    { "WINNATIVE",      IMAGE_SUBSYSTEM_NATIVE_WINDOWS },
+    { "WINDOWSCE",      IMAGE_SUBSYSTEM_WINDOWS_CE_GUI },
+    { "ROM",            IMAGE_SUBSYSTEM_EFI_ROM },
+    { "XBOX",           IMAGE_SUBSYSTEM_XBOX },
+    { "WINBOOT",        IMAGE_SUBSYSTEM_WINDOWS_BOOT_APPLICATION },
+
     { NULL, 0 }
 };
 
@@ -486,8 +500,10 @@
 	if(archs->object->mh_cputype != CPU_TYPE_I386 &&
 	   archs->object->mh_cputype != CPU_TYPE_ARM &&
 	   archs->object->mh_cputype != CPU_TYPE_ARM64 &&
+       archs->object->mh_cputype != CPU_TYPE_POWERPC &&
+       archs->object->mh_cputype != CPU_TYPE_POWERPC64 &&
 	   archs->object->mh_cputype != CPU_TYPE_X86_64)
-	    fatal("input file: %s must be an i386 or ARM architecture",
+	    fatal("input file: %s must be an i386, PowerPC or ARM architecture",
 		  archs->file_name);
 	if(archs->object->mh != NULL){
 	    if(archs->object->mh->filetype == MH_PRELOAD ||
@@ -687,6 +703,19 @@
 			    break;
 			}
 		        break;
+            case CPU_TYPE_POWERPC:
+            switch(flavor){
+            ppc_thread_state_t *cpu;
+            case PPC_THREAD_STATE:
+                cpu = (ppc_thread_state_t *)state;
+                entry = cpu->__srr0;
+                state += sizeof(ppc_thread_state_t);
+                break;
+            default:
+                state += count * sizeof(uint32_t);
+                break;
+            }
+                break;
 		    case CPU_TYPE_ARM:
 			switch(flavor){
 			arm_thread_state_t *cpu;
@@ -1012,6 +1041,21 @@
 		    count = *((uint32_t *)state);
 		    state += sizeof(uint32_t);
 		    switch(arch->object->mh_cputype){
+#ifdef PPC_THREAD_STATE64
+            case CPU_TYPE_POWERPC64:
+            switch(flavor){
+                ppc_thread_state64_t *cpu64;
+            case PPC_THREAD_STATE64:
+                cpu64 = (ppc_thread_state64_t *)state;
+                entry = cpu64->__srr0;
+                state += sizeof(ppc_thread_state64_t);
+                break;
+            default:
+                state += count * sizeof(uint32_t);
+                break;
+            }
+            break;
+#endif /* PPC_THREAD_STATE64 */
 #ifdef x86_THREAD_STATE64
 		    case CPU_TYPE_X86_64:
 			switch(flavor){
@@ -1351,14 +1395,18 @@
 	if(ofile->mh != NULL){
 	    if(ofile->mh->cputype == CPU_TYPE_I386)
 		filehdr.f_magic = IMAGE_FILE_MACHINE_I386;
-	    else
+	    else if (ofile->mh->cputype == CPU_TYPE_ARM)
 		filehdr.f_magic = IMAGE_FILE_MACHINE_ARM;
+        else
+        filehdr.f_magic = IMAGE_FILE_MACHINE_POWERPC;
 	}
 	else{
 	    if(ofile->mh64->cputype == CPU_TYPE_X86_64)
 		filehdr.f_magic = IMAGE_FILE_MACHINE_AMD64;
-	    else
+	    else if(ofile->mh64->cputype == CPU_TYPE_ARM64)
 		filehdr.f_magic = IMAGE_FILE_MACHINE_ARM64;
+        else
+        filehdr.f_magic = IMAGE_FILE_MACHINE_POWERPC;
 	}
 	filehdr.f_nscns = nscns;
 #ifdef HACK_TO_MATCH_TEST_CASE
@@ -1661,6 +1709,23 @@
 	    system_fatal("Can't close output file: %s", out);
 }
 
+static
+unsigned char
+create_ms_dos_stub_checksum(unsigned char *buffer, unsigned long len)
+{
+    unsigned char checksum = 0;
+    unsigned long donecnt = 0;
+
+    while (donecnt < len)
+    {
+        checksum += buffer[donecnt];
+
+        ++donecnt;
+    }
+
+    return (0x100 - checksum);
+}
+
 /*
  * create_ms_dos_stub() is pass a pointer to the buffer where to fill in the
  * MS-DOS stub.
@@ -1766,6 +1831,8 @@
 	p->dos_program[61] = 0x0;
 	p->dos_program[62] = 0x0;
 	p->dos_program[63] = 0x0;
+
+    p->e_csum = create_ms_dos_stub_checksum((unsigned char *)p, sizeof(struct ms_dos_stub));
 }
 
 
@@ -1782,7 +1849,9 @@
     struct symtab_command *st;
     struct nlist *syms;
     char *strs;
+#if 0
     enum bool found_undef;
+#endif
 #ifdef HACK_TO_MATCH_TEST_CASE
     uint32_t j, n_sect, bss_n_sect, common_n_sect,
 	     bss_addr, common_addr, size;
@@ -1808,6 +1877,7 @@
 	strs = object_addr + st->stroff;
 	if(swapped)
 	    swap_nlist(syms, st->nsyms, host_byte_sex);
+#if 0
 	found_undef = FALSE;
 	for(i = 0; i < st->nsyms; i++){
 	    if((syms[i].n_type & N_STAB) != 0)
@@ -1828,6 +1898,7 @@
 	if(found_undef == TRUE)
 	    fatal("undefined symbols are unsupported for conversion to a "
 		  "pecoff file");
+#endif
 
 #ifdef HACK_TO_MATCH_TEST_CASE
 	/*
@@ -2125,6 +2196,10 @@
 			gather_base_reloc_info(s[j].addr, relocs, s[j].nreloc,
 				CPU_TYPE_ARM, 2, GENERIC_RELOC_VANILLA,
 				IMAGE_REL_BASED_HIGHLOW);
+            else if(arch->object->mh_cputype == CPU_TYPE_POWERPC)
+            gather_base_reloc_info(s[j].addr, relocs, s[j].nreloc,
+                CPU_TYPE_POWERPC, 2, GENERIC_RELOC_VANILLA,
+                IMAGE_REL_BASED_HIGHLOW);
 		    if((s[j].flags & SECTION_TYPE) ==
 			S_NON_LAZY_SYMBOL_POINTERS){
 			for(addr = s[j].addr;
@@ -2143,7 +2218,7 @@
 		     * segment.
 		     */
 		    /*
-		     * But arm64 relocations are NOT relative to the first
+		     * But arm64/ppc64 relocations are NOT relative to the first
 		     * writable segment but just the first segment.
 		     */
 		    if((first_addr == 0) &&
@@ -2170,6 +2245,10 @@
 			gather_base_reloc_info(s64[j].addr, relocs,
 			    s64[j].nreloc, CPU_TYPE_ARM64, 3,
 			    ARM64_RELOC_UNSIGNED, IMAGE_REL_BASED_DIR64);
+            else if(arch->object->mh_cputype == CPU_TYPE_POWERPC64)
+            gather_base_reloc_info(s64[j].addr, relocs,
+                s64[j].nreloc, CPU_TYPE_POWERPC64, 3,
+                PPC_RELOC_VANILLA, IMAGE_REL_BASED_DIR64);
 		    if((s64[j].flags & SECTION_TYPE) ==
 			S_NON_LAZY_SYMBOL_POINTERS){
 			for(addr = s64[j].addr;
@@ -2195,6 +2274,10 @@
 		gather_base_reloc_info(first_addr, relocs, dyst->nlocrel,
 		    CPU_TYPE_ARM, 2, GENERIC_RELOC_VANILLA,
 		    IMAGE_REL_BASED_HIGHLOW);
+        else if(arch->object->mh_cputype == CPU_TYPE_POWERPC)
+        gather_base_reloc_info(first_addr, relocs, dyst->nlocrel,
+            CPU_TYPE_POWERPC, 2, GENERIC_RELOC_VANILLA,
+            IMAGE_REL_BASED_HIGHLOW);
 	    else if(arch->object->mh_cputype == CPU_TYPE_X86_64)
 		gather_base_reloc_info(first_addr, relocs, dyst->nlocrel,
 		    CPU_TYPE_X86_64, 3, X86_64_RELOC_UNSIGNED,
@@ -2203,6 +2286,10 @@
 		gather_base_reloc_info(first_addr, relocs, dyst->nlocrel,
 		    CPU_TYPE_ARM64, 3, ARM64_RELOC_UNSIGNED,
 		    IMAGE_REL_BASED_DIR64);
+        else if(arch->object->mh_cputype == CPU_TYPE_POWERPC64)
+        gather_base_reloc_info(first_addr, relocs, dyst->nlocrel,
+            CPU_TYPE_POWERPC64, 3, GENERIC_RELOC_VANILLA,
+            IMAGE_REL_BASED_DIR64);
 	}
 	/*
 	if(dyst != NULL && dyst->nextrel != 0)
diff -Nur cctools-877.5/efitools/symstosafe cctools-877.5-AnV/efitools/symstosafe
--- cctools-877.5/efitools/symstosafe	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/efitools/symstosafe	2015-11-19 09:03:05 +0000
@@ -0,0 +1,85 @@
+?AppleAcpiVariableGuid@@3UEFI_GUID@@A
+?AppleDeviceControlProtocolGuid@@3UEFI_GUID@@A
+?AppleDevicePropertyProtocolGuid@@3UEFI_GUID@@A
+?AppleDiskIoProtocolGuid@@3UEFI_GUID@@A
+?AppleFirmwarePasswordProtocolGuid@@3UEFI_GUID@@A
+?AppleFirmwareVariableGuid@@3UEFI_GUID@@A
+?AppleGraphConfigProtocolGuid@@3UEFI_GUID@@A
+?AppleGraphInfoProtocolGuid@@3UEFI_GUID@@A
+?AppleImageCodecProtocolGuid@@3UEFI_GUID@@A
+?AppleKeyStateProtocolGuid@@3UEFI_GUID@@A
+?AppleNVRAMVariableGuid@@3UEFI_GUID@@A
+?AppleNetBootProtocolGuid@@3UEFI_GUID@@A
+?ApplePasswordUIEfiFileNameGuid@@3UEFI_GUID@@A
+?AppleRamDmgDevicePathGuid@@3UEFI_GUID@@A
+?AppleSMCProtocolGuid@@3UEFI_GUID@@A
+?AppleSystemInfoProducerNameGuid@@3UEFI_GUID@@A
+?ArchThunk64BufferEnd@@3PAEA
+?ArchThunk64BufferStart@@3PAEA
+?Bd1394ReceivePacket@@YAIIPAU_STRING@@0PAI@Z
+?Bd1394SendPacket@@YAXIPAU_STRING@@0@Z
+?BdArchBlockDebuggerOperation@@3EA
+?BdBreakpointInstruction@@3EA
+?BdBreakpointTable@@3PAU_BREAKPOINT_ENTRY@@A
+?BdConnectionActive@@3EA
+?BdControlCPending@@3EA
+?BdControlCPressed@@3EA
+?BdDebugMessage@@3PAEA
+?BdDebugTrap@@3P6AEPAU_EXCEPTION_RECORD@@PAU_KEXCEPTION_FRAME@@PAU_KTRAP_FRAME@@@ZA
+?BdDebuggerNotPresent@@3EA
+?BdDebuggerType@@3EA
+?BdMessageBuffer@@3PAEA
+?BdModuleDataTableEntry@@3U_LDR_DATA_TABLE_ENTRY@@A
+?BdModuleList@@3U_LIST_ENTRY@@A
+?BdNextPacketIdToSend@@3IA
+?BdNumberRetries@@3IA
+?BdPacketIdExpected@@3IA
+?BdPcr@@3PAU_KPCR@@A
+?BdPcrPhysicalAddress@@3_KA
+?BdPrcb@@3PAU_KPRCB@@A
+?BdReceivePacket@@3P6AIIPAU_STRING@@0PAI@ZA
+?BdRetryCount@@3IA
+?BdSendPacket@@3P6AXIPAU_STRING@@0@ZA
+?BdSubsystemInitialized@@3EA
+?BdTrap01@@YAXXZ
+?BdTrap03@@YAXXZ
+?BdTrap0d@@YAXXZ
+?BdTrap0e@@YAXXZ
+?BdTrap2d@@YAXXZ
+?BdTrap@@YAEPAU_EXCEPTION_RECORD@@PAU_KEXCEPTION_FRAME@@PAU_KTRAP_FRAME@@@Z
+?BdUsbReceivePacket@@YAIIPAU_STRING@@0PAI@Z
+?BdUsbSendPacket@@YAXIPAU_STRING@@0@Z
+?BdUsbpGlobalData@@3PAU_DEBUG_USB_GLOBAL_DATA@@A
+?BlDecompressLZVN@@YAIPBXIPAXIPAI@Z
+?BlDetectHotKey@@YAIXZ
+?EfiAcpi20TableGuid@@3UEFI_GUID@@A
+?EfiAcpiTableGuid@@3UEFI_GUID@@A
+?EfiBlockIoProtocolGuid@@3UEFI_GUID@@A
+?EfiBootServices@@3PAUEFI_BOOT_SERVICES@@A
+?EfiConsoleControlProtocolGuid@@3UEFI_GUID@@A
+?EfiDataHubProtocolGuid@@3UEFI_GUID@@A
+?EfiDevicePathProtocolGuid@@3UEFI_GUID@@A
+?EfiDiskIoProtocolGuid@@3UEFI_GUID@@A
+?EfiFileInfoGuid@@3UEFI_GUID@@A
+?EfiFirmwareVolumeDispatchProtocolGuid@@3UEFI_GUID@@A
+?EfiFirmwareVolumeProtocolGuid@@3UEFI_GUID@@A
+?EfiGraphicsOutputProtocolGuid@@3UEFI_GUID@@A
+?EfiImageHandle@@3PAXA
+?EfiLoadFileProtocolGuid@@3UEFI_GUID@@A
+?EfiLoadedImageProtocolGuid@@3UEFI_GUID@@A
+?EfiPciIoProtocolGuid@@3UEFI_GUID@@A
+?EfiRuntimeServices@@3PAUEFI_RUNTIME_SERVICES@@A
+?EfiSimpleFileSystemProtocolGuid@@3UEFI_GUID@@A
+?EfiSimplePointerProtocolGuid@@3UEFI_GUID@@A
+?EfiSmbiosTableGuid@@3UEFI_GUID@@A
+?EfiSystemTable@@3PAU_EFI_SYSTEM_TABLE@@A
+?EfiUgaDrawProtocolGuid@@3UEFI_GUID@@A
+?FvLookupUnlockCoreVolumeKey@@YAIPAUEFI_DEVICE_PATH_PROTOCOL@@E@Z
+_t_fl
+_t_fn
+_t_il
+_t_im
+_t_in
+_t_rc
+_vsnprintf
+
diff -Nur cctools-877.5/gprof/Makefile cctools-877.5-AnV/gprof/Makefile
--- cctools-877.5/gprof/Makefile	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/gprof/Makefile	2015-11-19 09:03:05 +0000
@@ -1,3 +1,4 @@
+CC=clang
 ifneq "" "$(SDKROOT)"
   SDK = -isysroot $(SDKROOT)
   CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
@@ -6,8 +7,8 @@
   DSYMUTIL = dsymutil
 endif
 
-OFLAG = -Os
-CFLAGS = $(OFLAG) -g -I../include -Wall -DNeXT_MOD -DDEBUG $(SDK)
+OFLAG = -Ofast
+CFLAGS = -arch i386 -arch x86_64 $(OFLAG) -g0 -I../include -Wall -DNeXT_MOD -DDEBUG $(SDK)
 LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
 MKDIRS = /bin/mkdir -p
 OBJROOT = .
diff -Nur cctools-877.5/include/Availability.h cctools-877.5-AnV/include/Availability.h
--- cctools-877.5/include/Availability.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/Availability.h	2015-11-19 09:28:29 +0000
@@ -0,0 +1,216 @@
+/*
+ * Copyright (c) 2007-2014 by Apple Inc.. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+ 
+#ifndef __AVAILABILITY__
+#define __AVAILABILITY__
+ /*     
+    These macros are for use in OS header files. They enable function prototypes
+    and Objective-C methods to be tagged with the OS version in which they
+    were first available; and, if applicable, the OS version in which they 
+    became deprecated.  
+     
+    The desktop Mac OS X and iOS each have different version numbers.
+    The __OSX_AVAILABLE_STARTING() macro allows you to specify both the desktop
+    and iOS version numbers.  For instance:
+        __OSX_AVAILABLE_STARTING(__MAC_10_2,__IPHONE_2_0)
+    means the function/method was first available on Mac OS X 10.2 on the desktop
+    and first available in iOS 2.0 on the iPhone.
+    
+    If a function is available on one platform, but not the other a _NA (not
+    applicable) parameter is used.  For instance:
+            __OSX_AVAILABLE_STARTING(__MAC_10_3,__IPHONE_NA)
+    means that the function/method was first available on Mac OS X 10.3, and it
+    currently not implemented on the iPhone.
+
+    At some point, a function/method may be deprecated.  That means Apple
+    recommends applications stop using the function, either because there is a 
+    better replacement or the functionality is being phased out.  Deprecated
+    functions/methods can be tagged with a __OSX_AVAILABLE_BUT_DEPRECATED()
+    macro which specifies the OS version where the function became available
+    as well as the OS version in which it became deprecated.  For instance:
+        __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0,__MAC_10_5,__IPHONE_NA,__IPHONE_NA)
+    means that the function/method was introduced in Mac OS X 10.0, then
+    became deprecated beginning in Mac OS X 10.5.  On iOS the function 
+    has never been available.  
+    
+    For these macros to function properly, a program must specify the OS version range 
+    it is targeting.  The min OS version is specified as an option to the compiler:
+    -mmacosx-version-min=10.x when building for Mac OS X, and -miphoneos-version-min=y.z
+    when building for the iPhone.  The upper bound for the OS version is rarely needed,
+    but it can be set on the command line via: -D__MAC_OS_X_VERSION_MAX_ALLOWED=10x0 for
+    Mac OS X and __IPHONE_OS_VERSION_MAX_ALLOWED = y0z00 for iOS.  
+    
+    Examples:
+
+        A function available in Mac OS X 10.5 and later, but not on the phone:
+        
+            extern void mymacfunc() __OSX_AVAILABLE_STARTING(__MAC_10_5,__IPHONE_NA);
+
+
+        An Objective-C method in Mac OS X 10.5 and later, but not on the phone:
+        
+            @interface MyClass : NSObject
+            -(void) mymacmethod __OSX_AVAILABLE_STARTING(__MAC_10_5,__IPHONE_NA);
+            @end
+
+        
+        An enum available on the phone, but not available on Mac OS X:
+        
+            #if __IPHONE_OS_VERSION_MIN_REQUIRED
+                enum { myEnum = 1 };
+            #endif
+           Note: this works when targeting the Mac OS X platform because 
+           __IPHONE_OS_VERSION_MIN_REQUIRED is undefined which evaluates to zero. 
+        
+
+        An enum with values added in different iPhoneOS versions:
+		
+			enum {
+			    myX  = 1,	// Usable on iPhoneOS 2.1 and later
+			    myY  = 2,	// Usable on iPhoneOS 3.0 and later
+			    myZ  = 3,	// Usable on iPhoneOS 3.0 and later
+				...
+		      Note: you do not want to use #if with enumeration values
+			  when a client needs to see all values at compile time
+			  and use runtime logic to only use the viable values.
+			  
+
+    It is also possible to use the *_VERSION_MIN_REQUIRED in source code to make one
+    source base that can be compiled to target a range of OS versions.  It is best
+    to not use the _MAC_* and __IPHONE_* macros for comparisons, but rather their values.
+    That is because you might get compiled on an old OS that does not define a later
+    OS version macro, and in the C preprocessor undefined values evaluate to zero
+    in expresssions, which could cause the #if expression to evaluate in an unexpected
+    way.
+    
+        #ifdef __MAC_OS_X_VERSION_MIN_REQUIRED
+            // code only compiled when targeting Mac OS X and not iPhone
+            // note use of 1050 instead of __MAC_10_5
+            #if __MAC_OS_X_VERSION_MIN_REQUIRED < 1050
+                // code in here might run on pre-Leopard OS
+            #else
+                // code here can assume Leopard or later
+            #endif
+        #endif
+
+
+*/
+
+#define __MAC_10_0            1000
+#define __MAC_10_1            1010
+#define __MAC_10_2            1020
+#define __MAC_10_3            1030
+#define __MAC_10_4            1040
+#define __MAC_10_5            1050
+#define __MAC_10_6            1060
+#define __MAC_10_7            1070
+#define __MAC_10_8            1080
+#define __MAC_10_9            1090
+#define __MAC_10_10         101000
+/* __MAC_NA is not defined to a value but is uses as a token by macros to indicate that the API is unavailable */
+
+#define __IPHONE_2_0     20000
+#define __IPHONE_2_1     20100
+#define __IPHONE_2_2     20200
+#define __IPHONE_3_0     30000
+#define __IPHONE_3_1     30100
+#define __IPHONE_3_2     30200
+#define __IPHONE_4_0     40000
+#define __IPHONE_4_1     40100
+#define __IPHONE_4_2     40200
+#define __IPHONE_4_3     40300
+#define __IPHONE_5_0     50000
+#define __IPHONE_5_1     50100
+#define __IPHONE_6_0     60000
+#define __IPHONE_6_1     60100
+#define __IPHONE_7_0     70000
+#define __IPHONE_7_1     70100
+#define __IPHONE_8_0     80000
+/* __IPHONE_NA is not defined to a value but is uses as a token by macros to indicate that the API is unavailable */
+
+#include <AvailabilityInternal.h>
+
+#ifdef __IPHONE_OS_VERSION_MIN_REQUIRED
+    #define __OSX_AVAILABLE_STARTING(_osx, _ios) __AVAILABILITY_INTERNAL##_ios
+    #define __OSX_AVAILABLE_BUT_DEPRECATED(_osxIntro, _osxDep, _iosIntro, _iosDep) \
+                                                    __AVAILABILITY_INTERNAL##_iosIntro##_DEP##_iosDep
+    #define __OSX_AVAILABLE_BUT_DEPRECATED_MSG(_osxIntro, _osxDep, _iosIntro, _iosDep, _msg) \
+                                                    __AVAILABILITY_INTERNAL##_iosIntro##_DEP##_iosDep##_MSG(_msg)
+
+#elif defined(__MAC_OS_X_VERSION_MIN_REQUIRED)
+    #define __OSX_AVAILABLE_STARTING(_osx, _ios) __AVAILABILITY_INTERNAL##_osx
+    #define __OSX_AVAILABLE_BUT_DEPRECATED(_osxIntro, _osxDep, _iosIntro, _iosDep) \
+                                                    __AVAILABILITY_INTERNAL##_osxIntro##_DEP##_osxDep
+    #define __OSX_AVAILABLE_BUT_DEPRECATED_MSG(_osxIntro, _osxDep, _iosIntro, _iosDep, _msg) \
+                                                    __AVAILABILITY_INTERNAL##_osxIntro##_DEP##_osxDep##_MSG(_msg)
+
+#else
+    #define __OSX_AVAILABLE_STARTING(_osx, _ios)
+    #define __OSX_AVAILABLE_BUT_DEPRECATED(_osxIntro, _osxDep, _iosIntro, _iosDep)
+    #define __OSX_AVAILABLE_BUT_DEPRECATED_MSG(_osxIntro, _osxDep, _iosIntro, _iosDep, _msg)
+#endif
+
+
+#if defined(__has_feature)
+  #if __has_feature(attribute_availability_with_message)
+    #define __OS_AVAILABILITY(_target, _availability)            __attribute__((availability(_target,_availability)))
+    #define __OS_AVAILABILITY_MSG(_target, _availability, _msg)  __attribute__((availability(_target,_availability,message=_msg)))
+  #else
+    #define __OS_AVAILABILITY(_target, _availability)
+    #define __OS_AVAILABILITY_MSG(_target, _availability, _msg)
+  #endif
+#else
+    #define __OS_AVAILABILITY(_target, _availability)
+    #define __OS_AVAILABILITY_MSG(_target, _availability, _msg)
+#endif
+
+
+/* for use to document app extension usage */
+#if defined(__has_feature)
+  #if __has_feature(attribute_availability_app_extension)
+    #define __OSX_EXTENSION_UNAVAILABLE(_msg)  __OS_AVAILABILITY_MSG(macosx_app_extension,unavailable,_msg)
+    #define __IOS_EXTENSION_UNAVAILABLE(_msg)  __OS_AVAILABILITY_MSG(ios_app_extension,unavailable,_msg)
+  #else
+    #define __OSX_EXTENSION_UNAVAILABLE(_msg)
+    #define __IOS_EXTENSION_UNAVAILABLE(_msg)
+  #endif
+#else
+    #define __OSX_EXTENSION_UNAVAILABLE(_msg)
+    #define __IOS_EXTENSION_UNAVAILABLE(_msg)
+#endif
+
+#define __OS_EXTENSION_UNAVAILABLE(_msg)  __OSX_EXTENSION_UNAVAILABLE(_msg) __IOS_EXTENSION_UNAVAILABLE(_msg)
+
+#ifndef __private_extern__
+#define __private_extern__ extern
+#endif
+
+#ifndef _OFF_T_
+#define _OFF_T_
+  typedef long _off_t;
+#if !defined(NO_OLDNAMES) || defined(_POSIX)
+  typedef long off32_t;
+#endif
+#endif
+
+#endif /* __AVAILABILITY__ */
diff -Nur cctools-877.5/include/AvailabilityInternal.h cctools-877.5-AnV/include/AvailabilityInternal.h
--- cctools-877.5/include/AvailabilityInternal.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/AvailabilityInternal.h	2015-11-16 07:55:53 +0000
@@ -0,0 +1,5805 @@
+/*
+ * Copyright (c) 2007-2012 by Apple Inc.. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+/*
+    File:       AvailabilityInternal.h
+ 
+    Contains:   implementation details of __OSX_AVAILABLE_* macros from <Availability.h>
+
+*/
+#ifndef __AVAILABILITY_INTERNAL__
+#define __AVAILABILITY_INTERNAL__
+
+
+
+#ifndef __IPHONE_OS_VERSION_MIN_REQUIRED
+    #ifdef __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__
+        /* compiler sets __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ when -miphoneos-version-min is used */
+        #define __IPHONE_OS_VERSION_MIN_REQUIRED __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__
+    #endif
+#endif
+
+#define __AVAILABILITY_INTERNAL_DEPRECATED            __attribute__((deprecated))
+#ifdef __has_feature
+    #if __has_feature(attribute_deprecated_with_message)
+        #define __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)  __attribute__((deprecated(_msg)))
+    #else
+        #define __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)  __attribute__((deprecated))
+    #endif
+#elif defined(__GNUC__) && ((__GNUC__ >= 5) || ((__GNUC__ == 4) && (__GNUC_MINOR__ >= 5)))
+    #define __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)  __attribute__((deprecated(_msg)))
+#else
+    #define __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)  __attribute__((deprecated))
+#endif
+#define __AVAILABILITY_INTERNAL_UNAVAILABLE           __attribute__((unavailable))
+#define __AVAILABILITY_INTERNAL_WEAK_IMPORT           __attribute__((weak_import))
+#define __AVAILABILITY_INTERNAL_REGULAR            
+
+#ifdef __IPHONE_OS_VERSION_MIN_REQUIRED
+    /* make sure a default max version is set */
+    #ifndef __IPHONE_OS_VERSION_MAX_ALLOWED
+        #define __IPHONE_OS_VERSION_MAX_ALLOWED     __IPHONE_8_0
+    #endif
+    /* make sure a valid min is set */
+    #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_0
+        #undef __IPHONE_OS_VERSION_MIN_REQUIRED
+        #define __IPHONE_OS_VERSION_MIN_REQUIRED    __IPHONE_2_0 
+    #endif
+
+    #if defined(__has_attribute) && defined(__has_feature)
+        #if __has_attribute(availability)
+            /* use better attributes if possible */
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0                    __attribute__((availability(ios,introduced=2.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_0    __attribute__((availability(ios,introduced=2.0,deprecated=2.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=2.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=2.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_1    __attribute__((availability(ios,introduced=2.0,deprecated=2.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=2.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=2.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_2    __attribute__((availability(ios,introduced=2.0,deprecated=2.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=2.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=2.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0    __attribute__((availability(ios,introduced=2.0,deprecated=3.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=3.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=3.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1    __attribute__((availability(ios,introduced=2.0,deprecated=3.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=3.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=3.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2    __attribute__((availability(ios,introduced=2.0,deprecated=3.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=3.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=3.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0    __attribute__((availability(ios,introduced=2.0,deprecated=4.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=4.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=4.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1    __attribute__((availability(ios,introduced=2.0,deprecated=4.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=4.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=4.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2    __attribute__((availability(ios,introduced=2.0,deprecated=4.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=4.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=4.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3    __attribute__((availability(ios,introduced=2.0,deprecated=4.3)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=4.3,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=4.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0    __attribute__((availability(ios,introduced=2.0,deprecated=5.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=5.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=5.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1    __attribute__((availability(ios,introduced=2.0,deprecated=5.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=5.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=5.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=2.0,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=2.0,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=2.0,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=2.0,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=2.0,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.0,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=2.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=2.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1                    __attribute__((availability(ios,introduced=2.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_1    __attribute__((availability(ios,introduced=2.1,deprecated=2.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=2.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=2.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_2    __attribute__((availability(ios,introduced=2.1,deprecated=2.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=2.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=2.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0    __attribute__((availability(ios,introduced=2.1,deprecated=3.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=3.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=3.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1    __attribute__((availability(ios,introduced=2.1,deprecated=3.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=3.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=3.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2    __attribute__((availability(ios,introduced=2.1,deprecated=3.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=3.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=3.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0    __attribute__((availability(ios,introduced=2.1,deprecated=4.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=4.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=4.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1    __attribute__((availability(ios,introduced=2.1,deprecated=4.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=4.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=4.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2    __attribute__((availability(ios,introduced=2.1,deprecated=4.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=4.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=4.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3    __attribute__((availability(ios,introduced=2.1,deprecated=4.3)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=4.3,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=4.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0    __attribute__((availability(ios,introduced=2.1,deprecated=5.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=5.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=5.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1    __attribute__((availability(ios,introduced=2.1,deprecated=5.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=5.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=5.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=2.1,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=2.1,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=2.1,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=2.1,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=2.1,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.1,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=2.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=2.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2                    __attribute__((availability(ios,introduced=2.2)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_2_2    __attribute__((availability(ios,introduced=2.2,deprecated=2.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_2_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=2.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_2_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=2.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0    __attribute__((availability(ios,introduced=2.2,deprecated=3.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=3.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=3.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1    __attribute__((availability(ios,introduced=2.2,deprecated=3.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=3.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=3.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2    __attribute__((availability(ios,introduced=2.2,deprecated=3.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=3.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=3.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0    __attribute__((availability(ios,introduced=2.2,deprecated=4.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=4.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=4.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1    __attribute__((availability(ios,introduced=2.2,deprecated=4.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=4.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=4.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2    __attribute__((availability(ios,introduced=2.2,deprecated=4.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=4.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=4.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3    __attribute__((availability(ios,introduced=2.2,deprecated=4.3)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=4.3,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=4.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0    __attribute__((availability(ios,introduced=2.2,deprecated=5.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=5.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=5.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1    __attribute__((availability(ios,introduced=2.2,deprecated=5.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=5.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=5.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=2.2,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=2.2,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=2.2,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=2.2,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=2.2,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=2.2,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=2.2)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=2.2)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0                    __attribute__((availability(ios,introduced=3.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0    __attribute__((availability(ios,introduced=3.0,deprecated=3.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=3.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=3.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1    __attribute__((availability(ios,introduced=3.0,deprecated=3.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=3.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=3.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2    __attribute__((availability(ios,introduced=3.0,deprecated=3.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=3.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=3.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0    __attribute__((availability(ios,introduced=3.0,deprecated=4.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=4.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=4.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1    __attribute__((availability(ios,introduced=3.0,deprecated=4.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=4.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=4.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2    __attribute__((availability(ios,introduced=3.0,deprecated=4.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=4.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=4.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3    __attribute__((availability(ios,introduced=3.0,deprecated=4.3)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=4.3,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=4.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0    __attribute__((availability(ios,introduced=3.0,deprecated=5.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=5.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=5.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1    __attribute__((availability(ios,introduced=3.0,deprecated=5.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=5.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=5.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=3.0,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=3.0,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=3.0,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=3.0,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=3.0,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.0,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=3.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=3.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1                    __attribute__((availability(ios,introduced=3.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1    __attribute__((availability(ios,introduced=3.1,deprecated=3.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=3.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=3.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2    __attribute__((availability(ios,introduced=3.1,deprecated=3.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=3.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=3.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0    __attribute__((availability(ios,introduced=3.1,deprecated=4.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=4.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=4.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1    __attribute__((availability(ios,introduced=3.1,deprecated=4.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=4.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=4.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2    __attribute__((availability(ios,introduced=3.1,deprecated=4.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=4.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=4.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3    __attribute__((availability(ios,introduced=3.1,deprecated=4.3)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=4.3,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=4.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0    __attribute__((availability(ios,introduced=3.1,deprecated=5.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=5.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=5.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1    __attribute__((availability(ios,introduced=3.1,deprecated=5.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=5.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=5.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=3.1,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=3.1,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=3.1,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=3.1,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=3.1,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.1,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=3.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=3.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2                    __attribute__((availability(ios,introduced=3.2)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2    __attribute__((availability(ios,introduced=3.2,deprecated=3.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=3.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=3.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0    __attribute__((availability(ios,introduced=3.2,deprecated=4.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=4.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=4.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1    __attribute__((availability(ios,introduced=3.2,deprecated=4.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=4.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=4.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2    __attribute__((availability(ios,introduced=3.2,deprecated=4.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=4.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=4.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3    __attribute__((availability(ios,introduced=3.2,deprecated=4.3)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=4.3,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=4.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0    __attribute__((availability(ios,introduced=3.2,deprecated=5.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=5.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=5.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1    __attribute__((availability(ios,introduced=3.2,deprecated=5.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=5.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=5.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=3.2,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=3.2,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=3.2,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=3.2,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=3.2,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=3.2,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=3.2)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=3.2)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0                    __attribute__((availability(ios,introduced=4.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0    __attribute__((availability(ios,introduced=4.0,deprecated=4.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=4.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=4.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1    __attribute__((availability(ios,introduced=4.0,deprecated=4.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=4.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=4.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2    __attribute__((availability(ios,introduced=4.0,deprecated=4.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=4.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=4.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3    __attribute__((availability(ios,introduced=4.0,deprecated=4.3)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=4.3,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=4.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0    __attribute__((availability(ios,introduced=4.0,deprecated=5.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=5.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=5.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1    __attribute__((availability(ios,introduced=4.0,deprecated=5.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=5.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=5.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=4.0,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=4.0,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=4.0,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=4.0,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=4.0,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.0,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=4.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=4.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1                    __attribute__((availability(ios,introduced=4.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1    __attribute__((availability(ios,introduced=4.1,deprecated=4.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=4.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=4.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2    __attribute__((availability(ios,introduced=4.1,deprecated=4.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=4.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=4.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3    __attribute__((availability(ios,introduced=4.1,deprecated=4.3)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=4.3,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=4.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0    __attribute__((availability(ios,introduced=4.1,deprecated=5.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=5.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=5.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1    __attribute__((availability(ios,introduced=4.1,deprecated=5.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=5.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=5.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=4.1,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=4.1,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=4.1,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=4.1,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=4.1,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.1,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=4.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=4.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2                    __attribute__((availability(ios,introduced=4.2)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2    __attribute__((availability(ios,introduced=4.2,deprecated=4.2)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=4.2,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=4.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3    __attribute__((availability(ios,introduced=4.2,deprecated=4.3)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=4.3,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=4.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0    __attribute__((availability(ios,introduced=4.2,deprecated=5.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=5.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=5.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1    __attribute__((availability(ios,introduced=4.2,deprecated=5.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=5.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=5.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=4.2,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=4.2,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=4.2,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=4.2,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=4.2,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.2,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=4.2)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=4.2)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3                    __attribute__((availability(ios,introduced=4.3)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3    __attribute__((availability(ios,introduced=4.3,deprecated=4.3)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=4.3,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=4.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0    __attribute__((availability(ios,introduced=4.3,deprecated=5.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=5.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=5.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1    __attribute__((availability(ios,introduced=4.3,deprecated=5.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=5.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=5.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=4.3,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=4.3,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=4.3,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=4.3,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=4.3,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=4.3,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=4.3)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=4.3)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0                    __attribute__((availability(ios,introduced=5.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0    __attribute__((availability(ios,introduced=5.0,deprecated=5.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=5.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=5.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1    __attribute__((availability(ios,introduced=5.0,deprecated=5.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=5.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=5.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=5.0,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=5.0,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=5.0,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=5.0,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=5.0,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.0,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=5.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=5.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1                    __attribute__((availability(ios,introduced=5.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1    __attribute__((availability(ios,introduced=5.1,deprecated=5.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=5.1,deprecated=5.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __attribute__((availability(ios,introduced=5.1,deprecated=5.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=5.1,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.1,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.1,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=5.1,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=5.1,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=5.1,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=5.1,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.1,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.1,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=5.1,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=5.1,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=5.1,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=5.1,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.1,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=5.1,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=5.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=5.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0                    __attribute__((availability(ios,introduced=6.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0    __attribute__((availability(ios,introduced=6.0,deprecated=6.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=6.0,deprecated=6.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __attribute__((availability(ios,introduced=6.0,deprecated=6.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=6.0,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=6.0,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=6.0,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=6.0,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=6.0,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=6.0,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=6.0,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=6.0,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=6.0,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=6.0,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=6.0,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=6.0,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=6.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=6.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1                    __attribute__((availability(ios,introduced=6.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1    __attribute__((availability(ios,introduced=6.1,deprecated=6.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=6.1,deprecated=6.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __attribute__((availability(ios,introduced=6.1,deprecated=6.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=6.1,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=6.1,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=6.1,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=6.1,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=6.1,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=6.1,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=6.1,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=6.1,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=6.1,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=6.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=6.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0                    __attribute__((availability(ios,introduced=7.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0    __attribute__((availability(ios,introduced=7.0,deprecated=7.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=7.0,deprecated=7.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __attribute__((availability(ios,introduced=7.0,deprecated=7.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=7.0,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=7.0,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=7.0,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=7.0,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=7.0,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=7.0,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=7.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=7.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1                    __attribute__((availability(ios,introduced=7.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1    __attribute__((availability(ios,introduced=7.1,deprecated=7.1)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=7.1,deprecated=7.1,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __attribute__((availability(ios,introduced=7.1,deprecated=7.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=7.1,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=7.1,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=7.1,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=7.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=7.1)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0                    __attribute__((availability(ios,introduced=8.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0    __attribute__((availability(ios,introduced=8.0,deprecated=8.0)))
+            #if __has_feature(attribute_availability_with_message)
+                    #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=8.0,deprecated=8.0,message=_msg)))
+            #else
+                    #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __attribute__((availability(ios,introduced=8.0,deprecated=8.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_NA               __attribute__((availability(ios,introduced=8.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_NA_MSG(_msg)     __attribute__((availability(ios,introduced=8.0)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_NA                               __attribute__((availability(ios,unavailable)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_NA_DEP__IPHONE_NA                __attribute__((availability(ios,unavailable)))
+            #define __AVAILABILITY_INTERNAL__IPHONE_NA_DEP__IPHONE_NA_MSG(_msg)      __attribute__((availability(ios,unavailable)))
+        #endif
+    #endif
+
+    #ifndef __AVAILABILITY_INTERNAL__IPHONE_2_0
+        /* set up old style internal macros (up to 2.0) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_2_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_2_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_2_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_0              __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        /* set up old style internal macros (up to 2.1) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 2.2) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_2_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_2_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_2_2              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_2_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_2_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_2_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 3.0) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 3.1) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 3.2) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 4.0) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 4.1) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 4.2) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_4_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_4_2
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 4.3) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_4_3
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_4_3
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 5.0) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_5_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_5_0
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 5.1) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_5_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_5_1
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_5_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 6.0) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_6_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_6_0
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 6.1) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_6_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_6_1
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_1
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_6_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 7.0) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_7_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_7_0
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL__IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_7_0
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 7.1) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_7_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_7_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_7_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_7_1
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_7_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_7_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL__IPHONE_7_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_7_1
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_7_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up old style internal macros (up to 8.0) */
+        #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_8_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0                      __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_8_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0                      __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0                      __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_NA           __AVAILABILITY_INTERNAL__IPHONE_8_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_NA_MSG(_msg) __AVAILABILITY_INTERNAL__IPHONE_8_0
+        #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_2_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_3_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_2
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_2
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_4_3
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_4_3
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_5_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_5_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_6_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_6_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_6_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_7_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_7_0
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_7_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_7_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_7_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_7_1
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_7_1
+        #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_8_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_REGULAR
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL__IPHONE_8_0
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL__IPHONE_8_0
+        #else
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_5_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_6_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_7_1_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__IPHONE_8_0_DEP__IPHONE_8_0_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #endif
+        /* set up internal macros (n/a) */
+        #define __AVAILABILITY_INTERNAL__IPHONE_NA                               __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #define __AVAILABILITY_INTERNAL__IPHONE_NA_DEP__IPHONE_NA                __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #define __AVAILABILITY_INTERNAL__IPHONE_NA_DEP__IPHONE_NA_MSG(_msg)      __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #endif
+
+#elif defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__)
+    /* compiler for Mac OS X sets __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ */
+    #define __MAC_OS_X_VERSION_MIN_REQUIRED __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__
+    /* make sure a default max version is set */
+    #ifndef __MAC_OS_X_VERSION_MAX_ALLOWED
+        #define __MAC_OS_X_VERSION_MAX_ALLOWED __MAC_10_10
+    #endif
+
+    #if defined(__has_attribute) && defined(__has_feature)
+        #if __has_attribute(availability)
+            /* use better attributes if possible */
+            #define __AVAILABILITY_INTERNAL__MAC_10_0                  __attribute__((availability(macosx,introduced=10.0)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_0    __attribute__((availability(macosx,introduced=10.0,deprecated=10.0)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_0_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.0,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_0_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.0)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_1    __attribute__((availability(macosx,introduced=10.0,deprecated=10.1)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_1_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.1,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_1_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_2    __attribute__((availability(macosx,introduced=10.0,deprecated=10.2)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_2_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.2,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_2_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_3    __attribute__((availability(macosx,introduced=10.0,deprecated=10.3)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_3_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.3,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_3_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_4    __attribute__((availability(macosx,introduced=10.0,deprecated=10.4)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_4_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.4,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_4_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.4)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_5    __attribute__((availability(macosx,introduced=10.0,deprecated=10.5)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_5_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.5,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_5_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.5)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_6    __attribute__((availability(macosx,introduced=10.0,deprecated=10.6)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.6,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.6)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_7    __attribute__((availability(macosx,introduced=10.0,deprecated=10.7)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.7,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.7)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_8    __attribute__((availability(macosx,introduced=10.0,deprecated=10.8)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.8,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.8)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_9    __attribute__((availability(macosx,introduced=10.0,deprecated=10.9)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.9,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.9)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_10    __attribute__((availability(macosx,introduced=10.0,deprecated=10.10)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.10,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.0,deprecated=10.10)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_NA_MSG(_msg)      __attribute__((availability(macosx,introduced=10.0)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_NA                __attribute__((availability(macosx,introduced=10.0)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_1                  __attribute__((availability(macosx,introduced=10.1)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_1    __attribute__((availability(macosx,introduced=10.1,deprecated=10.1)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_1_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.1,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_1_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.1)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_2    __attribute__((availability(macosx,introduced=10.1,deprecated=10.2)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_2_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.2,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_2_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_3    __attribute__((availability(macosx,introduced=10.1,deprecated=10.3)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_3_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.3,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_3_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_4    __attribute__((availability(macosx,introduced=10.1,deprecated=10.4)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_4_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.4,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_4_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.4)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_5    __attribute__((availability(macosx,introduced=10.1,deprecated=10.5)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_5_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.5,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_5_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.5)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_6    __attribute__((availability(macosx,introduced=10.1,deprecated=10.6)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.6,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.6)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_7    __attribute__((availability(macosx,introduced=10.1,deprecated=10.7)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.7,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.7)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_8    __attribute__((availability(macosx,introduced=10.1,deprecated=10.8)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.8,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.8)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_9    __attribute__((availability(macosx,introduced=10.1,deprecated=10.9)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.9,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.9)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_10    __attribute__((availability(macosx,introduced=10.1,deprecated=10.10)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.10,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.1,deprecated=10.10)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_NA_MSG(_msg)      __attribute__((availability(macosx,introduced=10.1)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_NA                __attribute__((availability(macosx,introduced=10.1)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_2                  __attribute__((availability(macosx,introduced=10.2)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_2    __attribute__((availability(macosx,introduced=10.2,deprecated=10.2)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_2_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.2,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_2_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.2)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_3    __attribute__((availability(macosx,introduced=10.2,deprecated=10.3)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_3_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.3,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_3_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_4    __attribute__((availability(macosx,introduced=10.2,deprecated=10.4)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_4_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.4,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_4_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.4)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_5    __attribute__((availability(macosx,introduced=10.2,deprecated=10.5)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_5_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.5,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_5_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.5)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_6    __attribute__((availability(macosx,introduced=10.2,deprecated=10.6)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.6,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.6)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_7    __attribute__((availability(macosx,introduced=10.2,deprecated=10.7)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.7,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.7)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_8    __attribute__((availability(macosx,introduced=10.2,deprecated=10.8)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.8,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.8)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_9    __attribute__((availability(macosx,introduced=10.2,deprecated=10.9)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.9,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.9)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_10    __attribute__((availability(macosx,introduced=10.2,deprecated=10.10)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.10,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.2,deprecated=10.10)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_NA_MSG(_msg)      __attribute__((availability(macosx,introduced=10.2)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_NA                __attribute__((availability(macosx,introduced=10.2)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_3                  __attribute__((availability(macosx,introduced=10.3)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_3    __attribute__((availability(macosx,introduced=10.3,deprecated=10.3)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_3_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.3,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_3_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.3)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_4    __attribute__((availability(macosx,introduced=10.3,deprecated=10.4)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_4_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.4,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_4_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.4)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_5    __attribute__((availability(macosx,introduced=10.3,deprecated=10.5)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_5_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.5,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_5_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.5)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_6    __attribute__((availability(macosx,introduced=10.3,deprecated=10.6)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.6,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.6)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_7    __attribute__((availability(macosx,introduced=10.3,deprecated=10.7)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.7,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.7)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_8    __attribute__((availability(macosx,introduced=10.3,deprecated=10.8)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.8,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.8)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_9    __attribute__((availability(macosx,introduced=10.3,deprecated=10.9)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.9,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.9)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_10    __attribute__((availability(macosx,introduced=10.3,deprecated=10.10)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.10,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.3,deprecated=10.10)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_NA_MSG(_msg)      __attribute__((availability(macosx,introduced=10.3)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_NA                __attribute__((availability(macosx,introduced=10.3)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_4                  __attribute__((availability(macosx,introduced=10.4)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_4    __attribute__((availability(macosx,introduced=10.4,deprecated=10.4)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_4_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.4,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_4_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.4)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_5    __attribute__((availability(macosx,introduced=10.4,deprecated=10.5)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_5_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.5,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_5_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.5)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_6    __attribute__((availability(macosx,introduced=10.4,deprecated=10.6)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.6,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.6)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_7    __attribute__((availability(macosx,introduced=10.4,deprecated=10.7)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.7,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.7)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_8    __attribute__((availability(macosx,introduced=10.4,deprecated=10.8)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.8,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.8)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_9    __attribute__((availability(macosx,introduced=10.4,deprecated=10.9)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.9,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.9)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_10    __attribute__((availability(macosx,introduced=10.4,deprecated=10.10)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.10,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.4,deprecated=10.10)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_NA_MSG(_msg)      __attribute__((availability(macosx,introduced=10.4)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_NA                __attribute__((availability(macosx,introduced=10.4)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_5                  __attribute__((availability(macosx,introduced=10.5)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_5    __attribute__((availability(macosx,introduced=10.5,deprecated=10.5)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_5_MSG(_msg)    __attribute__((availability(macosx,introduced=10.5,deprecated=10.5,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_5_MSG(_msg)    __attribute__((availability(macosx,introduced=10.5,deprecated=10.5)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_6    __attribute__((availability(macosx,introduced=10.5,deprecated=10.6)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.5,deprecated=10.6,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.5,deprecated=10.6)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_7    __attribute__((availability(macosx,introduced=10.5,deprecated=10.7)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.5,deprecated=10.7,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.5,deprecated=10.7)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_8    __attribute__((availability(macosx,introduced=10.5,deprecated=10.8)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.5,deprecated=10.8,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.5,deprecated=10.8)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_9    __attribute__((availability(macosx,introduced=10.5,deprecated=10.9)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.5,deprecated=10.9,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.5,deprecated=10.9)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_10    __attribute__((availability(macosx,introduced=10.5,deprecated=10.10)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.5,deprecated=10.10,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.5,deprecated=10.10)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_NA_MSG(_msg)      __attribute__((availability(macosx,introduced=10.5)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_NA                __attribute__((availability(macosx,introduced=10.5)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_6                  __attribute__((availability(macosx,introduced=10.6)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_6    __attribute__((availability(macosx,introduced=10.6,deprecated=10.6)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.6,deprecated=10.6,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_6_MSG(_msg)    __attribute__((availability(macosx,introduced=10.6,deprecated=10.6)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_7    __attribute__((availability(macosx,introduced=10.6,deprecated=10.7)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.6,deprecated=10.7,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.6,deprecated=10.7)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_8    __attribute__((availability(macosx,introduced=10.6,deprecated=10.8)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.6,deprecated=10.8,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.6,deprecated=10.8)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_9    __attribute__((availability(macosx,introduced=10.6,deprecated=10.9)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.6,deprecated=10.9,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.6,deprecated=10.9)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_10    __attribute__((availability(macosx,introduced=10.6,deprecated=10.10)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.6,deprecated=10.10,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.6,deprecated=10.10)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_NA_MSG(_msg)      __attribute__((availability(macosx,introduced=10.6)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_NA                __attribute__((availability(macosx,introduced=10.6)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_7                  __attribute__((availability(macosx,introduced=10.7)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_7    __attribute__((availability(macosx,introduced=10.7,deprecated=10.7)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.7,deprecated=10.7,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_7_MSG(_msg)    __attribute__((availability(macosx,introduced=10.7,deprecated=10.7)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_8    __attribute__((availability(macosx,introduced=10.7,deprecated=10.8)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.7,deprecated=10.8,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.7,deprecated=10.8)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_9    __attribute__((availability(macosx,introduced=10.7,deprecated=10.9)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.7,deprecated=10.9,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.7,deprecated=10.9)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_10    __attribute__((availability(macosx,introduced=10.7,deprecated=10.10)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.7,deprecated=10.10,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.7,deprecated=10.10)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_NA_MSG(_msg)      __attribute__((availability(macosx,introduced=10.7)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_NA                __attribute__((availability(macosx,introduced=10.7)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_8                  __attribute__((availability(macosx,introduced=10.8)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_8    __attribute__((availability(macosx,introduced=10.8,deprecated=10.8)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.8,deprecated=10.8,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_8_MSG(_msg)    __attribute__((availability(macosx,introduced=10.8,deprecated=10.8)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_9    __attribute__((availability(macosx,introduced=10.8,deprecated=10.9)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.8,deprecated=10.9,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.8,deprecated=10.9)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_10    __attribute__((availability(macosx,introduced=10.8,deprecated=10.10)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.8,deprecated=10.10,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.8,deprecated=10.10)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_NA_MSG(_msg)      __attribute__((availability(macosx,introduced=10.8)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_NA                __attribute__((availability(macosx,introduced=10.8)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_9                  __attribute__((availability(macosx,introduced=10.9)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_9    __attribute__((availability(macosx,introduced=10.9,deprecated=10.9)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.9,deprecated=10.9,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_9_MSG(_msg)    __attribute__((availability(macosx,introduced=10.9,deprecated=10.9)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_10    __attribute__((availability(macosx,introduced=10.9,deprecated=10.10)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.9,deprecated=10.10,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.9,deprecated=10.10)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_NA_MSG(_msg)      __attribute__((availability(macosx,introduced=10.9)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_NA                __attribute__((availability(macosx,introduced=10.9)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_10                  __attribute__((availability(macosx,introduced=10.10)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_10_DEP__MAC_10_10    __attribute__((availability(macosx,introduced=10.10,deprecated=10.10)))
+            #if __has_feature(attribute_availability_with_message)
+                #define __AVAILABILITY_INTERNAL__MAC_10_10_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.10,deprecated=10.10,message=_msg)))
+            #else
+                #define __AVAILABILITY_INTERNAL__MAC_10_10_DEP__MAC_10_10_MSG(_msg)    __attribute__((availability(macosx,introduced=10.10,deprecated=10.10)))
+            #endif
+            #define __AVAILABILITY_INTERNAL__MAC_10_10_DEP__MAC_NA_MSG(_msg)      __attribute__((availability(macosx,introduced=10.10)))
+            #define __AVAILABILITY_INTERNAL__MAC_10_10_DEP__MAC_NA                __attribute__((availability(macosx,introduced=10.10)))
+            #define __AVAILABILITY_INTERNAL__MAC_NA                        __attribute__((availability(macosx,unavailable)))
+            #define __AVAILABILITY_INTERNAL__MAC_NA_DEP__MAC_NA            __attribute__((availability(macosx,unavailable)))
+            #define __AVAILABILITY_INTERNAL__MAC_NA_DEP__MAC_NA_MSG(_msg)  __attribute__((availability(macosx,unavailable)))
+        #endif
+    #endif
+
+    #ifndef __AVAILABILITY_INTERNAL__MAC_10_0
+        /* use old style attributes */
+        #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_10
+            #define __AVAILABILITY_INTERNAL__MAC_10_10        __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_10
+            #define __AVAILABILITY_INTERNAL__MAC_10_10        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_10        __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_9
+            #define __AVAILABILITY_INTERNAL__MAC_10_9        __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_9
+            #define __AVAILABILITY_INTERNAL__MAC_10_9        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_9        __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_8
+            #define __AVAILABILITY_INTERNAL__MAC_10_8        __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_8
+            #define __AVAILABILITY_INTERNAL__MAC_10_8        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_8        __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_7
+            #define __AVAILABILITY_INTERNAL__MAC_10_7        __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_7
+            #define __AVAILABILITY_INTERNAL__MAC_10_7        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_7        __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_6
+            #define __AVAILABILITY_INTERNAL__MAC_10_6        __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_6
+            #define __AVAILABILITY_INTERNAL__MAC_10_6        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_6        __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_5        __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_5        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_5        __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_4        __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_4        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_4        __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_3        __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_3        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_3        __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_2        __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_2        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_2        __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_1        __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_1        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_1        __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_0        __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_0        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_0        __AVAILABILITY_INTERNAL_REGULAR
+        #endif
+        #define __AVAILABILITY_INTERNAL__MAC_NA             __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_1              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_1_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_1              __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_1_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_1              __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_1_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_1
+        #endif
+        #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_2              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_2_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_2              __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_2_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_2              __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_2_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_2              __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_2_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_2
+        #endif
+        #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_3              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_3_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_3              __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_3_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_3              __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_3_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_3              __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_3_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_3              __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_3_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_3
+        #endif
+        #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_4              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_4_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_4              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_4_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_4              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_4_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_4              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_4_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_4              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_4_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_4              __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_4_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_4              __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_4_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_4              __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_4_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_4              __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_4_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_4              __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_4_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_4
+        #endif
+        #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_5              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_5_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_5              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_5_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_5              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_5_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_5              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_5_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_5              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_5_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_5              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_5_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_5              __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_5_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_5              __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_5_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_5              __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_5_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_5              __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_5_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_5              __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_5_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_5              __AVAILABILITY_INTERNAL__MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_5_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_5
+        #endif
+        #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_6
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_6              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_6              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_6              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_6              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_6              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_6              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_6              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_6              __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_6              __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_6              __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_6              __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_6              __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_6              __AVAILABILITY_INTERNAL__MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_6              __AVAILABILITY_INTERNAL__MAC_10_6
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_6_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_6
+        #endif
+        #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_7
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_7              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_7              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_7              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_7              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_7              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_7              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_7              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_7              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_7              __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_7              __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_7              __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_7              __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_7              __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_7              __AVAILABILITY_INTERNAL__MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_7              __AVAILABILITY_INTERNAL__MAC_10_6
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_6
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_7              __AVAILABILITY_INTERNAL__MAC_10_7
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_7_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_7
+        #endif
+        #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_8
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_8              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_8              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_8              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_8              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_8              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_8              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_8              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_8              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_8              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_8              __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_8              __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_8              __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_8              __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_8              __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_8              __AVAILABILITY_INTERNAL__MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_8              __AVAILABILITY_INTERNAL__MAC_10_6
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_6
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_8              __AVAILABILITY_INTERNAL__MAC_10_7
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_7
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_8              __AVAILABILITY_INTERNAL__MAC_10_8
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_8_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_8
+        #endif
+        #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_9
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_9              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_9              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_9              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_9              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_9              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_9              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_9              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_9              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_9              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_9              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_9              __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_9              __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_9              __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_9              __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_9              __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_9              __AVAILABILITY_INTERNAL__MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_9              __AVAILABILITY_INTERNAL__MAC_10_6
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_6
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_9              __AVAILABILITY_INTERNAL__MAC_10_7
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_7
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_9              __AVAILABILITY_INTERNAL__MAC_10_8
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_8
+            #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_9              __AVAILABILITY_INTERNAL__MAC_10_9
+            #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_9_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_9
+        #endif
+        #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_10
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_10              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_10              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_10              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_10              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_10              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_10              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_10              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_10              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_10              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_10              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+            #define __AVAILABILITY_INTERNAL__MAC_10_10_DEP__MAC_10_10              __AVAILABILITY_INTERNAL_DEPRECATED
+            #define __AVAILABILITY_INTERNAL__MAC_10_10_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL_DEPRECATED_MSG(_msg)
+        #else
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_10              __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_0
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_10              __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_1
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_10              __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_2
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_10              __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_3
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_10              __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_4
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_10              __AVAILABILITY_INTERNAL__MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_5
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_10              __AVAILABILITY_INTERNAL__MAC_10_6
+            #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_6
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_10              __AVAILABILITY_INTERNAL__MAC_10_7
+            #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_7
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_10              __AVAILABILITY_INTERNAL__MAC_10_8
+            #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_8
+            #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_10              __AVAILABILITY_INTERNAL__MAC_10_9
+            #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_9
+            #define __AVAILABILITY_INTERNAL__MAC_10_10_DEP__MAC_10_10              __AVAILABILITY_INTERNAL__MAC_10_10
+            #define __AVAILABILITY_INTERNAL__MAC_10_10_DEP__MAC_10_10_MSG(_msg)    __AVAILABILITY_INTERNAL__MAC_10_10
+        #endif
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_0
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_NA_MSG(_msg)   __AVAILABILITY_INTERNAL__MAC_10_0
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_1
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_NA_MSG(_msg)   __AVAILABILITY_INTERNAL__MAC_10_1
+        #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_2
+        #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_NA_MSG(_msg)   __AVAILABILITY_INTERNAL__MAC_10_2
+        #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_3
+        #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_NA_MSG(_msg)   __AVAILABILITY_INTERNAL__MAC_10_3
+        #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_4
+        #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_NA_MSG(_msg)   __AVAILABILITY_INTERNAL__MAC_10_4
+        #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_5
+        #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_NA_MSG(_msg)   __AVAILABILITY_INTERNAL__MAC_10_5
+        #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_6
+        #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_NA_MSG(_msg)   __AVAILABILITY_INTERNAL__MAC_10_6
+        #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_7
+        #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_NA_MSG(_msg)   __AVAILABILITY_INTERNAL__MAC_10_7
+        #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_8
+        #define __AVAILABILITY_INTERNAL__MAC_10_8_DEP__MAC_NA_MSG(_msg)   __AVAILABILITY_INTERNAL__MAC_10_8
+        #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_9
+        #define __AVAILABILITY_INTERNAL__MAC_10_9_DEP__MAC_NA_MSG(_msg)   __AVAILABILITY_INTERNAL__MAC_10_9
+        #define __AVAILABILITY_INTERNAL__MAC_10_10_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_10
+        #define __AVAILABILITY_INTERNAL__MAC_10_10_DEP__MAC_NA_MSG(_msg)   __AVAILABILITY_INTERNAL__MAC_10_10
+        #define __AVAILABILITY_INTERNAL__MAC_NA_DEP__MAC_NA               __AVAILABILITY_INTERNAL_UNAVAILABLE
+        #define __AVAILABILITY_INTERNAL__MAC_NA_DEP__MAC_NA_MSG(_msg)     __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #endif
+#endif
+
+#endif /* __AVAILABILITY_INTERNAL__ */
diff -Nur cctools-877.5/include/AvailabilityMacros.h cctools-877.5-AnV/include/AvailabilityMacros.h
--- cctools-877.5/include/AvailabilityMacros.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/AvailabilityMacros.h	2015-11-16 07:55:53 +0000
@@ -0,0 +1,1429 @@
+/*
+ * Copyright (c) 2001-2010 by Apple Inc.. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+/*
+     File:       AvailabilityMacros.h
+ 
+     More Info:  See TechNote 2064
+
+     Contains:   Autoconfiguration of AVAILABLE_ macros for Mac OS X
+
+                 This header enables a developer to specify build time
+                 constraints on what Mac OS X versions the resulting
+                 application will be run.  There are two bounds a developer
+                 can specify:
+                 
+                      MAC_OS_X_VERSION_MIN_REQUIRED
+                      MAC_OS_X_VERSION_MAX_ALLOWED
+                      
+                The lower bound controls which calls to OS functions will 
+                be weak-importing (allowed to be unresolved at launch time).
+                The upper bound controls which OS functionality, if used,
+                will result in a compiler error because that functionality is
+                not available on on any OS is the specifed range.
+                
+                For example, suppose an application is compiled with:
+                
+                      MAC_OS_X_VERSION_MIN_REQUIRED = MAC_OS_X_VERSION_10_2
+                      MAC_OS_X_VERSION_MAX_ALLOWED  = MAC_OS_X_VERSION_10_3
+                     
+                and an OS header contains:
+                
+                     extern void funcA(void) AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER;
+                     extern void funcB(void) AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2;
+                     extern void funcC(void) AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3;
+                     extern void funcD(void) AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER;
+                     extern void funcE(void) AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER;
+                     extern void funcF(void) AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER;
+                     extern void funcG(void) AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER;
+                     
+                     typedef long TypeA DEPRECATED_IN_MAC_OS_X_VERSION_10_0_AND_LATER;
+                     typedef long TypeB DEPRECATED_IN_MAC_OS_X_VERSION_10_1_AND_LATER;
+                     typedef long TypeC DEPRECATED_IN_MAC_OS_X_VERSION_10_2_AND_LATER;
+                     typedef long TypeD DEPRECATED_IN_MAC_OS_X_VERSION_10_3_AND_LATER;
+                     typedef long TypeE DEPRECATED_IN_MAC_OS_X_VERSION_10_4_AND_LATER;
+
+                Any application code which uses these declarations will get the following:
+                
+                                compile         link          run 
+                                -------         ------        -------
+                     funcA:     normal          normal        normal
+                     funcB:     warning         normal        normal
+                     funcC:     normal          normal        normal
+                     funcD:     normal          normal        normal
+                     funcE:     normal          normal        normal
+                     funcF:     normal          weak          on 10.3 normal, on 10.2 (&funcF == NULL)
+                     funcG:     error           error         n/a
+                     typeA:     warning
+                     typeB:     warning
+                     typeC:     warning
+                     typeD:     normal
+                     typeE:     normal
+                  
+  
+*/
+#ifndef __AVAILABILITYMACROS__
+#define __AVAILABILITYMACROS__
+
+
+/*
+ * Set up standard Mac OS X versions
+ */
+#define MAC_OS_X_VERSION_10_0         1000
+#define MAC_OS_X_VERSION_10_1         1010
+#define MAC_OS_X_VERSION_10_2         1020
+#define MAC_OS_X_VERSION_10_3         1030
+#define MAC_OS_X_VERSION_10_4         1040
+#define MAC_OS_X_VERSION_10_5         1050
+#define MAC_OS_X_VERSION_10_6         1060
+#define MAC_OS_X_VERSION_10_7         1070
+#define MAC_OS_X_VERSION_10_8         1080
+#define MAC_OS_X_VERSION_10_9         1090
+#define MAC_OS_X_VERSION_10_10      101000
+
+/* 
+ * If min OS not specified, assume 10.4 for intel
+ * Note: compiler driver may set _ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED_ based on MACOSX_DEPLOYMENT_TARGET environment variable
+ */
+#ifndef MAC_OS_X_VERSION_MIN_REQUIRED
+    #ifdef __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__
+        #if (__i386__ || __x86_64__) && (__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ < MAC_OS_X_VERSION_10_4)
+            #warning Building for Intel with Mac OS X Deployment Target < 10.4 is invalid.
+        #endif
+        #define MAC_OS_X_VERSION_MIN_REQUIRED __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__
+    #else
+        #if __i386__ || __x86_64__
+            #define MAC_OS_X_VERSION_MIN_REQUIRED MAC_OS_X_VERSION_10_4
+        #elif __arm__ || __arm64__
+            #define MAC_OS_X_VERSION_MIN_REQUIRED MAC_OS_X_VERSION_10_5
+        #else
+            #define MAC_OS_X_VERSION_MIN_REQUIRED MAC_OS_X_VERSION_10_1
+        #endif
+     #endif
+#endif
+
+/*
+ * if max OS not specified, assume larger of (10.10, min)
+ */
+#ifndef MAC_OS_X_VERSION_MAX_ALLOWED
+    #if MAC_OS_X_VERSION_MIN_REQUIRED > MAC_OS_X_VERSION_10_10
+        #define MAC_OS_X_VERSION_MAX_ALLOWED MAC_OS_X_VERSION_MIN_REQUIRED
+    #else
+        #define MAC_OS_X_VERSION_MAX_ALLOWED MAC_OS_X_VERSION_10_10
+    #endif
+#endif
+
+/*
+ * Error on bad values
+ */
+#if MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_MIN_REQUIRED
+    #error MAC_OS_X_VERSION_MAX_ALLOWED must be >= MAC_OS_X_VERSION_MIN_REQUIRED
+#endif
+#if MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_0
+    #error MAC_OS_X_VERSION_MIN_REQUIRED must be >= MAC_OS_X_VERSION_10_0
+#endif
+
+/*
+ * only certain compilers support __attribute__((weak_import))
+ */
+#if defined(__GNUC__) && ((__GNUC__ >= 4) || ((__GNUC__ == 3) && (__GNUC_MINOR__ >= 1))) && (MAC_OS_X_VERSION_MIN_REQUIRED >= 1020)
+    #define WEAK_IMPORT_ATTRIBUTE __attribute__((weak_import))
+#elif defined(__MWERKS__) && (__MWERKS__ >= 0x3205) && (MAC_OS_X_VERSION_MIN_REQUIRED >= 1020) && !defined(__INTEL__)
+    #define WEAK_IMPORT_ATTRIBUTE __attribute__((weak_import))
+#else
+    #define WEAK_IMPORT_ATTRIBUTE
+#endif
+
+/*
+ * only certain compilers support __attribute__((deprecated))
+ */
+#if defined(__has_feature) && defined(__has_attribute)
+    #if __has_attribute(deprecated)
+        #define DEPRECATED_ATTRIBUTE        __attribute__((deprecated))
+        #if __has_feature(attribute_deprecated_with_message)
+            #define DEPRECATED_MSG_ATTRIBUTE(s) __attribute__((deprecated(s)))
+        #else
+            #define DEPRECATED_MSG_ATTRIBUTE(s) __attribute__((deprecated))
+        #endif
+    #else
+        #define DEPRECATED_ATTRIBUTE
+        #define DEPRECATED_MSG_ATTRIBUTE(s)
+    #endif
+#elif defined(__GNUC__) && ((__GNUC__ >= 4) || ((__GNUC__ == 3) && (__GNUC_MINOR__ >= 1)))
+    #define DEPRECATED_ATTRIBUTE        __attribute__((deprecated))
+    #if (__GNUC__ >= 5) || ((__GNUC__ == 4) && (__GNUC_MINOR__ >= 5))
+        #define DEPRECATED_MSG_ATTRIBUTE(s) __attribute__((deprecated(s)))
+    #else
+        #define DEPRECATED_MSG_ATTRIBUTE(s) __attribute__((deprecated))
+    #endif
+#else
+    #define DEPRECATED_ATTRIBUTE
+    #define DEPRECATED_MSG_ATTRIBUTE(s)
+#endif
+
+/*
+ * only certain compilers support __attribute__((unavailable))
+ */
+#if defined(__GNUC__) && ((__GNUC__ >= 4) || ((__GNUC__ == 3) && (__GNUC_MINOR__ >= 1)))
+    #define UNAVAILABLE_ATTRIBUTE __attribute__((unavailable))
+#else
+    #define UNAVAILABLE_ATTRIBUTE
+#endif
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+ * 
+ * Used on functions introduced in Mac OS X 10.0 
+ */
+#define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED
+ * 
+ * Used on functions introduced in Mac OS X 10.0, 
+ * and deprecated in Mac OS X 10.0
+ */
+#define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_0_AND_LATER
+ * 
+ * Used on types deprecated in Mac OS X 10.0 
+ */
+#define DEPRECATED_IN_MAC_OS_X_VERSION_10_0_AND_LATER     DEPRECATED_ATTRIBUTE
+
+#ifndef __AVAILABILITY_MACROS_USES_AVAILABILITY
+	#ifdef __has_attribute
+		#if __has_attribute(availability)
+			#include <Availability.h>
+			#define __AVAILABILITY_MACROS_USES_AVAILABILITY 1
+		#endif
+	#endif
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.1 
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER     __OSX_AVAILABLE_STARTING(__MAC_10_1, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_1
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_1
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED
+ *
+ * Used on declarations introduced in Mac OS X 10.1,
+ * and deprecated in Mac OS X 10.1
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED     __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_1, __MAC_10_1, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_1
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_1
+ *
+ * Used on declarations introduced in Mac OS X 10.0,
+ * but later deprecated in Mac OS X 10.1
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_1    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_1, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_1
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_1    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_1    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_1_AND_LATER
+ *
+ * Used on types deprecated in Mac OS X 10.1
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_1_AND_LATER    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_1, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_1
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_1_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.2 
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER     __OSX_AVAILABLE_STARTING(__MAC_10_2, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_2
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_2
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED
+ *
+ * Used on declarations introduced in Mac OS X 10.2,
+ * and deprecated in Mac OS X 10.2
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED     __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_2, __MAC_10_2, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_2
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2
+ *
+ * Used on declarations introduced in Mac OS X 10.0,
+ * but later deprecated in Mac OS X 10.2
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_2, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_2
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2
+ *
+ * Used on declarations introduced in Mac OS X 10.1,
+ * but later deprecated in Mac OS X 10.2
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_1, __MAC_10_2, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_2
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_2_AND_LATER
+ *
+ * Used on types deprecated in Mac OS X 10.2
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_2_AND_LATER    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_2, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_2
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_2_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.3 
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER     __OSX_AVAILABLE_STARTING(__MAC_10_3, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_3
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_3
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED
+ *
+ * Used on declarations introduced in Mac OS X 10.3,
+ * and deprecated in Mac OS X 10.3
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED     __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_3, __MAC_10_3, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_3
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3
+ *
+ * Used on declarations introduced in Mac OS X 10.0,
+ * but later deprecated in Mac OS X 10.3
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_3, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_3
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3
+ *
+ * Used on declarations introduced in Mac OS X 10.1,
+ * but later deprecated in Mac OS X 10.3
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_1, __MAC_10_3, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_3
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3
+ *
+ * Used on declarations introduced in Mac OS X 10.2,
+ * but later deprecated in Mac OS X 10.3
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_2, __MAC_10_3, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_3
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_3_AND_LATER
+ *
+ * Used on types deprecated in Mac OS X 10.3
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_3_AND_LATER    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_3, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_3
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_3_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.4 
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER     __OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED
+ *
+ * Used on declarations introduced in Mac OS X 10.4,
+ * and deprecated in Mac OS X 10.4
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED     __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_4, __MAC_10_4, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4
+ *
+ * Used on declarations introduced in Mac OS X 10.0,
+ * but later deprecated in Mac OS X 10.4
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_4, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4
+ *
+ * Used on declarations introduced in Mac OS X 10.1,
+ * but later deprecated in Mac OS X 10.4
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_1, __MAC_10_4, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4
+ *
+ * Used on declarations introduced in Mac OS X 10.2,
+ * but later deprecated in Mac OS X 10.4
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_2, __MAC_10_4, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4
+ *
+ * Used on declarations introduced in Mac OS X 10.3,
+ * but later deprecated in Mac OS X 10.4
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_3, __MAC_10_4, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_4_AND_LATER
+ *
+ * Used on types deprecated in Mac OS X 10.4
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_4_AND_LATER    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_4, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_4
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_4_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.5 
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER     __OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED
+ *
+ * Used on declarations introduced in Mac OS X 10.5,
+ * and deprecated in Mac OS X 10.5
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED     __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5, __MAC_10_5, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5
+ *
+ * Used on declarations introduced in Mac OS X 10.0,
+ * but later deprecated in Mac OS X 10.5
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_5, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5
+ *
+ * Used on declarations introduced in Mac OS X 10.1,
+ * but later deprecated in Mac OS X 10.5
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_1, __MAC_10_5, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5
+ *
+ * Used on declarations introduced in Mac OS X 10.2,
+ * but later deprecated in Mac OS X 10.5
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_2, __MAC_10_5, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5
+ *
+ * Used on declarations introduced in Mac OS X 10.3,
+ * but later deprecated in Mac OS X 10.5
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_3, __MAC_10_5, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5
+ *
+ * Used on declarations introduced in Mac OS X 10.4,
+ * but later deprecated in Mac OS X 10.5
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_4, __MAC_10_5, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER
+ *
+ * Used on types deprecated in Mac OS X 10.5
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_5, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER
+#endif
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.6 
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER     __OSX_AVAILABLE_STARTING(__MAC_10_6, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_6
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_6
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED
+ *
+ * Used on declarations introduced in Mac OS X 10.6,
+ * and deprecated in Mac OS X 10.6
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED     __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_6, __MAC_10_6, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_6
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6
+ *
+ * Used on declarations introduced in Mac OS X 10.0,
+ * but later deprecated in Mac OS X 10.6
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_6, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_6
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6
+ *
+ * Used on declarations introduced in Mac OS X 10.1,
+ * but later deprecated in Mac OS X 10.6
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_1, __MAC_10_6, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_6
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6
+ *
+ * Used on declarations introduced in Mac OS X 10.2,
+ * but later deprecated in Mac OS X 10.6
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_2, __MAC_10_6, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_6
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6
+ *
+ * Used on declarations introduced in Mac OS X 10.3,
+ * but later deprecated in Mac OS X 10.6
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_3, __MAC_10_6, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_6
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6
+ *
+ * Used on declarations introduced in Mac OS X 10.4,
+ * but later deprecated in Mac OS X 10.6
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_4, __MAC_10_6, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_6
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6
+ *
+ * Used on declarations introduced in Mac OS X 10.5,
+ * but later deprecated in Mac OS X 10.6
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5, __MAC_10_6, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_6
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6    AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_6_AND_LATER
+ *
+ * Used on types deprecated in Mac OS X 10.6
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_6_AND_LATER    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_6, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_6
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_6_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_6_AND_LATER
+#endif
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.7 
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER     __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_7
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_7
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED
+ *
+ * Used on declarations introduced in Mac OS X 10.7,
+ * and deprecated in Mac OS X 10.7
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED     __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_7, __MAC_10_7, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_7
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7
+ *
+ * Used on declarations introduced in Mac OS X 10.0,
+ * but later deprecated in Mac OS X 10.7
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_7, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_7
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7
+ *
+ * Used on declarations introduced in Mac OS X 10.1,
+ * but later deprecated in Mac OS X 10.7
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_1, __MAC_10_7, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_7
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7
+ *
+ * Used on declarations introduced in Mac OS X 10.2,
+ * but later deprecated in Mac OS X 10.7
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_2, __MAC_10_7, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_7
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7
+ *
+ * Used on declarations introduced in Mac OS X 10.3,
+ * but later deprecated in Mac OS X 10.7
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_3, __MAC_10_7, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_7
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7
+ *
+ * Used on declarations introduced in Mac OS X 10.4,
+ * but later deprecated in Mac OS X 10.7
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_4, __MAC_10_7, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_7
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7
+ *
+ * Used on declarations introduced in Mac OS X 10.5,
+ * but later deprecated in Mac OS X 10.7
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5, __MAC_10_7, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_7
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7
+ *
+ * Used on declarations introduced in Mac OS X 10.6,
+ * but later deprecated in Mac OS X 10.7
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_6, __MAC_10_7, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_7
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_7    AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER
+ *
+ * Used on types deprecated in Mac OS X 10.7
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_7, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_7
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER
+#endif
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.8 
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER     __OSX_AVAILABLE_STARTING(__MAC_10_8, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_8
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_8
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER_BUT_DEPRECATED
+ *
+ * Used on declarations introduced in Mac OS X 10.8,
+ * and deprecated in Mac OS X 10.8
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER_BUT_DEPRECATED     __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_8, __MAC_10_8, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_8
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8
+ *
+ * Used on declarations introduced in Mac OS X 10.0,
+ * but later deprecated in Mac OS X 10.8
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_8, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_8
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8
+ *
+ * Used on declarations introduced in Mac OS X 10.1,
+ * but later deprecated in Mac OS X 10.8
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_1, __MAC_10_8, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_8
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8
+ *
+ * Used on declarations introduced in Mac OS X 10.2,
+ * but later deprecated in Mac OS X 10.8
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_2, __MAC_10_8, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_8
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8
+ *
+ * Used on declarations introduced in Mac OS X 10.3,
+ * but later deprecated in Mac OS X 10.8
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_3, __MAC_10_8, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_8
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8
+ *
+ * Used on declarations introduced in Mac OS X 10.4,
+ * but later deprecated in Mac OS X 10.8
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_4, __MAC_10_8, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_8
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8
+ *
+ * Used on declarations introduced in Mac OS X 10.5,
+ * but later deprecated in Mac OS X 10.8
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5, __MAC_10_8, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_8
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8
+ *
+ * Used on declarations introduced in Mac OS X 10.6,
+ * but later deprecated in Mac OS X 10.8
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_6, __MAC_10_8, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_8
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8
+ *
+ * Used on declarations introduced in Mac OS X 10.7,
+ * but later deprecated in Mac OS X 10.8
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_7, __MAC_10_8, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_8
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_8    AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_8_AND_LATER
+ *
+ * Used on types deprecated in Mac OS X 10.8
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_8_AND_LATER    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_8, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_8
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_8_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_8_AND_LATER
+#endif
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.9 
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER     __OSX_AVAILABLE_STARTING(__MAC_10_9, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_9
+    #define AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_9
+    #define AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER_BUT_DEPRECATED
+ *
+ * Used on declarations introduced in Mac OS X 10.9,
+ * and deprecated in Mac OS X 10.9
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER_BUT_DEPRECATED     __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_9, __MAC_10_9, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_9
+    #define AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9
+ *
+ * Used on declarations introduced in Mac OS X 10.0,
+ * but later deprecated in Mac OS X 10.9
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_9, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_9
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9
+ *
+ * Used on declarations introduced in Mac OS X 10.1,
+ * but later deprecated in Mac OS X 10.9
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_1, __MAC_10_9, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_9
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9
+ *
+ * Used on declarations introduced in Mac OS X 10.2,
+ * but later deprecated in Mac OS X 10.9
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_2, __MAC_10_9, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_9
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9
+ *
+ * Used on declarations introduced in Mac OS X 10.3,
+ * but later deprecated in Mac OS X 10.9
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_3, __MAC_10_9, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_9
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9
+ *
+ * Used on declarations introduced in Mac OS X 10.4,
+ * but later deprecated in Mac OS X 10.9
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_4, __MAC_10_9, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_9
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9
+ *
+ * Used on declarations introduced in Mac OS X 10.5,
+ * but later deprecated in Mac OS X 10.9
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5, __MAC_10_9, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_9
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9
+ *
+ * Used on declarations introduced in Mac OS X 10.6,
+ * but later deprecated in Mac OS X 10.9
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_6, __MAC_10_9, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_9
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9
+ *
+ * Used on declarations introduced in Mac OS X 10.7,
+ * but later deprecated in Mac OS X 10.9
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_7, __MAC_10_9, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_9
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9
+ *
+ * Used on declarations introduced in Mac OS X 10.8,
+ * but later deprecated in Mac OS X 10.9
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_8, __MAC_10_9, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_9
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_9    AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_9_AND_LATER
+ *
+ * Used on types deprecated in Mac OS X 10.9
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_9_AND_LATER    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_9, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_9
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_9_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_9_AND_LATER
+#endif
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_10_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.10 
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_10_AND_LATER     __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_10_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_10_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_10_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_10_AND_LATER_BUT_DEPRECATED
+ *
+ * Used on declarations introduced in Mac OS X 10.10,
+ * and deprecated in Mac OS X 10.10
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_10_AND_LATER_BUT_DEPRECATED     __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_10, __MAC_10_10, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_10_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_10_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_10_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10
+ *
+ * Used on declarations introduced in Mac OS X 10.0,
+ * but later deprecated in Mac OS X 10.10
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_10, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10
+ *
+ * Used on declarations introduced in Mac OS X 10.1,
+ * but later deprecated in Mac OS X 10.10
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_1, __MAC_10_10, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10
+ *
+ * Used on declarations introduced in Mac OS X 10.2,
+ * but later deprecated in Mac OS X 10.10
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_2, __MAC_10_10, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10
+ *
+ * Used on declarations introduced in Mac OS X 10.3,
+ * but later deprecated in Mac OS X 10.10
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_3, __MAC_10_10, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10
+ *
+ * Used on declarations introduced in Mac OS X 10.4,
+ * but later deprecated in Mac OS X 10.10
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_4, __MAC_10_10, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10
+ *
+ * Used on declarations introduced in Mac OS X 10.5,
+ * but later deprecated in Mac OS X 10.10
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5, __MAC_10_10, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10
+ *
+ * Used on declarations introduced in Mac OS X 10.6,
+ * but later deprecated in Mac OS X 10.10
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_6, __MAC_10_10, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    AVAILABLE_MAC_OS_X_VERSION_10_6_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10
+ *
+ * Used on declarations introduced in Mac OS X 10.7,
+ * but later deprecated in Mac OS X 10.10
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_7, __MAC_10_10, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    AVAILABLE_MAC_OS_X_VERSION_10_7_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10
+ *
+ * Used on declarations introduced in Mac OS X 10.8,
+ * but later deprecated in Mac OS X 10.10
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_8, __MAC_10_10, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    AVAILABLE_MAC_OS_X_VERSION_10_8_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10
+ *
+ * Used on declarations introduced in Mac OS X 10.9,
+ * but later deprecated in Mac OS X 10.10
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_9, __MAC_10_10, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_10
+    #define AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_10    AVAILABLE_MAC_OS_X_VERSION_10_9_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_10_AND_LATER
+ *
+ * Used on types deprecated in Mac OS X 10.10
+ */
+#if __AVAILABILITY_MACROS_USES_AVAILABILITY
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_10_AND_LATER    __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_10, __IPHONE_NA, __IPHONE_NA)
+#elif MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_10
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_10_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_10_AND_LATER
+#endif
+
+
+
+
+#endif  /* __AVAILABILITYMACROS__ */
+
+
diff -Nur cctools-877.5/include/_types/_intmax_t.h cctools-877.5-AnV/include/_types/_intmax_t.h
--- cctools-877.5/include/_types/_intmax_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/_types/_intmax_t.h	2015-11-16 07:55:53 +0000
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _INTMAX_T
+#define _INTMAX_T
+#ifdef __INTMAX_TYPE__
+typedef __INTMAX_TYPE__ intmax_t;
+#else
+#ifdef __LP64__
+typedef long int intmax_t;
+#else
+typedef long long int intmax_t;
+#endif /* __LP64__ */
+#endif /* __INTMAX_TYPE__ */
+#endif /* _INTMAX_T */
diff -Nur cctools-877.5/include/_types/_nl_item.h cctools-877.5-AnV/include/_types/_nl_item.h
--- cctools-877.5/include/_types/_nl_item.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/_types/_nl_item.h	2015-11-16 07:55:53 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _NL_ITEM
+#define _NL_ITEM 
+typedef __darwin_nl_item nl_item;
+#endif /* _NL_ITEM */
\ No newline at end of file
diff -Nur cctools-877.5/include/_types/_uint16_t.h cctools-877.5-AnV/include/_types/_uint16_t.h
--- cctools-877.5/include/_types/_uint16_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/_types/_uint16_t.h	2015-11-16 07:55:53 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _UINT16_T
+#define _UINT16_T
+typedef unsigned short uint16_t;
+#endif /* _UINT16_T */
diff -Nur cctools-877.5/include/_types/_uint32_t.h cctools-877.5-AnV/include/_types/_uint32_t.h
--- cctools-877.5/include/_types/_uint32_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/_types/_uint32_t.h	2015-11-16 07:55:53 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _UINT32_T
+#define _UINT32_T
+typedef unsigned int uint32_t;
+#endif /* _UINT32_T */
diff -Nur cctools-877.5/include/_types/_uint64_t.h cctools-877.5-AnV/include/_types/_uint64_t.h
--- cctools-877.5/include/_types/_uint64_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/_types/_uint64_t.h	2015-11-16 07:55:53 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _UINT64_T
+#define _UINT64_T
+typedef unsigned long long uint64_t;
+#endif /* _UINT64_T */
diff -Nur cctools-877.5/include/_types/_uint8_t.h cctools-877.5-AnV/include/_types/_uint8_t.h
--- cctools-877.5/include/_types/_uint8_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/_types/_uint8_t.h	2015-11-16 07:55:53 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _UINT8_T
+#define _UINT8_T
+typedef unsigned char uint8_t;
+#endif /* _UINT8_T */
diff -Nur cctools-877.5/include/_types/_uintmax_t.h cctools-877.5-AnV/include/_types/_uintmax_t.h
--- cctools-877.5/include/_types/_uintmax_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/_types/_uintmax_t.h	2015-11-16 07:55:53 +0000
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _UINTMAX_T
+#define _UINTMAX_T
+#ifdef __UINTMAX_TYPE__
+typedef __UINTMAX_TYPE__ uintmax_t;
+#else
+#ifdef __LP64__
+typedef long unsigned int uintmax_t;
+#else
+typedef long long unsigned int uintmax_t;
+#endif /* __LP64__ */
+#endif /* __UINTMAX_TYPE__ */
+#endif /* _UINTMAX_T */
diff -Nur cctools-877.5/include/_types/_wctrans_t.h cctools-877.5-AnV/include/_types/_wctrans_t.h
--- cctools-877.5/include/_types/_wctrans_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/_types/_wctrans_t.h	2015-11-16 07:55:53 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _WCTRANS_T 
+#define _WCTRANS_T 
+typedef	__darwin_wctrans_t wctrans_t;
+#endif /* _WCTRANS_T */
\ No newline at end of file
diff -Nur cctools-877.5/include/_types/_wctype_t.h cctools-877.5-AnV/include/_types/_wctype_t.h
--- cctools-877.5/include/_types/_wctype_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/_types/_wctype_t.h	2015-11-16 07:55:53 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _WCTYPE_T
+#define _WCTYPE_T 
+typedef __darwin_wctype_t wctype_t;
+#endif /* _WCTYPE_T */
\ No newline at end of file
diff -Nur cctools-877.5/include/ar.h cctools-877.5-AnV/include/ar.h
--- cctools-877.5/include/ar.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/ar.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,67 @@
+/*-
+ * Copyright (c) 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * This code is derived from software contributed to Berkeley by
+ * Hugh Smith at The University of Guelph.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)ar.h	8.2 (Berkeley) 1/21/94
+ */
+
+#ifndef _AR_H_
+#define	_AR_H_
+
+/* Pre-4BSD archives had these magic numbers in them. */
+#define	OARMAG1	0177555
+#define	OARMAG2	0177545
+
+#define	ARMAG		"!<arch>\n"	/* ar "magic number" */
+#define	SARMAG		8		/* strlen(ARMAG); */
+
+#define	AR_EFMT1	"#1/"		/* extended format #1 */
+
+struct ar_hdr {
+	char ar_name[16];		/* name */
+	char ar_date[12];		/* modification time */
+	char ar_uid[6];			/* user id */
+	char ar_gid[6];			/* group id */
+	char ar_mode[8];		/* octal file permissions */
+	char ar_size[10];		/* size in bytes */
+#define	ARFMAG	"`\n"
+	char ar_fmag[2];		/* consistency check */
+};
+
+#endif /* !_AR_H_ */
diff -Nur cctools-877.5/include/architecture/alignment.h cctools-877.5-AnV/include/architecture/alignment.h
--- cctools-877.5/include/architecture/alignment.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/alignment.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,43 @@
+/*
+ * Copyright (c) 1999, 2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1996 NeXT Software, Inc.
+ *
+ * Natural alignment of shorts and longs.
+ *
+ * HISTORY
+ *
+ * 2 Sept 1992 Brian Raymor at NeXT
+ *	Moved over to architecture.
+ * 18 August 1992 Jack Greenfield at NeXT
+ *	Created.
+ */
+ 
+
+#if defined (__i386__)
+#include "architecture/i386/alignment.h"
+#else
+#error architecture not supported
+#endif
+
+
diff -Nur cctools-877.5/include/architecture/byte_order.h cctools-877.5-AnV/include/architecture/byte_order.h
--- cctools-877.5/include/architecture/byte_order.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/byte_order.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,381 @@
+/*
+ * Copyright (c) 1999-2008 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ * Byte ordering conversion.
+ *
+ */
+
+#ifndef	_ARCHITECTURE_BYTE_ORDER_H_
+#define _ARCHITECTURE_BYTE_ORDER_H_
+
+/*
+ * Please note that the byte ordering functions in this file are deprecated.
+ * A replacement API exists in libkern/OSByteOrder.h
+ */
+
+#include <libkern/OSByteOrder.h>
+
+typedef unsigned long NXSwappedFloat;
+typedef unsigned long long NXSwappedDouble;
+
+static __inline__ __attribute__((deprecated))
+unsigned short 
+NXSwapShort(
+    unsigned short inv
+)
+{
+    return (unsigned short)OSSwapInt16((uint16_t)inv);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned int
+NXSwapInt(
+    unsigned int inv
+)
+{
+    return (unsigned int)OSSwapInt32((uint32_t)inv);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned long
+NXSwapLong(
+    unsigned long inv
+)
+{
+    return (unsigned long)OSSwapInt32((uint32_t)inv);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned long long
+NXSwapLongLong(
+    unsigned long long inv
+)
+{
+    return (unsigned long long)OSSwapInt64((uint64_t)inv);
+}
+
+static __inline__ __attribute__((deprecated))
+NXSwappedFloat
+NXConvertHostFloatToSwapped(float x)
+{
+    union fconv {
+        float number;
+        NXSwappedFloat sf;
+    } u;
+    u.number = x;
+    return u.sf;
+}
+
+static __inline__ __attribute__((deprecated))
+float
+NXConvertSwappedFloatToHost(NXSwappedFloat x)
+{
+    union fconv {
+        float number;
+        NXSwappedFloat sf;
+    } u;
+    u.sf = x;
+    return u.number;
+}
+
+static __inline__ __attribute__((deprecated))
+NXSwappedDouble
+NXConvertHostDoubleToSwapped(double x)
+{
+    union dconv {
+        double number;
+        NXSwappedDouble sd;
+    } u;
+    u.number = x;
+    return u.sd;
+}
+
+static __inline__ __attribute__((deprecated))
+double
+NXConvertSwappedDoubleToHost(NXSwappedDouble x)
+{
+    union dconv {
+        double number;
+        NXSwappedDouble sd;
+    } u;
+    u.sd = x;
+    return u.number;
+}
+
+static __inline__ __attribute__((deprecated))
+NXSwappedFloat
+NXSwapFloat(NXSwappedFloat x)
+{ 
+    return (NXSwappedFloat)OSSwapInt32((uint32_t)x);  
+}
+
+static __inline__ __attribute__((deprecated))
+NXSwappedDouble   
+NXSwapDouble(NXSwappedDouble x)
+{  
+    return (NXSwappedDouble)OSSwapInt64((uint64_t)x);
+}
+
+/*
+ * Identify the byte order
+ * of the current host.
+ */
+
+enum NXByteOrder {
+    NX_UnknownByteOrder,
+    NX_LittleEndian,
+    NX_BigEndian
+};
+
+static __inline__
+enum NXByteOrder
+NXHostByteOrder(void)
+{
+#if defined(__LITTLE_ENDIAN__)
+    return NX_LittleEndian;
+#elif defined(__BIG_ENDIAN__)
+    return NX_BigEndian;
+#else
+    return NX_UnknownByteOrder;
+#endif
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned short
+NXSwapBigShortToHost(
+    unsigned short	x
+)
+{
+    return (unsigned short)OSSwapBigToHostInt16((uint16_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned int
+NXSwapBigIntToHost(
+    unsigned int	x
+)
+{
+    return (unsigned int)OSSwapBigToHostInt32((uint32_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned long
+NXSwapBigLongToHost(
+    unsigned long	x
+)
+{
+    return (unsigned long)OSSwapBigToHostInt32((uint32_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned long long
+NXSwapBigLongLongToHost(
+    unsigned long long	x
+)
+{
+    return (unsigned long long)OSSwapBigToHostInt64((uint64_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+double
+NXSwapBigDoubleToHost(
+    NXSwappedDouble	x
+)
+{
+    return NXConvertSwappedDoubleToHost((NXSwappedDouble)OSSwapBigToHostInt64((uint64_t)x));
+}
+
+static __inline__ __attribute__((deprecated))
+float
+NXSwapBigFloatToHost(
+    NXSwappedFloat	x
+)
+{
+    return NXConvertSwappedFloatToHost((NXSwappedFloat)OSSwapBigToHostInt32((uint32_t)x));
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned short
+NXSwapHostShortToBig(
+    unsigned short	x
+)
+{
+    return (unsigned short)OSSwapHostToBigInt16((uint16_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned int
+NXSwapHostIntToBig(
+    unsigned int	x
+)
+{
+    return (unsigned int)OSSwapHostToBigInt32((uint32_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned long
+NXSwapHostLongToBig(
+    unsigned long	x
+)
+{
+    return (unsigned long)OSSwapHostToBigInt32((uint32_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned long long
+NXSwapHostLongLongToBig(
+    unsigned long long	x
+)
+{
+    return (unsigned long long)OSSwapHostToBigInt64((uint64_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+NXSwappedDouble
+NXSwapHostDoubleToBig(
+    double	x
+)
+{
+    return (NXSwappedDouble)OSSwapHostToBigInt64((uint64_t)NXConvertHostDoubleToSwapped(x));
+}
+
+static __inline__ __attribute__((deprecated))
+NXSwappedFloat
+NXSwapHostFloatToBig(
+    float	x
+)
+{
+    return (NXSwappedFloat)OSSwapHostToBigInt32((uint32_t)NXConvertHostFloatToSwapped(x));
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned short
+NXSwapLittleShortToHost(
+    unsigned short	x
+)
+{
+    return (unsigned short)OSSwapLittleToHostInt16((uint16_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned int
+NXSwapLittleIntToHost(
+    unsigned int	x
+)
+{
+    return (unsigned int)OSSwapLittleToHostInt32((uint32_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned long
+NXSwapLittleLongToHost(
+    unsigned long	x
+)
+{
+    return (unsigned long)OSSwapLittleToHostInt32((uint32_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned long long
+NXSwapLittleLongLongToHost(
+    unsigned long long	x
+)
+{
+    return (unsigned long long)OSSwapLittleToHostInt64((uint64_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+double
+NXSwapLittleDoubleToHost(
+    NXSwappedDouble	x
+)
+{
+    return NXConvertSwappedDoubleToHost((NXSwappedDouble)OSSwapLittleToHostInt64((uint64_t)x));
+}
+
+static __inline__ __attribute__((deprecated))
+float
+NXSwapLittleFloatToHost(
+    NXSwappedFloat	x
+)
+{
+    return NXConvertSwappedFloatToHost((NXSwappedFloat)OSSwapLittleToHostInt32((uint32_t)x));
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned short
+NXSwapHostShortToLittle(
+    unsigned short	x
+)
+{
+    return (unsigned short)OSSwapHostToLittleInt16((uint16_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned int
+NXSwapHostIntToLittle(
+    unsigned int	x
+)
+{
+    return (unsigned int)OSSwapHostToLittleInt32((uint32_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned long
+NXSwapHostLongToLittle(
+    unsigned long	x
+)
+{
+    return (unsigned long)OSSwapHostToLittleInt32((uint32_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+unsigned long long
+NXSwapHostLongLongToLittle(
+    unsigned long long	x
+)
+{
+    return (unsigned long long)OSSwapHostToLittleInt64((uint64_t)x);
+}
+
+static __inline__ __attribute__((deprecated))
+NXSwappedDouble
+NXSwapHostDoubleToLittle(
+    double	x
+)
+{
+    return (NXSwappedDouble)OSSwapHostToLittleInt64((uint64_t)NXConvertHostDoubleToSwapped(x));
+}
+
+static __inline__ __attribute__((deprecated))
+NXSwappedFloat
+NXSwapHostFloatToLittle(
+    float	x
+)
+{
+    return (NXSwappedFloat)OSSwapHostToLittleInt32((uint32_t)NXConvertHostFloatToSwapped(x));
+}
+
+#endif	/* _ARCHITECTURE_BYTE_ORDER_H_ */
diff -Nur cctools-877.5/include/architecture/i386/alignment.h cctools-877.5-AnV/include/architecture/i386/alignment.h
--- cctools-877.5/include/architecture/i386/alignment.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/i386/alignment.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,69 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ * Natural alignment of shorts and longs (for i386)
+ *
+ * HISTORY
+ *
+ * 2 Sept 1992 Brian Raymor at NeXT
+ *      Moved over to architecture.
+ * 18 August 1992 Jack Greenfield at NeXT
+ *	Created.
+ */
+
+#ifndef _ARCH_I386_ALIGNMENT_H_
+#define _ARCH_I386_ALIGNMENT_H_
+
+/*
+ * NOP
+ */
+__inline__ static unsigned short
+get_align_short(void *ivalue)
+{
+    return *((unsigned short *) ivalue);
+}
+
+__inline__ static unsigned short 
+put_align_short(unsigned short ivalue, void *ovalue)
+{
+    return *((unsigned short *) ovalue) = ivalue;
+}
+
+/*
+ * NOP
+ */
+__inline__ static unsigned long
+get_align_long(void *ivalue)
+{
+    return *((unsigned long *) ivalue);
+}
+
+__inline__ static unsigned long 
+put_align_long(unsigned long ivalue, void *ovalue)
+{
+    return *((unsigned long *) ovalue) = ivalue;
+}
+
+#endif	/* _ARCH_I386_ALIGNMENT_H_ */
diff -Nur cctools-877.5/include/architecture/i386/asm_help.h cctools-877.5-AnV/include/architecture/i386/asm_help.h
--- cctools-877.5/include/architecture/i386/asm_help.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/i386/asm_help.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,398 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1991 NeXT Computer, Inc.  All rights reserved.
+ *
+ *	File:	architecture/i386/asm_help.h
+ *	Author:	Mike DeMoney, NeXT Computer, Inc.
+ *	Modified for i386 by: Bruce Martin, NeXT Computer, Inc.
+ *
+ *	This header file defines macros useful when writing assembly code
+ *	for the Intel i386 family processors.
+ *
+ * HISTORY
+ * 10-Mar-92  Bruce Martin (bmartin@next.com)
+ *	Adapted to i386
+ * 23-Jan-91  Mike DeMoney (mike@next.com)
+ *	Created.
+ */
+
+#ifndef	_ARCH_I386_ASM_HELP_H_
+#define	_ARCH_I386_ASM_HELP_H_
+
+#include	<architecture/i386/reg_help.h>
+
+
+#ifdef	__ASSEMBLER__
+
+#define ALIGN						\
+	.align	2, 0x90
+
+#define	ROUND_TO_STACK(len)				\
+	(((len) + STACK_INCR - 1) / STACK_INCR * STACK_INCR)
+
+#ifdef notdef
+#if defined(__i386__)
+#define CALL_MCOUNT						\
+	pushl	%ebp						;\
+	movl	%esp, %ebp					;\
+	.data							;\
+	1: .long 0						;\
+	.text							;\
+	lea 9b,%edx						;\
+	call mcount						;\
+	popl	%ebp						;
+#elif defined(__x86_64__)
+#define CALL_MCOUNT						\
+	pushq	%rbp						;\
+	movq	%rsp, %rbp					;\
+	.data							;\
+	1: .quad 0						;\
+	.text							;\
+	lea 9b,%r13						;\
+	call mcount						;\
+	popq	%rbp					;
+#endif
+#else
+#define CALL_MCOUNT
+#endif
+
+/*
+ * Prologue for functions that may call other functions.  Saves
+ * registers and sets up a C frame.
+ */
+#if defined(__i386__)
+#define NESTED_FUNCTION_PROLOGUE(localvarsize)			\
+	.set	L__framesize,ROUND_TO_STACK(localvarsize)	;\
+	.set	L__nested_function, 1				;\
+	CALL_MCOUNT						\
+	.if L__framesize						;\
+	  pushl	%ebp						;\
+	  movl	%esp, %ebp					;\
+	  subl	$L__framesize, %esp				;\
+	.endif							;\
+	pushl	%edi						;\
+	pushl	%esi						;\
+	pushl	%ebx
+#elif defined(__x86_64__)
+#define NESTED_FUNCTION_PROLOGUE(localvarsize)			\
+	.set	L__framesize,ROUND_TO_STACK(localvarsize)	;\
+	.set	L__nested_function, 1				;\
+	CALL_MCOUNT						\
+	.if L__framesize						;\
+	  pushq	%rbp						;\
+	  movq	%rsp, %rbp					;\
+	  subq	$L__framesize, %rsp				;\
+	.endif							;
+#endif
+
+/*
+ * Prologue for functions that do not call other functions.  Does not
+ * save registers (this is the functions responsibility).  Does set
+ * up a C frame.
+ */
+#if defined(__i386__)
+#define LEAF_FUNCTION_PROLOGUE(localvarsize)			\
+	.set	L__framesize,ROUND_TO_STACK(localvarsize)	;\
+	.set	L__nested_function, 0				;\
+	CALL_MCOUNT						\
+	.if L__framesize						;\
+	  pushl	%ebp						;\
+	  movl	%esp, %ebp					;\
+	  subl	$L__framesize, %esp				;\
+	.endif
+#elif defined(__x86_64__)
+#define LEAF_FUNCTION_PROLOGUE(localvarsize)			\
+	.set	L__framesize,ROUND_TO_STACK(localvarsize)	;\
+	.set	L__nested_function, 0				;\
+	CALL_MCOUNT						\
+	.if L__framesize						;\
+	  pushq	%rbp						;\
+	  movq	%rsp, %rbp					;\
+	  subq	$L__framesize, %rsp				;\
+	.endif
+#endif
+
+/*
+ * Epilogue for any function.
+ *
+ * We assume that all Leaf functions will be responsible for saving any
+ * local registers they clobber.
+ */
+#if defined(__i386__)
+#define FUNCTION_EPILOGUE					\
+	.if L__nested_function					;\
+	  popl	%ebx						;\
+	  popl	%esi						;\
+	  popl	%edi						;\
+	.endif							;\
+	.if L__framesize						;\
+	  movl	%ebp, %esp					;\
+	  popl	%ebp						;\
+	.endif							;\
+	ret
+#elif defined(__x86_64__)
+#define FUNCTION_EPILOGUE					\
+	.if L__framesize						;\
+	  movq	%rbp, %rsp					;\
+	  popq	%rbp						;\
+	.endif							;\
+	ret
+#endif
+
+/*
+ * Macros for declaring procedures
+ *
+ * Use of these macros allows ctags to have a predictable way
+ * to find various types of declarations.  They also simplify
+ * inserting appropriate symbol table information.
+ *
+ * NOTE: these simple stubs will be replaced with more
+ * complicated versions once we know what the linker and gdb
+ * will require as far as register use masks and frame declarations.
+ * These macros may also be ifdef'ed in the future to contain profiling
+ * code.
+ *
+ */
+
+/*
+ * TEXT -- declare start of text segment
+ */
+#define	TEXT						\
+	.text
+
+/*
+ * DATA -- declare start of data segment
+ */
+#define DATA						\
+	.data
+
+/*
+ * LEAF -- declare global leaf procedure
+ * NOTE: Control SHOULD NOT FLOW into a LEAF!  A LEAF should only
+ * be jumped to.  (A leaf may do an align.)  Use a LABEL() if you
+ * need control to flow into the label.
+ */
+#define	LEAF(name, localvarsize)			\
+	.globl	name					;\
+	ALIGN						;\
+name:							;\
+	LEAF_FUNCTION_PROLOGUE(localvarsize)
+
+/*
+ * X_LEAF -- declare alternate global label for leaf
+ */
+#define	X_LEAF(name, value)				\
+	.globl	name					;\
+	.set	name,value
+
+/*
+ * P_LEAF -- declare private leaf procedure
+ */
+#define	P_LEAF(name, localvarsize)			\
+	ALIGN						;\
+name:							;\
+	LEAF_FUNCTION_PROLOGUE(localvarsize)
+
+/*
+ * LABEL -- declare a global code label
+ * MUST be used (rather than LEAF, NESTED, etc) if control
+ * "flows into" the label.
+ */
+#define	LABEL(name)					\
+	.globl	name					;\
+name:
+
+/*
+ * NESTED -- declare procedure that invokes other procedures
+ */
+#define	NESTED(name, localvarsize)			\
+	.globl	name					;\
+	ALIGN						;\
+name:							;\
+	NESTED_FUNCTION_PROLOGUE(localvarsize)
+
+/*
+ * X_NESTED -- declare alternate global label for nested proc
+ */
+#define	X_NESTED(name, value)				\
+	.globl	name					;\
+	.set	name,value
+
+/*
+ * P_NESTED -- declare private nested procedure
+ */
+#define	P_NESTED(name, localvarsize)			\
+	ALIGN						;\
+name:							;\
+	NESTED_FUNCTION_PROLOGUE(localvarsize)
+
+/*
+ * END -- mark end of procedure
+ */
+#define	END(name)					\
+	FUNCTION_EPILOGUE
+
+
+/*
+ * Storage definition macros
+ * The main purpose of these is to allow an easy handle for ctags
+ */
+
+/*
+ * IMPORT -- import symbol
+ */
+#define	IMPORT(name)					\
+	.reference	name
+
+/*
+ * ABS -- declare global absolute symbol
+ */
+#define	ABS(name, value)				\
+	.globl	name					;\
+	.set	name,value
+
+/*
+ * P_ABS -- declare private absolute symbol
+ */
+#define	P_ABS(name, value)				\
+	.set	name,value
+
+/*
+ * EXPORT -- declare global label for data
+ */
+#define	EXPORT(name)					\
+	.globl	name					;\
+name:
+
+/*
+ * BSS -- declare global zero'ed storage
+ */
+#define	BSS(name,size)					\
+	.comm	name,size
+
+
+/*
+ * P_BSS -- declare private zero'ed storage
+ */
+#define	P_BSS(name,size)				\
+	.lcomm	name,size
+
+/*
+ * dynamic/PIC macros for routines which reference external symbols
+ */
+
+#if defined(__DYNAMIC__)
+#if defined(__i386__)
+#define PICIFY(var)					\
+	call	1f					; \
+1:							; \
+	popl	%edx					; \
+	movl	L ## var ## __non_lazy_ptr-1b(%edx),%edx
+#elif defined(__x86_64__)
+#define PICIFY(var)					\
+	movq	var@GOTPCREL(%rip),%r11
+#endif
+
+#if defined(__i386__)
+#define CALL_EXTERN_AGAIN(func)	\
+	PICIFY(func)		; \
+	call	*%edx
+#elif defined(__x86_64__)
+#define CALL_EXTERN_AGAIN(func)	\
+	call	func
+#endif
+
+#if defined(__i386__)
+#define NON_LAZY_STUB(var)	\
+.section __IMPORT,__pointers,non_lazy_symbol_pointers	; \
+L ## var ## __non_lazy_ptr:	; \
+.indirect_symbol var		; \
+.long 0				; \
+.text
+#elif defined(__x86_64__)
+#define NON_LAZY_STUB(var)	
+#endif
+
+#define CALL_EXTERN(func)	\
+	CALL_EXTERN_AGAIN(func)	; \
+	NON_LAZY_STUB(func)
+
+#if defined(__i386__)
+#define BRANCH_EXTERN(func)	\
+	PICIFY(func)		; \
+	jmp	*%edx		; \
+	NON_LAZY_STUB(func)
+#elif defined(__x86_64__)
+#define BRANCH_EXTERN(func)	\
+	jmp	func
+#endif
+
+#if defined(__i386__)
+#define PUSH_EXTERN(var)	\
+	PICIFY(var)		; \
+	movl	(%edx),%edx	; \
+	pushl	%edx		; \
+	NON_LAZY_STUB(var)
+#endif
+
+#if defined(__i386__)
+#define REG_TO_EXTERN(reg, var)	\
+	PICIFY(var)		; \
+	movl	reg, (%edx)	; \
+	NON_LAZY_STUB(var)
+#elif defined(__x86_64__)
+#define REG_TO_EXTERN(reg, var)	\
+	PICIFY(var)		; \
+	mov		reg, (%r11)
+#endif
+
+#if defined(__i386__)
+#define EXTERN_TO_REG(var, reg)				\
+	call	1f					; \
+1:							; \
+	popl	%edx					; \
+	movl	L ## var ##__non_lazy_ptr-1b(%edx),reg	; \
+	NON_LAZY_STUB(var)
+#elif defined(__x86_64__)
+#define EXTERN_TO_REG(var, reg)				\
+	PICIFY(var)		; \
+	mov    (%r11), reg
+#endif
+
+#else
+#define BRANCH_EXTERN(func)	jmp	func
+#define PUSH_EXTERN(var)	push	var
+#define CALL_EXTERN(func)	call	func
+#define CALL_EXTERN_AGAIN(func)	call	func
+#if defined(__i386__)
+#define REG_TO_EXTERN(reg, var)	mov	reg, var
+#define EXTERN_TO_REG(var, reg)	mov	$ ## var, reg
+#elif defined(__x86_64__)
+#define REG_TO_EXTERN(reg, var)	mov	reg, var ## (%rip)
+#define EXTERN_TO_REG(var, reg)	mov	var ## (%rip), reg
+#endif
+#endif
+
+#endif	/* __ASSEMBLER__ */
+
+#endif	/* _ARCH_I386_ASM_HELP_H_ */
diff -Nur cctools-877.5/include/architecture/i386/byte_order.h cctools-877.5-AnV/include/architecture/i386/byte_order.h
--- cctools-877.5/include/architecture/i386/byte_order.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/i386/byte_order.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,33 @@
+/*
+ * Copyright (c) 1999-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _ARCH_I386_BYTE_ORDER_H_
+#define _ARCH_I386_BYTE_ORDER_H_
+
+/*
+ * Maintain source compatibility
+ */
+
+#include <architecture/byte_order.h>
+
+#endif	/* _ARCH_I386_BYTE_ORDER_H_ */
diff -Nur cctools-877.5/include/architecture/i386/cpu.h cctools-877.5-AnV/include/architecture/i386/cpu.h
--- cctools-877.5/include/architecture/i386/cpu.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/i386/cpu.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,74 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ * Intel386 Family:	Special processor registers.
+ *
+ * HISTORY
+ *
+ * 5 April 1992 ? at NeXT
+ *	Created.
+ */
+
+#ifndef _ARCH_I386_CPU_H_
+#define _ARCH_I386_CPU_H_
+
+/*
+ * Control register 0
+ */
+ 
+typedef struct _cr0 {
+    unsigned int	pe	:1,
+    			mp	:1,
+			em	:1,
+			ts	:1,
+				:1,
+			ne	:1,
+				:10,
+			wp	:1,
+				:1,
+			am	:1,
+				:10,
+			nw	:1,
+			cd	:1,
+			pg	:1;
+} cr0_t;
+
+/*
+ * Debugging register 6
+ */
+
+typedef struct _dr6 {
+    unsigned int	b0	:1,
+    			b1	:1,
+			b2	:1,
+			b3	:1,
+				:9,
+			bd	:1,
+			bs	:1,
+			bt	:1,
+				:16;
+} dr6_t;
+
+#endif	/* _ARCH_I386_CPU_H_ */
diff -Nur cctools-877.5/include/architecture/i386/desc.h cctools-877.5-AnV/include/architecture/i386/desc.h
--- cctools-877.5/include/architecture/i386/desc.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/i386/desc.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,150 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ * Intel386 Family:	Segment descriptors.
+ *
+ * HISTORY
+ *
+ * 29 March 1992 ? at NeXT
+ *	Created.
+ */
+
+#ifndef _ARCH_I386_DESC_H_
+#define _ARCH_I386_DESC_H_
+
+/*
+ * Code segment descriptor.
+ */
+
+typedef struct code_desc {
+    unsigned short	limit00;
+    unsigned short	base00;
+    unsigned char	base16;
+    unsigned char	type	:5,
+#define DESC_CODE_EXEC	0x18
+#define DESC_CODE_READ	0x1a
+			dpl	:2,
+			present	:1;
+    unsigned char	limit16	:4,
+				:2,
+			opsz	:1,
+#define DESC_CODE_16B	0
+#define DESC_CODE_32B	1
+			granular:1;
+#define DESC_GRAN_BYTE	0
+#define DESC_GRAN_PAGE	1
+    unsigned char	base24;
+} code_desc_t;
+ 
+/*
+ * Data segment descriptor.
+ */
+
+typedef struct data_desc {
+    unsigned short	limit00;
+    unsigned short	base00;
+    unsigned char	base16;
+    unsigned char	type	:5,
+#define DESC_DATA_RONLY	0x10
+#define DESC_DATA_WRITE	0x12
+			dpl	:2,
+			present	:1;
+    unsigned char	limit16	:4,
+				:2,
+			stksz	:1,
+#define DESC_DATA_16B	0
+#define DESC_DATA_32B	1
+			granular:1;
+    unsigned char	base24;
+} data_desc_t;
+
+/*
+ * LDT segment descriptor.
+ */
+
+typedef struct ldt_desc {
+    unsigned short	limit00;
+    unsigned short	base00;
+    unsigned char	base16;
+    unsigned char	type	:5,
+#define DESC_LDT	0x02
+				:2,
+			present	:1;
+    unsigned char	limit16	:4,
+				:3,
+			granular:1;
+    unsigned char	base24;
+} ldt_desc_t;
+
+#include <architecture/i386/sel.h>
+
+/*
+ * Call gate descriptor.
+ */
+ 
+typedef struct call_gate {
+    unsigned short	offset00;
+    sel_t		seg;
+    unsigned int	argcnt	:5,
+    				:3,
+			type	:5,
+#define DESC_CALL_GATE	0x0c
+			dpl	:2,
+			present	:1,
+			offset16:16;
+} call_gate_t;
+
+/*
+ * Trap gate descriptor.
+ */
+ 
+typedef struct trap_gate {
+    unsigned short	offset00;
+    sel_t		seg;
+    unsigned int		:8,
+    			type	:5,
+#define DESC_TRAP_GATE	0x0f
+			dpl	:2,
+			present	:1,
+			offset16:16;
+} trap_gate_t;
+
+
+/*
+ * Interrupt gate descriptor.
+ */
+ 
+typedef struct intr_gate {
+    unsigned short	offset00;
+    sel_t		seg;
+    unsigned int		:8,
+    			type	:5,
+#define DESC_INTR_GATE	0x0e
+			dpl	:2,
+			present	:1,
+			offset16:16;
+} intr_gate_t;
+
+#endif	/* _ARCH_I386_DESC_H_ */
diff -Nur cctools-877.5/include/architecture/i386/io.h cctools-877.5-AnV/include/architecture/i386/io.h
--- cctools-877.5/include/architecture/i386/io.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/i386/io.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ * Intel 386 Family: IO space defines.
+ *
+ * HISTORY
+ *
+ * 11 August 1992 ? at NeXT
+ *	Created.
+ */
+
+#ifndef _ARCH_I386_IO_H_
+#define _ARCH_I386_IO_H_
+
+typedef unsigned short		io_addr_t;
+typedef unsigned short		io_len_t;
+
+#endif	/* _ARCH_I386_IO_H_ */
diff -Nur cctools-877.5/include/architecture/i386/pio.h cctools-877.5-AnV/include/architecture/i386/pio.h
--- cctools-877.5/include/architecture/i386/pio.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/i386/pio.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,104 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/* 
+ */
+#ifndef _ARCH_I386_PIO_H_
+#define _ARCH_I386_PIO_H_
+
+typedef unsigned short i386_ioport_t;
+
+#if defined(__GNUC__)
+static __inline__ unsigned long	inl(
+				i386_ioport_t port)
+{
+	unsigned long datum;
+	__asm__ volatile("inl %w1, %0" : "=a" (datum) : "Nd" (port));
+	return(datum);
+}
+
+static __inline__ unsigned short inw(
+				i386_ioport_t port)
+{
+	unsigned short datum;
+	__asm__ volatile("inw %w1, %w0" : "=a" (datum) : "Nd" (port));
+	return(datum);
+}
+
+static __inline__ unsigned char inb(
+				i386_ioport_t port)
+{
+	unsigned char datum;
+	__asm__ volatile("inb %w1, %b0" : "=a" (datum) : "Nd" (port));
+	return(datum);
+}
+
+static __inline__ void outl(
+				i386_ioport_t port,
+				unsigned long datum)
+{
+	__asm__ volatile("outl %0, %w1" : : "a" (datum), "Nd" (port));
+}
+
+static __inline__ void outw(
+				i386_ioport_t port,
+				unsigned short datum)
+{
+	__asm__ volatile("outw %w0, %w1" : : "a" (datum), "Nd" (port));
+}
+
+static __inline__ void outb(
+				i386_ioport_t port,
+				unsigned char datum)
+{
+	__asm__ volatile("outb %b0, %w1" : : "a" (datum), "Nd" (port));
+}
+#endif /* defined(__GNUC__) */
+#endif /* _ARCH_I386_PIO_H_ */
diff -Nur cctools-877.5/include/architecture/i386/reg_help.h cctools-877.5-AnV/include/architecture/i386/reg_help.h
--- cctools-877.5/include/architecture/i386/reg_help.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/i386/reg_help.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,105 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1991 NeXT Computer, Inc.  All rights reserved.
+ *
+ *	File:	architecture/i386/reg_help.h
+ *	Author:	Mike DeMoney, NeXT Computer, Inc.
+ *      Modified for i386 by: Bruce Martin, NeXT Computer, Inc.
+ *
+ *	This header file defines cpp macros useful for defining
+ *	machine register and doing machine-level operations.
+ *
+ * HISTORY
+ * 10-Mar-92  Bruce Martin (bmartin@next.com)
+ *	Adapted to i386
+ * 23-Jan-91  Mike DeMoney (mike@next.com)
+ *	Created.
+ */
+
+#ifndef	_ARCH_I386_REG_HELP_H_
+#define	_ARCH_I386_REG_HELP_H_
+
+/* Bitfield definition aid */
+#define	BITS_WIDTH(msb, lsb)	((msb)-(lsb)+1)
+#define	BIT_WIDTH(pos)		(1)	/* mostly to record the position */
+
+/* Mask creation */
+#define	MKMASK(width, offset)	(((unsigned)-1)>>(32-(width))<<(offset))
+#define	BITSMASK(msb, lsb)	MKMASK(BITS_WIDTH(msb, lsb), lsb & 0x1f)
+#define	BITMASK(pos)		MKMASK(BIT_WIDTH(pos), pos & 0x1f)
+
+/* Register addresses */
+#if	__ASSEMBLER__
+# define	REG_ADDR(type, addr)	(addr)
+#else	/* __ASSEMBLER__ */
+# define	REG_ADDR(type, addr)	(*(volatile type *)(addr))
+#endif	/* __ASSEMBLER__ */
+
+/* Cast a register to be an unsigned */
+#define	CONTENTS(foo)	(*(unsigned *) &(foo))
+
+/* Stack pointer must always be a multiple of 4 */
+#define	STACK_INCR	4
+#define	ROUND_FRAME(x)	((((unsigned)(x)) + STACK_INCR - 1) & ~(STACK_INCR-1))
+
+/* STRINGIFY -- perform all possible substitutions, then stringify */
+#define	__STR(x)	#x		/* just a helper macro */
+#define	STRINGIFY(x)	__STR(x)
+
+/*
+ * REG_PAIR_DEF -- define a register pair
+ * Register pairs are appropriately aligned to allow access via
+ * ld.d and st.d.
+ *
+ * Usage:
+ *	struct foo {
+ *		REG_PAIR_DEF(
+ *			bar_t *,	barp,
+ *			afu_t,		afu
+ *		);
+ *	};
+ *
+ * Access to individual entries of the pair is via the REG_PAIR
+ * macro (below).
+ */
+#define	REG_PAIR_DEF(type0, name0, type1, name1)		\
+	struct {						\
+		type0	name0 __attribute__(( aligned(8) ));	\
+		type1	name1;					\
+	} name0##_##name1
+
+/*
+ * REG_PAIR -- Macro to define names for accessing individual registers
+ * of register pairs.
+ *
+ * Usage:
+ *	arg0 is first element of pair
+ *	arg1 is second element of pair
+ *	arg2 is desired element of pair
+ * eg:
+ *	#define	foo_barp	REG_PAIR(barp, afu, afu)
+ */
+#define	REG_PAIR(name0, name1, the_name)			\
+	name0##_##name1.the_name
+
+#endif	/* _ARCH_I386_REG_HELP_H_ */
diff -Nur cctools-877.5/include/architecture/i386/sel.h cctools-877.5-AnV/include/architecture/i386/sel.h
--- cctools-877.5/include/architecture/i386/sel.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/i386/sel.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,53 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ * Intel386 Family:	Segment selector.
+ *
+ * HISTORY
+ *
+ * 29 March 1992 ? at NeXT
+ *	Created.
+ */
+
+#ifndef	_ARCH_I386_SEL_H_
+#define	_ARCH_I386_SEL_H_
+
+/*
+ * Segment selector.
+ */
+
+typedef struct sel {
+    unsigned short	rpl	:2,
+#define KERN_PRIV	0
+#define USER_PRIV	3
+			ti	:1,
+#define SEL_GDT		0
+#define SEL_LDT		1
+			index	:13;
+} sel_t;
+
+#define NULL_SEL	((sel_t) { 0, 0, 0 } )
+
+#endif	/* _ARCH_I386_SEL_H_ */
diff -Nur cctools-877.5/include/architecture/i386/table.h cctools-877.5-AnV/include/architecture/i386/table.h
--- cctools-877.5/include/architecture/i386/table.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/i386/table.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,98 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ * Intel386 Family:	Descriptor tables.
+ *
+ * HISTORY
+ *
+ * 30 March 1992 ? at NeXT
+ *	Created.
+ */
+
+#ifndef _ARCH_I386_TABLE_H_
+#define _ARCH_I386_TABLE_H_
+
+#include <architecture/i386/desc.h>
+#include <architecture/i386/tss.h>
+
+/*
+ * A totally generic descriptor
+ * table entry.
+ */
+
+typedef union dt_entry {
+    code_desc_t		code;
+    data_desc_t		data;
+    ldt_desc_t		ldt;
+    tss_desc_t		task_state;
+    call_gate_t		call_gate;
+    trap_gate_t		trap_gate;
+    intr_gate_t		intr_gate;
+    task_gate_t		task_gate;
+} dt_entry_t;
+
+#define DESC_TBL_MAX	8192
+
+/*
+ * Global descriptor table.
+ */
+
+typedef union gdt_entry {
+    code_desc_t		code;
+    data_desc_t		data;
+    ldt_desc_t		ldt;
+    call_gate_t		call_gate;
+    task_gate_t		task_gate;
+    tss_desc_t		task_state;
+} gdt_entry_t;
+
+typedef gdt_entry_t	gdt_t;
+
+/*
+ * Interrupt descriptor table.
+ */
+
+typedef union idt_entry {
+    trap_gate_t		trap_gate;
+    intr_gate_t		intr_gate;
+    task_gate_t		task_gate;
+} idt_entry_t;
+
+typedef idt_entry_t	idt_t;
+
+/*
+ * Local descriptor table.
+ */
+
+typedef union ldt_entry {
+    code_desc_t		code;
+    data_desc_t		data;
+    call_gate_t		call_gate;
+    task_gate_t		task_gate;
+} ldt_entry_t;
+
+typedef ldt_entry_t	ldt_t;
+
+#endif	/* _ARCH_I386_TABLE_H_ */
diff -Nur cctools-877.5/include/architecture/i386/tss.h cctools-877.5-AnV/include/architecture/i386/tss.h
--- cctools-877.5/include/architecture/i386/tss.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/architecture/i386/tss.h	2015-11-16 07:55:56 +0000
@@ -0,0 +1,120 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ * Intel386 Family:	Task State Segment.
+ *
+ * HISTORY
+ *
+ * 29 March 1992 ? at NeXT
+ *	Created.
+ */
+
+#ifndef _ARCH_I386_TSS_H_
+#define _ARCH_I386_TSS_H_
+
+#include <architecture/i386/sel.h>
+
+/*
+ * Task State segment.
+ */
+
+typedef struct tss {
+    sel_t		oldtss;
+    unsigned int		:0;
+    unsigned int	esp0;
+    sel_t		ss0;
+    unsigned int		:0;
+    unsigned int	esp1;
+    sel_t		ss1;
+    unsigned int		:0;
+    unsigned int	esp2;
+    sel_t		ss2;
+    unsigned int		:0;
+    unsigned int	cr3;
+    unsigned int	eip;
+    unsigned int	eflags;
+    unsigned int	eax;
+    unsigned int	ecx;
+    unsigned int	edx;
+    unsigned int	ebx;
+    unsigned int	esp;
+    unsigned int	ebp;
+    unsigned int	esi;
+    unsigned int	edi;
+    sel_t		es;
+    unsigned int		:0;
+    sel_t		cs;
+    unsigned int		:0;
+    sel_t		ss;
+    unsigned int		:0;
+    sel_t		ds;
+    unsigned int		:0;
+    sel_t		fs;
+    unsigned int		:0;
+    sel_t		gs;
+    unsigned int		:0;
+    sel_t		ldt;
+    unsigned int		:0;
+    unsigned int	t	:1,
+    				:15,
+			io_bmap	:16;
+} tss_t;
+
+#define TSS_SIZE(n)	(sizeof (struct tss) + (n))
+
+/*
+ * Task State segment descriptor.
+ */
+
+typedef struct tss_desc {
+    unsigned short	limit00;
+    unsigned short	base00;
+    unsigned char	base16;
+    unsigned char	type	:5,
+#define DESC_TSS	0x09
+			dpl	:2,
+			present	:1;
+    unsigned char	limit16	:4,
+				:3,
+			granular:1;
+    unsigned char	base24;
+} tss_desc_t;
+
+/*
+ * Task gate descriptor.
+ */
+ 
+typedef struct task_gate {
+    unsigned short		:16;
+    sel_t		tss;
+    unsigned int		:8,
+    			type	:5,
+#define DESC_TASK_GATE	0x05
+			dpl	:2,
+			present	:1,
+				:0;
+} task_gate_t;
+
+#endif	/* _ARCH_I386_TSS_H_ */
diff -Nur cctools-877.5/include/coff/aouthdr.h cctools-877.5-AnV/include/coff/aouthdr.h
--- cctools-877.5/include/coff/aouthdr.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/coff/aouthdr.h	2015-11-19 09:03:05 +0000
@@ -101,9 +101,25 @@
 	uint32_t DataDirectory[16][2]; /* 16 entries, 2 elements/entry, */
 };
 
+struct aouthdr_rom {
+    uint16_t magic;
+    uint16_t vstamp;
+    uint32_t tsize;
+    uint32_t dsize;
+    uint32_t bsize;
+    uint32_t entry;
+    uint32_t text_start;
+    uint32_t data_start;
+    uint32_t bss_start;
+    uint32_t gpr_mask;
+    uint32_t cpr_mask[4];
+    uint32_t gp_value;
+};
+
 /* for the magic field */
-#define PE32MAGIC       0x10b   /* 32-bit image */
-#define PE32PMAGIC	0x20b	/* 32-bit image inside 64-bit address space */
+#define PE32MAGIC   0x10b   /* 32-bit image */
+#define PE32PMAGIC  0x20b   /* 32-bit image inside 64-bit address space */
+#define ROMMAGIC    0x107   /* ROM image */
 
 /* for the FileAlignment field */
 #define FILEALIGNMENT	0x200	/* The alignment factor (in bytes) that is used
@@ -127,8 +143,19 @@
 #define VSTAMP (LINKER_VERSION / 100 + (LINKER_VERSION % 100) * 256)
 
 /* for the Subsystem field */
+#define IMAGE_SUBSYSTEM_UNKNOWN 0
+#define IMAGE_SUBSYSTEM_NATIVE 1
+#define IMAGE_SUBSYSTEM_WINDOWS_GUI 2
+#define IMAGE_SUBSYSTEM_WINDOWS_CUI 3
+#define IMAGE_SUBSYSTEM_OS2_CUI 5
+#define IMAGE_SUBSYSTEM_POSIX_CUI 7
+#define IMAGE_SUBSYSTEM_NATIVE_WINDOWS 8
+#define IMAGE_SUBSYSTEM_WINDOWS_CE_GUI 9
 #define IMAGE_SUBSYSTEM_EFI_APPLICATION		10
 #define IMAGE_SUBSYSTEM_EFI_BOOT_SERVICE_DRIVER	11
 #define IMAGE_SUBSYSTEM_EFI_RUNTIME_DRIVER	12
+#define IMAGE_SUBSYSTEM_EFI_ROM 13
+#define IMAGE_SUBSYSTEM_XBOX 14
+#define IMAGE_SUBSYSTEM_WINDOWS_BOOT_APPLICATION 16
 
 #endif /* _COFF_AOUTHDR_H */
diff -Nur cctools-877.5/include/coff/filehdr.h cctools-877.5-AnV/include/coff/filehdr.h
--- cctools-877.5/include/coff/filehdr.h	2013-12-10 19:28:11 +0000
+++ cctools-877.5-AnV/include/coff/filehdr.h	2015-11-19 09:03:05 +0000
@@ -46,10 +46,17 @@
 };
 
 /* Machine numbers (for the f_magic field).  */
+#define IMAGE_FILE_MACHINE_UNKNOWN           0
 #define IMAGE_FILE_MACHINE_ARM               0x01c0
+#define IMAGE_FILE_MACHINE_THUMB             0x01c2
+#define IMAGE_FILE_MACHINE_ARMV7             0x01c4
 #define IMAGE_FILE_MACHINE_ARM64             0x01c6
+#define IMAGE_FILE_MACHINE_POWERPC           0x01F0
+#define IMAGE_FILE_MACHINE_POWERPCFP         0x01f1
 #define IMAGE_FILE_MACHINE_I386              0x014c
+#define IMAGE_FILE_MACHINE_IA64              0x0200
 #define IMAGE_FILE_MACHINE_AMD64             0x8664
+#define IMAGE_FILE_MACHINE_EBC               0x0EBC
 
 /* NT specific file attributes (for the f_flags field).  */
 #define IMAGE_FILE_EXECUTABLE_IMAGE          0x0002
diff -Nur cctools-877.5/include/i386/_limits.h cctools-877.5-AnV/include/i386/_limits.h
--- cctools-877.5/include/i386/_limits.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/_limits.h	2015-11-16 07:56:09 +0000
@@ -0,0 +1,27 @@
+/*
+ * Copyright (c) 2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+#ifndef	_I386__LIMITS_H_
+#define	_I386__LIMITS_H_
+
+#define	__DARWIN_CLK_TCK		100	/* ticks per second */
+
+#endif	/* _I386__LIMITS_H_ */
diff -Nur cctools-877.5/include/i386/_mcontext.h cctools-877.5-AnV/include/i386/_mcontext.h
--- cctools-877.5/include/i386/_mcontext.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/_mcontext.h	2015-11-16 07:56:09 +0000
@@ -0,0 +1,123 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef __I386_MCONTEXT_H_
+#define __I386_MCONTEXT_H_
+
+#include <sys/appleapiopts.h>
+#include <mach/i386/_structs.h>
+
+#ifndef _STRUCT_MCONTEXT32
+#if __DARWIN_UNIX03
+#define	_STRUCT_MCONTEXT32	struct __darwin_mcontext32
+_STRUCT_MCONTEXT32
+{
+	_STRUCT_X86_EXCEPTION_STATE32	__es;
+	_STRUCT_X86_THREAD_STATE32	__ss;
+	_STRUCT_X86_FLOAT_STATE32	__fs;
+};
+
+#define	_STRUCT_MCONTEXT_AVX32	struct __darwin_mcontext_avx32
+_STRUCT_MCONTEXT_AVX32
+{
+	_STRUCT_X86_EXCEPTION_STATE32	__es;
+	_STRUCT_X86_THREAD_STATE32	__ss;
+	_STRUCT_X86_AVX_STATE32		__fs;
+};
+
+#else /* !__DARWIN_UNIX03 */
+#define	_STRUCT_MCONTEXT32	struct mcontext32
+_STRUCT_MCONTEXT32
+{
+	_STRUCT_X86_EXCEPTION_STATE32	es;
+	_STRUCT_X86_THREAD_STATE32	ss;
+	_STRUCT_X86_FLOAT_STATE32	fs;
+};
+
+#define	_STRUCT_MCONTEXT_AVX32	struct mcontext_avx32
+_STRUCT_MCONTEXT_AVX32
+{
+	_STRUCT_X86_EXCEPTION_STATE32	es;
+	_STRUCT_X86_THREAD_STATE32	ss;
+	_STRUCT_X86_AVX_STATE32		fs;
+};
+
+#endif /* __DARWIN_UNIX03 */
+#endif /* _STRUCT_MCONTEXT32 */
+
+#ifndef _STRUCT_MCONTEXT64
+#if __DARWIN_UNIX03
+#define	_STRUCT_MCONTEXT64	struct __darwin_mcontext64
+_STRUCT_MCONTEXT64
+{
+	_STRUCT_X86_EXCEPTION_STATE64	__es;
+	_STRUCT_X86_THREAD_STATE64	__ss;
+	_STRUCT_X86_FLOAT_STATE64	__fs;
+};
+
+#define	_STRUCT_MCONTEXT_AVX64	struct __darwin_mcontext_avx64
+_STRUCT_MCONTEXT_AVX64
+{
+	_STRUCT_X86_EXCEPTION_STATE64	__es;
+	_STRUCT_X86_THREAD_STATE64	__ss;
+	_STRUCT_X86_AVX_STATE64		__fs;
+};
+
+#else /* !__DARWIN_UNIX03 */
+#define	_STRUCT_MCONTEXT64	struct mcontext64
+_STRUCT_MCONTEXT64
+{
+	_STRUCT_X86_EXCEPTION_STATE64	es;
+	_STRUCT_X86_THREAD_STATE64	ss;
+	_STRUCT_X86_FLOAT_STATE64	fs;
+};
+
+#define	_STRUCT_MCONTEXT_AVX64	struct mcontext_avx64
+_STRUCT_MCONTEXT_AVX64
+{
+	_STRUCT_X86_EXCEPTION_STATE64	es;
+	_STRUCT_X86_THREAD_STATE64	ss;
+	_STRUCT_X86_AVX_STATE64		fs;
+};
+
+#endif /* __DARWIN_UNIX03 */
+#endif /* _STRUCT_MCONTEXT64 */
+
+
+#ifndef _MCONTEXT_T
+#define _MCONTEXT_T
+#if defined(__LP64__)
+typedef _STRUCT_MCONTEXT64	*mcontext_t;
+#define _STRUCT_MCONTEXT _STRUCT_MCONTEXT64
+#else
+typedef _STRUCT_MCONTEXT32	*mcontext_t;
+#define _STRUCT_MCONTEXT	_STRUCT_MCONTEXT32
+#endif
+#endif /* _MCONTEXT_T */
+
+#endif /* __I386_MCONTEXT_H_ */
diff -Nur cctools-877.5/include/i386/_param.h cctools-877.5-AnV/include/i386/_param.h
--- cctools-877.5/include/i386/_param.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/_param.h	2015-11-16 07:56:09 +0000
@@ -0,0 +1,46 @@
+/*
+ * Copyright (c) 2008 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _I386__PARAM_H_
+#define _I386__PARAM_H_
+
+#include <i386/_types.h>
+
+/*
+ * Round p (pointer or byte index) up to a correctly-aligned value for all
+ * data types (int, long, ...).   The result is unsigned int and must be
+ * cast to any desired pointer type.
+ */
+#define	__DARWIN_ALIGNBYTES	(sizeof(__darwin_size_t) - 1)
+#define	__DARWIN_ALIGN(p)	((__darwin_size_t)((char *)(__darwin_size_t)(p) + __DARWIN_ALIGNBYTES) &~ __DARWIN_ALIGNBYTES)
+
+#define      __DARWIN_ALIGNBYTES32     (sizeof(__uint32_t) - 1)
+#define       __DARWIN_ALIGN32(p)       ((__darwin_size_t)((char *)(__darwin_size_t)(p) + __DARWIN_ALIGNBYTES32) &~ __DARWIN_ALIGNBYTES32)
+
+
+#endif /* _I386__PARAM_H_ */
diff -Nur cctools-877.5/include/i386/_types.h cctools-877.5-AnV/include/i386/_types.h
--- cctools-877.5/include/i386/_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/_types.h	2015-11-16 07:56:09 +0000
@@ -0,0 +1,122 @@
+/*
+ * Copyright (c) 2000-2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef	_BSD_I386__TYPES_H_
+#define	_BSD_I386__TYPES_H_
+
+/*
+ * This header file contains integer types.  It's intended to also contain
+ * flotaing point and other arithmetic types, as needed, later.
+ */
+
+#ifdef __GNUC__
+typedef __signed char		__int8_t;
+#else	/* !__GNUC__ */
+typedef char			__int8_t;
+#endif	/* !__GNUC__ */
+typedef unsigned char		__uint8_t;
+typedef	short			__int16_t;
+typedef	unsigned short		__uint16_t;
+typedef int			__int32_t;
+typedef unsigned int		__uint32_t;
+typedef long long		__int64_t;
+typedef unsigned long long	__uint64_t;
+
+typedef long			__darwin_intptr_t;
+typedef unsigned int		__darwin_natural_t;
+
+/*
+ * The rune type below is declared to be an ``int'' instead of the more natural
+ * ``unsigned long'' or ``long''.  Two things are happening here.  It is not
+ * unsigned so that EOF (-1) can be naturally assigned to it and used.  Also,
+ * it looks like 10646 will be a 31 bit standard.  This means that if your
+ * ints cannot hold 32 bits, you will be in trouble.  The reason an int was
+ * chosen over a long is that the is*() and to*() routines take ints (says
+ * ANSI C), but they use __darwin_ct_rune_t instead of int.  By changing it
+ * here, you lose a bit of ANSI conformance, but your programs will still
+ * work.
+ *
+ * NOTE: rune_t is not covered by ANSI nor other standards, and should not
+ * be instantiated outside of lib/libc/locale.  Use wchar_t.  wchar_t and
+ * rune_t must be the same type.  Also wint_t must be no narrower than
+ * wchar_t, and should also be able to hold all members of the largest
+ * character set plus one extra value (WEOF). wint_t must be at least 16 bits.
+ */
+
+typedef int			__darwin_ct_rune_t;	/* ct_rune_t */
+
+/*
+ * mbstate_t is an opaque object to keep conversion state, during multibyte
+ * stream conversions.  The content must not be referenced by user programs.
+ */
+typedef union {
+	char		__mbstate8[128];
+	long long	_mbstateL;			/* for alignment */
+} __mbstate_t;
+
+typedef __mbstate_t		__darwin_mbstate_t;	/* mbstate_t */
+
+#if defined(__PTRDIFF_TYPE__)
+typedef __PTRDIFF_TYPE__	__darwin_ptrdiff_t;	/* ptr1 - ptr2 */
+#elif defined(__LP64__)
+typedef long			__darwin_ptrdiff_t;	/* ptr1 - ptr2 */
+#else
+typedef int			__darwin_ptrdiff_t;	/* ptr1 - ptr2 */
+#endif /* __GNUC__ */
+
+#if defined(__SIZE_TYPE__)
+typedef __SIZE_TYPE__		__darwin_size_t;	/* sizeof() */
+#else
+typedef unsigned long		__darwin_size_t;	/* sizeof() */
+#endif
+
+#if (__GNUC__ > 2)
+typedef __builtin_va_list	__darwin_va_list;	/* va_list */
+#else
+typedef void *			__darwin_va_list;	/* va_list */
+#endif
+
+#if defined(__WCHAR_TYPE__)
+typedef __WCHAR_TYPE__		__darwin_wchar_t;	/* wchar_t */
+#else
+typedef __darwin_ct_rune_t	__darwin_wchar_t;	/* wchar_t */
+#endif
+
+typedef __darwin_wchar_t	__darwin_rune_t;	/* rune_t */
+
+#if defined(__WINT_TYPE__)
+typedef __WINT_TYPE__		__darwin_wint_t;	/* wint_t */
+#else
+typedef __darwin_ct_rune_t	__darwin_wint_t;	/* wint_t */
+#endif
+
+typedef unsigned long		__darwin_clock_t;	/* clock() */
+typedef __uint32_t		__darwin_socklen_t;	/* socklen_t (duh) */
+typedef long			__darwin_ssize_t;	/* byte count or error */
+typedef long			__darwin_time_t;	/* time() */
+
+#endif	/* _BSD_I386__TYPES_H_ */
diff -Nur cctools-877.5/include/i386/endian.h cctools-877.5-AnV/include/i386/endian.h
--- cctools-877.5/include/i386/endian.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/endian.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,102 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright 1995 NeXT Computer, Inc. All rights reserved.
+ */
+/*
+ * Copyright (c) 1987, 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)endian.h	8.1 (Berkeley) 6/11/93
+ */
+
+#ifndef _I386__ENDIAN_H_
+#define	_I386__ENDIAN_H_
+
+#include <sys/cdefs.h>
+/*
+ * Define _NOQUAD if the compiler does NOT support 64-bit integers.
+ */
+/* #define _NOQUAD */
+
+/*
+ * Define the order of 32-bit words in 64-bit words.
+ */
+#define _QUAD_HIGHWORD 1
+#define _QUAD_LOWWORD 0
+
+/*
+ * Definitions for byte order, according to byte significance from low
+ * address to high.
+ */
+#define	__DARWIN_LITTLE_ENDIAN	1234	/* LSB first: i386, vax */
+#define	__DARWIN_BIG_ENDIAN	4321	/* MSB first: 68000, ibm, net */
+#define	__DARWIN_PDP_ENDIAN	3412	/* LSB first in word, MSW first in long */
+
+#define	__DARWIN_BYTE_ORDER	__DARWIN_LITTLE_ENDIAN
+
+#if	defined(KERNEL) || (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+
+#define	LITTLE_ENDIAN	__DARWIN_LITTLE_ENDIAN
+#define	BIG_ENDIAN	__DARWIN_BIG_ENDIAN
+#define	PDP_ENDIAN	__DARWIN_PDP_ENDIAN
+
+#define	BYTE_ORDER	__DARWIN_BYTE_ORDER
+
+#include <sys/_endian.h>
+
+#endif /* defined(KERNEL) || (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)) */
+#endif /* !_I386__ENDIAN_H_ */
diff -Nur cctools-877.5/include/i386/fasttrap_isa.h cctools-877.5-AnV/include/i386/fasttrap_isa.h
--- cctools-877.5/include/i386/fasttrap_isa.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/fasttrap_isa.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,112 @@
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License (the "License").
+ * You may not use this file except in compliance with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+/*
+ * Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef	_FASTTRAP_ISA_H
+#define	_FASTTRAP_ISA_H
+
+/*
+ * #pragma ident	"@(#)fasttrap_isa.h	1.6	06/09/19 SMI"
+ */
+
+#include <sys/types.h>
+#include <stdint.h>
+
+#ifdef	__cplusplus
+extern "C" {
+#endif
+
+#define	FASTTRAP_MAX_INSTR_SIZE		15
+
+#define	FASTTRAP_INSTR			0xcc
+
+#define	FASTTRAP_SUNWDTRACE_SIZE	64
+
+typedef	uint8_t		fasttrap_instr_t;
+
+typedef struct fasttrap_machtp {
+	uint8_t		ftmt_instr[FASTTRAP_MAX_INSTR_SIZE]; /* orig. instr. */
+	uint8_t		ftmt_size;	/* instruction size */
+	uint8_t		ftmt_ripmode;	/* %rip-relative handling mode */
+	uint8_t		ftmt_modrm;	/* saved modrm byte */
+	uint8_t		ftmt_type;	/* emulation type */
+	uint8_t		ftmt_code;	/* branch condition */
+	uint8_t		ftmt_base;	/* branch base */
+	uint8_t		ftmt_index;	/* branch index */
+	uint8_t		ftmt_scale;	/* branch scale */
+	uint8_t		ftmt_segment;	/* segment for memory accesses */
+	user_addr_t	ftmt_dest;	/* destination of control flow */
+} fasttrap_machtp_t;
+
+#define	ftt_instr	ftt_mtp.ftmt_instr
+#define	ftt_ripmode	ftt_mtp.ftmt_ripmode
+#define	ftt_modrm	ftt_mtp.ftmt_modrm
+#define	ftt_size	ftt_mtp.ftmt_size
+#define	ftt_type	ftt_mtp.ftmt_type
+#define	ftt_code	ftt_mtp.ftmt_code
+#define	ftt_base	ftt_mtp.ftmt_base
+#define	ftt_index	ftt_mtp.ftmt_index
+#define	ftt_scale	ftt_mtp.ftmt_scale
+#define	ftt_segment	ftt_mtp.ftmt_segment
+#define	ftt_dest	ftt_mtp.ftmt_dest
+
+#define	FASTTRAP_T_COMMON	0x00	/* common case -- no emulation */
+#define	FASTTRAP_T_JCC		0x01	/* near and far conditional jumps */
+#define	FASTTRAP_T_LOOP		0x02	/* loop instructions */
+#define	FASTTRAP_T_JCXZ		0x03	/* jump if %ecx/%rcx is zero */
+#define	FASTTRAP_T_JMP		0x04	/* relative jump */
+#define	FASTTRAP_T_CALL		0x05	/* near call (and link) */
+#define	FASTTRAP_T_RET		0x06	/* ret */
+#define	FASTTRAP_T_RET16	0x07	/* ret <imm16> */
+
+/*
+ * For performance rather than correctness.
+ */
+#define	FASTTRAP_T_PUSHL_EBP	0x10	/* pushl %ebp (for function entry) */
+#define	FASTTRAP_T_NOP		0x11	/* nop */
+
+#define	FASTTRAP_RIP_1		0x1
+#define	FASTTRAP_RIP_2		0x2
+#define	FASTTRAP_RIP_X		0x4
+
+/*
+ * Segment values.
+ */
+#define	FASTTRAP_SEG_NONE		0
+#define	FASTTRAP_SEG_CS			1
+#define	FASTTRAP_SEG_DS			2
+#define	FASTTRAP_SEG_ES			3
+#define	FASTTRAP_SEG_FS			4
+#define	FASTTRAP_SEG_GS			5
+#define	FASTTRAP_SEG_SS			6
+
+#define	FASTTRAP_RETURN_AFRAMES		6	
+#define	FASTTRAP_ENTRY_AFRAMES		5
+#define	FASTTRAP_OFFSET_AFRAMES		5
+
+#ifdef	__cplusplus
+}
+#endif
+
+#endif	/* _FASTTRAP_ISA_H */
diff -Nur cctools-877.5/include/i386/limits.h cctools-877.5-AnV/include/i386/limits.h
--- cctools-877.5/include/i386/limits.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/limits.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,107 @@
+/*
+ * Copyright (c) 1988, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)limits.h	8.3 (Berkeley) 1/4/94
+ */
+
+#ifndef _I386_LIMITS_H_
+#define _I386_LIMITS_H_
+
+#include <sys/cdefs.h>
+#include <i386/_limits.h>
+
+#define	CHAR_BIT	8		/* number of bits in a char */
+#define	MB_LEN_MAX	6		/* Allow 31 bit UTF2 */
+
+#if !defined(_ANSI_SOURCE) && (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+#define	CLK_TCK		__DARWIN_CLK_TCK	/* ticks per second */
+#endif /* !_ANSI_SOURCE && (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/*
+ * According to ANSI (section 2.2.4.2), the values below must be usable by
+ * #if preprocessing directives.  Additionally, the expression must have the
+ * same type as would an expression that is an object of the corresponding
+ * type converted according to the integral promotions.  The subtraction for
+ * INT_MIN and LONG_MIN is so the value is not unsigned; 2147483648 is an
+ * unsigned int for 32-bit two's complement ANSI compilers (section 3.1.3.2).
+ * These numbers work for pcc as well.  The UINT_MAX and ULONG_MAX values
+ * are written as hex so that GCC will be quiet about large integer constants.
+ */
+#define	SCHAR_MAX	127		/* min value for a signed char */
+#define	SCHAR_MIN	(-128)		/* max value for a signed char */
+
+#define	UCHAR_MAX	255		/* max value for an unsigned char */
+#define	CHAR_MAX	127		/* max value for a char */
+#define	CHAR_MIN	(-128)		/* min value for a char */
+
+#define	USHRT_MAX	65535		/* max value for an unsigned short */
+#define	SHRT_MAX	32767		/* max value for a short */
+#define	SHRT_MIN	(-32768)	/* min value for a short */
+
+#define	UINT_MAX	0xffffffff	/* max value for an unsigned int */
+#define	INT_MAX		2147483647	/* max value for an int */
+#define	INT_MIN		(-2147483647-1)	/* min value for an int */
+
+#ifdef __LP64__
+#define	ULONG_MAX	0xffffffffffffffffUL	/* max unsigned long */
+#define	LONG_MAX	0x7fffffffffffffffL	/* max signed long */
+#define	LONG_MIN	(-0x7fffffffffffffffL-1) /* min signed long */
+#else /* !__LP64__ */
+#define	ULONG_MAX	0xffffffffUL	/* max unsigned long */
+#define	LONG_MAX	2147483647L	/* max signed long */
+#define	LONG_MIN	(-2147483647L-1) /* min signed long */
+#endif /* __LP64__ */
+
+#define	ULLONG_MAX	0xffffffffffffffffULL	/* max unsigned long long */
+#define	LLONG_MAX	0x7fffffffffffffffLL	/* max signed long long */
+#define	LLONG_MIN	(-0x7fffffffffffffffLL-1) /* min signed long long */
+
+#if !defined(_ANSI_SOURCE)
+#ifdef __LP64__
+#define LONG_BIT	64
+#else /* !__LP64__ */
+#define LONG_BIT	32
+#endif /* __LP64__ */
+#define	SSIZE_MAX	LONG_MAX	/* max value for a ssize_t */
+#define WORD_BIT	32
+
+#if (!defined(_POSIX_C_SOURCE) && !defined(_XOPEN_SOURCE)) || defined(_DARWIN_C_SOURCE)
+#define	SIZE_T_MAX	ULONG_MAX	/* max value for a size_t */
+
+#define	UQUAD_MAX	ULLONG_MAX
+#define	QUAD_MAX	LLONG_MAX
+#define	QUAD_MIN	LLONG_MIN
+
+#endif /* (!_POSIX_C_SOURCE && !_XOPEN_SOURCE) || _DARWIN_C_SOURCE */
+#endif /* !_ANSI_SOURCE */
+
+#endif /* _I386_LIMITS_H_ */
diff -Nur cctools-877.5/include/i386/param.h cctools-877.5-AnV/include/i386/param.h
--- cctools-877.5/include/i386/param.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/param.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,171 @@
+/*
+ * Copyright (c) 2000-2010 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*-
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)param.h	8.1 (Berkeley) 4/4/95
+ */
+
+/*
+ * Machine dependent constants for Intel 386.
+ */
+
+#ifndef _I386_PARAM_H_
+#define _I386_PARAM_H_
+
+#include <i386/_param.h>
+
+/*
+ * Round p (pointer or byte index) up to a correctly-aligned value for all
+ * data types (int, long, ...).   The result is unsigned int and must be
+ * cast to any desired pointer type.
+ */
+#define	ALIGNBYTES	__DARWIN_ALIGNBYTES
+#define	ALIGN(p)	__DARWIN_ALIGN(p)
+
+#define	NBPG		4096		/* bytes/page */
+#define	PGOFSET		(NBPG-1)	/* byte offset into page */
+#define	PGSHIFT		12		/* LOG2(NBPG) */
+
+#define	DEV_BSIZE	512
+#define	DEV_BSHIFT	9		/* log2(DEV_BSIZE) */
+#define BLKDEV_IOSIZE	2048
+#define	MAXPHYS		(128 * 1024)	/* max raw I/O transfer size */
+
+#define	CLSIZE		1
+#define	CLSIZELOG2	0
+
+/*
+ * Constants related to network buffer management.
+ * MCLBYTES must be no larger than CLBYTES (the software page size), and,
+ * on machines that exchange pages of input or output buffers with mbuf
+ * clusters (MAPPED_MBUFS), MCLBYTES must also be an integral multiple
+ * of the hardware page size.
+ */
+#define	MSIZESHIFT	8			/* 256 */
+#define	MSIZE		(1 << MSIZESHIFT)	/* size of an mbuf */
+#define	MCLSHIFT	11			/* 2048 */
+#define	MCLBYTES	(1 << MCLSHIFT)		/* size of an mbuf cluster */
+#define	MBIGCLSHIFT	12			/* 4096 */
+#define	MBIGCLBYTES	(1 << MBIGCLSHIFT)	/* size of a big cluster */
+#define	M16KCLSHIFT	14			/* 16384 */
+#define	M16KCLBYTES	(1 << M16KCLSHIFT)	/* size of a jumbo cluster */
+
+#define	MCLOFSET	(MCLBYTES - 1)
+#ifndef NMBCLUSTERS
+#define	NMBCLUSTERS	((1024 * 1024) / MCLBYTES)	/* cl map size: 1MB */
+#endif
+
+/*
+ * Some macros for units conversion
+ */
+/* Core clicks (NeXT_page_size bytes) to segments and vice versa */
+#define	ctos(x)	(x)
+#define	stoc(x)	(x)
+
+/* Core clicks (4096 bytes) to disk blocks */
+#define	ctod(x)	((x)<<(PGSHIFT-DEV_BSHIFT))
+#define	dtoc(x)	((x)>>(PGSHIFT-DEV_BSHIFT))
+#define	dtob(x)	((x)<<DEV_BSHIFT)
+
+/* clicks to bytes */
+#define	ctob(x)	((x)<<PGSHIFT)
+
+/* bytes to clicks */
+#define	btoc(x)	(((unsigned)(x)+(NBPG-1))>>PGSHIFT)
+
+#ifdef __APPLE__
+#define  btodb(bytes, devBlockSize)         \
+        ((unsigned)(bytes) / devBlockSize)
+#define  dbtob(db, devBlockSize)            \
+        ((unsigned)(db) * devBlockSize)
+#else
+#define	btodb(bytes)	 		/* calculates (bytes / DEV_BSIZE) */ \
+	((unsigned)(bytes) >> DEV_BSHIFT)
+#define	dbtob(db)			/* calculates (db * DEV_BSIZE) */ \
+	((unsigned)(db) << DEV_BSHIFT)
+#endif
+
+/*
+ * Map a ``block device block'' to a file system block.
+ * This should be device dependent, and will be if we
+ * add an entry to cdevsw/bdevsw for that purpose.
+ * For now though just use DEV_BSIZE.
+ */
+#define	bdbtofsb(bn)	((bn) / (BLKDEV_IOSIZE/DEV_BSIZE))
+
+/*
+ * Macros to decode (and encode) processor status word.
+ */
+#define STATUS_WORD(rpl, ipl)	(((ipl) << 8) | (rpl))
+#define	USERMODE(x)		(((x) & 3) == 3)
+#define	BASEPRI(x)		(((x) & (255 << 8)) == 0)
+
+
+#if	defined(KERNEL) || defined(STANDALONE)
+#define	DELAY(n) delay(n)
+
+#else	/* defined(KERNEL) || defined(STANDALONE) */
+#define	DELAY(n)	{ register int N = (n); while (--N > 0); }
+#endif	/* defined(KERNEL) || defined(STANDALONE) */
+
+#endif /* _I386_PARAM_H_ */
diff -Nur cctools-877.5/include/i386/profile.h cctools-877.5-AnV/include/i386/profile.h
--- cctools-877.5/include/i386/profile.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/profile.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,39 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1997, Apple Computer, Inc. All rights reserved.
+ *
+ */
+
+#ifndef _BSD_I386_PROFILE_H_
+#define _BSD_I386_PROFILE_H_
+
+#include <sys/appleapiopts.h>
+
+
+#endif /* _BSD_I386_PROFILE_H_ */
diff -Nur cctools-877.5/include/i386/signal.h cctools-877.5-AnV/include/i386/signal.h
--- cctools-877.5/include/i386/signal.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/signal.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,44 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ */
+
+#ifndef	_I386_SIGNAL_H_
+#define	_I386_SIGNAL_H_ 1
+
+#include <sys/cdefs.h>
+
+#ifndef _ANSI_SOURCE
+typedef int sig_atomic_t; 
+
+#endif /* ! _ANSI_SOURCE */
+
+#endif	/* _I386_SIGNAL_H_ */
+
diff -Nur cctools-877.5/include/i386/types.h cctools-877.5-AnV/include/i386/types.h
--- cctools-877.5/include/i386/types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/types.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,114 @@
+/*
+ * Copyright (c) 2000-2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright 1995 NeXT Computer, Inc. All rights reserved.
+ */
+/*
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)types.h	8.3 (Berkeley) 1/5/94
+ */
+
+#ifndef	_MACHTYPES_H_
+#define	_MACHTYPES_H_
+
+#ifndef __ASSEMBLER__
+#include <i386/_types.h>
+#include <sys/cdefs.h>
+/*
+ * Basic integral types.  Omit the typedef if
+ * not possible for a machine/compiler combination.
+ */
+#include <sys/_types/_int8_t.h>
+#include <sys/_types/_int16_t.h>
+#include <sys/_types/_int32_t.h>
+#include <sys/_types/_int64_t.h>
+
+typedef	unsigned char		u_int8_t;
+typedef	unsigned short		u_int16_t;
+typedef	unsigned int		u_int32_t;
+typedef	unsigned long long	u_int64_t;
+
+#if __LP64__
+typedef int64_t			register_t;
+#else
+typedef int32_t			register_t;
+#endif
+
+#include <sys/_types/_intptr_t.h>
+#include <sys/_types/_uintptr_t.h>
+
+#if !defined(_ANSI_SOURCE) && (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+/* These types are used for reserving the largest possible size. */
+typedef u_int64_t		user_addr_t;	
+typedef u_int64_t		user_size_t;	
+typedef int64_t			user_ssize_t;
+typedef int64_t			user_long_t;
+typedef u_int64_t		user_ulong_t;
+typedef int64_t			user_time_t;
+typedef int64_t			user_off_t;
+#define USER_ADDR_NULL	((user_addr_t) 0)
+#define CAST_USER_ADDR_T(a_ptr)   ((user_addr_t)((uintptr_t)(a_ptr)))
+
+
+#endif /* !_ANSI_SOURCE && (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/* This defines the size of syscall arguments after copying into the kernel: */
+typedef u_int64_t		syscall_arg_t;
+
+#endif /* __ASSEMBLER__ */
+#endif	/* _MACHTYPES_H_ */
diff -Nur cctools-877.5/include/i386/user_ldt.h cctools-877.5-AnV/include/i386/user_ldt.h
--- cctools-877.5/include/i386/user_ldt.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/user_ldt.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,80 @@
+/*
+ * Copyright (c) 2000-2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon 
+ * the rights to redistribute these changes.
+ */
+
+/*
+ */
+
+#ifndef	_I386_USER_LDT_H_
+#define	_I386_USER_LDT_H_
+
+/*
+ * User LDT management.
+ *
+ * Each task may have its own LDT.
+ */
+
+#define	LDT_AUTO_ALLOC	0xffffffff
+
+#include <sys/cdefs.h>
+
+union ldt_entry;
+
+__BEGIN_DECLS
+int i386_get_ldt(int, union ldt_entry *, int);
+int i386_set_ldt(int, const union ldt_entry *, int);
+__END_DECLS
+
+#endif	/* _I386_USER_LDT_H_ */
diff -Nur cctools-877.5/include/i386/vmparam.h cctools-877.5-AnV/include/i386/vmparam.h
--- cctools-877.5/include/i386/vmparam.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/i386/vmparam.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,60 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef	_BSD_I386_VMPARAM_H_
+#define	_BSD_I386_VMPARAM_H_ 1
+
+#include <sys/resource.h>
+
+#define	USRSTACK	VM_USRSTACK32
+#define	USRSTACK64	VM_USRSTACK64
+
+
+/*
+ * Virtual memory related constants, all in bytes
+ */
+#ifndef DFLDSIZ
+#define	DFLDSIZ		(RLIM_INFINITY)		/* initial data size limit */
+#endif
+#ifndef MAXDSIZ
+#define	MAXDSIZ		(RLIM_INFINITY)		/* max data size */
+#endif
+#ifndef	DFLSSIZ
+#define	DFLSSIZ		(8*1024*1024)		/* initial stack size limit */
+#endif
+#ifndef	MAXSSIZ
+#define	MAXSSIZ		(64*1024*1024)		/* max stack size */
+#endif
+#ifndef	DFLCSIZ
+#define DFLCSIZ		(0)			/* initial core size limit */
+#endif
+#ifndef	MAXCSIZ
+#define MAXCSIZ		(RLIM_INFINITY)		/* max core size */
+#endif	/* MAXCSIZ */
+
+#endif	/* _BSD_I386_VMPARAM_H_ */
diff -Nur cctools-877.5/include/libc.h cctools-877.5-AnV/include/libc.h
--- cctools-877.5/include/libc.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libc.h	2015-11-19 09:21:18 +0000
@@ -0,0 +1,2 @@
+#define PATH_MAX 256
+#define MAXPATHLEN 256
diff -Nur cctools-877.5/include/libkern/OSAtomic.h cctools-877.5-AnV/include/libkern/OSAtomic.h
--- cctools-877.5/include/libkern/OSAtomic.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libkern/OSAtomic.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,852 @@
+/*
+ * Copyright (c) 2004-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OSATOMIC_H_
+#define _OSATOMIC_H_
+
+#include    <stddef.h>
+#include    <sys/cdefs.h>
+#include    <stdint.h>
+#include    <stdbool.h>
+
+#include    <Availability.h>
+
+/*! @header
+ * These are the preferred atomic and synchronization operations.
+ *
+ * Their implementation is customized at boot time for the platform, including
+ * late-breaking errata fixes as necessary. They are thread safe.
+ *
+ * WARNING: all addresses passed to these functions must be "naturally aligned",
+ * i.e.  * <code>int32_t</code> pointers must be 32-bit aligned (low 2 bits of
+ * address are zeroes), and <code>int64_t</code> pointers must be 64-bit aligned
+ * (low 3 bits of address are zeroes.)
+ *
+ * Note that some versions of the atomic functions incorporate memory barriers
+ * and some do not.  Barriers strictly order memory access on weakly-ordered
+ * architectures such as ARM.  All loads and stores that appear (in sequential
+ * program order) before the barrier are guaranteed to complete before any
+ * load or store that appears after the barrier.
+ *
+ * The barrier operation is typically a no-op on uniprocessor systems and
+ * fully enabled on multiprocessor systems. On some platforms, such as ARM,
+ * the barrier can be quite expensive.
+ *
+ * Most code should use the barrier functions to ensure that memory shared
+ * between threads is properly synchronized.  For example, if you want to
+ * initialize a shared data structure and then atomically increment a variable
+ * to indicate that the initialization is complete, you must use
+ * {@link OSAtomicIncrement32Barrier} to ensure that the stores to your data
+ * structure complete before the atomic increment.
+ *
+ * Likewise, the consumer of that data structure must use
+ * {@link OSAtomicDecrement32Barrier},
+ * in order to ensure that their loads of the structure are not executed before
+ * the atomic decrement.  On the other hand, if you are simply incrementing a
+ * global counter, then it is safe and potentially faster to use
+ * {@link OSAtomicIncrement32}.
+ *
+ * If you are unsure which version to use, prefer the barrier variants as they
+ * are safer.
+ *
+ * The spinlock and queue operations always incorporate a barrier.
+ *
+ * For the kernel-space version of this header, see
+ * {@link //apple_ref/doc/header/OSAtomic.h OSAtomic.h (Kernel Framework)}
+ *
+ * @apiuid //apple_ref/doc/header/user_space_OSAtomic.h
+ */ 
+__BEGIN_DECLS
+
+
+/*! @group Arithmetic functions
+    All functions in this group return the new value.
+ */
+
+/*! @abstract Atomically adds two 32-bit values.
+    @discussion
+	This function adds the value given by <code>__theAmount</code> to the
+	value in the memory location referenced by <code>__theValue</code>,
+ 	storing the result back to that memory location atomically.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+int32_t	OSAtomicAdd32( int32_t __theAmount, volatile int32_t *__theValue );
+
+
+/*! @abstract Atomically adds two 32-bit values.
+    @discussion
+	This function adds the value given by <code>__theAmount</code> to the
+	value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+
+	This function is equivalent to {@link OSAtomicAdd32}
+	except that it also introduces a barrier.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+int32_t	OSAtomicAdd32Barrier( int32_t __theAmount, volatile int32_t *__theValue );
+
+
+#if __IPHONE_OS_VERSION_MIN_REQUIRED >= __IPHONE_7_1
+
+/*! @abstract Atomically increments a 32-bit value.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_7_1)
+int32_t	OSAtomicIncrement32( volatile int32_t *__theValue );
+
+
+/*! @abstract Atomically increments a 32-bit value with a barrier.
+    @discussion
+	This function is equivalent to {@link OSAtomicIncrement32}
+	except that it also introduces a barrier.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_7_1)
+int32_t	OSAtomicIncrement32Barrier( volatile int32_t *__theValue );
+
+
+/*! @abstract Atomically decrements a 32-bit value.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_7_1)
+int32_t	OSAtomicDecrement32( volatile int32_t *__theValue );
+
+
+/*! @abstract Atomically decrements a 32-bit value with a barrier.
+    @discussion
+	This function is equivalent to {@link OSAtomicDecrement32}
+	except that it also introduces a barrier.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_7_1)
+int32_t	OSAtomicDecrement32Barrier( volatile int32_t *__theValue );
+
+#else
+__inline static
+int32_t	OSAtomicIncrement32( volatile int32_t *__theValue )
+            { return OSAtomicAdd32(  1, __theValue); }
+
+__inline static
+int32_t	OSAtomicIncrement32Barrier( volatile int32_t *__theValue )
+            { return OSAtomicAdd32Barrier(  1, __theValue); }
+
+__inline static
+int32_t	OSAtomicDecrement32( volatile int32_t *__theValue )
+            { return OSAtomicAdd32( -1, __theValue); }
+
+__inline static
+int32_t	OSAtomicDecrement32Barrier( volatile int32_t *__theValue )
+            { return OSAtomicAdd32Barrier( -1, __theValue); }
+#endif
+
+
+/*! @abstract Atomically adds two 64-bit values.
+    @discussion
+	This function adds the value given by <code>__theAmount</code> to the
+	value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+int64_t	OSAtomicAdd64( int64_t __theAmount, volatile int64_t *__theValue );
+
+
+/*! @abstract Atomically adds two 64-bit values with a barrier.
+    @discussion
+	This function adds the value given by <code>__theAmount</code> to the
+	value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+ 
+	This function is equivalent to {@link OSAtomicAdd64}
+	except that it also introduces a barrier.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_3_2)
+int64_t	OSAtomicAdd64Barrier( int64_t __theAmount, volatile int64_t *__theValue );
+
+
+#if __IPHONE_OS_VERSION_MIN_REQUIRED >= __IPHONE_7_1
+
+/*! @abstract Atomically increments a 64-bit value.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_7_1)
+int64_t	OSAtomicIncrement64( volatile int64_t *__theValue );
+
+
+/*! @abstract Atomically increments a 64-bit value with a barrier.
+    @discussion
+	This function is equivalent to {@link OSAtomicIncrement64}
+	except that it also introduces a barrier.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_7_1)
+int64_t	OSAtomicIncrement64Barrier( volatile int64_t *__theValue );
+
+
+/*! @abstract Atomically decrements a 64-bit value.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_7_1)
+int64_t	OSAtomicDecrement64( volatile int64_t *__theValue );
+
+
+/*! @abstract Atomically decrements a 64-bit value with a barrier.
+    @discussion
+	This function is equivalent to {@link OSAtomicDecrement64}
+	except that it also introduces a barrier.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_7_1)
+int64_t	OSAtomicDecrement64Barrier( volatile int64_t *__theValue );
+
+#else
+__inline static
+int64_t	OSAtomicIncrement64( volatile int64_t *__theValue )
+            { return OSAtomicAdd64(  1, __theValue); }
+
+__inline static
+int64_t	OSAtomicIncrement64Barrier( volatile int64_t *__theValue )
+            { return OSAtomicAdd64Barrier(  1, __theValue); }
+
+__inline static
+int64_t	OSAtomicDecrement64( volatile int64_t *__theValue )
+            { return OSAtomicAdd64( -1, __theValue); }
+
+__inline static
+int64_t	OSAtomicDecrement64Barrier( volatile int64_t *__theValue )
+            { return OSAtomicAdd64Barrier( -1, __theValue); }
+#endif
+
+
+/*! @group Boolean functions (AND, OR, XOR)
+ * 
+ * @discussion Functions in this group come in four variants for each operation:
+ * with and without barriers, and functions that return the original value or
+ * the result value of the operation.
+ * 
+ * The "Orig" versions return the original value, (before the operation); the non-Orig
+ * versions return the value after the operation.  All are layered on top of
+ * {@link OSAtomicCompareAndSwap32} and similar.
+ */
+
+/*! @abstract Atomic bitwise OR of two 32-bit values.
+    @discussion
+	This function performs the bitwise OR of the value given by <code>__theMask</code>
+	with the value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+int32_t	OSAtomicOr32( uint32_t __theMask, volatile uint32_t *__theValue );
+
+
+/*! @abstract Atomic bitwise OR of two 32-bit values with barrier.
+    @discussion
+	This function performs the bitwise OR of the value given by <code>__theMask</code>
+	with the value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+ 
+	This function is equivalent to {@link OSAtomicOr32}
+	except that it also introduces a barrier.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+int32_t	OSAtomicOr32Barrier( uint32_t __theMask, volatile uint32_t *__theValue );
+
+
+/*! @abstract Atomic bitwise OR of two 32-bit values returning original.
+    @discussion
+	This function performs the bitwise OR of the value given by <code>__theMask</code>
+	with the value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+    @result Returns the original value referenced by <code>__theValue</code>.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_3_2)
+int32_t	OSAtomicOr32Orig( uint32_t __theMask, volatile uint32_t *__theValue );
+
+
+/*! @abstract Atomic bitwise OR of two 32-bit values returning original with barrier.
+    @discussion
+	This function performs the bitwise OR of the value given by <code>__theMask</code>
+	with the value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+ 
+	This function is equivalent to {@link OSAtomicOr32Orig}
+	except that it also introduces a barrier.
+    @result Returns the original value referenced by <code>__theValue</code>.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_3_2)
+int32_t	OSAtomicOr32OrigBarrier( uint32_t __theMask, volatile uint32_t *__theValue );
+
+
+
+
+/*! @abstract Atomic bitwise AND of two 32-bit values.
+    @discussion
+	This function performs the bitwise AND of the value given by <code>__theMask</code>
+	with the value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+int32_t	OSAtomicAnd32( uint32_t __theMask, volatile uint32_t *__theValue );
+
+
+/*! @abstract Atomic bitwise AND of two 32-bit values with barrier.
+    @discussion
+	This function performs the bitwise AND of the value given by <code>__theMask</code>
+	with the value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+
+	This function is equivalent to {@link OSAtomicAnd32}
+	except that it also introduces a barrier.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+int32_t	OSAtomicAnd32Barrier( uint32_t __theMask, volatile uint32_t *__theValue ); 
+
+
+/*! @abstract Atomic bitwise AND of two 32-bit values returning original.
+    @discussion
+	This function performs the bitwise AND of the value given by <code>__theMask</code>
+	with the value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+    @result Returns the original value referenced by <code>__theValue</code>.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_3_2)
+int32_t	OSAtomicAnd32Orig( uint32_t __theMask, volatile uint32_t *__theValue );
+
+
+/*! @abstract Atomic bitwise AND of two 32-bit values returning original with barrier.
+    @discussion
+	This function performs the bitwise AND of the value given by <code>__theMask</code>
+	with the value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+
+	This function is equivalent to {@link OSAtomicAnd32Orig}
+	except that it also introduces a barrier.
+    @result Returns the original value referenced by <code>__theValue</code>.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_3_2)
+int32_t	OSAtomicAnd32OrigBarrier( uint32_t __theMask, volatile uint32_t *__theValue );
+
+
+
+
+/*! @abstract Atomic bitwise XOR of two 32-bit values.
+    @discussion
+	This function performs the bitwise XOR of the value given by <code>__theMask</code>
+	with the value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+int32_t	OSAtomicXor32( uint32_t __theMask, volatile uint32_t *__theValue );
+
+
+/*! @abstract Atomic bitwise XOR of two 32-bit values with barrier.
+    @discussion
+	This function performs the bitwise XOR of the value given by <code>__theMask</code>
+	with the value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+
+	This function is equivalent to {@link OSAtomicXor32}
+	except that it also introduces a barrier.
+    @result Returns the new value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+int32_t	OSAtomicXor32Barrier( uint32_t __theMask, volatile uint32_t *__theValue );
+
+
+/*! @abstract Atomic bitwise XOR of two 32-bit values returning original.
+    @discussion
+	This function performs the bitwise XOR of the value given by <code>__theMask</code>
+	with the value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+    @result Returns the original value referenced by <code>__theValue</code>.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_3_2)
+int32_t	OSAtomicXor32Orig( uint32_t __theMask, volatile uint32_t *__theValue );
+
+
+/*! @abstract Atomic bitwise XOR of two 32-bit values returning original with barrier.
+    @discussion
+	This function performs the bitwise XOR of the value given by <code>__theMask</code>
+	with the value in the memory location referenced by <code>__theValue</code>,
+	storing the result back to that memory location atomically.
+
+	This function is equivalent to {@link OSAtomicXor32Orig}
+	except that it also introduces a barrier.
+    @result Returns the original value referenced by <code>__theValue</code>.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_3_2)
+int32_t	OSAtomicXor32OrigBarrier( uint32_t __theMask, volatile uint32_t *__theValue );
+ 
+
+/*! @group Compare and swap
+ * Functions in this group return true if the swap occured.  There are several versions,
+ * depending on data type and on whether or not a barrier is used.
+ */
+
+
+/*! @abstract Compare and swap for 32-bit values.
+    @discussion
+	This function compares the value in <code>__oldValue</code> to the value
+	in the memory location referenced by <code>__theValue</code>.  If the values
+	match, this function stores the value from <code>__newValue</code> into
+	that memory location atomically.
+    @result Returns TRUE on a match, FALSE otherwise.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+bool    OSAtomicCompareAndSwap32( int32_t __oldValue, int32_t __newValue, volatile int32_t *__theValue );
+
+
+/*! @abstract Compare and swap for 32-bit values with barrier.
+    @discussion
+	This function compares the value in <code>__oldValue</code> to the value
+	in the memory location referenced by <code>__theValue</code>.  If the values
+	match, this function stores the value from <code>__newValue</code> into
+	that memory location atomically.
+
+	This function is equivalent to {@link OSAtomicCompareAndSwap32}
+	except that it also introduces a barrier.
+    @result Returns TRUE on a match, FALSE otherwise.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+bool    OSAtomicCompareAndSwap32Barrier( int32_t __oldValue, int32_t __newValue, volatile int32_t *__theValue );
+
+
+/*! @abstract Compare and swap pointers.
+    @discussion
+	This function compares the pointer stored in <code>__oldValue</code> to the pointer
+	in the memory location referenced by <code>__theValue</code>.  If the pointers
+	match, this function stores the pointer from <code>__newValue</code> into
+	that memory location atomically.
+    @result Returns TRUE on a match, FALSE otherwise.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0)
+bool	OSAtomicCompareAndSwapPtr( void *__oldValue, void *__newValue, void * volatile *__theValue );
+
+
+/*! @abstract Compare and swap pointers with barrier.
+    @discussion
+	This function compares the pointer stored in <code>__oldValue</code> to the pointer
+	in the memory location referenced by <code>__theValue</code>.  If the pointers
+	match, this function stores the pointer from <code>__newValue</code> into
+	that memory location atomically.
+
+	This function is equivalent to {@link OSAtomicCompareAndSwapPtr}
+	except that it also introduces a barrier.
+    @result Returns TRUE on a match, FALSE otherwise.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0)
+bool	OSAtomicCompareAndSwapPtrBarrier( void *__oldValue, void *__newValue, void * volatile *__theValue );
+
+
+/*! @abstract Compare and swap for <code>int</code> values.
+    @discussion
+	This function compares the value in <code>__oldValue</code> to the value
+	in the memory location referenced by <code>__theValue</code>.  If the values
+	match, this function stores the value from <code>__newValue</code> into
+	that memory location atomically.
+
+	This function is equivalent to {@link OSAtomicCompareAndSwap32}.
+    @result Returns TRUE on a match, FALSE otherwise.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0)
+bool	OSAtomicCompareAndSwapInt( int __oldValue, int __newValue, volatile int *__theValue );
+
+
+/*! @abstract Compare and swap for <code>int</code> values.
+    @discussion
+	This function compares the value in <code>__oldValue</code> to the value
+	in the memory location referenced by <code>__theValue</code>.  If the values
+	match, this function stores the value from <code>__newValue</code> into
+	that memory location atomically.
+
+	This function is equivalent to {@link OSAtomicCompareAndSwapInt}
+	except that it also introduces a barrier.
+
+	This function is equivalent to {@link OSAtomicCompareAndSwap32Barrier}.
+    @result Returns TRUE on a match, FALSE otherwise.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0)
+bool	OSAtomicCompareAndSwapIntBarrier( int __oldValue, int __newValue, volatile int *__theValue );
+
+
+/*! @abstract Compare and swap for <code>long</code> values.
+    @discussion
+	This function compares the value in <code>__oldValue</code> to the value
+	in the memory location referenced by <code>__theValue</code>.  If the values
+	match, this function stores the value from <code>__newValue</code> into
+	that memory location atomically.
+
+	This function is equivalent to {@link OSAtomicCompareAndSwap32} on 32-bit architectures, 
+	or {@link OSAtomicCompareAndSwap64} on 64-bit architectures.
+    @result Returns TRUE on a match, FALSE otherwise.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0)
+bool	OSAtomicCompareAndSwapLong( long __oldValue, long __newValue, volatile long *__theValue );
+
+
+/*! @abstract Compare and swap for <code>long</code> values.
+    @discussion
+	This function compares the value in <code>__oldValue</code> to the value
+	in the memory location referenced by <code>__theValue</code>.  If the values
+	match, this function stores the value from <code>__newValue</code> into
+	that memory location atomically.
+
+	This function is equivalent to {@link OSAtomicCompareAndSwapLong}
+	except that it also introduces a barrier.
+
+	This function is equivalent to {@link OSAtomicCompareAndSwap32} on 32-bit architectures, 
+	or {@link OSAtomicCompareAndSwap64} on 64-bit architectures.
+    @result Returns TRUE on a match, FALSE otherwise.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0)
+bool	OSAtomicCompareAndSwapLongBarrier( long __oldValue, long __newValue, volatile long *__theValue );
+
+
+/*! @abstract Compare and swap for <code>uint64_t</code> values.
+    @discussion
+	This function compares the value in <code>__oldValue</code> to the value
+	in the memory location referenced by <code>__theValue</code>.  If the values
+	match, this function stores the value from <code>__newValue</code> into
+	that memory location atomically.
+    @result Returns TRUE on a match, FALSE otherwise.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+bool    OSAtomicCompareAndSwap64( int64_t __oldValue, int64_t __newValue, volatile int64_t *__theValue );
+
+
+/*! @abstract Compare and swap for <code>uint64_t</code> values.
+    @discussion
+	This function compares the value in <code>__oldValue</code> to the value
+	in the memory location referenced by <code>__theValue</code>.  If the values
+	match, this function stores the value from <code>__newValue</code> into
+	that memory location atomically.
+
+	This function is equivalent to {@link OSAtomicCompareAndSwap64}
+	except that it also introduces a barrier.
+    @result Returns TRUE on a match, FALSE otherwise.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_3_2)
+bool    OSAtomicCompareAndSwap64Barrier( int64_t __oldValue, int64_t __newValue, volatile int64_t *__theValue );
+
+
+/* Test and set.
+ * They return the original value of the bit, and operate on bit (0x80>>(n&7))
+ * in byte ((char*)theAddress + (n>>3)).
+ */
+/*! @abstract Atomic test and set
+    @discussion
+	This function tests a bit in the value referenced by
+	<code>__theAddress</code> and if it is not set, sets it.
+
+	The bit is chosen by the value of <code>__n</code> such that the
+	operation will be performed on bit <code>(0x80 >> (__n & 7))</code>
+	of byte <code>((char *)__theAddress + (n >> 3))</code>.
+
+	For example, if <code>__theAddress</code> points to a 64-bit value,
+	to compare the value of the most significant bit, you would specify
+	<code>56</code> for <code>__n</code>.
+    @result
+	Returns the original value of the bit being tested.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+bool    OSAtomicTestAndSet( uint32_t __n, volatile void *__theAddress );
+
+
+/*! @abstract Atomic test and set with barrier
+    @discussion
+	This function tests a bit in the value referenced by <code>__theAddress</code>
+	and if it is not set, sets it.
+
+	The bit is chosen by the value of <code>__n</code> such that the
+	operation will be performed on bit <code>(0x80 >> (__n & 7))</code>
+	of byte <code>((char *)__theAddress + (n >> 3))</code>.
+
+	For example, if <code>__theAddress</code> points to a 64-bit value,
+	to compare the value of the most significant bit, you would specify
+	<code>56</code> for <code>__n</code>.
+
+	This function is equivalent to {@link OSAtomicTestAndSet}
+	except that it also introduces a barrier.
+    @result
+	Returns the original value of the bit being tested.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+bool    OSAtomicTestAndSetBarrier( uint32_t __n, volatile void *__theAddress );
+
+
+
+/*! @abstract Atomic test and clear
+    @discussion
+	This function tests a bit in the value referenced by <code>__theAddress</code>
+	and if it is not cleared, clears it.
+
+	The bit is chosen by the value of <code>__n</code> such that the
+	operation will be performed on bit <code>(0x80 >> (__n & 7))</code>
+	of byte <code>((char *)__theAddress + (n >> 3))</code>.
+
+	For example, if <code>__theAddress</code> points to a 64-bit value,
+	to compare the value of the most significant bit, you would specify
+	<code>56</code> for <code>__n</code>.
+ 
+    @result
+	Returns the original value of the bit being tested.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+bool    OSAtomicTestAndClear( uint32_t __n, volatile void *__theAddress );
+
+
+/*! @abstract Atomic test and clear
+    @discussion
+	This function tests a bit in the value referenced by <code>__theAddress</code>
+	and if it is not cleared, clears it.
+ 
+	The bit is chosen by the value of <code>__n</code> such that the
+	operation will be performed on bit <code>(0x80 >> (__n & 7))</code>
+	of byte <code>((char *)__theAddress + (n >> 3))</code>.
+ 
+	For example, if <code>__theAddress</code> points to a 64-bit value,
+	to compare the value of the most significant bit, you would specify
+	<code>56</code> for <code>__n</code>.
+ 
+	This function is equivalent to {@link OSAtomicTestAndSet}
+	except that it also introduces a barrier.
+    @result
+	Returns the original value of the bit being tested.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+bool    OSAtomicTestAndClearBarrier( uint32_t __n, volatile void *__theAddress );
+ 
+
+/*! @group Spinlocks
+ * These spinlocks use memory barriers as required to synchronize access to shared
+ * memory protected by the lock.
+ */
+
+/*! @abstract The default value for an <code>OSSpinLock</code>.
+    @discussion
+	The convention is that unlocked is zero, locked is nonzero.
+ */
+#define	OS_SPINLOCK_INIT    0
+
+
+/*! @abstract Data type for a spinlock.
+    @discussion
+	You should always initialize a spinlock to {@link OS_SPINLOCK_INIT} before
+	using it.
+ */
+typedef int32_t OSSpinLock;
+
+
+/*! @abstract Locks a spinlock if it would not block
+    @result
+	Returns <code>false</code> if the lock was already held by another thread,
+	<code>true</code> if it took the lock successfully. 
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+bool    OSSpinLockTry( volatile OSSpinLock *__lock );
+
+
+/*! @abstract Locks a spinlock
+    @discussion
+	Although the lock operation spins, it employs various strategies
+        to back off if the lock is held, making it immune to most priority-inversion
+	livelocks.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+void    OSSpinLockLock( volatile OSSpinLock *__lock );
+
+
+/*! @abstract Unlocks a spinlock */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+void    OSSpinLockUnlock( volatile OSSpinLock *__lock );
+
+
+/*! @group Lockless atomic enqueue and dequeue
+ * These routines manipulate singly-linked LIFO lists.
+ */
+
+/*! @abstract The data structure for a queue head.
+    @discussion
+	You should always initialize a queue head structure with the
+	initialization vector {@link OS_ATOMIC_QUEUE_INIT} before use.
+ */
+#if defined(__x86_64__)
+
+typedef volatile struct {
+	void	*opaque1;
+	long	 opaque2;
+} __attribute__ ((aligned (16))) OSQueueHead;
+
+#else
+
+typedef volatile struct {
+	void	*opaque1;
+	long	 opaque2;
+} OSQueueHead;
+
+#endif
+
+/*! @abstract The initialization vector for a queue head. */
+#define	OS_ATOMIC_QUEUE_INIT	{ NULL, 0 }
+
+/*! @abstract Enqueue an item onto a list.
+    @discussion
+	Memory barriers are incorporated as needed to permit thread-safe access
+	to the queue element.
+    @param __list
+	The list on which you want to enqueue the item.
+    @param __new
+	The item to add.
+    @param __offset
+	The "offset" parameter is the offset (in bytes) of the link field
+	from the beginning of the data structure being queued (<code>__new</code>).
+	The link field should be a pointer type.
+	The <code>__offset</code> value needs to be same for all enqueuing and
+	dequeuing operations on the same queue, even if different structure types
+	are enqueued on that queue.  The use of <code>offsetset()</code>, defined in
+	<code>stddef.h</code> is the common way to specify the <code>__offset</code>
+	value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_4_0)
+void  OSAtomicEnqueue( OSQueueHead *__list, void *__new, size_t __offset);
+
+
+/*! @abstract Dequeue an item from a list.
+    @discussion
+	Memory barriers are incorporated as needed to permit thread-safe access
+	to the queue element.
+    @param __list
+	The list on which you want to enqueue the item.
+    @param __offset
+	The "offset" parameter is the offset (in bytes) of the link field
+	from the beginning of the data structure being queued (<code>__new</code>).
+	The link field should be a pointer type.
+	The <code>__offset</code> value needs to be same for all enqueuing and
+	dequeuing operations on the same queue, even if different structure types
+	are enqueued on that queue.  The use of <code>offsetset()</code>, defined in
+	<code>stddef.h</code> is the common way to specify the <code>__offset</code>
+	value.
+    @result
+	Returns the most recently enqueued element, or <code>NULL</code> if the
+	list is empty.  
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_4_0)
+void* OSAtomicDequeue( OSQueueHead *__list, size_t __offset);
+
+#if defined(__x86_64__) || defined(__i386__)
+
+/*! @group Lockless atomic fifo enqueue and dequeue
+ * These routines manipulate singly-linked FIFO lists.
+ */
+
+/*! @abstract The data structure for a fifo queue head.
+    @discussion
+	You should always initialize a fifo queue head structure with the
+	initialization vector {@link OS_ATOMIC_FIFO_QUEUE_INIT} before use.
+ */
+#if defined(__x86_64__)
+
+typedef	volatile struct {
+	void	*opaque1;
+	void	*opaque2;
+	int	 opaque3;
+} __attribute__ ((aligned (16))) OSFifoQueueHead;
+
+#else
+
+typedef	volatile struct {
+	void	*opaque1;
+	void	*opaque2;
+	int	 opaque3;
+} OSFifoQueueHead;
+
+#endif
+
+/*! @abstract The initialization vector for a fifo queue head. */
+#define OS_ATOMIC_FIFO_QUEUE_INIT   { NULL, NULL, 0 }
+
+/*! @abstract Enqueue an item onto a list.
+    @discussion
+	Memory barriers are incorporated as needed to permit thread-safe access
+	to the queue element.
+    @param __list
+	The list on which you want to enqueue the item.
+    @param __new
+	The item to add.
+    @param __offset
+	The "offset" parameter is the offset (in bytes) of the link field
+	from the beginning of the data structure being queued (<code>__new</code>).
+	The link field should be a pointer type.
+	The <code>__offset</code> value needs to be same for all enqueuing and
+	dequeuing operations on the same queue, even if different structure types
+	are enqueued on that queue.  The use of <code>offsetset()</code>, defined in
+	<code>stddef.h</code> is the common way to specify the <code>__offset</code>
+	value.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_NA)
+void  OSAtomicFifoEnqueue( OSFifoQueueHead *__list, void *__new, size_t __offset);
+
+/*! @abstract Dequeue an item from a list.
+    @discussion
+	Memory barriers are incorporated as needed to permit thread-safe access
+	to the queue element.
+    @param __list
+	The list on which you want to enqueue the item.
+    @param __offset
+	The "offset" parameter is the offset (in bytes) of the link field
+	from the beginning of the data structure being queued (<code>__new</code>).
+	The link field should be a pointer type.
+	The <code>__offset</code> value needs to be same for all enqueuing and
+	dequeuing operations on the same queue, even if different structure types
+	are enqueued on that queue.  The use of <code>offsetset()</code>, defined in
+	<code>stddef.h</code> is the common way to specify the <code>__offset</code>
+	value.
+    @result
+	Returns the oldest enqueued element, or <code>NULL</code> if the
+	list is empty.  
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_NA)
+void* OSAtomicFifoDequeue( OSFifoQueueHead *__list, size_t __offset);
+
+#endif /* __i386__ || __x86_64__ */
+
+/*! @group Memory barriers */
+
+/*! @abstract Memory barrier.
+    @discussion
+	This function serves as both a read and write barrier.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0)
+void    OSMemoryBarrier( void );
+
+__END_DECLS
+
+#endif /* _OSATOMIC_H_ */
diff -Nur cctools-877.5/include/libkern/OSByteOrder.h cctools-877.5-AnV/include/libkern/OSByteOrder.h
--- cctools-877.5/include/libkern/OSByteOrder.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libkern/OSByteOrder.h	2015-11-19 09:14:34 +0000
@@ -0,0 +1,308 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OS_OSBYTEORDER_H
+#define _OS_OSBYTEORDER_H
+
+#include <stdint.h>
+#include <libkern/_OSByteOrder.h>
+
+/* Macros for swapping constant values in the preprocessing stage. */
+#define OSSwapConstInt16(x)	__DARWIN_OSSwapConstInt16(x)
+#define OSSwapConstInt32(x)	__DARWIN_OSSwapConstInt32(x)
+#define OSSwapConstInt64(x)	__DARWIN_OSSwapConstInt64(x)
+
+#if defined(__GNUC__)
+
+#if (defined(__i386__) || defined(__x86_64__))
+#include <libkern/i386/OSByteOrder.h>
+#define __LITTLE_ENDIAN__ 1
+#else
+#include <libkern/machine/OSByteOrder.h>
+#define __BIG_ENDIAN__ 1
+#endif
+
+#else /* ! __GNUC__ */
+
+#include <libkern/machine/OSByteOrder.h>
+
+#endif /* __GNUC__ */
+
+#define OSSwapInt16(x)	__DARWIN_OSSwapInt16(x)
+#define OSSwapInt32(x)	__DARWIN_OSSwapInt32(x)
+#define OSSwapInt64(x)	__DARWIN_OSSwapInt64(x)
+
+enum {
+    OSUnknownByteOrder,
+    OSLittleEndian,
+    OSBigEndian
+};
+
+OS_INLINE
+int32_t
+OSHostByteOrder(void) {
+#if defined(__LITTLE_ENDIAN__)
+    return OSLittleEndian;
+#elif defined(__BIG_ENDIAN__)
+    return OSBigEndian;
+#else
+    return OSUnknownByteOrder;
+#endif
+}
+
+#define OSReadBigInt(x, y)		OSReadBigInt32(x, y)
+#define OSWriteBigInt(x, y, z)		OSWriteBigInt32(x, y, z)
+#define OSSwapBigToHostInt(x)		OSSwapBigToHostInt32(x)
+#define OSSwapHostToBigInt(x)		OSSwapHostToBigInt32(x)
+#define OSReadLittleInt(x, y)		OSReadLittleInt32(x, y)
+#define OSWriteLittleInt(x, y, z)	OSWriteLittleInt32(x, y, z)
+#define OSSwapHostToLittleInt(x)	OSSwapHostToLittleInt32(x)
+#define OSSwapLittleToHostInt(x)	OSSwapLittleToHostInt32(x)
+
+/* Functions for loading native endian values. */
+
+OS_INLINE
+uint16_t
+_OSReadInt16(
+    const volatile void               * base,
+    uintptr_t                     byteOffset
+)
+{
+    return *(volatile uint16_t *)((uintptr_t)base + byteOffset);
+}
+
+OS_INLINE
+uint32_t
+_OSReadInt32(
+    const volatile void               * base,
+    uintptr_t                     byteOffset
+)
+{
+    return *(volatile uint32_t *)((uintptr_t)base + byteOffset);
+}
+
+OS_INLINE
+uint64_t
+_OSReadInt64(
+    const volatile void               * base,
+    uintptr_t                     byteOffset
+)
+{
+    return *(volatile uint64_t *)((uintptr_t)base + byteOffset);
+}
+
+/* Functions for storing native endian values. */
+
+OS_INLINE
+void
+_OSWriteInt16(
+    volatile void               * base,
+    uintptr_t                     byteOffset,
+    uint16_t                      data
+)
+{
+    *(volatile uint16_t *)((uintptr_t)base + byteOffset) = data;
+}
+
+OS_INLINE
+void
+_OSWriteInt32(
+    volatile void               * base,
+    uintptr_t                     byteOffset,
+    uint32_t                      data
+)
+{
+    *(volatile uint32_t *)((uintptr_t)base + byteOffset) = data;
+}
+
+OS_INLINE
+void
+_OSWriteInt64(
+    volatile void               * base,
+    uintptr_t                     byteOffset,
+    uint64_t                      data
+)
+{
+    *(volatile uint64_t *)((uintptr_t)base + byteOffset) = data;
+}
+
+#if		defined(__BIG_ENDIAN__)
+
+/* Functions for loading big endian to host endianess. */
+
+#define OSReadBigInt16(base, byteOffset) _OSReadInt16(base, byteOffset)
+#define OSReadBigInt32(base, byteOffset) _OSReadInt32(base, byteOffset)
+#define OSReadBigInt64(base, byteOffset) _OSReadInt64(base, byteOffset)
+
+/* Functions for storing host endianess to big endian. */
+
+#define OSWriteBigInt16(base, byteOffset, data) _OSWriteInt16(base, byteOffset, data)
+#define OSWriteBigInt32(base, byteOffset, data) _OSWriteInt32(base, byteOffset, data)
+#define OSWriteBigInt64(base, byteOffset, data) _OSWriteInt64(base, byteOffset, data)
+
+/* Functions for loading little endian to host endianess. */
+
+#define OSReadLittleInt16(base, byteOffset) OSReadSwapInt16(base, byteOffset)
+#define OSReadLittleInt32(base, byteOffset) OSReadSwapInt32(base, byteOffset)
+#define OSReadLittleInt64(base, byteOffset) OSReadSwapInt64(base, byteOffset)
+
+/* Functions for storing host endianess to little endian. */
+
+#define OSWriteLittleInt16(base, byteOffset, data) OSWriteSwapInt16(base, byteOffset, data)
+#define OSWriteLittleInt32(base, byteOffset, data) OSWriteSwapInt32(base, byteOffset, data)
+#define OSWriteLittleInt64(base, byteOffset, data) OSWriteSwapInt64(base, byteOffset, data)
+
+/* Host endianess to big endian byte swapping macros for constants. */
+
+#define OSSwapHostToBigConstInt16(x) ((uint16_t)(x))
+#define OSSwapHostToBigConstInt32(x) ((uint32_t)(x))
+#define OSSwapHostToBigConstInt64(x) ((uint64_t)(x))
+
+/* Generic host endianess to big endian byte swapping functions. */
+
+#define OSSwapHostToBigInt16(x) ((uint16_t)(x))
+#define OSSwapHostToBigInt32(x) ((uint32_t)(x))
+#define OSSwapHostToBigInt64(x) ((uint64_t)(x))
+
+/* Host endianess to little endian byte swapping macros for constants. */
+
+#define OSSwapHostToLittleConstInt16(x) OSSwapConstInt16(x)
+#define OSSwapHostToLittleConstInt32(x) OSSwapConstInt32(x) 
+#define OSSwapHostToLittleConstInt64(x) OSSwapConstInt64(x) 
+
+/* Generic host endianess to little endian byte swapping functions. */
+
+#define OSSwapHostToLittleInt16(x) OSSwapInt16(x)
+#define OSSwapHostToLittleInt32(x) OSSwapInt32(x)
+#define OSSwapHostToLittleInt64(x) OSSwapInt64(x)
+
+/* Big endian to host endianess byte swapping macros for constants. */
+    
+#define OSSwapBigToHostConstInt16(x) ((uint16_t)(x))
+#define OSSwapBigToHostConstInt32(x) ((uint32_t)(x))
+#define OSSwapBigToHostConstInt64(x) ((uint64_t)(x))
+
+/* Generic big endian to host endianess byte swapping functions. */
+
+#define OSSwapBigToHostInt16(x) ((uint16_t)(x))
+#define OSSwapBigToHostInt32(x) ((uint32_t)(x))
+#define OSSwapBigToHostInt64(x) ((uint64_t)(x))
+
+/* Little endian to host endianess byte swapping macros for constants. */
+   
+#define OSSwapLittleToHostConstInt16(x) OSSwapConstInt16(x)
+#define OSSwapLittleToHostConstInt32(x) OSSwapConstInt32(x)
+#define OSSwapLittleToHostConstInt64(x) OSSwapConstInt64(x)
+
+/* Generic little endian to host endianess byte swapping functions. */
+
+#define OSSwapLittleToHostInt16(x) OSSwapInt16(x)
+#define OSSwapLittleToHostInt32(x) OSSwapInt32(x)
+#define OSSwapLittleToHostInt64(x) OSSwapInt64(x)
+
+#elif		defined(__LITTLE_ENDIAN__)
+
+/* Functions for loading big endian to host endianess. */
+
+#define OSReadBigInt16(base, byteOffset) OSReadSwapInt16(base, byteOffset)
+#define OSReadBigInt32(base, byteOffset) OSReadSwapInt32(base, byteOffset)
+#define OSReadBigInt64(base, byteOffset) OSReadSwapInt64(base, byteOffset)
+
+/* Functions for storing host endianess to big endian. */
+
+#define OSWriteBigInt16(base, byteOffset, data) OSWriteSwapInt16(base, byteOffset, data)
+#define OSWriteBigInt32(base, byteOffset, data) OSWriteSwapInt32(base, byteOffset, data)
+#define OSWriteBigInt64(base, byteOffset, data) OSWriteSwapInt64(base, byteOffset, data)
+
+/* Functions for loading little endian to host endianess. */
+
+#define OSReadLittleInt16(base, byteOffset) _OSReadInt16(base, byteOffset)
+#define OSReadLittleInt32(base, byteOffset) _OSReadInt32(base, byteOffset)
+#define OSReadLittleInt64(base, byteOffset) _OSReadInt64(base, byteOffset)
+
+/* Functions for storing host endianess to little endian. */
+
+#define OSWriteLittleInt16(base, byteOffset, data) _OSWriteInt16(base, byteOffset, data)
+#define OSWriteLittleInt32(base, byteOffset, data) _OSWriteInt32(base, byteOffset, data)
+#define OSWriteLittleInt64(base, byteOffset, data) _OSWriteInt64(base, byteOffset, data)
+
+/* Host endianess to big endian byte swapping macros for constants. */
+
+#define OSSwapHostToBigConstInt16(x) OSSwapConstInt16(x)
+#define OSSwapHostToBigConstInt32(x) OSSwapConstInt32(x)
+#define OSSwapHostToBigConstInt64(x) OSSwapConstInt64(x)
+
+/* Generic host endianess to big endian byte swapping functions. */
+
+#define OSSwapHostToBigInt16(x) OSSwapInt16(x)
+#define OSSwapHostToBigInt32(x) OSSwapInt32(x)
+#define OSSwapHostToBigInt64(x) OSSwapInt64(x)
+
+/* Host endianess to little endian byte swapping macros for constants. */
+
+#define OSSwapHostToLittleConstInt16(x) ((uint16_t)(x))
+#define OSSwapHostToLittleConstInt32(x) ((uint32_t)(x))
+#define OSSwapHostToLittleConstInt64(x) ((uint64_t)(x)) 
+
+/* Generic host endianess to little endian byte swapping functions. */
+
+#define OSSwapHostToLittleInt16(x) ((uint16_t)(x))
+#define OSSwapHostToLittleInt32(x) ((uint32_t)(x))
+#define OSSwapHostToLittleInt64(x) ((uint64_t)(x))
+
+/* Big endian to host endianess byte swapping macros for constants. */
+
+#define OSSwapBigToHostConstInt16(x) OSSwapConstInt16(x)
+#define OSSwapBigToHostConstInt32(x) OSSwapConstInt32(x)
+#define OSSwapBigToHostConstInt64(x) OSSwapConstInt64(x)
+
+/* Generic big endian to host endianess byte swapping functions. */
+
+#define OSSwapBigToHostInt16(x) OSSwapInt16(x)
+#define OSSwapBigToHostInt32(x) OSSwapInt32(x)
+#define OSSwapBigToHostInt64(x) OSSwapInt64(x)
+
+/* Little endian to host endianess byte swapping macros for constants. */
+
+#define OSSwapLittleToHostConstInt16(x) ((uint16_t)(x))
+#define OSSwapLittleToHostConstInt32(x) ((uint32_t)(x))
+#define OSSwapLittleToHostConstInt64(x) ((uint64_t)(x))
+
+/* Generic little endian to host endianess byte swapping functions. */
+
+#define OSSwapLittleToHostInt16(x) ((uint16_t)(x))
+#define OSSwapLittleToHostInt32(x) ((uint32_t)(x))
+#define OSSwapLittleToHostInt64(x) ((uint64_t)(x))
+
+#else
+#error Unknown endianess.
+#endif
+
+#endif /* ! _OS_OSBYTEORDER_H */
+
+
diff -Nur cctools-877.5/include/libkern/OSCacheControl.h cctools-877.5-AnV/include/libkern/OSCacheControl.h
--- cctools-877.5/include/libkern/OSCacheControl.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libkern/OSCacheControl.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,66 @@
+/*
+ * Copyright (c) 2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OS_CACHE_CONTROL_H_
+#define _OS_CACHE_CONTROL_H_
+
+#include    <stddef.h>
+#include    <sys/cdefs.h>
+#include    <stdint.h>
+#include    <Availability.h>
+
+__BEGIN_DECLS
+
+
+/* Functions performed by sys_cache_control(): */
+
+/* Prepare memory for execution.  This should be called
+ * after writing machine instructions to memory, before
+ * executing them.  It syncs the dcache and icache.
+ * On IA32 processors this function is a NOP, because
+ * no synchronization is required.
+ */
+#define	kCacheFunctionPrepareForExecution	1
+
+/* Flush data cache(s).  This ensures that cached data 
+ * makes it all the way out to DRAM, and then removes
+ * copies of the data from all processor caches.
+ * It can be useful when dealing with cache incoherent
+ * devices or DMA.
+ */
+#define	kCacheFunctionFlushDcache	2
+
+
+/* perform one of the above cache functions: */
+int	sys_cache_control( int function, void *start, size_t len);
+ 
+/* equivalent to sys_cache_control(kCacheFunctionPrepareForExecution): */
+void	sys_icache_invalidate( void *start, size_t len);
+
+/* equivalent to sys_cache_control(kCacheFunctionFlushDcache): */
+void	sys_dcache_flush( void *start, size_t len) __OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0);
+
+
+__END_DECLS
+
+#endif /* _OS_CACHE_CONTROL_H_ */
diff -Nur cctools-877.5/include/libkern/OSDebug.h cctools-877.5-AnV/include/libkern/OSDebug.h
--- cctools-877.5/include/libkern/OSDebug.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libkern/OSDebug.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,69 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1999 Apple Computer, Inc.  All rights reserved.
+ *
+ * HISTORY
+ *
+ */
+
+#ifndef _OS_OSDEBBUG_H
+#define _OS_OSDEBBUG_H
+
+#include <sys/cdefs.h>
+#include <mach/mach_types.h>
+
+__BEGIN_DECLS
+
+extern int log_leaks;
+
+/* Use kernel_debug() to log a backtrace */ 
+extern void trace_backtrace(unsigned int debugid, unsigned int debugid2, unsigned long size, unsigned long data);
+/* Report a message with a 4 entry backtrace - very slow */
+extern void OSReportWithBacktrace(const char *str, ...);
+extern unsigned OSBacktrace(void **bt, unsigned maxAddrs);
+
+/* Simple dump of 20 backtrace entries */
+extern void OSPrintBacktrace(void);
+
+/*! @function OSKernelStackRemaining
+    @abstract Returns bytes available below the current stack frame.
+    @discussion Returns bytes available below the current stack frame. Safe for interrupt or thread context.
+    @result Approximate byte count available. */
+
+vm_offset_t OSKernelStackRemaining( void );
+
+__END_DECLS
+
+#define TRACE_MACHLEAKS(a,b,c,d)	\
+do {					\
+    if (log_leaks)			\
+        trace_backtrace(a,b,c,d);	\
+} while(0)
+
+#endif /* !_OS_OSDEBBUG_H */
diff -Nur cctools-877.5/include/libkern/OSKextLib.h cctools-877.5-AnV/include/libkern/OSKextLib.h
--- cctools-877.5/include/libkern/OSKextLib.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libkern/OSKextLib.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,475 @@
+/*
+ * Copyright (c) 2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ *
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ *
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ *
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _LIBKERN_OSKEXTLIB_H
+#define _LIBKERN_OSKEXTLIB_H
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+#include <stdint.h>
+#include <mach/kmod.h>
+#include <mach/vm_types.h>
+
+#include <CoreFoundation/CoreFoundation.h>
+#include <System/libkern/OSReturn.h>
+
+/*!
+ * @header
+ *
+ * Declares functions, basic return values, and other constants
+ * related to kernel extensions (kexts).
+ */
+
+#if PRAGMA_MARK
+#pragma mark -
+/********************************************************************/
+#pragma mark OSReturn Values for Kernel Extensions
+/********************************************************************/
+#endif
+/*!
+ * @group OSReturn Values for Kernel Extensions
+ * Many kext-related functions return these values,
+ * as well as those defined under
+ * <code>@link //apple_ref/c/tdef/OSReturn OSReturn@/link</code>
+ * and other variants of <code>kern_return_t</code>.
+ */
+
+
+#define sub_libkern_kext           err_sub(2)
+#define libkern_kext_err(code)     (sys_libkern|sub_libkern_kext|(code))
+
+
+/*!
+ * @define   kOSKextReturnInternalError
+ * @abstract An internal error in the kext library.
+ *           Contrast with <code>@link //apple_ref/c/econst/OSReturnError
+ *           OSReturnError@/link</code>.
+ */
+#define kOSKextReturnInternalError                   libkern_kext_err(0x1)
+
+/*!
+ * @define   kOSKextReturnNoMemory
+ * @abstract Memory allocation failed.
+ */
+#define kOSKextReturnNoMemory                        libkern_kext_err(0x2)
+
+/*!
+ * @define   kOSKextReturnNoResources
+ * @abstract Some resource other than memory (such as available load tags)
+ *           is exhausted.
+ */
+#define kOSKextReturnNoResources                     libkern_kext_err(0x3)
+
+/*!
+ * @define   kOSKextReturnNotPrivileged
+ * @abstract The caller lacks privileges to perform the requested operation.
+ */
+#define kOSKextReturnNotPrivileged                   libkern_kext_err(0x4)
+
+/*!
+ * @define   kOSKextReturnInvalidArgument
+ * @abstract Invalid argument.
+ */
+#define kOSKextReturnInvalidArgument                 libkern_kext_err(0x5)
+
+/*!
+ * @define   kOSKextReturnNotFound
+ * @abstract Search item not found.
+ */
+#define kOSKextReturnNotFound                        libkern_kext_err(0x6)
+
+/*!
+ * @define   kOSKextReturnBadData
+ * @abstract Malformed data (not used for XML).
+ */
+#define kOSKextReturnBadData                         libkern_kext_err(0x7)
+
+/*!
+ * @define   kOSKextReturnSerialization
+ * @abstract Error converting or (un)serializing URL, string, or XML.
+ */
+#define kOSKextReturnSerialization                   libkern_kext_err(0x8)
+
+/*!
+ * @define   kOSKextReturnUnsupported
+ * @abstract Operation is no longer or not yet supported.
+ */
+#define kOSKextReturnUnsupported                     libkern_kext_err(0x9)
+
+/*!
+ * @define   kOSKextReturnDisabled
+ * @abstract Operation is currently disabled.
+ */
+#define kOSKextReturnDisabled                        libkern_kext_err(0xa)
+
+/*!
+ * @define   kOSKextReturnNotAKext
+ * @abstract Bundle is not a kernel extension.
+ */
+#define kOSKextReturnNotAKext                        libkern_kext_err(0xb)
+
+/*!
+ * @define   kOSKextReturnValidation
+ * @abstract Validation failures encountered; check diagnostics for details.
+ */
+#define kOSKextReturnValidation                      libkern_kext_err(0xc)
+
+/*!
+ * @define   kOSKextReturnAuthentication
+ * @abstract Authetication failures encountered; check diagnostics for details.
+ */
+#define kOSKextReturnAuthentication                  libkern_kext_err(0xd)
+
+/*!
+ * @define   kOSKextReturnDependencies
+ * @abstract Dependency resolution failures encountered; check diagnostics for details.
+ */
+#define kOSKextReturnDependencies                    libkern_kext_err(0xe)
+
+/*!
+ * @define   kOSKextReturnArchNotFound
+ * @abstract Kext does not contain code for the requested architecture.
+ */
+#define kOSKextReturnArchNotFound                    libkern_kext_err(0xf)
+
+/*!
+ * @define   kOSKextReturnCache
+ * @abstract An error occurred processing a system kext cache.
+ */
+#define kOSKextReturnCache                           libkern_kext_err(0x10)
+
+/*!
+ * @define   kOSKextReturnDeferred
+ * @abstract Operation has been posted asynchronously to user space (kernel only).
+ */
+#define kOSKextReturnDeferred                        libkern_kext_err(0x11)
+
+/*!
+ * @define   kOSKextReturnBootLevel
+ * @abstract Kext not loadable or operation not allowed at current boot level.
+ */
+#define kOSKextReturnBootLevel                       libkern_kext_err(0x12)
+
+/*!
+ * @define   kOSKextReturnNotLoadable
+ * @abstract Kext cannot be loaded; check diagnostics for details.
+ */
+#define kOSKextReturnNotLoadable                     libkern_kext_err(0x13)
+
+/*!
+ * @define   kOSKextReturnLoadedVersionDiffers
+ * @abstract A different version (or executable UUID, or executable by checksum)
+ *           of the requested kext is already loaded.
+ */
+#define kOSKextReturnLoadedVersionDiffers            libkern_kext_err(0x14)
+
+/*!
+ * @define   kOSKextReturnDependencyLoadError
+ * @abstract A load error occurred on a dependency of the kext being loaded.
+ */
+#define kOSKextReturnDependencyLoadError             libkern_kext_err(0x15)
+
+/*!
+ * @define   kOSKextReturnLinkError
+ * @abstract A link failure occured with this kext or a dependency.
+ */
+#define kOSKextReturnLinkError                       libkern_kext_err(0x16)
+
+/*!
+ * @define   kOSKextReturnStartStopError
+ * @abstract The kext start or stop routine returned an error.
+ */
+#define kOSKextReturnStartStopError                  libkern_kext_err(0x17)
+
+/*!
+ * @define   kOSKextReturnInUse
+ * @abstract The kext is currently in use or has outstanding references,
+ *           and cannot be unloaded.
+ */
+#define kOSKextReturnInUse                           libkern_kext_err(0x18)
+
+/*!
+ * @define   kOSKextReturnTimeout
+ * @abstract A kext request has timed out.
+ */
+#define kOSKextReturnTimeout                         libkern_kext_err(0x19)
+
+/*!
+ * @define   kOSKextReturnStopping
+ * @abstract The kext is in the process of stopping; requests cannot be made.
+ */
+#define kOSKextReturnStopping                        libkern_kext_err(0x1a)
+
+#if PRAGMA_MARK
+#pragma mark -
+/********************************************************************/
+#pragma mark Kext/OSBundle Property List Keys
+/********************************************************************/
+#endif
+/*!
+ * @group Kext Property List Keys
+ * These constants cover CFBundle properties defined for kernel extensions.
+ * Because they are used in the kernel, if you want to use one with
+ * CFBundle APIs you'll need to wrap it in a <code>CFSTR()</code> macro.
+ */
+
+
+/*!
+ * @define   kOSBundleCompatibleVersionKey
+ * @abstract A string giving the backwards-compatible version of a library kext
+ *           in extended Mac OS 'vers' format (####.##.##s{1-255} where 's'
+ *           is a build stage 'd', 'a', 'b', 'f' or 'fc').
+ */
+#define kOSBundleCompatibleVersionKey           "OSBundleCompatibleVersion"
+
+/*!
+ * @define   kOSBundleEnableKextLoggingKey
+ * @abstract Set to true to have the kernel kext logging spec applied
+ *           to the kext.
+ *           See <code>@link //apple_ref/c/econst/OSKextLogSpec
+ *           OSKextLogSpec@/link</code>.
+ */
+#define kOSBundleEnableKextLoggingKey           "OSBundleEnableKextLogging"
+
+/*!
+ * @define   kOSBundleIsInterfaceKey
+ * @abstract A boolean value indicating whether the kext executable
+ *           contains only symbol references.
+ */
+#define kOSBundleIsInterfaceKey                 "OSBundleIsInterface"
+
+/*!
+ * @define   kOSBundleLibrariesKey
+ * @abstract A dictionary listing link dependencies for this kext.
+ *           Keys are bundle identifiers, values are version strings.
+ */
+#define kOSBundleLibrariesKey                   "OSBundleLibraries"
+
+/*!
+ * @define   kOSBundleRequiredKey
+ * @abstract A string indicating in which kinds of startup this kext
+ *           may need to load during early startup (before
+ *           <code>@link //apple_ref/doc/man/8/kextd kextcache(8)@/link</code>).
+ * @discussion
+ * The value is one of:
+ * <ul>
+ * <li>@link kOSBundleRequiredRoot "OSBundleRequiredRoot"@/link</li>
+ * <li>@link kOSBundleRequiredLocalRoot "OSBundleRequiredLocalRoot"@/link</li>
+ * <li>@link kOSBundleRequiredNetworkRoot "OSBundleRequiredNetworkRoot"@/link</li>
+ * <li>@link kOSBundleRequiredSafeBoot "OSBundleRequiredSafeBoot"@/link</li>
+ * <li>@link kOSBundleRequiredConsole "OSBundleRequiredConsole"@/link</li>
+ * </ul>
+ *
+ * Use this property judiciously.
+ * Every kext that declares a value other than "OSBundleRequiredSafeBoot"
+ * increases startup time, as the booter must read it into memory,
+ * or startup kext caches must include it.
+ */
+#define kOSBundleRequiredKey                    "OSBundleRequired"
+
+/*!
+ * @define   kOSBundleAllowUserLoadKey
+ * @abstract A boolean value indicating whether
+ *           <code>@link //apple_ref/doc/man/8/kextd kextcache(8)@/link</code>
+ *           will honor a non-root process's request to load a kext.
+ * @discussion
+ * See <code>@link //apple_ref/doc/compositePage/c/func/KextManagerLoadKextWithURL
+ * KextManagerLoadKextWithURL@/link</code>
+ * and <code>@link //apple_ref/doc/compositePage/c/func/KextManagerLoadKextWithIdentifier
+ * KextManagerLoadKextWithIdentifier@/link</code>.
+ */
+#define kOSBundleAllowUserLoadKey               "OSBundleAllowUserLoad"
+
+/*!
+ * @define   kOSKernelResourceKey
+ * @abstract A boolean value indicating whether the kext represents a built-in
+ *           component of the kernel.
+ */
+#define kOSKernelResourceKey                    "OSKernelResource"
+
+/*!
+ * @define   kIOKitPersonalitiesKey
+ * @abstract A dictionary of dictionaries used in matching for I/O Kit drivers.
+ */
+#define kIOKitPersonalitiesKey                  "IOKitPersonalities"
+
+/*
+ * @define   kIOPersonalityPublisherKey
+ * @abstract Used in personalities sent to the I/O Kit,
+ *           contains the CFBundleIdentifier of the kext
+ *           that the personality originated in.
+ */
+#define kIOPersonalityPublisherKey              "IOPersonalityPublisher"
+
+#if CONFIG_KEC_FIPS
+/*
+ * @define   kAppleTextHashesKey
+ * @abstract A dictionary conataining hashes for corecrypto kext.
+ */
+#define kAppleTextHashesKey                     "AppleTextHashes"
+#endif
+
+
+
+#if PRAGMA_MARK
+/********************************************************************/
+#pragma mark Kext/OSBundle Property Deprecated Keys
+/********************************************************************/
+#endif
+/*
+ * @define   kOSBundleDebugLevelKey
+ * @abstract
+ * Deprecated (used on some releases of Mac OS X prior to 10.6 Snow Leopard).
+ * Value is an integer from 1-6, corresponding to the verbose levels
+ * of kext tools on those releases.
+ * On 10.6 Snow Leopard, use <code>@link OSKextEnableKextLogging
+ * OSKextEnableKextLogging@/link</code>.
+ */
+#define kOSBundleDebugLevelKey                  "OSBundleDebugLevel"
+
+/*!
+ * @define   kOSBundleSharedExecutableIdentifierKey
+ * @abstract Deprecated (used on some releases of Mac OS X
+ *           prior to 10.6 Snow Leopard).
+ *           Value is the bundle identifier of the pseudokext
+ *           that contains an executable shared by this kext.
+ */
+#define kOSBundleSharedExecutableIdentifierKey  "OSBundleSharedExecutableIdentifier"
+
+
+#if PRAGMA_MARK
+/********************************************************************/
+#pragma mark Kext/OSBundle Property List Values
+/********************************************************************/
+#endif
+
+/*!
+ * @group Kext Property List Values
+ * These constants encompass established values
+ * for kernel extension bundle properties.
+ */
+
+/*!
+* @define   kOSKextKernelIdentifier
+* @abstract
+* This is the CFBundleIdentifier user for the kernel itself.
+*/
+#define kOSKextKernelIdentifier                 "__kernel__"
+
+/*!
+* @define   kOSBundleRequiredRoot
+* @abstract
+* This <code>@link kOSBundleRequiredKey OSBundleRequired@/link</code>
+* value indicates that the kext may be needed to mount the root filesystem
+* whether starting from a local or a network volume.
+*/
+#define kOSBundleRequiredRoot                   "Root"
+
+/*!
+* @define   kOSBundleRequiredLocalRoot
+* @abstract
+* This <code>@link kOSBundleRequiredKey OSBundleRequired@/link</code>
+* value indicates that the kext may be needed to mount the root filesystem
+* when starting from a local disk.
+*/
+#define kOSBundleRequiredLocalRoot              "Local-Root"
+
+/*!
+* @define   kOSBundleRequiredNetworkRoot
+* @abstract
+* This <code>@link kOSBundleRequiredKey OSBundleRequired@/link</code>
+* value indicates that the kext may be needed to mount the root filesystem
+* when starting over a network connection.
+*/
+#define kOSBundleRequiredNetworkRoot            "Network-Root"
+
+/*!
+* @define   kOSBundleRequiredSafeBoot
+* @abstract
+* This <code>@link kOSBundleRequiredKey OSBundleRequired@/link</code>
+* value indicates that the kext can be loaded during a safe startup.
+* This value does not normally cause the kext to be read by the booter
+* or included in startup kext caches.
+*/
+#define kOSBundleRequiredSafeBoot               "Safe Boot"
+
+/*!
+* @define   kOSBundleRequiredConsole
+* @abstract
+* This <code>@link kOSBundleRequiredKey OSBundleRequired@/link</code>
+* value indicates that the kext may be needed for console access
+* (specifically in a single-user startup when
+* <code>@link //apple_ref/doc/man/8/kextd kextd(8)@/link</code>.
+* does not run)
+* and should be loaded during early startup.
+*/
+#define kOSBundleRequiredConsole                "Console"
+
+
+#if PRAGMA_MARK
+#pragma mark -
+/********************************************************************/
+#pragma mark Kext Information
+/********************************************************************/
+#endif
+/*!
+ * @group Kext Information
+ * Types, constants, and macros providing a kext with information
+ * about itself.
+ */
+
+/*!
+ * @typedef OSKextLoadTag
+ *
+ * @abstract
+ * A unique identifier assigned to a loaded instanace of a kext.
+ *
+ * @discussion
+ * If a kext is unloaded and later reloaded, the new instance
+ * has a different load tag.
+ *
+ * A kext can get its own load tag in the <code>kmod_info_t</code>
+ * structure passed into its module start routine, as the
+ * <code>id</code> field (cast to this type).
+ */
+typedef uint32_t  OSKextLoadTag;
+
+/*!
+ * @define kOSKextInvalidLoadTag
+ *
+ * @abstract
+ * A load tag value that will never be used for a loaded kext;
+ * indicates kext not found.
+ */
+#define  kOSKextInvalidLoadTag  ((OSKextLoadTag)(-1))
+
+
+__END_DECLS
+
+#endif /* _LIBKERN_OSKEXTLIB_H */
diff -Nur cctools-877.5/include/libkern/OSReturn.h cctools-877.5-AnV/include/libkern/OSReturn.h
--- cctools-877.5/include/libkern/OSReturn.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libkern/OSReturn.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,198 @@
+/*
+ * Copyright (c) 2000 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1998 Apple Inc.  All rights reserved. 
+ *
+ * HISTORY
+ *
+ */
+ 
+/*
+ * Core OSReturn values.
+ */
+
+#ifndef __LIBKERN_OSRETURN_H
+#define __LIBKERN_OSRETURN_H
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+
+#include <mach/error.h>
+
+
+/*!
+ * @header
+ *
+ * Declares functions, basic return values, and other constants
+ * related to kernel extensions (kexts).
+ */
+
+#if PRAGMA_MARK
+#pragma mark Core OSReturn Values for Libkern
+#endif
+/*********************************************************************
+* Core OSReturn Values for Libkern
+*********************************************************************/
+/*!
+ * @group Core OSReturn Values for Libkern
+ * Some kext and I/O Kit functions can return these values,
+ * as well as  other values of
+ * <code>kern_return_t</code>.
+ *
+ * Many of these return values represent internal errors
+ * in the Libkern C++ run-time typing information system
+ * based on @link //apple_ref/doc/class/OSMetaClass OSMetaClass@/link;
+ * you are unlikely to ever see them.
+ * 
+ */
+
+
+/*!
+ * @typedef  OSReturn
+ * @abstract The return type for many Libkern functions.
+ */
+typedef kern_return_t OSReturn;
+
+#ifndef sys_libkern
+#define sys_libkern                   err_system(0x37)
+#endif /* sys_libkern */
+
+#define sub_libkern_common            err_sub(0)
+#define sub_libkern_metaclass         err_sub(1)
+#define sub_libkern_reserved          err_sub(-1)
+
+#define libkern_common_err(return)    (sys_libkern|sub_libkern_common|(return))
+#define libkern_metaclass_err(return) (sys_libkern|sub_libkern_metaclass|(return))
+
+/* See OSKextLib.h for these
+ * #define sub_libkern_kext           err_sub(2)
+ * #define libkern_kext_err(code)     (sys_libkern|sub_libkern_kext|(code))
+ */
+
+/*!
+ * @define   kOSReturnSuccess
+ * @abstract Operation successful.
+ *           Equal to <code>@link //apple_ref/c/econst/KERN_SUCCESS
+ *           KERN_SUCCESS@/link</code>.
+ */
+#define kOSReturnSuccess              KERN_SUCCESS
+
+/*!
+ * @define   kOSReturnError
+ * @abstract Unspecified Libkern error.
+ *           <b>Not equal</b> to 
+ *           <code>@link //apple_ref/c/econst/KERN_FAILURE
+ *           KERN_FAILURE@/link</code>.
+ */
+#define kOSReturnError                libkern_common_err(1)
+
+/*!
+ * @define   kOSMetaClassInternal
+ * @abstract Internal OSMetaClass run-time error.
+ */
+#define kOSMetaClassInternal          libkern_metaclass_err(1)
+
+/*!
+ * @define   kOSMetaClassHasInstances
+ * @abstract A kext cannot be unloaded because there are instances
+ *           derived from Libkern C++ classes that it defines.
+ */
+#define kOSMetaClassHasInstances      libkern_metaclass_err(2)
+
+/*!
+ * @define   kOSMetaClassNoInit
+ * @abstract Internal error: The Libkern C++ class registration system
+ *           was not properly initialized during kext loading.
+ */
+#define kOSMetaClassNoInit            libkern_metaclass_err(3)
+// OSMetaClass::preModLoad wasn't called, runtime internal error
+
+/*!
+ * @define   kOSMetaClassNoTempData
+ * @abstract Internal error: An allocation failure occurred
+ *           registering Libkern C++ classes during kext loading.
+ */
+#define kOSMetaClassNoTempData        libkern_metaclass_err(4)
+// Allocation failure internal data
+
+/*!
+ * @define   kOSMetaClassNoDicts
+ * @abstract Internal error: An allocation failure occurred
+ *           registering Libkern C++ classes during kext loading.
+ */
+#define kOSMetaClassNoDicts           libkern_metaclass_err(5)
+// Allocation failure for Metaclass internal dictionaries
+
+/*!
+ * @define   kOSMetaClassNoKModSet
+ * @abstract Internal error: An allocation failure occurred
+ *           registering Libkern C++ classes during kext loading.
+ */
+#define kOSMetaClassNoKModSet         libkern_metaclass_err(6)
+// Allocation failure for internal kmodule set
+
+/*!
+ * @define   kOSMetaClassNoInsKModSet
+ * @abstract Internal error: An error occurred registering
+ *           a specific Libkern C++ class during kext loading.
+ */
+#define kOSMetaClassNoInsKModSet      libkern_metaclass_err(7)
+// Can't insert the KMod set into the module dictionary
+
+/*!
+ * @define   kOSMetaClassNoSuper
+ * @abstract Internal error: No superclass can be found
+ *           for a specific Libkern C++ class during kext loading.
+ */
+#define kOSMetaClassNoSuper           libkern_metaclass_err(8)
+
+/*!
+ * @define   kOSMetaClassInstNoSuper
+ * @abstract Internal error: No superclass can be found when constructing
+ *           an instance of a Libkern C++ class.
+ */
+#define kOSMetaClassInstNoSuper       libkern_metaclass_err(9)
+
+/*!
+ * @define   kOSMetaClassDuplicateClass
+ * @abstract A duplicate Libkern C++ classname was encountered
+ *           during kext loading.
+ */
+#define kOSMetaClassDuplicateClass    libkern_metaclass_err(10)
+
+/*!
+ * @define   kOSMetaClassNoKext
+ * @abstract Internal error: The kext for a Libkern C++ class
+ *           can't be found during kext loading.
+ */
+#define kOSMetaClassNoKext            libkern_metaclass_err(11)
+
+__END_DECLS
+
+#endif /* ! __LIBKERN_OSRETURN_H */
diff -Nur cctools-877.5/include/libkern/OSThermalNotification.h cctools-877.5-AnV/include/libkern/OSThermalNotification.h
--- cctools-877.5/include/libkern/OSThermalNotification.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libkern/OSThermalNotification.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,126 @@
+/*
+ * Copyright (c) 2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OSTHERMALNOTIFICATION_H_
+#define _OSTHERMALNOTIFICATION_H_
+
+#include <sys/cdefs.h>
+#include <Availability.h>
+
+/*
+**  OSThermalNotification.h
+**  
+**  Notification mechanism to alert registered tasks when device thermal conditions
+**  reach certain thresholds. Notifications are triggered in both directions
+**  so clients can manage their memory usage more and less aggressively.
+**
+*/
+
+__BEGIN_DECLS
+
+/* Define pressure levels usable by OSThermalPressureLevel */
+typedef enum {
+	kOSThermalPressureLevelNominal = 0,
+	kOSThermalPressureLevelModerate,
+	kOSThermalPressureLevelHeavy,
+	kOSThermalPressureLevelTrapping,
+	kOSThermalPressureLevelSleeping
+} OSThermalPressureLevel;
+
+/*
+ ** External notify(3) string for thermal pressure level notification
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_7_0)
+extern const char * const kOSThermalNotificationPressureLevelName;
+
+
+#if defined(__IPHONE_OS_VERSION_MIN_REQUIRED) && \
+	__IPHONE_OS_VERSION_MIN_REQUIRED >= __IPHONE_2_0
+
+typedef enum {
+	OSThermalNotificationLevelAny      = -1,
+	OSThermalNotificationLevelNormal   =  0,
+} OSThermalNotificationLevel;
+
+extern OSThermalNotificationLevel _OSThermalNotificationLevelForBehavior(int) __OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_4_2);
+extern void _OSThermalNotificationSetLevelForBehavior(int, int) __OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_4_2);
+
+enum {
+	kOSThermalMitigationNone,
+	kOSThermalMitigation70PercentTorch,
+	kOSThermalMitigation70PercentBacklight,
+	kOSThermalMitigation50PercentTorch,
+	kOSThermalMitigation50PercentBacklight,
+	kOSThermalMitigationDisableTorch,
+	kOSThermalMitigation25PercentBacklight,
+	kOSThermalMitigationDisableMapsHalo,
+	kOSThermalMitigationAppTerminate,
+	kOSThermalMitigationDeviceRestart,
+	kOSThermalMitigationThermalTableReady,
+	kOSThermalMitigationCount
+};
+
+#define OSThermalNotificationLevel70PercentTorch _OSThermalNotificationLevelForBehavior(kOSThermalMitigation70PercentTorch)
+#define OSThermalNotificationLevel70PercentBacklight _OSThermalNotificationLevelForBehavior(kOSThermalMitigation70PercentBacklight)
+#define OSThermalNotificationLevel50PercentTorch _OSThermalNotificationLevelForBehavior(kOSThermalMitigation50PercentTorch)
+#define OSThermalNotificationLevel50PercentBacklight _OSThermalNotificationLevelForBehavior(kOSThermalMitigation50PercentBacklight)
+#define OSThermalNotificationLevelDisableTorch _OSThermalNotificationLevelForBehavior(kOSThermalMitigationDisableTorch)
+#define OSThermalNotificationLevel25PercentBacklight _OSThermalNotificationLevelForBehavior(kOSThermalMitigation25PercentBacklight)
+#define OSThermalNotificationLevelDisableMapsHalo _OSThermalNotificationLevelForBehavior(kOSThermalMitigationDisableMapsHalo)
+#define OSThermalNotificationLevelAppTerminate _OSThermalNotificationLevelForBehavior(kOSThermalMitigationAppTerminate)
+#define OSThermalNotificationLevelDeviceRestart _OSThermalNotificationLevelForBehavior(kOSThermalMitigationDeviceRestart)
+
+/* Backwards compatibility */
+#define OSThermalNotificationLevelWarning OSThermalNotificationLevel70PercentBacklight
+#define OSThermalNotificationLevelUrgent OSThermalNotificationLevelAppTerminate
+#define OSThermalNotificationLevelCritical OSThermalNotificationLevelDeviceRestart
+
+/*
+** Simple polling interface to detect current thermal level
+*/
+__OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_2_0)
+extern OSThermalNotificationLevel OSThermalNotificationCurrentLevel(void);
+
+/*
+** External notify(3) string for manual notification setup
+*/
+__OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_2_0)
+extern const char * const kOSThermalNotificationName;
+
+/*
+** External notify(3) string for alerting user of a thermal condition
+*/
+__OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_6_0)
+extern const char * const kOSThermalNotificationAlert;
+
+/*
+** External notify(3) string for notifying system the options taken to resolve thermal condition
+*/
+__OSX_AVAILABLE_STARTING(__MAC_NA, __IPHONE_6_0)
+extern const char * const kOSThermalNotificationDecision;
+
+#endif // __IPHONE_OS_VERSION_MIN_REQUIRED
+
+__END_DECLS
+
+#endif /* _OSTHERMALNOTIFICATION_H_ */
diff -Nur cctools-877.5/include/libkern/OSTypes.h cctools-877.5-AnV/include/libkern/OSTypes.h
--- cctools-877.5/include/libkern/OSTypes.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libkern/OSTypes.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,42 @@
+/*
+ * Copyright (c) 1999-2012 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#include <MacTypes.h>
+
+#ifndef _OS_OSTYPES_H
+#define _OS_OSTYPES_H
+
+#define OSTYPES_K64_REV		2
+
+typedef unsigned int 	   UInt;
+typedef signed int         SInt;
+
+
+#include <sys/_types/_os_inline.h>
+
+#endif /* _OS_OSTYPES_H */
diff -Nur cctools-877.5/include/libkern/_OSByteOrder.h cctools-877.5-AnV/include/libkern/_OSByteOrder.h
--- cctools-877.5/include/libkern/_OSByteOrder.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libkern/_OSByteOrder.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,130 @@
+/*
+ * Copyright (c) 2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OS__OSBYTEORDER_H
+#define _OS__OSBYTEORDER_H
+
+/*
+ * This header is normally included from <libkern/OSByteOrder.h>.  However,
+ * <sys/_endian.h> also includes this in the case of little-endian
+ * architectures, so that we can map OSByteOrder routines to the hton* and ntoh*
+ * macros.  This results in the asymmetry below; we only include
+ * <libkern/arch/_OSByteOrder.h> for little-endian architectures.
+ */
+
+#include <sys/_types.h>
+
+/* Macros for swapping constant values in the preprocessing stage. */
+#define __DARWIN_OSSwapConstInt16(x) \
+    ((__uint16_t)((((__uint16_t)(x) & 0xff00) >> 8) | \
+                (((__uint16_t)(x) & 0x00ff) << 8)))
+
+#define __DARWIN_OSSwapConstInt32(x) \
+    ((__uint32_t)((((__uint32_t)(x) & 0xff000000) >> 24) | \
+                (((__uint32_t)(x) & 0x00ff0000) >>  8) | \
+                (((__uint32_t)(x) & 0x0000ff00) <<  8) | \
+                (((__uint32_t)(x) & 0x000000ff) << 24)))
+
+#define __DARWIN_OSSwapConstInt64(x) \
+    ((__uint64_t)((((__uint64_t)(x) & 0xff00000000000000ULL) >> 56) | \
+                (((__uint64_t)(x) & 0x00ff000000000000ULL) >> 40) | \
+                (((__uint64_t)(x) & 0x0000ff0000000000ULL) >> 24) | \
+                (((__uint64_t)(x) & 0x000000ff00000000ULL) >>  8) | \
+                (((__uint64_t)(x) & 0x00000000ff000000ULL) <<  8) | \
+                (((__uint64_t)(x) & 0x0000000000ff0000ULL) << 24) | \
+                (((__uint64_t)(x) & 0x000000000000ff00ULL) << 40) | \
+                (((__uint64_t)(x) & 0x00000000000000ffULL) << 56)))
+
+#if defined(__GNUC__)
+
+#if defined(__i386__) || defined(__x86_64__)
+#include <libkern/i386/_OSByteOrder.h>
+#endif
+
+
+
+#define __DARWIN_OSSwapInt16(x) \
+    ((__uint16_t)(__builtin_constant_p(x) ? __DARWIN_OSSwapConstInt16(x) : _OSSwapInt16(x)))
+
+#define __DARWIN_OSSwapInt32(x) \
+    (__builtin_constant_p(x) ? __DARWIN_OSSwapConstInt32(x) : _OSSwapInt32(x))
+
+#define __DARWIN_OSSwapInt64(x) \
+    (__builtin_constant_p(x) ? __DARWIN_OSSwapConstInt64(x) : _OSSwapInt64(x))
+
+#else /* ! __GNUC__ */
+
+#if defined(__i386__) || defined(__x86_64__)
+
+#if !defined(__DARWIN_OS_INLINE)
+# if defined(__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
+#        define __DARWIN_OS_INLINE static inline
+# elif defined(__MWERKS__) || defined(__cplusplus)
+#        define __DARWIN_OS_INLINE static inline
+# else
+#        define __DARWIN_OS_INLINE static __inline__
+# endif
+#endif
+
+__DARWIN_OS_INLINE
+uint16_t
+_OSSwapInt16(
+    uint16_t			data
+)
+{
+    return __DARWIN_OSSwapConstInt16(data);
+}
+
+__DARWIN_OS_INLINE
+uint32_t
+_OSSwapInt32(
+    uint32_t			data
+)
+{
+    return __DARWIN_OSSwapConstInt32(data);
+}
+
+__DARWIN_OS_INLINE
+uint64_t
+_OSSwapInt64(
+    uint64_t			data
+)
+{
+    return __DARWIN_OSSwapConstInt64(data);
+}
+#endif
+
+#define __DARWIN_OSSwapInt16(x) _OSSwapInt16(x)
+
+#define __DARWIN_OSSwapInt32(x) _OSSwapInt32(x)
+
+#define __DARWIN_OSSwapInt64(x) _OSSwapInt64(x)
+
+#endif /* __GNUC__ */
+
+#endif /* ! _OS__OSBYTEORDER_H */
diff -Nur cctools-877.5/include/libkern/i386/OSByteOrder.h cctools-877.5-AnV/include/libkern/i386/OSByteOrder.h
--- cctools-877.5/include/libkern/i386/OSByteOrder.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libkern/i386/OSByteOrder.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,112 @@
+/*
+ * Copyright (c) 1999-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OS_OSBYTEORDERI386_H
+#define _OS_OSBYTEORDERI386_H
+
+#include <stdint.h>
+#include <libkern/i386/_OSByteOrder.h>
+#include <sys/_types/_os_inline.h>
+
+/* Functions for byte reversed loads. */
+
+OS_INLINE
+uint16_t
+OSReadSwapInt16(
+    const volatile void   * base,
+    uintptr_t       byteOffset
+)
+{
+    uint16_t result;
+
+    result = *(volatile uint16_t *)((uintptr_t)base + byteOffset);
+    return _OSSwapInt16(result);
+}
+
+OS_INLINE
+uint32_t
+OSReadSwapInt32(
+    const volatile void   * base,
+    uintptr_t       byteOffset
+)
+{
+    uint32_t result;
+
+    result = *(volatile uint32_t *)((uintptr_t)base + byteOffset);
+    return _OSSwapInt32(result);
+}
+
+OS_INLINE
+uint64_t
+OSReadSwapInt64(
+    const volatile void   * base,
+    uintptr_t       byteOffset
+)
+{
+    uint64_t result;
+
+    result = *(volatile uint64_t *)((uintptr_t)base + byteOffset);
+    return _OSSwapInt64(result);
+}
+
+/* Functions for byte reversed stores. */
+
+OS_INLINE
+void
+OSWriteSwapInt16(
+    volatile void   * base,
+    uintptr_t       byteOffset,
+    uint16_t        data
+)
+{
+    *(volatile uint16_t *)((uintptr_t)base + byteOffset) = _OSSwapInt16(data);
+}
+
+OS_INLINE
+void
+OSWriteSwapInt32(
+    volatile void   * base,
+    uintptr_t       byteOffset,
+    uint32_t        data
+)
+{
+    *(volatile uint32_t *)((uintptr_t)base + byteOffset) = _OSSwapInt32(data);
+}
+
+OS_INLINE
+void
+OSWriteSwapInt64(
+    volatile void    * base,
+    uintptr_t        byteOffset,
+    uint64_t         data
+)
+{
+    *(volatile uint64_t *)((uintptr_t)base + byteOffset) = _OSSwapInt64(data);
+}
+
+#endif /* ! _OS_OSBYTEORDERI386_H */
diff -Nur cctools-877.5/include/libkern/i386/_OSByteOrder.h cctools-877.5-AnV/include/libkern/i386/_OSByteOrder.h
--- cctools-877.5/include/libkern/i386/_OSByteOrder.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libkern/i386/_OSByteOrder.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,104 @@
+/*
+ * Copyright (c) 2006-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OS__OSBYTEORDERI386_H
+#define _OS__OSBYTEORDERI386_H
+
+#if !defined(__DARWIN_OS_INLINE)
+# if defined(__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
+#        define __DARWIN_OS_INLINE static inline
+# elif defined(__MWERKS__) || defined(__cplusplus)
+#        define __DARWIN_OS_INLINE static inline
+# else
+#        define __DARWIN_OS_INLINE static __inline__
+# endif
+#endif
+
+/* Generic byte swapping functions. */
+
+__DARWIN_OS_INLINE
+__uint16_t
+_OSSwapInt16(
+    __uint16_t        _data
+)
+{
+    return ((__uint16_t)((_data << 8) | (_data >> 8)));
+}
+
+__DARWIN_OS_INLINE
+__uint32_t
+_OSSwapInt32(
+    __uint32_t        _data
+)
+{
+#if defined(__llvm__)
+    return __builtin_bswap32(_data);
+#else
+    __asm__ ("bswap   %0" : "+r" (_data));
+    return _data;
+#endif
+}
+
+#if defined(__llvm__)
+__DARWIN_OS_INLINE
+__uint64_t
+_OSSwapInt64(
+    __uint64_t        _data
+)
+{
+    return __builtin_bswap64(_data);
+}
+
+#elif defined(__i386__)
+__DARWIN_OS_INLINE
+__uint64_t
+_OSSwapInt64(
+    __uint64_t        _data
+)
+{
+    __asm__ ("bswap   %%eax\n\t"
+             "bswap   %%edx\n\t" 
+             "xchgl   %%eax, %%edx"
+             : "+A" (_data));
+    return _data;
+}
+#elif defined(__x86_64__)
+__DARWIN_OS_INLINE
+__uint64_t
+_OSSwapInt64(
+    __uint64_t        _data
+)
+{
+    __asm__ ("bswap   %0" : "+r" (_data));
+    return _data;
+}
+#else
+#error Unknown architecture
+#endif
+
+#endif /* ! _OS__OSBYTEORDERI386_H */
diff -Nur cctools-877.5/include/libkern/machine/OSByteOrder.h cctools-877.5-AnV/include/libkern/machine/OSByteOrder.h
--- cctools-877.5/include/libkern/machine/OSByteOrder.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/libkern/machine/OSByteOrder.h	2015-11-16 07:56:10 +0000
@@ -0,0 +1,143 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OS_OSBYTEORDERMACHINE_H
+#define _OS_OSBYTEORDERMACHINE_H
+
+#include <stdint.h>
+
+#if !defined(OS_INLINE)
+# if defined(__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
+#        define OS_INLINE static inline
+# elif defined(__MWERKS__) || defined(__cplusplus)
+#        define OS_INLINE static inline
+# else
+#        define OS_INLINE static __inline__
+# endif
+#endif
+
+/* Generic byte swapping functions. */
+
+OS_INLINE
+uint16_t
+_OSSwapInt16(
+    uint16_t                      data
+)
+{
+    return OSSwapConstInt16(data);
+}
+
+OS_INLINE
+uint32_t
+_OSSwapInt32(
+    uint32_t                      data
+)
+{
+    return OSSwapConstInt32(data);
+}
+
+OS_INLINE
+uint64_t
+_OSSwapInt64(
+    uint64_t                        data
+)
+{
+    return OSSwapConstInt64(data);
+}
+
+/* Functions for byte reversed loads. */
+
+OS_INLINE
+uint16_t
+OSReadSwapInt16(
+    const volatile void               * base,
+    uintptr_t                     byteOffset
+)
+{
+    uint16_t data = *(volatile uint16_t *)((uintptr_t)base + byteOffset);
+    return _OSSwapInt16(data);
+}
+
+OS_INLINE
+uint32_t
+OSReadSwapInt32(
+    const volatile void               * base,
+    uintptr_t                     byteOffset
+)
+{
+    uint32_t data = *(volatile uint32_t *)((uintptr_t)base + byteOffset);
+    return _OSSwapInt32(data);
+}
+
+OS_INLINE
+uint64_t
+OSReadSwapInt64(
+    const volatile void               * base,
+    uintptr_t                     byteOffset
+)
+{
+    uint64_t data = *(volatile uint64_t *)((uintptr_t)base + byteOffset);
+    return _OSSwapInt64(data);
+}
+
+/* Functions for byte reversed stores. */
+
+OS_INLINE
+void
+OSWriteSwapInt16(
+    volatile void               * base,
+    uintptr_t                     byteOffset,
+    uint16_t                      data
+)
+{
+    *(volatile uint16_t *)((uintptr_t)base + byteOffset) = _OSSwapInt16(data);
+}
+
+OS_INLINE
+void
+OSWriteSwapInt32(
+    volatile void               * base,
+    uintptr_t                     byteOffset,
+    uint32_t                      data
+)
+{
+    *(volatile uint32_t *)((uintptr_t)base + byteOffset) = _OSSwapInt32(data);
+}
+
+OS_INLINE
+void
+OSWriteSwapInt64(
+    volatile void               * base,
+    uintptr_t                     byteOffset,
+    uint64_t                      data
+)
+{
+    *(volatile uint64_t *)((uintptr_t)base + byteOffset) = _OSSwapInt64(data);
+}
+
+#endif /* ! _OS_OSBYTEORDERMACHINE_H */
diff -Nur cctools-877.5/include/llvm-c/Disassembler.h cctools-877.5-AnV/include/llvm-c/Disassembler.h
--- cctools-877.5/include/llvm-c/Disassembler.h	2014-02-25 21:51:28 +0000
+++ cctools-877.5-AnV/include/llvm-c/Disassembler.h	2015-11-19 09:03:05 +0000
@@ -15,6 +15,7 @@
 #ifndef LLVM_C_DISASSEMBLER_H
 #define LLVM_C_DISASSEMBLER_H
 
+#include "LLVMDataTypes.h"
 #include <stddef.h>
 
 /**
@@ -41,12 +42,12 @@
  * instruction are specified by the Offset parameter and its byte widith is the
  * size parameter.  For instructions sets with fixed widths and one symbolic
  * operand per instruction, the Offset parameter will be zero and Size parameter
- * will be the instruction width.  The information is returned in TagBuf and is 
+ * will be the instruction width.  The information is returned in TagBuf and is
  * Triple specific with its specific information defined by the value of
  * TagType for that Triple.  If symbolic information is returned the function
  * returns 1, otherwise it returns 0.
  */
-typedef int (*LLVMOpInfoCallback)(void *DisInfo, uint64_t Pc,
+typedef int (*LLVMOpInfoCallback)(void *DisInfo, uint64_t CB_PC,
                                   uint64_t Offset, uint64_t Size,
                                   int TagType, void *TagBuf);
 
@@ -57,7 +58,7 @@
  * SubtractSymbol can be link edited independent of each other.  Many other
  * platforms only allow a relocatable expression of the form AddSymbol + Offset
  * to be encoded.
- * 
+ *
  * The LLVMOpInfoCallback() for the TagType value of 1 uses the struct
  * LLVMOpInfo1.  The value of the relocatable expression for the operand,
  * including any PC adjustment, is passed in to the call back in the Value
@@ -225,7 +226,7 @@
  * no valid instruction.
  */
 size_t LLVMDisasmInstruction(LLVMDisasmContextRef DC, uint8_t *Bytes,
-                             uint64_t BytesSize, uint64_t Pc,
+                             uint64_t BytesSize, uint64_t DI_PC,
                              char *OutString, size_t OutStringSize);
 
 /**
diff -Nur cctools-877.5/include/llvm-c/Disassembler_old.h cctools-877.5-AnV/include/llvm-c/Disassembler_old.h
--- cctools-877.5/include/llvm-c/Disassembler_old.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/llvm-c/Disassembler_old.h	2015-11-19 09:03:05 +0000
@@ -0,0 +1,233 @@
+/*===-- llvm-c/Disassembler.h - Disassembler Public C Interface ---*- C -*-===*\
+|*                                                                            *|
+|*                     The LLVM Compiler Infrastructure                       *|
+|*                                                                            *|
+|* This file is distributed under the University of Illinois Open Source      *|
+|* License. See LICENSE.TXT for details.                                      *|
+|*                                                                            *|
+|*===----------------------------------------------------------------------===*|
+|*                                                                            *|
+|* This header provides a public interface to a disassembler library.         *|
+|* LLVM provides an implementation of this interface.                         *|
+|*                                                                            *|
+\*===----------------------------------------------------------------------===*/
+
+#ifndef LLVM_C_DISASSEMBLER_H
+#define LLVM_C_DISASSEMBLER_H
+
+#include <stddef.h>
+
+/**
+ * @defgroup LLVMCDisassembler Disassembler
+ * @ingroup LLVMC
+ *
+ * @{
+ */
+
+/**
+ * An opaque reference to a disassembler context.
+ */
+typedef void *LLVMDisasmContextRef;
+
+/**
+ * The type for the operand information call back function.  This is called to
+ * get the symbolic information for an operand of an instruction.  Typically
+ * this is from the relocation information, symbol table, etc.  That block of
+ * information is saved when the disassembler context is created and passed to
+ * the call back in the DisInfo parameter.  The instruction containing operand
+ * is at the PC parameter.  For some instruction sets, there can be more than
+ * one operand with symbolic information.  To determine the symbolic operand
+ * information for each operand, the bytes for the specific operand in the
+ * instruction are specified by the Offset parameter and its byte widith is the
+ * size parameter.  For instructions sets with fixed widths and one symbolic
+ * operand per instruction, the Offset parameter will be zero and Size parameter
+ * will be the instruction width.  The information is returned in TagBuf and is 
+ * Triple specific with its specific information defined by the value of
+ * TagType for that Triple.  If symbolic information is returned the function
+ * returns 1, otherwise it returns 0.
+ */
+typedef int (*LLVMOpInfoCallback)(void *DisInfo, uint64_t Pc,
+                                  uint64_t Offset, uint64_t Size,
+                                  int TagType, void *TagBuf);
+
+/**
+ * The initial support in LLVM MC for the most general form of a relocatable
+ * expression is "AddSymbol - SubtractSymbol + Offset".  For some Darwin targets
+ * this full form is encoded in the relocation information so that AddSymbol and
+ * SubtractSymbol can be link edited independent of each other.  Many other
+ * platforms only allow a relocatable expression of the form AddSymbol + Offset
+ * to be encoded.
+ * 
+ * The LLVMOpInfoCallback() for the TagType value of 1 uses the struct
+ * LLVMOpInfo1.  The value of the relocatable expression for the operand,
+ * including any PC adjustment, is passed in to the call back in the Value
+ * field.  The symbolic information about the operand is returned using all
+ * the fields of the structure with the Offset of the relocatable expression
+ * returned in the Value field.  It is possible that some symbols in the
+ * relocatable expression were assembly temporary symbols, for example
+ * "Ldata - LpicBase + constant", and only the Values of the symbols without
+ * symbol names are present in the relocation information.  The VariantKind
+ * type is one of the Target specific #defines below and is used to print
+ * operands like "_foo@GOT", ":lower16:_foo", etc.
+ */
+struct LLVMOpInfoSymbol1 {
+  uint64_t Present;  /* 1 if this symbol is present */
+  const char *Name;  /* symbol name if not NULL */
+  uint64_t Value;    /* symbol value if name is NULL */
+};
+
+struct LLVMOpInfo1 {
+  struct LLVMOpInfoSymbol1 AddSymbol;
+  struct LLVMOpInfoSymbol1 SubtractSymbol;
+  uint64_t Value;
+  uint64_t VariantKind;
+};
+
+/**
+ * The operand VariantKinds for symbolic disassembly.
+ */
+#define LLVMDisassembler_VariantKind_None 0 /* all targets */
+
+/**
+ * The ARM target VariantKinds.
+ */
+#define LLVMDisassembler_VariantKind_ARM_HI16 1 /* :upper16: */
+#define LLVMDisassembler_VariantKind_ARM_LO16 2 /* :lower16: */
+
+/**
+ * The ARM64 target VariantKinds.
+ */
+#define LLVMDisassembler_VariantKind_ARM64_PAGE       1 /* @page */
+#define LLVMDisassembler_VariantKind_ARM64_PAGEOFF    2 /* @pageoff */
+#define LLVMDisassembler_VariantKind_ARM64_GOTPAGE    3 /* @gotpage */
+#define LLVMDisassembler_VariantKind_ARM64_GOTPAGEOFF 4 /* @gotpageoff */
+#define LLVMDisassembler_VariantKind_ARM64_TLVP       5 /* @tvlppage */
+#define LLVMDisassembler_VariantKind_ARM64_TLVOFF     6 /* @tvlppageoff */
+
+/**
+ * The type for the symbol lookup function.  This may be called by the
+ * disassembler for things like adding a comment for a PC plus a constant
+ * offset load instruction to use a symbol name instead of a load address value.
+ * It is passed the block information is saved when the disassembler context is
+ * created and the ReferenceValue to look up as a symbol.  If no symbol is found
+ * for the ReferenceValue NULL is returned.  The ReferenceType of the
+ * instruction is passed indirectly as is the PC of the instruction in
+ * ReferencePC.  If the output reference can be determined its type is returned
+ * indirectly in ReferenceType along with ReferenceName if any, or that is set
+ * to NULL.
+ */
+typedef const char *(*LLVMSymbolLookupCallback)(void *DisInfo,
+                                                uint64_t ReferenceValue,
+                                                uint64_t *ReferenceType,
+                                                uint64_t ReferencePC,
+                                                const char **ReferenceName);
+/**
+ * The reference types on input and output.
+ */
+/* No input reference type or no output reference type. */
+#define LLVMDisassembler_ReferenceType_InOut_None 0
+
+/* The input reference is from a branch instruction. */
+#define LLVMDisassembler_ReferenceType_In_Branch 1
+/* The input reference is from a PC relative load instruction. */
+#define LLVMDisassembler_ReferenceType_In_PCrel_Load 2
+
+/* The input reference is from an ARM64::ADRP instruction. */
+#define LLVMDisassembler_ReferenceType_In_ARM64_ADRP 0x100000001
+/* The input reference is from an ARM64::ADDXri instruction. */
+#define LLVMDisassembler_ReferenceType_In_ARM64_ADDXri 0x100000002
+/* The input reference is from an ARM64::LDRXui instruction. */
+#define LLVMDisassembler_ReferenceType_In_ARM64_LDRXui 0x100000003
+/* The input reference is from an ARM64::LDRXl instruction. */
+#define LLVMDisassembler_ReferenceType_In_ARM64_LDRXl 0x100000004
+/* The input reference is from an ARM64::ADR instruction. */
+#define LLVMDisassembler_ReferenceType_In_ARM64_ADR 0x100000005
+
+/* The output reference is to as symbol stub. */
+#define LLVMDisassembler_ReferenceType_Out_SymbolStub 1
+/* The output reference is to a symbol address in a literal pool. */
+#define LLVMDisassembler_ReferenceType_Out_LitPool_SymAddr 2
+/* The output reference is to a cstring address in a literal pool. */
+#define LLVMDisassembler_ReferenceType_Out_LitPool_CstrAddr 3
+
+/* The output reference is to a Objective-C CoreFoundation string. */
+#define LLVMDisassembler_ReferenceType_Out_Objc_CFString_Ref 4
+/* The output reference is to a Objective-C message. */
+#define LLVMDisassembler_ReferenceType_Out_Objc_Message 5
+/* The output reference is to a Objective-C message ref. */
+#define LLVMDisassembler_ReferenceType_Out_Objc_Message_Ref 6
+/* The output reference is to a Objective-C selector ref. */
+#define LLVMDisassembler_ReferenceType_Out_Objc_Selector_Ref 7
+/* The output reference is to a Objective-C class ref. */
+#define LLVMDisassembler_ReferenceType_Out_Objc_Class_Ref 8
+
+/* The output reference is to a C++ symbol name. */
+#define LLVMDisassembler_ReferenceType_DeMangled_Name 9
+
+#ifdef __cplusplus
+extern "C" {
+#endif /* !defined(__cplusplus) */
+
+/**
+ * Create a disassembler for the TripleName.  Symbolic disassembly is supported
+ * by passing a block of information in the DisInfo parameter and specifying the
+ * TagType and callback functions as described above.  These can all be passed
+ * as NULL.  If successful, this returns a disassembler context.  If not, it
+ * returns NULL. This function is equivalent to calling LLVMCreateDisasmCPU()
+ * with an empty CPU name.
+ */
+LLVMDisasmContextRef LLVMCreateDisasm(const char *TripleName, void *DisInfo,
+                                      int TagType, LLVMOpInfoCallback GetOpInfo,
+                                      LLVMSymbolLookupCallback SymbolLookUp);
+
+/**
+ * Create a disassembler for the TripleName and a specific CPU.  Symbolic
+ * disassembly is supported by passing a block of information in the DisInfo
+ * parameter and specifying the TagType and callback functions as described
+ * above.  These can all be passed * as NULL.  If successful, this returns a
+ * disassembler context.  If not, it returns NULL.
+ */
+LLVMDisasmContextRef LLVMCreateDisasmCPU(const char *Triple, const char *CPU,
+                                         void *DisInfo, int TagType,
+                                         LLVMOpInfoCallback GetOpInfo,
+                                         LLVMSymbolLookupCallback SymbolLookUp);
+
+/**
+ * Set the disassembler's options.  Returns 1 if it can set the Options and 0
+ * otherwise.
+ */
+int LLVMSetDisasmOptions(LLVMDisasmContextRef DC, uint64_t Options);
+
+/* The option to produce marked up assembly. */
+#define LLVMDisassembler_Option_UseMarkup 1
+/* The option to print immediates as hex. */
+#define LLVMDisassembler_Option_PrintImmHex 2
+
+/**
+ * Dispose of a disassembler context.
+ */
+void LLVMDisasmDispose(LLVMDisasmContextRef DC);
+
+/**
+ * Disassemble a single instruction using the disassembler context specified in
+ * the parameter DC.  The bytes of the instruction are specified in the
+ * parameter Bytes, and contains at least BytesSize number of bytes.  The
+ * instruction is at the address specified by the PC parameter.  If a valid
+ * instruction can be disassembled, its string is returned indirectly in
+ * OutString whose size is specified in the parameter OutStringSize.  This
+ * function returns the number of bytes in the instruction or zero if there was
+ * no valid instruction.
+ */
+size_t LLVMDisasmInstruction(LLVMDisasmContextRef DC, uint8_t *Bytes,
+                             uint64_t BytesSize, uint64_t Pc,
+                             char *OutString, size_t OutStringSize);
+
+/**
+ * @}
+ */
+
+#ifdef __cplusplus
+}
+#endif /* !defined(__cplusplus) */
+
+#endif /* !defined(LLVM_C_DISASSEMBLER_H) */
diff -Nur cctools-877.5/include/llvm-c/LLVMDataTypes.h cctools-877.5-AnV/include/llvm-c/LLVMDataTypes.h
--- cctools-877.5/include/llvm-c/LLVMDataTypes.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/llvm-c/LLVMDataTypes.h	2015-11-19 09:03:05 +0000
@@ -0,0 +1,186 @@
+/* include/llvm/Support/DataTypes.h.  Generated from DataTypes.h.in by configure.  */
+/*===-- include/Support/DataTypes.h - Define fixed size types -----*- C -*-===*\
+|*                                                                            *|
+|*                     The LLVM Compiler Infrastructure                       *|
+|*                                                                            *|
+|* This file is distributed under the University of Illinois Open Source      *|
+|* License. See LICENSE.TXT for details.                                      *|
+|*                                                                            *|
+|*===----------------------------------------------------------------------===*|
+|*                                                                            *|
+|* This file contains definitions to figure out the size of _HOST_ data types.*|
+|* This file is important because different host OS's define different macros,*|
+|* which makes portability tough.  This file exports the following            *|
+|* definitions:                                                               *|
+|*                                                                            *|
+|*   [u]int(32|64)_t : typedefs for signed and unsigned 32/64 bit system types*|
+|*   [U]INT(8|16|32|64)_(MIN|MAX) : Constants for the min and max values.     *|
+|*                                                                            *|
+|* No library is required when using these functions.                         *|
+|*                                                                            *|
+|*===----------------------------------------------------------------------===*/
+
+/* Please leave this file C-compatible. */
+
+/* Please keep this file in sync with DataTypes.h.cmake */
+
+#ifndef SUPPORT_DATATYPES_H
+#define SUPPORT_DATATYPES_H
+
+#define HAVE_INTTYPES_H 1
+#define HAVE_STDINT_H 1
+#define HAVE_UINT64_T 1
+/* #undef HAVE_U_INT64_T */
+
+#ifdef __cplusplus
+#include <cmath>
+#else
+#include <math.h>
+#endif
+
+#ifndef _MSC_VER
+
+/* Note that <inttypes.h> includes <stdint.h>, if this is a C99 system. */
+#include <sys/types.h>
+
+#ifdef HAVE_INTTYPES_H
+#include <inttypes.h>
+#endif
+
+#ifdef HAVE_STDINT_H
+#include <stdint.h>
+#endif
+
+/* Handle incorrect definition of uint64_t as u_int64_t */
+#ifndef HAVE_UINT64_T
+#ifdef HAVE_U_INT64_T
+typedef u_int64_t uint64_t;
+#else
+# error "Don't have a definition for uint64_t on this platform"
+#endif
+#endif
+
+#else /* _MSC_VER */
+/* Visual C++ doesn't provide standard integer headers, but it does provide
+   built-in data types. */
+#include <stdlib.h>
+#include <stddef.h>
+#include <sys/types.h>
+#ifdef __cplusplus
+#include <cmath>
+#else
+#include <math.h>
+#endif
+typedef __int64 int64_t;
+typedef unsigned __int64 uint64_t;
+typedef signed int int32_t;
+typedef unsigned int uint32_t;
+typedef short int16_t;
+typedef unsigned short uint16_t;
+typedef signed char int8_t;
+typedef unsigned char uint8_t;
+#if defined(_WIN64)
+  typedef signed __int64 ssize_t;
+#else
+  typedef signed int ssize_t;
+#endif
+
+#ifndef INT8_MAX
+# define INT8_MAX 127
+#endif
+#ifndef INT8_MIN
+# define INT8_MIN -128
+#endif
+#ifndef UINT8_MAX
+# define UINT8_MAX 255
+#endif
+#ifndef INT16_MAX
+# define INT16_MAX 32767
+#endif
+#ifndef INT16_MIN
+# define INT16_MIN -32768
+#endif
+#ifndef UINT16_MAX
+# define UINT16_MAX 65535
+#endif
+#ifndef INT32_MAX
+# define INT32_MAX 2147483647
+#endif
+#ifndef INT32_MIN
+/* MSC treats -2147483648 as -(2147483648U). */
+# define INT32_MIN (-INT32_MAX - 1)
+#endif
+#ifndef UINT32_MAX
+# define UINT32_MAX 4294967295U
+#endif
+/* Certain compatibility updates to VC++ introduce the `cstdint'
+ * header, which defines the INT*_C macros. On default installs they
+ * are absent. */
+#ifndef INT8_C
+# define INT8_C(C)   C##i8
+#endif
+#ifndef UINT8_C
+# define UINT8_C(C)  C##ui8
+#endif
+#ifndef INT16_C
+# define INT16_C(C)  C##i16
+#endif
+#ifndef UINT16_C
+# define UINT16_C(C) C##ui16
+#endif
+#ifndef INT32_C
+# define INT32_C(C)  C##i32
+#endif
+#ifndef UINT32_C
+# define UINT32_C(C) C##ui32
+#endif
+#ifndef INT64_C
+# define INT64_C(C)  C##i64
+#endif
+#ifndef UINT64_C
+# define UINT64_C(C) C##ui64
+#endif
+
+#ifndef PRId64
+# define PRId64 "I64d"
+#endif
+#ifndef PRIi64
+# define PRIi64 "I64i"
+#endif
+#ifndef PRIo64
+# define PRIo64 "I64o"
+#endif
+#ifndef PRIu64
+# define PRIu64 "I64u"
+#endif
+#ifndef PRIx64
+# define PRIx64 "I64x"
+#endif
+#ifndef PRIX64
+# define PRIX64 "I64X"
+#endif
+
+#endif /* _MSC_VER */
+
+/* Set defaults for constants which we cannot find. */
+#if !defined(INT64_MAX)
+# define INT64_MAX 9223372036854775807LL
+#endif
+#if !defined(INT64_MIN)
+# define INT64_MIN ((-INT64_MAX)-1)
+#endif
+#if !defined(UINT64_MAX)
+# define UINT64_MAX 0xffffffffffffffffULL
+#endif
+
+#if __GNUC__ > 3
+#define END_WITH_NULL __attribute__((sentinel))
+#else
+#define END_WITH_NULL
+#endif
+
+#ifndef HUGE_VALF
+#define HUGE_VALF (float)HUGE_VAL
+#endif
+
+#endif  /* SUPPORT_DATATYPES_H */
diff -Nur cctools-877.5/include/llvm-c/lto.h cctools-877.5-AnV/include/llvm-c/lto.h
--- cctools-877.5/include/llvm-c/lto.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/llvm-c/lto.h	2015-11-19 09:03:05 +0000
@@ -0,0 +1,361 @@
+/*===-- llvm-c/lto.h - LTO Public C Interface ---------------------*- C -*-===*\
+|*                                                                            *|
+|*                     The LLVM Compiler Infrastructure                       *|
+|*                                                                            *|
+|* This file is distributed under the University of Illinois Open Source      *|
+|* License. See LICENSE.TXT for details.                                      *|
+|*                                                                            *|
+|*===----------------------------------------------------------------------===*|
+|*                                                                            *|
+|* This header provides public interface to an abstract link time optimization*|
+|* library.  LLVM provides an implementation of this interface for use with   *|
+|* llvm bitcode files.                                                        *|
+|*                                                                            *|
+\*===----------------------------------------------------------------------===*/
+
+#ifndef LLVM_C_LTO_H
+#define LLVM_C_LTO_H
+
+#include <stddef.h>
+#include <sys/types.h>
+
+#ifndef __cplusplus
+#if !defined(_MSC_VER)
+#include <stdbool.h>
+typedef bool lto_bool_t;
+#else
+/* MSVC in particular does not have anything like _Bool or bool in C, but we can
+   at least make sure the type is the same size.  The implementation side will
+   use C++ bool. */
+typedef unsigned char lto_bool_t;
+#endif
+#else
+typedef bool lto_bool_t;
+#endif
+
+/**
+ * @defgroup LLVMCLTO LTO
+ * @ingroup LLVMC
+ *
+ * @{
+ */
+
+#define LTO_API_VERSION 7
+
+typedef enum {
+    LTO_SYMBOL_ALIGNMENT_MASK              = 0x0000001F, /* log2 of alignment */
+    LTO_SYMBOL_PERMISSIONS_MASK            = 0x000000E0,
+    LTO_SYMBOL_PERMISSIONS_CODE            = 0x000000A0,
+    LTO_SYMBOL_PERMISSIONS_DATA            = 0x000000C0,
+    LTO_SYMBOL_PERMISSIONS_RODATA          = 0x00000080,
+    LTO_SYMBOL_DEFINITION_MASK             = 0x00000700,
+    LTO_SYMBOL_DEFINITION_REGULAR          = 0x00000100,
+    LTO_SYMBOL_DEFINITION_TENTATIVE        = 0x00000200,
+    LTO_SYMBOL_DEFINITION_WEAK             = 0x00000300,
+    LTO_SYMBOL_DEFINITION_UNDEFINED        = 0x00000400,
+    LTO_SYMBOL_DEFINITION_WEAKUNDEF        = 0x00000500,
+    LTO_SYMBOL_SCOPE_MASK                  = 0x00003800,
+    LTO_SYMBOL_SCOPE_INTERNAL              = 0x00000800,
+    LTO_SYMBOL_SCOPE_HIDDEN                = 0x00001000,
+    LTO_SYMBOL_SCOPE_PROTECTED             = 0x00002000,
+    LTO_SYMBOL_SCOPE_DEFAULT               = 0x00001800,
+    LTO_SYMBOL_SCOPE_DEFAULT_CAN_BE_HIDDEN = 0x00002800
+} lto_symbol_attributes;
+
+typedef enum {
+    LTO_DEBUG_MODEL_NONE         = 0,
+    LTO_DEBUG_MODEL_DWARF        = 1
+} lto_debug_model;
+
+typedef enum {
+    LTO_CODEGEN_PIC_MODEL_STATIC         = 0,
+    LTO_CODEGEN_PIC_MODEL_DYNAMIC        = 1,
+    LTO_CODEGEN_PIC_MODEL_DYNAMIC_NO_PIC = 2
+} lto_codegen_model;
+
+typedef enum {
+    LTO_INTERNALIZE_FULL   = 0,
+    LTO_INTERNALIZE_NONE   = 1,
+    LTO_INTERNALIZE_HIDDEN = 2
+} lto_internalize_strategy;
+
+/** opaque reference to a loaded object module */
+typedef struct LTOModule*         lto_module_t;
+
+/** opaque reference to a code generator */
+typedef struct LTOCodeGenerator*  lto_code_gen_t;
+
+#ifdef __cplusplus
+extern "C" {
+#endif
+
+/**
+ * Returns a printable string.
+ */
+extern const char*
+lto_get_version(void);
+
+
+/**
+ * Returns the last error string or NULL if last operation was successful.
+ */
+extern const char*
+lto_get_error_message(void);
+
+/**
+ * Checks if a file is a loadable object file.
+ */
+extern lto_bool_t
+lto_module_is_object_file(const char* path);
+
+
+/**
+ * Checks if a file is a loadable object compiled for requested target.
+ */
+extern lto_bool_t
+lto_module_is_object_file_for_target(const char* path,
+                                     const char* target_triple_prefix);
+
+
+/**
+ * Checks if a buffer is a loadable object file.
+ */
+extern lto_bool_t
+lto_module_is_object_file_in_memory(const void* mem, size_t length);
+
+
+/**
+ * Checks if a buffer is a loadable object compiled for requested target.
+ */
+extern lto_bool_t
+lto_module_is_object_file_in_memory_for_target(const void* mem, size_t length,
+                                              const char* target_triple_prefix);
+
+
+/**
+ * Loads an object file from disk.
+ * Returns NULL on error (check lto_get_error_message() for details).
+ */
+extern lto_module_t
+lto_module_create(const char* path);
+
+
+/**
+ * Loads an object file from memory.
+ * Returns NULL on error (check lto_get_error_message() for details).
+ */
+extern lto_module_t
+lto_module_create_from_memory(const void* mem, size_t length);
+
+/**
+ * Loads an object file from disk. The seek point of fd is not preserved.
+ * Returns NULL on error (check lto_get_error_message() for details).
+ */
+extern lto_module_t
+lto_module_create_from_fd(int fd, const char *path, size_t file_size);
+
+/**
+ * Loads an object file from disk. The seek point of fd is not preserved.
+ * Returns NULL on error (check lto_get_error_message() for details).
+ */
+extern lto_module_t
+lto_module_create_from_fd_at_offset(int fd, const char *path, size_t file_size,
+                                    size_t map_size, off_t offset);
+
+
+/**
+ * Frees all memory internally allocated by the module.
+ * Upon return the lto_module_t is no longer valid.
+ */
+extern void
+lto_module_dispose(lto_module_t mod);
+
+
+/**
+ * Returns triple string which the object module was compiled under.
+ */
+extern const char*
+lto_module_get_target_triple(lto_module_t mod);
+
+/**
+ * Sets triple string with which the object will be codegened.
+ */
+extern void
+lto_module_set_target_triple(lto_module_t mod, const char *triple);
+
+
+/**
+ * Returns the number of symbols in the object module.
+ */
+extern unsigned int
+lto_module_get_num_symbols(lto_module_t mod);
+
+
+/**
+ * Returns the name of the ith symbol in the object module.
+ */
+extern const char*
+lto_module_get_symbol_name(lto_module_t mod, unsigned int index);
+
+
+/**
+ * Returns the attributes of the ith symbol in the object module.
+ */
+extern lto_symbol_attributes
+lto_module_get_symbol_attribute(lto_module_t mod, unsigned int index);
+
+/**
+ * Diagnostic severity.
+ */
+typedef enum {
+  LTO_DS_ERROR,
+  LTO_DS_WARNING,
+  LTO_DS_NOTE
+} lto_codegen_diagnostic_severity_t;
+
+/**
+ * Diagnostic handler type.
+ * \p severity defines the severity.
+ * \p diag is the actual diagnostic.
+ * The diagnostic is not prefixed by any of severity keyword, e.g., 'error: '.
+ * \p ctxt is used to pass the context set with the diagnostic handler.
+ */
+typedef void (*lto_diagnostic_handler_t)(
+    lto_codegen_diagnostic_severity_t severity, const char *diag, void *ctxt);
+
+/**
+ * Set a diagnostic handler and the related context (void *).
+ * This is more general than lto_get_error_message, as the diagnostic handler
+ * can be called at anytime within lto.
+ */
+extern void lto_codegen_set_diagnostic_handler(lto_code_gen_t,
+                                               lto_diagnostic_handler_t,
+                                               void *);
+
+/**
+ * Instantiates a code generator.
+ * Returns NULL on error (check lto_get_error_message() for details).
+ */
+extern lto_code_gen_t
+lto_codegen_create(void);
+
+
+/**
+ * Frees all code generator and all memory it internally allocated.
+ * Upon return the lto_code_gen_t is no longer valid.
+ */
+extern void
+lto_codegen_dispose(lto_code_gen_t);
+
+
+
+/**
+ * Add an object module to the set of modules for which code will be generated.
+ * Returns true on error (check lto_get_error_message() for details).
+ */
+extern lto_bool_t
+lto_codegen_add_module(lto_code_gen_t cg, lto_module_t mod);
+
+
+
+/**
+ * Sets if debug info should be generated.
+ * Returns true on error (check lto_get_error_message() for details).
+ */
+extern lto_bool_t
+lto_codegen_set_debug_model(lto_code_gen_t cg, lto_debug_model);
+
+
+/**
+ * Sets which PIC code model to generated.
+ * Returns true on error (check lto_get_error_message() for details).
+ */
+extern lto_bool_t
+lto_codegen_set_pic_model(lto_code_gen_t cg, lto_codegen_model);
+
+
+/**
+ * Sets the cpu to generate code for.
+ */
+extern void
+lto_codegen_set_cpu(lto_code_gen_t cg, const char *cpu);
+
+
+/**
+ * Sets the location of the assembler tool to run. If not set, libLTO
+ * will use gcc to invoke the assembler.
+ */
+extern void
+lto_codegen_set_assembler_path(lto_code_gen_t cg, const char* path);
+
+/**
+ * Sets extra arguments that libLTO should pass to the assembler.
+ */
+extern void
+lto_codegen_set_assembler_args(lto_code_gen_t cg, const char **args,
+                               int nargs);
+
+/**
+ * Sets the strategy to use during internalize.  Default strategy is
+ * LTO_INTERNALIZE_FULL.
+ */
+extern void
+lto_codegen_set_internalize_strategy(lto_code_gen_t cg,
+                                     lto_internalize_strategy);
+
+/**
+ * Tells LTO optimization passes that this symbol must be preserved
+ * because it is referenced by native code or a command line option.
+ */
+extern void
+lto_codegen_add_must_preserve_symbol(lto_code_gen_t cg, const char* symbol);
+
+/**
+ * Writes a new object file at the specified path that contains the
+ * merged contents of all modules added so far.
+ * Returns true on error (check lto_get_error_message() for details).
+ */
+extern lto_bool_t
+lto_codegen_write_merged_modules(lto_code_gen_t cg, const char* path);
+
+/**
+ * Generates code for all added modules into one native object file.
+ * On success returns a pointer to a generated mach-o/ELF buffer and
+ * length set to the buffer size.  The buffer is owned by the
+ * lto_code_gen_t and will be freed when lto_codegen_dispose()
+ * is called, or lto_codegen_compile() is called again.
+ * On failure, returns NULL (check lto_get_error_message() for details).
+ */
+extern const void*
+lto_codegen_compile(lto_code_gen_t cg, size_t* length);
+
+/**
+ * Generates code for all added modules into one native object file.
+ * The name of the file is written to name. Returns true on error.
+ */
+extern lto_bool_t
+lto_codegen_compile_to_file(lto_code_gen_t cg, const char** name);
+
+
+/**
+ * Sets options to help debug codegen bugs.
+ */
+extern void
+lto_codegen_debug_options(lto_code_gen_t cg, const char *);
+
+/**
+ * Initializes LLVM disassemblers.
+ * FIXME: This doesn't really belong here.
+ */
+extern void
+lto_initialize_disassembler(void);
+
+#ifdef __cplusplus
+}
+#endif
+
+/**
+ * @}
+ */
+
+#endif
diff -Nur cctools-877.5/include/mach/arm/thread_state.h cctools-877.5-AnV/include/mach/arm/thread_state.h
--- cctools-877.5/include/mach/arm/thread_state.h	2013-12-10 19:28:11 +0000
+++ cctools-877.5-AnV/include/mach/arm/thread_state.h	2015-11-19 09:03:07 +0000
@@ -8,6 +8,9 @@
 #ifndef _MACH_ARM_THREAD_STATE_H_
 #define _MACH_ARM_THREAD_STATE_H_
 
+#include "_structs.h"
+#include "thread_status.h"
+
 #define ARM_THREAD_STATE_MAX	(272)
 
 #if defined (__arm__)
diff -Nur cctools-877.5/include/mach/audit_triggers.defs cctools-877.5-AnV/include/mach/audit_triggers.defs
--- cctools-877.5/include/mach/audit_triggers.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/audit_triggers.defs	2015-11-16 07:56:12 +0000
@@ -0,0 +1,49 @@
+/*
+ * Copyright (c) 2004-2008, Apple Inc.  All rights reserved.
+ * 
+ * @APPLE_BSD_LICENSE_HEADER_START@
+ * 
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 
+ * 1.  Redistributions of source code must retain the above copyright
+ *     notice, this list of conditions and the following disclaimer. 
+ * 2.  Redistributions in binary form must reproduce the above copyright
+ *     notice, this list of conditions and the following disclaimer in the
+ *     documentation and/or other materials provided with the distribution. 
+ * 3.  Neither the name of Apple Inc. ("Apple") nor the names of
+ *     its contributors may be used to endorse or promote products derived
+ *     from this software without specific prior written permission. 
+ * 
+ * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND ANY
+ * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+ * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
+ * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
+ * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ * 
+ * @APPLE_BSD_LICENSE_HEADER_END@
+*/
+
+/*
+ *  Interface definition for the audit logging facility.
+ */
+
+subsystem
+#if	KERNEL_USER
+    KernelUser
+#endif	/* KERNEL_USER */
+    audit_triggers 123;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+simpleroutine	audit_triggers(
+		audit_port	: mach_port_t; 
+	in	flags		: int);
+
diff -Nur cctools-877.5/include/mach/boolean.h cctools-877.5-AnV/include/mach/boolean.h
--- cctools-877.5/include/mach/boolean.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/boolean.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,88 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/boolean.h
+ *
+ *	Boolean data type.
+ *
+ */
+
+#ifndef	_MACH_BOOLEAN_H_
+#define	_MACH_BOOLEAN_H_
+
+/*
+ *	Pick up "boolean_t" type definition
+ */
+
+#ifndef	ASSEMBLER
+#include <mach/machine/boolean.h>
+#endif	/* ASSEMBLER */
+
+/*
+ *	Define TRUE and FALSE if not defined.
+ */
+
+#ifndef	TRUE
+#define TRUE	1
+#endif	/* TRUE */
+
+#ifndef	FALSE
+#define FALSE	0
+#endif	/* FALSE */
+
+#endif	/* _MACH_BOOLEAN_H_ */
diff -Nur cctools-877.5/include/mach/bootstrap.h cctools-877.5-AnV/include/mach/bootstrap.h
--- cctools-877.5/include/mach/bootstrap.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/bootstrap.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,34 @@
+/*
+ * Copyright (c) 2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Mach bootstrap interfaces (obsolete: header included only for compatibility)
+ */
+#ifndef	_MACH_BOOTSTRAP_H_
+#define _MACH_BOOTSTRAP_H_
+
+#endif /* _MACH_BOOTSTRAP_H_ */
diff -Nur cctools-877.5/include/mach/clock.defs cctools-877.5-AnV/include/mach/clock.defs
--- cctools-877.5/include/mach/clock.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/clock.defs	2015-11-16 07:56:12 +0000
@@ -0,0 +1,81 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ * 	File:		mach/clock.defs
+ *	Purpose:	Kernel clock subsystem definitions. This
+ *			file defines the clock request interface.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		       clock 1000;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach/clock_types.defs>
+
+/*
+ * References to clock objects are returned by:
+ *	host_get_clock_service(host_t,...)
+ *	host_get_clock_control(host_priv_t,...) - Priviledged subclass
+ */
+
+/*
+ *	Get the clock time.
+ *	Available to all.
+ */
+routine	clock_get_time(
+		clock_serv	: clock_serv_t;
+	out	cur_time	: mach_timespec_t);
+
+/*
+ *	Get clock attributes.
+ *	Available to all.
+ */
+routine	clock_get_attributes(
+		clock_serv	: clock_serv_t;
+	in	flavor		: clock_flavor_t;
+	out	clock_attr	: clock_attr_t, CountInOut);
+
+/*
+ *	Setup a clock alarm.
+ *	Available to all.
+ */
+routine clock_alarm(
+		clock_serv	: clock_serv_t;
+		alarm_type	: alarm_type_t;
+		alarm_time	: mach_timespec_t;
+                alarm_port      : clock_reply_t =
+			MACH_MSG_TYPE_MAKE_SEND_ONCE|polymorphic);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/clock.h cctools-877.5-AnV/include/mach/clock.h
--- cctools-877.5/include/mach/clock.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/clock.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,222 @@
+#ifndef	_clock_user_
+#define	_clock_user_
+
+/* Module clock */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	clock_MSG_COUNT
+#define	clock_MSG_COUNT	3
+#endif	/* clock_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine clock_get_time */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t clock_get_time
+(
+	clock_serv_t clock_serv,
+	mach_timespec_t *cur_time
+);
+
+/* Routine clock_get_attributes */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t clock_get_attributes
+(
+	clock_serv_t clock_serv,
+	clock_flavor_t flavor,
+	clock_attr_t clock_attr,
+	mach_msg_type_number_t *clock_attrCnt
+);
+
+/* Routine clock_alarm */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t clock_alarm
+(
+	clock_serv_t clock_serv,
+	alarm_type_t alarm_type,
+	mach_timespec_t alarm_time,
+	clock_reply_t alarm_port
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__clock_subsystem__defined
+#define __Request__clock_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__clock_get_time_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		clock_flavor_t flavor;
+		mach_msg_type_number_t clock_attrCnt;
+	} __Request__clock_get_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t alarm_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		alarm_type_t alarm_type;
+		mach_timespec_t alarm_time;
+	} __Request__clock_alarm_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__clock_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__clock_subsystem__defined
+#define __RequestUnion__clock_subsystem__defined
+union __RequestUnion__clock_subsystem {
+	__Request__clock_get_time_t Request_clock_get_time;
+	__Request__clock_get_attributes_t Request_clock_get_attributes;
+	__Request__clock_alarm_t Request_clock_alarm;
+};
+#endif /* !__RequestUnion__clock_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__clock_subsystem__defined
+#define __Reply__clock_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_timespec_t cur_time;
+	} __Reply__clock_get_time_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t clock_attrCnt;
+		int clock_attr[1];
+	} __Reply__clock_get_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__clock_alarm_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__clock_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__clock_subsystem__defined
+#define __ReplyUnion__clock_subsystem__defined
+union __ReplyUnion__clock_subsystem {
+	__Reply__clock_get_time_t Reply_clock_get_time;
+	__Reply__clock_get_attributes_t Reply_clock_get_attributes;
+	__Reply__clock_alarm_t Reply_clock_alarm;
+};
+#endif /* !__RequestUnion__clock_subsystem__defined */
+
+#ifndef subsystem_to_name_map_clock
+#define subsystem_to_name_map_clock \
+    { "clock_get_time", 1000 },\
+    { "clock_get_attributes", 1001 },\
+    { "clock_alarm", 1002 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _clock_user_ */
diff -Nur cctools-877.5/include/mach/clock_priv.defs cctools-877.5-AnV/include/mach/clock_priv.defs
--- cctools-877.5/include/mach/clock_priv.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/clock_priv.defs	2015-11-16 07:56:12 +0000
@@ -0,0 +1,69 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ * 	File:		mach/clock_priv.defs
+ *	Purpose:	Kernel clock subsystem definitions. This
+ *			file defines the clock request interface.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		       clock_priv 1200;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach/clock_types.defs>
+
+/*
+ * References to clock_priv objects are returned by:
+ *	host_get_clock_control(host_priv_t,...) - Priviledged subclass
+ */
+
+/*
+ *	Set the clock time.
+ *	Privileged.
+ */
+routine	clock_set_time(
+		clock_ctrl	: clock_ctrl_t;
+		new_time	: mach_timespec_t);
+
+/*
+ *	Set clock attributes.
+ *	Privileged.
+ */
+routine	clock_set_attributes(
+		clock_ctrl	: clock_ctrl_t;
+	in	flavor		: clock_flavor_t;
+	in	clock_attr	: clock_attr_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/clock_priv.h cctools-877.5-AnV/include/mach/clock_priv.h
--- cctools-877.5/include/mach/clock_priv.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/clock_priv.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,176 @@
+#ifndef	_clock_priv_user_
+#define	_clock_priv_user_
+
+/* Module clock_priv */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	clock_priv_MSG_COUNT
+#define	clock_priv_MSG_COUNT	2
+#endif	/* clock_priv_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine clock_set_time */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t clock_set_time
+(
+	clock_ctrl_t clock_ctrl,
+	mach_timespec_t new_time
+);
+
+/* Routine clock_set_attributes */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t clock_set_attributes
+(
+	clock_ctrl_t clock_ctrl,
+	clock_flavor_t flavor,
+	clock_attr_t clock_attr,
+	mach_msg_type_number_t clock_attrCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__clock_priv_subsystem__defined
+#define __Request__clock_priv_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_timespec_t new_time;
+	} __Request__clock_set_time_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		clock_flavor_t flavor;
+		mach_msg_type_number_t clock_attrCnt;
+		int clock_attr[1];
+	} __Request__clock_set_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__clock_priv_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__clock_priv_subsystem__defined
+#define __RequestUnion__clock_priv_subsystem__defined
+union __RequestUnion__clock_priv_subsystem {
+	__Request__clock_set_time_t Request_clock_set_time;
+	__Request__clock_set_attributes_t Request_clock_set_attributes;
+};
+#endif /* !__RequestUnion__clock_priv_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__clock_priv_subsystem__defined
+#define __Reply__clock_priv_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__clock_set_time_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__clock_set_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__clock_priv_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__clock_priv_subsystem__defined
+#define __ReplyUnion__clock_priv_subsystem__defined
+union __ReplyUnion__clock_priv_subsystem {
+	__Reply__clock_set_time_t Reply_clock_set_time;
+	__Reply__clock_set_attributes_t Reply_clock_set_attributes;
+};
+#endif /* !__RequestUnion__clock_priv_subsystem__defined */
+
+#ifndef subsystem_to_name_map_clock_priv
+#define subsystem_to_name_map_clock_priv \
+    { "clock_set_time", 1200 },\
+    { "clock_set_attributes", 1201 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _clock_priv_user_ */
diff -Nur cctools-877.5/include/mach/clock_reply.defs cctools-877.5-AnV/include/mach/clock_reply.defs
--- cctools-877.5/include/mach/clock_reply.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/clock_reply.defs	2015-11-16 07:56:12 +0000
@@ -0,0 +1,56 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ *	File:		clock_reply.defs
+ *	Purpose:	Kernel clock subsystem definitions. This
+ *			file defines the clock reply interface.
+ */
+
+subsystem
+#if	KERNEL_USER
+	  KernelUser
+#endif	/* KERNEL_USER */
+		     clock_reply 3125107;  /* Matches up with old value */
+
+#include <mach/std_types.defs>
+#include <mach/clock_types.defs>
+
+
+/*
+ *	Reply routine for clock_alarm. 
+ */
+simpleroutine clock_alarm_reply(
+                alarm_port      : clock_reply_t;
+		alarm_code	: kern_return_t;
+		alarm_type	: alarm_type_t;
+		alarm_time	: mach_timespec_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/clock_reply.h cctools-877.5-AnV/include/mach/clock_reply.h
--- cctools-877.5/include/mach/clock_reply.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/clock_reply.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,136 @@
+#ifndef	_clock_reply_user_
+#define	_clock_reply_user_
+
+/* Module clock_reply */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	clock_reply_MSG_COUNT
+#define	clock_reply_MSG_COUNT	1
+#endif	/* clock_reply_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* SimpleRoutine clock_alarm_reply */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t clock_alarm_reply
+(
+	clock_reply_t alarm_port,
+	mach_msg_type_name_t alarm_portPoly,
+	kern_return_t alarm_code,
+	alarm_type_t alarm_type,
+	mach_timespec_t alarm_time
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__clock_reply_subsystem__defined
+#define __Request__clock_reply_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t alarm_code;
+		alarm_type_t alarm_type;
+		mach_timespec_t alarm_time;
+	} __Request__clock_alarm_reply_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__clock_reply_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__clock_reply_subsystem__defined
+#define __RequestUnion__clock_reply_subsystem__defined
+union __RequestUnion__clock_reply_subsystem {
+	__Request__clock_alarm_reply_t Request_clock_alarm_reply;
+};
+#endif /* !__RequestUnion__clock_reply_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__clock_reply_subsystem__defined
+#define __Reply__clock_reply_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__clock_alarm_reply_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__clock_reply_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__clock_reply_subsystem__defined
+#define __ReplyUnion__clock_reply_subsystem__defined
+union __ReplyUnion__clock_reply_subsystem {
+	__Reply__clock_alarm_reply_t Reply_clock_alarm_reply;
+};
+#endif /* !__RequestUnion__clock_reply_subsystem__defined */
+
+#ifndef subsystem_to_name_map_clock_reply
+#define subsystem_to_name_map_clock_reply \
+    { "clock_alarm_reply", 3125107 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _clock_reply_user_ */
diff -Nur cctools-877.5/include/mach/clock_types.defs cctools-877.5-AnV/include/mach/clock_types.defs
--- cctools-877.5/include/mach/clock_types.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/clock_types.defs	2015-11-16 07:56:12 +0000
@@ -0,0 +1,73 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ *	File:		clock_types.defs
+ *	Purpose:
+ *		Clock kernel interface type declarations
+ */
+
+#ifndef	_MACH_CLOCK_TYPES_DEFS_
+#define _MACH_CLOCK_TYPES_DEFS_
+
+#include <mach/std_types.defs>
+
+type clock_serv_t = mach_port_t
+		cusertype: clock_serv_t
+#if	KERNEL_SERVER
+		intran: clock_serv_t convert_port_to_clock(mach_port_t)
+		outtran: mach_port_t convert_clock_to_port(clock_serv_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type clock_ctrl_t = mach_port_t
+		cusertype: clock_ctrl_t
+#if	KERNEL_SERVER
+		intran: clock_ctrl_t convert_port_to_clock_ctrl(mach_port_t)
+		outtran: mach_port_t convert_clock_ctrl_to_port(clock_ctrl_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type clock_reply_t = polymorphic|MACH_MSG_TYPE_MAKE_SEND_ONCE;
+
+type clock_flavor_t = int;
+type clock_attr_t = array[*:1] of int;
+type mach_timespec_t	= struct[2] of int;
+type time_t = int;
+type sleep_type_t = int;
+type alarm_type_t = int;
+type clock_res_t = int;
+type clock_id_t = int;
+
+import <mach/mach_types.h>;
+
+#endif	/* _MACH_CLOCK_TYPES_DEFS_ */
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/clock_types.h cctools-877.5-AnV/include/mach/clock_types.h
--- cctools-877.5/include/mach/clock_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/clock_types.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,127 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ *	File:		clock_types.h
+ *	Purpose:	Clock facility header definitions. These
+ *				definitons are needed by both kernel and
+ *				user-level software.
+ */
+
+/*
+ *	All interfaces defined here are obsolete.
+ */
+
+#ifndef	_MACH_CLOCK_TYPES_H_
+#define	_MACH_CLOCK_TYPES_H_
+
+#include <stdint.h>
+#include <mach/time_value.h>
+
+/*
+ * Type definitions.
+ */
+typedef	int	alarm_type_t;		/* alarm time type */
+typedef int	sleep_type_t;		/* sleep time type */
+typedef	int	clock_id_t;			/* clock identification type */
+typedef int	clock_flavor_t;		/* clock flavor type */
+typedef int	*clock_attr_t;		/* clock attribute type */
+typedef int	clock_res_t;		/* clock resolution type */
+
+/*
+ * Normal time specification used by the kernel clock facility.
+ */
+struct mach_timespec {
+	unsigned int	tv_sec;			/* seconds */
+	clock_res_t		tv_nsec;		/* nanoseconds */
+};
+typedef struct mach_timespec	mach_timespec_t;
+
+/*
+ * Reserved clock id values for default clocks.
+ */
+#define SYSTEM_CLOCK		0
+#define CALENDAR_CLOCK		1
+
+#define REALTIME_CLOCK		0
+
+/*
+ * Attribute names.
+ */
+#define	CLOCK_GET_TIME_RES	1	/* get_time call resolution */
+/*							2	 * was map_time call resolution */
+#define CLOCK_ALARM_CURRES	3	/* current alarm resolution */
+#define CLOCK_ALARM_MINRES	4	/* minimum alarm resolution */
+#define CLOCK_ALARM_MAXRES	5	/* maximum alarm resolution */
+
+#define NSEC_PER_USEC	1000ull		/* nanoseconds per microsecond */
+#define USEC_PER_SEC	1000000ull	/* microseconds per second */
+#define NSEC_PER_SEC	1000000000ull	/* nanoseconds per second */
+#define NSEC_PER_MSEC	1000000ull	/* nanoseconds per millisecond */
+
+#define BAD_MACH_TIMESPEC(t)						\
+	((t)->tv_nsec < 0 || (t)->tv_nsec >= (long)NSEC_PER_SEC)
+
+/* t1 <=> t2, also (t1 - t2) in nsec with max of +- 1 sec */
+#define CMP_MACH_TIMESPEC(t1, t2)					\
+	((t1)->tv_sec > (t2)->tv_sec ? (long) +NSEC_PER_SEC :	\
+	((t1)->tv_sec < (t2)->tv_sec ? (long) -NSEC_PER_SEC :	\
+			(t1)->tv_nsec - (t2)->tv_nsec))
+
+/* t1  += t2 */
+#define ADD_MACH_TIMESPEC(t1, t2)								\
+  do {															\
+	if (((t1)->tv_nsec += (t2)->tv_nsec) >= (long) NSEC_PER_SEC) {		\
+		(t1)->tv_nsec -= (long) NSEC_PER_SEC;							\
+		(t1)->tv_sec  += 1;										\
+	}															\
+	(t1)->tv_sec += (t2)->tv_sec;								\
+  } while (0)
+
+/* t1  -= t2 */
+#define SUB_MACH_TIMESPEC(t1, t2)								\
+  do {															\
+	if (((t1)->tv_nsec -= (t2)->tv_nsec) < 0) {					\
+		(t1)->tv_nsec += (long) NSEC_PER_SEC;							\
+		(t1)->tv_sec  -= 1;										\
+	}															\
+	(t1)->tv_sec -= (t2)->tv_sec;								\
+  } while (0)
+
+/*
+ * Alarm parameter defines.
+ */
+#define ALRMTYPE			0xff		/* type (8-bit field)	*/
+#define TIME_ABSOLUTE		0x00		/* absolute time */
+#define	TIME_RELATIVE		0x01		/* relative time */
+
+#define BAD_ALRMTYPE(t)		(((t) &~ TIME_RELATIVE) != 0)
+
+#endif /* _MACH_CLOCK_TYPES_H_ */
diff -Nur cctools-877.5/include/mach/error.h cctools-877.5-AnV/include/mach/error.h
--- cctools-877.5/include/mach/error.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/error.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,114 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ * File:	mach/error.h
+ * Purpose:
+ *	error module definitions
+ *
+ */
+
+#ifndef	_MACH_ERROR_H_
+#define	_MACH_ERROR_H_
+
+#include <mach/kern_return.h>
+
+/*
+ *	error number layout as follows:
+ *
+ *	hi		 		       lo
+ *	| system(6) | subsystem(12) | code(14) |
+ */
+
+
+#define	err_none		(mach_error_t)0
+#define ERR_SUCCESS		(mach_error_t)0
+#define	ERR_ROUTINE_NIL		(mach_error_fn_t)0
+
+
+#define	err_system(x)		(((x)&0x3f)<<26)
+#define err_sub(x)		(((x)&0xfff)<<14)
+
+#define err_get_system(err)	(((err)>>26)&0x3f)
+#define err_get_sub(err)	(((err)>>14)&0xfff)
+#define err_get_code(err)	((err)&0x3fff)
+
+#define system_emask		(err_system(0x3f))
+#define sub_emask		(err_sub(0xfff))
+#define code_emask		(0x3fff)
+
+
+/*	major error systems	*/
+#define	err_kern		err_system(0x0)		/* kernel */
+#define	err_us			err_system(0x1)		/* user space library */
+#define	err_server		err_system(0x2)		/* user space servers */
+#define	err_ipc			err_system(0x3)		/* old ipc errors */
+#define err_mach_ipc		err_system(0x4)		/* mach-ipc errors */
+#define	err_dipc		err_system(0x7)		/* distributed ipc */
+#define err_local		err_system(0x3e)	/* user defined errors */
+#define	err_ipc_compat		err_system(0x3f)	/* (compatibility) mach-ipc errors */
+
+#define	err_max_system		0x3f
+
+
+/*	unix errors get lumped into one subsystem  */
+#define	unix_err(errno)		(err_kern|err_sub(3)|errno)
+
+typedef	kern_return_t	mach_error_t;
+typedef mach_error_t	(* mach_error_fn_t)( void );
+
+#endif	/* _MACH_ERROR_H_ */
diff -Nur cctools-877.5/include/mach/exc.defs cctools-877.5-AnV/include/mach/exc.defs
--- cctools-877.5/include/mach/exc.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/exc.defs	2015-11-16 07:56:12 +0000
@@ -0,0 +1,119 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ * Abstract:
+ *	MiG definitions file for Mach exception interface.
+ */
+
+subsystem
+#if	KERNEL_USER
+	  KernelUser
+#endif
+		     exc 2401;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+ServerPrefix catch_;
+
+type exception_data_t		= array[*:2] of integer_t;
+type exception_type_t		= int;
+
+routine		exception_raise(
+#if	KERNEL_USER
+			exception_port	: mach_port_move_send_t;
+			thread		: mach_port_move_send_t;
+			task		: mach_port_move_send_t;
+#else	/* KERNEL_USER */
+			exception_port	: mach_port_t;
+			thread		: mach_port_t;
+			task		: mach_port_t;
+#endif	/* KERNEL_USER */
+			exception	: exception_type_t;
+			code		: exception_data_t
+			);
+
+routine		exception_raise_state(
+#if	KERNEL_USER
+			exception_port	: mach_port_move_send_t;
+#else	/* KERNEL_USER */
+			exception_port	: mach_port_t;
+#endif	/* KERNEL_USER */
+			exception	: exception_type_t;
+			code		: exception_data_t, const;
+		  inout flavor		: int;
+			old_state	: thread_state_t, const;
+		    out new_state	: thread_state_t);
+
+routine		exception_raise_state_identity(
+#if	KERNEL_USER
+			exception_port  : mach_port_move_send_t;
+			thread		: mach_port_move_send_t;
+			task		: mach_port_move_send_t;
+#else	/* KERNEL_USER */
+			exception_port  : mach_port_t;
+			thread          : mach_port_t;
+			task            : mach_port_t;
+#endif	/* KERNEL_USER */
+			exception       : exception_type_t;
+			code            : exception_data_t;
+		  inout flavor          : int;
+			old_state       : thread_state_t;
+		    out new_state       : thread_state_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/exc.h cctools-877.5-AnV/include/mach/exc.h
--- cctools-877.5/include/mach/exc.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/exc.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,258 @@
+#ifndef	_exc_user_
+#define	_exc_user_
+
+/* Module exc */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	exc_MSG_COUNT
+#define	exc_MSG_COUNT	3
+#endif	/* exc_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine exception_raise */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t exception_raise
+(
+	mach_port_t exception_port,
+	mach_port_t thread,
+	mach_port_t task,
+	exception_type_t exception,
+	exception_data_t code,
+	mach_msg_type_number_t codeCnt
+);
+
+/* Routine exception_raise_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t exception_raise_state
+(
+	mach_port_t exception_port,
+	exception_type_t exception,
+	const exception_data_t code,
+	mach_msg_type_number_t codeCnt,
+	int *flavor,
+	const thread_state_t old_state,
+	mach_msg_type_number_t old_stateCnt,
+	thread_state_t new_state,
+	mach_msg_type_number_t *new_stateCnt
+);
+
+/* Routine exception_raise_state_identity */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t exception_raise_state_identity
+(
+	mach_port_t exception_port,
+	mach_port_t thread,
+	mach_port_t task,
+	exception_type_t exception,
+	exception_data_t code,
+	mach_msg_type_number_t codeCnt,
+	int *flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t old_stateCnt,
+	thread_state_t new_state,
+	mach_msg_type_number_t *new_stateCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__exc_subsystem__defined
+#define __Request__exc_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t thread;
+		mach_msg_port_descriptor_t task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_type_t exception;
+		mach_msg_type_number_t codeCnt;
+		integer_t code[2];
+	} __Request__exception_raise_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_type_t exception;
+		mach_msg_type_number_t codeCnt;
+		integer_t code[2];
+		int flavor;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[224];
+	} __Request__exception_raise_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t thread;
+		mach_msg_port_descriptor_t task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_type_t exception;
+		mach_msg_type_number_t codeCnt;
+		integer_t code[2];
+		int flavor;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[224];
+	} __Request__exception_raise_state_identity_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__exc_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__exc_subsystem__defined
+#define __RequestUnion__exc_subsystem__defined
+union __RequestUnion__exc_subsystem {
+	__Request__exception_raise_t Request_exception_raise;
+	__Request__exception_raise_state_t Request_exception_raise_state;
+	__Request__exception_raise_state_identity_t Request_exception_raise_state_identity;
+};
+#endif /* !__RequestUnion__exc_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__exc_subsystem__defined
+#define __Reply__exc_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__exception_raise_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		int flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[224];
+	} __Reply__exception_raise_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		int flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[224];
+	} __Reply__exception_raise_state_identity_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__exc_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__exc_subsystem__defined
+#define __ReplyUnion__exc_subsystem__defined
+union __ReplyUnion__exc_subsystem {
+	__Reply__exception_raise_t Reply_exception_raise;
+	__Reply__exception_raise_state_t Reply_exception_raise_state;
+	__Reply__exception_raise_state_identity_t Reply_exception_raise_state_identity;
+};
+#endif /* !__RequestUnion__exc_subsystem__defined */
+
+#ifndef subsystem_to_name_map_exc
+#define subsystem_to_name_map_exc \
+    { "exception_raise", 2401 },\
+    { "exception_raise_state", 2402 },\
+    { "exception_raise_state_identity", 2403 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _exc_user_ */
diff -Nur cctools-877.5/include/mach/exception.h cctools-877.5-AnV/include/mach/exception.h
--- cctools-877.5/include/mach/exception.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/exception.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,62 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+
+#ifndef	_MACH_EXCEPTION_H_
+#define	_MACH_EXCEPTION_H_
+
+#include <mach/exception_types.h>
+
+#endif	/* _MACH_EXCEPTION_H_ */
diff -Nur cctools-877.5/include/mach/exception_types.h cctools-877.5-AnV/include/mach/exception_types.h
--- cctools-877.5/include/mach/exception_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/exception_types.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,195 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_MACH_EXCEPTION_TYPES_H_
+#define	_MACH_EXCEPTION_TYPES_H_
+
+#include <mach/machine/exception.h>
+
+/*
+ *	Machine-independent exception definitions.
+ */
+
+#define EXC_BAD_ACCESS		1	/* Could not access memory */
+		/* Code contains kern_return_t describing error. */
+		/* Subcode contains bad memory address. */
+
+#define EXC_BAD_INSTRUCTION	2	/* Instruction failed */
+		/* Illegal or undefined instruction or operand */
+
+#define EXC_ARITHMETIC		3	/* Arithmetic exception */
+		/* Exact nature of exception is in code field */
+
+#define EXC_EMULATION		4	/* Emulation instruction */
+		/* Emulation support instruction encountered */
+		/* Details in code and subcode fields	*/
+
+#define EXC_SOFTWARE		5	/* Software generated exception */
+		/* Exact exception is in code field. */
+		/* Codes 0 - 0xFFFF reserved to hardware */
+		/* Codes 0x10000 - 0x1FFFF reserved for OS emulation (Unix) */
+
+#define EXC_BREAKPOINT		6	/* Trace, breakpoint, etc. */
+		/* Details in code field. */
+
+#define EXC_SYSCALL		7	/* System calls. */
+
+#define EXC_MACH_SYSCALL	8	/* Mach system calls. */
+
+#define EXC_RPC_ALERT		9	/* RPC alert */
+ 
+#define EXC_CRASH		10	/* Abnormal process exit */
+
+#define EXC_RESOURCE		11	/* Hit resource consumption limit */
+		/* Exact resource is in code field. */
+
+#define EXC_GUARD		12	/* Violated guarded resource protections */
+
+
+/*
+ *	Machine-independent exception behaviors
+ */
+
+# define EXCEPTION_DEFAULT		1
+/*	Send a catch_exception_raise message including the identity.
+ */
+
+# define EXCEPTION_STATE		2
+/*	Send a catch_exception_raise_state message including the
+ *	thread state.
+ */
+
+# define EXCEPTION_STATE_IDENTITY	3
+/*	Send a catch_exception_raise_state_identity message including
+ *	the thread identity and state.
+ */
+
+#define MACH_EXCEPTION_CODES		0x80000000
+/*	Send 64-bit code and subcode in the exception header */
+
+/*
+ * Masks for exception definitions, above
+ * bit zero is unused, therefore 1 word = 31 exception types
+ */
+
+#define EXC_MASK_BAD_ACCESS		(1 << EXC_BAD_ACCESS)
+#define EXC_MASK_BAD_INSTRUCTION	(1 << EXC_BAD_INSTRUCTION)
+#define EXC_MASK_ARITHMETIC		(1 << EXC_ARITHMETIC)
+#define EXC_MASK_EMULATION		(1 << EXC_EMULATION)
+#define EXC_MASK_SOFTWARE		(1 << EXC_SOFTWARE)
+#define EXC_MASK_BREAKPOINT		(1 << EXC_BREAKPOINT)
+#define EXC_MASK_SYSCALL		(1 << EXC_SYSCALL)
+#define EXC_MASK_MACH_SYSCALL		(1 << EXC_MACH_SYSCALL)
+#define EXC_MASK_RPC_ALERT		(1 << EXC_RPC_ALERT)
+#define EXC_MASK_CRASH			(1 << EXC_CRASH)
+#define EXC_MASK_RESOURCE		(1 << EXC_RESOURCE)
+#define EXC_MASK_GUARD			(1 << EXC_GUARD)
+
+#define EXC_MASK_ALL	(EXC_MASK_BAD_ACCESS |			\
+			 EXC_MASK_BAD_INSTRUCTION |		\
+			 EXC_MASK_ARITHMETIC |			\
+			 EXC_MASK_EMULATION |			\
+			 EXC_MASK_SOFTWARE |			\
+			 EXC_MASK_BREAKPOINT |			\
+			 EXC_MASK_SYSCALL |			\
+			 EXC_MASK_MACH_SYSCALL |		\
+			 EXC_MASK_RPC_ALERT |			\
+			 EXC_MASK_RESOURCE |			\
+			 EXC_MASK_GUARD |			\
+			 EXC_MASK_MACHINE)
+
+
+#define FIRST_EXCEPTION		1	/* ZERO is illegal */
+
+/*
+ * Machine independent codes for EXC_SOFTWARE
+ * Codes 0x10000 - 0x1FFFF reserved for OS emulation (Unix) 
+ * 0x10000 - 0x10002 in use for unix signals
+ * 0x20000 - 0x2FFFF reserved for MACF
+ */
+#define	EXC_SOFT_SIGNAL		0x10003	/* Unix signal exceptions */
+
+#define	EXC_MACF_MIN		0x20000 /* MACF exceptions */
+#define	EXC_MACF_MAX		0x2FFFF
+
+#ifndef	ASSEMBLER
+
+#include <mach/port.h>
+#include <mach/thread_status.h>
+#include <mach/machine/vm_types.h>
+/*
+ * Exported types
+ */
+
+typedef int				exception_type_t;
+typedef	integer_t			exception_data_type_t;
+typedef	int64_t				mach_exception_data_type_t;
+typedef int				exception_behavior_t;
+typedef exception_data_type_t		*exception_data_t;
+typedef mach_exception_data_type_t	*mach_exception_data_t;
+typedef	unsigned int			exception_mask_t;
+typedef	exception_mask_t		*exception_mask_array_t;
+typedef exception_behavior_t		*exception_behavior_array_t;
+typedef thread_state_flavor_t		*exception_flavor_array_t;
+typedef mach_port_t			*exception_port_array_t;
+typedef	mach_exception_data_type_t	mach_exception_code_t;
+typedef	mach_exception_data_type_t	mach_exception_subcode_t;
+
+#endif	/* ASSEMBLER */
+
+#endif	/* _MACH_EXCEPTION_TYPES_H_ */
diff -Nur cctools-877.5/include/mach/host_info.h cctools-877.5-AnV/include/mach/host_info.h
--- cctools-877.5/include/mach/host_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/host_info.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,241 @@
+/*
+ * Copyright (c) 2000-2009 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	mach/host_info.h
+ *
+ *	Definitions for host_info call.
+ */
+
+#ifndef	_MACH_HOST_INFO_H_
+#define	_MACH_HOST_INFO_H_
+
+#include <mach/message.h>
+#include <mach/vm_statistics.h>
+#include <mach/machine.h>
+#include <mach/machine/vm_types.h>
+#include <mach/time_value.h>
+
+#include <sys/cdefs.h>
+
+/*
+ *	Generic information structure to allow for expansion.
+ */
+typedef integer_t	*host_info_t;		/* varying array of int. */
+typedef integer_t	*host_info64_t;		/* varying array of int. */
+
+#define	HOST_INFO_MAX	(1024)		/* max array size */
+typedef integer_t	host_info_data_t[HOST_INFO_MAX];
+
+#define KERNEL_VERSION_MAX (512)
+typedef char	kernel_version_t[KERNEL_VERSION_MAX];
+
+#define KERNEL_BOOT_INFO_MAX (4096)
+typedef char	kernel_boot_info_t[KERNEL_BOOT_INFO_MAX];
+
+/*
+ *	Currently defined information.
+ */
+/* host_info() */
+typedef	integer_t	host_flavor_t;
+#define HOST_BASIC_INFO		1	/* basic info */
+#define HOST_SCHED_INFO		3	/* scheduling info */
+#define HOST_RESOURCE_SIZES	4	/* kernel struct sizes */
+#define HOST_PRIORITY_INFO	5	/* priority information */
+#define HOST_SEMAPHORE_TRAPS	7	/* Has semaphore traps */
+#define HOST_MACH_MSG_TRAP	8	/* Has mach_msg_trap */
+#define HOST_VM_PURGABLE	9	/* purg'e'able memory info */
+
+
+#pragma pack(4)
+
+struct host_basic_info {
+	integer_t		max_cpus;		/* max number of CPUs possible */
+	integer_t		avail_cpus;		/* number of CPUs now available */
+	natural_t		memory_size;		/* size of memory in bytes, capped at 2 GB */
+	cpu_type_t		cpu_type;		/* cpu type */
+	cpu_subtype_t		cpu_subtype;		/* cpu subtype */
+	cpu_threadtype_t	cpu_threadtype;		/* cpu threadtype */
+	integer_t		physical_cpu;		/* number of physical CPUs now available */
+	integer_t		physical_cpu_max;	/* max number of physical CPUs possible */
+	integer_t		logical_cpu;		/* number of logical cpu now available */
+	integer_t		logical_cpu_max;	/* max number of physical CPUs possible */
+	uint64_t		max_mem;		/* actual size of physical memory */
+};
+
+#pragma pack()
+
+typedef	struct host_basic_info	host_basic_info_data_t;
+typedef struct host_basic_info	*host_basic_info_t;
+#define HOST_BASIC_INFO_COUNT ((mach_msg_type_number_t) \
+		(sizeof(host_basic_info_data_t)/sizeof(integer_t)))
+
+struct host_sched_info {
+	integer_t	min_timeout;	/* minimum timeout in milliseconds */
+	integer_t	min_quantum;	/* minimum quantum in milliseconds */
+};
+
+typedef	struct host_sched_info	host_sched_info_data_t;
+typedef struct host_sched_info	*host_sched_info_t;
+#define HOST_SCHED_INFO_COUNT ((mach_msg_type_number_t) \
+		(sizeof(host_sched_info_data_t)/sizeof(integer_t)))
+
+struct kernel_resource_sizes {
+	natural_t	task;
+        natural_t	thread;
+        natural_t	port;
+        natural_t	memory_region;
+        natural_t	memory_object;
+};
+
+typedef struct kernel_resource_sizes	kernel_resource_sizes_data_t;
+typedef struct kernel_resource_sizes	*kernel_resource_sizes_t;
+#define HOST_RESOURCE_SIZES_COUNT ((mach_msg_type_number_t) \
+		(sizeof(kernel_resource_sizes_data_t)/sizeof(integer_t)))
+
+struct host_priority_info {
+    	integer_t	kernel_priority;
+    	integer_t	system_priority;
+    	integer_t	server_priority;
+    	integer_t	user_priority;
+    	integer_t	depress_priority;
+    	integer_t	idle_priority;
+    	integer_t	minimum_priority;
+	integer_t	maximum_priority;
+};
+
+typedef struct host_priority_info	host_priority_info_data_t;
+typedef struct host_priority_info	*host_priority_info_t;
+#define HOST_PRIORITY_INFO_COUNT ((mach_msg_type_number_t) \
+		(sizeof(host_priority_info_data_t)/sizeof(integer_t)))
+
+/* host_statistics() */
+#define	HOST_LOAD_INFO		1	/* System loading stats */
+#define HOST_VM_INFO		2	/* Virtual memory stats */
+#define HOST_CPU_LOAD_INFO	3	/* CPU load stats */
+
+/* host_statistics64() */
+#define HOST_VM_INFO64		4	/* 64-bit virtual memory stats */
+#define HOST_EXTMOD_INFO64	5	/* External modification stats */
+#define HOST_EXPIRED_TASK_INFO	6	/* Statistics for expired tasks */
+
+
+struct host_load_info {
+	integer_t	avenrun[3];	/* scaled by LOAD_SCALE */
+	integer_t	mach_factor[3];	/* scaled by LOAD_SCALE */
+};
+
+typedef struct host_load_info	host_load_info_data_t;
+typedef struct host_load_info	*host_load_info_t;
+#define	HOST_LOAD_INFO_COUNT ((mach_msg_type_number_t) \
+		(sizeof(host_load_info_data_t)/sizeof(integer_t)))
+
+typedef struct vm_purgeable_info	host_purgable_info_data_t;
+typedef struct vm_purgeable_info	*host_purgable_info_t;
+#define HOST_VM_PURGABLE_COUNT ((mach_msg_type_number_t) \
+		(sizeof(host_purgable_info_data_t)/sizeof(integer_t)))
+
+/* in <mach/vm_statistics.h> */
+/* vm_statistics64 */
+#define	HOST_VM_INFO64_COUNT ((mach_msg_type_number_t) \
+		(sizeof(vm_statistics64_data_t)/sizeof(integer_t)))
+
+/* size of the latest version of the structure */
+#define HOST_VM_INFO64_LATEST_COUNT HOST_VM_INFO64_COUNT
+#define	HOST_VM_INFO64_REV1_COUNT HOST_VM_INFO64_LATEST_COUNT
+/* previous versions: adjust the size according to what was added each time */
+#define HOST_VM_INFO64_REV0_COUNT /* added compression and swapper info (14 ints) */\
+	((mach_msg_type_number_t) \
+	 (HOST_VM_INFO64_REV1_COUNT - 14))
+
+/* in <mach/vm_statistics.h> */
+/* vm_extmod_statistics */
+#define HOST_EXTMOD_INFO64_COUNT ((mach_msg_type_number_t) \
+	    (sizeof(vm_extmod_statistics_data_t)/sizeof(integer_t)))
+
+/* size of the latest version of the structure */
+#define HOST_EXTMOD_INFO64_LATEST_COUNT HOST_EXTMOD_INFO64_COUNT
+
+/* vm_statistics */
+#define	HOST_VM_INFO_COUNT ((mach_msg_type_number_t) \
+		(sizeof(vm_statistics_data_t)/sizeof(integer_t)))
+
+/* size of the latest version of the structure */
+#define HOST_VM_INFO_LATEST_COUNT HOST_VM_INFO_COUNT
+#define	HOST_VM_INFO_REV2_COUNT HOST_VM_INFO_LATEST_COUNT
+/* previous versions: adjust the size according to what was added each time */
+#define	HOST_VM_INFO_REV1_COUNT /* added "speculative_count" (1 int) */	\
+	((mach_msg_type_number_t) \
+	 (HOST_VM_INFO_REV2_COUNT - 1))
+#define	HOST_VM_INFO_REV0_COUNT /* added "purgable" info (2 ints) */ 	\
+	((mach_msg_type_number_t) \
+	 (HOST_VM_INFO_REV1_COUNT - 2))
+
+struct host_cpu_load_info {		/* number of ticks while running... */
+	natural_t	cpu_ticks[CPU_STATE_MAX]; /* ... in the given mode */
+};
+
+typedef struct host_cpu_load_info	host_cpu_load_info_data_t;
+typedef struct host_cpu_load_info	*host_cpu_load_info_t;
+#define HOST_CPU_LOAD_INFO_COUNT ((mach_msg_type_number_t) \
+		(sizeof (host_cpu_load_info_data_t) / sizeof (integer_t)))
+
+
+
+
+#endif	/* _MACH_HOST_INFO_H_ */
diff -Nur cctools-877.5/include/mach/host_notify.h cctools-877.5-AnV/include/mach/host_notify.h
--- cctools-877.5/include/mach/host_notify.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/host_notify.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef	_MACH_HOST_NOTIFY_H_
+#define	_MACH_HOST_NOTIFY_H_
+
+#define HOST_NOTIFY_CALENDAR_CHANGE		0
+#define HOST_NOTIFY_TYPE_MAX			0
+
+#define HOST_CALENDAR_CHANGED_REPLYID	950
+
+#endif /* _MACH_HOST_NOTIFY_H_ */
diff -Nur cctools-877.5/include/mach/host_notify_reply.defs cctools-877.5-AnV/include/mach/host_notify_reply.defs
--- cctools-877.5/include/mach/host_notify_reply.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/host_notify_reply.defs	2015-11-16 07:56:12 +0000
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+subsystem
+#if	KERNEL_USER
+		KernelUser
+#endif	/* KERN_USER */
+			host_notify_reply 950;
+
+#include <mach/std_types.defs>
+
+simpleroutine host_calendar_changed(
+		notify_port	: mach_port_move_send_once_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/host_priv.defs cctools-877.5-AnV/include/mach/host_priv.defs
--- cctools-877.5/include/mach/host_priv.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/host_priv.defs	2015-11-16 07:56:12 +0000
@@ -0,0 +1,369 @@
+/*
+ * Copyright (c) 2000-2004 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	Matchmaker definitions file for Mach kernel interface.
+ */
+subsystem
+#if	KERNEL_USER
+	  KernelUser
+#endif	/* KERNEL_USER */
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		       host_priv 400;
+
+#ifdef	KERNEL_USER
+userprefix r_;
+#endif	/* KERNEL_USER */
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach/clock_types.defs>
+#include <mach_debug/mach_debug_types.defs>
+
+/*
+ *      Get boot configuration information from kernel.
+ */
+routine host_get_boot_info(
+		host_priv	: host_priv_t;
+	out	boot_info	: kernel_boot_info_t);
+
+/*
+ *	Reboot this host.
+ *	Only available to privileged users.
+ */
+routine host_reboot(
+		host_priv	: host_priv_t;
+		options		: int);
+
+
+/*
+ *	Return privileged statistics from this host.
+ */
+routine host_priv_statistics(
+		host_priv	: host_priv_t;
+		flavor		: host_flavor_t;
+	out	host_info_out	: host_info_t, CountInOut);
+
+/*
+ *	Sets the default memory manager, the port to which
+ *	newly-created temporary memory objects are delivered.
+ *	[See (memory_object_default)memory_object_create.]
+ *	Also sets the default cluster size used for pagein/pageout
+ *	to this port.
+ *	The old memory manager port is returned.
+ */
+routine host_default_memory_manager(
+		host_priv	: host_priv_t;
+	inout	default_manager	: memory_object_default_t = 
+					MACH_MSG_TYPE_MAKE_SEND;
+		cluster_size	: memory_object_cluster_size_t);
+
+
+/*
+ *	Specify that the range of the virtual address space
+ *	of the target task must not cause page faults for
+ *	the indicated accesses.
+ *
+ *	[ To unwire the pages, specify VM_PROT_NONE. ]
+ */
+routine	vm_wire(
+		host_priv	: host_priv_t;
+		task		: vm_map_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		desired_access	: vm_prot_t);
+
+/*
+ *	Specify that the target thread must always be able
+ *	to run and to allocate memory.
+ */
+routine	thread_wire(
+		host_priv	: host_priv_t;
+		thread		: thread_act_t;
+		wired		: boolean_t);
+
+/*
+ *	Allocate zero-filled, wired, contiguous physical memory
+ *	in the address space of the target task, either at the
+ *	specified address, or wherever space can be found (if
+ *	anywhere is TRUE), of the specified size.  The address
+ *	at which the allocation actually took place is returned.
+ *	All pages will be entered into the task's pmap immediately,
+ *	with VM_PROT_ALL.
+ *
+ *	In addition to all the failure modes of its cousin,
+ *	vm_allocate, this call may also fail if insufficient
+ *	contiguous memory exists to satisfy the request.
+ *
+ *	Memory obtained from this call should be freed the
+ *	normal way, via vm_deallocate.
+ *
+ *	N.B.  This is an EXPERIMENTAL interface!
+ */
+routine	vm_allocate_cpm(
+		host_priv	: host_priv_t;
+		task		: vm_map_t;
+	inout	address		: vm_address_t;
+		size		: vm_size_t;
+		flags		: int);
+
+/*
+ *	Get list of processors on this host.
+ */
+routine host_processors(
+		host_priv		: host_priv_t;
+	out	out_processor_list	: processor_array_t);
+
+
+/*
+ *	Get control port for a system-wide clock.
+ *	Privileged.
+ */
+routine host_get_clock_control(
+		host_priv	: host_priv_t;
+		clock_id	: clock_id_t;
+	out	clock_ctrl	: clock_ctrl_t);
+
+
+/*
+ * kernel module interface (obsolete as of SnowLeopard)
+ * see mach/kmod.h
+ */
+/* kmod_ MIG calls now return KERN_NOT_SUPPORTED on PPC/i386/x86_64. */
+routine kmod_create(
+		host_priv	: host_priv_t;
+		info		: vm_address_t;
+	out	module		: kmod_t);
+
+routine kmod_destroy(
+		host_priv	: host_priv_t;
+		module		: kmod_t);
+
+routine	kmod_control(
+		host_priv	: host_priv_t;
+		module		: kmod_t;
+		flavor		: kmod_control_flavor_t;
+	inout	data		: kmod_args_t);
+
+/*
+ * 	Get a given special port for a given node.
+ * 	Special ports are defined in host_special_ports.h;
+ * 	examples include the master device port.
+ * 	There are a limited number of slots available for system servers.
+ */
+routine host_get_special_port(
+                host_priv       : host_priv_t;
+                node            : int;
+                which           : int;
+        out     port            : mach_port_t);
+
+/*
+ * 	Set a given special port for the local node.
+ * 	See host_get_special_port.
+ */
+routine host_set_special_port(
+                host_priv       : host_priv_t;
+                which           : int;
+                port            : mach_port_t);
+
+/*
+ * Set an exception handler for a host on one or more exception types.
+ * These handlers are invoked for all threads on the host if there are
+ * no task or thread-specific exception handlers or those handlers returned
+ * an error.
+ */
+routine	host_set_exception_ports(
+		host_priv	: host_priv_t;
+		exception_mask	: exception_mask_t;
+		new_port	: mach_port_t;
+		behavior	: exception_behavior_t;
+		new_flavor	: thread_state_flavor_t);
+
+
+/*
+ * Lookup some of the old exception handlers for a host
+ */
+routine	host_get_exception_ports(
+		host_priv	: host_priv_t;
+		exception_mask	: exception_mask_t;
+	  out	masks		: exception_mask_array_t;
+	  out	old_handlers	: exception_handler_array_t, SameCount;
+	  out	old_behaviors	: exception_behavior_array_t, SameCount;
+	  out	old_flavors	: exception_flavor_array_t, SameCount);
+
+
+/*
+ * Set an exception handler for a host on one or more exception types.
+ * At the same time, return the previously defined exception handlers for
+ * those types.
+ */
+routine	host_swap_exception_ports(
+		host_priv	: host_priv_t;
+		exception_mask	: exception_mask_t;
+		new_port	: mach_port_t;
+		behavior	: exception_behavior_t;
+		new_flavor	: thread_state_flavor_t;
+	  out	masks		: exception_mask_array_t;
+	  out	old_handlerss	: exception_handler_array_t, SameCount;
+	  out	old_behaviors	: exception_behavior_array_t, SameCount;
+	  out	old_flavors	: exception_flavor_array_t, SameCount);
+
+skip; /* old host_load_symbol_table */
+
+/*
+ *	Specify that the range of the virtual address space
+ *	of the target task must not cause page faults for
+ *	the indicated accesses.
+ *
+ *	[ To unwire the pages, specify VM_PROT_NONE. ]
+ */
+routine	mach_vm_wire(
+		host_priv	: host_priv_t;
+		task		: vm_map_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		desired_access	: vm_prot_t);
+
+/*
+ * JMM - Keep all processor_set related items at the end for easy
+ * removal.
+ */
+/*
+ *	List all processor sets on host.
+ */
+routine host_processor_sets(
+		host_priv	: host_priv_t;
+	out	processor_sets	: processor_set_name_array_t);
+
+/*
+ *	Get control port for a processor set.
+ */
+routine host_processor_set_priv(
+		host_priv	: host_priv_t;
+		set_name	: processor_set_name_t;
+	out	set		: processor_set_t);
+
+/************************** Warning *************************************/
+/*       The following routines are going away in a future release	*/
+/*	use the appropriate variant of host_set_special_port instead	*/
+/************************************************************************/
+ 
+/*
+ *	Set the dynamic_pager control port. Other entities
+ *	can request a send right to this port to talk with
+ *	the dynamic_pager utility, setting behavioral parameters
+ *	within the dynamic pager and getting low/high backing store
+ *	resource notifications.
+ */
+routine set_dp_control_port(    
+		host		: host_priv_t;
+	in	control_port	: mach_port_t);
+
+/*
+ *	Get the dynamic_pager control port.  This port
+ *	allows the holder to talk directly with the dynamic
+ *	pager utility.
+ */
+routine get_dp_control_port(    
+		host		: host_priv_t;
+	out	contorl_port    :mach_port_t);
+
+/*
+ *	Set the UserNotification daemon access port for this host. 
+ *	If this value is already set, the kernel will discard its
+ *	reference to the previously registered port.
+ */
+routine host_set_UNDServer(    
+		host		: host_priv_t;
+	in	server		: UNDServerRef);
+
+/*
+ *	Get the UserNotification daemon access port for this host.
+ *	This can then be used to communicate with that daemon, which
+ *	in turn communicates with the User through whatever means
+ *	available (pop-up-menus for GUI systems, text for non-GUI, etc..).
+ *
+ *	Access to this port is restricted to privileged clients because
+ *	it is a special purpose port intended for kernel clients.  User
+ *	level clients should go directly to the CFUserNotifcation services.
+ */
+routine host_get_UNDServer(    
+		host		: host_priv_t;
+	out	server		: UNDServerRef);
+
+/*
+ * Perform an operation with a kernel extension, on the kext loading system,
+ * or request information about loaded kexts or the state of the kext loading
+ * system.
+ * Active operations (load, unload, disable/enable) require host_priv/root access.
+ * Info retrieval does not.
+ *
+ * WARNING: THIS ROUTINE IS PRIVATE TO THE KEXT-MANAGEMENT STACK AND IS
+ * SUBJECT TO CHANGE AT ANY TIME.
+ */
+routine kext_request(
+        host_priv      : host_priv_t;
+    in  user_log_flags : uint32_t;
+    in  request_data   : pointer_t;
+    out response_data  : pointer_t;
+    out log_data       : pointer_t;
+    out op_result      : kern_return_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/host_priv.h cctools-877.5-AnV/include/mach/host_priv.h
--- cctools-877.5/include/mach/host_priv.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/host_priv.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,1220 @@
+#ifndef	_host_priv_user_
+#define	_host_priv_user_
+
+/* Module host_priv */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	host_priv_MSG_COUNT
+#define	host_priv_MSG_COUNT	26
+#endif	/* host_priv_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine host_get_boot_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_boot_info
+(
+	host_priv_t host_priv,
+	kernel_boot_info_t boot_info
+);
+
+/* Routine host_reboot */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_reboot
+(
+	host_priv_t host_priv,
+	int options
+);
+
+/* Routine host_priv_statistics */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_priv_statistics
+(
+	host_priv_t host_priv,
+	host_flavor_t flavor,
+	host_info_t host_info_out,
+	mach_msg_type_number_t *host_info_outCnt
+);
+
+/* Routine host_default_memory_manager */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_default_memory_manager
+(
+	host_priv_t host_priv,
+	memory_object_default_t *default_manager,
+	memory_object_cluster_size_t cluster_size
+);
+
+/* Routine vm_wire */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_wire
+(
+	host_priv_t host_priv,
+	vm_map_t task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_prot_t desired_access
+);
+
+/* Routine thread_wire */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_wire
+(
+	host_priv_t host_priv,
+	thread_act_t thread,
+	boolean_t wired
+);
+
+/* Routine vm_allocate_cpm */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_allocate_cpm
+(
+	host_priv_t host_priv,
+	vm_map_t task,
+	vm_address_t *address,
+	vm_size_t size,
+	int flags
+);
+
+/* Routine host_processors */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_processors
+(
+	host_priv_t host_priv,
+	processor_array_t *out_processor_list,
+	mach_msg_type_number_t *out_processor_listCnt
+);
+
+/* Routine host_get_clock_control */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_clock_control
+(
+	host_priv_t host_priv,
+	clock_id_t clock_id,
+	clock_ctrl_t *clock_ctrl
+);
+
+/* Routine kmod_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t kmod_create
+(
+	host_priv_t host_priv,
+	vm_address_t info,
+	kmod_t *module
+);
+
+/* Routine kmod_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t kmod_destroy
+(
+	host_priv_t host_priv,
+	kmod_t module
+);
+
+/* Routine kmod_control */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t kmod_control
+(
+	host_priv_t host_priv,
+	kmod_t module,
+	kmod_control_flavor_t flavor,
+	kmod_args_t *data,
+	mach_msg_type_number_t *dataCnt
+);
+
+/* Routine host_get_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_special_port
+(
+	host_priv_t host_priv,
+	int node,
+	int which,
+	mach_port_t *port
+);
+
+/* Routine host_set_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_set_special_port
+(
+	host_priv_t host_priv,
+	int which,
+	mach_port_t port
+);
+
+/* Routine host_set_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_set_exception_ports
+(
+	host_priv_t host_priv,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor
+);
+
+/* Routine host_get_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_exception_ports
+(
+	host_priv_t host_priv,
+	exception_mask_t exception_mask,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine host_swap_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_swap_exception_ports
+(
+	host_priv_t host_priv,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlerss,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine mach_vm_wire */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_wire
+(
+	host_priv_t host_priv,
+	vm_map_t task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	vm_prot_t desired_access
+);
+
+/* Routine host_processor_sets */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_processor_sets
+(
+	host_priv_t host_priv,
+	processor_set_name_array_t *processor_sets,
+	mach_msg_type_number_t *processor_setsCnt
+);
+
+/* Routine host_processor_set_priv */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_processor_set_priv
+(
+	host_priv_t host_priv,
+	processor_set_name_t set_name,
+	processor_set_t *set
+);
+
+/* Routine set_dp_control_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t set_dp_control_port
+(
+	host_priv_t host,
+	mach_port_t control_port
+);
+
+/* Routine get_dp_control_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t get_dp_control_port
+(
+	host_priv_t host,
+	mach_port_t *contorl_port
+);
+
+/* Routine host_set_UNDServer */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_set_UNDServer
+(
+	host_priv_t host,
+	UNDServerRef server
+);
+
+/* Routine host_get_UNDServer */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_UNDServer
+(
+	host_priv_t host,
+	UNDServerRef *server
+);
+
+/* Routine kext_request */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t kext_request
+(
+	host_priv_t host_priv,
+	uint32_t user_log_flags,
+	vm_offset_t request_data,
+	mach_msg_type_number_t request_dataCnt,
+	vm_offset_t *response_data,
+	mach_msg_type_number_t *response_dataCnt,
+	vm_offset_t *log_data,
+	mach_msg_type_number_t *log_dataCnt,
+	kern_return_t *op_result
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__host_priv_subsystem__defined
+#define __Request__host_priv_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_get_boot_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int options;
+	} __Request__host_reboot_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		host_flavor_t flavor;
+		mach_msg_type_number_t host_info_outCnt;
+	} __Request__host_priv_statistics_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t default_manager;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		memory_object_cluster_size_t cluster_size;
+	} __Request__host_default_memory_manager_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_prot_t desired_access;
+	} __Request__vm_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t thread;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t wired;
+	} __Request__thread_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		int flags;
+	} __Request__vm_allocate_cpm_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_processors_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		clock_id_t clock_id;
+	} __Request__host_get_clock_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t info;
+	} __Request__kmod_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kmod_t module;
+	} __Request__kmod_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		kmod_t module;
+		kmod_control_flavor_t flavor;
+		mach_msg_type_number_t dataCnt;
+	} __Request__kmod_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int node;
+		int which;
+	} __Request__host_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int which;
+	} __Request__host_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__host_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+	} __Request__host_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__host_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		vm_prot_t desired_access;
+	} __Request__mach_vm_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_processor_sets_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t set_name;
+		/* end of the kernel processed data */
+	} __Request__host_processor_set_priv_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t control_port;
+		/* end of the kernel processed data */
+	} __Request__set_dp_control_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__get_dp_control_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t server;
+		/* end of the kernel processed data */
+	} __Request__host_set_UNDServer_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_get_UNDServer_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t request_data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		uint32_t user_log_flags;
+		mach_msg_type_number_t request_dataCnt;
+	} __Request__kext_request_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__host_priv_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__host_priv_subsystem__defined
+#define __RequestUnion__host_priv_subsystem__defined
+union __RequestUnion__host_priv_subsystem {
+	__Request__host_get_boot_info_t Request_host_get_boot_info;
+	__Request__host_reboot_t Request_host_reboot;
+	__Request__host_priv_statistics_t Request_host_priv_statistics;
+	__Request__host_default_memory_manager_t Request_host_default_memory_manager;
+	__Request__vm_wire_t Request_vm_wire;
+	__Request__thread_wire_t Request_thread_wire;
+	__Request__vm_allocate_cpm_t Request_vm_allocate_cpm;
+	__Request__host_processors_t Request_host_processors;
+	__Request__host_get_clock_control_t Request_host_get_clock_control;
+	__Request__kmod_create_t Request_kmod_create;
+	__Request__kmod_destroy_t Request_kmod_destroy;
+	__Request__kmod_control_t Request_kmod_control;
+	__Request__host_get_special_port_t Request_host_get_special_port;
+	__Request__host_set_special_port_t Request_host_set_special_port;
+	__Request__host_set_exception_ports_t Request_host_set_exception_ports;
+	__Request__host_get_exception_ports_t Request_host_get_exception_ports;
+	__Request__host_swap_exception_ports_t Request_host_swap_exception_ports;
+	__Request__mach_vm_wire_t Request_mach_vm_wire;
+	__Request__host_processor_sets_t Request_host_processor_sets;
+	__Request__host_processor_set_priv_t Request_host_processor_set_priv;
+	__Request__set_dp_control_port_t Request_set_dp_control_port;
+	__Request__get_dp_control_port_t Request_get_dp_control_port;
+	__Request__host_set_UNDServer_t Request_host_set_UNDServer;
+	__Request__host_get_UNDServer_t Request_host_get_UNDServer;
+	__Request__kext_request_t Request_kext_request;
+};
+#endif /* !__RequestUnion__host_priv_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__host_priv_subsystem__defined
+#define __Reply__host_priv_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t boot_infoOffset; /* MiG doesn't use it */
+		mach_msg_type_number_t boot_infoCnt;
+		char boot_info[4096];
+	} __Reply__host_get_boot_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_reboot_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t host_info_outCnt;
+		integer_t host_info_out[68];
+	} __Reply__host_priv_statistics_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t default_manager;
+		/* end of the kernel processed data */
+	} __Reply__host_default_memory_manager_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t address;
+	} __Reply__vm_allocate_cpm_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t out_processor_list;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t out_processor_listCnt;
+	} __Reply__host_processors_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t clock_ctrl;
+		/* end of the kernel processed data */
+	} __Reply__host_get_clock_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		kmod_t module;
+	} __Reply__kmod_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__kmod_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t dataCnt;
+	} __Reply__kmod_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t port;
+		/* end of the kernel processed data */
+	} __Reply__host_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__host_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlerss[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__host_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t processor_sets;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t processor_setsCnt;
+	} __Reply__host_processor_sets_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t set;
+		/* end of the kernel processed data */
+	} __Reply__host_processor_set_priv_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__set_dp_control_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t contorl_port;
+		/* end of the kernel processed data */
+	} __Reply__get_dp_control_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_set_UNDServer_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t server;
+		/* end of the kernel processed data */
+	} __Reply__host_get_UNDServer_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t response_data;
+		mach_msg_ool_descriptor_t log_data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t response_dataCnt;
+		mach_msg_type_number_t log_dataCnt;
+		kern_return_t op_result;
+	} __Reply__kext_request_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__host_priv_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__host_priv_subsystem__defined
+#define __ReplyUnion__host_priv_subsystem__defined
+union __ReplyUnion__host_priv_subsystem {
+	__Reply__host_get_boot_info_t Reply_host_get_boot_info;
+	__Reply__host_reboot_t Reply_host_reboot;
+	__Reply__host_priv_statistics_t Reply_host_priv_statistics;
+	__Reply__host_default_memory_manager_t Reply_host_default_memory_manager;
+	__Reply__vm_wire_t Reply_vm_wire;
+	__Reply__thread_wire_t Reply_thread_wire;
+	__Reply__vm_allocate_cpm_t Reply_vm_allocate_cpm;
+	__Reply__host_processors_t Reply_host_processors;
+	__Reply__host_get_clock_control_t Reply_host_get_clock_control;
+	__Reply__kmod_create_t Reply_kmod_create;
+	__Reply__kmod_destroy_t Reply_kmod_destroy;
+	__Reply__kmod_control_t Reply_kmod_control;
+	__Reply__host_get_special_port_t Reply_host_get_special_port;
+	__Reply__host_set_special_port_t Reply_host_set_special_port;
+	__Reply__host_set_exception_ports_t Reply_host_set_exception_ports;
+	__Reply__host_get_exception_ports_t Reply_host_get_exception_ports;
+	__Reply__host_swap_exception_ports_t Reply_host_swap_exception_ports;
+	__Reply__mach_vm_wire_t Reply_mach_vm_wire;
+	__Reply__host_processor_sets_t Reply_host_processor_sets;
+	__Reply__host_processor_set_priv_t Reply_host_processor_set_priv;
+	__Reply__set_dp_control_port_t Reply_set_dp_control_port;
+	__Reply__get_dp_control_port_t Reply_get_dp_control_port;
+	__Reply__host_set_UNDServer_t Reply_host_set_UNDServer;
+	__Reply__host_get_UNDServer_t Reply_host_get_UNDServer;
+	__Reply__kext_request_t Reply_kext_request;
+};
+#endif /* !__RequestUnion__host_priv_subsystem__defined */
+
+#ifndef subsystem_to_name_map_host_priv
+#define subsystem_to_name_map_host_priv \
+    { "host_get_boot_info", 400 },\
+    { "host_reboot", 401 },\
+    { "host_priv_statistics", 402 },\
+    { "host_default_memory_manager", 403 },\
+    { "vm_wire", 404 },\
+    { "thread_wire", 405 },\
+    { "vm_allocate_cpm", 406 },\
+    { "host_processors", 407 },\
+    { "host_get_clock_control", 408 },\
+    { "kmod_create", 409 },\
+    { "kmod_destroy", 410 },\
+    { "kmod_control", 411 },\
+    { "host_get_special_port", 412 },\
+    { "host_set_special_port", 413 },\
+    { "host_set_exception_ports", 414 },\
+    { "host_get_exception_ports", 415 },\
+    { "host_swap_exception_ports", 416 },\
+    { "mach_vm_wire", 418 },\
+    { "host_processor_sets", 419 },\
+    { "host_processor_set_priv", 420 },\
+    { "set_dp_control_port", 421 },\
+    { "get_dp_control_port", 422 },\
+    { "host_set_UNDServer", 423 },\
+    { "host_get_UNDServer", 424 },\
+    { "kext_request", 425 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _host_priv_user_ */
diff -Nur cctools-877.5/include/mach/host_reboot.h cctools-877.5-AnV/include/mach/host_reboot.h
--- cctools-877.5/include/mach/host_reboot.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/host_reboot.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,39 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef _MACH_HOST_REBOOT_
+#define _MACH_HOST_REBOOT_
+
+#define HOST_REBOOT_HALT        0x0008
+#define HOST_REBOOT_UPSDELAY    0x0100
+#define	HOST_REBOOT_DEBUGGER	0x1000
+
+#endif	/* _MACH_HOST_REBOOT_ */
diff -Nur cctools-877.5/include/mach/host_security.defs cctools-877.5-AnV/include/mach/host_security.defs
--- cctools-877.5/include/mach/host_security.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/host_security.defs	2015-11-16 07:56:12 +0000
@@ -0,0 +1,101 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ * File:	mach/host_security.defs
+ *
+ * Abstract:
+ *	Mach host security operations support.
+ */
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		      host_security 600;
+
+/*
+ *	Basic types
+ */
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+
+/*
+ *	Create a new task with an explicit security token
+ */
+routine host_security_create_task_token(
+		host_security	: host_security_t;
+		parent_task	: task_t;
+		sec_token	: security_token_t;
+		audit_token	: audit_token_t;
+		host		: host_t;
+		ledgers		: ledger_array_t;
+		inherit_memory	: boolean_t;
+	out	child_task	: task_t);
+
+/*
+ *	Change a task's security token
+ */
+routine host_security_set_task_token(
+		host_security	: host_security_t;
+		target_task	: task_t;
+		sec_token	: security_token_t;
+		audit_token	: audit_token_t;
+		host		: host_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/host_security.h cctools-877.5-AnV/include/mach/host_security.h
--- cctools-877.5/include/mach/host_security.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/host_security.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,198 @@
+#ifndef	_host_security_user_
+#define	_host_security_user_
+
+/* Module host_security */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	host_security_MSG_COUNT
+#define	host_security_MSG_COUNT	2
+#endif	/* host_security_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine host_security_create_task_token */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_security_create_task_token
+(
+	host_security_t host_security,
+	task_t parent_task,
+	security_token_t sec_token,
+	audit_token_t audit_token,
+	host_t host,
+	ledger_array_t ledgers,
+	mach_msg_type_number_t ledgersCnt,
+	boolean_t inherit_memory,
+	task_t *child_task
+);
+
+/* Routine host_security_set_task_token */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_security_set_task_token
+(
+	host_security_t host_security,
+	task_t target_task,
+	security_token_t sec_token,
+	audit_token_t audit_token,
+	host_t host
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__host_security_subsystem__defined
+#define __Request__host_security_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t parent_task;
+		mach_msg_port_descriptor_t host;
+		mach_msg_ool_ports_descriptor_t ledgers;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		security_token_t sec_token;
+		audit_token_t audit_token;
+		mach_msg_type_number_t ledgersCnt;
+		boolean_t inherit_memory;
+	} __Request__host_security_create_task_token_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t target_task;
+		mach_msg_port_descriptor_t host;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		security_token_t sec_token;
+		audit_token_t audit_token;
+	} __Request__host_security_set_task_token_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__host_security_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__host_security_subsystem__defined
+#define __RequestUnion__host_security_subsystem__defined
+union __RequestUnion__host_security_subsystem {
+	__Request__host_security_create_task_token_t Request_host_security_create_task_token;
+	__Request__host_security_set_task_token_t Request_host_security_set_task_token;
+};
+#endif /* !__RequestUnion__host_security_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__host_security_subsystem__defined
+#define __Reply__host_security_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_task;
+		/* end of the kernel processed data */
+	} __Reply__host_security_create_task_token_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_security_set_task_token_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__host_security_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__host_security_subsystem__defined
+#define __ReplyUnion__host_security_subsystem__defined
+union __ReplyUnion__host_security_subsystem {
+	__Reply__host_security_create_task_token_t Reply_host_security_create_task_token;
+	__Reply__host_security_set_task_token_t Reply_host_security_set_task_token;
+};
+#endif /* !__RequestUnion__host_security_subsystem__defined */
+
+#ifndef subsystem_to_name_map_host_security
+#define subsystem_to_name_map_host_security \
+    { "host_security_create_task_token", 600 },\
+    { "host_security_set_task_token", 601 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _host_security_user_ */
diff -Nur cctools-877.5/include/mach/host_special_ports.h cctools-877.5-AnV/include/mach/host_special_ports.h
--- cctools-877.5/include/mach/host_special_ports.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/host_special_ports.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,208 @@
+/*
+ * Copyright (c) 2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/host_special_ports.h
+ *
+ *	Defines codes for access to host-wide special ports.
+ */
+
+#ifndef _MACH_HOST_SPECIAL_PORTS_H_
+#define _MACH_HOST_SPECIAL_PORTS_H_
+
+/*
+ * Cannot be set or gotten from user space
+ */
+#define HOST_SECURITY_PORT               0
+
+/*
+ * Always provided by kernel (cannot be set from user-space).
+ */
+#define HOST_PORT                        1
+#define HOST_PRIV_PORT                   2
+#define HOST_IO_MASTER_PORT              3
+#define HOST_MAX_SPECIAL_KERNEL_PORT     7 /* room to grow */
+
+/*
+ * Not provided by kernel
+ */
+#define HOST_DYNAMIC_PAGER_PORT         (1 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_AUDIT_CONTROL_PORT         (2 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_USER_NOTIFICATION_PORT     (3 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_AUTOMOUNTD_PORT            (4 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_LOCKD_PORT                 (5 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_SEATBELT_PORT              (7 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_KEXTD_PORT                 (8 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_CHUD_PORT                  (9 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_UNFREED_PORT		(10 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_AMFID_PORT			(11 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_GSSD_PORT			(12 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_TELEMETRY_PORT		(13 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_ATM_NOTIFICATION_PORT		(14 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_COALITION_PORT		(15 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_MAX_SPECIAL_PORT           (16 + HOST_MAX_SPECIAL_KERNEL_PORT)
+                                        /* room to grow here as well */
+
+/*
+ * Special node identifier to always represent the local node.
+ */
+#define HOST_LOCAL_NODE	                 -1
+			
+/*
+ * Definitions for ease of use.
+ *
+ * In the get call, the host parameter can be any host, but will generally
+ * be the local node host port. In the set call, the host must the per-node
+ * host port for the node being affected.
+ */
+#define host_get_host_port(host, port)	\
+	(host_get_special_port((host), 	\
+	HOST_LOCAL_NODE, HOST_PORT, (port)))
+#define host_set_host_port(host, port) (KERN_INVALID_ARGUMENT)
+
+#define host_get_host_priv_port(host, port)	\
+	(host_get_special_port((host), 		\
+	HOST_LOCAL_NODE, HOST_PRIV_PORT, (port)))
+#define host_set_host_priv_port(host, port) (KERN_INVALID_ARGUMENT)
+
+#define host_get_io_master_port(host, port)	\
+	(host_get_special_port((host), 		\
+	HOST_LOCAL_NODE, HOST_IO_MASTER_PORT, (port)))
+#define host_set_io_master_port(host, port) (KERN_INVALID_ARGUMENT)
+
+/*
+ * User-settable special ports.
+ */
+#define host_get_dynamic_pager_port(host, port)	\
+	(host_get_special_port((host),			\
+	HOST_LOCAL_NODE, HOST_DYNAMIC_PAGER_PORT, (port)))
+#define host_set_dynamic_pager_port(host, port)	\
+	(host_set_special_port((host), HOST_DYNAMIC_PAGER_PORT, (port)))
+
+#define host_get_audit_control_port(host, port)	\
+	(host_get_special_port((host), 		\
+	HOST_LOCAL_NODE, HOST_AUDIT_CONTROL_PORT, (port)))
+#define host_set_audit_control_port(host, port)	\
+	(host_set_special_port((host), HOST_AUDIT_CONTROL_PORT, (port)))
+
+#define host_get_user_notification_port(host, port)	\
+	(host_get_special_port((host), 			\
+	HOST_LOCAL_NODE, HOST_USER_NOTIFICATION_PORT, (port)))
+#define host_set_user_notification_port(host, port)	\
+	(host_set_special_port((host), HOST_USER_NOTIFICATION_PORT, (port)))
+
+#define host_get_automountd_port(host, port)	\
+	(host_get_special_port((host), 		\
+	HOST_LOCAL_NODE, HOST_AUTOMOUNTD_PORT, (port)))
+#define host_set_automountd_port(host, port)	\
+	(host_set_special_port((host), HOST_AUTOMOUNTD_PORT, (port)))
+
+#define host_get_lockd_port(host, port)	\
+	(host_get_special_port((host), 			\
+	HOST_LOCAL_NODE, HOST_LOCKD_PORT, (port)))
+#define host_set_lockd_port(host, port)	\
+	(host_set_special_port((host), HOST_LOCKD_PORT, (port)))
+
+#define host_get_kextd_port(host, port)	\
+	(host_get_special_port((host), 			\
+	HOST_LOCAL_NODE, HOST_KEXTD_PORT, (port)))
+#define host_set_kextd_port(host, port)	\
+	(host_set_special_port((host), HOST_KEXTD_PORT, (port)))
+
+#define host_get_chud_port(host, port)	\
+	(host_get_special_port((host), 			\
+	HOST_LOCAL_NODE, HOST_CHUD_PORT, (port)))
+#define host_set_chud_port(host, port)	\
+	(host_set_special_port((host), HOST_CHUD_PORT, (port)))
+
+#define host_get_unfreed_port(host, port)	\
+	(host_get_special_port((host), 			\
+	HOST_LOCAL_NODE, HOST_UNFREED_PORT, (port)))
+#define host_set_unfreed_port(host, port)	\
+	(host_set_special_port((host), HOST_UNFREED_PORT, (port)))
+
+#define host_get_amfid_port(host, port)	\
+	(host_get_special_port((host), 			\
+	HOST_LOCAL_NODE, HOST_AMFID_PORT, (port)))
+#define host_set_amfid_port(host, port)	\
+	(host_set_special_port((host), HOST_AMFID_PORT, (port)))
+
+#define host_get_gssd_port(host, port)	\
+	(host_get_special_port((host),			\
+	HOST_LOCAL_NODE, HOST_GSSD_PORT, (port)))
+#define host_set_gssd_port(host, port)	\
+	(host_set_special_port((host), HOST_GSSD_PORT, (port)))
+
+#define host_get_telemetry_port(host, port)	\
+	(host_get_special_port((host),			\
+	HOST_LOCAL_NODE, HOST_TELEMETRY_PORT, (port)))
+#define host_set_telemetry_port(host, port)	\
+	(host_set_special_port((host), HOST_TELEMETRY_PORT, (port)))
+
+#define host_get_atm_notification_port(host, port)	\
+	(host_get_special_port((host),			\
+	HOST_LOCAL_NODE, HOST_ATM_NOTIFICATION_PORT, (port)))
+#define host_set_atm_notification_port(host, port)	\
+	(host_set_special_port((host), HOST_ATM_NOTIFICATION_PORT, (port)))
+
+#define host_get_coalition_port(host, port)	\
+	(host_get_special_port((host),			\
+	HOST_LOCAL_NODE, HOST_COALITION_PORT, (port)))
+#define host_set_coalition_port(host, port)	\
+	(host_set_special_port((host), HOST_COALITION_PORT, (port)))
+
+#endif	/* _MACH_HOST_SPECIAL_PORTS_H_ */
diff -Nur cctools-877.5/include/mach/i386/asm.h cctools-877.5-AnV/include/mach/i386/asm.h
--- cctools-877.5/include/mach/i386/asm.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/i386/asm.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,392 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+
+#ifndef	_I386_ASM_H_
+#define	_I386_ASM_H_
+
+#ifdef _KERNEL
+#include <gprof.h>
+#endif	/* _KERNEL */
+
+#if	defined(MACH_KERNEL) || defined(_KERNEL)
+#include <gprof.h>
+#endif	/* MACH_KERNEL || _KERNEL */
+
+#if defined(__i386__)
+
+#define S_PC	 (%esp)
+#define S_ARG0	 4(%esp)
+#define S_ARG1	 8(%esp)
+#define S_ARG2	12(%esp)
+#define S_ARG3	16(%esp)
+#define S_ARG4	20(%esp)
+
+#define FRAME	pushl %ebp; movl %esp, %ebp
+#define EMARF	leave
+
+#define B_LINK	 (%ebp)
+#define B_PC	 4(%ebp)
+#define B_ARG0	 8(%ebp)
+#define B_ARG1	12(%ebp)
+#define B_ARG2	16(%ebp)
+#define B_ARG3	20(%ebp)
+
+#elif defined(__x86_64__)
+
+#define S_PC	 (%rsp)
+
+#define FRAME	pushq %rbp; movq %rsp, %rbp
+#define EMARF	leave
+
+#define B_LINK	 (%rbp)
+#define B_PC	 8(%rbp)
+
+#else
+#error unsupported architecture
+#endif
+
+/* There is another definition of ALIGN for .c sources */
+#ifdef ASSEMBLER
+#define ALIGN 4,0x90
+#endif /* ASSEMBLER */
+
+#ifndef FALIGN
+#define FALIGN ALIGN
+#endif
+
+#define LB(x,n) n
+#if	__STDC__
+#ifndef __NO_UNDERSCORES__
+#define	LCL(x)	L ## x
+#define EXT(x) _ ## x
+#define LEXT(x) _ ## x ## :
+#else
+#define	LCL(x)	.L ## x
+#define EXT(x) x
+#define LEXT(x) x ## :
+#endif
+#define LBc(x,n) n ## :
+#define LBb(x,n) n ## b
+#define LBf(x,n) n ## f
+#else /* __STDC__ */
+#ifndef __NO_UNDERSCORES__
+#define LCL(x) L/**/x
+#define EXT(x) _/**/x
+#define LEXT(x) _/**/x/**/:
+#else /* __NO_UNDERSCORES__ */
+#define	LCL(x)	.L/**/x
+#define EXT(x) x
+#define LEXT(x) x/**/:
+#endif /* __NO_UNDERSCORES__ */
+#define LBc(x,n) n/**/:
+#define LBb(x,n) n/**/b
+#define LBf(x,n) n/**/f
+#endif /* __STDC__ */
+
+#define SVC .byte 0x9a; .long 0; .word 0x7
+
+#define RPC_SVC .byte 0x9a; .long 0; .word 0xf
+
+#define String	.asciz
+#define Value	.word
+#define Times(a,b) (a*b)
+#define Divide(a,b) (a/b)
+
+#define INB	inb	%dx, %al
+#define OUTB	outb	%al, %dx
+#define INL	inl	%dx, %eax
+#define OUTL	outl	%eax, %dx
+
+#define data16	.byte 0x66
+#define addr16	.byte 0x67
+
+#if !GPROF
+#define MCOUNT
+
+#elif defined(__SHARED__)
+#define MCOUNT		; .data;\
+			.align ALIGN;\
+			LBc(x, 8) .long 0;\
+			.text;\
+			Gpush;\
+			Gload;\
+			leal Gotoff(LBb(x,8)),%edx;\
+			Egaddr(%eax,_mcount_ptr);\
+			Gpop;\
+			call *(%eax);
+
+#else	/* !GPROF, !__SHARED__ */
+#define MCOUNT		; call mcount;
+#endif /* GPROF */
+
+#ifdef __ELF__
+#define ELF_FUNC(x)	.type x,@function
+#define ELF_DATA(x)	.type x,@object
+#define ELF_SIZE(x,s)	.size x,s
+#else
+#define ELF_FUNC(x)
+#define ELF_DATA(x)
+#define ELF_SIZE(x,s)
+#endif
+
+#define	Entry(x)	.globl EXT(x); ELF_FUNC(EXT(x)); .align FALIGN; LEXT(x)
+#define	ENTRY(x)	Entry(x) MCOUNT
+#define	ENTRY2(x,y)	.globl EXT(x); .globl EXT(y); \
+			ELF_FUNC(EXT(x)); ELF_FUNC(EXT(y)); \
+			.align FALIGN; LEXT(x); LEXT(y) \
+			MCOUNT
+#if __STDC__
+#define	ASENTRY(x) 	.globl x; .align FALIGN; x ## : ELF_FUNC(x) MCOUNT
+#else
+#define	ASENTRY(x) 	.globl x; .align FALIGN; x: ELF_FUNC(x) MCOUNT
+#endif /* __STDC__ */
+
+#define	DATA(x)		.globl EXT(x); ELF_DATA(EXT(x)); .align ALIGN; LEXT(x)
+
+#define End(x)		ELF_SIZE(x,.-x)
+#define END(x)		End(EXT(x))
+#define ENDDATA(x)	END(x)
+#define Enddata(x)	End(x)
+
+/*
+ * ELF shared library accessor macros.
+ * Gpush saves the %ebx register used for the GOT address
+ * Gpop pops %ebx if we need a GOT
+ * Gload loads %ebx with the GOT address if shared libraries are used
+ * Gcall calls an external function.
+ * Gotoff allows you to reference local labels.
+ * Gotoff2 allows you to reference local labels with an index reg.
+ * Gotoff3 allows you to reference local labels with an index reg & size.
+ * Gaddr loads up a register with an address of an external item.
+ * Gstack is the number of bytes that Gpush pushes on the stack.
+ *
+ * Varients of the above with E or L prefixes do EXT(name) or LCL(name)
+ * respectively.
+ */
+
+#ifndef __SHARED__
+#define Gpush
+#define Gpop
+#define Gload
+#define Gcall(func)		call func
+#define Gotoff(lab)		lab
+#define Gotoff2(l,r)		l(r)
+#define Gotoff3(l,r,s)		l(,r,s)
+#define Gaddr(to,lab)		movl $lab,to
+#define Gcmp(lab,reg)		cmpl $lab,reg
+#define Gmemload(lab,reg)	movl lab,reg
+#define Gmemstore(reg,lab,tmp)	movl reg,lab
+#define Gstack			0
+
+#else
+#ifdef __ELF__			/* ELF shared libraries */
+#define Gpush			pushl %ebx
+#define Gpop			popl %ebx
+#define Gload			call 9f; 9: popl %ebx; addl $_GLOBAL_OFFSET_TABLE_+[.-9b],%ebx
+#define Gcall(func)		call EXT(func)@PLT
+#define Gotoff(lab)		lab@GOTOFF(%ebx)
+#define Gotoff2(l,r)		l@GOTOFF(%ebx,r)
+#define Gotoff3(l,r,s)		l@GOTOFF(%ebx,r,s)
+#define Gaddr(to,lab)		movl lab@GOT(%ebx),to
+#define Gcmp(lab,reg)		cmpl reg,lab@GOT(%ebx)
+#define Gmemload(lab,reg)	movl lab@GOT(%ebx),reg; movl (reg),reg
+#define Gmemstore(reg,lab,tmp)	movl lab@GOT(%ebx),tmp; movl reg,(tmp)
+#define Gstack			4
+
+#else				/* ROSE shared libraries */
+#define Gpush
+#define Gpop
+#define Gload
+#define Gcall(func)		call *9f; .data; .align ALIGN; 9: .long func; .text
+#define Gotoff(lab)		lab
+#define Gotoff2(l,r)		l(r)
+#define Gotoff3(l,r,s)		l(,r,s)
+#define Gaddr(to,lab)		movl 9f,to; .data; .align ALIGN; 9: .long lab; .text
+#define Gcmp(lab,reg)		cmpl reg,9f; .data; .align ALIGN; 9: .long lab; .text
+#define Gmemload(lab,reg)	movl 9f,reg; movl (reg),reg; .data; .align ALIGN; 9: .long lab; .text
+#define Gmemstore(reg,lab,tmp)	movl 9f,tmp; movl reg,(tmp); .data; .align ALIGN; 9: .long lab; .text
+#define Gstack			0
+#endif	/* __ELF__ */
+#endif	/* __SHARED__ */
+
+/* Egotoff is not provided, since external symbols should not use @GOTOFF
+   relocations.  */
+#define Egcall(func)		Gcall(EXT(func))
+#define Egaddr(to,lab)		Gaddr(to,EXT(lab))
+#define Egcmp(lab,reg)		Gcmp(EXT(lab),reg)
+#define Egmemload(lab,reg)	Gmemload(EXT(lab),reg)
+#define Egmemstore(reg,lab,tmp)	Gmemstore(reg,EXT(lab),tmp)
+
+#define Lgotoff(lab)		Gotoff(LCL(lab))
+#define Lgotoff2(l,r)		Gotoff2(LCL(l),r)
+#define Lgotoff3(l,r,s)		Gotoff3(LCL(l),r,s)
+#define Lgcmp(lab,reg)		Gcmp(LCL(lab),reg)
+#define Lgmemload(lab,reg)	movl Lgotoff(lab),reg
+#define Lgmemstore(reg,lab,tmp)	movl reg,Lgotoff(lab)
+
+#ifndef ASSEMBLER
+/* These defines are here for .c files that wish to reference global symbols
+ * within __asm__ statements. 
+ */
+#ifndef __NO_UNDERSCORES__
+#define CC_SYM_PREFIX "_"
+#else
+#define CC_SYM_PREFIX ""
+#endif /* __NO_UNDERSCORES__ */
+#endif /* ASSEMBLER */
+
+/*
+ * The following macros make calls into C code.
+ * They dynamically align the stack to 16 bytes.
+ */
+#if defined(__i386__)
+/*
+ * Arguments are moved (not pushed) onto the correctly aligned stack.
+ * NOTE: ESI is destroyed in the process, and hence cannot
+ * be directly used as a parameter. Users of this macro must
+ * independently preserve ESI (a non-volatile) if the routine is
+ * intended to be called from C, for instance.
+ */
+
+#define CCALL(fn)			\
+	movl	%esp, %esi		;\
+	andl	$0xFFFFFFF0, %esp	;\
+	call	EXT(fn)			;\
+	movl	%esi, %esp
+
+#define CCALL1(fn, arg1)		\
+	movl	%esp, %esi		;\
+	subl	$4, %esp		;\
+	andl	$0xFFFFFFF0, %esp	;\
+	movl	arg1, (%esp)		;\
+	call	EXT(fn)			;\
+	movl	%esi, %esp
+
+#define CCALL2(fn, arg1, arg2)		\
+	movl	%esp, %esi		;\
+	subl	$8, %esp		;\
+	andl	$0xFFFFFFF0, %esp	;\
+	movl	arg2, 4(%esp)		;\
+	movl	arg1, (%esp)		;\
+	call	EXT(fn)			;\
+	movl	%esi, %esp
+
+/* This variant exists to permit adjustment of the stack by "dtrace" */
+#define CCALL1WITHSP(fn, arg1)		\
+	movl	%esp, %esi		;\
+	subl	$12, %esp		;\
+	andl	$0xFFFFFFF0, %esp	;\
+	movl	%esi, 8(%esp)		;\
+	leal	8(%esp), %esi		;\
+	movl	%esi, 4(%esp)		;\
+	movl	arg1, (%esp)		;\
+	call	EXT(fn)			;\
+	movl	8(%esp), %esp
+
+/*
+ * CCALL5 is used for callee functions with 3 arguments but
+ * where arg2 (a3:a2) and arg3 (a5:a4) are 64-bit values.
+ */
+#define CCALL5(fn, a1, a2, a3, a4, a5)	\
+	movl	%esp, %esi		;\
+	subl	$20, %esp		;\
+	andl	$0xFFFFFFF0, %esp	;\
+	movl	a5, 16(%esp)		;\
+	movl	a4, 12(%esp)		;\
+	movl	a3,  8(%esp)		;\
+	movl	a2,  4(%esp)		;\
+	movl	a1,  (%esp)		;\
+	call	EXT(fn)			;\
+	movl	%esi, %esp
+
+#elif defined(__x86_64__)
+
+/* This variant exists to permit adjustment of the stack by "dtrace" */
+#define CCALLWITHSP(fn)				 \
+	mov	%rsp, %r12			;\
+	sub	$8, %rsp			;\
+	and	$0xFFFFFFFFFFFFFFF0, %rsp	;\
+	mov	%r12, (%rsp)			;\
+	leaq	(%rsp), %rsi			;\
+	call	EXT(fn)				;\
+	mov	(%rsp), %rsp
+	
+#define CCALL(fn)				 \
+	mov	%rsp, %r12			;\
+	and	$0xFFFFFFFFFFFFFFF0, %rsp	;\
+	call	EXT(fn)				;\
+	mov	%r12, %rsp
+
+#define CCALL1(fn, arg1) 			 \
+	mov	arg1, %rdi 			;\
+	CCALL(fn)
+
+#define CCALL2(fn, arg1, arg2)		 	 \
+	mov	arg1, %rdi 			;\
+	mov	arg2, %rsi 			;\
+	CCALL(fn)
+
+#define CCALL3(fn, arg1, arg2, arg3) 		 \
+	mov	arg1, %rdi 			;\
+	mov	arg2, %rsi 			;\
+	mov	arg3, %rdx 			;\
+	CCALL(fn)
+
+#else
+#error unsupported architecture
+#endif
+
+#endif /* _I386_ASM_H_ */
diff -Nur cctools-877.5/include/mach/i386/boolean.h cctools-877.5-AnV/include/mach/i386/boolean.h
--- cctools-877.5/include/mach/i386/boolean.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/i386/boolean.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,74 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	boolean.h
+ *
+ *	Boolean type, for I386.
+ */
+
+#ifndef	_MACH_I386_BOOLEAN_H_
+#define _MACH_I386_BOOLEAN_H_
+
+#if defined(__x86_64__) && !defined(KERNEL)
+typedef unsigned int	boolean_t;
+#else
+typedef int		boolean_t;
+#endif
+
+#endif	/* _MACH_I386_BOOLEAN_H_ */
diff -Nur cctools-877.5/include/mach/i386/exception.h cctools-877.5-AnV/include/mach/i386/exception.h
--- cctools-877.5/include/mach/i386/exception.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/i386/exception.h	2015-11-16 07:56:12 +0000
@@ -0,0 +1,135 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_MACH_I386_EXCEPTION_H_
+#define _MACH_I386_EXCEPTION_H_
+
+/*
+ * No machine dependent types for the 80386
+ */
+
+#define	EXC_TYPES_COUNT	13	/* incl. illegal exception 0 */
+
+/*
+ *	Codes and subcodes for 80386 exceptions.
+ */
+
+#define EXCEPTION_CODE_MAX	2	/* currently code and subcode */
+
+/*
+ *	EXC_BAD_INSTRUCTION
+ */
+
+#define EXC_I386_INVOP			1
+
+/*
+ *	EXC_ARITHMETIC
+ */
+
+#define EXC_I386_DIV			1
+#define EXC_I386_INTO			2
+#define EXC_I386_NOEXT			3
+#define EXC_I386_EXTOVR			4
+#define EXC_I386_EXTERR			5
+#define EXC_I386_EMERR			6
+#define EXC_I386_BOUND			7
+#define EXC_I386_SSEEXTERR              8
+
+/*
+ *	EXC_SOFTWARE
+ *	Note: 0x10000-0x10003 in use for unix signal
+ */
+
+/*
+ *	EXC_BAD_ACCESS
+ */
+
+/*
+ *	EXC_BREAKPOINT
+ */
+
+#define EXC_I386_SGL			1
+#define EXC_I386_BPT			2
+
+#define EXC_I386_DIVERR		0	/* divide by 0 eprror		*/
+#define EXC_I386_SGLSTP		1	/* single step			*/
+#define EXC_I386_NMIFLT		2	/* NMI				*/
+#define EXC_I386_BPTFLT		3	/* breakpoint fault		*/
+#define EXC_I386_INTOFLT	4	/* INTO overflow fault		*/
+#define EXC_I386_BOUNDFLT	5	/* BOUND instruction fault	*/
+#define EXC_I386_INVOPFLT	6	/* invalid opcode fault		*/
+#define EXC_I386_NOEXTFLT	7	/* extension not available fault*/
+#define EXC_I386_DBLFLT		8	/* double fault			*/
+#define EXC_I386_EXTOVRFLT	9	/* extension overrun fault	*/
+#define EXC_I386_INVTSSFLT	10	/* invalid TSS fault		*/
+#define EXC_I386_SEGNPFLT	11	/* segment not present fault	*/
+#define EXC_I386_STKFLT		12	/* stack fault			*/
+#define EXC_I386_GPFLT		13	/* general protection fault	*/
+#define EXC_I386_PGFLT		14	/* page fault			*/
+#define EXC_I386_EXTERRFLT	16	/* extension error fault	*/
+#define	EXC_I386_ALIGNFLT	17	/* Alignment fault */
+#define EXC_I386_ENDPERR	33	/* emulated extension error flt	*/
+#define EXC_I386_ENOEXTFLT	32	/* emulated ext not present	*/
+
+
+/*
+ *	machine dependent exception masks
+ */
+#define	EXC_MASK_MACHINE	0
+
+#endif	/* _MACH_I386_EXCEPTION_H_ */
diff -Nur cctools-877.5/include/mach/i386/kern_return.h cctools-877.5-AnV/include/mach/i386/kern_return.h
--- cctools-877.5/include/mach/i386/kern_return.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/i386/kern_return.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,74 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	kern_return.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *	Date:	1985
+ *
+ *	Machine-dependent kernel return definitions.
+ */
+
+#ifndef	_MACH_I386_KERN_RETURN_H_
+#define _MACH_I386_KERN_RETURN_H_
+
+#ifndef	ASSEMBLER
+typedef	int		kern_return_t;
+#endif	/* ASSEMBLER */
+
+#endif	/* _MACH_I386_KERN_RETURN_H_ */
diff -Nur cctools-877.5/include/mach/i386/ndr_def.h cctools-877.5-AnV/include/mach/i386/ndr_def.h
--- cctools-877.5/include/mach/i386/ndr_def.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/i386/ndr_def.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,45 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+/* NDR record for Intel x86s */
+
+#include <mach/ndr.h>
+
+NDR_record_t NDR_record = {
+	0,			/* mig_reserved */
+	0,			/* mig_reserved */
+	0,			/* mig_reserved */
+	NDR_PROTOCOL_2_0,		
+	NDR_INT_LITTLE_ENDIAN,
+	NDR_CHAR_ASCII,
+	NDR_FLOAT_IEEE,
+	0,
+};
diff -Nur cctools-877.5/include/mach/i386/processor_info.h cctools-877.5-AnV/include/mach/i386/processor_info.h
--- cctools-877.5/include/mach/i386/processor_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/i386/processor_info.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ *	File:	mach/i386/processor_info.h
+ *
+ *	Data structure definitions for i386 specific processor control
+ */
+
+#ifndef	_MACH_I386_PROCESSOR_INFO_H_
+#define _MACH_I386_PROCESSOR_INFO_H_
+
+#endif	/* _MACH_I386_PROCESSOR_INFO_H_ */
diff -Nur cctools-877.5/include/mach/i386/rpc.h cctools-877.5-AnV/include/mach/i386/rpc.h
--- cctools-877.5/include/mach/i386/rpc.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/i386/rpc.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,36 @@
+/*
+ * Copyright (c) 2002,2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef	_MACH_I386_RPC_H_
+#define	_MACH_I386_RPC_H_
+
+#endif	/* _MACH_I386_RPC_H_ */
+
diff -Nur cctools-877.5/include/mach/i386/sdt_isa.h cctools-877.5-AnV/include/mach/i386/sdt_isa.h
--- cctools-877.5/include/mach/i386/sdt_isa.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/i386/sdt_isa.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,414 @@
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License, Version 1.0 only
+ * (the "License").  You may not use this file except in compliance
+ * with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+/*
+ * Copyright 2004 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef _MACH_I386_SDT_ISA_H
+#define	_MACH_I386_SDT_ISA_H
+
+/*
+ * Only define when testing.  This makes the calls into actual calls to
+ * test functions.
+ */
+/* #define DTRACE_CALL_TEST */
+
+#define DTRACE_STRINGIFY(s) #s
+#define DTRACE_TOSTRING(s) DTRACE_STRINGIFY(s)
+#define DTRACE_LABEL(p, n)									\
+	"__dtrace_probe$" DTRACE_TOSTRING(%=__LINE__) DTRACE_STRINGIFY(_##p##___##n) ":"	"\n\t"
+
+#ifdef DTRACE_CALL_TEST
+
+#define DTRACE_CALL(p,n)	\
+	DTRACE_LABEL(p,n)	\
+	DTRACE_CALL_INSN(p,n)
+
+#else
+
+#define DTRACE_CALL(p,n)	\
+	DTRACE_LABEL(p,n)	\
+	DTRACE_NOPS
+
+#endif
+
+#ifdef __x86_64__
+
+#define DTRACE_NOPS			\
+	"nop"			"\n\t"	\
+	"nop"			"\n\t"	\
+	"nop"			"\n\t"	
+
+#define DTRACE_CALL_INSN(p,n)						\
+	"call _dtracetest" DTRACE_STRINGIFY(_##p##_##n)	"\n\t"
+
+#define ARG1_EXTENT	1
+#define ARGS2_EXTENT	2
+#define ARGS3_EXTENT	3
+#define ARGS4_EXTENT	4
+#define ARGS5_EXTENT	5
+#define ARGS6_EXTENT	6
+#define ARGS7_EXTENT	7
+#define ARGS8_EXTENT	8
+#define ARGS9_EXTENT	9
+#define ARGS10_EXTENT	10
+
+#define DTRACE_CALL0ARGS(provider, name)							\
+	asm volatile (										\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              :										\
+	);
+
+#define DTRACE_CALL1ARG(provider, name)								\
+	asm volatile ("movq\t0x0(%0),%%rdi"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi"								\
+	);
+
+#define DTRACE_CALL2ARGS(provider, name)							\
+	asm volatile ("movq\t0x0(%0),%%rdi"						"\n\t"	\
+	              "movq\t0x8(%0),%%rsi"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi", "rsi"							\
+	);
+
+#define DTRACE_CALL3ARGS(provider, name)							\
+	asm volatile ("movq\t0x0(%0),%%rdi"						"\n\t"	\
+	              "movq\t0x8(%0),%%rsi"						"\n\t"	\
+	              "movq\t0x10(%0),%%rdx"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi", "rsi", "rdx"						\
+	);
+
+#define DTRACE_CALL4ARGS(provider, name)							\
+	asm volatile ("movq\t0x0(%0),%%rdi"						"\n\t"	\
+	              "movq\t0x8(%0),%%rsi"						"\n\t"	\
+	              "movq\t0x10(%0),%%rdx"						"\n\t"	\
+	              "movq\t0x18(%0),%%rcx"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi", "rsi", "rdx", "rcx"					\
+	);
+
+#define DTRACE_CALL5ARGS(provider, name)							\
+	asm volatile ("movq\t0x0(%0),%%rdi"						"\n\t"	\
+	              "movq\t0x8(%0),%%rsi"						"\n\t"	\
+	              "movq\t0x10(%0),%%rdx"						"\n\t"	\
+	              "movq\t0x18(%0),%%rcx"						"\n\t"	\
+	              "movq\t0x20(%0),%%r8"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi", "rsi", "rdx", "rcx", "r8"				\
+	);
+
+#define DTRACE_CALL6ARGS(provider, name)							\
+	asm volatile ("movq\t0x0(%0),%%rdi"						"\n\t"	\
+	              "movq\t0x8(%0),%%rsi"						"\n\t"	\
+	              "movq\t0x10(%0),%%rdx"						"\n\t"	\
+	              "movq\t0x18(%0),%%rcx"						"\n\t"	\
+	              "movq\t0x20(%0),%%r8"						"\n\t"	\
+	              "movq\t0x28(%0),%%r9"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi", "rsi", "rdx", "rcx", "r8", "r9"			\
+	);
+
+#define DTRACE_CALL7ARGS(provider, name)							\
+	asm volatile ("subq\t$0x8,%%rsp"						"\n\t"	\
+	              "movq\t0x0(%0),%%rdi"						"\n\t"	\
+	              "movq\t0x8(%0),%%rsi"						"\n\t"	\
+	              "movq\t0x10(%0),%%rdx"						"\n\t"	\
+	              "movq\t0x18(%0),%%rcx"						"\n\t"	\
+	              "movq\t0x20(%0),%%r8"						"\n\t"	\
+	              "movq\t0x28(%0),%%r9"						"\n\t"	\
+	              "movq\t0x30(%0),%%rax"						"\n\t"	\
+	              "movq\t%%rax,0x0(%%rsp)"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              "addq\t$0x8,%%rsp"						"\n\t"	\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi", "rsi", "rdx", "rcx", "r8", "r9", "rax"			\
+	);
+
+#endif // __x86_64__
+
+#ifdef __i386__
+
+#define DTRACE_NOPS			\
+	"nop"			"\n\t"	\
+	"leal 0(%%esi), %%esi"	"\n\t"	
+
+#define DTRACE_CALL_INSN(p,n)						\
+	"call _dtracetest" DTRACE_STRINGIFY(_##p##_##n)	"\n\t"
+
+#define ARG1_EXTENT	1
+#define ARGS2_EXTENT	2
+#define ARGS3_EXTENT	4
+#define ARGS4_EXTENT	4
+#define ARGS5_EXTENT	8
+#define ARGS6_EXTENT	8
+#define ARGS7_EXTENT	8
+#define ARGS8_EXTENT	8
+#define ARGS9_EXTENT	12	
+#define ARGS10_EXTENT	12	
+
+/*
+ * Because this code is used in the kernel, we must not touch any floating point
+ * or specialized registers. This leaves the following registers:
+ *
+ * eax ; volatile, safe to use
+ * ebx ; PIC register, gcc error when used
+ * ecx ; volatile, safe to use
+ * edx ; volatile, safe to use
+ * esi ; non-volatile, otherwise safe to use
+ * edi ; non-volatile, otherwise safe to use
+ *
+ * Using any of the non volatile register causes a spill to stack which is almost
+ * certainly a net performance loss. Also, note that the array ref (__dtrace_args)
+ * consumes one free register. If all three of the volatile regs are used for load/store,
+ * the compiler will spill a register to hold the array ref.
+ *
+ * The end result is that we only pipeline two loads/stores at a time. Blech.
+ */
+
+#define DTRACE_CALL0ARGS(provider, name)							\
+	asm volatile (										\
+	              DTRACE_CALL(provider, name)						\
+	              "# eat trailing nl +tabfrom DTRACE_CALL"					\
+	              :										\
+	              :										\
+	);
+
+#define DTRACE_CALL1ARG(provider, name)								\
+	asm volatile ("subl\t$0x10,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x10,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)		       					\
+	              : "memory", "eax"								\
+	);
+
+#define DTRACE_CALL2ARGS(provider, name)							\
+	asm volatile ("subl\t$0x10,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x10,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"							\
+	);
+
+#define DTRACE_CALL3ARGS(provider, name)							\
+	asm volatile ("subl\t$0x10,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x10,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"							\
+	);
+
+#define DTRACE_CALL4ARGS(provider, name)							\
+	asm volatile ("subl\t$0x10,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x10,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#define DTRACE_CALL5ARGS(provider, name)							\
+	asm volatile ("subl\t$0x20,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              "movl\t0x10(%0),%%eax"						"\n\t"	\
+	              "movl\t%%eax,0x10(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x20,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#define DTRACE_CALL6ARGS(provider, name)							\
+	asm volatile ("subl\t$0x20,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              "movl\t0x10(%0),%%eax"						"\n\t"	\
+		      "movl\t0x14(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x10(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x14(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x20,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#define DTRACE_CALL7ARGS(provider, name)							\
+	asm volatile ("subl\t$0x20,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              "movl\t0x10(%0),%%eax"						"\n\t"	\
+		      "movl\t0x14(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x10(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x14(%%esp)"						"\n\t"	\
+	              "movl\t0x18(%0),%%eax"						"\n\t"	\
+	              "movl\t%%eax,0x18(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x20,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#define DTRACE_CALL8ARGS(provider, name)							\
+	asm volatile ("subl\t$0x20,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              "movl\t0x10(%0),%%eax"						"\n\t"	\
+		      "movl\t0x14(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x10(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x14(%%esp)"						"\n\t"	\
+	              "movl\t0x18(%0),%%eax"						"\n\t"	\
+		      "movl\t0x1C(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x18(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x1C(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x20,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#define DTRACE_CALL9ARGS(provider, name)							\
+	asm volatile ("subl\t$0x30,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              "movl\t0x10(%0),%%eax"						"\n\t"	\
+		      "movl\t0x14(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x10(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x14(%%esp)"						"\n\t"	\
+	              "movl\t0x18(%0),%%eax"						"\n\t"	\
+		      "movl\t0x1C(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x18(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x1C(%%esp)"						"\n\t"	\
+	              "movl\t0x20(%0),%%eax"						"\n\t"	\
+	              "movl\t%%eax,0x20(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x30,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#define DTRACE_CALL10ARGS(provider, name)							\
+	asm volatile ("subl\t$0x30,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              "movl\t0x10(%0),%%eax"						"\n\t"	\
+		      "movl\t0x14(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x10(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x14(%%esp)"						"\n\t"	\
+	              "movl\t0x18(%0),%%eax"						"\n\t"	\
+		      "movl\t0x1C(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x18(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x1C(%%esp)"						"\n\t"	\
+	              "movl\t0x20(%0),%%eax"						"\n\t"	\
+		      "movl\t0x24(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x20(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x24(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x30,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#endif // __i386__
+
+#endif	/* _MACH_I386_SDT_ISA_H */
diff -Nur cctools-877.5/include/mach/i386/vm_param.h cctools-877.5-AnV/include/mach/i386/vm_param.h
--- cctools-877.5/include/mach/i386/vm_param.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/i386/vm_param.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,166 @@
+/*
+ * Copyright (c) 2000-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+
+/* 
+ * Copyright (c) 1994 The University of Utah and
+ * the Computer Systems Laboratory at the University of Utah (CSL).
+ * All rights reserved.
+ *
+ * Permission to use, copy, modify and distribute this software is hereby
+ * granted provided that (1) source code retains these copyright, permission,
+ * and disclaimer notices, and (2) redistributions including binaries
+ * reproduce the notices in supporting documentation, and (3) all advertising
+ * materials mentioning features or use of this software display the following
+ * acknowledgement: ``This product includes software developed by the
+ * Computer Systems Laboratory at the University of Utah.''
+ *
+ * THE UNIVERSITY OF UTAH AND CSL ALLOW FREE USE OF THIS SOFTWARE IN ITS "AS
+ * IS" CONDITION.  THE UNIVERSITY OF UTAH AND CSL DISCLAIM ANY LIABILITY OF
+ * ANY KIND FOR ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ *
+ * CSL requests users of this software to return to csl-dist@cs.utah.edu any
+ * improvements that they make and grant CSL redistribution rights.
+ *
+ */
+
+/*
+ *	File:	vm_param.h
+ *	Author:	Avadis Tevanian, Jr.
+ *	Date:	1985
+ *
+ *	I386 machine dependent virtual memory parameters.
+ *	Most of the declarations are preceeded by I386_ (or i386_)
+ *	which is OK because only I386 specific code will be using
+ *	them.
+ */
+
+#ifndef	_MACH_I386_VM_PARAM_H_
+#define _MACH_I386_VM_PARAM_H_
+
+#define BYTE_SIZE		8		/* byte size in bits */
+
+#define I386_PGBYTES		4096		/* bytes per 80386 page */
+#define I386_PGSHIFT		12		/* bitshift for pages */
+
+#define	PAGE_SIZE		I386_PGBYTES
+#define	PAGE_SHIFT		I386_PGSHIFT
+#define	PAGE_MASK		(PAGE_SIZE - 1)
+
+#define PAGE_MAX_SHIFT          PAGE_SHIFT
+#define PAGE_MAX_SIZE           PAGE_SIZE
+#define PAGE_MAX_MASK           PAGE_MASK
+
+#define PAGE_MIN_SHIFT          PAGE_SHIFT
+#define PAGE_MIN_SIZE           PAGE_SIZE
+#define PAGE_MIN_MASK           PAGE_MASK
+
+#define I386_LPGBYTES		2*1024*1024	/* bytes per large page */
+#define I386_LPGSHIFT		21		/* bitshift for large pages */
+#define I386_LPGMASK		(I386_LPGBYTES-1)
+
+/*
+ *	Convert bytes to pages and convert pages to bytes.
+ *	No rounding is used.
+ */
+
+#define i386_btop(x)		((ppnum_t)((x) >> I386_PGSHIFT))
+#define machine_btop(x)		i386_btop(x)
+#define i386_ptob(x)		(((pmap_paddr_t)(x)) << I386_PGSHIFT)
+#define machine_ptob(x)		i386_ptob(x)
+
+/*
+ *	Round off or truncate to the nearest page.  These will work
+ *	for either addresses or counts.  (i.e. 1 byte rounds to 1 page
+ *	bytes.
+ */
+
+#define i386_round_page(x)	((((pmap_paddr_t)(x)) + I386_PGBYTES - 1) & \
+					~(I386_PGBYTES-1))
+#define i386_trunc_page(x)	(((pmap_paddr_t)(x)) & ~(I386_PGBYTES-1))
+
+
+
+#define VM_MIN_ADDRESS64	((user_addr_t) 0x0000000000000000ULL)
+/*
+ * default top of user stack... it grows down from here
+ */
+#define VM_USRSTACK64		((user_addr_t) 0x00007FFF5FC00000ULL)
+#define VM_DYLD64		((user_addr_t) 0x00007FFF5FC00000ULL)
+#define VM_LIB64_SHR_DATA	((user_addr_t) 0x00007FFF60000000ULL)
+#define VM_LIB64_SHR_TEXT	((user_addr_t) 0x00007FFF80000000ULL)
+/*
+ * the end of the usable user address space , for now about 47 bits.
+ * the 64 bit commpage is past the end of this
+ */
+#define VM_MAX_PAGE_ADDRESS	((user_addr_t) 0x00007FFFFFE00000ULL)
+/*
+ * canonical end of user address space for limits checking
+ */
+#define VM_MAX_USER_PAGE_ADDRESS ((user_addr_t)0x00007FFFFFFFF000ULL)
+
+
+/* system-wide values */
+#define MACH_VM_MIN_ADDRESS		((mach_vm_offset_t) 0)
+#define MACH_VM_MAX_ADDRESS		((mach_vm_offset_t) VM_MAX_PAGE_ADDRESS)
+
+/* process-relative values (all 32-bit legacy only for now) */
+#define VM_MIN_ADDRESS		((vm_offset_t) 0)
+#define VM_USRSTACK32		((vm_offset_t) 0xC0000000)	/* ASLR slides stack down by up to 1 MB */
+#define VM_MAX_ADDRESS		((vm_offset_t) 0xFFE00000)
+
+
+
+#endif	/* _MACH_I386_VM_PARAM_H_ */
diff -Nur cctools-877.5/include/mach/i386/vm_types.h cctools-877.5-AnV/include/mach/i386/vm_types.h
--- cctools-877.5/include/mach/i386/vm_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/i386/vm_types.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,142 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	vm_types.h
+ *	Author:	Avadis Tevanian, Jr.
+ *	Date: 1985
+ *
+ *	Header file for VM data types.  I386 version.
+ */
+
+#ifndef	_MACH_I386_VM_TYPES_H_
+#define _MACH_I386_VM_TYPES_H_
+
+#ifndef	ASSEMBLER
+
+#include <i386/_types.h>
+#include <mach/i386/vm_param.h>
+#include <stdint.h>
+
+/*
+ * natural_t and integer_t are Mach's legacy types for machine-
+ * independent integer types (unsigned, and signed, respectively).
+ * Their original purpose was to define other types in a machine/
+ * compiler independent way.
+ *
+ * They also had an implicit "same size as pointer" characteristic
+ * to them (i.e. Mach's traditional types are very ILP32 or ILP64
+ * centric).  We support x86 ABIs that do not follow either of
+ * these models (specifically LP64).  Therefore, we had to make a
+ * choice between making these types scale with pointers or stay
+ * tied to integers.  Because their use is predominantly tied to
+ * to the size of an integer, we are keeping that association and
+ * breaking free from pointer size guarantees.
+ *
+ * New use of these types is discouraged.
+ */
+typedef __darwin_natural_t	natural_t;
+typedef int			integer_t;
+
+/*
+ * A vm_offset_t is a type-neutral pointer,
+ * e.g. an offset into a virtual memory space.
+ */
+#ifdef __LP64__
+typedef uintptr_t		vm_offset_t;
+#else	/* __LP64__ */
+typedef	natural_t		vm_offset_t;
+#endif	/* __LP64__ */
+
+/*
+ * A vm_size_t is the proper type for e.g.
+ * expressing the difference between two
+ * vm_offset_t entities.
+ */
+#ifdef __LP64__
+typedef uintptr_t		vm_size_t;
+#else	/* __LP64__ */
+typedef	natural_t		vm_size_t;
+#endif	/* __LP64__ */
+
+/*
+ * This new type is independent of a particular vm map's
+ * implementation size - and represents appropriate types
+ * for all possible maps.  This is used for interfaces
+ * where the size of the map is not known - or we don't
+ * want to have to distinguish.
+ */
+typedef uint64_t		mach_vm_address_t;
+typedef uint64_t		mach_vm_offset_t;
+typedef uint64_t		mach_vm_size_t;
+
+typedef uint64_t		vm_map_offset_t;
+typedef uint64_t		vm_map_address_t;
+typedef uint64_t		vm_map_size_t;
+
+typedef mach_vm_address_t	mach_port_context_t;
+
+
+#endif	/* ASSEMBLER */
+
+/*
+ * If composing messages by hand (please do not)
+ */
+#define	MACH_MSG_TYPE_INTEGER_T	MACH_MSG_TYPE_INTEGER_32
+
+#endif	/* _MACH_I386_VM_TYPES_H_ */
diff -Nur cctools-877.5/include/mach/kern_return.h cctools-877.5-AnV/include/mach/kern_return.h
--- cctools-877.5/include/mach/kern_return.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/kern_return.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,326 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	h/kern_return.h
+ *	Author:	Avadis Tevanian, Jr.
+ *	Date:	1985
+ *
+ *	Kernel return codes.
+ *
+ */
+
+#ifndef	_MACH_KERN_RETURN_H_
+#define _MACH_KERN_RETURN_H_
+
+#include <mach/machine/kern_return.h>
+
+#define KERN_SUCCESS			0
+
+#define KERN_INVALID_ADDRESS		1
+		/* Specified address is not currently valid.
+		 */
+
+#define KERN_PROTECTION_FAILURE		2
+		/* Specified memory is valid, but does not permit the
+		 * required forms of access.
+		 */
+
+#define KERN_NO_SPACE			3
+		/* The address range specified is already in use, or
+		 * no address range of the size specified could be
+		 * found.
+		 */
+
+#define KERN_INVALID_ARGUMENT		4
+		/* The function requested was not applicable to this
+		 * type of argument, or an argument is invalid
+		 */
+
+#define KERN_FAILURE			5
+		/* The function could not be performed.  A catch-all.
+		 */
+
+#define KERN_RESOURCE_SHORTAGE		6
+		/* A system resource could not be allocated to fulfill
+		 * this request.  This failure may not be permanent.
+		 */
+
+#define KERN_NOT_RECEIVER		7
+		/* The task in question does not hold receive rights
+		 * for the port argument.
+		 */
+
+#define KERN_NO_ACCESS			8
+		/* Bogus access restriction.
+		 */
+
+#define KERN_MEMORY_FAILURE		9
+		/* During a page fault, the target address refers to a
+		 * memory object that has been destroyed.  This
+		 * failure is permanent.
+		 */
+
+#define KERN_MEMORY_ERROR		10
+		/* During a page fault, the memory object indicated
+		 * that the data could not be returned.  This failure
+		 * may be temporary; future attempts to access this
+		 * same data may succeed, as defined by the memory
+		 * object.
+		 */
+
+#define	KERN_ALREADY_IN_SET		11
+		/* The receive right is already a member of the portset.
+		 */
+
+#define KERN_NOT_IN_SET			12
+		/* The receive right is not a member of a port set.
+		 */
+
+#define KERN_NAME_EXISTS		13
+		/* The name already denotes a right in the task.
+		 */
+
+#define KERN_ABORTED			14
+		/* The operation was aborted.  Ipc code will
+		 * catch this and reflect it as a message error.
+		 */
+
+#define KERN_INVALID_NAME		15
+		/* The name doesn't denote a right in the task.
+		 */
+
+#define	KERN_INVALID_TASK		16
+		/* Target task isn't an active task.
+		 */
+
+#define KERN_INVALID_RIGHT		17
+		/* The name denotes a right, but not an appropriate right.
+		 */
+
+#define KERN_INVALID_VALUE		18
+		/* A blatant range error.
+		 */
+
+#define	KERN_UREFS_OVERFLOW		19
+		/* Operation would overflow limit on user-references.
+		 */
+
+#define	KERN_INVALID_CAPABILITY		20
+		/* The supplied (port) capability is improper.
+		 */
+
+#define KERN_RIGHT_EXISTS		21
+		/* The task already has send or receive rights
+		 * for the port under another name.
+		 */
+
+#define	KERN_INVALID_HOST		22
+		/* Target host isn't actually a host.
+		 */
+
+#define KERN_MEMORY_PRESENT		23
+		/* An attempt was made to supply "precious" data
+		 * for memory that is already present in a
+		 * memory object.
+		 */
+
+#define KERN_MEMORY_DATA_MOVED		24
+		/* A page was requested of a memory manager via
+		 * memory_object_data_request for an object using
+		 * a MEMORY_OBJECT_COPY_CALL strategy, with the
+		 * VM_PROT_WANTS_COPY flag being used to specify
+		 * that the page desired is for a copy of the
+		 * object, and the memory manager has detected
+		 * the page was pushed into a copy of the object
+		 * while the kernel was walking the shadow chain
+		 * from the copy to the object. This error code
+		 * is delivered via memory_object_data_error
+		 * and is handled by the kernel (it forces the
+		 * kernel to restart the fault). It will not be
+		 * seen by users.
+		 */
+
+#define KERN_MEMORY_RESTART_COPY	25
+		/* A strategic copy was attempted of an object
+		 * upon which a quicker copy is now possible.
+		 * The caller should retry the copy using
+		 * vm_object_copy_quickly. This error code
+		 * is seen only by the kernel.
+		 */
+
+#define KERN_INVALID_PROCESSOR_SET	26
+		/* An argument applied to assert processor set privilege
+		 * was not a processor set control port.
+		 */
+
+#define KERN_POLICY_LIMIT		27
+		/* The specified scheduling attributes exceed the thread's
+		 * limits.
+		 */
+
+#define KERN_INVALID_POLICY		28
+		/* The specified scheduling policy is not currently
+		 * enabled for the processor set.
+		 */
+
+#define KERN_INVALID_OBJECT		29
+		/* The external memory manager failed to initialize the
+		 * memory object.
+		 */
+
+#define KERN_ALREADY_WAITING		30
+		/* A thread is attempting to wait for an event for which 
+		 * there is already a waiting thread.
+		 */
+
+#define KERN_DEFAULT_SET		31
+		/* An attempt was made to destroy the default processor
+		 * set.
+		 */
+
+#define KERN_EXCEPTION_PROTECTED	32
+		/* An attempt was made to fetch an exception port that is
+		 * protected, or to abort a thread while processing a
+		 * protected exception.
+		 */
+
+#define KERN_INVALID_LEDGER		33
+		/* A ledger was required but not supplied.
+		 */
+
+#define KERN_INVALID_MEMORY_CONTROL	34
+		/* The port was not a memory cache control port.
+		 */
+
+#define KERN_INVALID_SECURITY		35
+		/* An argument supplied to assert security privilege 	
+		 * was not a host security port.
+		 */
+		
+#define KERN_NOT_DEPRESSED		36
+		/* thread_depress_abort was called on a thread which
+		 * was not currently depressed.
+		 */
+		
+#define KERN_TERMINATED			37
+		/* Object has been terminated and is no longer available
+		 */
+
+#define KERN_LOCK_SET_DESTROYED		38
+		/* Lock set has been destroyed and is no longer available.
+		 */
+
+#define KERN_LOCK_UNSTABLE		39
+		/* The thread holding the lock terminated before releasing
+		 * the lock
+		 */
+
+#define KERN_LOCK_OWNED			40
+		/* The lock is already owned by another thread
+		 */
+
+#define KERN_LOCK_OWNED_SELF		41
+		/* The lock is already owned by the calling thread
+		 */
+
+#define KERN_SEMAPHORE_DESTROYED	42
+		/* Semaphore has been destroyed and is no longer available.
+		 */
+
+#define KERN_RPC_SERVER_TERMINATED	43
+		/* Return from RPC indicating the target server was 
+		 * terminated before it successfully replied 
+		 */
+
+#define KERN_RPC_TERMINATE_ORPHAN	44
+		/* Terminate an orphaned activation.
+		 */
+
+#define KERN_RPC_CONTINUE_ORPHAN	45
+		/* Allow an orphaned activation to continue executing.
+		 */
+
+#define	KERN_NOT_SUPPORTED		46
+		/* Empty thread activation (No thread linked to it)
+		 */
+
+#define	KERN_NODE_DOWN			47
+		/* Remote node down or inaccessible.
+		 */
+
+#define KERN_NOT_WAITING		48
+		/* A signalled thread was not actually waiting. */
+
+#define	KERN_OPERATION_TIMED_OUT        49
+		/* Some thread-oriented operation (semaphore_wait) timed out
+		 */
+
+#define KERN_CODESIGN_ERROR		50
+		/* During a page fault, indicates that the page was rejected
+		 * as a result of a signature check.
+		 */
+
+#define KERN_POLICY_STATIC		51
+		/* The requested property cannot be changed at this time.
+		 */
+
+#define	KERN_RETURN_MAX			0x100
+		/* Maximum return value allowable
+		 */
+
+#endif	/* _MACH_KERN_RETURN_H_ */
diff -Nur cctools-877.5/include/mach/kmod.h cctools-877.5-AnV/include/mach/kmod.h
--- cctools-877.5/include/mach/kmod.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/kmod.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,180 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+#ifndef    _MACH_KMOD_H_
+#define    _MACH_KMOD_H_
+
+#include <mach/kern_return.h>
+#include <mach/mach_types.h>
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+
+#if PRAGMA_MARK
+#pragma mark Basic macros & typedefs
+#endif
+/***********************************************************************
+* Basic macros & typedefs
+***********************************************************************/
+#define KMOD_MAX_NAME    64
+
+#define KMOD_RETURN_SUCCESS    KERN_SUCCESS
+#define KMOD_RETURN_FAILURE    KERN_FAILURE
+
+typedef int kmod_t;
+
+struct  kmod_info;
+typedef kern_return_t kmod_start_func_t(struct kmod_info * ki, void * data);
+typedef kern_return_t kmod_stop_func_t(struct kmod_info * ki, void * data);
+
+#if PRAGMA_MARK
+#pragma mark Structure definitions
+#endif
+/***********************************************************************
+* Structure definitions
+*
+* All structures must be #pragma pack(4).
+***********************************************************************/
+#pragma pack(4)
+
+/* Run-time struct only; never saved to a file */
+typedef struct kmod_reference {
+    struct kmod_reference * next;
+    struct kmod_info      * info;
+} kmod_reference_t;
+
+/***********************************************************************
+* Warning: Any changes to the kmod_info structure affect the
+* KMOD_..._DECL macros below.
+***********************************************************************/
+
+/* The kmod_info_t structure is only safe to use inside the running
+ * kernel.  If you need to work with a kmod_info_t structure outside
+ * the kernel, please use the compatibility definitions below.
+ */
+typedef struct kmod_info {
+    struct kmod_info  * next;
+    int32_t             info_version;           // version of this structure
+    uint32_t            id;
+    char                name[KMOD_MAX_NAME];
+    char                version[KMOD_MAX_NAME];
+    int32_t             reference_count;        // # linkage refs to this 
+    kmod_reference_t  * reference_list;         // who this refs (links on)
+    vm_address_t        address;                // starting address
+    vm_size_t           size;                   // total size
+    vm_size_t           hdr_size;               // unwired hdr size
+    kmod_start_func_t * start;
+    kmod_stop_func_t  * stop;
+} kmod_info_t;
+
+/* A compatibility definition of kmod_info_t for 32-bit kexts.
+ */
+typedef struct kmod_info_32_v1 {
+    uint32_t            next_addr;
+    int32_t             info_version;
+    uint32_t            id;
+    uint8_t             name[KMOD_MAX_NAME];
+    uint8_t             version[KMOD_MAX_NAME];
+    int32_t             reference_count;
+    uint32_t            reference_list_addr;
+    uint32_t            address;
+    uint32_t            size;
+    uint32_t            hdr_size;
+    uint32_t            start_addr;
+    uint32_t            stop_addr;
+} kmod_info_32_v1_t;
+
+/* A compatibility definition of kmod_info_t for 64-bit kexts.
+ */
+typedef struct kmod_info_64_v1 {
+    uint64_t            next_addr;
+    int32_t             info_version;
+    uint32_t            id;
+    uint8_t             name[KMOD_MAX_NAME];
+    uint8_t             version[KMOD_MAX_NAME];
+    int32_t             reference_count;
+    uint64_t            reference_list_addr;
+    uint64_t            address;
+    uint64_t            size;
+    uint64_t            hdr_size;
+    uint64_t            start_addr;
+    uint64_t            stop_addr;
+} kmod_info_64_v1_t;
+
+#pragma pack()
+
+#if PRAGMA_MARK
+#pragma mark Kmod structure declaration macros
+#endif
+/***********************************************************************
+* Kmod structure declaration macros
+***********************************************************************/
+#define KMOD_INFO_NAME       kmod_info
+#define KMOD_INFO_VERSION    1
+
+#define KMOD_DECL(name, version)                                  \
+    static kmod_start_func_t name ## _module_start;               \
+    static kmod_stop_func_t  name ## _module_stop;                \
+    kmod_info_t KMOD_INFO_NAME = { 0, KMOD_INFO_VERSION, -1U,      \
+                       { #name }, { version }, -1, 0, 0, 0, 0,    \
+                           name ## _module_start,                 \
+                           name ## _module_stop };
+
+#define KMOD_EXPLICIT_DECL(name, version, start, stop)            \
+    kmod_info_t KMOD_INFO_NAME = { 0, KMOD_INFO_VERSION, -1U,      \
+                       { #name }, { version }, -1, 0, 0, 0, 0,    \
+                           start, stop };
+
+#if PRAGMA_MARK
+#pragma mark Kernel private declarations
+#endif
+/***********************************************************************
+* Kernel private declarations.
+***********************************************************************/
+
+
+#if PRAGMA_MARK
+#pragma mark Obsolete kmod stuff
+#endif
+/***********************************************************************
+* These 3 should be dropped but they're referenced by MIG declarations.
+***********************************************************************/
+typedef void * kmod_args_t;
+typedef int kmod_control_flavor_t;
+typedef kmod_info_t * kmod_info_array_t;
+
+__END_DECLS
+
+#endif    /* _MACH_KMOD_H_ */
diff -Nur cctools-877.5/include/mach/lock_set.defs cctools-877.5-AnV/include/mach/lock_set.defs
--- cctools-877.5/include/mach/lock_set.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/lock_set.defs	2015-11-16 07:56:13 +0000
@@ -0,0 +1,83 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ * 
+ */
+/*
+ *	File: mach/lock_set.defs
+ *	Author: Joseph CaraDonna
+ *
+ *	Exported kernel calls	
+ *
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	KernelServer
+#endif	/* KERNEL_SERVER */
+			lock_set 617000;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+/*
+ * OBSOLETE interfaces
+ * a lock_set_t is created and destroyed through the task object.
+ *      lock_set_create(task,&lock_set_t,...);
+ *      lock_set_destroy(task,lock_set_t);
+ */
+
+/*
+ * OBSOLETE interfaces
+ */
+routine lock_acquire(
+		lock_set	: lock_set_t;
+		lock_id		: int);
+
+routine lock_release(
+		lock_set	: lock_set_t;
+		lock_id		: int);
+
+routine lock_try(
+		lock_set	: lock_set_t;
+		lock_id		: int);
+
+routine lock_make_stable(
+		lock_set	: lock_set_t;
+		lock_id		: int);
+
+routine lock_handoff(
+		lock_set	: lock_set_t;
+		lock_id		: int);
+
+routine lock_handoff_accept(
+		lock_set	: lock_set_t;
+		lock_id		: int);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/lock_set.h cctools-877.5-AnV/include/mach/lock_set.h
--- cctools-877.5/include/mach/lock_set.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/lock_set.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,327 @@
+#ifndef	_lock_set_user_
+#define	_lock_set_user_
+
+/* Module lock_set */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	lock_set_MSG_COUNT
+#define	lock_set_MSG_COUNT	6
+#endif	/* lock_set_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine lock_acquire */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_acquire
+(
+	lock_set_t lock_set,
+	int lock_id
+);
+
+/* Routine lock_release */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_release
+(
+	lock_set_t lock_set,
+	int lock_id
+);
+
+/* Routine lock_try */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_try
+(
+	lock_set_t lock_set,
+	int lock_id
+);
+
+/* Routine lock_make_stable */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_make_stable
+(
+	lock_set_t lock_set,
+	int lock_id
+);
+
+/* Routine lock_handoff */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_handoff
+(
+	lock_set_t lock_set,
+	int lock_id
+);
+
+/* Routine lock_handoff_accept */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_handoff_accept
+(
+	lock_set_t lock_set,
+	int lock_id
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__lock_set_subsystem__defined
+#define __Request__lock_set_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int lock_id;
+	} __Request__lock_acquire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int lock_id;
+	} __Request__lock_release_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int lock_id;
+	} __Request__lock_try_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int lock_id;
+	} __Request__lock_make_stable_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int lock_id;
+	} __Request__lock_handoff_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int lock_id;
+	} __Request__lock_handoff_accept_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__lock_set_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__lock_set_subsystem__defined
+#define __RequestUnion__lock_set_subsystem__defined
+union __RequestUnion__lock_set_subsystem {
+	__Request__lock_acquire_t Request_lock_acquire;
+	__Request__lock_release_t Request_lock_release;
+	__Request__lock_try_t Request_lock_try;
+	__Request__lock_make_stable_t Request_lock_make_stable;
+	__Request__lock_handoff_t Request_lock_handoff;
+	__Request__lock_handoff_accept_t Request_lock_handoff_accept;
+};
+#endif /* !__RequestUnion__lock_set_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__lock_set_subsystem__defined
+#define __Reply__lock_set_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_acquire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_release_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_try_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_make_stable_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_handoff_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_handoff_accept_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__lock_set_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__lock_set_subsystem__defined
+#define __ReplyUnion__lock_set_subsystem__defined
+union __ReplyUnion__lock_set_subsystem {
+	__Reply__lock_acquire_t Reply_lock_acquire;
+	__Reply__lock_release_t Reply_lock_release;
+	__Reply__lock_try_t Reply_lock_try;
+	__Reply__lock_make_stable_t Reply_lock_make_stable;
+	__Reply__lock_handoff_t Reply_lock_handoff;
+	__Reply__lock_handoff_accept_t Reply_lock_handoff_accept;
+};
+#endif /* !__RequestUnion__lock_set_subsystem__defined */
+
+#ifndef subsystem_to_name_map_lock_set
+#define subsystem_to_name_map_lock_set \
+    { "lock_acquire", 617000 },\
+    { "lock_release", 617001 },\
+    { "lock_try", 617002 },\
+    { "lock_make_stable", 617003 },\
+    { "lock_handoff", 617004 },\
+    { "lock_handoff_accept", 617005 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _lock_set_user_ */
diff -Nur cctools-877.5/include/mach/mach.h cctools-877.5-AnV/include/mach/mach.h
--- cctools-877.5/include/mach/mach.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,237 @@
+/*
+ * Copyright (c) 1999-2014 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+
+/* 
+ *  Includes all the types that a normal user
+ *  of Mach programs should need
+ */
+
+#ifndef	_MACH_H_
+#define	_MACH_H_
+
+#define __MACH30__
+#define MACH_IPC_FLAVOR UNTYPED
+
+#include <mach/std_types.h>
+#include <mach/mach_types.h>
+#include <mach/mach_interface.h>
+#include <mach/mach_port.h>
+#include <mach/mach_init.h>
+#include <mach/mach_host.h>
+#include <mach/thread_switch.h>
+
+#include <mach/rpc.h>  		/* for compatibility only */
+#include <mach/mig.h>
+
+#include <mach/mig_errors.h>
+#include <mach/mach_error.h>
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+/*
+ * Standard prototypes
+ */
+extern void			panic_init(mach_port_t);
+extern void			panic(const char *, ...);
+
+extern void			safe_gets(char *,
+					  char *,
+					  int);
+
+extern void			slot_name(cpu_type_t,
+					  cpu_subtype_t,
+					  char **,
+					  char **);
+
+extern void			mig_reply_setup(mach_msg_header_t *,
+						mach_msg_header_t *);
+
+extern void			mach_msg_destroy(mach_msg_header_t *);
+
+extern mach_msg_return_t	mach_msg_receive(mach_msg_header_t *);
+
+extern mach_msg_return_t	mach_msg_send(mach_msg_header_t *);
+
+extern mach_msg_return_t	mach_msg_server_once(boolean_t (*)
+						     (mach_msg_header_t *,
+						      mach_msg_header_t *),
+						     mach_msg_size_t,
+						     mach_port_t,
+						     mach_msg_options_t);
+extern mach_msg_return_t	mach_msg_server(boolean_t (*)
+						(mach_msg_header_t *,
+						 mach_msg_header_t *),
+						mach_msg_size_t,
+						mach_port_t,
+						mach_msg_options_t);
+
+extern mach_msg_return_t	mach_msg_server_importance(boolean_t (*)
+						(mach_msg_header_t *,
+						 mach_msg_header_t *),
+						mach_msg_size_t,
+						mach_port_t,
+						mach_msg_options_t);
+/*
+ * Prototypes for compatibility
+ */
+extern kern_return_t	clock_get_res(mach_port_t,
+				      clock_res_t *);
+extern kern_return_t	clock_set_res(mach_port_t,
+				      clock_res_t);
+
+extern kern_return_t	clock_sleep(mach_port_t,
+				    int,
+				    mach_timespec_t,
+				    mach_timespec_t *);
+
+/*!
+ * @group voucher_mach_msg Prototypes
+ */
+
+#define VOUCHER_MACH_MSG_API_VERSION 20140205
+
+/*!
+ * @typedef voucher_mach_msg_state_t
+ *
+ * @abstract
+ * Opaque object encapsulating state changed by voucher_mach_msg_adopt().
+ */
+typedef struct voucher_mach_msg_state_s *voucher_mach_msg_state_t;
+
+/*!
+ * @const VOUCHER_MACH_MSG_STATE_UNCHANGED
+ *
+ * @discussion
+ * Constant indicating no state change occurred.
+ */
+#define VOUCHER_MACH_MSG_STATE_UNCHANGED ((voucher_mach_msg_state_t)~0ul)
+
+/*!
+ * @function voucher_mach_msg_set
+ *
+ * @abstract
+ * Change specified message header to contain current mach voucher with a
+ * COPY_SEND disposition.
+ * Does not change message if it already has non-zero MACH_MSGH_BITS_VOUCHER.
+ *
+ * @discussion
+ * Borrows reference to current thread voucher so message should be sent
+ * immediately (without intervening calls that might change that voucher).
+ *
+ * @param msg
+ * The message to modify.
+ *
+ * @result
+ * True if header was changed.
+ */
+extern boolean_t voucher_mach_msg_set(mach_msg_header_t *msg);
+
+/*!
+ * @function voucher_mach_msg_clear
+ *
+ * @abstract
+ * Removes changes made to specified message header by voucher_mach_msg_set()
+ * and any mach_msg() send operations (successful or not).
+ * If the message is not needed further, mach_msg_destroy() should be called
+ * instead.
+ *
+ * @discussion
+ * Not intended to be called if voucher_mach_msg_set() returned false.
+ * Releases reference to message mach voucher if an extra reference was
+ * acquired due to an unsuccessful send operation (pseudo-receive).
+ *
+ * @param msg
+ * The message to modify.
+ */
+extern void voucher_mach_msg_clear(mach_msg_header_t *msg);
+
+/*!
+ * @function voucher_mach_msg_adopt
+ *
+ * @abstract
+ * Adopt the voucher contained in the specified message on the current thread
+ * and return the previous thread voucher state.
+ *
+ * @discussion
+ * Ownership of the mach voucher in the message is transferred to the current
+ * thread and the message header voucher fields are cleared.
+ *
+ * @param msg
+ * The message to query and modify.
+ *
+ * @result
+ * The previous thread voucher state or VOUCHER_MACH_MSG_STATE_UNCHANGED if no
+ * state change occurred.
+ */
+extern voucher_mach_msg_state_t voucher_mach_msg_adopt(mach_msg_header_t *msg);
+
+/*!
+ * @function voucher_mach_msg_revert
+ *
+ * @abstract
+ * Restore thread voucher state previously modified by voucher_mach_msg_adopt().
+ *
+ * @discussion
+ * Current thread voucher reference is released.
+ * No change to thread voucher state if passed VOUCHER_MACH_MSG_STATE_UNCHANGED.
+ *
+ * @param state
+ * The thread voucher state to restore.
+ */
+
+extern void voucher_mach_msg_revert(voucher_mach_msg_state_t state);
+
+__END_DECLS
+
+#endif	/* _MACH_H_ */
diff -Nur cctools-877.5/include/mach/mach_error.h cctools-877.5-AnV/include/mach/mach_error.h
--- cctools-877.5/include/mach/mach_error.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_error.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,93 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS 
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie the
+ * rights to redistribute these changes.
+ */
+
+/*
+ *	File:	mach_error.h
+ *	Author:	Douglas Orr, Carnegie Mellon University
+ *	Date:	Mar. 1988
+ *
+ *	Definitions of routines in mach_error.c
+ */
+
+#ifndef	_MACH_ERROR_
+#define	_MACH_ERROR_	1
+
+#include <mach/error.h>
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+char		*mach_error_string(
+/*
+ *	Returns a string appropriate to the error argument given
+ */
+	mach_error_t error_value
+				);
+
+void		mach_error(
+/*
+ *	Prints an appropriate message on the standard error stream
+ */
+	const char	*str,
+	mach_error_t	error_value
+				);
+
+char		*mach_error_type(
+/*
+ *	Returns a string with the error system, subsystem and code
+ */
+	mach_error_t	error_value
+				);
+__END_DECLS
+
+#endif	/* _MACH_ERROR_ */
diff -Nur cctools-877.5/include/mach/mach_exc.defs cctools-877.5-AnV/include/mach/mach_exc.defs
--- cctools-877.5/include/mach/mach_exc.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_exc.defs	2015-11-16 07:56:13 +0000
@@ -0,0 +1,119 @@
+/*
+ * Copyright (c) 2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ * Abstract:
+ *	MiG definitions file for Mach exception interface.
+ */
+
+subsystem
+#if	KERNEL_USER
+	  KernelUser
+#endif
+		     mach_exc 2405;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+ServerPrefix catch_;
+
+type mach_exception_data_t	= array[*:2] of int64_t;
+type exception_type_t		= int;
+
+routine		mach_exception_raise(
+#if	KERNEL_USER
+			exception_port	: mach_port_move_send_t;
+			thread		: mach_port_move_send_t;
+			task		: mach_port_move_send_t;
+#else	/* KERNEL_USER */
+			exception_port	: mach_port_t;
+			thread		: mach_port_t;
+			task		: mach_port_t;
+#endif	/* KERNEL_USER */
+			exception	: exception_type_t;
+			code		: mach_exception_data_t
+			);
+
+routine		mach_exception_raise_state(
+#if	KERNEL_USER
+			exception_port	: mach_port_move_send_t;
+#else	/* KERNEL_USER */
+			exception_port	: mach_port_t;
+#endif	/* KERNEL_USER */
+			exception	: exception_type_t;
+			code		: mach_exception_data_t, const;
+		  inout flavor		: int;
+			old_state	: thread_state_t, const;
+		    out new_state	: thread_state_t);
+
+routine		mach_exception_raise_state_identity(
+#if	KERNEL_USER
+			exception_port  : mach_port_move_send_t;
+			thread		: mach_port_move_send_t;
+			task		: mach_port_move_send_t;
+#else	/* KERNEL_USER */
+			exception_port  : mach_port_t;
+			thread          : mach_port_t;
+			task            : mach_port_t;
+#endif	/* KERNEL_USER */
+			exception       : exception_type_t;
+			code            : mach_exception_data_t;
+		  inout flavor          : int;
+			old_state       : thread_state_t;
+		    out new_state       : thread_state_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/mach_host.defs cctools-877.5-AnV/include/mach/mach_host.defs
--- cctools-877.5/include/mach/mach_host.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_host.defs	2015-11-16 07:56:13 +0000
@@ -0,0 +1,289 @@
+/*
+ * Copyright (c) 2000-2009 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ * File:	mach/mach_host.defs
+ *
+ * Abstract:
+ *	Mach host operations support.  Includes processor allocation and
+ *	control.  
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		       mach_host 200;
+
+/*
+ *	Basic types
+ */
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach/clock_types.defs>
+#include <mach_debug/mach_debug_types.defs>
+
+/*
+ * References to host objects are returned by:
+ *	mach_host_self() - trap
+ */
+
+/*
+ *	Return information about this host.
+ */
+routine host_info(
+		host		: host_t;
+		flavor		: host_flavor_t;
+	out	host_info_out	: host_info_t, CountInOut);
+
+/*
+ *	Get string describing current kernel version.
+ */
+routine	host_kernel_version(
+		host		: host_t;
+	out	kernel_version	: kernel_version_t);
+
+/*
+ *      Get host page size
+ *	(compatibility for running old libraries on new kernels -
+ *	host_page_size() is now a library routine based on constants)
+ */
+routine _host_page_size(
+		host		: host_t;
+	out	out_page_size	: vm_size_t);
+
+/*
+ *	Allow pagers to create named entries that point to un-mapped
+ *	abstract memory object.  The named entries are generally mappable
+ *	and can be subsetted through the mach_make_memory_entry call
+ */
+routine mach_memory_object_memory_entry(
+		host		:host_t;
+		internal	:boolean_t;
+		size		:vm_size_t;
+		permission	:vm_prot_t;
+		pager		:memory_object_t;
+	out	entry_handle	:mach_port_move_send_t);
+
+
+/*
+ *      Get processor info for all the processors on this host.
+ *	The returned data is an OOL array of processor info.
+ */
+routine host_processor_info(
+		host			: host_t;
+                flavor          	: processor_flavor_t;
+	out	out_processor_count 	: natural_t;
+        out     out_processor_info  	: processor_info_array_t);
+
+/*
+ * 	Return host IO master access port
+ */
+routine host_get_io_master(
+                host            : host_t;
+        out     io_master       : io_master_t);
+
+/*
+ *	Get service port for a processor set.
+ *	Available to all.
+ */
+routine host_get_clock_service(
+		host		: host_t;
+		clock_id	: clock_id_t;
+	out	clock_serv	: clock_serv_t);
+
+/*
+ * kernel module interface (obsolete as of SnowLeopard)
+ * see mach/kmod.h
+ */
+/* kmod_ MIG calls now return KERN_NOT_SUPPORTED on PPC/i386/x86_64. */
+routine	kmod_get_info(
+		host		: host_t;
+	out	modules		: kmod_args_t);
+
+/*
+ *	Returns information about the memory allocation zones.
+ *      Supported in all kernels..
+ *
+ *	DEPRECATED!  Use mach_zone_info() instead.
+ */
+routine host_zone_info(
+		host		: host_priv_t;
+	out	names		: zone_name_array_t,
+					Dealloc;
+	out	info		: zone_info_array_t,
+					Dealloc);
+
+/*
+ *	Returns information about the global VP table.
+ *      Only supported in MACH_VM_DEBUG kernels,
+ *      otherwise returns KERN_FAILURE.
+ */
+routine host_virtual_physical_table_info(
+		host		: host_t;
+	out	info		: hash_info_bucket_array_t,
+					Dealloc);
+
+
+skip; /* was host_ipc_hash_info */
+skip; /* was enable_bluebox */
+skip; /* was disable_bluebox */
+
+/*
+ * JMM - Keep processor_set related items at the end for easy
+ * removal.
+ */
+/*
+ *	Get default processor set for host.
+ */
+routine processor_set_default(
+		host		: host_t;
+	out	default_set	: processor_set_name_t);
+
+/*
+ *	Create new processor set.  Returns real port for manipulations,
+ *	and name port for obtaining information.
+ */
+routine processor_set_create(
+		host		: host_t;
+	out	new_set		: processor_set_t;
+	out	new_name	: processor_set_name_t);
+
+/*
+ * 	Temporary interfaces for conversion to 64 bit data path 
+ */
+
+routine mach_memory_object_memory_entry_64(
+		host		:host_t;
+		internal	:boolean_t;
+		size		:memory_object_size_t;
+		permission	:vm_prot_t;
+		pager		:memory_object_t;
+	out	entry_handle	:mach_port_move_send_t);
+
+/*
+ *	Return statistics from this host.
+ */
+routine host_statistics(
+		host_priv	: host_t;
+		flavor		: host_flavor_t;
+	out	host_info_out	: host_info_t, CountInOut);
+
+routine host_request_notification(
+		host		: host_t;
+		notify_type	: host_flavor_t;
+		notify_port	: mach_port_make_send_once_t);
+
+routine host_lockgroup_info(
+		host		: host_t;
+	out	lockgroup_info	: lockgroup_info_array_t,
+					Dealloc);
+
+/*
+ *	Return 64-bit statistics from this host.
+ */
+routine host_statistics64(
+		host_priv	: host_t;
+		flavor		: host_flavor_t;
+	out	host_info64_out	: host_info64_t, CountInOut);
+
+/*
+ *	Returns information about the memory allocation zones.
+ *      Data returned is compatible with various caller and kernel
+ *	address space sizes (unlike host_zone_info()).
+ */
+routine mach_zone_info(
+		host		: host_priv_t;
+	out	names		: mach_zone_name_array_t,
+					Dealloc;
+	out	info		: mach_zone_info_array_t,
+					Dealloc);
+
+skip;
+
+/*
+ *	Create a new voucher by running a series of commands against
+ *	<key, previous-voucher> pairs of resource attributes.
+ */
+routine host_create_mach_voucher(
+		host		: host_t;
+		recipes		: mach_voucher_attr_raw_recipe_array_t;
+	out	voucher		: ipc_voucher_t);
+
+/*
+ *	Register a resource manager with the kernel.  A new key is selected.
+ */
+routine host_register_mach_voucher_attr_manager(
+		host		: host_t;
+		attr_manager	: mach_voucher_attr_manager_t;
+		default_value	: mach_voucher_attr_value_handle_t;
+	out	new_key		: mach_voucher_attr_key_t;
+	out	new_attr_control: ipc_voucher_attr_control_t);
+
+/*
+ *	Register a resource manager (with a well-known key value) with the kernel.
+ */
+routine host_register_well_known_mach_voucher_attr_manager(
+		host		: host_t;
+		attr_manager	: mach_voucher_attr_manager_t;
+		default_value	: mach_voucher_attr_value_handle_t;
+		key		: mach_voucher_attr_key_t;
+	out	new_attr_control: ipc_voucher_attr_control_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/mach_host.h cctools-877.5-AnV/include/mach/mach_host.h
--- cctools-877.5/include/mach/mach_host.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_host.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,1021 @@
+#ifndef	_mach_host_user_
+#define	_mach_host_user_
+
+/* Module mach_host */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	mach_host_MSG_COUNT
+#define	mach_host_MSG_COUNT	25
+#endif	/* mach_host_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+#include <mach/mach_init.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine host_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_info
+(
+	host_t host,
+	host_flavor_t flavor,
+	host_info_t host_info_out,
+	mach_msg_type_number_t *host_info_outCnt
+);
+
+/* Routine host_kernel_version */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_kernel_version
+(
+	host_t host,
+	kernel_version_t kernel_version
+);
+
+/* Routine _host_page_size */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t _host_page_size
+(
+	host_t host,
+	vm_size_t *out_page_size
+);
+
+/* Routine mach_memory_object_memory_entry */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_memory_object_memory_entry
+(
+	host_t host,
+	boolean_t internal,
+	vm_size_t size,
+	vm_prot_t permission,
+	memory_object_t pager,
+	mach_port_t *entry_handle
+);
+
+/* Routine host_processor_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_processor_info
+(
+	host_t host,
+	processor_flavor_t flavor,
+	natural_t *out_processor_count,
+	processor_info_array_t *out_processor_info,
+	mach_msg_type_number_t *out_processor_infoCnt
+);
+
+/* Routine host_get_io_master */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_io_master
+(
+	host_t host,
+	io_master_t *io_master
+);
+
+/* Routine host_get_clock_service */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_clock_service
+(
+	host_t host,
+	clock_id_t clock_id,
+	clock_serv_t *clock_serv
+);
+
+/* Routine kmod_get_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t kmod_get_info
+(
+	host_t host,
+	kmod_args_t *modules,
+	mach_msg_type_number_t *modulesCnt
+);
+
+/* Routine host_zone_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_zone_info
+(
+	host_priv_t host,
+	zone_name_array_t *names,
+	mach_msg_type_number_t *namesCnt,
+	zone_info_array_t *info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine host_virtual_physical_table_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_virtual_physical_table_info
+(
+	host_t host,
+	hash_info_bucket_array_t *info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine processor_set_default */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_default
+(
+	host_t host,
+	processor_set_name_t *default_set
+);
+
+/* Routine processor_set_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_create
+(
+	host_t host,
+	processor_set_t *new_set,
+	processor_set_name_t *new_name
+);
+
+/* Routine mach_memory_object_memory_entry_64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_memory_object_memory_entry_64
+(
+	host_t host,
+	boolean_t internal,
+	memory_object_size_t size,
+	vm_prot_t permission,
+	memory_object_t pager,
+	mach_port_t *entry_handle
+);
+
+/* Routine host_statistics */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_statistics
+(
+	host_t host_priv,
+	host_flavor_t flavor,
+	host_info_t host_info_out,
+	mach_msg_type_number_t *host_info_outCnt
+);
+
+/* Routine host_request_notification */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_request_notification
+(
+	host_t host,
+	host_flavor_t notify_type,
+	mach_port_t notify_port
+);
+
+/* Routine host_lockgroup_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_lockgroup_info
+(
+	host_t host,
+	lockgroup_info_array_t *lockgroup_info,
+	mach_msg_type_number_t *lockgroup_infoCnt
+);
+
+/* Routine host_statistics64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_statistics64
+(
+	host_t host_priv,
+	host_flavor_t flavor,
+	host_info64_t host_info64_out,
+	mach_msg_type_number_t *host_info64_outCnt
+);
+
+/* Routine mach_zone_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_zone_info
+(
+	host_priv_t host,
+	mach_zone_name_array_t *names,
+	mach_msg_type_number_t *namesCnt,
+	mach_zone_info_array_t *info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine host_create_mach_voucher */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_create_mach_voucher
+(
+	host_t host,
+	mach_voucher_attr_raw_recipe_array_t recipes,
+	mach_msg_type_number_t recipesCnt,
+	ipc_voucher_t *voucher
+);
+
+/* Routine host_register_mach_voucher_attr_manager */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_register_mach_voucher_attr_manager
+(
+	host_t host,
+	mach_voucher_attr_manager_t attr_manager,
+	mach_voucher_attr_value_handle_t default_value,
+	mach_voucher_attr_key_t *new_key,
+	ipc_voucher_attr_control_t *new_attr_control
+);
+
+/* Routine host_register_well_known_mach_voucher_attr_manager */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_register_well_known_mach_voucher_attr_manager
+(
+	host_t host,
+	mach_voucher_attr_manager_t attr_manager,
+	mach_voucher_attr_value_handle_t default_value,
+	mach_voucher_attr_key_t key,
+	ipc_voucher_attr_control_t *new_attr_control
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__mach_host_subsystem__defined
+#define __Request__mach_host_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		host_flavor_t flavor;
+		mach_msg_type_number_t host_info_outCnt;
+	} __Request__host_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_kernel_version_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request___host_page_size_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pager;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t internal;
+		vm_size_t size;
+		vm_prot_t permission;
+	} __Request__mach_memory_object_memory_entry_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		processor_flavor_t flavor;
+	} __Request__host_processor_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_get_io_master_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		clock_id_t clock_id;
+	} __Request__host_get_clock_service_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__kmod_get_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_virtual_physical_table_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_set_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pager;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t internal;
+		memory_object_size_t size;
+		vm_prot_t permission;
+	} __Request__mach_memory_object_memory_entry_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		host_flavor_t flavor;
+		mach_msg_type_number_t host_info_outCnt;
+	} __Request__host_statistics_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t notify_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		host_flavor_t notify_type;
+	} __Request__host_request_notification_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_lockgroup_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		host_flavor_t flavor;
+		mach_msg_type_number_t host_info64_outCnt;
+	} __Request__host_statistics64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__mach_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_msg_type_number_t recipesCnt;
+		uint8_t recipes[5120];
+	} __Request__host_create_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t attr_manager;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_voucher_attr_value_handle_t default_value;
+	} __Request__host_register_mach_voucher_attr_manager_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t attr_manager;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_voucher_attr_value_handle_t default_value;
+		mach_voucher_attr_key_t key;
+	} __Request__host_register_well_known_mach_voucher_attr_manager_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__mach_host_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__mach_host_subsystem__defined
+#define __RequestUnion__mach_host_subsystem__defined
+union __RequestUnion__mach_host_subsystem {
+	__Request__host_info_t Request_host_info;
+	__Request__host_kernel_version_t Request_host_kernel_version;
+	__Request___host_page_size_t Request__host_page_size;
+	__Request__mach_memory_object_memory_entry_t Request_mach_memory_object_memory_entry;
+	__Request__host_processor_info_t Request_host_processor_info;
+	__Request__host_get_io_master_t Request_host_get_io_master;
+	__Request__host_get_clock_service_t Request_host_get_clock_service;
+	__Request__kmod_get_info_t Request_kmod_get_info;
+	__Request__host_zone_info_t Request_host_zone_info;
+	__Request__host_virtual_physical_table_info_t Request_host_virtual_physical_table_info;
+	__Request__processor_set_default_t Request_processor_set_default;
+	__Request__processor_set_create_t Request_processor_set_create;
+	__Request__mach_memory_object_memory_entry_64_t Request_mach_memory_object_memory_entry_64;
+	__Request__host_statistics_t Request_host_statistics;
+	__Request__host_request_notification_t Request_host_request_notification;
+	__Request__host_lockgroup_info_t Request_host_lockgroup_info;
+	__Request__host_statistics64_t Request_host_statistics64;
+	__Request__mach_zone_info_t Request_mach_zone_info;
+	__Request__host_create_mach_voucher_t Request_host_create_mach_voucher;
+	__Request__host_register_mach_voucher_attr_manager_t Request_host_register_mach_voucher_attr_manager;
+	__Request__host_register_well_known_mach_voucher_attr_manager_t Request_host_register_well_known_mach_voucher_attr_manager;
+};
+#endif /* !__RequestUnion__mach_host_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__mach_host_subsystem__defined
+#define __Reply__mach_host_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t host_info_outCnt;
+		integer_t host_info_out[68];
+	} __Reply__host_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t kernel_versionOffset; /* MiG doesn't use it */
+		mach_msg_type_number_t kernel_versionCnt;
+		char kernel_version[512];
+	} __Reply__host_kernel_version_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_size_t out_page_size;
+	} __Reply___host_page_size_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t entry_handle;
+		/* end of the kernel processed data */
+	} __Reply__mach_memory_object_memory_entry_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t out_processor_info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		natural_t out_processor_count;
+		mach_msg_type_number_t out_processor_infoCnt;
+	} __Reply__host_processor_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t io_master;
+		/* end of the kernel processed data */
+	} __Reply__host_get_io_master_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t clock_serv;
+		/* end of the kernel processed data */
+	} __Reply__host_get_clock_service_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t modules;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t modulesCnt;
+	} __Reply__kmod_get_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t names;
+		mach_msg_ool_descriptor_t info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t namesCnt;
+		mach_msg_type_number_t infoCnt;
+	} __Reply__host_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t infoCnt;
+	} __Reply__host_virtual_physical_table_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t default_set;
+		/* end of the kernel processed data */
+	} __Reply__processor_set_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		mach_msg_port_descriptor_t new_name;
+		/* end of the kernel processed data */
+	} __Reply__processor_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t entry_handle;
+		/* end of the kernel processed data */
+	} __Reply__mach_memory_object_memory_entry_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t host_info_outCnt;
+		integer_t host_info_out[68];
+	} __Reply__host_statistics_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_request_notification_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t lockgroup_info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t lockgroup_infoCnt;
+	} __Reply__host_lockgroup_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t host_info64_outCnt;
+		integer_t host_info64_out[256];
+	} __Reply__host_statistics64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t names;
+		mach_msg_ool_descriptor_t info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t namesCnt;
+		mach_msg_type_number_t infoCnt;
+	} __Reply__mach_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t voucher;
+		/* end of the kernel processed data */
+	} __Reply__host_create_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_attr_control;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_voucher_attr_key_t new_key;
+	} __Reply__host_register_mach_voucher_attr_manager_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_attr_control;
+		/* end of the kernel processed data */
+	} __Reply__host_register_well_known_mach_voucher_attr_manager_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__mach_host_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__mach_host_subsystem__defined
+#define __ReplyUnion__mach_host_subsystem__defined
+union __ReplyUnion__mach_host_subsystem {
+	__Reply__host_info_t Reply_host_info;
+	__Reply__host_kernel_version_t Reply_host_kernel_version;
+	__Reply___host_page_size_t Reply__host_page_size;
+	__Reply__mach_memory_object_memory_entry_t Reply_mach_memory_object_memory_entry;
+	__Reply__host_processor_info_t Reply_host_processor_info;
+	__Reply__host_get_io_master_t Reply_host_get_io_master;
+	__Reply__host_get_clock_service_t Reply_host_get_clock_service;
+	__Reply__kmod_get_info_t Reply_kmod_get_info;
+	__Reply__host_zone_info_t Reply_host_zone_info;
+	__Reply__host_virtual_physical_table_info_t Reply_host_virtual_physical_table_info;
+	__Reply__processor_set_default_t Reply_processor_set_default;
+	__Reply__processor_set_create_t Reply_processor_set_create;
+	__Reply__mach_memory_object_memory_entry_64_t Reply_mach_memory_object_memory_entry_64;
+	__Reply__host_statistics_t Reply_host_statistics;
+	__Reply__host_request_notification_t Reply_host_request_notification;
+	__Reply__host_lockgroup_info_t Reply_host_lockgroup_info;
+	__Reply__host_statistics64_t Reply_host_statistics64;
+	__Reply__mach_zone_info_t Reply_mach_zone_info;
+	__Reply__host_create_mach_voucher_t Reply_host_create_mach_voucher;
+	__Reply__host_register_mach_voucher_attr_manager_t Reply_host_register_mach_voucher_attr_manager;
+	__Reply__host_register_well_known_mach_voucher_attr_manager_t Reply_host_register_well_known_mach_voucher_attr_manager;
+};
+#endif /* !__RequestUnion__mach_host_subsystem__defined */
+
+#ifndef subsystem_to_name_map_mach_host
+#define subsystem_to_name_map_mach_host \
+    { "host_info", 200 },\
+    { "host_kernel_version", 201 },\
+    { "_host_page_size", 202 },\
+    { "mach_memory_object_memory_entry", 203 },\
+    { "host_processor_info", 204 },\
+    { "host_get_io_master", 205 },\
+    { "host_get_clock_service", 206 },\
+    { "kmod_get_info", 207 },\
+    { "host_zone_info", 208 },\
+    { "host_virtual_physical_table_info", 209 },\
+    { "processor_set_default", 213 },\
+    { "processor_set_create", 214 },\
+    { "mach_memory_object_memory_entry_64", 215 },\
+    { "host_statistics", 216 },\
+    { "host_request_notification", 217 },\
+    { "host_lockgroup_info", 218 },\
+    { "host_statistics64", 219 },\
+    { "mach_zone_info", 220 },\
+    { "host_create_mach_voucher", 222 },\
+    { "host_register_mach_voucher_attr_manager", 223 },\
+    { "host_register_well_known_mach_voucher_attr_manager", 224 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _mach_host_user_ */
diff -Nur cctools-877.5/include/mach/mach_init.h cctools-877.5-AnV/include/mach/mach_init.h
--- cctools-877.5/include/mach/mach_init.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_init.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,110 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987,1986 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+
+/*
+ *	Items provided by the Mach environment initialization.
+ */
+
+#ifndef	_MACH_INIT_
+#define	_MACH_INIT_	1
+
+#include <mach/mach_types.h>
+#include <mach/vm_page_size.h>
+#include <stdarg.h>
+
+#include <sys/cdefs.h>
+
+/*
+ *	Kernel-related ports; how a task/thread controls itself
+ */
+
+__BEGIN_DECLS
+extern mach_port_t mach_host_self(void);
+extern mach_port_t mach_thread_self(void);
+extern kern_return_t host_page_size(host_t, vm_size_t *);
+
+extern mach_port_t	mach_task_self_;
+#define	mach_task_self() mach_task_self_
+#define	current_task()	mach_task_self()
+
+__END_DECLS
+#include <mach/mach_traps.h>
+__BEGIN_DECLS
+
+/*
+ *	Other important ports in the Mach user environment
+ */
+
+extern	mach_port_t	bootstrap_port;
+
+/*
+ *	Where these ports occur in the "mach_ports_register"
+ *	collection... only servers or the runtime library need know.
+ */
+
+#define	NAME_SERVER_SLOT	0
+#define	ENVIRONMENT_SLOT	1
+#define SERVICE_SLOT		2
+
+#define	MACH_PORTS_SLOTS_USED	3
+
+/*
+ *	fprintf_stderr uses vprintf_stderr_func to produce
+ *	error messages, this can be overridden by a user
+ *	application to point to a user-specified output function
+ */
+extern int (*vprintf_stderr_func)(const char *format, va_list ap);
+
+__END_DECLS
+
+#endif	/* _MACH_INIT_ */
diff -Nur cctools-877.5/include/mach/mach_interface.h cctools-877.5-AnV/include/mach/mach_interface.h
--- cctools-877.5/include/mach/mach_interface.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_interface.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,53 @@
+/*
+ * Copyright (c) 2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (C) Apple Computer 1998
+ * ALL Rights Reserved
+ */
+/*
+ * This file represents the interfaces that used to come
+ * from creating the user headers from the mach.defs file.
+ * Because mach.defs was decomposed, this file now just
+ * wraps up all the new interface headers generated from
+ * each of the new .defs resulting from that decomposition.
+ */
+#ifndef	_MACH_INTERFACE_H_
+#define _MACH_INTERFACE_H_
+
+#include <mach/clock_priv.h>
+#include <mach/host_priv.h>
+#include <mach/host_security.h>
+#include <mach/lock_set.h>
+#include <mach/processor.h>
+#include <mach/processor_set.h>
+#include <mach/semaphore.h>
+#include <mach/task.h>
+#include <mach/thread_act.h>
+#include <mach/vm_map.h>
+
+#endif /* _MACH_INTERFACE_H_ */
diff -Nur cctools-877.5/include/mach/mach_param.h cctools-877.5-AnV/include/mach/mach_param.h
--- cctools-877.5/include/mach/mach_param.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_param.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,73 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_param.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *	Date:	1986
+ *
+ *	Mach system sizing parameters
+ */
+
+#ifndef	_MACH_MACH_PARAM_H_
+#define _MACH_MACH_PARAM_H_
+
+/* Number of "registered" ports */
+
+#define TASK_PORT_REGISTER_MAX	3
+
+#endif	/* _MACH_MACH_PARAM_H_ */
diff -Nur cctools-877.5/include/mach/mach_port.defs cctools-877.5-AnV/include/mach/mach_port.defs
--- cctools-877.5/include/mach/mach_port.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_port.defs	2015-11-16 07:56:13 +0000
@@ -0,0 +1,614 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_port.defs
+ *	Author:	Rich Draves
+ *
+ *	Exported kernel calls.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  mach_port 3200;
+
+#if !KERNEL && !LIBSYSCALL_INTERFACE
+	UserPrefix _kernelrpc_;
+#endif
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach_debug/mach_debug_types.defs>
+
+/*
+ *	Returns the set of port and port set names
+ *	to which the target task has access, along with
+ *	the type (set or port) for each name.
+ */
+
+routine mach_port_names(
+		task		: ipc_space_t;
+	out	names		: mach_port_name_array_t;
+	out	types		: mach_port_type_array_t);
+
+/*
+ *	Returns the type (set or port) for the port name
+ *	within the target task.  Also indicates whether
+ *	there is a dead-name request for the name.
+ */
+
+routine mach_port_type(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out	ptype		: mach_port_type_t);
+
+/*
+ *	Changes the name by which a port (or port set) is known to
+ *	the target task.  The new name can't be in use.  The
+ *	old name becomes available for recycling.
+ *
+ *	This interface is OBSOLETE and will always
+ *	return KERN_NOT_SUPPORTED.
+ */
+
+routine mach_port_rename(
+		task		: ipc_space_t;
+		old_name	: mach_port_name_t;
+		new_name	: mach_port_name_t);
+
+/*
+ *	Allocates the specified kind of object, with the given name.
+ *	The right must be one of
+ *		MACH_PORT_RIGHT_RECEIVE
+ *		MACH_PORT_RIGHT_PORT_SET
+ *		MACH_PORT_RIGHT_DEAD_NAME
+ *	New port sets are empty.  New ports don't have any
+ *	send/send-once rights or queued messages.  The make-send
+ *	count is zero and their queue limit is MACH_PORT_QLIMIT_DEFAULT.
+ *	New sets, ports, and dead names have one user reference.
+ */
+
+routine mach_port_allocate_name(
+		task		: ipc_space_t;
+		right		: mach_port_right_t;
+		name		: mach_port_name_t);
+
+/*
+ *	Allocates the specified kind of object.
+ *	The right must be one of
+ *		MACH_PORT_RIGHT_RECEIVE
+ *		MACH_PORT_RIGHT_PORT_SET
+ *		MACH_PORT_RIGHT_DEAD_NAME
+ *	Like port_allocate_name, but the kernel picks a name.
+ *	It can use any name not associated with a right.
+ */
+
+routine mach_port_allocate(
+		task		: ipc_space_t;
+		right		: mach_port_right_t;
+	out	name		: mach_port_name_t);
+
+/*
+ *	Destroys all rights associated with the name and makes it
+ *	available for recycling immediately.  The name can be a
+ *	port (possibly with multiple user refs), a port set, or
+ *	a dead name (again, with multiple user refs).
+ */
+
+routine mach_port_destroy(
+		task		: ipc_space_t;
+		name		: mach_port_name_t);
+
+/*
+ *	Releases one send/send-once/dead-name user ref.
+ *	Just like mach_port_mod_refs -1, but deduces the
+ *	correct type of right.  This allows a user task
+ *	to release a ref for a port without worrying
+ *	about whether the port has died or not.
+ */
+
+routine mach_port_deallocate(
+		task		: ipc_space_t;
+		name		: mach_port_name_t);
+
+/*
+ *	A port set always has one user ref.
+ *	A send-once right always has one user ref.
+ *	A dead name always has one or more user refs.
+ *	A send right always has one or more user refs.
+ *	A receive right always has one user ref.
+ *	The right must be one of
+ *		MACH_PORT_RIGHT_RECEIVE
+ *		MACH_PORT_RIGHT_PORT_SET
+ *		MACH_PORT_RIGHT_DEAD_NAME
+ *		MACH_PORT_RIGHT_SEND
+ *		MACH_PORT_RIGHT_SEND_ONCE
+ */
+
+routine mach_port_get_refs(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		right		: mach_port_right_t;
+	out	refs		: mach_port_urefs_t);
+
+/*
+ *	The delta is a signed change to the task's
+ *	user ref count for the right.  Only dead names
+ *	and send rights can have a positive delta.
+ *	The resulting user ref count can't be negative.
+ *	If it is zero, the right is deallocated.
+ *	If the name isn't a composite right, it becomes
+ *	available for recycling.  The right must be one of
+ *		MACH_PORT_RIGHT_RECEIVE
+ *		MACH_PORT_RIGHT_PORT_SET
+ *		MACH_PORT_RIGHT_DEAD_NAME
+ *		MACH_PORT_RIGHT_SEND
+ *		MACH_PORT_RIGHT_SEND_ONCE
+ */
+
+routine mach_port_mod_refs(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		right		: mach_port_right_t;
+		delta		: mach_port_delta_t);
+
+/*
+ *	Peek at the message queue for the specified receive
+ *	right and return info about the message with the
+ *	sequence number matching the input.  If zero is
+ *	specified as the seqno, the first message in the
+ *	queue will be peeked.
+ *
+ *	Only the following trailer types are currently supported:
+ *	     MACH_RCV_TRAILER_TYPE(MACH_MSG_TRAILER_FORMAT_0)
+ *
+ *		or'ed with one of these element types:
+ *	     MACH_RCV_TRAILER_ELEMENTS(MACH_RCV_TRAILER_NULL)
+ *	     MACH_RCV_TRAILER_ELEMENTS(MACH_RCV_TRAILER_SEQNO)
+ *	     MACH_RCV_TRAILER_ELEMENTS(MACH_RCV_TRAILER_SENDER)
+ *	     MACH_RCV_TRAILER_ELEMENTS(MACH_RCV_TRAILER_AUDIT)
+ */
+routine mach_port_peek(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		trailer_type	: mach_msg_trailer_type_t;
+ inout		request_seqnop	: mach_port_seqno_t;
+ out		msg_sizep	: mach_msg_size_t;
+ out		msg_idp		: mach_msg_id_t;
+ out		trailer_infop	: mach_msg_trailer_info_t, CountInOut);		
+
+/*
+ *	Only valid for receive rights.
+ *	Sets the make-send count for the port.
+ */
+routine mach_port_set_mscount(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		mscount		: mach_port_mscount_t);
+
+/*
+ *	Only valid for port sets.  Returns a list of
+ *	the members.
+ */
+
+routine mach_port_get_set_status(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out	members		: mach_port_name_array_t);
+
+/*
+ *	Puts the member port (the task must have receive rights)
+ *	into the after port set.  If the port is already a member
+ *	of any set(s), it is atomically removed from those sets as
+ *	part of this operation.  (If after is MACH_PORT_NULL, the
+ *	port is still removed from all current sets).
+ */
+
+routine mach_port_move_member(
+		task		: ipc_space_t;
+		member		: mach_port_name_t;
+		after		: mach_port_name_t);
+
+/*
+ *	Requests a notification from the kernel.  The request
+ *	must supply the send-once right which is used for
+ *	the notification.  If a send-once right was previously
+ *	registered, it is returned.  The msgid must be one of:
+ *		MACH_NOTIFY_PORT_DESTROYED (receive rights)
+ *		MACH_NOTIFY_DEAD_NAME (send/receive/send-once rights)
+ *		MACH_NOTIFY_SEND_POSSIBLE (send/receive/send-once rights)
+ *		MACH_NOTIFY_NO_SENDERS (receive rights)
+ *
+ *	The sync value specifies whether a notification should
+ *	get sent immediately, if appropriate.  The exact meaning
+ *	depends on the notification:
+ *		MACH_NOTIFY_PORT_DESTROYED: must be zero.
+ *		MACH_NOTIFY_DEAD_NAME: if non-zero, then name can be dead,
+ *			and the notification gets sent immediately.
+ *			If zero, then name can't be dead.
+ *		MACH_NOTIFY_SEND_POSSIBLE: if non-zero, will generate a	send-
+ *			possible notification as soon as it is possible to send
+ *			to the port. If zero, will generate a send-possible
+ *			notification only after a subsequent failed send
+ *			(with MACH_SEND_NOTIFY option to mach_msg call).  Can
+ *			generate a dead-name notification if name is already dead
+ *			or becomes dead before a send-possible notification fires.
+ *		MACH_NOTIFY_NO_SENDERS: the notification gets sent
+ *			immediately if the current mscount is greater
+ *			than or equal to the sync value and there are no
+ *			extant send rights.
+ *
+ * If the name is deleted before a successfully registered notification
+ * is delivered, it is replaced with a port-deleted notification.
+ */
+
+routine mach_port_request_notification(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		msgid		: mach_msg_id_t;
+		sync		: mach_port_mscount_t;
+		notify		: mach_port_send_once_t;
+	out	previous	: mach_port_move_send_once_t);
+
+/*
+ *	Inserts the specified rights into the target task,
+ *	using the specified name.  If inserting send/receive
+ *	rights and the task already has send/receive rights
+ *	for the port, then the names must agree.  In any case,
+ *	the task gains a user ref for the port.
+ */
+
+routine mach_port_insert_right(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		poly		: mach_port_poly_t);
+
+/*
+ *	Returns the specified right for the named port
+ *	in the target task, extracting that right from
+ *	the target task.  The target task loses a user
+ *	ref and the name may be available for recycling.
+ *	msgt_name must be one of
+ *		MACH_MSG_TYPE_MOVE_RECEIVE
+ *		MACH_MSG_TYPE_COPY_SEND
+ *		MACH_MSG_TYPE_MAKE_SEND
+ *		MACH_MSG_TYPE_MOVE_SEND
+ *		MACH_MSG_TYPE_MAKE_SEND_ONCE
+ *		MACH_MSG_TYPE_MOVE_SEND_ONCE
+ */
+
+routine mach_port_extract_right(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		msgt_name	: mach_msg_type_name_t;
+	out	poly		: mach_port_poly_t);
+
+/*
+ *	Only valid for receive rights.
+ *	Sets the sequence number for the port.
+ */
+
+routine mach_port_set_seqno(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		seqno		: mach_port_seqno_t);
+
+/*
+ *      Returns information about a port.
+ */
+
+routine mach_port_get_attributes(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		flavor		: mach_port_flavor_t;
+	out	port_info_out	: mach_port_info_t, CountInOut);
+
+/*
+ *      Set attributes of a port
+ */
+
+routine mach_port_set_attributes(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		flavor		: mach_port_flavor_t;
+		port_info	: mach_port_info_t);
+
+
+/*
+ *	Allocates the specified kind of object, qos version.
+ *	The right must be
+ *		MACH_PORT_RIGHT_RECEIVE
+ *	Like port_allocate_name, but the kernel picks a name.
+ *	It can use any name not associated with a right.
+ */
+
+routine mach_port_allocate_qos(
+		task		: ipc_space_t;
+		right		: mach_port_right_t;
+	inout	qos		: mach_port_qos_t;
+	out	name		: mach_port_name_t);
+
+
+/*
+ *	Generic interface to allocation various kinds of ports.
+ *	Should never be called directly by users (at least not
+ *	unless they are exceedingly masochistic).
+ */
+
+routine mach_port_allocate_full(
+		task		: ipc_space_t;
+		right		: mach_port_right_t;
+		proto		: mach_port_t;
+	inout	qos		: mach_port_qos_t;
+	inout	name		: mach_port_name_t);
+
+
+/*
+ *	Pre-expand task port name space.
+ */
+routine task_set_port_space(
+		task		: ipc_space_t;
+		table_entries	: int);
+
+
+/*
+ *	Returns the exact number of extant send rights
+ *	for the given receive right.
+ *      This call is only valid on MACH_IPC_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ */
+routine	mach_port_get_srights(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out	srights		: mach_port_rights_t);
+
+
+/*
+ *	Returns information about an IPC space.
+ *      This call is only valid on MACH_IPC_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ */
+routine mach_port_space_info(
+		task		: ipc_space_t;
+	out	space_info	: ipc_info_space_t;
+	out	table_info	: ipc_info_name_array_t;
+	out	tree_info	: ipc_info_tree_name_array_t);
+
+/*
+ *	Returns information about the dead-name requests
+ *	registered with the named receive right.
+ *      This call is only valid on MACH_IPC_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ */
+routine mach_port_dnrequest_info(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out	dnr_total	: unsigned;	/* total size of table */
+	out	dnr_used	: unsigned);	/* amount used */
+
+/*
+ *	Return the type and address of the kernel object
+ *	that the given send/receive right represents.
+ *      This call is only valid on MACH_IPC_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ *
+ *	This interface is DEPRECATED in favor of the new
+ *	mach_port_kernel_object64() call (see below).
+ */
+routine	mach_port_kernel_object(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out	object_type	: unsigned;
+	out	object_addr	: unsigned);
+
+
+/*
+ *	Inserts the specified rights into the portset identified
+ *	by the <task, pset> pair.  The results of passing in the
+ *	Poly argument via the supplied disposition must yield a
+ *	receive right.
+ *
+ *	If the <task,pset> pair does not represent a valid portset
+ *	KERN_INVALID_RIGHT is returned.
+ *	
+ *	If the passed in name argument does not represent a receive
+ *	right, KERN_INVALID_CAPABILITY will be returned.
+ *
+ *	If the port represented by the receive right is already in
+ *	the portset, KERN_ALREADY_IN_SET is returned.
+ */
+routine mach_port_insert_member(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		pset		: mach_port_name_t);
+
+/*
+ *	Extracts the specified right from the named portset
+ *	in the target task.  
+ *	the target task.  The target task loses a user
+ *	ref and the name may be available for recycling.
+ *	msgt_name must be one of
+ *		MACH_MSG_TYPE_MOVE_RECEIVE
+ *		MACH_MSG_TYPE_COPY_SEND
+ *		MACH_MSG_TYPE_MAKE_SEND
+ *		MACH_MSG_TYPE_MOVE_SEND
+ *		MACH_MSG_TYPE_MAKE_SEND_ONCE
+ *		MACH_MSG_TYPE_MOVE_SEND_ONCE
+ */
+
+routine mach_port_extract_member(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		pset		: mach_port_name_t);
+
+/*
+ * Only valid for receive rights.
+ * Gets the context pointer for the port.
+ */
+
+routine mach_port_get_context(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+#ifdef LIBSYSCALL_INTERFACE
+	out context		: mach_port_context_t
+#else
+	out context		: mach_vm_address_t
+#endif
+	);
+
+/*
+ * Only valid for receive rights.
+ * Sets the context pointer for the port.
+ */
+
+routine mach_port_set_context(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+#ifdef LIBSYSCALL_INTERFACE
+		context		: mach_port_context_t
+#else
+		context		: mach_vm_address_t
+#endif
+		);
+
+/*
+ *	Return the type and address of the kernel object
+ *	that the given send/receive right represents.
+ *      This call is only valid on MACH_IPC_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ */
+routine	mach_port_kobject(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out	object_type	: natural_t;
+	out	object_addr	: mach_vm_address_t);
+
+
+/*
+ *	Constructs a right based on the options passed
+ *	in. Also allows guarding the port as one of the
+ *	options if the requested right is a receive
+ *	right.
+ */
+routine mach_port_construct(
+		task		: ipc_space_t;
+		options		: mach_port_options_ptr_t;
+#ifdef LIBSYSCALL_INTERFACE
+		context		: mach_port_context_t;
+#else
+		context		: uint64_t;
+#endif
+	out	name		: mach_port_name_t);
+
+/*
+ *	Destroys a mach port using the guard provided
+ *	for guarded ports. Also reduces the user ref
+ *	count for send rights as specified by srdelta.
+ */
+routine mach_port_destruct(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		srdelta		: mach_port_delta_t;
+#ifdef LIBSYSCALL_INTERFACE
+		guard		: mach_port_context_t
+#else
+		guard		: uint64_t
+#endif		
+		);
+
+/*
+ *	Guard an already existing port. Allows guarding
+ *	receive rights only. Uses the context field in the
+ *	port structure to store the guard.
+ */
+routine mach_port_guard(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+#ifdef LIBSYSCALL_INTERFACE
+		guard		: mach_port_context_t;
+#else
+		guard		: uint64_t;
+#endif	
+		strict		: boolean_t);
+
+/*
+ *	Unguard a port guarded previously. For unguarded ports
+ *	or incorrect guards passed in it raises an exception
+ *	indicating guarding misbehavior.
+ */
+routine mach_port_unguard(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+#ifdef LIBSYSCALL_INTERFACE
+		guard		: mach_port_context_t
+#else
+		guard		: uint64_t
+#endif	
+		);
+
+/*
+ *	Returns basic information about an IPC space.
+ *      This call is only valid on MACH_IPC_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ */
+routine mach_port_space_basic_info(
+		task		: ipc_space_t;
+	out	basic_info	: ipc_info_space_basic_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/mach_port.h cctools-877.5-AnV/include/mach/mach_port.h
--- cctools-877.5/include/mach/mach_port.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_port.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,1648 @@
+#ifndef	_mach_port_user_
+#define	_mach_port_user_
+
+/* Module mach_port */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	mach_port_MSG_COUNT
+#define	mach_port_MSG_COUNT	36
+#endif	/* mach_port_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine mach_port_names */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_names
+(
+	ipc_space_t task,
+	mach_port_name_array_t *names,
+	mach_msg_type_number_t *namesCnt,
+	mach_port_type_array_t *types,
+	mach_msg_type_number_t *typesCnt
+);
+
+/* Routine mach_port_type */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_type
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_type_t *ptype
+);
+
+/* Routine mach_port_rename */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_rename
+(
+	ipc_space_t task,
+	mach_port_name_t old_name,
+	mach_port_name_t new_name
+);
+
+/* Routine mach_port_allocate_name */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_allocate_name
+(
+	ipc_space_t task,
+	mach_port_right_t right,
+	mach_port_name_t name
+);
+
+/* Routine mach_port_allocate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_allocate
+(
+	ipc_space_t task,
+	mach_port_right_t right,
+	mach_port_name_t *name
+);
+
+/* Routine mach_port_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_destroy
+(
+	ipc_space_t task,
+	mach_port_name_t name
+);
+
+/* Routine mach_port_deallocate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_deallocate
+(
+	ipc_space_t task,
+	mach_port_name_t name
+);
+
+/* Routine mach_port_get_refs */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_get_refs
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_right_t right,
+	mach_port_urefs_t *refs
+);
+
+/* Routine mach_port_mod_refs */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_mod_refs
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_right_t right,
+	mach_port_delta_t delta
+);
+
+/* Routine mach_port_peek */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_peek
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_msg_trailer_type_t trailer_type,
+	mach_port_seqno_t *request_seqnop,
+	mach_msg_size_t *msg_sizep,
+	mach_msg_id_t *msg_idp,
+	mach_msg_trailer_info_t trailer_infop,
+	mach_msg_type_number_t *trailer_infopCnt
+);
+
+/* Routine mach_port_set_mscount */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_set_mscount
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_mscount_t mscount
+);
+
+/* Routine mach_port_get_set_status */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_get_set_status
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_name_array_t *members,
+	mach_msg_type_number_t *membersCnt
+);
+
+/* Routine mach_port_move_member */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_move_member
+(
+	ipc_space_t task,
+	mach_port_name_t member,
+	mach_port_name_t after
+);
+
+/* Routine mach_port_request_notification */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_request_notification
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_msg_id_t msgid,
+	mach_port_mscount_t sync,
+	mach_port_t notify,
+	mach_msg_type_name_t notifyPoly,
+	mach_port_t *previous
+);
+
+/* Routine mach_port_insert_right */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_insert_right
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_t poly,
+	mach_msg_type_name_t polyPoly
+);
+
+/* Routine mach_port_extract_right */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_extract_right
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_msg_type_name_t msgt_name,
+	mach_port_t *poly,
+	mach_msg_type_name_t *polyPoly
+);
+
+/* Routine mach_port_set_seqno */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_set_seqno
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_seqno_t seqno
+);
+
+/* Routine mach_port_get_attributes */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_get_attributes
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_flavor_t flavor,
+	mach_port_info_t port_info_out,
+	mach_msg_type_number_t *port_info_outCnt
+);
+
+/* Routine mach_port_set_attributes */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_set_attributes
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_flavor_t flavor,
+	mach_port_info_t port_info,
+	mach_msg_type_number_t port_infoCnt
+);
+
+/* Routine mach_port_allocate_qos */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_allocate_qos
+(
+	ipc_space_t task,
+	mach_port_right_t right,
+	mach_port_qos_t *qos,
+	mach_port_name_t *name
+);
+
+/* Routine mach_port_allocate_full */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_allocate_full
+(
+	ipc_space_t task,
+	mach_port_right_t right,
+	mach_port_t proto,
+	mach_port_qos_t *qos,
+	mach_port_name_t *name
+);
+
+/* Routine task_set_port_space */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_port_space
+(
+	ipc_space_t task,
+	int table_entries
+);
+
+/* Routine mach_port_get_srights */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_get_srights
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_rights_t *srights
+);
+
+/* Routine mach_port_space_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_space_info
+(
+	ipc_space_t task,
+	ipc_info_space_t *space_info,
+	ipc_info_name_array_t *table_info,
+	mach_msg_type_number_t *table_infoCnt,
+	ipc_info_tree_name_array_t *tree_info,
+	mach_msg_type_number_t *tree_infoCnt
+);
+
+/* Routine mach_port_dnrequest_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_dnrequest_info
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	unsigned *dnr_total,
+	unsigned *dnr_used
+);
+
+/* Routine mach_port_kernel_object */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_kernel_object
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	unsigned *object_type,
+	unsigned *object_addr
+);
+
+/* Routine mach_port_insert_member */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_insert_member
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_name_t pset
+);
+
+/* Routine mach_port_extract_member */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_extract_member
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_name_t pset
+);
+
+/* Routine mach_port_get_context */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_get_context
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_context_t *context
+);
+
+/* Routine mach_port_set_context */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_set_context
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_context_t context
+);
+
+/* Routine mach_port_kobject */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_kobject
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	natural_t *object_type,
+	mach_vm_address_t *object_addr
+);
+
+/* Routine mach_port_construct */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_construct
+(
+	ipc_space_t task,
+	mach_port_options_ptr_t options,
+	mach_port_context_t context,
+	mach_port_name_t *name
+);
+
+/* Routine mach_port_destruct */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_destruct
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_delta_t srdelta,
+	mach_port_context_t guard
+);
+
+/* Routine mach_port_guard */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_guard
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_context_t guard,
+	boolean_t strict
+);
+
+/* Routine mach_port_unguard */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_unguard
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_context_t guard
+);
+
+/* Routine mach_port_space_basic_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_space_basic_info
+(
+	ipc_space_t task,
+	ipc_info_space_basic_t *basic_info
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__mach_port_subsystem__defined
+#define __Request__mach_port_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__mach_port_names_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_type_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t old_name;
+		mach_port_name_t new_name;
+	} __Request__mach_port_rename_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_right_t right;
+		mach_port_name_t name;
+	} __Request__mach_port_allocate_name_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_right_t right;
+	} __Request__mach_port_allocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_deallocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_right_t right;
+	} __Request__mach_port_get_refs_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_right_t right;
+		mach_port_delta_t delta;
+	} __Request__mach_port_mod_refs_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_msg_trailer_type_t trailer_type;
+		mach_port_seqno_t request_seqnop;
+		mach_msg_type_number_t trailer_infopCnt;
+	} __Request__mach_port_peek_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_mscount_t mscount;
+	} __Request__mach_port_set_mscount_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_get_set_status_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t member;
+		mach_port_name_t after;
+	} __Request__mach_port_move_member_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t notify;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_msg_id_t msgid;
+		mach_port_mscount_t sync;
+	} __Request__mach_port_request_notification_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t poly;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_insert_right_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_msg_type_name_t msgt_name;
+	} __Request__mach_port_extract_right_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_seqno_t seqno;
+	} __Request__mach_port_set_seqno_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_flavor_t flavor;
+		mach_msg_type_number_t port_info_outCnt;
+	} __Request__mach_port_get_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_flavor_t flavor;
+		mach_msg_type_number_t port_infoCnt;
+		integer_t port_info[17];
+	} __Request__mach_port_set_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_right_t right;
+		mach_port_qos_t qos;
+	} __Request__mach_port_allocate_qos_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t proto;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_port_right_t right;
+		mach_port_qos_t qos;
+		mach_port_name_t name;
+	} __Request__mach_port_allocate_full_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int table_entries;
+	} __Request__task_set_port_space_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_get_srights_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__mach_port_space_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_dnrequest_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_kernel_object_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_name_t pset;
+	} __Request__mach_port_insert_member_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_name_t pset;
+	} __Request__mach_port_extract_member_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_get_context_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_context_t context;
+	} __Request__mach_port_set_context_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_kobject_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t options;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_port_context_t context;
+	} __Request__mach_port_construct_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_delta_t srdelta;
+		mach_port_context_t guard;
+	} __Request__mach_port_destruct_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_context_t guard;
+		boolean_t strict;
+	} __Request__mach_port_guard_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_context_t guard;
+	} __Request__mach_port_unguard_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__mach_port_space_basic_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__mach_port_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__mach_port_subsystem__defined
+#define __RequestUnion__mach_port_subsystem__defined
+union __RequestUnion__mach_port_subsystem {
+	__Request__mach_port_names_t Request_mach_port_names;
+	__Request__mach_port_type_t Request_mach_port_type;
+	__Request__mach_port_rename_t Request_mach_port_rename;
+	__Request__mach_port_allocate_name_t Request_mach_port_allocate_name;
+	__Request__mach_port_allocate_t Request_mach_port_allocate;
+	__Request__mach_port_destroy_t Request_mach_port_destroy;
+	__Request__mach_port_deallocate_t Request_mach_port_deallocate;
+	__Request__mach_port_get_refs_t Request_mach_port_get_refs;
+	__Request__mach_port_mod_refs_t Request_mach_port_mod_refs;
+	__Request__mach_port_peek_t Request_mach_port_peek;
+	__Request__mach_port_set_mscount_t Request_mach_port_set_mscount;
+	__Request__mach_port_get_set_status_t Request_mach_port_get_set_status;
+	__Request__mach_port_move_member_t Request_mach_port_move_member;
+	__Request__mach_port_request_notification_t Request_mach_port_request_notification;
+	__Request__mach_port_insert_right_t Request_mach_port_insert_right;
+	__Request__mach_port_extract_right_t Request_mach_port_extract_right;
+	__Request__mach_port_set_seqno_t Request_mach_port_set_seqno;
+	__Request__mach_port_get_attributes_t Request_mach_port_get_attributes;
+	__Request__mach_port_set_attributes_t Request_mach_port_set_attributes;
+	__Request__mach_port_allocate_qos_t Request_mach_port_allocate_qos;
+	__Request__mach_port_allocate_full_t Request_mach_port_allocate_full;
+	__Request__task_set_port_space_t Request_task_set_port_space;
+	__Request__mach_port_get_srights_t Request_mach_port_get_srights;
+	__Request__mach_port_space_info_t Request_mach_port_space_info;
+	__Request__mach_port_dnrequest_info_t Request_mach_port_dnrequest_info;
+	__Request__mach_port_kernel_object_t Request_mach_port_kernel_object;
+	__Request__mach_port_insert_member_t Request_mach_port_insert_member;
+	__Request__mach_port_extract_member_t Request_mach_port_extract_member;
+	__Request__mach_port_get_context_t Request_mach_port_get_context;
+	__Request__mach_port_set_context_t Request_mach_port_set_context;
+	__Request__mach_port_kobject_t Request_mach_port_kobject;
+	__Request__mach_port_construct_t Request_mach_port_construct;
+	__Request__mach_port_destruct_t Request_mach_port_destruct;
+	__Request__mach_port_guard_t Request_mach_port_guard;
+	__Request__mach_port_unguard_t Request_mach_port_unguard;
+	__Request__mach_port_space_basic_info_t Request_mach_port_space_basic_info;
+};
+#endif /* !__RequestUnion__mach_port_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__mach_port_subsystem__defined
+#define __Reply__mach_port_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t names;
+		mach_msg_ool_descriptor_t types;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t namesCnt;
+		mach_msg_type_number_t typesCnt;
+	} __Reply__mach_port_names_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_type_t ptype;
+	} __Reply__mach_port_type_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_rename_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_allocate_name_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_name_t name;
+	} __Reply__mach_port_allocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_deallocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_urefs_t refs;
+	} __Reply__mach_port_get_refs_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_mod_refs_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_seqno_t request_seqnop;
+		mach_msg_size_t msg_sizep;
+		mach_msg_id_t msg_idp;
+		mach_msg_type_number_t trailer_infopCnt;
+		char trailer_infop[68];
+	} __Reply__mach_port_peek_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_set_mscount_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t members;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t membersCnt;
+	} __Reply__mach_port_get_set_status_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_move_member_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t previous;
+		/* end of the kernel processed data */
+	} __Reply__mach_port_request_notification_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_insert_right_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t poly;
+		/* end of the kernel processed data */
+	} __Reply__mach_port_extract_right_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_set_seqno_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t port_info_outCnt;
+		integer_t port_info_out[17];
+	} __Reply__mach_port_get_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_set_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_qos_t qos;
+		mach_port_name_t name;
+	} __Reply__mach_port_allocate_qos_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_qos_t qos;
+		mach_port_name_t name;
+	} __Reply__mach_port_allocate_full_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_port_space_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_rights_t srights;
+	} __Reply__mach_port_get_srights_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t table_info;
+		mach_msg_ool_descriptor_t tree_info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		ipc_info_space_t space_info;
+		mach_msg_type_number_t table_infoCnt;
+		mach_msg_type_number_t tree_infoCnt;
+	} __Reply__mach_port_space_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		unsigned dnr_total;
+		unsigned dnr_used;
+	} __Reply__mach_port_dnrequest_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		unsigned object_type;
+		unsigned object_addr;
+	} __Reply__mach_port_kernel_object_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_insert_member_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_extract_member_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_context_t context;
+	} __Reply__mach_port_get_context_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_set_context_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		natural_t object_type;
+		mach_vm_address_t object_addr;
+	} __Reply__mach_port_kobject_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_name_t name;
+	} __Reply__mach_port_construct_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_destruct_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_guard_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_unguard_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		ipc_info_space_basic_t basic_info;
+	} __Reply__mach_port_space_basic_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__mach_port_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__mach_port_subsystem__defined
+#define __ReplyUnion__mach_port_subsystem__defined
+union __ReplyUnion__mach_port_subsystem {
+	__Reply__mach_port_names_t Reply_mach_port_names;
+	__Reply__mach_port_type_t Reply_mach_port_type;
+	__Reply__mach_port_rename_t Reply_mach_port_rename;
+	__Reply__mach_port_allocate_name_t Reply_mach_port_allocate_name;
+	__Reply__mach_port_allocate_t Reply_mach_port_allocate;
+	__Reply__mach_port_destroy_t Reply_mach_port_destroy;
+	__Reply__mach_port_deallocate_t Reply_mach_port_deallocate;
+	__Reply__mach_port_get_refs_t Reply_mach_port_get_refs;
+	__Reply__mach_port_mod_refs_t Reply_mach_port_mod_refs;
+	__Reply__mach_port_peek_t Reply_mach_port_peek;
+	__Reply__mach_port_set_mscount_t Reply_mach_port_set_mscount;
+	__Reply__mach_port_get_set_status_t Reply_mach_port_get_set_status;
+	__Reply__mach_port_move_member_t Reply_mach_port_move_member;
+	__Reply__mach_port_request_notification_t Reply_mach_port_request_notification;
+	__Reply__mach_port_insert_right_t Reply_mach_port_insert_right;
+	__Reply__mach_port_extract_right_t Reply_mach_port_extract_right;
+	__Reply__mach_port_set_seqno_t Reply_mach_port_set_seqno;
+	__Reply__mach_port_get_attributes_t Reply_mach_port_get_attributes;
+	__Reply__mach_port_set_attributes_t Reply_mach_port_set_attributes;
+	__Reply__mach_port_allocate_qos_t Reply_mach_port_allocate_qos;
+	__Reply__mach_port_allocate_full_t Reply_mach_port_allocate_full;
+	__Reply__task_set_port_space_t Reply_task_set_port_space;
+	__Reply__mach_port_get_srights_t Reply_mach_port_get_srights;
+	__Reply__mach_port_space_info_t Reply_mach_port_space_info;
+	__Reply__mach_port_dnrequest_info_t Reply_mach_port_dnrequest_info;
+	__Reply__mach_port_kernel_object_t Reply_mach_port_kernel_object;
+	__Reply__mach_port_insert_member_t Reply_mach_port_insert_member;
+	__Reply__mach_port_extract_member_t Reply_mach_port_extract_member;
+	__Reply__mach_port_get_context_t Reply_mach_port_get_context;
+	__Reply__mach_port_set_context_t Reply_mach_port_set_context;
+	__Reply__mach_port_kobject_t Reply_mach_port_kobject;
+	__Reply__mach_port_construct_t Reply_mach_port_construct;
+	__Reply__mach_port_destruct_t Reply_mach_port_destruct;
+	__Reply__mach_port_guard_t Reply_mach_port_guard;
+	__Reply__mach_port_unguard_t Reply_mach_port_unguard;
+	__Reply__mach_port_space_basic_info_t Reply_mach_port_space_basic_info;
+};
+#endif /* !__RequestUnion__mach_port_subsystem__defined */
+
+#ifndef subsystem_to_name_map_mach_port
+#define subsystem_to_name_map_mach_port \
+    { "mach_port_names", 3200 },\
+    { "mach_port_type", 3201 },\
+    { "mach_port_rename", 3202 },\
+    { "mach_port_allocate_name", 3203 },\
+    { "mach_port_allocate", 3204 },\
+    { "mach_port_destroy", 3205 },\
+    { "mach_port_deallocate", 3206 },\
+    { "mach_port_get_refs", 3207 },\
+    { "mach_port_mod_refs", 3208 },\
+    { "mach_port_peek", 3209 },\
+    { "mach_port_set_mscount", 3210 },\
+    { "mach_port_get_set_status", 3211 },\
+    { "mach_port_move_member", 3212 },\
+    { "mach_port_request_notification", 3213 },\
+    { "mach_port_insert_right", 3214 },\
+    { "mach_port_extract_right", 3215 },\
+    { "mach_port_set_seqno", 3216 },\
+    { "mach_port_get_attributes", 3217 },\
+    { "mach_port_set_attributes", 3218 },\
+    { "mach_port_allocate_qos", 3219 },\
+    { "mach_port_allocate_full", 3220 },\
+    { "task_set_port_space", 3221 },\
+    { "mach_port_get_srights", 3222 },\
+    { "mach_port_space_info", 3223 },\
+    { "mach_port_dnrequest_info", 3224 },\
+    { "mach_port_kernel_object", 3225 },\
+    { "mach_port_insert_member", 3226 },\
+    { "mach_port_extract_member", 3227 },\
+    { "mach_port_get_context", 3228 },\
+    { "mach_port_set_context", 3229 },\
+    { "mach_port_kobject", 3230 },\
+    { "mach_port_construct", 3231 },\
+    { "mach_port_destruct", 3232 },\
+    { "mach_port_guard", 3233 },\
+    { "mach_port_unguard", 3234 },\
+    { "mach_port_space_basic_info", 3235 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _mach_port_user_ */
diff -Nur cctools-877.5/include/mach/mach_syscalls.h cctools-877.5-AnV/include/mach/mach_syscalls.h
--- cctools-877.5/include/mach/mach_syscalls.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_syscalls.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef _MACH_MACH_SYSCALLS_H_
+#define	_MACH_MACH_SYSCALLS_H_
+
+#include <mach/mach_traps.h>
+
+#endif	/* _MACH_MACH_SYSCALLS_H_ */
diff -Nur cctools-877.5/include/mach/mach_time.h cctools-877.5-AnV/include/mach/mach_time.h
--- cctools-877.5/include/mach/mach_time.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_time.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,57 @@
+/*
+ * Copyright (c) 2001-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef	_MACH_MACH_TIME_H_
+#define	_MACH_MACH_TIME_H_
+
+#include <mach/mach_types.h>
+
+#include <sys/cdefs.h>
+
+struct mach_timebase_info {
+	uint32_t	numer;
+	uint32_t	denom;
+};
+
+typedef struct mach_timebase_info	*mach_timebase_info_t;
+typedef struct mach_timebase_info	mach_timebase_info_data_t;
+
+__BEGIN_DECLS
+
+kern_return_t		mach_timebase_info(
+						mach_timebase_info_t	info);
+
+kern_return_t		mach_wait_until(
+						uint64_t		deadline);
+
+
+uint64_t			mach_absolute_time(void);
+uint64_t			mach_approximate_time(void);
+__END_DECLS
+
+#endif /* _MACH_MACH_TIME_H_ */
diff -Nur cctools-877.5/include/mach/mach_traps.h cctools-877.5-AnV/include/mach/mach_traps.h
--- cctools-877.5/include/mach/mach_traps.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_traps.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,252 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	Definitions of general Mach system traps.
+ *
+ *	These are the definitions as seen from user-space.
+ *	The kernel definitions are in <mach/syscall_sw.h>.
+ *	Kernel RPC functions are defined in <mach/mach_interface.h>.
+ */
+
+#ifndef	_MACH_MACH_TRAPS_H_
+#define _MACH_MACH_TRAPS_H_
+
+#include <stdint.h>
+
+#include <mach/std_types.h>
+#include <mach/mach_types.h>
+#include <mach/kern_return.h>
+#include <mach/port.h>
+#include <mach/vm_types.h>
+#include <mach/clock_types.h>
+
+#include <machine/endian.h>
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+
+
+
+extern kern_return_t clock_sleep_trap(
+				mach_port_name_t clock_name,
+				sleep_type_t sleep_type,
+				int sleep_sec,
+				int sleep_nsec,
+				mach_timespec_t	*wakeup_time);
+
+extern kern_return_t _kernelrpc_mach_vm_allocate_trap(
+				mach_port_name_t target,
+				mach_vm_offset_t *addr,
+				mach_vm_size_t size,
+				int flags);
+
+extern kern_return_t _kernelrpc_mach_vm_deallocate_trap(
+				mach_port_name_t target,
+				mach_vm_address_t address,
+				mach_vm_size_t size
+);
+
+extern kern_return_t _kernelrpc_mach_vm_protect_trap(
+				mach_port_name_t target,
+				mach_vm_address_t address,
+				mach_vm_size_t size,
+				boolean_t set_maximum,
+				vm_prot_t new_protection
+);
+
+extern kern_return_t _kernelrpc_mach_vm_map_trap(
+				mach_port_name_t target,
+				mach_vm_offset_t *address,
+				mach_vm_size_t size,
+				mach_vm_offset_t mask,
+				int flags,
+				vm_prot_t cur_protection
+);
+
+extern kern_return_t _kernelrpc_mach_port_allocate_trap(
+				mach_port_name_t target,
+				mach_port_right_t right,
+				mach_port_name_t *name
+);
+
+
+extern kern_return_t _kernelrpc_mach_port_destroy_trap(
+				mach_port_name_t target,
+				mach_port_name_t name
+);
+
+extern kern_return_t _kernelrpc_mach_port_deallocate_trap(
+				mach_port_name_t target,
+				mach_port_name_t name
+);
+
+extern kern_return_t _kernelrpc_mach_port_mod_refs_trap(
+				mach_port_name_t target,
+				mach_port_name_t name,
+				mach_port_right_t right,
+				mach_port_delta_t delta
+);
+
+extern kern_return_t _kernelrpc_mach_port_move_member_trap(
+				mach_port_name_t target,
+				mach_port_name_t member,
+				mach_port_name_t after
+);
+
+extern kern_return_t _kernelrpc_mach_port_insert_right_trap(
+				mach_port_name_t target,
+				mach_port_name_t name,
+				mach_port_name_t poly,
+				mach_msg_type_name_t polyPoly
+);
+
+extern kern_return_t _kernelrpc_mach_port_insert_member_trap(
+				mach_port_name_t target,
+				mach_port_name_t name,
+				mach_port_name_t pset
+);
+
+extern kern_return_t _kernelrpc_mach_port_extract_member_trap(
+				mach_port_name_t target,
+				mach_port_name_t name,
+				mach_port_name_t pset
+);
+
+extern kern_return_t _kernelrpc_mach_port_construct_trap(
+				mach_port_name_t target,
+				mach_port_options_t *options,
+				uint64_t context,
+				mach_port_name_t *name
+);
+
+extern kern_return_t _kernelrpc_mach_port_destruct_trap(
+				mach_port_name_t target,
+				mach_port_name_t name,
+				mach_port_delta_t srdelta,
+				uint64_t guard
+);
+
+extern kern_return_t _kernelrpc_mach_port_guard_trap(
+				mach_port_name_t target,
+				mach_port_name_t name,
+				uint64_t guard,
+				boolean_t strict
+);
+
+extern kern_return_t _kernelrpc_mach_port_unguard_trap(
+				mach_port_name_t target,
+				mach_port_name_t name,
+				uint64_t guard
+);
+
+extern kern_return_t macx_swapon(
+				uint64_t filename,
+				int flags,
+				int size,
+				int priority);
+
+extern kern_return_t macx_swapoff(
+				uint64_t filename,
+				int flags);
+
+extern kern_return_t macx_triggers(
+				int hi_water,
+				int low_water,
+				int flags,
+				mach_port_t alert_port);
+
+extern kern_return_t macx_backing_store_suspend(
+				boolean_t suspend);
+
+extern kern_return_t macx_backing_store_recovery(
+				int pid);
+
+extern boolean_t swtch_pri(int pri);
+
+extern boolean_t swtch(void);
+
+extern kern_return_t thread_switch(
+				mach_port_name_t thread_name,
+				int option,
+				mach_msg_timeout_t option_time);
+
+extern mach_port_name_t task_self_trap(void);
+
+/*
+ *	Obsolete interfaces.
+ */
+
+extern kern_return_t task_for_pid(
+				mach_port_name_t target_tport,
+				int pid,
+				mach_port_name_t *t);
+
+extern kern_return_t task_name_for_pid(
+				mach_port_name_t target_tport,
+				int pid,
+				mach_port_name_t *tn);
+
+extern kern_return_t pid_for_task(
+				mach_port_name_t t,
+				int *x);
+
+
+__END_DECLS
+
+#endif	/* _MACH_MACH_TRAPS_H_ */
diff -Nur cctools-877.5/include/mach/mach_types.defs cctools-877.5-AnV/include/mach/mach_types.defs
--- cctools-877.5/include/mach/mach_types.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_types.defs	2015-11-16 07:56:13 +0000
@@ -0,0 +1,557 @@
+/*
+ * Copyright (c) 2000-2010 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ * NOTICE: This file was modified by McAfee Research in 2004 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+/*
+ */
+/*
+ *	Mach kernel interface type declarations
+ */
+
+#ifndef	_MACH_MACH_TYPES_DEFS_
+#define _MACH_MACH_TYPES_DEFS_
+
+
+#include <mach/std_types.defs>
+
+type memory_object_offset_t 	= uint64_t;
+type memory_object_size_t 	= uint64_t;
+type memory_object_cluster_size_t = uint32_t;
+type memory_object_fault_info_t = array[16] of integer_t;
+
+
+type mach_port_status_t = struct[10] of integer_t;	/* obsolete */
+type mach_port_info_ext_t = struct[17] of integer_t;
+
+		/* mach_port_info_t: can hold either a
+		 * mach_port_status_t (9 ints) or a
+		 * mach_port_limits_t (1 int) or a 
+		 * mach_port_info_ext_t (17 ints). If new flavors of
+		 * mach_port_{get,set}_attributes are added, the size of
+		 * this array may have to be increased. (See mach/port.h)
+		 */
+type mach_port_flavor_t 	= int;
+type mach_port_info_t		= array[*:17] of integer_t;
+
+     		/*
+		 * mach_msg_max_trailer_t: can hold
+		 * mach_msg_trailer_type_t (1 int)
+		 * mach_msg_trailer_size_t (1 int)
+		 * mach_port_seqno_t (1 int)
+		 * security_token_t (2 ints)
+		 * audit_token_t (8 ints)
+		 * mach_port_context_t (2 ints)
+		 * msgh_ad (1 int)
+		 * msg_labels_t (1 int)
+		 */
+type mach_msg_trailer_type_t = int;
+type mach_msg_trailer_info_t	= array[*:68] of char;
+
+type task_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: task_t convert_port_to_task(mach_port_t)
+		outtran: mach_port_t convert_task_to_port(task_t)
+		destructor: task_deallocate(task_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type task_name_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: task_name_t convert_port_to_task_name(mach_port_t)
+		outtran: mach_port_t convert_task_name_to_port(task_name_t)
+		destructor: task_name_deallocate(task_name_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type thread_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: thread_t convert_port_to_thread(mach_port_t)
+		outtran: mach_port_t convert_thread_to_port(thread_t)
+		destructor: thread_deallocate(thread_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type thread_act_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: thread_act_t convert_port_to_thread(mach_port_t)
+		outtran: mach_port_t convert_thread_to_port(thread_act_t)
+		destructor: thread_deallocate(thread_act_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type thread_act_consume_ref_t = mach_port_move_send_t
+		cusertype: thread_act_t
+#if	KERNEL_SERVER
+		intran: thread_act_t convert_port_to_thread(mach_port_t)
+		destructor: thread_deallocate(thread_act_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+		/* thread_state_t: This inline array can hold
+		 * a machine-dependent amount of data, defined in
+		 * mach/machine/???? (currently THREAD_STATE_MAX,
+		 * in mach/thread_state.h)
+		 */
+#include <mach/machine/thread_state.h>
+type thread_state_flavor_t	= int;
+type thread_state_t		= array[*:THREAD_STATE_MAX] of natural_t;
+
+type task_array_t = ^array[] of task_t;
+type thread_array_t = ^array[] of thread_t;
+type thread_act_array_t = ^array[] of thread_act_t;
+type act_params_t = array[6] of int;
+
+type vm_map_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: vm_map_t convert_port_to_map(mach_port_t)
+		destructor: vm_map_deallocate(vm_map_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type vm_task_entry_t = mach_port_t
+		cusertype: vm_map_t
+#if	KERNEL_SERVER
+		intran: vm_map_t convert_port_entry_to_map(mach_port_t)
+		destructor: vm_map_deallocate(vm_map_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type ipc_space_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: ipc_space_t convert_port_to_space(mach_port_t)
+		destructor: space_deallocate(ipc_space_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type vm_prot_t = int;
+type vm_inherit_t = int;
+type vm_purgable_t = int;
+type xxx_vm_statistics_data_t = struct[13] of integer_t;
+type vm_behavior_t = int;
+type vm_statistics_data_t = struct[15] of integer_t;
+type vm_machine_attribute_t = int;
+type vm_machine_attribute_val_t = int;
+type vm_sync_t = int;
+
+		/* thread_info_t: this inline array can hold any of:
+		 * thread_basic_info_t (10 ints)
+		 * policy_timeshare_info_t (5 ints)
+		 * policy_fifo_info_t (4 ints)
+		 * policy_rr_info_t (5 ints)
+		 * if other thread_info flavors are added, this
+		 * definition may need to be changed. (See
+		 * mach/thread_info.h and mach/policy.h) */
+type thread_flavor_t		= int;
+type thread_info_t		= array[*:12] of integer_t;
+
+type thread_policy_flavor_t	= natural_t;
+type thread_policy_t		= array[*:16] of integer_t;
+
+		/* task_info_t: this inline array can hold any of:
+		 * task_basic_info_32_t (8 ints)
+		 * task_basic_info_64_t (10 ints)
+		 * task_events_info_t (8 ints)
+		 * task_thread_times_info_t (4 ints)
+		 * policy_timeshare_info_t (5 ints)
+		 * policy_fifo_info_t (4 ints)
+		 * policy_rr_info_t (5 ints)
+		 * task security token (2 ints)
+		 * task audit token (8 ints)
+		 * dyld info (2 64-bit ints and 1 int)
+		 * task_extmod_info_t (8 64-bit ints)
+		 * task_basic_info_64_2_t
+		 * mach_task_basic_info_t (12 ints)
+		 * task_power_info_t (18 ints)
+		 * If other task_info flavors are added, this
+		 * definition may need to be changed. (See
+		 * mach/task_info.h and mach/policy.h) */
+type task_flavor_t		= int;
+type task_info_t		= array[*:52] of integer_t;
+
+type task_purgable_info_t	= struct[68] of integer_t;
+
+type task_policy_flavor_t	= natural_t;
+type task_policy_t		= array[*:16] of integer_t;
+
+type mem_entry_name_port_t = mach_port_t
+#if     KERNEL_SERVER
+		intran: mem_entry_name_port_t null_conversion(mach_port_t)
+		outtran: mach_port_t null_conversion(mem_entry_name_port_t)
+#endif  /* KERNEL_SERVER */
+		;
+
+type mem_entry_name_port_move_send_t = mach_port_move_send_t
+	cusertype: mem_entry_name_port_t
+#if     KERNEL_SERVER
+		intran: mem_entry_name_port_t null_conversion(mach_port_t)
+		outtran: mach_port_t null_conversion(mem_entry_name_port_t)
+#endif  /* KERNEL_SERVER */
+		;
+
+type memory_object_default_t = mach_port_t
+		;
+ 
+type memory_object_t = mach_port_t
+		;
+
+
+type memory_object_control_t = mach_port_t
+		;
+
+type memory_object_name_t = mach_port_t
+		ctype: mach_port_t
+		;
+
+
+type memory_object_copy_strategy_t = int;
+type memory_object_return_t = int;
+
+type machine_info_data_t = struct[5] of integer_t;
+type machine_slot_data_t = struct[8] of integer_t;
+
+type host_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: host_t convert_port_to_host(mach_port_t)
+		outtran: mach_port_t convert_host_to_port(host_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type host_priv_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: host_priv_t convert_port_to_host_priv(mach_port_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type host_security_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: host_security_t convert_port_to_host_security(mach_port_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+		/* 
+		 * host_info_t: variable-sized inline array that can contain:
+		 * 
+		 * 	host_basic_info_old_t (5 ints)
+		 * 	host_basic_info_t (12 ints)
+		 * 	host_sched_info_t (2 ints)
+		 * 	kernel_resource_sizes_t (5 ints)
+		 * 	host_load_info_t (6 ints)
+		 * 	vm_statistics32_t (15 ints)
+		 * 	host_purgable_info_t (68 ints)
+		 *	host_expired_task_info uses a task_power_info (18 ints)
+		 * 
+		 * If other host_info flavors are added, this definition may
+		 * need to be changed. (See mach/{host_info,vm_statistics}.h)
+		 */
+type host_flavor_t		= int;
+type host_info_t 		= array[*:68] of integer_t;
+		/* 
+		 * host_info64_t: variable-sized inline array that can contain:
+		 * 
+		 *	vm_statistics_t (6 ints and 9 longs)
+		 *	vm_extmod_statistics_t (6 64-bit ints)
+		 */
+type host_info64_t		= array[*:256] of integer_t;
+
+type processor_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: processor_t convert_port_to_processor(mach_port_t)
+		outtran: mach_port_t convert_processor_to_port(processor_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type processor_array_t 	= ^array[] of processor_t;
+
+		/* processor_info_t: variable-sized inline array that can
+		 * contain:
+		 * processor_basic_info_t:   (5 ints)
+		 * processor_cpu_load_info_t:(4 ints)
+		 * processor_machine_info_t :(12 ints)
+		 * If other processor_info flavors are added, this definition
+		 * may need to be changed. (See mach/processor_info.h) */
+type processor_flavor_t		= int;
+type processor_info_t		= array[*:12] of integer_t;
+type processor_info_array_t	= ^array[] of integer_t;
+
+type processor_set_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: processor_set_t convert_port_to_pset(mach_port_t)
+		outtran: mach_port_t convert_pset_to_port(processor_set_t)
+		destructor: pset_deallocate(processor_set_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type processor_set_array_t = ^array[] of processor_set_t;
+
+type processor_set_name_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: processor_set_name_t convert_port_to_pset_name(mach_port_t)
+		outtran: mach_port_t convert_pset_name_to_port(processor_set_name_t)
+		destructor: pset_deallocate(processor_set_name_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type processor_set_name_array_t = ^array[] of processor_set_name_t;
+
+		/* processor_set_info_t: variable-size inline array
+		 * that can hold:
+		 * processor_set_basic_info (5 ints)
+		 * processor_set_load_info (4 ints)
+		 * policy_timeshare_base_t (1 int)
+		 * policy_fifo_base_t (1 int)
+		 * policy_rr_base_t (1 int)
+		 * policy_timeshare_base_t (1 int)
+		 * policy_fifo_base_t (1 int)
+		 * policy_rr_base_t (1 int)
+		 * policy_t (1 int)
+		 * If other flavors are added, this definition may
+		 * need to be changed. (see mach/processor.h) */
+type processor_set_flavor_t	= int;
+type processor_set_info_t	= array[*:5] of integer_t;	
+
+type bootstrap_t = mach_port_t;
+
+type kernel_version_t           = c_string[*:512];
+type kernel_boot_info_t         = c_string[*:4096];
+
+type time_value_t = struct[2] of integer_t;
+
+type mach_port_qos_t = struct[2] of integer_t;
+
+type mach_port_options_t = struct[3] of uint64_t;
+type mach_port_options_ptr_t = ^ mach_port_options_t;
+
+type emulation_vector_t		= ^array[] of vm_offset_t;
+
+type inline_existence_map_t	= array[*:512] of char;
+
+type policy_t			= int;
+		/* policy_info_t: variable-size inline array. Can hold:
+		 * policy_timeshare_info_t (5 ints)
+		 * policy_fifo_info_t (4 ints)
+		 * policy_rr_info_t (5 ints) */
+type policy_base_t		= array[*:5] of integer_t;
+type policy_info_t		= array[*:2] of integer_t;
+type policy_limit_t		= array[*:1] of integer_t;
+
+type ledger_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: ledger_t convert_port_to_ledger(mach_port_t)
+		outtran: mach_port_t convert_ledger_to_port(ledger_t)
+#endif	/* KERNEL_SERVER */
+                ;
+
+type ledger_array_t	 	= ^array[] of ledger_t;
+type ledger_item_t		= integer_t;
+     				  /* DEPRECATED */
+
+type ledger_amount_t		= int64_t;
+
+type security_token_t		= struct[2] of uint32_t;
+type audit_token_t		= struct[8] of uint32_t;
+
+type msg_labels_t = mach_port_t;
+
+		/* memory_object_info_t: variable-size inline array:
+		 * memory_object_attr_info_t (5 ints)
+		 * XXX actually it's 6 ints temporarily (object_ready!)
+		 * memory_object_behave_info_t (4 ints)
+		 * memory_object_perf_info_t (2 ints)
+		 * old_memory_object_attr_info_t (3 ints)
+		 * If other flavors are added, this definition may
+		 * need to be changed. (see mach/memory_object.h) */
+type memory_object_flavor_t	= int;
+type memory_object_info_t	= array[*:6] of int;
+
+		/* vm_region_info_t: variable-size inline array that can hold:
+		 * vm_region_basic_info_t (8 ints)
+		 * If other flavors are added, this definition may
+		 * need to be changed. (see mach/vm_region.h) */
+type vm_region_flavor_t		= int;
+type vm_region_info_t		= array[*:10] of int;
+type vm_region_recurse_info_t	= array[*:19] of int;
+
+type vm_page_info_flavor_t	= int;
+type vm_page_info_t		= array[*:32] of int;
+
+type mach_vm_read_entry_t = array[512] of mach_vm_offset_t;
+type vm_read_entry_t = array[512] of vm_offset_t;
+#if VM32_SUPPORT
+type vm32_read_entry_t = array[512] of vm32_offset_t;
+#endif
+
+type exception_mask_t		= int;
+type exception_behavior_t	= int;
+
+type    exception_handler_t = mach_port_t;
+
+type	exception_handler_array_t	=
+			array[*:32] of exception_handler_t;
+
+type	exception_behavior_array_t	=
+			array[*:32] of exception_behavior_t;
+
+type	exception_flavor_array_t	=
+			array[*:32] of thread_state_flavor_t;
+
+type	exception_mask_array_t	=
+			array[*:32] of exception_mask_t;
+
+type semaphore_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: semaphore_t convert_port_to_semaphore(mach_port_t)
+		outtran: mach_port_t convert_semaphore_to_port(semaphore_t)
+		destructor: semaphore_dereference(semaphore_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type semaphore_consume_ref_t = mach_port_move_send_t
+		cusertype: semaphore_t
+#if	KERNEL_SERVER
+		intran: semaphore_t convert_port_to_semaphore(mach_port_t)
+		outtran: mach_port_t convert_semaphore_to_port(semaphore_t)
+		destructor: semaphore_dereference(semaphore_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type lock_set_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: lock_set_t convert_port_to_lock_set(mach_port_t)
+		outtran: mach_port_t convert_lock_set_to_port(lock_set_t)
+		destructor: lock_set_dereference(lock_set_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type task_suspension_token_t = mach_port_move_send_once_t
+#if	KERNEL_SERVER
+		intran: task_suspension_token_t convert_port_to_task_suspension_token(mach_port_t)
+		outtran: mach_port_t convert_task_suspension_token_to_port(task_suspension_token_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+
+/* public voucher types */
+
+/* Mach voucher object */
+type mach_voucher_t = mach_port_t;
+type mach_voucher_name_t = mach_port_name_t;
+
+type mach_voucher_attr_manager_t = mach_port_t;
+type mach_voucher_attr_control_t = mach_port_t;
+
+/* IPC voucher internal object */
+type ipc_voucher_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: ipc_voucher_t convert_port_to_voucher(mach_port_t)
+		outtran: mach_port_t convert_voucher_to_port(ipc_voucher_t)
+		destructor: ipc_voucher_release(ipc_voucher_t)
+#endif	/* KERNEL_SERVER */
+	        ;
+
+/* IPC voucher attribute control internal object */
+type ipc_voucher_attr_control_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: ipc_voucher_attr_control_t convert_port_to_voucher_attr_control(mach_port_t)
+		outtran: mach_port_t convert_voucher_attr_control_to_port(ipc_voucher_attr_control_t)
+		destructor: ipc_voucher_attr_control_release(ipc_voucher_attr_control_t)
+#endif	/* KERNEL_SERVER */
+                ;
+
+type mach_voucher_attr_key_t = uint32_t;
+
+type mach_voucher_attr_command_t = uint32_t;
+type mach_voucher_attr_recipe_command_t = uint32_t;
+
+type mach_voucher_attr_content_size_t = uint32_t;
+type mach_voucher_attr_content_t = array[*:4096] of uint8_t;
+type mach_voucher_attr_content_array_t = array[*:5120] of uint8_t;
+
+type mach_voucher_attr_raw_recipe_size_t = uint32_t;
+type mach_voucher_attr_raw_recipe_t = array[*:4096] of uint8_t;
+type mach_voucher_attr_raw_recipe_array_t = array[*:5120] of uint8_t;
+
+type mach_voucher_selector_t = uint32_t;
+
+type mach_voucher_attr_value_handle_t = uint64_t;
+type mach_voucher_attr_value_handle_array_t = array[*:4] of mach_voucher_attr_value_handle_t;
+type mach_voucher_attr_value_reference_t = uint32_t;
+
+/* kernel module loader */
+type kmod_t = int;
+type kmod_control_flavor_t = int;
+
+type kmod_args_t = ^array[] of MACH_MSG_TYPE_BYTE
+	ctype: kmod_args_t;
+
+type io_master_t = mach_port_t;
+type UNDServerRef = mach_port_t;
+
+#if KERNEL_SERVER
+
+simport <kern/ipc_mig.h>;	/* pick up kernel-specific MIG things */
+
+#endif /* KERNEL_SERVER */
+
+import <mach/mig.h>;
+import <mach/mach_types.h>;
+
+#endif	/* _MACH_MACH_TYPES_DEFS_ */
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/mach_types.h cctools-877.5-AnV/include/mach/mach_types.h
--- cctools-877.5/include/mach/mach_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_types.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,239 @@
+/*
+ * Copyright (c) 2000-2010 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+/*
+ *	File:	mach/mach_types.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *	Date:	1986
+ *
+ *	Mach external interface definitions.
+ *
+ */
+
+#ifndef	_MACH_MACH_TYPES_H_
+#define _MACH_MACH_TYPES_H_
+
+#include <stdint.h>
+
+#include <sys/cdefs.h>
+
+#include <mach/host_info.h>
+#include <mach/host_notify.h>
+#include <mach/host_special_ports.h>
+#include <mach/machine.h>
+#include <mach/machine/vm_types.h>
+#include <mach/memory_object_types.h>
+#include <mach/message.h>
+#include <mach/exception_types.h>
+#include <mach/port.h>
+#include <mach/mach_voucher_types.h>
+#include <mach/processor_info.h>
+#include <mach/task_info.h>
+#include <mach/task_policy.h>
+#include <mach/task_special_ports.h>
+#include <mach/thread_info.h>
+#include <mach/thread_policy.h>
+#include <mach/thread_special_ports.h>
+#include <mach/thread_status.h>
+#include <mach/time_value.h>
+#include <mach/clock_types.h>
+#include <mach/vm_attributes.h>
+#include <mach/vm_inherit.h>
+#include <mach/vm_purgable.h>
+#include <mach/vm_behavior.h>
+#include <mach/vm_prot.h>
+#include <mach/vm_statistics.h>
+#include <mach/vm_sync.h>
+#include <mach/vm_types.h>
+#include <mach/vm_region.h>
+#include <mach/kmod.h>
+
+
+/*
+ * If we are not in the kernel, then these will all be represented by
+ * ports at user-space.
+ */
+typedef mach_port_t		task_t;
+typedef mach_port_t		task_name_t;
+typedef mach_port_t		task_suspension_token_t;
+typedef mach_port_t		thread_t;
+typedef	mach_port_t		thread_act_t;
+typedef mach_port_t		ipc_space_t;
+typedef mach_port_t		coalition_t;
+typedef mach_port_t		host_t;
+typedef mach_port_t		host_priv_t;
+typedef mach_port_t		host_security_t;
+typedef mach_port_t		processor_t;
+typedef mach_port_t		processor_set_t;
+typedef mach_port_t		processor_set_control_t;
+typedef mach_port_t		semaphore_t;
+typedef mach_port_t		lock_set_t;
+typedef mach_port_t		ledger_t;
+typedef mach_port_t		alarm_t;
+typedef mach_port_t		clock_serv_t;
+typedef mach_port_t		clock_ctrl_t;
+
+
+/*
+ * These aren't really unique types.  They are just called
+ * out as unique types at one point in history.  So we list
+ * them here for compatibility.
+ */
+typedef processor_set_t		processor_set_name_t;
+
+/*
+ * These types are just hard-coded as ports
+ */
+typedef mach_port_t		clock_reply_t;
+typedef mach_port_t		bootstrap_t;
+typedef	mach_port_t		mem_entry_name_port_t;
+typedef mach_port_t		exception_handler_t;
+typedef exception_handler_t	*exception_handler_array_t;
+typedef mach_port_t		vm_task_entry_t;
+typedef mach_port_t		io_master_t;
+typedef mach_port_t		UNDServerRef;
+
+/*
+ * Mig doesn't translate the components of an array.
+ * For example, Mig won't use the thread_t translations
+ * to translate a thread_array_t argument.  So, these definitions
+ * are not completely accurate at the moment for other kernel
+ * components.
+ */
+typedef task_t			*task_array_t;
+typedef thread_t		*thread_array_t;
+typedef processor_set_t		*processor_set_array_t;
+typedef processor_set_t		*processor_set_name_array_t;
+typedef processor_t		*processor_array_t;
+typedef	thread_act_t		*thread_act_array_t;
+typedef ledger_t		*ledger_array_t;
+
+/*
+ * However the real mach_types got declared, we also have to declare
+ * types with "port" in the name for compatability with the way OSF
+ * had declared the user interfaces at one point.  Someday these should
+ * go away.
+ */
+typedef task_t			task_port_t;
+typedef	task_array_t		task_port_array_t;
+typedef thread_t		thread_port_t;
+typedef	thread_array_t		thread_port_array_t;
+typedef ipc_space_t		ipc_space_port_t;
+typedef host_t			host_name_t;
+typedef host_t			host_name_port_t;
+typedef processor_set_t		processor_set_port_t;
+typedef processor_set_t		processor_set_name_port_t;
+typedef processor_set_array_t	processor_set_name_port_array_t;
+typedef processor_set_t		processor_set_control_port_t;
+typedef processor_t		processor_port_t;
+typedef processor_array_t	processor_port_array_t;
+typedef thread_act_t		thread_act_port_t;
+typedef	thread_act_array_t	thread_act_port_array_t;
+typedef semaphore_t		semaphore_port_t;
+typedef lock_set_t		lock_set_port_t;
+typedef ledger_t		ledger_port_t;
+typedef ledger_array_t		ledger_port_array_t;
+typedef alarm_t			alarm_port_t;
+typedef clock_serv_t		clock_serv_port_t;
+typedef clock_ctrl_t		clock_ctrl_port_t;
+typedef exception_handler_t	exception_port_t;
+typedef exception_handler_array_t exception_port_arrary_t;
+
+
+#define TASK_NULL		((task_t) 0)
+#define TASK_NAME_NULL		((task_name_t) 0)
+#define THREAD_NULL		((thread_t) 0)
+#define TID_NULL		((uint64_t) 0)
+#define THR_ACT_NULL 		((thread_act_t) 0)
+#define IPC_SPACE_NULL		((ipc_space_t) 0)
+#define COALITION_NULL		((coalition_t) 0)
+#define HOST_NULL		((host_t) 0)
+#define HOST_PRIV_NULL		((host_priv_t)0)
+#define HOST_SECURITY_NULL	((host_security_t)0)
+#define PROCESSOR_SET_NULL	((processor_set_t) 0)
+#define PROCESSOR_NULL		((processor_t) 0)
+#define SEMAPHORE_NULL		((semaphore_t) 0)
+#define LOCK_SET_NULL		((lock_set_t) 0)
+#define LEDGER_NULL 		((ledger_t) 0)
+#define ALARM_NULL		((alarm_t) 0)
+#define CLOCK_NULL		((clock_t) 0)
+#define UND_SERVER_NULL		((UNDServerRef) 0)
+
+/* DEPRECATED */
+typedef natural_t	ledger_item_t;
+#define LEDGER_ITEM_INFINITY	((ledger_item_t) (~0))
+
+typedef int64_t 		ledger_amount_t;
+#define LEDGER_LIMIT_INFINITY   ((ledger_amount_t)((1ULL << 63) - 1))
+
+typedef mach_vm_offset_t	*emulation_vector_t;
+typedef char			*user_subsystem_t;
+
+typedef char			*labelstr_t;
+/*
+ *	Backwards compatibility, for those programs written
+ *	before mach/{std,mach}_types.{defs,h} were set up.
+ */
+#include <mach/std_types.h>
+
+#endif	/* _MACH_MACH_TYPES_H_ */
diff -Nur cctools-877.5/include/mach/mach_vm.defs cctools-877.5-AnV/include/mach/mach_vm.defs
--- cctools-877.5/include/mach/mach_vm.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_vm.defs	2015-11-16 07:56:13 +0000
@@ -0,0 +1,524 @@
+/*
+ * Copyright (c) 2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_vm.defs
+ *
+ *	Exported kernel VM calls (for any task on the platform).
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+	  mach_vm
+#else
+	  vm_map_lp64_local
+#endif
+	  4800;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach_debug/mach_debug_types.defs>
+
+#if !KERNEL && !LIBSYSCALL_INTERFACE
+#define PREFIX(NAME) _kernelrpc_ ## NAME
+#else
+#define PREFIX(NAME) NAME
+#endif
+
+/*
+ *	Allocate zero-filled memory in the address space
+ *	of the target task, either at the specified address,
+ *	or wherever space can be found (controlled by flags),
+ *	of the specified size.  The address at which the
+ *	allocation actually took place is returned.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine PREFIX(mach_vm_allocate) (
+		target		: vm_task_entry_t;
+	inout	address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		flags		: int);
+
+#else
+
+#if !KERNEL && !LIBSYSCALL_INTERFACE
+skip;
+#else
+routine PREFIX(vm_allocate) (
+		target		: vm_task_entry_t;
+	inout	address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		flags		: int);
+
+#endif
+
+#endif
+
+
+/*
+ *	Deallocate the specified range from the virtual
+ *	address space of the target virtual memory map.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine PREFIX(mach_vm_deallocate) (
+		target		: vm_task_entry_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t);
+
+#else
+
+#if !KERNEL && !LIBSYSCALL_INTERFACE
+skip;
+#else
+routine PREFIX(vm_deallocate) (
+		target		: vm_task_entry_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t);
+#endif
+
+#endif
+
+/*
+ *	Set the current or maximum protection attribute
+ *	for the specified range of the virtual address
+ *	space of the target virtual memory map.  The current
+ *	protection limits the memory access rights of threads
+ *	within the map; the maximum protection limits the accesses
+ *	that may be given in the current protection.
+ *	Protections are specified as a set of {read, write, execute}
+ *	*permissions*.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine PREFIX(mach_vm_protect) (
+		target_task	: vm_task_entry_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		set_maximum	: boolean_t;
+		new_protection	: vm_prot_t);
+
+
+#else
+
+#if !KERNEL && !LIBSYSCALL_INTERFACE
+skip;
+#else
+
+routine PREFIX(vm_protect) (
+		target_task	: vm_task_entry_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		set_maximum	: boolean_t;
+		new_protection	: vm_prot_t);
+
+#endif
+
+#endif
+
+/*
+ *	Set the inheritance attribute for the specified range
+ *	of the virtual address space of the target address space.
+ *	The inheritance value is one of {none, copy, share}, and
+ *	specifies how the child address space should acquire
+ *	this memory at the time of a task_create call.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_inherit(
+#else
+routine vm_inherit(
+#endif
+		target_task	: vm_task_entry_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		new_inheritance	: vm_inherit_t);
+
+/*
+ *	Returns the contents of the specified range of the
+ *	virtual address space of the target task.  [The
+ *	range must be aligned on a virtual page boundary,
+ *	and must be a multiple of pages in extent.  The
+ *	protection on the specified range must permit reading.]
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine PREFIX(mach_vm_read) (
+#else
+routine PREFIX(vm_read) (
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+	out	data		: pointer_t);
+
+/* 
+ * List corrollary to vm_read, returns mapped contents of specified
+ * ranges within target address space.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_read_list(
+#else
+routine vm_read_list(
+#endif
+		target_task 	: vm_map_t;
+	inout	data_list   	: mach_vm_read_entry_t;
+		count		: natural_t);
+
+/*
+ *	Writes the contents of the specified range of the
+ *	virtual address space of the target task.  [The
+ *	range must be aligned on a virtual page boundary,
+ *	and must be a multiple of pages in extent.  The
+ *	protection on the specified range must permit writing.]
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_write(
+#else
+routine vm_write(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		data		: pointer_t);
+
+/*
+ *	Copy the contents of the source range of the virtual
+ *	address space of the target task to the destination
+ *	range in that same address space.  [Both of the
+ *	ranges must be aligned on a virtual page boundary,
+ *	and must be multiples of pages in extent.  The
+ *	protection on the source range must permit reading,
+ *	and the protection on the destination range must
+ *	permit writing.]
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_copy(
+#else
+routine vm_copy(
+#endif
+		target_task	: vm_map_t;
+		source_address	: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		dest_address	: mach_vm_address_t);
+
+/*
+ *	Returns the contents of the specified range of the
+ *	virtual address space of the target task.  [There
+ *	are no alignment restrictions, and the results will
+ *      overwrite the area pointed to by data - which must
+ *      already exist. The protection on the specified range
+ *	must permit reading.]
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_read_overwrite(
+#else
+routine vm_read_overwrite(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		data		: mach_vm_address_t;
+	out	outsize		: mach_vm_size_t);
+
+
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_msync(
+#else
+routine vm_msync(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		sync_flags	: vm_sync_t );
+
+/*
+ *	Set the paging behavior attribute for the specified range
+ *	of the virtual address space of the target task.
+ *	The behavior value is one of {default, random, forward 
+ *	sequential, reverse sequential} and indicates the expected
+ *	page reference pattern for the specified range.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_behavior_set(
+#else
+routine vm_behavior_set(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		new_behavior	: vm_behavior_t);
+
+
+/*
+ *	Map a user-supplie memory object into the virtual address
+ *	space of the target task.  If desired (anywhere is TRUE),
+ *	the kernel will find a suitable address range of the
+ *	specified size; else, the specific address will be allocated.
+ *
+ *	The beginning address of the range will be aligned on a virtual
+ *	page boundary, be at or beyond the address specified, and
+ *	meet the mask requirements (bits turned on in the mask must not
+ *	be turned on in the result); the size of the range, in bytes,
+ *	will be rounded	up to an integral number of virtual pages.
+ *
+ *	The memory in the resulting range will be associated with the
+ *	specified memory object, with the beginning of the memory range
+ *	referring to the specified offset into the memory object.
+ *
+ *	The mapping will take the current and maximum protections and
+ *	the inheritance attributes specified; see the vm_protect and
+ *	vm_inherit calls for a description of these attributes.
+ *
+ *	If desired (copy is TRUE), the memory range will be filled
+ *	with a copy of the data from the memory object; this copy will
+ *	be private to this mapping in this target task.  Otherwise,
+ *	the memory in this mapping will be shared with other mappings
+ *	of the same memory object at the same offset (in this task or
+ *	in other tasks).  [The Mach kernel only enforces shared memory
+ *	consistency among mappings on one host with similar page alignments.
+ *	The user-defined memory manager for this object is responsible
+ *	for further consistency.]
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine PREFIX(mach_vm_map) (
+#else
+routine PREFIX(vm_map) (
+#endif
+		target_task	: vm_task_entry_t;
+	inout	address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		mask		: mach_vm_offset_t;
+		flags		: int;
+		object		: mem_entry_name_port_t;
+		offset		: memory_object_offset_t;
+		copy		: boolean_t;
+		cur_protection	: vm_prot_t;
+		max_protection	: vm_prot_t;
+		inheritance	: vm_inherit_t);
+
+/*
+ *	Set/Get special properties of memory associated
+ *	to some virtual address range, such as cachability, 
+ *	migrability, replicability.  Machine-dependent.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_machine_attribute(
+#else
+routine vm_machine_attribute(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		attribute	: vm_machine_attribute_t;
+	inout	value		: vm_machine_attribute_val_t);
+
+/*
+ *      Map portion of a task's address space.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine PREFIX(mach_vm_remap) (
+#else
+routine PREFIX(vm_remap) (
+#endif
+		target_task	: vm_map_t;
+	inout	target_address	: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		mask		: mach_vm_offset_t;
+		flags		: int;
+		src_task	: vm_map_t;
+		src_address	: mach_vm_address_t;
+		copy		: boolean_t;
+	out	cur_protection	: vm_prot_t;
+	out	max_protection	: vm_prot_t;
+		inheritance	: vm_inherit_t);
+
+/*
+ *      Give the caller information on the given location in a virtual
+ *      address space.  If a page is mapped return ref and dirty info.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_page_query(
+#else
+routine vm_map_page_query(
+#endif
+                target_map      :vm_map_t;
+                offset          :mach_vm_offset_t;
+        out     disposition     :integer_t;
+        out     ref_count       :integer_t);
+
+
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_region_recurse(
+#else
+routine vm_region_recurse_64(
+#endif
+                target_task     : vm_map_t;
+	inout	address		: mach_vm_address_t;
+        out     size            : mach_vm_size_t;
+	inout	nesting_depth	: natural_t;
+	out	info		: vm_region_recurse_info_t,CountInOut);
+
+/*
+ *      Returns information about the contents of the virtual
+ *      address space of the target task at the specified
+ *      address.  The returned protection, inheritance, sharing
+ *      and memory object values apply to the entire range described
+ *      by the address range returned; the memory object offset
+ *      corresponds to the beginning of the address range.
+ *      [If the specified address is not allocated, the next
+ *      highest address range is described.  If no addresses beyond
+ *      the one specified are allocated, the call returns KERN_NO_SPACE.]
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_region(
+#else
+routine vm_region_64(
+#endif
+                target_task     : vm_map_t;
+	inout	address		: mach_vm_address_t;
+        out     size            : mach_vm_size_t;
+		flavor		: vm_region_flavor_t;
+	out	info		: vm_region_info_t, CountInOut;
+        out     object_name     : memory_object_name_t =
+                                        MACH_MSG_TYPE_MOVE_SEND
+                                        ctype: mach_port_t);
+
+/*
+ *	Allow application level processes to create named entries which
+ *	correspond to mapped portions of their address space.  These named
+ *	entries can then be manipulated, shared with other processes in
+ *	other address spaces and ultimately mapped in ohter address spaces
+ *
+ *	THIS INTERFACE IS STILL EVOLVING.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+#if !defined(__LP64__) || KERNEL_SERVER || XNU_KERNEL_PRIVATE || LIBSYSCALL_INTERFACE
+routine _mach_make_memory_entry(
+#else
+routine mach_make_memory_entry(
+#endif
+#else
+routine mach_make_memory_entry_64(
+#endif
+		target_task	:vm_map_t;
+	inout	size		:memory_object_size_t;
+		offset		:memory_object_offset_t;
+		permission	:vm_prot_t;
+	out	object_handle	:mem_entry_name_port_move_send_t;
+		parent_handle	:mem_entry_name_port_t);
+
+/*
+ *	Control behavior and investigate state of a "purgable" object in
+ *	the virtual address space of the target task.  A purgable object is
+ *	created via a call to mach_vm_allocate() with VM_FLAGS_PURGABLE
+ *	specified.  See the routine implementation for a complete
+ *	definition of the routine.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_purgable_control(
+#else
+routine vm_purgable_control(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		control		: vm_purgable_t;
+	inout	state		: int);
+
+
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_page_info(
+			target_task		: vm_map_t;
+			address			: mach_vm_address_t;
+			flavor			: vm_page_info_flavor_t;
+	out		info			: vm_page_info_t, CountInOut);
+#else
+skip;
+#endif
+
+/****************************** Legacy section ***************************/
+/*  The following definitions are exist to provide compatibility with    */
+/*  the legacy APIs.  They are no different.  We just need to produce    */
+/*  the user-level stub interface for them.                              */
+/****************************** Legacy section ***************************/
+
+
+/*
+ * These interfaces just aren't supported in the new (wide) model:
+ *
+ *	mach_vm_region_info() -
+ *	vm_map_pages_info() -
+ *		no user-level replacement for these MACH_DEBUG interfaces
+ *	vm_map_get_upl() -
+ *		no user-level replacement at the moment
+ *	vm_region_info() -
+ *		use mach_vm_region_info() or vm_region_info_64()
+ *	vm_region_recurse() -
+ *		use mach_vm_region_recurse() or vm_region_recurse_64()
+ */
+
+/*
+ * The following legacy interfaces are provides as macro wrappers to the new
+ * interfaces.  You should strive to use the new ones instead:
+ *
+ *	vm_map() -
+ *		use mach_vm_map() or vm_map_64()
+ *	vm_region() -
+ *		use mach_vm_region() or vm_region_64()
+ *	mach_make_memory_entry() -
+ *		use mach_vm_make_memory_entry() or mach_make_memory_entry_64()
+ */
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/mach_vm.h cctools-877.5-AnV/include/mach/mach_vm.h
--- cctools-877.5/include/mach/mach_vm.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_vm.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,1033 @@
+#ifndef	_mach_vm_user_
+#define	_mach_vm_user_
+
+/* Module mach_vm */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	mach_vm_MSG_COUNT
+#define	mach_vm_MSG_COUNT	20
+#endif	/* mach_vm_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine mach_vm_allocate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_allocate
+(
+	vm_map_t target,
+	mach_vm_address_t *address,
+	mach_vm_size_t size,
+	int flags
+);
+
+/* Routine mach_vm_deallocate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_deallocate
+(
+	vm_map_t target,
+	mach_vm_address_t address,
+	mach_vm_size_t size
+);
+
+/* Routine mach_vm_protect */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_protect
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	boolean_t set_maximum,
+	vm_prot_t new_protection
+);
+
+/* Routine mach_vm_inherit */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_inherit
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	vm_inherit_t new_inheritance
+);
+
+/* Routine mach_vm_read */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_read
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	vm_offset_t *data,
+	mach_msg_type_number_t *dataCnt
+);
+
+/* Routine mach_vm_read_list */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_read_list
+(
+	vm_map_t target_task,
+	mach_vm_read_entry_t data_list,
+	natural_t count
+);
+
+/* Routine mach_vm_write */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_write
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	vm_offset_t data,
+	mach_msg_type_number_t dataCnt
+);
+
+/* Routine mach_vm_copy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_copy
+(
+	vm_map_t target_task,
+	mach_vm_address_t source_address,
+	mach_vm_size_t size,
+	mach_vm_address_t dest_address
+);
+
+/* Routine mach_vm_read_overwrite */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_read_overwrite
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	mach_vm_address_t data,
+	mach_vm_size_t *outsize
+);
+
+/* Routine mach_vm_msync */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_msync
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	vm_sync_t sync_flags
+);
+
+/* Routine mach_vm_behavior_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_behavior_set
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	vm_behavior_t new_behavior
+);
+
+/* Routine mach_vm_map */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_map
+(
+	vm_map_t target_task,
+	mach_vm_address_t *address,
+	mach_vm_size_t size,
+	mach_vm_offset_t mask,
+	int flags,
+	mem_entry_name_port_t object,
+	memory_object_offset_t offset,
+	boolean_t copy,
+	vm_prot_t cur_protection,
+	vm_prot_t max_protection,
+	vm_inherit_t inheritance
+);
+
+/* Routine mach_vm_machine_attribute */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_machine_attribute
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	vm_machine_attribute_t attribute,
+	vm_machine_attribute_val_t *value
+);
+
+/* Routine mach_vm_remap */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_remap
+(
+	vm_map_t target_task,
+	mach_vm_address_t *target_address,
+	mach_vm_size_t size,
+	mach_vm_offset_t mask,
+	int flags,
+	vm_map_t src_task,
+	mach_vm_address_t src_address,
+	boolean_t copy,
+	vm_prot_t *cur_protection,
+	vm_prot_t *max_protection,
+	vm_inherit_t inheritance
+);
+
+/* Routine mach_vm_page_query */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_page_query
+(
+	vm_map_t target_map,
+	mach_vm_offset_t offset,
+	integer_t *disposition,
+	integer_t *ref_count
+);
+
+/* Routine mach_vm_region_recurse */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_region_recurse
+(
+	vm_map_t target_task,
+	mach_vm_address_t *address,
+	mach_vm_size_t *size,
+	natural_t *nesting_depth,
+	vm_region_recurse_info_t info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine mach_vm_region */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_region
+(
+	vm_map_t target_task,
+	mach_vm_address_t *address,
+	mach_vm_size_t *size,
+	vm_region_flavor_t flavor,
+	vm_region_info_t info,
+	mach_msg_type_number_t *infoCnt,
+	mach_port_t *object_name
+);
+
+/* Routine _mach_make_memory_entry */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t _mach_make_memory_entry
+(
+	vm_map_t target_task,
+	memory_object_size_t *size,
+	memory_object_offset_t offset,
+	vm_prot_t permission,
+	mem_entry_name_port_t *object_handle,
+	mem_entry_name_port_t parent_handle
+);
+
+/* Routine mach_vm_purgable_control */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_purgable_control
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	vm_purgable_t control,
+	int *state
+);
+
+/* Routine mach_vm_page_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_page_info
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	vm_page_info_flavor_t flavor,
+	vm_page_info_t info,
+	mach_msg_type_number_t *infoCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__mach_vm_subsystem__defined
+#define __Request__mach_vm_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		int flags;
+	} __Request__mach_vm_allocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+	} __Request__mach_vm_deallocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		boolean_t set_maximum;
+		vm_prot_t new_protection;
+	} __Request__mach_vm_protect_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		vm_inherit_t new_inheritance;
+	} __Request__mach_vm_inherit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+	} __Request__mach_vm_read_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_read_entry_t data_list;
+		natural_t count;
+	} __Request__mach_vm_read_list_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_msg_type_number_t dataCnt;
+	} __Request__mach_vm_write_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t source_address;
+		mach_vm_size_t size;
+		mach_vm_address_t dest_address;
+	} __Request__mach_vm_copy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		mach_vm_address_t data;
+	} __Request__mach_vm_read_overwrite_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		vm_sync_t sync_flags;
+	} __Request__mach_vm_msync_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		vm_behavior_t new_behavior;
+	} __Request__mach_vm_behavior_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		mach_vm_offset_t mask;
+		int flags;
+		memory_object_offset_t offset;
+		boolean_t copy;
+		vm_prot_t cur_protection;
+		vm_prot_t max_protection;
+		vm_inherit_t inheritance;
+	} __Request__mach_vm_map_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		vm_machine_attribute_t attribute;
+		vm_machine_attribute_val_t value;
+	} __Request__mach_vm_machine_attribute_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t src_task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_vm_address_t target_address;
+		mach_vm_size_t size;
+		mach_vm_offset_t mask;
+		int flags;
+		mach_vm_address_t src_address;
+		boolean_t copy;
+		vm_inherit_t inheritance;
+	} __Request__mach_vm_remap_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_offset_t offset;
+	} __Request__mach_vm_page_query_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		natural_t nesting_depth;
+		mach_msg_type_number_t infoCnt;
+	} __Request__mach_vm_region_recurse_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		vm_region_flavor_t flavor;
+		mach_msg_type_number_t infoCnt;
+	} __Request__mach_vm_region_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t parent_handle;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		memory_object_size_t size;
+		memory_object_offset_t offset;
+		vm_prot_t permission;
+	} __Request___mach_make_memory_entry_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		vm_purgable_t control;
+		int state;
+	} __Request__mach_vm_purgable_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		vm_page_info_flavor_t flavor;
+		mach_msg_type_number_t infoCnt;
+	} __Request__mach_vm_page_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__mach_vm_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__mach_vm_subsystem__defined
+#define __RequestUnion__mach_vm_subsystem__defined
+union __RequestUnion__mach_vm_subsystem {
+	__Request__mach_vm_allocate_t Request_mach_vm_allocate;
+	__Request__mach_vm_deallocate_t Request_mach_vm_deallocate;
+	__Request__mach_vm_protect_t Request_mach_vm_protect;
+	__Request__mach_vm_inherit_t Request_mach_vm_inherit;
+	__Request__mach_vm_read_t Request_mach_vm_read;
+	__Request__mach_vm_read_list_t Request_mach_vm_read_list;
+	__Request__mach_vm_write_t Request_mach_vm_write;
+	__Request__mach_vm_copy_t Request_mach_vm_copy;
+	__Request__mach_vm_read_overwrite_t Request_mach_vm_read_overwrite;
+	__Request__mach_vm_msync_t Request_mach_vm_msync;
+	__Request__mach_vm_behavior_set_t Request_mach_vm_behavior_set;
+	__Request__mach_vm_map_t Request_mach_vm_map;
+	__Request__mach_vm_machine_attribute_t Request_mach_vm_machine_attribute;
+	__Request__mach_vm_remap_t Request_mach_vm_remap;
+	__Request__mach_vm_page_query_t Request_mach_vm_page_query;
+	__Request__mach_vm_region_recurse_t Request_mach_vm_region_recurse;
+	__Request__mach_vm_region_t Request_mach_vm_region;
+	__Request___mach_make_memory_entry_t Request__mach_make_memory_entry;
+	__Request__mach_vm_purgable_control_t Request_mach_vm_purgable_control;
+	__Request__mach_vm_page_info_t Request_mach_vm_page_info;
+};
+#endif /* !__RequestUnion__mach_vm_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__mach_vm_subsystem__defined
+#define __Reply__mach_vm_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_address_t address;
+	} __Reply__mach_vm_allocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_deallocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_protect_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_inherit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t dataCnt;
+	} __Reply__mach_vm_read_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_read_entry_t data_list;
+	} __Reply__mach_vm_read_list_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_write_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_copy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_size_t outsize;
+	} __Reply__mach_vm_read_overwrite_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_msync_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_behavior_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_address_t address;
+	} __Reply__mach_vm_map_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_machine_attribute_val_t value;
+	} __Reply__mach_vm_machine_attribute_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_address_t target_address;
+		vm_prot_t cur_protection;
+		vm_prot_t max_protection;
+	} __Reply__mach_vm_remap_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		integer_t disposition;
+		integer_t ref_count;
+	} __Reply__mach_vm_page_query_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		natural_t nesting_depth;
+		mach_msg_type_number_t infoCnt;
+		int info[19];
+	} __Reply__mach_vm_region_recurse_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object_name;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		mach_msg_type_number_t infoCnt;
+		int info[10];
+	} __Reply__mach_vm_region_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object_handle;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		memory_object_size_t size;
+	} __Reply___mach_make_memory_entry_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		int state;
+	} __Reply__mach_vm_purgable_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t infoCnt;
+		int info[32];
+	} __Reply__mach_vm_page_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__mach_vm_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__mach_vm_subsystem__defined
+#define __ReplyUnion__mach_vm_subsystem__defined
+union __ReplyUnion__mach_vm_subsystem {
+	__Reply__mach_vm_allocate_t Reply_mach_vm_allocate;
+	__Reply__mach_vm_deallocate_t Reply_mach_vm_deallocate;
+	__Reply__mach_vm_protect_t Reply_mach_vm_protect;
+	__Reply__mach_vm_inherit_t Reply_mach_vm_inherit;
+	__Reply__mach_vm_read_t Reply_mach_vm_read;
+	__Reply__mach_vm_read_list_t Reply_mach_vm_read_list;
+	__Reply__mach_vm_write_t Reply_mach_vm_write;
+	__Reply__mach_vm_copy_t Reply_mach_vm_copy;
+	__Reply__mach_vm_read_overwrite_t Reply_mach_vm_read_overwrite;
+	__Reply__mach_vm_msync_t Reply_mach_vm_msync;
+	__Reply__mach_vm_behavior_set_t Reply_mach_vm_behavior_set;
+	__Reply__mach_vm_map_t Reply_mach_vm_map;
+	__Reply__mach_vm_machine_attribute_t Reply_mach_vm_machine_attribute;
+	__Reply__mach_vm_remap_t Reply_mach_vm_remap;
+	__Reply__mach_vm_page_query_t Reply_mach_vm_page_query;
+	__Reply__mach_vm_region_recurse_t Reply_mach_vm_region_recurse;
+	__Reply__mach_vm_region_t Reply_mach_vm_region;
+	__Reply___mach_make_memory_entry_t Reply__mach_make_memory_entry;
+	__Reply__mach_vm_purgable_control_t Reply_mach_vm_purgable_control;
+	__Reply__mach_vm_page_info_t Reply_mach_vm_page_info;
+};
+#endif /* !__RequestUnion__mach_vm_subsystem__defined */
+
+#ifndef subsystem_to_name_map_mach_vm
+#define subsystem_to_name_map_mach_vm \
+    { "mach_vm_allocate", 4800 },\
+    { "mach_vm_deallocate", 4801 },\
+    { "mach_vm_protect", 4802 },\
+    { "mach_vm_inherit", 4803 },\
+    { "mach_vm_read", 4804 },\
+    { "mach_vm_read_list", 4805 },\
+    { "mach_vm_write", 4806 },\
+    { "mach_vm_copy", 4807 },\
+    { "mach_vm_read_overwrite", 4808 },\
+    { "mach_vm_msync", 4809 },\
+    { "mach_vm_behavior_set", 4810 },\
+    { "mach_vm_map", 4811 },\
+    { "mach_vm_machine_attribute", 4812 },\
+    { "mach_vm_remap", 4813 },\
+    { "mach_vm_page_query", 4814 },\
+    { "mach_vm_region_recurse", 4815 },\
+    { "mach_vm_region", 4816 },\
+    { "_mach_make_memory_entry", 4817 },\
+    { "mach_vm_purgable_control", 4818 },\
+    { "mach_vm_page_info", 4819 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _mach_vm_user_ */
diff -Nur cctools-877.5/include/mach/mach_voucher.defs cctools-877.5-AnV/include/mach/mach_voucher.defs
--- cctools-877.5/include/mach/mach_voucher.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_voucher.defs	2015-11-16 07:56:13 +0000
@@ -0,0 +1,69 @@
+/*
+ * Copyright (c) 2013 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		       mach_voucher 5400;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+/* extract just the content data for a <voucher, key> pair */
+routine mach_voucher_extract_attr_content(
+		voucher		: ipc_voucher_t;
+		key		: mach_voucher_attr_key_t;
+	out	content		: mach_voucher_attr_content_t, CountInOut);
+
+/* extract a recipe to reconstitue a <voucher, key> pair item in a future voucher */
+routine mach_voucher_extract_attr_recipe(
+		voucher		: ipc_voucher_t;
+		key		: mach_voucher_attr_key_t;
+	out	recipe		: mach_voucher_attr_raw_recipe_t, CountInOut);
+
+/* extract a recipe array to reconstitue all the key values in a future voucher */
+routine mach_voucher_extract_all_attr_recipes(	
+		voucher		: ipc_voucher_t;
+	out	recipes		: mach_voucher_attr_raw_recipe_array_t, CountInOut);
+
+/* execute a command against a given voucher attribute */
+routine mach_voucher_attr_command(
+		voucher		: ipc_voucher_t;
+		key		: mach_voucher_attr_key_t;
+		command		: mach_voucher_attr_command_t;
+		in_content	: mach_voucher_attr_content_t;
+	out	out_content	: mach_voucher_attr_content_t, CountInOut);
+
+/* extract a recipe array to reconstitue all the key values in a future voucher */
+routine mach_voucher_debug_info(
+		task		: ipc_space_t;
+		voucher_name: mach_port_name_t;
+	out	recipes		: mach_voucher_attr_raw_recipe_array_t, CountInOut);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/mach_voucher.h cctools-877.5-AnV/include/mach/mach_voucher.h
--- cctools-877.5/include/mach/mach_voucher.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_voucher.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,317 @@
+#ifndef	_mach_voucher_user_
+#define	_mach_voucher_user_
+
+/* Module mach_voucher */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	mach_voucher_MSG_COUNT
+#define	mach_voucher_MSG_COUNT	5
+#endif	/* mach_voucher_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine mach_voucher_extract_attr_content */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_voucher_extract_attr_content
+(
+	ipc_voucher_t voucher,
+	mach_voucher_attr_key_t key,
+	mach_voucher_attr_content_t content,
+	mach_msg_type_number_t *contentCnt
+);
+
+/* Routine mach_voucher_extract_attr_recipe */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_voucher_extract_attr_recipe
+(
+	ipc_voucher_t voucher,
+	mach_voucher_attr_key_t key,
+	mach_voucher_attr_raw_recipe_t recipe,
+	mach_msg_type_number_t *recipeCnt
+);
+
+/* Routine mach_voucher_extract_all_attr_recipes */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_voucher_extract_all_attr_recipes
+(
+	ipc_voucher_t voucher,
+	mach_voucher_attr_raw_recipe_array_t recipes,
+	mach_msg_type_number_t *recipesCnt
+);
+
+/* Routine mach_voucher_attr_command */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_voucher_attr_command
+(
+	ipc_voucher_t voucher,
+	mach_voucher_attr_key_t key,
+	mach_voucher_attr_command_t command,
+	mach_voucher_attr_content_t in_content,
+	mach_msg_type_number_t in_contentCnt,
+	mach_voucher_attr_content_t out_content,
+	mach_msg_type_number_t *out_contentCnt
+);
+
+/* Routine mach_voucher_debug_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_voucher_debug_info
+(
+	ipc_space_t task,
+	mach_port_name_t voucher_name,
+	mach_voucher_attr_raw_recipe_array_t recipes,
+	mach_msg_type_number_t *recipesCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__mach_voucher_subsystem__defined
+#define __Request__mach_voucher_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_voucher_attr_key_t key;
+		mach_msg_type_number_t contentCnt;
+	} __Request__mach_voucher_extract_attr_content_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_voucher_attr_key_t key;
+		mach_msg_type_number_t recipeCnt;
+	} __Request__mach_voucher_extract_attr_recipe_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_msg_type_number_t recipesCnt;
+	} __Request__mach_voucher_extract_all_attr_recipes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_voucher_attr_key_t key;
+		mach_voucher_attr_command_t command;
+		mach_msg_type_number_t in_contentCnt;
+		uint8_t in_content[4096];
+		mach_msg_type_number_t out_contentCnt;
+	} __Request__mach_voucher_attr_command_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t voucher_name;
+		mach_msg_type_number_t recipesCnt;
+	} __Request__mach_voucher_debug_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__mach_voucher_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__mach_voucher_subsystem__defined
+#define __RequestUnion__mach_voucher_subsystem__defined
+union __RequestUnion__mach_voucher_subsystem {
+	__Request__mach_voucher_extract_attr_content_t Request_mach_voucher_extract_attr_content;
+	__Request__mach_voucher_extract_attr_recipe_t Request_mach_voucher_extract_attr_recipe;
+	__Request__mach_voucher_extract_all_attr_recipes_t Request_mach_voucher_extract_all_attr_recipes;
+	__Request__mach_voucher_attr_command_t Request_mach_voucher_attr_command;
+	__Request__mach_voucher_debug_info_t Request_mach_voucher_debug_info;
+};
+#endif /* !__RequestUnion__mach_voucher_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__mach_voucher_subsystem__defined
+#define __Reply__mach_voucher_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t contentCnt;
+		uint8_t content[4096];
+	} __Reply__mach_voucher_extract_attr_content_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t recipeCnt;
+		uint8_t recipe[4096];
+	} __Reply__mach_voucher_extract_attr_recipe_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t recipesCnt;
+		uint8_t recipes[5120];
+	} __Reply__mach_voucher_extract_all_attr_recipes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t out_contentCnt;
+		uint8_t out_content[4096];
+	} __Reply__mach_voucher_attr_command_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t recipesCnt;
+		uint8_t recipes[5120];
+	} __Reply__mach_voucher_debug_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__mach_voucher_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__mach_voucher_subsystem__defined
+#define __ReplyUnion__mach_voucher_subsystem__defined
+union __ReplyUnion__mach_voucher_subsystem {
+	__Reply__mach_voucher_extract_attr_content_t Reply_mach_voucher_extract_attr_content;
+	__Reply__mach_voucher_extract_attr_recipe_t Reply_mach_voucher_extract_attr_recipe;
+	__Reply__mach_voucher_extract_all_attr_recipes_t Reply_mach_voucher_extract_all_attr_recipes;
+	__Reply__mach_voucher_attr_command_t Reply_mach_voucher_attr_command;
+	__Reply__mach_voucher_debug_info_t Reply_mach_voucher_debug_info;
+};
+#endif /* !__RequestUnion__mach_voucher_subsystem__defined */
+
+#ifndef subsystem_to_name_map_mach_voucher
+#define subsystem_to_name_map_mach_voucher \
+    { "mach_voucher_extract_attr_content", 5400 },\
+    { "mach_voucher_extract_attr_recipe", 5401 },\
+    { "mach_voucher_extract_all_attr_recipes", 5402 },\
+    { "mach_voucher_attr_command", 5403 },\
+    { "mach_voucher_debug_info", 5404 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _mach_voucher_user_ */
diff -Nur cctools-877.5/include/mach/mach_voucher_attr_control.defs cctools-877.5-AnV/include/mach/mach_voucher_attr_control.defs
--- cctools-877.5/include/mach/mach_voucher_attr_control.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_voucher_attr_control.defs	2015-11-16 07:56:13 +0000
@@ -0,0 +1,48 @@
+/*
+ * Copyright (c) 2013 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		       mach_voucher_attr_control 5600;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+/* Extract the given voucher-control's value-handle from the supplied voucher */
+routine mach_voucher_attr_control_get_values(
+		control		: ipc_voucher_attr_control_t;
+		voucher		: ipc_voucher_t;
+	out	value_handles	: mach_voucher_attr_value_handle_array_t, CountInOut);
+
+/* Create a new voucher with the control's privilege (to directly assign value-handles) */
+routine mach_voucher_attr_control_create_mach_voucher(
+		control		: ipc_voucher_attr_control_t;
+		recipes		: mach_voucher_attr_raw_recipe_array_t;
+	out	voucher		: ipc_voucher_t);
diff -Nur cctools-877.5/include/mach/mach_voucher_types.h cctools-877.5-AnV/include/mach/mach_voucher_types.h
--- cctools-877.5/include/mach/mach_voucher_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mach_voucher_types.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,231 @@
+/*
+ * Copyright (c) 2013 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef	_MACH_VOUCHER_TYPES_H_
+#define	_MACH_VOUCHER_TYPES_H_
+
+#include <mach/std_types.h>
+#include <mach/port.h>
+
+/*
+ * Mach Voucher - an immutable collection of attribute value handles.
+ *
+ * The mach voucher is such that it can be passed between processes
+ * as a Mach port send right (by convention in the mach_msg_header_ts
+ * msgh_voucher field).
+ *
+ * You may construct a new mach voucher by passing a construction
+ * recipe to host_create_mach_voucher().  The construction recipe supports
+ * generic commands for copying, removing, and redeeming attribute value
+ * handles from previous vouchers, or running attribute-mananger-specific
+ * commands within the recipe.
+ *
+ * Once the set of attribute value handles is constructed and returned,
+ * that set will not change for the life of the voucher (just because the
+ * attribute value handle itself doesn't change, the value the handle refers
+ * to is free to change at will).
+ */
+typedef mach_port_t		mach_voucher_t;
+#define MACH_VOUCHER_NULL	((mach_voucher_t) 0)
+
+typedef mach_port_name_t	mach_voucher_name_t;
+#define MACH_VOUCHER_NAME_NULL	((mach_voucher_name_t) 0)
+
+typedef mach_voucher_name_t	*mach_voucher_name_array_t;
+#define MACH_VOUCHER_NAME_ARRAY_NULL ((mach_voucher_name_array_t) 0)
+
+/*
+ * This type changes appearance between user-space and kernel.  It is
+ * a port at user-space and a reference to an ipc_voucher structure in-kernel.
+ */
+typedef mach_voucher_t		ipc_voucher_t;
+#define IPC_VOUCHER_NULL	((ipc_voucher_t) 0)
+
+/*
+ * mach_voucher_selector_t - A means of specifying which thread/task value to extract -
+ *  the current voucher set at this level, or a voucher representing
+ * the full [layered] effective value for the task/thread.
+ */
+typedef uint32_t mach_voucher_selector_t;
+#define MACH_VOUCHER_SELECTOR_CURRENT 		((mach_voucher_selector_t)0)
+#define MACH_VOUCHER_SELECTOR_EFFECTIVE 	((mach_voucher_selector_t)1)
+
+
+/*
+ * mach_voucher_attr_key_t - The key used to identify a particular managed resource or
+ * to select the specific resource managers data associated
+ * with a given voucher.
+ */ 
+typedef uint32_t mach_voucher_attr_key_t;
+typedef mach_voucher_attr_key_t *mach_voucher_attr_key_array_t;
+
+#define MACH_VOUCHER_ATTR_KEY_ALL 		((mach_voucher_attr_key_t)~0)
+#define MACH_VOUCHER_ATTR_KEY_NONE 		((mach_voucher_attr_key_t)0)
+
+/* other well-known-keys will be added here */
+#define MACH_VOUCHER_ATTR_KEY_ATM		((mach_voucher_attr_key_t)1)
+#define MACH_VOUCHER_ATTR_KEY_IMPORTANCE	((mach_voucher_attr_key_t)2)
+#define MACH_VOUCHER_ATTR_KEY_BANK		((mach_voucher_attr_key_t)3)
+
+#define MACH_VOUCHER_ATTR_KEY_USER_DATA		((mach_voucher_attr_key_t)7)
+#define MACH_VOUCHER_ATTR_KEY_BITS		MACH_VOUCHER_ATTR_KEY_USER_DATA /* deprecated */
+#define MACH_VOUCHER_ATTR_KEY_TEST 		((mach_voucher_attr_key_t)8)
+
+#define MACH_VOUCHER_ATTR_KEY_NUM_WELL_KNOWN	MACH_VOUCHER_ATTR_KEY_TEST
+
+/*
+ * mach_voucher_attr_content_t
+ *
+ * Data passed to a resource manager for modifying an attribute
+ * value or returned from the resource manager in response to a
+ * request to externalize the current value for that attribute.
+ */
+typedef uint8_t *mach_voucher_attr_content_t;
+typedef uint32_t mach_voucher_attr_content_size_t;
+
+/*
+ * mach_voucher_attr_command_t - The private verbs implemented by each voucher
+ * attribute manager via mach_voucher_attr_command().
+ */
+typedef uint32_t mach_voucher_attr_command_t;
+
+/*
+ * mach_voucher_attr_recipe_command_t 
+ * 
+ * The verbs used to create/morph a voucher attribute value.
+ * We define some system-wide commands here - related to creation, and transport of
+ * vouchers and attributes.  Additional commands can be defined by, and supported by,
+ * individual attribute resource managers.
+ */
+typedef uint32_t mach_voucher_attr_recipe_command_t;
+typedef mach_voucher_attr_recipe_command_t *mach_voucher_attr_recipe_command_array_t;
+
+#define MACH_VOUCHER_ATTR_NOOP			((mach_voucher_attr_recipe_command_t)0)
+#define MACH_VOUCHER_ATTR_COPY 			((mach_voucher_attr_recipe_command_t)1)
+#define MACH_VOUCHER_ATTR_REMOVE		((mach_voucher_attr_recipe_command_t)2)
+#define MACH_VOUCHER_ATTR_SET_VALUE_HANDLE	((mach_voucher_attr_recipe_command_t)3)
+
+/* redeem is on its way out? */
+#define MACH_VOUCHER_ATTR_REDEEM 		((mach_voucher_attr_recipe_command_t)10)
+
+/* recipe command(s) for importance attribute manager */
+#define MACH_VOUCHER_ATTR_IMPORTANCE_SELF	((mach_voucher_attr_recipe_command_t)200)
+
+/* recipe command(s) for bit-store attribute manager */
+#define MACH_VOUCHER_ATTR_USER_DATA_STORE 	((mach_voucher_attr_recipe_command_t)211)
+#define MACH_VOUCHER_ATTR_BITS_STORE 		MACH_VOUCHER_ATTR_USER_DATA_STORE /* deprecated */
+
+/* recipe command(s) for test attribute manager */
+#define MACH_VOUCHER_ATTR_TEST_STORE 		MACH_VOUCHER_ATTR_USER_DATA_STORE
+
+/*
+ * mach_voucher_attr_recipe_t
+ *
+ * An element in a recipe list to create a voucher.
+ */
+#pragma pack(1)
+
+typedef struct mach_voucher_attr_recipe_data {
+	mach_voucher_attr_key_t	                key;
+	mach_voucher_attr_recipe_command_t      command;
+	mach_voucher_name_t                     previous_voucher;
+	mach_voucher_attr_content_size_t	content_size;
+	uint8_t				        content[];
+} mach_voucher_attr_recipe_data_t;
+typedef mach_voucher_attr_recipe_data_t *mach_voucher_attr_recipe_t;
+typedef mach_msg_type_number_t mach_voucher_attr_recipe_size_t;
+
+/* Make the above palatable to MIG */
+typedef uint8_t *mach_voucher_attr_raw_recipe_t;
+typedef mach_voucher_attr_raw_recipe_t mach_voucher_attr_raw_recipe_array_t;
+typedef mach_msg_type_number_t mach_voucher_attr_raw_recipe_size_t;
+typedef mach_msg_type_number_t mach_voucher_attr_raw_recipe_array_size_t;
+
+#pragma pack()
+
+/*
+ * VOUCHER ATTRIBUTE MANAGER Writer types
+ */
+ 
+/*
+ * mach_voucher_attr_manager_t
+ *
+ * A handle through which the mach voucher mechanism communicates with the voucher
+ * attribute manager for a given attribute key.
+ */
+typedef mach_port_t			mach_voucher_attr_manager_t;
+#define MACH_VOUCHER_ATTR_MANAGER_NULL  ((mach_voucher_attr_manager_t) 0)
+
+/*
+ * mach_voucher_attr_control_t
+ *
+ * A handle provided to the voucher attribute manager for a given attribute key
+ * through which it makes inquiries or control operations of the mach voucher mechanism.
+ */
+typedef mach_port_t			mach_voucher_attr_control_t;
+#define MACH_VOUCHER_ATTR_CONTROL_NULL  ((mach_voucher_attr_control_t) 0)
+
+/*
+ * These types are different in-kernel vs user-space.  They are ports in user-space,
+ * pointers to opaque structs in most of the kernel, and pointers to known struct
+ * types in the Mach portion of the kernel.
+ */
+typedef mach_port_t		ipc_voucher_attr_manager_t;
+typedef mach_port_t		ipc_voucher_attr_control_t;
+#define IPC_VOUCHER_ATTR_MANAGER_NULL ((ipc_voucher_attr_manager_t) 0)
+#define IPC_VOUCHER_ATTR_CONTROL_NULL ((ipc_voucher_attr_control_t) 0)
+
+/*
+ * mach_voucher_attr_value_handle_t
+ * 
+ * The private handle that the voucher attribute manager provides to
+ * the mach voucher mechanism to represent a given attr content/value.
+ */ 
+typedef uint64_t mach_voucher_attr_value_handle_t;
+typedef mach_voucher_attr_value_handle_t *mach_voucher_attr_value_handle_array_t;
+
+typedef mach_msg_type_number_t mach_voucher_attr_value_handle_array_size_t;
+#define MACH_VOUCHER_ATTR_VALUE_MAX_NESTED 	((mach_voucher_attr_value_handle_array_size_t)4)
+
+typedef uint32_t mach_voucher_attr_value_reference_t;
+
+/* USE - TBD */
+typedef uint32_t mach_voucher_attr_control_flags_t;
+#define MACH_VOUCHER_ATTR_CONTROL_FLAGS_NONE 	((mach_voucher_attr_control_flags_t)0)
+
+/*
+ * Commands and types for the IPC Importance Attribute Manager
+ *
+ * These are the valid mach_voucher_attr_command() options with the 
+ * MACH_VOUCHER_ATTR_KEY_IMPORTANCE key.
+ */
+#define MACH_VOUCHER_IMPORTANCE_ATTR_ADD_EXTERNAL       1  /* Add some number of external refs (not supported) */
+#define MACH_VOUCHER_IMPORTANCE_ATTR_DROP_EXTERNAL      2  /* Drop some number of external refs */
+typedef uint32_t mach_voucher_attr_importance_refs;
+
+#endif	/* _MACH_VOUCHER_TYPES_H_ */
diff -Nur cctools-877.5/include/mach/machine/asm.h cctools-877.5-AnV/include/mach/machine/asm.h
--- cctools-877.5/include/mach/machine/asm.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/asm.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,38 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_ASM_H
+#define _MACH_MACHINE_ASM_H
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/asm.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_ASM_H */
diff -Nur cctools-877.5/include/mach/machine/boolean.h cctools-877.5-AnV/include/mach/machine/boolean.h
--- cctools-877.5/include/mach/machine/boolean.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/boolean.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,38 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_BOOLEAN_H_
+#define _MACH_MACHINE_BOOLEAN_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/boolean.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_BOOLEAN_H_ */
diff -Nur cctools-877.5/include/mach/machine/exception.h cctools-877.5-AnV/include/mach/machine/exception.h
--- cctools-877.5/include/mach/machine/exception.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/exception.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,38 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_EXCEPTION_H_
+#define _MACH_MACHINE_EXCEPTION_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/exception.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_EXCEPTION_H_ */
diff -Nur cctools-877.5/include/mach/machine/kern_return.h cctools-877.5-AnV/include/mach/machine/kern_return.h
--- cctools-877.5/include/mach/machine/kern_return.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/kern_return.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,38 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_KERN_RETURN_H_
+#define _MACH_MACHINE_KERN_RETURN_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/kern_return.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_KERN_RETURN_H_ */
diff -Nur cctools-877.5/include/mach/machine/machine_types.defs cctools-877.5-AnV/include/mach/machine/machine_types.defs
--- cctools-877.5/include/mach/machine/machine_types.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/machine_types.defs	2015-11-16 07:56:13 +0000
@@ -0,0 +1,130 @@
+/*
+ * Copyright (c) 2000-2007 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+/*
+ *	Header file for basic, machine-dependent data types.  arm+i386 version.
+ */
+ 
+#ifndef _MACH_MACHINE_MACHNINE_TYPES_DEFS
+#define _MACH_MACHINE_MACHNINE_TYPES_DEFS
+
+type short = int16_t;
+type int = int32_t;
+type unsigned = uint32_t;
+
+type float = MACH_MSG_TYPE_REAL_32;
+type double = MACH_MSG_TYPE_REAL_64;
+
+
+/* from ISO/IEC 988:1999 spec */
+/* 7.18.1.4 Integer types capable of hgolding object pointers */
+/*
+ * The [u]intptr_t types for the native
+ * integer type, e.g. 32 or 64 or.. whatever
+ * register size the machine has.  They are
+ * used for entities that might be either
+ * [unsigned] integers or pointers, and for
+ * type-casting between the two.
+ *
+ * For instance, the IPC system represents
+ * a port in user space as an integer and
+ * in kernel space as a pointer.
+ */
+#if defined(__LP64__)
+type uintptr_t = uint64_t;
+type intptr_t = int64_t;
+#else
+type uintptr_t = uint32_t;
+type intptr_t = int32_t;
+#endif
+
+/*
+ * These are the legacy Mach types that are
+ * the [rough] equivalents of the standards above.
+ * They were defined in terms of int, not
+ * long int, so they remain separate.
+ */
+#if defined(__LP64__)
+type register_t = int64_t;
+#else
+type register_t = int32_t;
+#endif
+type integer_t = int32_t;
+type natural_t = uint32_t;
+
+/*
+ * These are the VM types that scale with the address
+ * space size of a given process.
+ */
+
+#if defined(__LP64__)
+type vm_address_t = uint64_t;
+type vm_offset_t = uint64_t;
+type vm_size_t = uint64_t;
+#else
+type vm_address_t = natural_t;
+type vm_offset_t = natural_t;
+type vm_size_t = natural_t;
+#endif
+
+/* This is a bit of a hack for arm.  We implement the backend with a wide type, but present a native-sized type to callers */
+type mach_port_context_t = uint64_t;
+
+/*
+ * The mach_vm_xxx_t types are sized to hold the
+ * maximum pointer, offset, etc... supported on the
+ * platform.
+ */
+type mach_vm_address_t = uint64_t;
+type mach_vm_offset_t = uint64_t;
+type mach_vm_size_t = uint64_t;
+
+#if	MACH_IPC_COMPAT
+/*
+ * For the old IPC interface
+ */
+#define	MSG_TYPE_PORT_NAME	natural_t
+
+#endif	/* MACH_IPC_COMPAT */
+
+/*
+ * These are types used internal to Mach to implement the
+ * legacy 32-bit VM APIs published by the kernel.
+ */
+#define	VM32_SUPPORT	1
+
+type vm32_address_t = uint32_t;
+type vm32_offset_t = uint32_t;
+type vm32_size_t = uint32_t;
+
+#endif /* _MACH_MACHINE_MACHNINE_TYPES_DEFS */
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/machine/ndr_def.h cctools-877.5-AnV/include/mach/machine/ndr_def.h
--- cctools-877.5/include/mach/machine/ndr_def.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/ndr_def.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,38 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_NDR_DEF_H
+#define _MACH_MACHINE_NDR_DEF_H
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/ndr_def.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_NDR_DEF_H */
diff -Nur cctools-877.5/include/mach/machine/processor_info.h cctools-877.5-AnV/include/mach/machine/processor_info.h
--- cctools-877.5/include/mach/machine/processor_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/processor_info.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,38 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_PROCESSOR_INFO_H_
+#define _MACH_MACHINE_PROCESSOR_INFO_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/processor_info.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_PROCESSOR_INFO_H_ */
diff -Nur cctools-877.5/include/mach/machine/rpc.h cctools-877.5-AnV/include/mach/machine/rpc.h
--- cctools-877.5/include/mach/machine/rpc.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/rpc.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,38 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_RPC_H_
+#define _MACH_MACHINE_RPC_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/rpc.h"
+#else
+#error architecture not supported
+#endif
+
+#endif	/* _MACH_MACHINE_RPC_H_ */
diff -Nur cctools-877.5/include/mach/machine/sdt.h cctools-877.5-AnV/include/mach/machine/sdt.h
--- cctools-877.5/include/mach/machine/sdt.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/sdt.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,36 @@
+/*
+ * Copyright (c) 2007 Apple Inc. All rights reserved.
+ */
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License, Version 1.0 only
+ * (the "License").  You may not use this file except in compliance
+ * with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+/*
+ * Copyright 2004 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef _MACH_MACHINE_SYS_SDT_H
+#define	_MACH_MACHINE_SYS_SDT_H
+
+#include <mach/machine/sdt_isa.h>
+
+
+#endif	/* _MACH_MACHINE_SYS_SDT_H */
diff -Nur cctools-877.5/include/mach/machine/sdt_isa.h cctools-877.5-AnV/include/mach/machine/sdt_isa.h
--- cctools-877.5/include/mach/machine/sdt_isa.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/sdt_isa.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _MACH_MACHINE_SDT_ISA_H_
+#define _MACH_MACHINE_SDT_ISA_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include <mach/i386/sdt_isa.h>
+#else
+#error architecture not supported
+#endif
+
+#endif /* _BSD_MACHINE_SDT_ISA_H_ */
diff -Nur cctools-877.5/include/mach/machine/thread_state.h cctools-877.5-AnV/include/mach/machine/thread_state.h
--- cctools-877.5/include/mach/machine/thread_state.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/thread_state.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,38 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_THREAD_STATE_H_
+#define _MACH_MACHINE_THREAD_STATE_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/thread_state.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_THREAD_STATE_H_ */
diff -Nur cctools-877.5/include/mach/machine/thread_status.h cctools-877.5-AnV/include/mach/machine/thread_status.h
--- cctools-877.5/include/mach/machine/thread_status.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/thread_status.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,38 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_THREAD_STATUS_H_
+#define _MACH_MACHINE_THREAD_STATUS_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/thread_status.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_THREAD_STATUS_H_ */
diff -Nur cctools-877.5/include/mach/machine/vm_param.h cctools-877.5-AnV/include/mach/machine/vm_param.h
--- cctools-877.5/include/mach/machine/vm_param.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/vm_param.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,38 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_VM_PARAM_H_
+#define _MACH_MACHINE_VM_PARAM_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/vm_param.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_VM_PARAM_H_ */
diff -Nur cctools-877.5/include/mach/machine/vm_types.h cctools-877.5-AnV/include/mach/machine/vm_types.h
--- cctools-877.5/include/mach/machine/vm_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/machine/vm_types.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,38 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_VM_TYPES_H_
+#define _MACH_MACHINE_VM_TYPES_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/vm_types.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_VM_TYPES_H_ */
diff -Nur cctools-877.5/include/mach/memory_object_types.h cctools-877.5-AnV/include/mach/memory_object_types.h
--- cctools-877.5/include/mach/memory_object_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/memory_object_types.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,275 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	memory_object.h
+ *	Author:	Michael Wayne Young
+ *
+ *	External memory management interface definition.
+ */
+
+#ifndef	_MACH_MEMORY_OBJECT_TYPES_H_
+#define _MACH_MEMORY_OBJECT_TYPES_H_
+
+/*
+ *	User-visible types used in the external memory
+ *	management interface:
+ */
+
+#include <mach/port.h>
+#include <mach/message.h>
+#include <mach/vm_prot.h>
+#include <mach/vm_sync.h>
+#include <mach/vm_types.h>
+#include <mach/machine/vm_types.h>
+
+#include <sys/cdefs.h>
+
+#define VM_64_BIT_DATA_OBJECTS
+
+typedef unsigned long long	memory_object_offset_t;
+typedef unsigned long long	memory_object_size_t;
+typedef natural_t		memory_object_cluster_size_t;
+typedef natural_t *		memory_object_fault_info_t;
+
+typedef unsigned long long 	vm_object_id_t;
+
+
+/*
+ * Temporary until real EMMI version gets re-implemented
+ */
+
+
+typedef mach_port_t	memory_object_t;
+typedef mach_port_t	memory_object_control_t;
+
+
+typedef memory_object_t *memory_object_array_t;
+					/* A memory object ... */
+					/*  Used by the kernel to retrieve */
+					/*  or store data */
+
+typedef	mach_port_t	memory_object_name_t;
+					/* Used to describe the memory ... */
+					/*  object in vm_regions() calls */
+
+typedef mach_port_t	memory_object_default_t;
+					/* Registered with the host ... */
+					/*  for creating new internal objects */
+
+#define MEMORY_OBJECT_NULL		((memory_object_t) 0)
+#define MEMORY_OBJECT_CONTROL_NULL	((memory_object_control_t) 0)
+#define MEMORY_OBJECT_NAME_NULL		((memory_object_name_t) 0)
+#define MEMORY_OBJECT_DEFAULT_NULL	((memory_object_default_t) 0)
+
+
+typedef	int		memory_object_copy_strategy_t;
+					/* How memory manager handles copy: */
+#define		MEMORY_OBJECT_COPY_NONE		0
+					/* ... No special support */
+#define		MEMORY_OBJECT_COPY_CALL		1
+					/* ... Make call on memory manager */
+#define		MEMORY_OBJECT_COPY_DELAY 	2
+					/* ... Memory manager doesn't
+					 *     change data externally.
+					 */
+#define		MEMORY_OBJECT_COPY_TEMPORARY 	3
+					/* ... Memory manager doesn't
+					 *     change data externally, and
+					 *     doesn't need to see changes.
+					 */
+#define		MEMORY_OBJECT_COPY_SYMMETRIC 	4
+					/* ... Memory manager doesn't
+					 *     change data externally,
+					 *     doesn't need to see changes,
+					 *     and object will not be
+					 *     multiply mapped.
+					 *
+					 *     XXX
+					 *     Not yet safe for non-kernel use.
+					 */
+
+#define		MEMORY_OBJECT_COPY_INVALID	5
+					/* ...	An invalid copy strategy,
+					 *	for external objects which
+					 *	have not been initialized.
+					 *	Allows copy_strategy to be
+					 *	examined without also
+					 *	examining pager_ready and
+					 *	internal.
+					 */
+
+typedef	int		memory_object_return_t;
+					/* Which pages to return to manager
+					   this time (lock_request) */
+#define		MEMORY_OBJECT_RETURN_NONE	0
+					/* ... don't return any. */
+#define		MEMORY_OBJECT_RETURN_DIRTY	1
+					/* ... only dirty pages. */
+#define		MEMORY_OBJECT_RETURN_ALL	2
+					/* ... dirty and precious pages. */
+#define		MEMORY_OBJECT_RETURN_ANYTHING	3
+					/* ... any resident page. */
+
+/* 
+ *	Data lock request flags
+ */
+
+#define		MEMORY_OBJECT_DATA_FLUSH 	0x1
+#define		MEMORY_OBJECT_DATA_NO_CHANGE	0x2
+#define		MEMORY_OBJECT_DATA_PURGE	0x4
+#define		MEMORY_OBJECT_COPY_SYNC		0x8
+#define		MEMORY_OBJECT_DATA_SYNC		0x10
+#define         MEMORY_OBJECT_IO_SYNC           0x20
+#define		MEMORY_OBJECT_DATA_FLUSH_ALL	0x40
+
+/*
+ *	Types for the memory object flavor interfaces
+ */
+
+#define MEMORY_OBJECT_INFO_MAX      (1024) 
+typedef int     *memory_object_info_t;      
+typedef int	 memory_object_flavor_t;
+typedef int      memory_object_info_data_t[MEMORY_OBJECT_INFO_MAX];
+
+
+#define MEMORY_OBJECT_PERFORMANCE_INFO	11
+#define MEMORY_OBJECT_ATTRIBUTE_INFO	14
+#define MEMORY_OBJECT_BEHAVIOR_INFO 	15	
+
+
+struct memory_object_perf_info {
+	memory_object_cluster_size_t	cluster_size;
+	boolean_t			may_cache;
+};
+
+struct memory_object_attr_info {
+	memory_object_copy_strategy_t	copy_strategy;
+	memory_object_cluster_size_t	cluster_size;
+	boolean_t			may_cache_object;
+	boolean_t			temporary;
+};
+
+struct memory_object_behave_info {
+	memory_object_copy_strategy_t	copy_strategy;	
+	boolean_t			temporary;
+	boolean_t			invalidate;
+	boolean_t			silent_overwrite;
+	boolean_t			advisory_pageout;
+};
+
+
+typedef struct memory_object_behave_info *memory_object_behave_info_t;
+typedef struct memory_object_behave_info memory_object_behave_info_data_t;
+
+typedef struct memory_object_perf_info 	*memory_object_perf_info_t;
+typedef struct memory_object_perf_info	memory_object_perf_info_data_t;
+
+typedef struct memory_object_attr_info	*memory_object_attr_info_t;
+typedef struct memory_object_attr_info	memory_object_attr_info_data_t;
+
+#define MEMORY_OBJECT_BEHAVE_INFO_COUNT ((mach_msg_type_number_t)	\
+                (sizeof(memory_object_behave_info_data_t)/sizeof(int)))
+#define MEMORY_OBJECT_PERF_INFO_COUNT	((mach_msg_type_number_t)	\
+		(sizeof(memory_object_perf_info_data_t)/sizeof(int)))
+#define MEMORY_OBJECT_ATTR_INFO_COUNT	((mach_msg_type_number_t)	\
+		(sizeof(memory_object_attr_info_data_t)/sizeof(int)))
+
+#define invalid_memory_object_flavor(f)					\
+	(f != MEMORY_OBJECT_ATTRIBUTE_INFO && 				\
+	 f != MEMORY_OBJECT_PERFORMANCE_INFO && 			\
+	 f != OLD_MEMORY_OBJECT_BEHAVIOR_INFO &&			\
+	 f != MEMORY_OBJECT_BEHAVIOR_INFO &&				\
+	 f != OLD_MEMORY_OBJECT_ATTRIBUTE_INFO)
+
+
+/*
+ * Used to support options on memory_object_release_name call
+ */
+#define MEMORY_OBJECT_TERMINATE_IDLE	0x1
+#define MEMORY_OBJECT_RESPECT_CACHE	0x2
+#define MEMORY_OBJECT_RELEASE_NO_OP	0x4
+
+
+/* named entry processor mapping options */
+/* enumerated */
+#define MAP_MEM_NOOP		0
+#define MAP_MEM_COPYBACK	1
+#define MAP_MEM_IO		2
+#define MAP_MEM_WTHRU		3
+#define MAP_MEM_WCOMB		4	/* Write combining mode */
+					/* aka store gather     */
+#define MAP_MEM_INNERWBACK	5
+
+#define GET_MAP_MEM(flags)	\
+	((((unsigned int)(flags)) >> 24) & 0xFF)
+
+#define SET_MAP_MEM(caching, flags)	\
+	((flags) = ((((unsigned int)(caching)) << 24) \
+			& 0xFF000000) | ((flags) & 0xFFFFFF));
+
+/* leave room for vm_prot bits */
+#define MAP_MEM_ONLY		0x010000 /* change processor caching  */
+#define MAP_MEM_NAMED_CREATE	0x020000 /* create extant object      */
+#define MAP_MEM_PURGABLE	0x040000 /* create a purgable VM object */
+#define MAP_MEM_NAMED_REUSE	0x080000 /* reuse provided entry if identical */
+#define MAP_MEM_USE_DATA_ADDR	0x100000 /* preserve address of data, rather than base of page */
+#define MAP_MEM_VM_COPY		0x200000 /* make a copy of a VM range */
+#define MAP_MEM_VM_SHARE	0x400000 /* extract a VM range for remap */
+
+
+#endif	/* _MACH_MEMORY_OBJECT_TYPES_H_ */
diff -Nur cctools-877.5/include/mach/message.h cctools-877.5-AnV/include/mach/message.h
--- cctools-877.5/include/mach/message.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/message.h	2015-11-16 07:56:13 +0000
@@ -0,0 +1,863 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ * NOTICE: This file was modified by McAfee Research in 2004 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ * Copyright (c) 2005 SPARTA, Inc.
+ */
+/*
+ */
+/*
+ *	File:	mach/message.h
+ *
+ *	Mach IPC message and primitive function definitions.
+ */
+
+#ifndef	_MACH_MESSAGE_H_
+#define _MACH_MESSAGE_H_
+
+#include <stdint.h>
+#include <mach/port.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/machine/vm_types.h>
+
+#include <sys/cdefs.h>
+#include <sys/appleapiopts.h>
+
+/*
+ *  The timeout mechanism uses mach_msg_timeout_t values,
+ *  passed by value.  The timeout units are milliseconds.
+ *  It is controlled with the MACH_SEND_TIMEOUT
+ *  and MACH_RCV_TIMEOUT options.
+ */
+
+typedef natural_t mach_msg_timeout_t;
+
+/*
+ *  The value to be used when there is no timeout.
+ *  (No MACH_SEND_TIMEOUT/MACH_RCV_TIMEOUT option.)
+ */
+
+#define MACH_MSG_TIMEOUT_NONE		((mach_msg_timeout_t) 0)
+
+/*
+ *  The kernel uses MACH_MSGH_BITS_COMPLEX as a hint.  If it isn't on, it
+ *  assumes the body of the message doesn't contain port rights or OOL
+ *  data.  The field is set in received messages.  A user task must
+ *  use caution in interpreting the body of a message if the bit isn't
+ *  on, because the mach_msg_type's in the body might "lie" about the
+ *  contents.  If the bit isn't on, but the mach_msg_types
+ *  in the body specify rights or OOL data, the behavior is undefined.
+ *  (Ie, an error may or may not be produced.)
+ *
+ *  The value of MACH_MSGH_BITS_REMOTE determines the interpretation
+ *  of the msgh_remote_port field.  It is handled like a msgt_name,
+ *  but must result in a send or send-once type right.
+ *
+ *  The value of MACH_MSGH_BITS_LOCAL determines the interpretation
+ *  of the msgh_local_port field.  It is handled like a msgt_name,
+ *  and also must result in a send or send-once type right.
+ *
+ *  The value of MACH_MSGH_BITS_VOUCHER determines the interpretation
+ *  of the msgh_voucher_port field.  It is handled like a msgt_name,
+ *  but must result in a send right (and the msgh_voucher_port field
+ *  must be the name of a send right to a Mach voucher kernel object.
+ *
+ *  MACH_MSGH_BITS() combines two MACH_MSG_TYPE_* values, for the remote
+ *  and local fields, into a single value suitable for msgh_bits.
+ *
+ *  MACH_MSGH_BITS_CIRCULAR should be zero; is is used internally.
+ *
+ *  The unused bits should be zero and are reserved for the kernel
+ *  or for future interface expansion.
+ */
+
+#define MACH_MSGH_BITS_ZERO		0x00000000
+
+#define MACH_MSGH_BITS_REMOTE_MASK	0x0000001f
+#define MACH_MSGH_BITS_LOCAL_MASK	0x00001f00
+#define MACH_MSGH_BITS_VOUCHER_MASK	0x001f0000
+
+#define	MACH_MSGH_BITS_PORTS_MASK		\
+		(MACH_MSGH_BITS_REMOTE_MASK |	\
+		 MACH_MSGH_BITS_LOCAL_MASK |	\
+		 MACH_MSGH_BITS_VOUCHER_MASK)
+
+#define MACH_MSGH_BITS_COMPLEX		0x80000000U	/* message is complex */
+
+#define MACH_MSGH_BITS_USER             0x801f1f1fU	/* allowed bits user->kernel */
+
+#define	MACH_MSGH_BITS_RAISEIMP		0x20000000U	/* importance raised due to msg */
+#define MACH_MSGH_BITS_DENAP		MACH_MSGH_BITS_RAISEIMP
+
+#define	MACH_MSGH_BITS_IMPHOLDASRT	0x10000000U	/* assertion help, userland private */
+#define MACH_MSGH_BITS_DENAPHOLDASRT	MACH_MSGH_BITS_IMPHOLDASRT
+
+#define	MACH_MSGH_BITS_CIRCULAR		0x10000000U	/* message circular, kernel private */
+
+#define	MACH_MSGH_BITS_USED		0xb01f1f1fU
+
+/* setter macros for the bits */
+#define MACH_MSGH_BITS(remote, local)  /* legacy */		\
+		((remote) | ((local) << 8))
+#define	MACH_MSGH_BITS_SET_PORTS(remote, local, voucher)	\
+	(((remote) & MACH_MSGH_BITS_REMOTE_MASK) | 		\
+	 (((local) << 8) & MACH_MSGH_BITS_LOCAL_MASK) | 	\
+	 (((voucher) << 16) & MACH_MSGH_BITS_VOUCHER_MASK))
+#define MACH_MSGH_BITS_SET(remote, local, voucher, other)	\
+	(MACH_MSGH_BITS_SET_PORTS((remote), (local), (voucher)) \
+	 | ((other) &~ MACH_MSGH_BITS_PORTS_MASK))
+
+/* getter macros for pulling values out of the bits field */
+#define	MACH_MSGH_BITS_REMOTE(bits)				\
+		((bits) & MACH_MSGH_BITS_REMOTE_MASK)
+#define	MACH_MSGH_BITS_LOCAL(bits)				\
+		(((bits) & MACH_MSGH_BITS_LOCAL_MASK) >> 8)
+#define	MACH_MSGH_BITS_VOUCHER(bits)				\
+		(((bits) & MACH_MSGH_BITS_VOUCHER_MASK) >> 16)
+#define	MACH_MSGH_BITS_PORTS(bits)				\
+	((bits) & MACH_MSGH_BITS_PORTS_MASK)
+#define	MACH_MSGH_BITS_OTHER(bits)				\
+		((bits) &~ MACH_MSGH_BITS_PORTS_MASK)
+
+/* checking macros */
+#define MACH_MSGH_BITS_HAS_REMOTE(bits)				\
+	(MACH_MSGH_BITS_REMOTE(bits) != MACH_MSGH_BITS_ZERO)
+#define MACH_MSGH_BITS_HAS_LOCAL(bits)				\
+	(MACH_MSGH_BITS_LOCAL(bits) != MACH_MSGH_BITS_ZERO)
+#define MACH_MSGH_BITS_HAS_VOUCHER(bits)			\
+	(MACH_MSGH_BITS_VOUCHER(bits) != MACH_MSGH_BITS_ZERO)
+#define MACH_MSGH_BITS_IS_COMPLEX(bits)				\
+	(((bits) & MACH_MSGH_BITS_COMPLEX) != MACH_MSGH_BITS_ZERO)
+
+/* importance checking macros */
+#define MACH_MSGH_BITS_RAISED_IMPORTANCE(bits)			\
+	(((bits) & MACH_MSGH_BITS_RAISEIMP) != MACH_MSGH_BITS_ZERO)
+#define MACH_MSGH_BITS_HOLDS_IMPORTANCE_ASSERTION(bits)		\
+	(((bits) & MACH_MSGH_BITS_IMPHOLDASRT) != MACH_MSGH_BITS_ZERO)
+
+/*
+ *  Every message starts with a message header.
+ *  Following the message header, if the message is complex, are a count
+ *  of type descriptors and the type descriptors themselves 
+ *  (mach_msg_descriptor_t). The size of the message must be specified in 
+ *  bytes, and includes the message header, descriptor count, descriptors, 
+ *  and inline data.
+ *
+ *  The msgh_remote_port field specifies the destination of the message.
+ *  It must specify a valid send or send-once right for a port.
+ *
+ *  The msgh_local_port field specifies a "reply port".  Normally,
+ *  This field carries a send-once right that the receiver will use
+ *  to reply to the message.  It may carry the values MACH_PORT_NULL,
+ *  MACH_PORT_DEAD, a send-once right, or a send right.
+ *
+ *  The msgh_voucher_port field specifies a Mach voucher port. Only
+ *  send rights to kernel-implemented Mach Voucher kernel objects in
+ *  addition to MACH_PORT_NULL or MACH_PORT_DEAD may be passed.
+ *
+ *  The msgh_id field is uninterpreted by the message primitives.
+ *  It normally carries information specifying the format
+ *  or meaning of the message.
+ */
+
+typedef unsigned int mach_msg_bits_t;
+typedef	natural_t mach_msg_size_t;
+typedef integer_t mach_msg_id_t;
+
+
+#define MACH_MSG_SIZE_NULL (mach_msg_size_t *) 0
+
+typedef unsigned int mach_msg_type_name_t;
+
+#define MACH_MSG_TYPE_MOVE_RECEIVE	16	/* Must hold receive right */
+#define MACH_MSG_TYPE_MOVE_SEND		17	/* Must hold send right(s) */
+#define MACH_MSG_TYPE_MOVE_SEND_ONCE	18	/* Must hold sendonce right */
+#define MACH_MSG_TYPE_COPY_SEND		19	/* Must hold send right(s) */
+#define MACH_MSG_TYPE_MAKE_SEND		20	/* Must hold receive right */
+#define MACH_MSG_TYPE_MAKE_SEND_ONCE	21	/* Must hold receive right */
+#define MACH_MSG_TYPE_COPY_RECEIVE	22	/* NOT VALID */
+#define MACH_MSG_TYPE_DISPOSE_RECEIVE	24	/* must hold receive right */
+#define MACH_MSG_TYPE_DISPOSE_SEND	25	/* must hold send right(s) */
+#define MACH_MSG_TYPE_DISPOSE_SEND_ONCE 26	/* must hold sendonce right */
+
+typedef unsigned int mach_msg_copy_options_t;
+
+#define MACH_MSG_PHYSICAL_COPY		0
+#define MACH_MSG_VIRTUAL_COPY   	1
+#define MACH_MSG_ALLOCATE		2
+#define MACH_MSG_OVERWRITE		3
+#ifdef  MACH_KERNEL
+#define MACH_MSG_KALLOC_COPY_T		4
+#endif  /* MACH_KERNEL */
+
+/*
+ * In a complex mach message, the mach_msg_header_t is followed by 
+ * a descriptor count, then an array of that number of descriptors 
+ * (mach_msg_*_descriptor_t). The type field of mach_msg_type_descriptor_t
+ * (which any descriptor can be cast to) indicates the flavor of the
+ * descriptor.
+ *
+ * Note that in LP64, the various types of descriptors are no longer all
+ * the same size as mach_msg_descriptor_t, so the array cannot be indexed 
+ * as expected.
+ */
+
+typedef unsigned int mach_msg_descriptor_type_t;
+
+#define MACH_MSG_PORT_DESCRIPTOR 		0
+#define MACH_MSG_OOL_DESCRIPTOR  		1
+#define MACH_MSG_OOL_PORTS_DESCRIPTOR 		2
+#define MACH_MSG_OOL_VOLATILE_DESCRIPTOR  	3
+
+#pragma pack(4)
+
+typedef struct
+{
+  natural_t			pad1;
+  mach_msg_size_t		pad2;
+  unsigned int			pad3 : 24;
+  mach_msg_descriptor_type_t	type : 8;
+} mach_msg_type_descriptor_t;
+
+typedef struct
+{
+  mach_port_t			name;
+// Pad to 8 bytes everywhere except the K64 kernel where mach_port_t is 8 bytes
+  mach_msg_size_t		pad1;
+  unsigned int			pad2 : 16;
+  mach_msg_type_name_t		disposition : 8;
+  mach_msg_descriptor_type_t	type : 8;
+} mach_msg_port_descriptor_t;
+
+typedef struct
+{
+  uint32_t			address;
+  mach_msg_size_t       	size;
+  boolean_t     		deallocate: 8;
+  mach_msg_copy_options_t       copy: 8;
+  unsigned int     		pad1: 8;
+  mach_msg_descriptor_type_t    type: 8;
+} mach_msg_ool_descriptor32_t;
+
+typedef struct
+{
+  uint64_t			address;
+  boolean_t     		deallocate: 8;
+  mach_msg_copy_options_t       copy: 8;
+  unsigned int     		pad1: 8;
+  mach_msg_descriptor_type_t    type: 8;
+  mach_msg_size_t       	size;
+} mach_msg_ool_descriptor64_t;
+
+typedef struct
+{
+  void*				address;
+#if !defined(__LP64__)
+  mach_msg_size_t       	size;
+#endif
+  boolean_t     		deallocate: 8;
+  mach_msg_copy_options_t       copy: 8;
+  unsigned int     		pad1: 8;
+  mach_msg_descriptor_type_t    type: 8;
+#if defined(__LP64__)
+  mach_msg_size_t       	size;
+#endif
+} mach_msg_ool_descriptor_t;
+
+typedef struct
+{
+  uint32_t			address;
+  mach_msg_size_t		count;
+  boolean_t     		deallocate: 8;
+  mach_msg_copy_options_t       copy: 8;
+  mach_msg_type_name_t		disposition : 8;
+  mach_msg_descriptor_type_t	type : 8;
+} mach_msg_ool_ports_descriptor32_t;
+
+typedef struct
+{
+  uint64_t			address;
+  boolean_t     		deallocate: 8;
+  mach_msg_copy_options_t       copy: 8;
+  mach_msg_type_name_t		disposition : 8;
+  mach_msg_descriptor_type_t	type : 8;
+  mach_msg_size_t		count;
+} mach_msg_ool_ports_descriptor64_t;
+
+typedef struct
+{
+  void*				address;
+#if !defined(__LP64__)
+  mach_msg_size_t		count;
+#endif
+  boolean_t     		deallocate: 8;
+  mach_msg_copy_options_t       copy: 8;
+  mach_msg_type_name_t		disposition : 8;
+  mach_msg_descriptor_type_t	type : 8;
+#if defined(__LP64__)
+  mach_msg_size_t		count;
+#endif
+} mach_msg_ool_ports_descriptor_t;
+
+/*
+ * LP64support - This union definition is not really
+ * appropriate in LP64 mode because not all descriptors
+ * are of the same size in that environment.
+ */
+typedef union
+{
+  mach_msg_port_descriptor_t		port;
+  mach_msg_ool_descriptor_t		out_of_line;
+  mach_msg_ool_ports_descriptor_t	ool_ports;
+  mach_msg_type_descriptor_t		type;
+} mach_msg_descriptor_t;
+
+typedef struct
+{
+        mach_msg_size_t msgh_descriptor_count;
+} mach_msg_body_t;
+
+#define MACH_MSG_BODY_NULL (mach_msg_body_t *) 0
+#define MACH_MSG_DESCRIPTOR_NULL (mach_msg_descriptor_t *) 0
+
+typedef	struct 
+{
+  mach_msg_bits_t	msgh_bits;
+  mach_msg_size_t	msgh_size;
+  mach_port_t		msgh_remote_port;
+  mach_port_t		msgh_local_port;
+  mach_port_name_t	msgh_voucher_port;
+  mach_msg_id_t		msgh_id;
+} mach_msg_header_t;
+
+#define	msgh_reserved		msgh_voucher_port
+#define MACH_MSG_NULL	(mach_msg_header_t *) 0
+
+typedef struct
+{
+        mach_msg_header_t       header;
+        mach_msg_body_t         body;
+} mach_msg_base_t;
+
+typedef	unsigned int mach_msg_trailer_type_t;
+
+#define	MACH_MSG_TRAILER_FORMAT_0	0
+
+typedef	unsigned int mach_msg_trailer_size_t;
+typedef char *mach_msg_trailer_info_t;
+
+typedef struct 
+{
+  mach_msg_trailer_type_t	msgh_trailer_type;
+  mach_msg_trailer_size_t	msgh_trailer_size;
+} mach_msg_trailer_t;
+
+/*
+ *  The msgh_seqno field carries a sequence number
+ *  associated with the received-from port.  A port's
+ *  sequence number is incremented every time a message
+ *  is received from it and included in the received
+ *  trailer to help put messages back in sequence if
+ *  multiple threads receive and/or process received
+ *  messages.
+ */
+typedef struct
+{
+  mach_msg_trailer_type_t       msgh_trailer_type;
+  mach_msg_trailer_size_t       msgh_trailer_size;
+  mach_port_seqno_t             msgh_seqno;
+} mach_msg_seqno_trailer_t;
+
+typedef struct
+{
+  unsigned int			val[2];
+} security_token_t;
+
+typedef struct 
+{
+  mach_msg_trailer_type_t	msgh_trailer_type;
+  mach_msg_trailer_size_t	msgh_trailer_size;
+  mach_port_seqno_t		msgh_seqno;
+  security_token_t		msgh_sender;
+} mach_msg_security_trailer_t;
+
+/*
+ * The audit token is an opaque token which identifies
+ * Mach tasks and senders of Mach messages as subjects
+ * to the BSM audit system.  Only the appropriate BSM
+ * library routines should be used to interpret the
+ * contents of the audit token as the representation
+ * of the subject identity within the token may change
+ * over time.
+ */
+typedef struct
+{
+  unsigned int			val[8];
+} audit_token_t;
+
+typedef struct 
+{
+  mach_msg_trailer_type_t	msgh_trailer_type;
+  mach_msg_trailer_size_t	msgh_trailer_size;
+  mach_port_seqno_t		msgh_seqno;
+  security_token_t		msgh_sender;
+  audit_token_t			msgh_audit;
+} mach_msg_audit_trailer_t;
+
+typedef struct 
+{
+  mach_msg_trailer_type_t	msgh_trailer_type;
+  mach_msg_trailer_size_t	msgh_trailer_size;
+  mach_port_seqno_t		msgh_seqno;
+  security_token_t		msgh_sender;
+  audit_token_t			msgh_audit;
+  mach_port_context_t		msgh_context;
+} mach_msg_context_trailer_t;
+
+
+
+typedef struct
+{
+  mach_port_name_t sender;
+} msg_labels_t;
+
+/* 
+   Trailer type to pass MAC policy label info as a mach message trailer.
+   
+*/
+
+typedef struct
+{
+  mach_msg_trailer_type_t       msgh_trailer_type;
+  mach_msg_trailer_size_t       msgh_trailer_size;
+  mach_port_seqno_t             msgh_seqno;
+  security_token_t              msgh_sender;
+  audit_token_t                 msgh_audit;
+  mach_port_context_t		msgh_context;
+  int				msgh_ad;
+  msg_labels_t                  msgh_labels;
+} mach_msg_mac_trailer_t;
+
+
+#define MACH_MSG_TRAILER_MINIMUM_SIZE  sizeof(mach_msg_trailer_t)
+
+/*
+ * These values can change from release to release - but clearly
+ * code cannot request additional trailer elements one was not
+ * compiled to understand.  Therefore, it is safe to use this
+ * constant when the same module specified the receive options.
+ * Otherwise, you run the risk that the options requested by
+ * another module may exceed the local modules notion of
+ * MAX_TRAILER_SIZE.
+ */
+
+typedef mach_msg_mac_trailer_t mach_msg_max_trailer_t;
+#define MAX_TRAILER_SIZE ((mach_msg_size_t)sizeof(mach_msg_max_trailer_t))
+
+/*
+ * Legacy requirements keep us from ever updating these defines (even
+ * when the format_0 trailers gain new option data fields in the future).
+ * Therefore, they shouldn't be used going forward.  Instead, the sizes
+ * should be compared against the specific element size requested using
+ * REQUESTED_TRAILER_SIZE.
+ */
+typedef mach_msg_security_trailer_t mach_msg_format_0_trailer_t;
+
+/*typedef mach_msg_mac_trailer_t mach_msg_format_0_trailer_t;
+*/
+
+#define MACH_MSG_TRAILER_FORMAT_0_SIZE sizeof(mach_msg_format_0_trailer_t)
+
+#define   KERNEL_SECURITY_TOKEN_VALUE  { {0, 1} }
+extern security_token_t KERNEL_SECURITY_TOKEN;
+
+#define   KERNEL_AUDIT_TOKEN_VALUE  { {0, 0, 0, 0, 0, 0, 0, 0} }
+extern audit_token_t KERNEL_AUDIT_TOKEN;
+
+typedef	integer_t mach_msg_options_t;
+
+typedef struct
+{
+  mach_msg_header_t	header;
+} mach_msg_empty_send_t;
+
+typedef struct
+{
+  mach_msg_header_t	header;
+  mach_msg_trailer_t	trailer;
+} mach_msg_empty_rcv_t;
+
+typedef union
+{
+  mach_msg_empty_send_t	send;
+  mach_msg_empty_rcv_t	rcv;
+} mach_msg_empty_t;
+
+#pragma pack()
+
+/* utility to round the message size - will become machine dependent */
+#define round_msg(x)	(((mach_msg_size_t)(x) + sizeof (natural_t) - 1) & \
+				~(sizeof (natural_t) - 1))
+
+/*
+ *  There is no fixed upper bound to the size of Mach messages.
+ */
+#define	MACH_MSG_SIZE_MAX	((mach_msg_size_t) ~0)
+
+#if defined(__APPLE_API_PRIVATE)
+/*
+ *  But architectural limits of a given implementation, or
+ *  temporal conditions may cause unpredictable send failures
+ *  for messages larger than MACH_MSG_SIZE_RELIABLE.
+ *
+ *  In either case, waiting for memory is [currently] outside
+ *  the scope of send timeout values provided to IPC.
+ */
+#define	MACH_MSG_SIZE_RELIABLE	((mach_msg_size_t) 256 * 1024)
+#endif
+/*
+ *  Compatibility definitions, for code written
+ *  when there was a msgh_kind instead of msgh_seqno.
+ */
+#define MACH_MSGH_KIND_NORMAL		0x00000000
+#define MACH_MSGH_KIND_NOTIFICATION	0x00000001
+#define	msgh_kind			msgh_seqno
+#define mach_msg_kind_t			mach_port_seqno_t
+
+typedef natural_t mach_msg_type_size_t;
+typedef natural_t mach_msg_type_number_t;
+
+/*
+ *  Values received/carried in messages.  Tells the receiver what
+ *  sort of port right he now has.
+ *
+ *  MACH_MSG_TYPE_PORT_NAME is used to transfer a port name
+ *  which should remain uninterpreted by the kernel.  (Port rights
+ *  are not transferred, just the port name.)
+ */
+
+#define MACH_MSG_TYPE_PORT_NONE		0
+
+#define MACH_MSG_TYPE_PORT_NAME		15
+#define MACH_MSG_TYPE_PORT_RECEIVE	MACH_MSG_TYPE_MOVE_RECEIVE
+#define MACH_MSG_TYPE_PORT_SEND		MACH_MSG_TYPE_MOVE_SEND
+#define MACH_MSG_TYPE_PORT_SEND_ONCE	MACH_MSG_TYPE_MOVE_SEND_ONCE
+
+#define MACH_MSG_TYPE_LAST		22		/* Last assigned */
+
+/*
+ *  A dummy value.  Mostly used to indicate that the actual value
+ *  will be filled in later, dynamically.
+ */
+
+#define MACH_MSG_TYPE_POLYMORPHIC	((mach_msg_type_name_t) -1)
+
+/*
+ *	Is a given item a port type?
+ */
+
+#define MACH_MSG_TYPE_PORT_ANY(x)			\
+	(((x) >= MACH_MSG_TYPE_MOVE_RECEIVE) &&		\
+	 ((x) <= MACH_MSG_TYPE_MAKE_SEND_ONCE))
+
+#define	MACH_MSG_TYPE_PORT_ANY_SEND(x)			\
+	(((x) >= MACH_MSG_TYPE_MOVE_SEND) &&		\
+	 ((x) <= MACH_MSG_TYPE_MAKE_SEND_ONCE))
+
+#define	MACH_MSG_TYPE_PORT_ANY_RIGHT(x)			\
+	(((x) >= MACH_MSG_TYPE_MOVE_RECEIVE) &&		\
+	 ((x) <= MACH_MSG_TYPE_MOVE_SEND_ONCE))
+
+typedef integer_t mach_msg_option_t;
+
+#define MACH_MSG_OPTION_NONE	0x00000000
+
+#define	MACH_SEND_MSG		0x00000001
+#define	MACH_RCV_MSG		0x00000002
+
+#define MACH_RCV_LARGE		0x00000004	/* report large message sizes */
+#define MACH_RCV_LARGE_IDENTITY	0x00000008	/* identify source of large messages */
+
+#define MACH_SEND_TIMEOUT	0x00000010	/* timeout value applies to send */
+#define MACH_SEND_INTERRUPT	0x00000040	/* don't restart interrupted sends */
+#define MACH_SEND_NOTIFY	0x00000080	/* arm send-possible notify */
+#define MACH_SEND_ALWAYS	0x00010000	/* ignore qlimits - kernel only */
+#define MACH_SEND_TRAILER	0x00020000	/* sender-provided trailer */
+#define MACH_SEND_NOIMPORTANCE  0x00040000      /* msg won't carry importance */
+#define MACH_SEND_NODENAP	MACH_SEND_NOIMPORTANCE
+#define MACH_SEND_IMPORTANCE	0x00080000	/* msg carries importance - kernel only */
+
+
+#define MACH_RCV_TIMEOUT	0x00000100	/* timeout value applies to receive */	
+#define MACH_RCV_NOTIFY		0x00000200	/* reserved - legacy */
+#define MACH_RCV_INTERRUPT	0x00000400	/* don't restart interrupted receive */
+#define MACH_RCV_VOUCHER	0x00000800	/* willing to receive voucher port */
+#define MACH_RCV_OVERWRITE	0x00001000	/* scatter receive */
+
+/* 
+ * NOTE: a 0x00------ RCV mask implies to ask for
+ * a MACH_MSG_TRAILER_FORMAT_0 with 0 Elements, 
+ * which is equivalent to a mach_msg_trailer_t.
+ *
+ * XXXMAC: unlike the rest of the MACH_RCV_* flags, MACH_RCV_TRAILER_LABELS
+ * needs its own private bit since we only calculate its fields when absolutely 
+ * required.
+ */
+#define MACH_RCV_TRAILER_NULL   0
+#define MACH_RCV_TRAILER_SEQNO  1
+#define MACH_RCV_TRAILER_SENDER 2
+#define MACH_RCV_TRAILER_AUDIT  3
+#define MACH_RCV_TRAILER_CTX    4
+#define MACH_RCV_TRAILER_AV     7
+#define MACH_RCV_TRAILER_LABELS 8
+
+#define MACH_RCV_TRAILER_TYPE(x)     (((x) & 0xf) << 28) 
+#define MACH_RCV_TRAILER_ELEMENTS(x) (((x) & 0xf) << 24)  
+#define MACH_RCV_TRAILER_MASK 	     ((0xf << 24))
+
+#define GET_RCV_ELEMENTS(y) (((y) >> 24) & 0xf)
+
+
+/* 
+ * XXXMAC: note that in the case of MACH_RCV_TRAILER_LABELS, 
+ * we just fall through to mach_msg_max_trailer_t.
+ * This is correct behavior since mach_msg_max_trailer_t is defined as
+ * mac_msg_mac_trailer_t which is used for the LABELS trailer.
+ * It also makes things work properly if MACH_RCV_TRAILER_LABELS is ORed 
+ * with one of the other options.
+ */
+
+#define REQUESTED_TRAILER_SIZE_NATIVE(y)			\
+	((mach_msg_trailer_size_t)				\
+	 ((GET_RCV_ELEMENTS(y) == MACH_RCV_TRAILER_NULL) ?	\
+	  sizeof(mach_msg_trailer_t) :				\
+	  ((GET_RCV_ELEMENTS(y) == MACH_RCV_TRAILER_SEQNO) ?	\
+	   sizeof(mach_msg_seqno_trailer_t) :			\
+	  ((GET_RCV_ELEMENTS(y) == MACH_RCV_TRAILER_SENDER) ?	\
+	   sizeof(mach_msg_security_trailer_t) :		\
+	   ((GET_RCV_ELEMENTS(y) == MACH_RCV_TRAILER_AUDIT) ?	\
+	    sizeof(mach_msg_audit_trailer_t) :      		\
+	    ((GET_RCV_ELEMENTS(y) == MACH_RCV_TRAILER_CTX) ?	\
+	     sizeof(mach_msg_context_trailer_t) :      		\
+	     ((GET_RCV_ELEMENTS(y) == MACH_RCV_TRAILER_AV) ?	\
+	      sizeof(mach_msg_mac_trailer_t) :      		\
+	     sizeof(mach_msg_max_trailer_t))))))))
+
+
+#define REQUESTED_TRAILER_SIZE(y) REQUESTED_TRAILER_SIZE_NATIVE(y)
+
+/*
+ *  Much code assumes that mach_msg_return_t == kern_return_t.
+ *  This definition is useful for descriptive purposes.
+ *
+ *  See <mach/error.h> for the format of error codes.
+ *  IPC errors are system 4.  Send errors are subsystem 0;
+ *  receive errors are subsystem 1.  The code field is always non-zero.
+ *  The high bits of the code field communicate extra information
+ *  for some error codes.  MACH_MSG_MASK masks off these special bits.
+ */
+
+typedef kern_return_t mach_msg_return_t;
+
+#define MACH_MSG_SUCCESS		0x00000000
+
+
+#define	MACH_MSG_MASK			0x00003e00
+		/* All special error code bits defined below. */
+#define	MACH_MSG_IPC_SPACE		0x00002000
+		/* No room in IPC name space for another capability name. */
+#define	MACH_MSG_VM_SPACE		0x00001000
+		/* No room in VM address space for out-of-line memory. */
+#define	MACH_MSG_IPC_KERNEL		0x00000800
+		/* Kernel resource shortage handling an IPC capability. */
+#define	MACH_MSG_VM_KERNEL		0x00000400
+		/* Kernel resource shortage handling out-of-line memory. */
+
+#define MACH_SEND_IN_PROGRESS		0x10000001
+		/* Thread is waiting to send.  (Internal use only.) */
+#define MACH_SEND_INVALID_DATA		0x10000002
+		/* Bogus in-line data. */
+#define MACH_SEND_INVALID_DEST		0x10000003
+		/* Bogus destination port. */
+#define MACH_SEND_TIMED_OUT		0x10000004
+		/* Message not sent before timeout expired. */
+#define MACH_SEND_INVALID_VOUCHER	0x10000005
+		/* Bogus voucher port. */
+#define MACH_SEND_INTERRUPTED		0x10000007
+		/* Software interrupt. */
+#define MACH_SEND_MSG_TOO_SMALL		0x10000008
+		/* Data doesn't contain a complete message. */
+#define MACH_SEND_INVALID_REPLY		0x10000009
+		/* Bogus reply port. */
+#define MACH_SEND_INVALID_RIGHT		0x1000000a
+		/* Bogus port rights in the message body. */
+#define MACH_SEND_INVALID_NOTIFY	0x1000000b
+		/* Bogus notify port argument. */
+#define MACH_SEND_INVALID_MEMORY	0x1000000c
+		/* Invalid out-of-line memory pointer. */
+#define MACH_SEND_NO_BUFFER		0x1000000d
+		/* No message buffer is available. */
+#define MACH_SEND_TOO_LARGE		0x1000000e
+		/* Send is too large for port */
+#define MACH_SEND_INVALID_TYPE		0x1000000f
+		/* Invalid msg-type specification. */
+#define MACH_SEND_INVALID_HEADER	0x10000010
+		/* A field in the header had a bad value. */
+#define MACH_SEND_INVALID_TRAILER	0x10000011
+		/* The trailer to be sent does not match kernel format. */
+#define MACH_SEND_INVALID_RT_OOL_SIZE	0x10000015
+		/* compatibility: no longer a returned error */
+
+#define MACH_RCV_IN_PROGRESS		0x10004001
+		/* Thread is waiting for receive.  (Internal use only.) */
+#define MACH_RCV_INVALID_NAME		0x10004002
+		/* Bogus name for receive port/port-set. */
+#define MACH_RCV_TIMED_OUT		0x10004003
+		/* Didn't get a message within the timeout value. */
+#define MACH_RCV_TOO_LARGE		0x10004004
+		/* Message buffer is not large enough for inline data. */
+#define MACH_RCV_INTERRUPTED		0x10004005
+		/* Software interrupt. */
+#define MACH_RCV_PORT_CHANGED		0x10004006
+		/* compatibility: no longer a returned error */
+#define MACH_RCV_INVALID_NOTIFY		0x10004007
+		/* Bogus notify port argument. */
+#define MACH_RCV_INVALID_DATA		0x10004008
+		/* Bogus message buffer for inline data. */
+#define MACH_RCV_PORT_DIED		0x10004009
+		/* Port/set was sent away/died during receive. */
+#define	MACH_RCV_IN_SET			0x1000400a
+		/* compatibility: no longer a returned error */
+#define	MACH_RCV_HEADER_ERROR		0x1000400b
+		/* Error receiving message header.  See special bits. */
+#define	MACH_RCV_BODY_ERROR		0x1000400c
+		/* Error receiving message body.  See special bits. */
+#define	MACH_RCV_INVALID_TYPE		0x1000400d
+		/* Invalid msg-type specification in scatter list. */
+#define	MACH_RCV_SCATTER_SMALL		0x1000400e
+		/* Out-of-line overwrite region is not large enough */
+#define MACH_RCV_INVALID_TRAILER	0x1000400f
+		/* trailer type or number of trailer elements not supported */
+#define MACH_RCV_IN_PROGRESS_TIMED      0x10004011
+                /* Waiting for receive with timeout. (Internal use only.) */
+
+
+__BEGIN_DECLS
+
+/*
+ *	Routine:	mach_msg_overwrite
+ *	Purpose:
+ *		Send and/or receive a message.  If the message operation
+ *		is interrupted, and the user did not request an indication
+ *		of that fact, then restart the appropriate parts of the
+ *		operation silently (trap version does not restart).
+ *
+ *		Distinct send and receive buffers may be specified.  If
+ *		no separate receive buffer is specified, the msg parameter
+ *		will be used for both send and receive operations.
+ *
+ *		In addition to a distinct receive buffer, that buffer may
+ *		already contain scatter control information to direct the
+ *		receiving of the message.
+ */
+
+extern mach_msg_return_t	mach_msg_overwrite(
+					mach_msg_header_t *msg,
+					mach_msg_option_t option,
+					mach_msg_size_t send_size,
+					mach_msg_size_t rcv_size,
+					mach_port_name_t rcv_name,
+					mach_msg_timeout_t timeout,
+					mach_port_name_t notify,
+					mach_msg_header_t *rcv_msg,
+					mach_msg_size_t rcv_limit);
+
+
+/*
+ *	Routine:	mach_msg
+ *	Purpose:
+ *		Send and/or receive a message.  If the message operation
+ *		is interrupted, and the user did not request an indication
+ *		of that fact, then restart the appropriate parts of the
+ *		operation silently (trap version does not restart).
+ */
+extern mach_msg_return_t	mach_msg(
+					mach_msg_header_t *msg,
+					mach_msg_option_t option,
+					mach_msg_size_t send_size,
+					mach_msg_size_t rcv_size,
+					mach_port_name_t rcv_name,
+					mach_msg_timeout_t timeout,
+					mach_port_name_t notify);
+
+/*
+ *	Routine:	mach_voucher_deallocate
+ *	Purpose:
+ *		Deallocate a mach voucher created or received in a message.  Drops
+ *		one (send right) reference to the voucher.
+ */
+extern kern_return_t		mach_voucher_deallocate(
+					mach_port_name_t voucher);
+
+
+__END_DECLS
+
+#endif	/* _MACH_MESSAGE_H_ */
+
diff -Nur cctools-877.5/include/mach/mig.h cctools-877.5-AnV/include/mach/mig.h
--- cctools-877.5/include/mach/mig.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mig.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,168 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+/*
+ * Mach MIG Subsystem Interfaces
+ */
+
+#ifndef	_MACH_MIG_H_
+#define _MACH_MIG_H_
+
+#include <stdint.h>
+#include <mach/port.h>
+#include <mach/message.h>
+#include <mach/vm_types.h>
+
+#include <sys/cdefs.h>
+
+#if defined(MACH_KERNEL)
+
+#if !defined(__MigTypeCheck)
+/* Turn MIG type checking on by default for kernel */
+#define __MigTypeCheck 1
+#endif
+
+#define __MigKernelSpecificCode 1
+#define _MIG_KERNEL_SPECIFIC_CODE_ 1
+
+#elif !defined(__MigTypeCheck)
+
+#if defined(TypeCheck)
+/* use legacy setting (temporary) */
+#define __MigTypeCheck TypeCheck
+#else
+/* default MIG type checking on */
+#define __MigTypeCheck 1
+#endif
+
+#endif /* !defined(MACH_KERNEL) && !defined(__MigTypeCheck) */
+
+/*
+ * Pack MIG message structs.
+ * This is an indicator of the need to view shared structs in a
+ * binary-compatible format - and MIG message structs are no different.
+ */
+#define __MigPackStructs 1
+
+/*
+ * Definition for MIG-generated server stub routines.  These routines
+ * unpack the request message, call the server procedure, and pack the
+ * reply message.
+ */
+typedef void	(*mig_stub_routine_t) (mach_msg_header_t *InHeadP,
+				       mach_msg_header_t *OutHeadP);
+
+typedef mig_stub_routine_t mig_routine_t;
+
+/*
+ * Definition for MIG-generated server routine.  This routine takes a
+ * message, and returns the appropriate stub function for handling that
+ * message.
+ */
+typedef mig_routine_t (*mig_server_routine_t) (mach_msg_header_t *InHeadP);
+
+/*
+ * Generic definition for implementation routines.  These routines do
+ * the real work associated with this request.  This generic type is
+ * used for keeping the pointers in the subsystem array.
+ */
+typedef kern_return_t   (*mig_impl_routine_t)(void);
+
+typedef mach_msg_type_descriptor_t routine_arg_descriptor;
+typedef mach_msg_type_descriptor_t *routine_arg_descriptor_t;
+typedef mach_msg_type_descriptor_t *mig_routine_arg_descriptor_t;
+
+#define MIG_ROUTINE_ARG_DESCRIPTOR_NULL ((mig_routine_arg_descriptor_t)0)
+
+struct routine_descriptor {
+	mig_impl_routine_t	impl_routine;	/* Server work func pointer   */
+	mig_stub_routine_t	stub_routine;	/* Unmarshalling func pointer */
+	unsigned int		argc;			/* Number of argument words   */
+	unsigned int		descr_count;	/* Number complex descriptors */
+	routine_arg_descriptor_t
+						arg_descr;		/* pointer to descriptor array*/
+	unsigned int		max_reply_msg;	/* Max size for reply msg     */
+};
+typedef struct routine_descriptor *routine_descriptor_t;
+
+typedef struct routine_descriptor mig_routine_descriptor;
+typedef mig_routine_descriptor *mig_routine_descriptor_t;
+
+#define MIG_ROUTINE_DESCRIPTOR_NULL ((mig_routine_descriptor_t)0)
+
+typedef struct mig_subsystem {
+	mig_server_routine_t server;		/* pointer to demux routine	*/
+	mach_msg_id_t		 start;			/* Min routine number	    */
+	mach_msg_id_t		 end;			/* Max routine number + 1   */
+	mach_msg_size_t		 maxsize;		/* Max reply message size   */
+	vm_address_t		 reserved;		/* reserved for MIG use	    */
+	mig_routine_descriptor
+						 routine[1];	/* Routine descriptor array */
+} *mig_subsystem_t;
+
+#define MIG_SUBSYSTEM_NULL		((mig_subsystem_t)0)
+
+typedef struct mig_symtab {
+	char				*ms_routine_name;
+	int					ms_routine_number;
+	void    			(*ms_routine)(void);	/* Since the functions in the
+					 							 * symbol table have unknown
+												 * signatures, this is the best
+					 							 * we can do...
+					 							 */
+} mig_symtab_t;
+
+
+__BEGIN_DECLS
+
+/* Client side reply port allocate */
+extern mach_port_t mig_get_reply_port(void);
+
+/* Client side reply port deallocate */
+extern void mig_dealloc_reply_port(mach_port_t reply_port);
+
+/* Client side reply port "deallocation" */
+extern void mig_put_reply_port(mach_port_t reply_port);
+
+/* Bounded string copy */
+extern int mig_strncpy(char	*dest, const char *src,	int	len);
+
+
+/* Allocate memory for out-of-line mig structures */
+extern void mig_allocate(vm_address_t *, vm_size_t);
+
+/* Deallocate memory used for out-of-line mig structures */
+extern void mig_deallocate(vm_address_t, vm_size_t);
+
+
+__END_DECLS
+
+#endif	/* _MACH_MIG_H_ */
diff -Nur cctools-877.5/include/mach/mig_errors.h cctools-877.5-AnV/include/mach/mig_errors.h
--- cctools-877.5/include/mach/mig_errors.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mig_errors.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,124 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ * Mach Interface Generator errors
+ *
+ */
+
+#ifndef	_MACH_MIG_ERRORS_H_
+#define _MACH_MIG_ERRORS_H_
+
+#include <mach/mig.h>
+#include <mach/ndr.h>
+#include <mach/message.h>
+#include <mach/kern_return.h>
+
+#include <sys/cdefs.h>
+
+/*
+ *	These error codes should be specified as system 4, subsytem 2.
+ *	But alas backwards compatibility makes that impossible.
+ *	The problem is old clients of new servers (eg, the kernel)
+ *	which get strange large error codes when there is a Mig problem
+ *	in the server.  Unfortunately, the IPC system doesn't have
+ *	the knowledge to convert the codes in this situation.
+ */
+
+#define MIG_TYPE_ERROR		-300	/* client type check failure */
+#define MIG_REPLY_MISMATCH	-301	/* wrong reply message ID */
+#define MIG_REMOTE_ERROR	-302	/* server detected error */
+#define MIG_BAD_ID		-303	/* bad request message ID */
+#define MIG_BAD_ARGUMENTS	-304	/* server type check failure */
+#define MIG_NO_REPLY		-305	/* no reply should be send */
+#define MIG_EXCEPTION		-306	/* server raised exception */
+#define MIG_ARRAY_TOO_LARGE	-307	/* array not large enough */
+#define MIG_SERVER_DIED		-308	/* server died */
+#define MIG_TRAILER_ERROR       -309    /* trailer has an unknown format */
+
+/*
+ *	Whenever MIG detects an error, it sends back a generic
+ *	mig_reply_error_t format message.  Clients must accept
+ *	these in addition to the expected reply message format.
+ */
+#pragma pack(4)
+typedef struct {
+	mach_msg_header_t	Head;
+	NDR_record_t		NDR;
+	kern_return_t		RetCode;
+} mig_reply_error_t;
+#pragma pack()
+
+
+__BEGIN_DECLS
+
+#if !defined(__NDR_convert__mig_reply_error_t__defined)
+#define __NDR_convert__mig_reply_error_t__defined
+
+static __inline__ void
+__NDR_convert__mig_reply_error_t(__unused mig_reply_error_t *x)
+{
+#if defined(__NDR_convert__int_rep__kern_return_t__defined)
+	if (x->NDR.int_rep != NDR_record.int_rep)
+		__NDR_convert__int_rep__kern_return_t(&x->RetCode, x->NDR.int_rep);
+#endif /* __NDR_convert__int_rep__kern_return_t__defined */
+}
+#endif /* !defined(__NDR_convert__mig_reply_error_t__defined) */
+
+__END_DECLS
+
+#endif	/* _MACH_MIG_ERRORS_H_ */
diff -Nur cctools-877.5/include/mach/mig_voucher_support.h cctools-877.5-AnV/include/mach/mig_voucher_support.h
--- cctools-877.5/include/mach/mig_voucher_support.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/mig_voucher_support.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,8 @@
+//This dummy header file is created for mig to check when to include voucher code.
+//Mig checks if this file is available to include and knows that Libsyscall has the new voucher symbols to link to.
+//Do not delete this file, mig will stop including vouchers code.
+
+#ifndef __MACH_MIG_VOUCHER_SUPPORT__
+#define __MACH_MIG_VOUCHER_SUPPORT__
+
+#endif // __MACH_MIG_VOUCHER_SUPPORT__
diff -Nur cctools-877.5/include/mach/ndr.h cctools-877.5-AnV/include/mach/ndr.h
--- cctools-877.5/include/mach/ndr.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/ndr.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,203 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef _MACH_NDR_H_
+#define _MACH_NDR_H_
+
+#include <stdint.h>
+#include <sys/cdefs.h>
+#include <libkern/OSByteOrder.h>
+
+
+typedef struct {
+    unsigned char       mig_vers;
+    unsigned char       if_vers;
+    unsigned char       reserved1;
+    unsigned char       mig_encoding;
+    unsigned char       int_rep;
+    unsigned char       char_rep;
+    unsigned char       float_rep;
+    unsigned char       reserved2;
+} NDR_record_t;
+
+/*
+ * MIG supported protocols for Network Data Representation
+ */
+#define  NDR_PROTOCOL_2_0      0
+
+/*
+ * NDR 2.0 format flag type definition and values.
+ */
+#define  NDR_INT_BIG_ENDIAN    0
+#define  NDR_INT_LITTLE_ENDIAN 1
+#define  NDR_FLOAT_IEEE        0
+#define  NDR_FLOAT_VAX         1
+#define  NDR_FLOAT_CRAY        2
+#define  NDR_FLOAT_IBM         3
+#define  NDR_CHAR_ASCII        0
+#define  NDR_CHAR_EBCDIC       1
+
+extern NDR_record_t NDR_record;
+
+/* NDR conversion off by default */
+
+#if !defined(__NDR_convert__)
+#define __NDR_convert__ 0
+#endif /* !defined(__NDR_convert__) */
+
+#ifndef __NDR_convert__int_rep__
+#define __NDR_convert__int_rep__ __NDR_convert__
+#endif /* __NDR_convert__int_rep__ */
+
+#ifndef __NDR_convert__char_rep__
+#define __NDR_convert__char_rep__ 0
+#endif /* __NDR_convert__char_rep__ */
+
+#ifndef __NDR_convert__float_rep__
+#define __NDR_convert__float_rep__ 0
+#endif /* __NDR_convert__float_rep__ */
+
+#if __NDR_convert__
+
+#define __NDR_convert__NOOP		do ; while (0)
+#define __NDR_convert__UNKNOWN(s)	__NDR_convert__NOOP
+#define __NDR_convert__SINGLE(a, f, r)	do { r((a), (f)); } while (0)
+#define __NDR_convert__ARRAY(a, f, c, r) \
+	do { int __i__, __C__ = (c); \
+	for (__i__ = 0; __i__ < __C__; __i__++) \
+	r(&(a)[__i__], f); } while (0)
+#define __NDR_convert__2DARRAY(a, f, s, c, r) \
+	do { int __i__, __C__ = (c), __S__ = (s); \
+	for (__i__ = 0; __i__ < __C__; __i__++) \
+	r(&(a)[__i__ * __S__], f, __S__); } while (0)
+
+#if __NDR_convert__int_rep__
+
+#define __NDR_READSWAP_assign(a, rs)	do { *(a) = rs(a); } while (0)
+
+#define __NDR_READSWAP__uint16_t(a) 	OSReadSwapInt16((void *)a, 0)
+#define __NDR_READSWAP__int16_t(a)	(int16_t)OSReadSwapInt16((void *)a, 0)
+#define __NDR_READSWAP__uint32_t(a) 	OSReadSwapInt32((void *)a, 0)
+#define __NDR_READSWAP__int32_t(a)	(int32_t)OSReadSwapInt32((void *)a, 0)
+#define __NDR_READSWAP__uint64_t(a)	OSReadSwapInt64((void *)a, 0)
+#define __NDR_READSWAP__int64_t(a)	(int64_t)OSReadSwapInt64((void *)a, 0)
+
+__BEGIN_DECLS
+
+static __inline__ float __NDR_READSWAP__float(float *argp) {
+	union {
+		float sv;
+		uint32_t ull;
+	} result;
+	result.ull = __NDR_READSWAP__uint32_t((uint32_t *)argp);
+	return result.sv;
+}
+
+static __inline__ double __NDR_READSWAP__double(double *argp) {
+	union {
+		double sv;
+		uint64_t ull;
+	} result;
+	result.ull = __NDR_READSWAP__uint64_t((uint64_t *)argp);
+	return result.sv;
+}
+
+__END_DECLS
+
+#define __NDR_convert__int_rep__int16_t__defined
+#define __NDR_convert__int_rep__int16_t(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__int16_t)
+
+#define __NDR_convert__int_rep__uint16_t__defined
+#define __NDR_convert__int_rep__uint16_t(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__uint16_t)
+
+#define __NDR_convert__int_rep__int32_t__defined
+#define __NDR_convert__int_rep__int32_t(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__int32_t)
+
+#define __NDR_convert__int_rep__uint32_t__defined
+#define __NDR_convert__int_rep__uint32_t(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__uint32_t)
+
+#define __NDR_convert__int_rep__int64_t__defined
+#define __NDR_convert__int_rep__int64_t(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__int64_t)
+
+#define __NDR_convert__int_rep__uint64_t__defined
+#define __NDR_convert__int_rep__uint64_t(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__uint64_t)
+
+#define __NDR_convert__int_rep__float__defined
+#define __NDR_convert__int_rep__float(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__float)
+
+#define __NDR_convert__int_rep__double__defined
+#define __NDR_convert__int_rep__double(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__double)
+
+#define __NDR_convert__int_rep__boolean_t__defined
+#define __NDR_convert__int_rep__boolean_t(v, f)		\
+	__NDR_convert__int_rep__int32_t(v,f)
+
+#define __NDR_convert__int_rep__kern_return_t__defined
+#define __NDR_convert__int_rep__kern_return_t(v,f)	\
+	__NDR_convert__int_rep__int32_t(v,f)
+
+#define __NDR_convert__int_rep__mach_port_name_t__defined
+#define __NDR_convert__int_rep__mach_port_name_t(v,f)	\
+	__NDR_convert__int_rep__uint32_t(v,f)
+
+#define __NDR_convert__int_rep__mach_msg_type_number_t__defined
+#define __NDR_convert__int_rep__mach_msg_type_number_t(v,f) \
+	__NDR_convert__int_rep__uint32_t(v,f)
+
+#endif /* __NDR_convert__int_rep__ */
+
+#if __NDR_convert__char_rep__
+
+#warning  NDR character representation conversions not implemented yet!
+#define __NDR_convert__char_rep__char(v,f)	__NDR_convert__NOOP
+#define __NDR_convert__char_rep__string(v,f,l)	__NDR_convert__NOOP
+
+#endif /* __NDR_convert__char_rep__ */
+
+#if __NDR_convert__float_rep__
+
+#warning  NDR floating point representation conversions not implemented yet!
+#define __NDR_convert__float_rep__float(v,f)	__NDR_convert__NOOP
+#define __NDR_convert__float_rep__double(v,f)	__NDR_convert__NOOP
+
+#endif /* __NDR_convert__float_rep__ */
+
+#endif /* __NDR_convert__ */
+
+#endif /* _MACH_NDR_H_ */
diff -Nur cctools-877.5/include/mach/notify.defs cctools-877.5-AnV/include/mach/notify.defs
--- cctools-877.5/include/mach/notify.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/notify.defs	2015-11-16 07:56:14 +0000
@@ -0,0 +1,134 @@
+/*
+ * Copyright (c) 2000-2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+subsystem 
+#if	KERNEL_USER
+	KernelUser
+#endif
+	notify 64;
+
+#include <mach/std_types.defs>
+
+#if	SEQNOS
+serverprefix do_seqnos_;
+serverdemux seqnos_notify_server;
+#else	/* !SEQNOS */
+serverprefix do_;
+serverdemux notify_server;
+#endif	/* SEQNOS */
+
+/* MACH_NOTIFY_FIRST: 0100 */
+skip;
+
+/* MACH_NOTIFY_PORT_DELETED: 0101 */
+simpleroutine mach_notify_port_deleted(
+		notify	: mach_port_move_send_once_t;
+#if	SEQNOS
+	msgseqno seqno	: mach_port_seqno_t;
+#endif	/* SEQNOS */
+		name	: mach_port_name_t);
+
+#if (KERNEL_USER | MACH_NOTIFY_SEND_POSSIBLE_EXPECTED)
+/* MACH_NOTIFY_SEND_POSSIBLE: 0102 */
+simpleroutine mach_notify_send_possible(
+		notify	: mach_port_move_send_once_t;
+#if	SEQNOS
+	msgseqno seqno	: mach_port_seqno_t;
+#endif	/* SEQNOS */
+		name	: mach_port_name_t);
+#else
+skip;
+#endif
+
+skip;	/* was NOTIFY_OWNERSHIP_RIGHTS: 0103 */
+
+skip;	/* was NOTIFY_RECEIVE_RIGHTS: 0104 */
+
+/* MACH_NOTIFY_PORT_DESTROYED: 0105 */
+simpleroutine mach_notify_port_destroyed(
+		notify	: mach_port_move_send_once_t;
+#if	SEQNOS
+	msgseqno seqno	: mach_port_seqno_t;
+#endif	/* SEQNOS */
+		rights	: mach_port_move_receive_t);
+
+/* MACH_NOTIFY_NO_SENDERS: 0106 */
+simpleroutine mach_notify_no_senders(
+		notify	: mach_port_move_send_once_t;
+#if	SEQNOS
+	msgseqno seqno	: mach_port_seqno_t;
+#endif	/* SEQNOS */
+		mscount	: mach_port_mscount_t);
+
+/* MACH_NOTIFY_SEND_ONCE: 0107 */
+simpleroutine mach_notify_send_once(
+		notify	: mach_port_move_send_once_t
+#if	SEQNOS
+;	msgseqno seqno	: mach_port_seqno_t
+#endif	/* SEQNOS */
+		);
+
+/* MACH_NOTIFY_DEAD_NAME: 0110 */
+simpleroutine mach_notify_dead_name(
+		notify	: mach_port_move_send_once_t;
+#if	SEQNOS
+	msgseqno seqno	: mach_port_seqno_t;
+#endif	/* SEQNOS */
+		name	: mach_port_name_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/notify.h cctools-877.5-AnV/include/mach/notify.h
--- cctools-877.5/include/mach/notify.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/notify.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,141 @@
+/*
+ * Copyright (c) 2000-2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/notify.h
+ *
+ *	Kernel notification message definitions.
+ */
+
+#ifndef	_MACH_NOTIFY_H_
+#define _MACH_NOTIFY_H_
+
+#include <mach/port.h>
+#include <mach/message.h>
+#include <mach/ndr.h>
+
+/*
+ *  An alternative specification of the notification interface
+ *  may be found in mach/notify.defs.
+ */
+
+#define MACH_NOTIFY_FIRST		0100
+#define MACH_NOTIFY_PORT_DELETED	(MACH_NOTIFY_FIRST + 001)
+			/* A send or send-once right was deleted. */
+#define MACH_NOTIFY_SEND_POSSIBLE	(MACH_NOTIFY_FIRST + 002)
+			/* Now possible to send using specified right */
+#define MACH_NOTIFY_PORT_DESTROYED	(MACH_NOTIFY_FIRST + 005)
+			/* A receive right was (would have been) deallocated */
+#define MACH_NOTIFY_NO_SENDERS		(MACH_NOTIFY_FIRST + 006)
+			/* Receive right has no extant send rights */
+#define MACH_NOTIFY_SEND_ONCE		(MACH_NOTIFY_FIRST + 007)
+			/* An extant send-once right died */
+#define MACH_NOTIFY_DEAD_NAME		(MACH_NOTIFY_FIRST + 010)
+			/* Send or send-once right died, leaving a dead-name */
+#define MACH_NOTIFY_LAST		(MACH_NOTIFY_FIRST + 015)
+
+typedef mach_port_t notify_port_t;
+
+/*
+ * Hard-coded message structures for receiving Mach port notification
+ * messages.  However, they are not actual large enough to receive 
+ * the largest trailers current exported by Mach IPC (so they cannot
+ * be used for space allocations in situations using these new larger
+ * trailers).  Instead, the MIG-generated server routines (and
+ * related prototypes should be used).
+ */
+typedef struct {
+    mach_msg_header_t	not_header;
+    NDR_record_t	NDR;
+    mach_port_name_t not_port;/* MACH_MSG_TYPE_PORT_NAME */
+    mach_msg_format_0_trailer_t trailer;
+} mach_port_deleted_notification_t;
+
+typedef struct {
+    mach_msg_header_t	not_header;
+    NDR_record_t	NDR;
+    mach_port_name_t not_port;/* MACH_MSG_TYPE_PORT_NAME */
+    mach_msg_format_0_trailer_t trailer;
+} mach_send_possible_notification_t;
+
+typedef struct {
+    mach_msg_header_t	not_header;
+    mach_msg_body_t	not_body;
+    mach_msg_port_descriptor_t not_port;/* MACH_MSG_TYPE_PORT_RECEIVE */
+    mach_msg_format_0_trailer_t trailer;
+} mach_port_destroyed_notification_t;
+
+typedef struct {
+    mach_msg_header_t	not_header;
+    NDR_record_t	NDR;
+    mach_msg_type_number_t not_count;
+    mach_msg_format_0_trailer_t trailer;
+} mach_no_senders_notification_t;
+
+typedef struct {
+    mach_msg_header_t	not_header;
+    mach_msg_format_0_trailer_t trailer;
+} mach_send_once_notification_t;
+
+typedef struct {
+    mach_msg_header_t	not_header;
+    NDR_record_t	NDR;
+    mach_port_name_t not_port;/* MACH_MSG_TYPE_PORT_NAME */
+    mach_msg_format_0_trailer_t trailer;
+} mach_dead_name_notification_t;
+
+#endif	/* _MACH_NOTIFY_H_ */
diff -Nur cctools-877.5/include/mach/policy.h cctools-877.5-AnV/include/mach/policy.h
--- cctools-877.5/include/mach/policy.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/policy.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,235 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_MACH_POLICY_H_
+#define _MACH_POLICY_H_
+
+/*
+ *	mach/policy.h
+ *
+ *	Definitions for scheduing policy.
+ */
+
+/*
+ *  All interfaces defined here are obsolete.
+ */
+
+#include <mach/boolean.h>
+#include <mach/message.h>
+#include <mach/vm_types.h>
+
+/*
+ *	Old scheduling control interface
+ */
+typedef int 				policy_t;
+typedef integer_t			*policy_info_t;
+typedef integer_t			*policy_base_t;
+typedef integer_t			*policy_limit_t;
+
+/*
+ *	Policy definitions.  Policies should be powers of 2,
+ *	but cannot be or'd together other than to test for a
+ *	policy 'class'.
+ */
+#define	POLICY_NULL		0	/* none			*/
+#define	POLICY_TIMESHARE	1	/* timesharing		*/
+#define	POLICY_RR		2	/* fixed round robin	*/
+#define POLICY_FIFO		4	/* fixed fifo		*/
+
+#define __NEW_SCHEDULING_FRAMEWORK__
+
+/*
+ *	Check if policy is of 'class' fixed-priority.
+ */
+#define	POLICYCLASS_FIXEDPRI	(POLICY_RR | POLICY_FIFO)
+
+/*
+ *	Check if policy is valid.
+ */
+#define invalid_policy(policy)			\
+	((policy) != POLICY_TIMESHARE &&	\
+	 (policy) != POLICY_RR &&		\
+	 (policy) != POLICY_FIFO)
+
+
+/*
+ * 	Types for TIMESHARE policy
+ */
+struct policy_timeshare_base {			
+	integer_t		base_priority;
+};
+struct policy_timeshare_limit {
+	integer_t		max_priority;
+};
+struct policy_timeshare_info {
+	integer_t		max_priority;
+	integer_t		base_priority;
+	integer_t		cur_priority;
+	boolean_t		depressed;
+	integer_t		depress_priority;
+};
+
+typedef struct policy_timeshare_base	*policy_timeshare_base_t; 
+typedef struct policy_timeshare_limit	*policy_timeshare_limit_t;
+typedef struct policy_timeshare_info	*policy_timeshare_info_t;
+
+typedef struct policy_timeshare_base	policy_timeshare_base_data_t; 
+typedef struct policy_timeshare_limit	policy_timeshare_limit_data_t;
+typedef struct policy_timeshare_info	policy_timeshare_info_data_t;
+
+
+#define POLICY_TIMESHARE_BASE_COUNT	((mach_msg_type_number_t) \
+	(sizeof(struct policy_timeshare_base)/sizeof(integer_t)))
+#define POLICY_TIMESHARE_LIMIT_COUNT	((mach_msg_type_number_t) \
+	(sizeof(struct policy_timeshare_limit)/sizeof(integer_t)))
+#define POLICY_TIMESHARE_INFO_COUNT	((mach_msg_type_number_t) \
+	(sizeof(struct policy_timeshare_info)/sizeof(integer_t)))
+
+
+/*
+ *	Types for the ROUND ROBIN (RR) policy
+ */
+struct policy_rr_base {				
+	integer_t		base_priority;
+	integer_t		quantum;
+};
+struct policy_rr_limit {
+	integer_t		max_priority;
+};
+struct policy_rr_info {
+	integer_t		max_priority;
+	integer_t		base_priority;
+	integer_t		quantum;
+	boolean_t		depressed;
+	integer_t		depress_priority;
+};
+
+typedef struct policy_rr_base		*policy_rr_base_t;
+typedef struct policy_rr_limit		*policy_rr_limit_t;
+typedef struct policy_rr_info		*policy_rr_info_t;
+
+typedef struct policy_rr_base		policy_rr_base_data_t;
+typedef struct policy_rr_limit		policy_rr_limit_data_t;
+typedef struct policy_rr_info		policy_rr_info_data_t;
+
+#define POLICY_RR_BASE_COUNT	((mach_msg_type_number_t)	\
+	(sizeof(struct policy_rr_base)/sizeof(integer_t)))
+#define POLICY_RR_LIMIT_COUNT	((mach_msg_type_number_t)	\
+	(sizeof(struct policy_rr_limit)/sizeof(integer_t)))
+#define POLICY_RR_INFO_COUNT	((mach_msg_type_number_t)	\
+	(sizeof(struct policy_rr_info)/sizeof(integer_t)))
+
+
+/*
+ * 	Types for the FIRST-IN-FIRST-OUT (FIFO) policy
+ */
+struct policy_fifo_base {		
+	integer_t		base_priority;
+};
+struct policy_fifo_limit {
+	integer_t		max_priority;
+};
+struct policy_fifo_info {
+	integer_t		max_priority;
+	integer_t		base_priority;
+	boolean_t		depressed;
+	integer_t		depress_priority;
+};
+
+typedef struct policy_fifo_base		*policy_fifo_base_t;
+typedef struct policy_fifo_limit	*policy_fifo_limit_t;
+typedef struct policy_fifo_info		*policy_fifo_info_t;
+
+typedef struct policy_fifo_base		policy_fifo_base_data_t;
+typedef struct policy_fifo_limit	policy_fifo_limit_data_t;
+typedef struct policy_fifo_info		policy_fifo_info_data_t;
+
+#define POLICY_FIFO_BASE_COUNT	((mach_msg_type_number_t)	\
+	(sizeof(struct policy_fifo_base)/sizeof(integer_t)))
+#define POLICY_FIFO_LIMIT_COUNT	((mach_msg_type_number_t)	\
+	(sizeof(struct policy_fifo_limit)/sizeof(integer_t)))
+#define POLICY_FIFO_INFO_COUNT	((mach_msg_type_number_t)	\
+	(sizeof(struct policy_fifo_info)/sizeof(integer_t)))
+
+/*
+ * 	Aggregate policy types
+ */
+
+struct policy_bases {
+	policy_timeshare_base_data_t	ts;
+	policy_rr_base_data_t		rr;
+	policy_fifo_base_data_t		fifo;
+};
+
+struct policy_limits {
+	policy_timeshare_limit_data_t	ts;
+	policy_rr_limit_data_t		rr;
+	policy_fifo_limit_data_t	fifo;
+};
+
+struct policy_infos {
+	policy_timeshare_info_data_t	ts;
+	policy_rr_info_data_t		rr;
+	policy_fifo_info_data_t		fifo;
+};
+
+typedef struct policy_bases		policy_base_data_t;
+typedef struct policy_limits		policy_limit_data_t;
+typedef struct policy_infos		policy_info_data_t;
+
+#endif	/* _MACH_POLICY_H_ */
diff -Nur cctools-877.5/include/mach/port.h cctools-877.5-AnV/include/mach/port.h
--- cctools-877.5/include/mach/port.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/port.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,381 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ * NOTICE: This file was modified by McAfee Research in 2004 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+/*
+ */
+/*
+ *	File:	mach/port.h
+ *
+ *	Definition of a Mach port
+ *
+ *	Mach ports are the endpoints to Mach-implemented communications
+ *	channels (usually uni-directional message queues, but other types
+ *	also exist).
+ *
+ *	Unique collections of these endpoints are maintained for each
+ *	Mach task.  Each Mach port in the task's collection is given a 
+ *	[task-local] name to identify it - and the the various "rights"
+ *	held by the task for that specific endpoint.
+ *
+ *	This header defines the types used to identify these Mach ports
+ *	and the various rights associated with them.  For more info see:
+ *
+ *	<mach/mach_port.h> - manipulation of port rights in a given space
+ *	<mach/message.h> - message queue [and port right passing] mechanism
+ *
+ */
+
+#ifndef	_MACH_PORT_H_
+#define _MACH_PORT_H_
+
+#include <sys/cdefs.h>
+#include <stdint.h>
+#include <mach/boolean.h>
+#include <mach/machine/vm_types.h>
+
+/*
+ *	mach_port_name_t - the local identity for a Mach port
+ *
+ *	The name is Mach port namespace specific.  It is used to
+ *	identify the rights held for that port by the task whose
+ *	namespace is implied [or specifically provided].
+ *
+ *	Use of this type usually implies just a name - no rights.
+ *	See mach_port_t for a type that implies a "named right."
+ *
+ */
+ 
+typedef natural_t mach_port_name_t;
+typedef mach_port_name_t *mach_port_name_array_t;
+
+
+/* 
+ *	mach_port_t - a named port right
+ *
+ *	In user-space, "rights" are represented by the name of the
+ *	right in the Mach port namespace.  Even so, this type is
+ *	presented as a unique one to more clearly denote the presence
+ *	of a right coming along with the name. 
+ *
+ *	Often, various rights for a port held in a single name space
+ *	will coalesce and are, therefore, be identified by a single name
+ *	[this is the case for send and receive rights].  But not
+ *	always [send-once rights currently get a unique name for
+ *	each right].      
+ *
+ */
+
+#include <sys/_types.h>
+#include <sys/_types/_mach_port_t.h>
+
+
+typedef mach_port_t			*mach_port_array_t;
+
+/*
+ *  MACH_PORT_NULL is a legal value that can be carried in messages.
+ *  It indicates the absence of any port or port rights.  (A port
+ *  argument keeps the message from being "simple", even if the
+ *  value is MACH_PORT_NULL.)  The value MACH_PORT_DEAD is also a legal
+ *  value that can be carried in messages.  It indicates
+ *  that a port right was present, but it died.
+ */
+
+#define MACH_PORT_NULL		0  /* intentional loose typing */
+#define MACH_PORT_DEAD		((mach_port_name_t) ~0)
+#define MACH_PORT_VALID(name)				\
+		(((name) != MACH_PORT_NULL) && 		\
+		 ((name) != MACH_PORT_DEAD))
+
+
+/*
+ *	For kernel-selected [assigned] port names, the name is
+ *	comprised of two parts: a generation number and an index.
+ *	This approach keeps the exact same name from being generated
+ *	and reused too quickly [to catch right/reference counting bugs].
+ *	The dividing line between the constituent parts is exposed so
+ *	that efficient "mach_port_name_t to data structure pointer"
+ *	conversion implementation can be made.  But it is possible
+ *	for user-level code to assign their own names to Mach ports.
+ *	These are not required to participate in this algorithm.  So
+ *	care should be taken before "assuming" this model.
+ *
+ */
+
+#ifndef	NO_PORT_GEN
+
+#define	MACH_PORT_INDEX(name)		((name) >> 8)
+#define	MACH_PORT_GEN(name)		(((name) & 0xff) << 24)
+#define	MACH_PORT_MAKE(index, gen)	\
+		(((index) << 8) | (gen) >> 24)
+
+#else	/* NO_PORT_GEN */
+
+#define	MACH_PORT_INDEX(name)		(name)
+#define	MACH_PORT_GEN(name)		(0)
+#define	MACH_PORT_MAKE(index, gen)	(index)
+
+#endif	/* NO_PORT_GEN */
+
+
+/*
+ *  These are the different rights a task may have for a port.
+ *  The MACH_PORT_RIGHT_* definitions are used as arguments
+ *  to mach_port_allocate, mach_port_get_refs, etc, to specify
+ *  a particular right to act upon.  The mach_port_names and
+ *  mach_port_type calls return bitmasks using the MACH_PORT_TYPE_*
+ *  definitions.  This is because a single name may denote
+ *  multiple rights.
+ */
+
+typedef natural_t mach_port_right_t;
+
+#define MACH_PORT_RIGHT_SEND		((mach_port_right_t) 0)
+#define MACH_PORT_RIGHT_RECEIVE		((mach_port_right_t) 1)
+#define MACH_PORT_RIGHT_SEND_ONCE	((mach_port_right_t) 2)
+#define MACH_PORT_RIGHT_PORT_SET	((mach_port_right_t) 3)
+#define MACH_PORT_RIGHT_DEAD_NAME	((mach_port_right_t) 4)
+#define MACH_PORT_RIGHT_LABELH	        ((mach_port_right_t) 5)
+#define MACH_PORT_RIGHT_NUMBER		((mach_port_right_t) 6)
+
+typedef natural_t mach_port_type_t;
+typedef mach_port_type_t *mach_port_type_array_t;
+
+#define MACH_PORT_TYPE(right)						\
+		((mach_port_type_t)(((mach_port_type_t) 1)  		\
+		<< ((right) + ((mach_port_right_t) 16))))	
+#define MACH_PORT_TYPE_NONE	    ((mach_port_type_t) 0L)
+#define MACH_PORT_TYPE_SEND	    MACH_PORT_TYPE(MACH_PORT_RIGHT_SEND)
+#define MACH_PORT_TYPE_RECEIVE	    MACH_PORT_TYPE(MACH_PORT_RIGHT_RECEIVE)
+#define MACH_PORT_TYPE_SEND_ONCE    MACH_PORT_TYPE(MACH_PORT_RIGHT_SEND_ONCE)
+#define MACH_PORT_TYPE_PORT_SET	    MACH_PORT_TYPE(MACH_PORT_RIGHT_PORT_SET)
+#define MACH_PORT_TYPE_DEAD_NAME    MACH_PORT_TYPE(MACH_PORT_RIGHT_DEAD_NAME)
+#define MACH_PORT_TYPE_LABELH       MACH_PORT_TYPE(MACH_PORT_RIGHT_LABELH)
+
+/* Convenient combinations. */
+
+#define MACH_PORT_TYPE_SEND_RECEIVE					\
+		(MACH_PORT_TYPE_SEND|MACH_PORT_TYPE_RECEIVE)
+#define	MACH_PORT_TYPE_SEND_RIGHTS					\
+		(MACH_PORT_TYPE_SEND|MACH_PORT_TYPE_SEND_ONCE)
+#define	MACH_PORT_TYPE_PORT_RIGHTS					\
+		(MACH_PORT_TYPE_SEND_RIGHTS|MACH_PORT_TYPE_RECEIVE)
+#define	MACH_PORT_TYPE_PORT_OR_DEAD					\
+		(MACH_PORT_TYPE_PORT_RIGHTS|MACH_PORT_TYPE_DEAD_NAME)
+#define MACH_PORT_TYPE_ALL_RIGHTS					\
+		(MACH_PORT_TYPE_PORT_OR_DEAD|MACH_PORT_TYPE_PORT_SET)
+
+/* Dummy type bits that mach_port_type/mach_port_names can return. */
+
+#define MACH_PORT_TYPE_DNREQUEST		0x80000000
+#define MACH_PORT_TYPE_SPREQUEST		0x40000000
+#define MACH_PORT_TYPE_SPREQUEST_DELAYED	0x20000000
+
+/* User-references for capabilities. */
+
+typedef natural_t mach_port_urefs_t;
+typedef integer_t mach_port_delta_t;			/* change in urefs */
+
+/* Attributes of ports.  (See mach_port_get_receive_status.) */
+
+typedef natural_t mach_port_seqno_t;		/* sequence number */
+typedef natural_t mach_port_mscount_t;		/* make-send count */
+typedef natural_t mach_port_msgcount_t;		/* number of msgs */
+typedef natural_t mach_port_rights_t;		/* number of rights */
+
+/*
+ *	Are there outstanding send rights for a given port?
+ */
+#define	MACH_PORT_SRIGHTS_NONE		0		/* no srights */
+#define	MACH_PORT_SRIGHTS_PRESENT	1		/* srights */
+typedef unsigned int mach_port_srights_t;	/* status of send rights */
+
+typedef struct mach_port_status {
+	mach_port_rights_t	mps_pset;	/* count of containing port sets */
+	mach_port_seqno_t	mps_seqno;	/* sequence number */
+	mach_port_mscount_t	mps_mscount;	/* make-send count */
+	mach_port_msgcount_t	mps_qlimit;	/* queue limit */
+	mach_port_msgcount_t	mps_msgcount;	/* number in the queue */
+	mach_port_rights_t	mps_sorights;	/* how many send-once rights */
+	boolean_t		mps_srights;	/* do send rights exist? */
+	boolean_t		mps_pdrequest;	/* port-deleted requested? */
+	boolean_t		mps_nsrequest;	/* no-senders requested? */
+	natural_t		mps_flags;		/* port flags */
+} mach_port_status_t;
+
+/* System-wide values for setting queue limits on a port */
+#define MACH_PORT_QLIMIT_ZERO		((mach_port_msgcount_t) 0)
+#define MACH_PORT_QLIMIT_BASIC		((mach_port_msgcount_t) 5)
+#define MACH_PORT_QLIMIT_SMALL		((mach_port_msgcount_t) 16)
+#define MACH_PORT_QLIMIT_LARGE		((mach_port_msgcount_t) 1024)
+#define MACH_PORT_QLIMIT_KERNEL		((mach_port_msgcount_t) 65536)
+#define MACH_PORT_QLIMIT_MIN		MACH_PORT_QLIMIT_ZERO
+#define MACH_PORT_QLIMIT_DEFAULT	MACH_PORT_QLIMIT_BASIC
+#define MACH_PORT_QLIMIT_MAX		MACH_PORT_QLIMIT_LARGE
+
+typedef struct mach_port_limits {
+	mach_port_msgcount_t	mpl_qlimit;	/* number of msgs */
+} mach_port_limits_t;
+
+/* Possible values for mps_flags (part of mach_port_status_t) */
+#define MACH_PORT_STATUS_FLAG_TEMPOWNER		0x01
+#define MACH_PORT_STATUS_FLAG_GUARDED		0x02
+#define MACH_PORT_STATUS_FLAG_STRICT_GUARD	0x04
+#define MACH_PORT_STATUS_FLAG_IMP_DONATION	0x08
+#define MACH_PORT_STATUS_FLAG_REVIVE		0x10
+#define MACH_PORT_STATUS_FLAG_TASKPTR		0x20
+
+typedef struct mach_port_info_ext {
+	mach_port_status_t	mpie_status;
+	mach_port_msgcount_t	mpie_boost_cnt;
+	uint32_t		reserved[6];
+} mach_port_info_ext_t;
+
+typedef integer_t *mach_port_info_t;		/* varying array of natural_t */
+
+/* Flavors for mach_port_get/set_attributes() */
+typedef int	mach_port_flavor_t;
+#define MACH_PORT_LIMITS_INFO		1	/* uses mach_port_status_t */
+#define MACH_PORT_RECEIVE_STATUS	2	/* uses mach_port_limits_t */
+#define MACH_PORT_DNREQUESTS_SIZE	3	/* info is int */
+#define MACH_PORT_TEMPOWNER		4	/* indicates receive right will be reassigned to another task */
+#define MACH_PORT_IMPORTANCE_RECEIVER	5	/* indicates recieve right accepts priority donation */
+#define MACH_PORT_DENAP_RECEIVER	6	/* indicates receive right accepts de-nap donation */
+#define MACH_PORT_INFO_EXT		7	/* uses mach_port_info_ext_t */
+
+#define MACH_PORT_LIMITS_INFO_COUNT	((natural_t) \
+	(sizeof(mach_port_limits_t)/sizeof(natural_t)))
+#define MACH_PORT_RECEIVE_STATUS_COUNT	((natural_t) \
+	(sizeof(mach_port_status_t)/sizeof(natural_t)))
+#define MACH_PORT_DNREQUESTS_SIZE_COUNT 1
+#define MACH_PORT_INFO_EXT_COUNT	((natural_t) \
+	(sizeof(mach_port_info_ext_t)/sizeof(natural_t)))
+/*
+ * Structure used to pass information about port allocation requests.
+ * Must be padded to 64-bits total length.
+ */
+typedef struct mach_port_qos {
+	unsigned int		name:1;		/* name given */
+	unsigned int 		prealloc:1;	/* prealloced message */
+	boolean_t		pad1:30;
+	natural_t		len;
+} mach_port_qos_t;
+
+/* Mach Port Guarding definitions */
+
+/*
+ * Flags for mach_port_options (used for
+ * invocation of mach_port_construct).
+ * Indicates attributes to be set for the newly
+ * allocated port.
+ */
+#define MPO_CONTEXT_AS_GUARD	0x01	/* Add guard to the port */
+#define MPO_QLIMIT		0x02	/* Set qlimit for the port msg queue */
+#define MPO_TEMPOWNER		0x04	/* Set the tempowner bit of the port */
+#define MPO_IMPORTANCE_RECEIVER 0x08	/* Mark the port as importance receiver */
+#define MPO_INSERT_SEND_RIGHT   0x10	/* Insert a send right for the port */
+#define MPO_STRICT		0x20	/* Apply strict guarding for port */
+#define MPO_DENAP_RECEIVER	0x40	/* Mark the port as App de-nap receiver */
+/*
+ * Structure to define optional attributes for a newly
+ * constructed port.
+ */
+typedef struct mach_port_options {
+	uint32_t		flags;		/* Flags defining attributes for port */
+	mach_port_limits_t	mpl;		/* Message queue limit for port */
+	uint64_t		reserved[2];	/* Reserved */
+}mach_port_options_t;
+
+typedef mach_port_options_t *mach_port_options_ptr_t;
+
+/*
+ * EXC_GUARD represents a guard violation for both
+ * mach ports and file descriptors. GUARD_TYPE_ is used
+ * to differentiate among them.
+ */
+#define GUARD_TYPE_MACH_PORT	0x1
+
+/* Reasons for exception for a guarded mach port */
+enum mach_port_guard_exception_codes {
+	kGUARD_EXC_DESTROY		= 1u << 0,
+	kGUARD_EXC_MOD_REFS		= 1u << 1,
+	kGUARD_EXC_SET_CONTEXT		= 1u << 2,
+	kGUARD_EXC_UNGUARDED		= 1u << 3,
+	kGUARD_EXC_INCORRECT_GUARD	= 1u << 4
+};
+
+#if	!__DARWIN_UNIX03 && !defined(_NO_PORT_T_FROM_MACH)
+/*
+ *  Mach 3.0 renamed everything to have mach_ in front of it.
+ *  These types and macros are provided for backward compatibility
+ *	but are deprecated.
+ */
+typedef mach_port_t		port_t;
+typedef mach_port_name_t	port_name_t;
+typedef mach_port_name_t	*port_name_array_t;
+
+#define PORT_NULL		((port_t) 0)
+#define PORT_DEAD		((port_t) ~0)
+#define PORT_VALID(name) \
+		((port_t)(name) != PORT_NULL && (port_t)(name) != PORT_DEAD)
+
+#endif	/* !__DARWIN_UNIX03 && !_NO_PORT_T_FROM_MACH */
+
+#endif	/* _MACH_PORT_H_ */
diff -Nur cctools-877.5/include/mach/port_obj.h cctools-877.5-AnV/include/mach/port_obj.h
--- cctools-877.5/include/mach/port_obj.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/port_obj.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,103 @@
+/*
+ * Copyright (c) 2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+/*
+ * Define a service to map from a kernel-generated port name
+ * to server-defined "type" and "value" data to be associated
+ * with the port.
+ */
+
+#ifndef PORT_OBJ_H
+#define PORT_OBJ_H
+
+#include <mach/port.h>
+
+struct port_obj_tentry {
+	void *pos_value;
+	int pos_type;
+};
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+extern void port_obj_init(int);
+__END_DECLS
+
+extern struct port_obj_tentry *port_obj_table;
+extern int port_obj_table_size;
+
+#ifndef PORT_OBJ_ASSERT
+
+#define port_set_obj_value_type(pname, value, type)	\
+do {							\
+	int ndx;					\
+							\
+	if (!port_obj_table)				\
+		port_obj_init(port_obj_table_size);	\
+	ndx = MACH_PORT_INDEX(pname);			\
+	port_obj_table[ndx].pos_value = (value);	\
+	port_obj_table[ndx].pos_type = (type);		\
+} while (0)
+
+#define port_get_obj_value(pname)			\
+	(port_obj_table[MACH_PORT_INDEX(pname)].pos_value)
+
+#define port_get_obj_type(pname)			\
+	(port_obj_table[MACH_PORT_INDEX(pname)].pos_type)
+
+#else	/* PORT_OBJ_ASSERT */
+
+#define port_set_obj_value_type(pname, value, type)	\
+do {							\
+	int ndx;					\
+							\
+	if (!port_obj_table)				\
+		port_obj_init(port_obj_table_size);	\
+	ndx = MACH_PORT_INDEX(pname);			\
+	assert(ndx > 0);				\
+	assert(ndx < port_obj_table_size);		\
+	port_obj_table[ndx].pos_value = (value);	\
+	port_obj_table[ndx].pos_type = (type);		\
+} while (0)
+
+#define port_get_obj_value(pname)				\
+	((MACH_PORT_INDEX(pname) < (unsigned)port_obj_table_size) ?	\
+	port_obj_table[MACH_PORT_INDEX(pname)].pos_value :	\
+	(panic("port_get_obj_value: index too big"), (void *)-1))
+
+#define port_get_obj_type(pname)				\
+	((MACH_PORT_INDEX(pname) < (unsigned)port_obj_table_size) ?	\
+	port_obj_table[MACH_PORT_INDEX(pname)].pos_type :	\
+	(panic("port_get_obj_type: index too big"), -1))
+
+#endif	/* PORT_OBJ_ASSERT */
+
+#endif	/* PORT_OBJ_H */
diff -Nur cctools-877.5/include/mach/processor.defs cctools-877.5-AnV/include/mach/processor.defs
--- cctools-877.5/include/mach/processor.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/processor.defs	2015-11-16 07:56:14 +0000
@@ -0,0 +1,128 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_port.defs
+ *	Author:	Rich Draves
+ *
+ *	Exported kernel calls.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  processor 3000;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+/*
+ * References to processor objects are returned by:
+ *	host_processors(host_priv_t,...);
+ */
+/*
+ *	Start processor.
+ */
+routine	processor_start(
+		processor	: processor_t);
+
+/*
+ *	Exit processor -- may not be restartable.
+ */
+
+routine	processor_exit(
+		processor	: processor_t);
+
+/*
+ *	Return information about this processor.
+ */
+routine processor_info(
+		processor	: processor_t;
+		flavor		: processor_flavor_t;
+	out	host		: host_t;
+	out	processor_info_out: processor_info_t, CountInOut);
+
+
+/*
+ *	Do something machine-dependent to processor.
+ */
+routine processor_control(
+		processor	: processor_t;
+		processor_cmd	: processor_info_t);
+
+/*
+ * JMM - Keep processor_set related stuff at the end because
+ * they likely will be removed.
+ */
+
+/*
+ *	Assign processor to processor set.
+ */
+routine processor_assign(
+		processor	: processor_t;
+		new_set		: processor_set_t;
+		wait		: boolean_t);
+
+/*
+ *	Get current assignment for processor.
+ */
+routine processor_get_assignment(
+		processor	: processor_t;
+	out	assigned_set	: processor_set_name_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/processor.h cctools-877.5-AnV/include/mach/processor.h
--- cctools-877.5/include/mach/processor.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/processor.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,337 @@
+#ifndef	_processor_user_
+#define	_processor_user_
+
+/* Module processor */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	processor_MSG_COUNT
+#define	processor_MSG_COUNT	6
+#endif	/* processor_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine processor_start */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_start
+(
+	processor_t processor
+);
+
+/* Routine processor_exit */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_exit
+(
+	processor_t processor
+);
+
+/* Routine processor_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_info
+(
+	processor_t processor,
+	processor_flavor_t flavor,
+	host_t *host,
+	processor_info_t processor_info_out,
+	mach_msg_type_number_t *processor_info_outCnt
+);
+
+/* Routine processor_control */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_control
+(
+	processor_t processor,
+	processor_info_t processor_cmd,
+	mach_msg_type_number_t processor_cmdCnt
+);
+
+/* Routine processor_assign */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_assign
+(
+	processor_t processor,
+	processor_set_t new_set,
+	boolean_t wait
+);
+
+/* Routine processor_get_assignment */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_get_assignment
+(
+	processor_t processor,
+	processor_set_name_t *assigned_set
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__processor_subsystem__defined
+#define __Request__processor_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_start_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_exit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		processor_flavor_t flavor;
+		mach_msg_type_number_t processor_info_outCnt;
+	} __Request__processor_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_msg_type_number_t processor_cmdCnt;
+		integer_t processor_cmd[12];
+	} __Request__processor_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t wait;
+	} __Request__processor_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__processor_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__processor_subsystem__defined
+#define __RequestUnion__processor_subsystem__defined
+union __RequestUnion__processor_subsystem {
+	__Request__processor_start_t Request_processor_start;
+	__Request__processor_exit_t Request_processor_exit;
+	__Request__processor_info_t Request_processor_info;
+	__Request__processor_control_t Request_processor_control;
+	__Request__processor_assign_t Request_processor_assign;
+	__Request__processor_get_assignment_t Request_processor_get_assignment;
+};
+#endif /* !__RequestUnion__processor_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__processor_subsystem__defined
+#define __Reply__processor_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_start_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_exit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t host;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t processor_info_outCnt;
+		integer_t processor_info_out[12];
+	} __Reply__processor_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t assigned_set;
+		/* end of the kernel processed data */
+	} __Reply__processor_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__processor_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__processor_subsystem__defined
+#define __ReplyUnion__processor_subsystem__defined
+union __ReplyUnion__processor_subsystem {
+	__Reply__processor_start_t Reply_processor_start;
+	__Reply__processor_exit_t Reply_processor_exit;
+	__Reply__processor_info_t Reply_processor_info;
+	__Reply__processor_control_t Reply_processor_control;
+	__Reply__processor_assign_t Reply_processor_assign;
+	__Reply__processor_get_assignment_t Reply_processor_get_assignment;
+};
+#endif /* !__RequestUnion__processor_subsystem__defined */
+
+#ifndef subsystem_to_name_map_processor
+#define subsystem_to_name_map_processor \
+    { "processor_start", 3000 },\
+    { "processor_exit", 3001 },\
+    { "processor_info", 3002 },\
+    { "processor_control", 3003 },\
+    { "processor_assign", 3004 },\
+    { "processor_get_assignment", 3005 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _processor_user_ */
diff -Nur cctools-877.5/include/mach/processor_info.h cctools-877.5-AnV/include/mach/processor_info.h
--- cctools-877.5/include/mach/processor_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/processor_info.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,153 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	mach/processor_info.h
+ *	Author:	David L. Black
+ *	Date:	1988
+ *
+ *	Data structure definitions for processor_info, processor_set_info
+ */
+
+#ifndef	_MACH_PROCESSOR_INFO_H_
+#define _MACH_PROCESSOR_INFO_H_
+
+#include <mach/message.h>
+#include <mach/machine.h>
+#include <mach/machine/processor_info.h>
+
+/*
+ *	Generic information structure to allow for expansion.
+ */
+typedef integer_t	*processor_info_t;	/* varying array of int. */
+typedef integer_t	*processor_info_array_t;  /* varying array of int */
+
+#define PROCESSOR_INFO_MAX	(1024)	/* max array size */
+typedef integer_t	processor_info_data_t[PROCESSOR_INFO_MAX];
+
+
+typedef integer_t	*processor_set_info_t;	/* varying array of int. */
+
+#define PROCESSOR_SET_INFO_MAX	(1024)	/* max array size */
+typedef integer_t	processor_set_info_data_t[PROCESSOR_SET_INFO_MAX];
+
+/*
+ *	Currently defined information.
+ */
+typedef int	processor_flavor_t;
+#define	PROCESSOR_BASIC_INFO	1		/* basic information */
+#define	PROCESSOR_CPU_LOAD_INFO	2	/* cpu load information */
+#define	PROCESSOR_PM_REGS_INFO	0x10000001	/* performance monitor register info */
+#define	PROCESSOR_TEMPERATURE	0x10000002	/* Processor core temperature */
+
+struct processor_basic_info {
+	cpu_type_t	cpu_type;	/* type of cpu */
+	cpu_subtype_t	cpu_subtype;	/* subtype of cpu */
+	boolean_t	running;	/* is processor running */
+	int		slot_num;	/* slot number */
+	boolean_t	is_master;	/* is this the master processor */
+};
+
+typedef	struct processor_basic_info	processor_basic_info_data_t;
+typedef struct processor_basic_info	*processor_basic_info_t;
+#define PROCESSOR_BASIC_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof(processor_basic_info_data_t)/sizeof(natural_t)))
+
+struct processor_cpu_load_info {             /* number of ticks while running... */
+        unsigned int	cpu_ticks[CPU_STATE_MAX]; /* ... in the given mode */
+}; 
+
+typedef	struct processor_cpu_load_info	processor_cpu_load_info_data_t;
+typedef struct processor_cpu_load_info	*processor_cpu_load_info_t;
+#define PROCESSOR_CPU_LOAD_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof(processor_cpu_load_info_data_t)/sizeof(natural_t)))
+
+/*
+ *	Scaling factor for load_average, mach_factor.
+ */
+#define	LOAD_SCALE	1000		
+
+typedef	int	processor_set_flavor_t;
+#define	PROCESSOR_SET_BASIC_INFO	5	/* basic information */
+
+struct processor_set_basic_info {
+	int		processor_count;	/* How many processors */
+	int		default_policy;		/* When others not enabled */
+};
+
+typedef	struct processor_set_basic_info	processor_set_basic_info_data_t;
+typedef struct processor_set_basic_info	*processor_set_basic_info_t;
+#define PROCESSOR_SET_BASIC_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof(processor_set_basic_info_data_t)/sizeof(natural_t)))
+
+#define PROCESSOR_SET_LOAD_INFO		4	/* scheduling statistics */
+
+struct processor_set_load_info {
+        int             task_count;             /* How many tasks */
+        int             thread_count;           /* How many threads */
+        integer_t       load_average;           /* Scaled */
+        integer_t       mach_factor;            /* Scaled */
+};
+
+typedef struct processor_set_load_info processor_set_load_info_data_t;
+typedef struct processor_set_load_info *processor_set_load_info_t;
+#define PROCESSOR_SET_LOAD_INFO_COUNT	((mach_msg_type_number_t) \
+                (sizeof(processor_set_load_info_data_t)/sizeof(natural_t)))
+
+
+#endif	/* _MACH_PROCESSOR_INFO_H_ */
diff -Nur cctools-877.5/include/mach/processor_set.defs cctools-877.5-AnV/include/mach/processor_set.defs
--- cctools-877.5/include/mach/processor_set.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/processor_set.defs	2015-11-16 07:56:14 +0000
@@ -0,0 +1,161 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_port.defs
+ *	Author:	Rich Draves
+ *
+ *	Exported kernel calls.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  processor_set 4000;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+/*
+ *      Return scheduling statistics for a processor set.
+ */
+routine processor_set_statistics(
+        	pset                    : processor_set_name_t;
+        	flavor                  : processor_set_flavor_t;
+	out     info_out        	: processor_set_info_t, CountInOut);
+
+
+/*
+ *	Destroy processor set.
+ */
+routine processor_set_destroy(
+		set		: processor_set_t);
+
+
+/*
+ *	Set max priority for processor_set.
+ */
+routine processor_set_max_priority(
+		processor_set	: processor_set_t;
+		max_priority	: int;
+		change_threads	: boolean_t);
+
+/*
+ *	Enable policy for processor set
+ */
+routine processor_set_policy_enable(
+		processor_set	: processor_set_t;
+		policy		: int);
+
+/*
+ *	Disable policy for processor set
+ */
+routine processor_set_policy_disable(
+		processor_set	: processor_set_t;
+		policy		: int;
+		change_threads	: boolean_t);
+
+/*
+ *	List all tasks in processor set.
+ */
+routine processor_set_tasks(
+		processor_set	: processor_set_t;
+	out	task_list	: task_array_t);
+
+/*
+ *	List all threads in processor set.
+ */
+routine processor_set_threads(
+		processor_set	: processor_set_t;
+	out	thread_list	: thread_act_array_t);
+
+/*
+ *      Controls the scheduling attributes governing the processor set.
+ *      Allows control of enabled policies, and per-policy base and limit
+ *      priorities.
+ */
+routine processor_set_policy_control(
+	pset			: processor_set_t;
+	flavor			: processor_set_flavor_t;
+	policy_info		: processor_set_info_t;
+	change			: boolean_t);
+
+
+/*
+ *	Debug Info
+ *      This call is only valid on MACH_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ */
+routine processor_set_stack_usage(
+		pset		: processor_set_t;
+	out	ltotal		: unsigned;
+	out	space		: vm_size_t;
+	out	resident	: vm_size_t;
+	out	maxusage	: vm_size_t;
+	out	maxstack	: vm_offset_t);
+
+/*
+ *      Get information about processor set.
+ */
+routine processor_set_info(
+                set_name        : processor_set_name_t;
+                flavor          : int;
+        out     host            : host_t;
+        out     info_out        : processor_set_info_t, CountInOut);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/processor_set.h cctools-877.5-AnV/include/mach/processor_set.h
--- cctools-877.5/include/mach/processor_set.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/processor_set.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,517 @@
+#ifndef	_processor_set_user_
+#define	_processor_set_user_
+
+/* Module processor_set */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	processor_set_MSG_COUNT
+#define	processor_set_MSG_COUNT	10
+#endif	/* processor_set_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine processor_set_statistics */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_statistics
+(
+	processor_set_name_t pset,
+	processor_set_flavor_t flavor,
+	processor_set_info_t info_out,
+	mach_msg_type_number_t *info_outCnt
+);
+
+/* Routine processor_set_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_destroy
+(
+	processor_set_t set
+);
+
+/* Routine processor_set_max_priority */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_max_priority
+(
+	processor_set_t processor_set,
+	int max_priority,
+	boolean_t change_threads
+);
+
+/* Routine processor_set_policy_enable */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_policy_enable
+(
+	processor_set_t processor_set,
+	int policy
+);
+
+/* Routine processor_set_policy_disable */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_policy_disable
+(
+	processor_set_t processor_set,
+	int policy,
+	boolean_t change_threads
+);
+
+/* Routine processor_set_tasks */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_tasks
+(
+	processor_set_t processor_set,
+	task_array_t *task_list,
+	mach_msg_type_number_t *task_listCnt
+);
+
+/* Routine processor_set_threads */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_threads
+(
+	processor_set_t processor_set,
+	thread_act_array_t *thread_list,
+	mach_msg_type_number_t *thread_listCnt
+);
+
+/* Routine processor_set_policy_control */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_policy_control
+(
+	processor_set_t pset,
+	processor_set_flavor_t flavor,
+	processor_set_info_t policy_info,
+	mach_msg_type_number_t policy_infoCnt,
+	boolean_t change
+);
+
+/* Routine processor_set_stack_usage */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_stack_usage
+(
+	processor_set_t pset,
+	unsigned *ltotal,
+	vm_size_t *space,
+	vm_size_t *resident,
+	vm_size_t *maxusage,
+	vm_offset_t *maxstack
+);
+
+/* Routine processor_set_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_info
+(
+	processor_set_name_t set_name,
+	int flavor,
+	host_t *host,
+	processor_set_info_t info_out,
+	mach_msg_type_number_t *info_outCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__processor_set_subsystem__defined
+#define __Request__processor_set_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		processor_set_flavor_t flavor;
+		mach_msg_type_number_t info_outCnt;
+	} __Request__processor_set_statistics_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int max_priority;
+		boolean_t change_threads;
+	} __Request__processor_set_max_priority_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int policy;
+	} __Request__processor_set_policy_enable_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int policy;
+		boolean_t change_threads;
+	} __Request__processor_set_policy_disable_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_set_tasks_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_set_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		processor_set_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[5];
+		boolean_t change;
+	} __Request__processor_set_policy_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_set_stack_usage_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int flavor;
+		mach_msg_type_number_t info_outCnt;
+	} __Request__processor_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__processor_set_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__processor_set_subsystem__defined
+#define __RequestUnion__processor_set_subsystem__defined
+union __RequestUnion__processor_set_subsystem {
+	__Request__processor_set_statistics_t Request_processor_set_statistics;
+	__Request__processor_set_destroy_t Request_processor_set_destroy;
+	__Request__processor_set_max_priority_t Request_processor_set_max_priority;
+	__Request__processor_set_policy_enable_t Request_processor_set_policy_enable;
+	__Request__processor_set_policy_disable_t Request_processor_set_policy_disable;
+	__Request__processor_set_tasks_t Request_processor_set_tasks;
+	__Request__processor_set_threads_t Request_processor_set_threads;
+	__Request__processor_set_policy_control_t Request_processor_set_policy_control;
+	__Request__processor_set_stack_usage_t Request_processor_set_stack_usage;
+	__Request__processor_set_info_t Request_processor_set_info;
+};
+#endif /* !__RequestUnion__processor_set_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__processor_set_subsystem__defined
+#define __Reply__processor_set_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t info_outCnt;
+		integer_t info_out[5];
+	} __Reply__processor_set_statistics_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_set_max_priority_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_set_policy_enable_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_set_policy_disable_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t task_list;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t task_listCnt;
+	} __Reply__processor_set_tasks_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t thread_list;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t thread_listCnt;
+	} __Reply__processor_set_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_set_policy_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		unsigned ltotal;
+		vm_size_t space;
+		vm_size_t resident;
+		vm_size_t maxusage;
+		vm_offset_t maxstack;
+	} __Reply__processor_set_stack_usage_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t host;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t info_outCnt;
+		integer_t info_out[5];
+	} __Reply__processor_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__processor_set_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__processor_set_subsystem__defined
+#define __ReplyUnion__processor_set_subsystem__defined
+union __ReplyUnion__processor_set_subsystem {
+	__Reply__processor_set_statistics_t Reply_processor_set_statistics;
+	__Reply__processor_set_destroy_t Reply_processor_set_destroy;
+	__Reply__processor_set_max_priority_t Reply_processor_set_max_priority;
+	__Reply__processor_set_policy_enable_t Reply_processor_set_policy_enable;
+	__Reply__processor_set_policy_disable_t Reply_processor_set_policy_disable;
+	__Reply__processor_set_tasks_t Reply_processor_set_tasks;
+	__Reply__processor_set_threads_t Reply_processor_set_threads;
+	__Reply__processor_set_policy_control_t Reply_processor_set_policy_control;
+	__Reply__processor_set_stack_usage_t Reply_processor_set_stack_usage;
+	__Reply__processor_set_info_t Reply_processor_set_info;
+};
+#endif /* !__RequestUnion__processor_set_subsystem__defined */
+
+#ifndef subsystem_to_name_map_processor_set
+#define subsystem_to_name_map_processor_set \
+    { "processor_set_statistics", 4000 },\
+    { "processor_set_destroy", 4001 },\
+    { "processor_set_max_priority", 4002 },\
+    { "processor_set_policy_enable", 4003 },\
+    { "processor_set_policy_disable", 4004 },\
+    { "processor_set_tasks", 4005 },\
+    { "processor_set_threads", 4006 },\
+    { "processor_set_policy_control", 4007 },\
+    { "processor_set_stack_usage", 4008 },\
+    { "processor_set_info", 4009 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _processor_set_user_ */
diff -Nur cctools-877.5/include/mach/rpc.h cctools-877.5-AnV/include/mach/rpc.h
--- cctools-877.5/include/mach/rpc.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/rpc.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,135 @@
+/*
+ * Copyright (c) 2002,2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+/*
+ * Mach RPC Subsystem Interfaces
+ */
+
+#ifndef	_MACH_RPC_H_
+#define _MACH_RPC_H_
+
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/port.h>
+#include <mach/vm_types.h>
+
+#include <mach/mig.h>
+#include <mach/mig_errors.h>
+#include <mach/machine/rpc.h>
+#include <mach/thread_status.h>
+
+/*
+ * These are the types for RPC-specific variants of the MIG routine
+ * descriptor and subsystem data types.
+ *
+ * THIS IS ONLY FOR COMPATIBILITY.  WE WILL NOT BE IMPLEMENTING THIS.
+ */
+
+/*
+ * Basic mach rpc types.
+ */
+typedef unsigned int    routine_arg_type;
+typedef unsigned int	routine_arg_offset;
+typedef unsigned int	routine_arg_size;
+
+/*
+ * Definitions for a signature's argument and routine descriptor's.
+ */
+struct rpc_routine_arg_descriptor {
+	routine_arg_type	type;	   /* Port, Array, etc. */
+        routine_arg_size        size;      /* element size in bytes */
+        routine_arg_size        count;     /* number of elements */
+	routine_arg_offset	offset;	   /* Offset in list of routine args */
+};
+typedef struct rpc_routine_arg_descriptor *rpc_routine_arg_descriptor_t;
+
+struct rpc_routine_descriptor {
+	mig_impl_routine_t	impl_routine;	/* Server work func pointer   */
+	mig_stub_routine_t	stub_routine;	/* Unmarshalling func pointer */
+	unsigned int		argc;		/* Number of argument words   */
+	unsigned int		descr_count;	/* Number of complex argument */
+					        /* descriptors                */
+	rpc_routine_arg_descriptor_t
+				arg_descr;	/* Pointer to beginning of    */
+						/* the arg_descr array        */
+	unsigned int		max_reply_msg;	/* Max size for reply msg     */
+};
+typedef struct rpc_routine_descriptor *rpc_routine_descriptor_t;
+
+#define RPC_DESCR_SIZE(x) ((x)->descr_count * \
+				sizeof(struct rpc_routine_arg_descriptor))
+
+struct rpc_signature {
+    struct rpc_routine_descriptor rd;
+    struct rpc_routine_arg_descriptor rad[1];
+};
+
+#define RPC_SIGBUF_SIZE 8
+
+/*
+ *	A subsystem describes a set of server routines that can be invoked by
+ *	mach_rpc() on the ports that are registered with the subsystem.  For
+ *	each routine, the routine number is given, along with the
+ *	address of the implementation function in the server and a
+ *	description of the arguments of the routine (it's "signature").
+ *
+ *	This structure definition is only a template for what is really a
+ *	variable-length structure (generated by MIG for each subsystem).
+ *	The actual structures do not always have one entry in the routine
+ *	array, and also have a varying number of entries in the arg_descr
+ *	array.  Each routine has an array of zero or more arg descriptors
+ *	one for each complex arg.  These arrays are all catenated together
+ *	to form the arg_descr field of the subsystem struct.  The
+ *	arg_descr field of each routine entry points to a unique sub-sequence
+ *	within this catenated array.  The goal is to keep everything
+ *	contiguous.
+ */
+struct rpc_subsystem {
+	void		*reserved;	/* Reserved for system use */
+
+	mach_msg_id_t	start;		/* Min routine number */
+	mach_msg_id_t	end;		/* Max routine number + 1 */
+	unsigned int	maxsize;	/* Max mach_msg size */
+	vm_address_t	base_addr;	/* Address of this struct in user */
+
+	struct rpc_routine_descriptor	/* Array of routine descriptors */
+			routine[1       /* Actually, (start-end+1) */
+				 ];
+
+	struct rpc_routine_arg_descriptor
+			arg_descriptor[1   /* Actually, the sum of the descr_ */
+					]; /* count fields for all routines   */
+};
+typedef struct rpc_subsystem  *rpc_subsystem_t;
+
+#define RPC_SUBSYSTEM_NULL	((rpc_subsystem_t) 0)
+
+#endif	/* _MACH_RPC_H_ */
diff -Nur cctools-877.5/include/mach/sdt.h cctools-877.5-AnV/include/mach/sdt.h
--- cctools-877.5/include/mach/sdt.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/sdt.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,32 @@
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License, Version 1.0 only
+ * (the "License").  You may not use this file except in compliance
+ * with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+/*
+ * Copyright 2004 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef _MACH_SDT_H
+#define	_MACH_SDT_H
+
+#include <mach/machine/sdt.h>
+
+#endif	/* _MACH_SDT_H */
diff -Nur cctools-877.5/include/mach/semaphore.h cctools-877.5-AnV/include/mach/semaphore.h
--- cctools-877.5/include/mach/semaphore.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/semaphore.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,78 @@
+/*
+ * Copyright (c) 2000-2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_SEMAPHORE_H_
+#define _MACH_SEMAPHORE_H_
+
+#include <mach/port.h>
+#include <mach/mach_types.h>
+#include <mach/kern_return.h>
+#include <mach/sync_policy.h>
+
+/*
+ *	Forward Declarations
+ *
+ *	The semaphore creation and deallocation routines are
+ *	defined with the Mach task APIs in <mach/task.h>.
+ *
+ *      kern_return_t	semaphore_create(task_t task,
+ *                                       semaphore_t *new_semaphore,
+ *					 sync_policy_t policy,
+ *					 int value);
+ *
+ *	kern_return_t	semaphore_destroy(task_t task,
+ *					  semaphore_t semaphore);
+ */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+extern	kern_return_t	semaphore_signal     	(semaphore_t semaphore);
+extern	kern_return_t	semaphore_signal_all 	(semaphore_t semaphore);
+
+extern	kern_return_t	semaphore_wait       	(semaphore_t semaphore);
+
+
+extern	kern_return_t	semaphore_timedwait    	(semaphore_t semaphore, 
+												 mach_timespec_t wait_time);
+
+extern  kern_return_t	semaphore_timedwait_signal(semaphore_t wait_semaphore,
+												   semaphore_t signal_semaphore,
+												   mach_timespec_t wait_time);
+
+extern  kern_return_t   semaphore_wait_signal   (semaphore_t wait_semaphore,
+                                                 semaphore_t signal_semaphore);
+
+extern	kern_return_t	semaphore_signal_thread	(semaphore_t semaphore,
+                                                 thread_t thread);
+
+
+__END_DECLS
+
+
+#endif	/* _MACH_SEMAPHORE_H_ */
diff -Nur cctools-877.5/include/mach/shared_memory_server.h cctools-877.5-AnV/include/mach/shared_memory_server.h
--- cctools-877.5/include/mach/shared_memory_server.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/shared_memory_server.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,133 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ *
+ *	File: mach/shared_memory_server.h
+ *
+ * 	protos and struct definitions for shared library
+ *	server and interface
+ */
+
+/*
+ * XXX
+ * 
+ * NOTE: this file is deprecated and will be removed in the near future.
+ * Any project that includes this file should be changed to:
+ * 1. use <mach/shared_region.h> instead of this file,
+ * 2. handle the new shared regions, now available on more platforms
+ */
+
+#ifndef _MACH_SHARED_MEMORY_SERVER_H_
+#define _MACH_SHARED_MEMORY_SERVER_H_
+
+#warning "<mach/shared_memory_server.h> is deprecated.  Please use <mach/shared_region.h> instead."
+
+#include <sys/cdefs.h>
+#include <mach/vm_prot.h>
+#include <mach/vm_types.h>
+#include <mach/mach_types.h>
+
+#define VM_PROT_COW  0x8  /* must not interfere with normal prot assignments */
+#define VM_PROT_ZF  0x10  /* must not interfere with normal prot assignments */
+
+#define GLOBAL_SHARED_TEXT_SEGMENT	0x90000000U
+#define GLOBAL_SHARED_DATA_SEGMENT	0xA0000000U
+#define GLOBAL_SHARED_SEGMENT_MASK	0xF0000000U
+
+#define	SHARED_TEXT_REGION_SIZE		0x10000000
+#define	SHARED_DATA_REGION_SIZE		0x10000000
+
+#if !defined(__LP64__)
+
+#define	SHARED_LIBRARY_SERVER_SUPPORTED
+
+#define	SHARED_ALTERNATE_LOAD_BASE	0x09000000
+
+/* 
+ *  Note: the two masks below are useful because the assumption is 
+ *  made that these shared regions will always be mapped on natural boundaries 
+ *  i.e. if the size is 0x10000000 the object can be mapped at 
+ *  0x20000000, or 0x30000000, but not 0x1000000
+ */
+#define	SHARED_TEXT_REGION_MASK		0x0FFFFFFF
+#define	SHARED_DATA_REGION_MASK		0x0FFFFFFF
+
+
+/* flags field aliases for copyin_shared_file and load_shared_file */
+
+/* IN */
+#define ALTERNATE_LOAD_SITE 0x1
+#define NEW_LOCAL_SHARED_REGIONS 0x2
+#define	QUERY_IS_SYSTEM_REGION 0x4
+
+/* OUT */
+#define SF_PREV_LOADED    0x1
+#define SYSTEM_REGION_BACKED 0x2
+
+
+struct sf_mapping {
+	vm_offset_t	mapping_offset;
+	vm_size_t	size;
+	vm_offset_t	file_offset;
+	vm_prot_t	protection;  /* read/write/execute/COW/ZF */
+	vm_offset_t	cksum;
+};
+typedef struct sf_mapping sf_mapping_t;
+
+#endif  /* !defined(__LP64__) */
+
+/* 
+ * All shared_region_* declarations are a private interface
+ * between dyld and the kernel.
+ *
+ */
+struct shared_file_mapping_np {
+	mach_vm_address_t	sfm_address;
+	mach_vm_size_t		sfm_size;
+	mach_vm_offset_t	sfm_file_offset;
+	vm_prot_t		sfm_max_prot;
+	vm_prot_t		sfm_init_prot;
+};
+
+struct shared_region_range_np {
+	mach_vm_address_t	srr_address;
+	mach_vm_size_t		srr_size;
+};
+
+
+__BEGIN_DECLS
+int	shared_region_map_file_np(int fd,
+				  uint32_t mappingCount,
+				  const struct shared_file_mapping_np *mappings,
+				  int64_t *slide_p);
+int	shared_region_make_private_np(uint32_t rangeCount,
+				      const struct shared_region_range_np *ranges);
+__END_DECLS
+
+
+#endif /* _MACH_SHARED_MEMORY_SERVER_H_ */
diff -Nur cctools-877.5/include/mach/shared_region.h cctools-877.5-AnV/include/mach/shared_region.h
--- cctools-877.5/include/mach/shared_region.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/shared_region.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,122 @@
+/*
+ * Copyright (c) 2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ *
+ *	File: mach/shared_region.h
+ *
+ * 	protos and struct definitions for shared region
+ */
+
+#ifndef _MACH_SHARED_REGION_H_
+#define _MACH_SHARED_REGION_H_
+
+#include <sys/cdefs.h>
+#include <mach/vm_prot.h>
+#include <mach/vm_types.h>
+#include <mach/mach_types.h>
+
+#define SHARED_REGION_BASE_I386			0x90000000ULL
+#define SHARED_REGION_SIZE_I386			0x20000000ULL
+#define SHARED_REGION_NESTING_BASE_I386		0x90000000ULL
+#define SHARED_REGION_NESTING_SIZE_I386		0x20000000ULL
+#define SHARED_REGION_NESTING_MIN_I386		0x00200000ULL
+#define SHARED_REGION_NESTING_MAX_I386		0xFFE00000ULL
+
+#define SHARED_REGION_BASE_X86_64		0x00007FFF70000000ULL
+#define SHARED_REGION_SIZE_X86_64		0x000000008FE00000ULL
+#define SHARED_REGION_NESTING_BASE_X86_64	0x00007FFF80000000ULL
+#define SHARED_REGION_NESTING_SIZE_X86_64	0x0000000040000000ULL
+#define SHARED_REGION_NESTING_MIN_X86_64	0x0000000000200000ULL
+#define SHARED_REGION_NESTING_MAX_X86_64	0xFFFFFFFFFFE00000ULL
+
+#define SHARED_REGION_BASE_PPC			0x90000000ULL
+#define SHARED_REGION_SIZE_PPC			0x20000000ULL
+#define SHARED_REGION_NESTING_BASE_PPC		0x90000000ULL
+#define SHARED_REGION_NESTING_SIZE_PPC		0x10000000ULL
+#define SHARED_REGION_NESTING_MIN_PPC		0x10000000ULL
+#define SHARED_REGION_NESTING_MAX_PPC		0x10000000ULL
+
+#define SHARED_REGION_BASE_PPC64		0x00007FFF60000000ULL
+#define SHARED_REGION_SIZE_PPC64		0x00000000A0000000ULL
+#define SHARED_REGION_NESTING_BASE_PPC64	0x00007FFF60000000ULL
+#define SHARED_REGION_NESTING_SIZE_PPC64	0x00000000A0000000ULL
+#define SHARED_REGION_NESTING_MIN_PPC64		0x0000000010000000ULL
+#define SHARED_REGION_NESTING_MAX_PPC64		0x0000000010000000ULL
+
+#define SHARED_REGION_BASE_ARM			0x20000000ULL
+#define SHARED_REGION_SIZE_ARM			0x20000000ULL
+#define SHARED_REGION_NESTING_BASE_ARM		0x20000000ULL
+#define SHARED_REGION_NESTING_SIZE_ARM		0x20000000ULL
+#define SHARED_REGION_NESTING_MIN_ARM		?
+#define SHARED_REGION_NESTING_MAX_ARM		?
+
+#define SHARED_REGION_BASE_ARM64		0x180000000ULL
+#define SHARED_REGION_SIZE_ARM64		0x20000000ULL
+#define SHARED_REGION_NESTING_BASE_ARM64	0x180000000ULL
+#define SHARED_REGION_NESTING_SIZE_ARM64	0x20000000ULL
+#define SHARED_REGION_NESTING_MIN_ARM64		?
+#define SHARED_REGION_NESTING_MAX_ARM64		?
+
+#if defined(__i386__)
+#define SHARED_REGION_BASE			SHARED_REGION_BASE_I386
+#define SHARED_REGION_SIZE			SHARED_REGION_SIZE_I386
+#define SHARED_REGION_NESTING_BASE		SHARED_REGION_NESTING_BASE_I386
+#define SHARED_REGION_NESTING_SIZE		SHARED_REGION_NESTING_SIZE_I386
+#define SHARED_REGION_NESTING_MIN		SHARED_REGION_NESTING_MIN_I386
+#define SHARED_REGION_NESTING_MAX		SHARED_REGION_NESTING_MAX_I386
+#elif defined(__x86_64__)
+#define SHARED_REGION_BASE			SHARED_REGION_BASE_X86_64
+#define SHARED_REGION_SIZE			SHARED_REGION_SIZE_X86_64
+#define SHARED_REGION_NESTING_BASE		SHARED_REGION_NESTING_BASE_X86_64
+#define SHARED_REGION_NESTING_SIZE		SHARED_REGION_NESTING_SIZE_X86_64
+#define SHARED_REGION_NESTING_MIN		SHARED_REGION_NESTING_MIN_X86_64
+#define SHARED_REGION_NESTING_MAX		SHARED_REGION_NESTING_MAX_X86_64
+#endif
+
+/* 
+ * All shared_region_* declarations are a private interface
+ * between dyld and the kernel.
+ *
+ */
+struct shared_file_mapping_np {
+	mach_vm_address_t	sfm_address;
+	mach_vm_size_t		sfm_size;
+	mach_vm_offset_t	sfm_file_offset;
+	vm_prot_t		sfm_max_prot;
+	vm_prot_t		sfm_init_prot;
+};
+#define VM_PROT_COW  0x8  /* must not interfere with normal prot assignments */
+#define VM_PROT_ZF  0x10  /* must not interfere with normal prot assignments */
+#define VM_PROT_SLIDE  0x20  /* must not interfere with normal prot assignments */
+
+
+__BEGIN_DECLS
+int	shared_region_check_np(uint64_t	*startaddress);
+int	shared_region_map_np(int fd,
+			     uint32_t mappingCount,
+			     const struct shared_file_mapping_np *mappings);
+int	shared_region_slide_np(void);
+__END_DECLS
+
+
+#endif /* _MACH_SHARED_REGION_H_ */
diff -Nur cctools-877.5/include/mach/std_types.defs cctools-877.5-AnV/include/mach/std_types.defs
--- cctools-877.5/include/mach/std_types.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/std_types.defs	2015-11-16 07:56:14 +0000
@@ -0,0 +1,150 @@
+/*
+ * Copyright (c) 2002,2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	Mach kernel standard interface type declarations
+ */
+
+#ifndef	_MACH_STD_TYPES_DEFS_
+#define _MACH_STD_TYPES_DEFS_
+
+/* from ISO/IEC 988:1999 spec */
+/* 7.18.1.1 Exact-width integer types */
+
+type int8_t = MACH_MSG_TYPE_INTEGER_8;
+type uint8_t = MACH_MSG_TYPE_INTEGER_8;
+type int16_t = MACH_MSG_TYPE_INTEGER_16;
+type uint16_t = MACH_MSG_TYPE_INTEGER_16;
+type int32_t = MACH_MSG_TYPE_INTEGER_32;
+type uint32_t = MACH_MSG_TYPE_INTEGER_32;
+type int64_t = MACH_MSG_TYPE_INTEGER_64;
+type uint64_t = MACH_MSG_TYPE_INTEGER_64;
+
+/*
+ * Legacy fixed-length Mach types which should
+ * be replaced with the Standard types from above.
+ */
+type int32 = int32_t;
+type unsigned32 = uint32_t;
+type int64 = int64_t;
+type unsigned64 = uint64_t;
+
+/*
+ * Other fixed length Mach types.
+ */
+type char = MACH_MSG_TYPE_CHAR;
+type boolean_t = MACH_MSG_TYPE_BOOLEAN;
+
+#include <mach/machine/machine_types.defs>
+
+type kern_return_t = int;
+
+type pointer_t = ^array[] of MACH_MSG_TYPE_BYTE
+	ctype: vm_offset_t;
+
+
+type mach_port_t = MACH_MSG_TYPE_COPY_SEND;
+type mach_port_array_t = array[] of mach_port_t;
+
+type mach_port_name_t = MACH_MSG_TYPE_PORT_NAME;
+type mach_port_name_array_t = array[] of mach_port_name_t;
+
+type mach_port_right_t = natural_t;
+
+type mach_port_type_t = natural_t;
+type mach_port_type_array_t = array[] of mach_port_type_t;
+
+type mach_port_urefs_t = natural_t;
+type mach_port_delta_t = integer_t;
+type mach_port_seqno_t = natural_t;
+type mach_port_mscount_t = unsigned;
+type mach_port_msgcount_t = unsigned;
+type mach_port_rights_t = unsigned;
+type mach_msg_id_t = integer_t;
+type mach_msg_size_t = natural_t;
+type mach_msg_type_name_t = unsigned;
+type mach_msg_options_t = integer_t;
+
+type mach_port_move_receive_t =		MACH_MSG_TYPE_MOVE_RECEIVE
+	ctype: mach_port_t;
+type mach_port_copy_send_t =		MACH_MSG_TYPE_COPY_SEND
+	ctype: mach_port_t;
+type mach_port_make_send_t =		MACH_MSG_TYPE_MAKE_SEND
+	ctype: mach_port_t;
+type mach_port_move_send_t =		MACH_MSG_TYPE_MOVE_SEND
+	ctype: mach_port_t;
+type mach_port_make_send_once_t =	MACH_MSG_TYPE_MAKE_SEND_ONCE
+	ctype: mach_port_t;
+type mach_port_move_send_once_t =	MACH_MSG_TYPE_MOVE_SEND_ONCE
+	ctype: mach_port_t;
+
+type mach_port_receive_t =		MACH_MSG_TYPE_PORT_RECEIVE
+	ctype: mach_port_t;
+type mach_port_send_t =			MACH_MSG_TYPE_PORT_SEND
+	ctype: mach_port_t;
+type mach_port_send_once_t =		MACH_MSG_TYPE_PORT_SEND_ONCE
+	ctype: mach_port_t;
+
+type mach_port_poly_t = polymorphic
+	ctype: mach_port_t;
+
+import <mach/std_types.h>;
+import <mach/mig.h>;
+
+#endif	/* _MACH_STD_TYPES_DEFS_ */
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/std_types.h cctools-877.5-AnV/include/mach/std_types.h
--- cctools-877.5/include/mach/std_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/std_types.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,72 @@
+/*
+ * Copyright (c) 2002,2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	Mach standard external interface type definitions.
+ *
+ */
+
+#ifndef	_MACH_STD_TYPES_H_
+#define	_MACH_STD_TYPES_H_
+
+#include <stdint.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/port.h>
+#include <mach/vm_types.h>
+
+#endif	/* _MACH_STD_TYPES_H_ */
diff -Nur cctools-877.5/include/mach/sync.h cctools-877.5-AnV/include/mach/sync.h
--- cctools-877.5/include/mach/sync.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/sync.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,35 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+** This file contains compatibilty wrapper header for things that used
+** to be generated from mach/sync.defs.  Now that code is split into two
+** different interface generator files, so include the two resulting
+** headers here.
+*/
+#include <mach/semaphore.h>
+#include <mach/lock_set.h>
diff -Nur cctools-877.5/include/mach/sync_policy.h cctools-877.5-AnV/include/mach/sync_policy.h
--- cctools-877.5/include/mach/sync_policy.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/sync_policy.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,49 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef	_MACH_SYNC_POLICY_H_
+#define _MACH_SYNC_POLICY_H_
+
+typedef int sync_policy_t;
+
+/*
+ *	These options define the wait ordering of the synchronizers
+ */
+#define SYNC_POLICY_FIFO		0x0
+#define SYNC_POLICY_FIXED_PRIORITY	0x1
+#define SYNC_POLICY_REVERSED		0x2
+#define SYNC_POLICY_ORDER_MASK		0x3
+#define SYNC_POLICY_LIFO		(SYNC_POLICY_FIFO|SYNC_POLICY_REVERSED)
+
+
+#define SYNC_POLICY_MAX			0x7
+
+#endif 	/* _MACH_SYNC_POLICY_H_ */
diff -Nur cctools-877.5/include/mach/task.defs cctools-877.5-AnV/include/mach/task.defs
--- cctools-877.5/include/mach/task.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/task.defs	2015-11-16 07:56:14 +0000
@@ -0,0 +1,454 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_port.defs
+ *	Author:	Rich Draves
+ *
+ *	Exported kernel calls.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  task 3400;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach_debug/mach_debug_types.defs>
+
+/*
+ *	Create a new task with an empty set of IPC rights,
+ *	and having an address space constructed from the
+ *	target task (or empty, if inherit_memory is FALSE).
+ */
+routine task_create(
+		target_task	: task_t;
+		ledgers		: ledger_array_t;
+		inherit_memory	: boolean_t;
+	out	child_task	: task_t);
+
+/*
+ *	Destroy the target task, causing all of its threads
+ *	to be destroyed, all of its IPC rights to be deallocated,
+ *	and all of its address space to be deallocated.
+ */
+routine task_terminate(
+		target_task	: task_t);
+
+/*
+ *	Returns the set of threads belonging to the target task.
+ */
+routine task_threads(
+		target_task	: task_t;
+	out	act_list	: thread_act_array_t);
+
+/*
+ *	Stash a handful of ports for the target task; child
+ *	tasks inherit this stash at task_create time.
+ */
+routine	mach_ports_register(
+		target_task	: task_t;
+		init_port_set	: mach_port_array_t =
+					^array[] of mach_port_t);
+
+/*
+ *	Retrieve the stashed ports for the target task.
+ */
+routine	mach_ports_lookup(
+		target_task	: task_t;
+	out	init_port_set	: mach_port_array_t =
+					^array[] of mach_port_t);
+
+/*
+ *      Returns information about the target task.
+ */
+routine task_info(
+                target_task     : task_name_t;
+                flavor          : task_flavor_t;
+        out     task_info_out   : task_info_t, CountInOut);
+
+/*
+ * Set task information.
+ */
+routine	task_set_info(
+		target_task	: task_t;
+		flavor		: task_flavor_t;
+		task_info_in	: task_info_t);
+
+/*
+ *	Increment the suspend count for the target task.
+ *	No threads within a task may run when the suspend
+ *	count for that task is non-zero.
+ */
+routine	task_suspend(
+		target_task	: task_t);
+
+
+/*
+ *	Decrement the suspend count for the target task,
+ *	if the count is currently non-zero.  If the resulting
+ *	suspend	count is zero, then threads within the task
+ *	that also have non-zero suspend counts may execute.
+ */
+routine	task_resume(
+		target_task	: task_t);
+
+/*
+ *	Returns the current value of the selected special port
+ *	associated with the target task.
+ */
+routine task_get_special_port(
+		task		: task_t;
+		which_port	: int;
+	out	special_port	: mach_port_t);
+
+/*
+ *	Set one of the special ports associated with the
+ *	target task.
+ */
+routine task_set_special_port(
+		task		: task_t;
+		which_port	: int;
+		special_port	: mach_port_t);
+
+/*
+ *	Create a new thread within the target task, returning
+ *	the port representing the first thr_act in that new thread.  The
+ *	initial execution state of the thread is undefined.
+ */
+routine
+#ifdef KERNEL_SERVER
+thread_create_from_user(
+#else
+thread_create(
+#endif
+		parent_task	: task_t;
+	out	child_act	: thread_act_t);
+
+/*
+ *      Create a new thread within the target task, returning
+ *      the port representing that new thread.  The new thread 
+ *	is not suspended; its initial execution state is given
+ *	by flavor and new_state. Returns the port representing 
+ *	the new thread.
+ */
+routine
+#ifdef KERNEL_SERVER
+thread_create_running_from_user(
+#else
+thread_create_running(
+#endif
+                parent_task     : task_t;
+                flavor          : thread_state_flavor_t;
+                new_state       : thread_state_t;
+        out     child_act       : thread_act_t);
+
+/*
+ * Set an exception handler for a task on one or more exception types.
+ * These handlers are invoked for all threads in the task if there are
+ * no thread-specific exception handlers or those handlers returned an
+ * error.
+ */
+routine	task_set_exception_ports(
+		task		: task_t;
+		exception_mask	: exception_mask_t;
+		new_port	: mach_port_t;
+		behavior	: exception_behavior_t;
+		new_flavor	: thread_state_flavor_t);
+
+
+/*
+ * Lookup some of the old exception handlers for a task
+ */
+routine	task_get_exception_ports(
+		task		: task_t;
+		exception_mask	: exception_mask_t;
+	  out	masks		: exception_mask_array_t;
+	  out	old_handlers	: exception_handler_array_t, SameCount;
+	  out	old_behaviors	: exception_behavior_array_t, SameCount;
+	  out	old_flavors	: exception_flavor_array_t, SameCount);
+
+
+/*
+ * Set an exception handler for a thread on one or more exception types.
+ * At the same time, return the previously defined exception handlers for
+ * those types.
+ */
+routine	task_swap_exception_ports(
+		task		: task_t;
+		exception_mask	: exception_mask_t;
+		new_port	: mach_port_t;
+		behavior	: exception_behavior_t;
+		new_flavor	: thread_state_flavor_t;
+	  out	masks		: exception_mask_array_t;
+	  out	old_handlerss	: exception_handler_array_t, SameCount;
+	  out	old_behaviors	: exception_behavior_array_t, SameCount;
+	  out	old_flavors	: exception_flavor_array_t, SameCount);
+
+/*
+ * OBSOLETE interface.
+ */
+routine lock_set_create(
+		task		: task_t;
+	out	new_lock_set	: lock_set_t;
+		n_ulocks	: int;
+		policy		: int);
+
+/*
+ * OBSOLETE interface.
+ */
+routine lock_set_destroy(
+		task		: task_t;
+		lock_set	: lock_set_t);
+
+/*
+ * Create and destroy semaphore synchronizers on a
+ * per-task basis (i.e. the task owns them).
+ */
+
+routine semaphore_create(
+		task		: task_t;
+	out	semaphore	: semaphore_t;
+		policy		: int;
+		value		: int);
+
+routine semaphore_destroy(
+		task		: task_t;
+		semaphore	: semaphore_consume_ref_t);
+
+/*
+ * Set/get policy information for a task.
+ * (Approved Mac OS X microkernel interface)
+ */
+
+routine task_policy_set(
+	task			: task_t;
+	flavor			: task_policy_flavor_t;
+	policy_info		: task_policy_t);
+
+routine task_policy_get(
+	task			: task_t;
+	flavor			: task_policy_flavor_t;
+out	policy_info		: task_policy_t, CountInOut;
+inout	get_default		: boolean_t);
+
+/*
+ *	Removed from the kernel.
+ */
+#if KERNEL_SERVER
+skip;
+#else
+routine task_sample(
+		task		: task_t;
+		reply		: mach_port_make_send_t);
+#endif
+
+/*
+ * JMM - Everything from here down is likely to go away soon
+ */
+/*
+ * OBSOLETE interface.
+ */
+routine task_policy(
+	task			: task_t;
+	policy			: policy_t;
+	base			: policy_base_t;
+	set_limit		: boolean_t;
+	change			: boolean_t);
+
+
+/*
+ *	Establish a user-level handler for the specified
+ *	system call.
+ */
+routine task_set_emulation(
+		target_port	: task_t;
+		routine_entry_pt: vm_address_t;
+		routine_number  : int);	
+
+/*
+ *	Get user-level handler entry points for all
+ *	emulated system calls.
+ */
+routine task_get_emulation_vector(
+		task		: task_t;
+	out	vector_start	: int;
+	out	emulation_vector: emulation_vector_t);
+
+/*
+ *	Establish user-level handlers for the specified
+ *	system calls. Non-emulated system calls are specified
+ *	with emulation_vector[i] == EML_ROUTINE_NULL.
+ */
+routine task_set_emulation_vector(
+		task		: task_t;
+		vector_start	: int;
+		emulation_vector: emulation_vector_t);
+
+
+/*
+ *      Establish restart pc for interrupted atomic sequences.
+ */
+routine task_set_ras_pc(
+		target_task     : task_t;
+		basepc          : vm_address_t;
+		boundspc        : vm_address_t);
+
+
+/*
+ * Return zone info as seen/used by this task.
+ */
+routine task_zone_info(
+		target_task	: task_t;
+	out	names		: mach_zone_name_array_t,
+					Dealloc;
+	out	info		: task_zone_info_array_t,
+					Dealloc);
+
+
+/* 
+ * JMM - Want to eliminate processor_set so keep them at the end.
+ */
+
+/*
+ *	Assign task to processor set.
+ */
+routine task_assign(
+		task		: task_t;
+		new_set		: processor_set_t;
+		assign_threads	: boolean_t);
+
+/*
+ *	Assign task to default set.
+ */
+routine task_assign_default(
+		task		: task_t;
+		assign_threads	: boolean_t);
+
+/*
+ *	Get current assignment for task.
+ */
+routine task_get_assignment(
+		task		: task_t;
+	out	assigned_set	: processor_set_name_t);
+
+/*
+ * OBSOLETE interface.
+ */
+routine task_set_policy(
+	task			: task_t;
+	pset			: processor_set_t;
+	policy			: policy_t;
+	base			: policy_base_t;
+	limit			: policy_limit_t;
+	change			: boolean_t);
+
+/*
+ * Read the selected state which is to be installed on new 
+ * threads in the task as they are created.
+ */
+routine task_get_state(
+		task		: task_t;
+		flavor		: thread_state_flavor_t;
+	out	old_state	: thread_state_t, CountInOut);
+ 
+/*
+ * Set the selected state information to be installed on
+ * all subsequently created threads in the task.
+ */
+routine	task_set_state(
+		task		: task_t;
+		flavor		: thread_state_flavor_t;
+		new_state	: thread_state_t);
+
+/*
+ * Change the task's physical footprint limit (in MB).
+ */
+routine task_set_phys_footprint_limit(
+		task		: task_t;
+		new_limit	: int;
+	out old_limit	: int);
+
+routine task_suspend2(
+		target_task : task_t;
+	out suspend_token : task_suspension_token_t);
+
+routine task_resume2(
+		suspend_token : task_suspension_token_t);
+
+routine task_purgable_info(
+		task 		: task_t;
+	out	stats		: task_purgable_info_t);
+
+routine task_get_mach_voucher(
+		task		: task_t;
+		which		: mach_voucher_selector_t;
+	out	voucher		: ipc_voucher_t);
+
+routine task_set_mach_voucher(
+		task		: task_t;
+		voucher		: ipc_voucher_t);
+
+routine task_swap_mach_voucher(
+		task		: task_t;
+		new_voucher	: ipc_voucher_t;
+	inout	old_voucher	: ipc_voucher_t);
+
+/* vim: set ft=c : */
+
diff -Nur cctools-877.5/include/mach/task.h cctools-877.5-AnV/include/mach/task.h
--- cctools-877.5/include/mach/task.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/task.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,1907 @@
+#ifndef	_task_user_
+#define	_task_user_
+
+/* Module task */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	task_MSG_COUNT
+#define	task_MSG_COUNT	42
+#endif	/* task_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine task_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_create
+(
+	task_t target_task,
+	ledger_array_t ledgers,
+	mach_msg_type_number_t ledgersCnt,
+	boolean_t inherit_memory,
+	task_t *child_task
+);
+
+/* Routine task_terminate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_terminate
+(
+	task_t target_task
+);
+
+/* Routine task_threads */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_threads
+(
+	task_t target_task,
+	thread_act_array_t *act_list,
+	mach_msg_type_number_t *act_listCnt
+);
+
+/* Routine mach_ports_register */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_ports_register
+(
+	task_t target_task,
+	mach_port_array_t init_port_set,
+	mach_msg_type_number_t init_port_setCnt
+);
+
+/* Routine mach_ports_lookup */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_ports_lookup
+(
+	task_t target_task,
+	mach_port_array_t *init_port_set,
+	mach_msg_type_number_t *init_port_setCnt
+);
+
+/* Routine task_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_info
+(
+	task_name_t target_task,
+	task_flavor_t flavor,
+	task_info_t task_info_out,
+	mach_msg_type_number_t *task_info_outCnt
+);
+
+/* Routine task_set_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_info
+(
+	task_t target_task,
+	task_flavor_t flavor,
+	task_info_t task_info_in,
+	mach_msg_type_number_t task_info_inCnt
+);
+
+/* Routine task_suspend */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_suspend
+(
+	task_t target_task
+);
+
+/* Routine task_resume */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_resume
+(
+	task_t target_task
+);
+
+/* Routine task_get_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_special_port
+(
+	task_t task,
+	int which_port,
+	mach_port_t *special_port
+);
+
+/* Routine task_set_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_special_port
+(
+	task_t task,
+	int which_port,
+	mach_port_t special_port
+);
+
+/* Routine thread_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_create
+(
+	task_t parent_task,
+	thread_act_t *child_act
+);
+
+/* Routine thread_create_running */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_create_running
+(
+	task_t parent_task,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt,
+	thread_act_t *child_act
+);
+
+/* Routine task_set_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor
+);
+
+/* Routine task_get_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine task_swap_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_swap_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlerss,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine lock_set_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_set_create
+(
+	task_t task,
+	lock_set_t *new_lock_set,
+	int n_ulocks,
+	int policy
+);
+
+/* Routine lock_set_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_set_destroy
+(
+	task_t task,
+	lock_set_t lock_set
+);
+
+/* Routine semaphore_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t semaphore_create
+(
+	task_t task,
+	semaphore_t *semaphore,
+	int policy,
+	int value
+);
+
+/* Routine semaphore_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t semaphore_destroy
+(
+	task_t task,
+	semaphore_t semaphore
+);
+
+/* Routine task_policy_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy_set
+(
+	task_t task,
+	task_policy_flavor_t flavor,
+	task_policy_t policy_info,
+	mach_msg_type_number_t policy_infoCnt
+);
+
+/* Routine task_policy_get */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy_get
+(
+	task_t task,
+	task_policy_flavor_t flavor,
+	task_policy_t policy_info,
+	mach_msg_type_number_t *policy_infoCnt,
+	boolean_t *get_default
+);
+
+/* Routine task_sample */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_sample
+(
+	task_t task,
+	mach_port_t reply
+);
+
+/* Routine task_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy
+(
+	task_t task,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	boolean_t set_limit,
+	boolean_t change
+);
+
+/* Routine task_set_emulation */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_emulation
+(
+	task_t target_port,
+	vm_address_t routine_entry_pt,
+	int routine_number
+);
+
+/* Routine task_get_emulation_vector */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_emulation_vector
+(
+	task_t task,
+	int *vector_start,
+	emulation_vector_t *emulation_vector,
+	mach_msg_type_number_t *emulation_vectorCnt
+);
+
+/* Routine task_set_emulation_vector */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_emulation_vector
+(
+	task_t task,
+	int vector_start,
+	emulation_vector_t emulation_vector,
+	mach_msg_type_number_t emulation_vectorCnt
+);
+
+/* Routine task_set_ras_pc */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_ras_pc
+(
+	task_t target_task,
+	vm_address_t basepc,
+	vm_address_t boundspc
+);
+
+/* Routine task_zone_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_zone_info
+(
+	task_t target_task,
+	mach_zone_name_array_t *names,
+	mach_msg_type_number_t *namesCnt,
+	task_zone_info_array_t *info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine task_assign */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_assign
+(
+	task_t task,
+	processor_set_t new_set,
+	boolean_t assign_threads
+);
+
+/* Routine task_assign_default */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_assign_default
+(
+	task_t task,
+	boolean_t assign_threads
+);
+
+/* Routine task_get_assignment */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_assignment
+(
+	task_t task,
+	processor_set_name_t *assigned_set
+);
+
+/* Routine task_set_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_policy
+(
+	task_t task,
+	processor_set_t pset,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	policy_limit_t limit,
+	mach_msg_type_number_t limitCnt,
+	boolean_t change
+);
+
+/* Routine task_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_state
+(
+	task_t task,
+	thread_state_flavor_t flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine task_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_state
+(
+	task_t task,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+/* Routine task_set_phys_footprint_limit */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_phys_footprint_limit
+(
+	task_t task,
+	int new_limit,
+	int *old_limit
+);
+
+/* Routine task_suspend2 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_suspend2
+(
+	task_t target_task,
+	task_suspension_token_t *suspend_token
+);
+
+/* Routine task_resume2 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_resume2
+(
+	task_suspension_token_t suspend_token
+);
+
+/* Routine task_purgable_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_purgable_info
+(
+	task_t task,
+	task_purgable_info_t *stats
+);
+
+/* Routine task_get_mach_voucher */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_mach_voucher
+(
+	task_t task,
+	mach_voucher_selector_t which,
+	ipc_voucher_t *voucher
+);
+
+/* Routine task_set_mach_voucher */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_mach_voucher
+(
+	task_t task,
+	ipc_voucher_t voucher
+);
+
+/* Routine task_swap_mach_voucher */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_swap_mach_voucher
+(
+	task_t task,
+	ipc_voucher_t new_voucher,
+	ipc_voucher_t *old_voucher
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__task_subsystem__defined
+#define __Request__task_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t ledgers;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t ledgersCnt;
+		boolean_t inherit_memory;
+	} __Request__task_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t init_port_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t init_port_setCnt;
+	} __Request__mach_ports_register_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__mach_ports_lookup_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_flavor_t flavor;
+		mach_msg_type_number_t task_info_outCnt;
+	} __Request__task_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_flavor_t flavor;
+		mach_msg_type_number_t task_info_inCnt;
+		integer_t task_info_in[52];
+	} __Request__task_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__task_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__task_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[224];
+	} __Request__thread_create_running_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__task_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+	} __Request__task_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__task_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int n_ulocks;
+		int policy;
+	} __Request__lock_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t lock_set;
+		/* end of the kernel processed data */
+	} __Request__lock_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int policy;
+		int value;
+	} __Request__semaphore_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t semaphore;
+		/* end of the kernel processed data */
+	} __Request__semaphore_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+	} __Request__task_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		boolean_t get_default;
+	} __Request__task_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t reply;
+		/* end of the kernel processed data */
+	} __Request__task_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		boolean_t set_limit;
+		boolean_t change;
+	} __Request__task_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t routine_entry_pt;
+		int routine_number;
+	} __Request__task_set_emulation_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_get_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t emulation_vector;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int vector_start;
+		mach_msg_type_number_t emulation_vectorCnt;
+	} __Request__task_set_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t basepc;
+		vm_address_t boundspc;
+	} __Request__task_set_ras_pc_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t assign_threads;
+	} __Request__task_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		boolean_t assign_threads;
+	} __Request__task_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pset;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		mach_msg_type_number_t limitCnt;
+		integer_t limit[1];
+		boolean_t change;
+	} __Request__task_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__task_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[224];
+	} __Request__task_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int new_limit;
+	} __Request__task_set_phys_footprint_limit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_suspend2_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_resume2_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_purgable_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_voucher_selector_t which;
+	} __Request__task_get_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t voucher;
+		/* end of the kernel processed data */
+	} __Request__task_set_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_voucher;
+		mach_msg_port_descriptor_t old_voucher;
+		/* end of the kernel processed data */
+	} __Request__task_swap_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__task_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__task_subsystem__defined
+#define __RequestUnion__task_subsystem__defined
+union __RequestUnion__task_subsystem {
+	__Request__task_create_t Request_task_create;
+	__Request__task_terminate_t Request_task_terminate;
+	__Request__task_threads_t Request_task_threads;
+	__Request__mach_ports_register_t Request_mach_ports_register;
+	__Request__mach_ports_lookup_t Request_mach_ports_lookup;
+	__Request__task_info_t Request_task_info;
+	__Request__task_set_info_t Request_task_set_info;
+	__Request__task_suspend_t Request_task_suspend;
+	__Request__task_resume_t Request_task_resume;
+	__Request__task_get_special_port_t Request_task_get_special_port;
+	__Request__task_set_special_port_t Request_task_set_special_port;
+	__Request__thread_create_t Request_thread_create;
+	__Request__thread_create_running_t Request_thread_create_running;
+	__Request__task_set_exception_ports_t Request_task_set_exception_ports;
+	__Request__task_get_exception_ports_t Request_task_get_exception_ports;
+	__Request__task_swap_exception_ports_t Request_task_swap_exception_ports;
+	__Request__lock_set_create_t Request_lock_set_create;
+	__Request__lock_set_destroy_t Request_lock_set_destroy;
+	__Request__semaphore_create_t Request_semaphore_create;
+	__Request__semaphore_destroy_t Request_semaphore_destroy;
+	__Request__task_policy_set_t Request_task_policy_set;
+	__Request__task_policy_get_t Request_task_policy_get;
+	__Request__task_sample_t Request_task_sample;
+	__Request__task_policy_t Request_task_policy;
+	__Request__task_set_emulation_t Request_task_set_emulation;
+	__Request__task_get_emulation_vector_t Request_task_get_emulation_vector;
+	__Request__task_set_emulation_vector_t Request_task_set_emulation_vector;
+	__Request__task_set_ras_pc_t Request_task_set_ras_pc;
+	__Request__task_zone_info_t Request_task_zone_info;
+	__Request__task_assign_t Request_task_assign;
+	__Request__task_assign_default_t Request_task_assign_default;
+	__Request__task_get_assignment_t Request_task_get_assignment;
+	__Request__task_set_policy_t Request_task_set_policy;
+	__Request__task_get_state_t Request_task_get_state;
+	__Request__task_set_state_t Request_task_set_state;
+	__Request__task_set_phys_footprint_limit_t Request_task_set_phys_footprint_limit;
+	__Request__task_suspend2_t Request_task_suspend2;
+	__Request__task_resume2_t Request_task_resume2;
+	__Request__task_purgable_info_t Request_task_purgable_info;
+	__Request__task_get_mach_voucher_t Request_task_get_mach_voucher;
+	__Request__task_set_mach_voucher_t Request_task_set_mach_voucher;
+	__Request__task_swap_mach_voucher_t Request_task_swap_mach_voucher;
+};
+#endif /* !__RequestUnion__task_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__task_subsystem__defined
+#define __Reply__task_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_task;
+		/* end of the kernel processed data */
+	} __Reply__task_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t act_list;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t act_listCnt;
+	} __Reply__task_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_ports_register_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t init_port_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t init_port_setCnt;
+	} __Reply__mach_ports_lookup_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t task_info_outCnt;
+		integer_t task_info_out[52];
+	} __Reply__task_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+	} __Reply__task_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_act;
+		/* end of the kernel processed data */
+	} __Reply__thread_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_act;
+		/* end of the kernel processed data */
+	} __Reply__thread_create_running_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__task_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlerss[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__task_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_lock_set;
+		/* end of the kernel processed data */
+	} __Reply__lock_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t semaphore;
+		/* end of the kernel processed data */
+	} __Reply__semaphore_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__semaphore_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+		boolean_t get_default;
+	} __Reply__task_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_emulation_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t emulation_vector;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int vector_start;
+		mach_msg_type_number_t emulation_vectorCnt;
+	} __Reply__task_get_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_ras_pc_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t names;
+		mach_msg_ool_descriptor_t info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t namesCnt;
+		mach_msg_type_number_t infoCnt;
+	} __Reply__task_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t assigned_set;
+		/* end of the kernel processed data */
+	} __Reply__task_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[224];
+	} __Reply__task_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		int old_limit;
+	} __Reply__task_set_phys_footprint_limit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t suspend_token;
+		/* end of the kernel processed data */
+	} __Reply__task_suspend2_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_resume2_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		task_purgable_info_t stats;
+	} __Reply__task_purgable_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t voucher;
+		/* end of the kernel processed data */
+	} __Reply__task_get_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_voucher;
+		/* end of the kernel processed data */
+	} __Reply__task_swap_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__task_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__task_subsystem__defined
+#define __ReplyUnion__task_subsystem__defined
+union __ReplyUnion__task_subsystem {
+	__Reply__task_create_t Reply_task_create;
+	__Reply__task_terminate_t Reply_task_terminate;
+	__Reply__task_threads_t Reply_task_threads;
+	__Reply__mach_ports_register_t Reply_mach_ports_register;
+	__Reply__mach_ports_lookup_t Reply_mach_ports_lookup;
+	__Reply__task_info_t Reply_task_info;
+	__Reply__task_set_info_t Reply_task_set_info;
+	__Reply__task_suspend_t Reply_task_suspend;
+	__Reply__task_resume_t Reply_task_resume;
+	__Reply__task_get_special_port_t Reply_task_get_special_port;
+	__Reply__task_set_special_port_t Reply_task_set_special_port;
+	__Reply__thread_create_t Reply_thread_create;
+	__Reply__thread_create_running_t Reply_thread_create_running;
+	__Reply__task_set_exception_ports_t Reply_task_set_exception_ports;
+	__Reply__task_get_exception_ports_t Reply_task_get_exception_ports;
+	__Reply__task_swap_exception_ports_t Reply_task_swap_exception_ports;
+	__Reply__lock_set_create_t Reply_lock_set_create;
+	__Reply__lock_set_destroy_t Reply_lock_set_destroy;
+	__Reply__semaphore_create_t Reply_semaphore_create;
+	__Reply__semaphore_destroy_t Reply_semaphore_destroy;
+	__Reply__task_policy_set_t Reply_task_policy_set;
+	__Reply__task_policy_get_t Reply_task_policy_get;
+	__Reply__task_sample_t Reply_task_sample;
+	__Reply__task_policy_t Reply_task_policy;
+	__Reply__task_set_emulation_t Reply_task_set_emulation;
+	__Reply__task_get_emulation_vector_t Reply_task_get_emulation_vector;
+	__Reply__task_set_emulation_vector_t Reply_task_set_emulation_vector;
+	__Reply__task_set_ras_pc_t Reply_task_set_ras_pc;
+	__Reply__task_zone_info_t Reply_task_zone_info;
+	__Reply__task_assign_t Reply_task_assign;
+	__Reply__task_assign_default_t Reply_task_assign_default;
+	__Reply__task_get_assignment_t Reply_task_get_assignment;
+	__Reply__task_set_policy_t Reply_task_set_policy;
+	__Reply__task_get_state_t Reply_task_get_state;
+	__Reply__task_set_state_t Reply_task_set_state;
+	__Reply__task_set_phys_footprint_limit_t Reply_task_set_phys_footprint_limit;
+	__Reply__task_suspend2_t Reply_task_suspend2;
+	__Reply__task_resume2_t Reply_task_resume2;
+	__Reply__task_purgable_info_t Reply_task_purgable_info;
+	__Reply__task_get_mach_voucher_t Reply_task_get_mach_voucher;
+	__Reply__task_set_mach_voucher_t Reply_task_set_mach_voucher;
+	__Reply__task_swap_mach_voucher_t Reply_task_swap_mach_voucher;
+};
+#endif /* !__RequestUnion__task_subsystem__defined */
+
+#ifndef subsystem_to_name_map_task
+#define subsystem_to_name_map_task \
+    { "task_create", 3400 },\
+    { "task_terminate", 3401 },\
+    { "task_threads", 3402 },\
+    { "mach_ports_register", 3403 },\
+    { "mach_ports_lookup", 3404 },\
+    { "task_info", 3405 },\
+    { "task_set_info", 3406 },\
+    { "task_suspend", 3407 },\
+    { "task_resume", 3408 },\
+    { "task_get_special_port", 3409 },\
+    { "task_set_special_port", 3410 },\
+    { "thread_create", 3411 },\
+    { "thread_create_running", 3412 },\
+    { "task_set_exception_ports", 3413 },\
+    { "task_get_exception_ports", 3414 },\
+    { "task_swap_exception_ports", 3415 },\
+    { "lock_set_create", 3416 },\
+    { "lock_set_destroy", 3417 },\
+    { "semaphore_create", 3418 },\
+    { "semaphore_destroy", 3419 },\
+    { "task_policy_set", 3420 },\
+    { "task_policy_get", 3421 },\
+    { "task_sample", 3422 },\
+    { "task_policy", 3423 },\
+    { "task_set_emulation", 3424 },\
+    { "task_get_emulation_vector", 3425 },\
+    { "task_set_emulation_vector", 3426 },\
+    { "task_set_ras_pc", 3427 },\
+    { "task_zone_info", 3428 },\
+    { "task_assign", 3429 },\
+    { "task_assign_default", 3430 },\
+    { "task_get_assignment", 3431 },\
+    { "task_set_policy", 3432 },\
+    { "task_get_state", 3433 },\
+    { "task_set_state", 3434 },\
+    { "task_set_phys_footprint_limit", 3435 },\
+    { "task_suspend2", 3436 },\
+    { "task_resume2", 3437 },\
+    { "task_purgable_info", 3438 },\
+    { "task_get_mach_voucher", 3439 },\
+    { "task_set_mach_voucher", 3440 },\
+    { "task_swap_mach_voucher", 3441 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _task_user_ */
diff -Nur cctools-877.5/include/mach/task_access.defs cctools-877.5-AnV/include/mach/task_access.defs
--- cctools-877.5/include/mach/task_access.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/task_access.defs	2015-11-16 07:56:14 +0000
@@ -0,0 +1,59 @@
+/*
+ * Copyright (c) 2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+subsystem
+#if	KERNEL_USER
+		KernelUser
+#endif	/* KERN_USER */
+			task_access 27000;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+/*
+ *	Verify task_for_pid access for the given pid
+ *	Access granted by return value (success/failure)
+ */
+routine check_task_access(
+		task_access_port			: mach_port_t;
+		calling_pid				: int32_t;
+		calling_gid				: uint32_t;
+		target_pid				: int32_t;
+		ServerAuditToken	caller_cred 	: audit_token_t);
+
+/*
+ *	Search for a code signature for unsigned executables
+ */
+routine find_code_signature(
+		task_access_port			: mach_port_t;
+		new_pid					: int32_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/task_info.h cctools-877.5-AnV/include/mach/task_info.h
--- cctools-877.5/include/mach/task_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/task_info.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,388 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ *	Machine-independent task information structures and definitions.
+ *
+ *	The definitions in this file are exported to the user.  The kernel
+ *	will translate its internal data structures to these structures
+ *	as appropriate.
+ *
+ */
+
+#ifndef	_MACH_TASK_INFO_H_
+#define	_MACH_TASK_INFO_H_
+
+#include <mach/message.h>
+#include <mach/machine/vm_types.h>
+#include <mach/time_value.h>
+#include <mach/policy.h>
+#include <mach/vm_statistics.h> /* for vm_extmod_statistics_data_t */
+#include <Availability.h>
+
+#include <sys/cdefs.h>
+
+/*
+ *	Generic information structure to allow for expansion.
+ */
+typedef	natural_t	task_flavor_t;
+typedef	integer_t	*task_info_t;		/* varying array of int */
+
+/* Deprecated, use per structure _data_t's instead */
+#define	TASK_INFO_MAX	(1024)		/* maximum array size */
+typedef	integer_t	task_info_data_t[TASK_INFO_MAX];
+
+/*
+ *	Currently defined information structures.
+ */
+
+#pragma pack(4)
+
+/* Don't use this, use MACH_TASK_BASIC_INFO instead */
+#define TASK_BASIC_INFO_32      4       /* basic information */
+#define TASK_BASIC2_INFO_32      6
+
+struct task_basic_info_32 {
+        integer_t       suspend_count;  /* suspend count for task */
+        natural_t       virtual_size;   /* virtual memory size (bytes) */
+        natural_t       resident_size;  /* resident memory size (bytes) */
+        time_value_t    user_time;      /* total user run time for
+                                           terminated threads */
+        time_value_t    system_time;    /* total system run time for
+                                           terminated threads */
+	policy_t	policy;		/* default policy for new threads */
+};
+typedef struct task_basic_info_32       task_basic_info_32_data_t;
+typedef struct task_basic_info_32       *task_basic_info_32_t;
+#define TASK_BASIC_INFO_32_COUNT   \
+                (sizeof(task_basic_info_32_data_t) / sizeof(natural_t))
+
+/* Don't use this, use MACH_TASK_BASIC_INFO instead */
+struct task_basic_info_64 {
+        integer_t       suspend_count;  /* suspend count for task */
+        mach_vm_size_t  virtual_size;   /* virtual memory size (bytes) */
+        mach_vm_size_t  resident_size;  /* resident memory size (bytes) */
+        time_value_t    user_time;      /* total user run time for
+                                           terminated threads */
+        time_value_t    system_time;    /* total system run time for
+                                           terminated threads */
+	policy_t	policy;		/* default policy for new threads */
+};
+typedef struct task_basic_info_64       task_basic_info_64_data_t;
+typedef struct task_basic_info_64       *task_basic_info_64_t;
+
+#define TASK_BASIC_INFO_64      5       /* 64-bit capable basic info */
+#define TASK_BASIC_INFO_64_COUNT   \
+                (sizeof(task_basic_info_64_data_t) / sizeof(natural_t))
+
+
+/* localized structure - cannot be safely passed between tasks of differing sizes */
+/* Don't use this, use MACH_TASK_BASIC_INFO instead */
+struct task_basic_info {
+        integer_t       suspend_count;  /* suspend count for task */
+        vm_size_t       virtual_size;   /* virtual memory size (bytes) */
+        vm_size_t       resident_size;  /* resident memory size (bytes) */
+        time_value_t    user_time;      /* total user run time for
+                                           terminated threads */
+        time_value_t    system_time;    /* total system run time for
+                                           terminated threads */
+	policy_t	policy;		/* default policy for new threads */
+};
+
+typedef struct task_basic_info          task_basic_info_data_t;
+typedef struct task_basic_info          *task_basic_info_t;
+#define TASK_BASIC_INFO_COUNT   \
+                (sizeof(task_basic_info_data_t) / sizeof(natural_t))
+#if !defined(__LP64__)
+#define TASK_BASIC_INFO TASK_BASIC_INFO_32
+#else
+#define TASK_BASIC_INFO TASK_BASIC_INFO_64
+#endif
+
+
+
+#define	TASK_EVENTS_INFO	2	/* various event counts */
+
+struct task_events_info {
+	integer_t	faults;		/* number of page faults */
+	integer_t 	pageins;	/* number of actual pageins */
+	integer_t 	cow_faults;	/* number of copy-on-write faults */
+	integer_t 	messages_sent;	/* number of messages sent */
+	integer_t 	messages_received; /* number of messages received */
+        integer_t 	syscalls_mach;  /* number of mach system calls */
+	integer_t 	syscalls_unix;  /* number of unix system calls */
+	integer_t 	csw;            /* number of context switches */
+};
+typedef struct task_events_info		task_events_info_data_t;
+typedef struct task_events_info		*task_events_info_t;
+#define	TASK_EVENTS_INFO_COUNT		((mach_msg_type_number_t) \
+		(sizeof(task_events_info_data_t) / sizeof(natural_t)))
+
+#define	TASK_THREAD_TIMES_INFO	3	/* total times for live threads -
+					   only accurate if suspended */
+
+struct task_thread_times_info {
+	time_value_t	user_time;	/* total user run time for
+					   live threads */
+	time_value_t	system_time;	/* total system run time for
+					   live threads */
+};
+
+typedef struct task_thread_times_info	task_thread_times_info_data_t;
+typedef struct task_thread_times_info	*task_thread_times_info_t;
+#define	TASK_THREAD_TIMES_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof(task_thread_times_info_data_t) / sizeof(natural_t)))
+
+#define TASK_ABSOLUTETIME_INFO	1
+
+struct task_absolutetime_info {
+	uint64_t		total_user;
+	uint64_t		total_system;
+	uint64_t		threads_user;	/* existing threads only */
+	uint64_t		threads_system;
+};
+
+typedef struct task_absolutetime_info	task_absolutetime_info_data_t;
+typedef struct task_absolutetime_info	*task_absolutetime_info_t;
+#define TASK_ABSOLUTETIME_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof (task_absolutetime_info_data_t) / sizeof (natural_t)))
+
+#define TASK_KERNELMEMORY_INFO	7
+
+struct task_kernelmemory_info {
+	uint64_t		total_palloc;	/* private kernel mem alloc'ed */
+	uint64_t		total_pfree;	/* private kernel mem freed */
+	uint64_t		total_salloc;	/* shared kernel mem alloc'ed */
+	uint64_t		total_sfree;	/* shared kernel mem freed */
+};
+
+typedef struct task_kernelmemory_info	task_kernelmemory_info_data_t;
+typedef struct task_kernelmemory_info	*task_kernelmemory_info_t;
+#define TASK_KERNELMEMORY_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof (task_kernelmemory_info_data_t) / sizeof (natural_t)))
+
+#define TASK_SECURITY_TOKEN		13
+#define TASK_SECURITY_TOKEN_COUNT	((mach_msg_type_number_t) \
+		(sizeof(security_token_t) / sizeof(natural_t)))
+
+#define TASK_AUDIT_TOKEN		15
+#define TASK_AUDIT_TOKEN_COUNT	\
+		(sizeof(audit_token_t) / sizeof(natural_t))
+
+
+#define TASK_AFFINITY_TAG_INFO		16 	/* This is experimental. */
+
+struct task_affinity_tag_info {
+	integer_t		set_count;
+	integer_t		min;
+	integer_t		max;
+	integer_t		task_count;
+};
+typedef struct task_affinity_tag_info	task_affinity_tag_info_data_t;
+typedef struct task_affinity_tag_info	*task_affinity_tag_info_t;
+#define TASK_AFFINITY_TAG_INFO_COUNT	\
+		(sizeof(task_affinity_tag_info_data_t) / sizeof(natural_t))
+
+#define TASK_DYLD_INFO			17
+
+struct task_dyld_info {
+	mach_vm_address_t	all_image_info_addr;
+	mach_vm_size_t		all_image_info_size;
+	integer_t		all_image_info_format;		
+};
+typedef struct task_dyld_info	task_dyld_info_data_t;
+typedef struct task_dyld_info	*task_dyld_info_t;
+#define TASK_DYLD_INFO_COUNT	\
+    		(sizeof(task_dyld_info_data_t) / sizeof(natural_t))
+#define TASK_DYLD_ALL_IMAGE_INFO_32	0	/* format value */
+#define TASK_DYLD_ALL_IMAGE_INFO_64	1	/* format value */
+
+
+#define TASK_EXTMOD_INFO			19
+
+struct task_extmod_info {
+	unsigned char	task_uuid[16];
+	vm_extmod_statistics_data_t		extmod_statistics;
+};
+typedef struct task_extmod_info	task_extmod_info_data_t;
+typedef struct task_extmod_info	*task_extmod_info_t;
+#define TASK_EXTMOD_INFO_COUNT	\
+    		(sizeof(task_extmod_info_data_t) / sizeof(natural_t))
+
+
+#define MACH_TASK_BASIC_INFO     20         /* always 64-bit basic info */
+struct mach_task_basic_info {
+        mach_vm_size_t  virtual_size;       /* virtual memory size (bytes) */
+        mach_vm_size_t  resident_size;      /* resident memory size (bytes) */
+        mach_vm_size_t  resident_size_max;  /* maximum resident memory size (bytes) */
+        time_value_t    user_time;          /* total user run time for
+                                               terminated threads */
+        time_value_t    system_time;        /* total system run time for
+                                               terminated threads */
+        policy_t        policy;             /* default policy for new threads */
+        integer_t       suspend_count;      /* suspend count for task */
+};
+typedef struct mach_task_basic_info       mach_task_basic_info_data_t;
+typedef struct mach_task_basic_info       *mach_task_basic_info_t;
+#define MACH_TASK_BASIC_INFO_COUNT   \
+                (sizeof(mach_task_basic_info_data_t) / sizeof(natural_t))
+
+
+#define TASK_POWER_INFO	21
+
+struct task_power_info {
+	uint64_t		total_user;
+	uint64_t		total_system;
+	uint64_t		task_interrupt_wakeups;
+	uint64_t		task_platform_idle_wakeups;
+	uint64_t		task_timer_wakeups_bin_1;
+	uint64_t		task_timer_wakeups_bin_2;
+};
+
+typedef struct task_power_info	task_power_info_data_t;
+typedef struct task_power_info	*task_power_info_t;
+#define TASK_POWER_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof (task_power_info_data_t) / sizeof (natural_t)))
+
+
+
+#define TASK_VM_INFO		22
+#define TASK_VM_INFO_PURGEABLE	23
+struct task_vm_info {
+        mach_vm_size_t  virtual_size;	    /* virtual memory size (bytes) */
+	integer_t	region_count;	    /* number of memory regions */
+	integer_t	page_size;
+        mach_vm_size_t  resident_size;	    /* resident memory size (bytes) */
+        mach_vm_size_t  resident_size_peak; /* peak resident size (bytes) */
+
+	mach_vm_size_t	device;
+	mach_vm_size_t	device_peak;
+	mach_vm_size_t	internal;
+	mach_vm_size_t	internal_peak;
+	mach_vm_size_t	external;
+	mach_vm_size_t	external_peak;
+	mach_vm_size_t	reusable;
+	mach_vm_size_t	reusable_peak;
+	mach_vm_size_t	purgeable_volatile_pmap;
+	mach_vm_size_t	purgeable_volatile_resident;
+	mach_vm_size_t	purgeable_volatile_virtual;
+	mach_vm_size_t	compressed;
+	mach_vm_size_t	compressed_peak;
+	mach_vm_size_t	compressed_lifetime;
+};
+typedef struct task_vm_info	task_vm_info_data_t;
+typedef struct task_vm_info	*task_vm_info_t;
+#define TASK_VM_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof (task_vm_info_data_t) / sizeof (natural_t)))
+
+
+typedef struct vm_purgeable_info	task_purgable_info_t;
+
+
+#define TASK_TRACE_MEMORY_INFO  24
+struct task_trace_memory_info {
+	uint64_t  user_memory_address; 	/* address of start of trace memory buffer */
+	uint64_t  buffer_size;			/* size of buffer in bytes */
+	uint64_t  mailbox_array_size;	/* size of mailbox area in bytes */
+};
+typedef struct task_trace_memory_info task_trace_memory_info_data_t;
+typedef struct task_trace_memory_info * task_trace_memory_info_t;
+#define TASK_TRACE_MEMORY_INFO_COUNT  ((mach_msg_type_number_t) \
+		(sizeof(task_trace_memory_info_data_t) / sizeof(natural_t)))
+
+#define TASK_WAIT_STATE_INFO  25    /* deprecated. */
+struct task_wait_state_info {
+	uint64_t  total_wait_state_time;	/* Time that all threads past and present have been in a wait state */
+	uint64_t  total_wait_sfi_state_time;	/* Time that threads have been in SFI wait (should be a subset of total wait state time */
+	uint32_t  _reserved[4];
+};
+typedef struct task_wait_state_info task_wait_state_info_data_t;
+typedef struct task_wait_state_info * task_wait_state_info_t;
+#define TASK_WAIT_STATE_INFO_COUNT  ((mach_msg_type_number_t) \
+		(sizeof(task_wait_state_info_data_t) / sizeof(natural_t)))
+
+#define TASK_POWER_INFO_V2	26
+
+typedef struct {
+	uint64_t		task_gpu_utilisation;
+	uint64_t		task_gpu_stat_reserved0;
+	uint64_t		task_gpu_stat_reserved1;
+	uint64_t		task_gpu_stat_reserved2;
+} gpu_energy_data;
+
+typedef gpu_energy_data *gpu_energy_data_t;
+struct task_power_info_v2 {
+	task_power_info_data_t	cpu_energy;
+	gpu_energy_data gpu_energy;
+};
+
+typedef struct task_power_info_v2	task_power_info_v2_data_t;
+typedef struct task_power_info_v2	*task_power_info_v2_t;
+#define TASK_POWER_INFO_V2_COUNT	((mach_msg_type_number_t) \
+		(sizeof (task_power_info_v2_data_t) / sizeof (natural_t)))
+
+/*
+ * Obsolete interfaces.
+ */
+
+#define TASK_SCHED_TIMESHARE_INFO	10
+#define TASK_SCHED_RR_INFO		11
+#define TASK_SCHED_FIFO_INFO		12
+
+#define TASK_SCHED_INFO			14
+
+#pragma pack()
+
+#endif	/* _MACH_TASK_INFO_H_ */
diff -Nur cctools-877.5/include/mach/task_policy.h cctools-877.5-AnV/include/mach/task_policy.h
--- cctools-877.5/include/mach/task_policy.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/task_policy.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,189 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_TASK_POLICY_H_
+#define _MACH_TASK_POLICY_H_
+
+#include <mach/mach_types.h>
+
+/*
+ * These are the calls for accessing the policy parameters
+ * of a particular task.
+ *
+ * The extra 'get_default' parameter to the second call is
+ * IN/OUT as follows:
+ * 1) if asserted on the way in it indicates that the default
+ * values should be returned, not the ones currently set, in
+ * this case 'get_default' will always be asserted on return;
+ * 2) if unasserted on the way in, the current settings are
+ * desired and if still unasserted on return, then the info
+ * returned reflects the current settings, otherwise if
+ * 'get_default' returns asserted, it means that there are no
+ * current settings due to other parameters taking precedence,
+ * and the default ones are being returned instead.
+ */
+
+typedef natural_t	task_policy_flavor_t;
+typedef integer_t	*task_policy_t;
+
+/*
+kern_return_t	task_policy_set(
+					task_t					task,
+					task_policy_flavor_t	flavor,
+					task_policy_t			policy_info,
+					mach_msg_type_number_t	count);
+
+kern_return_t	task_policy_get(
+					task_t					task,
+					task_policy_flavor_t	flavor,
+					task_policy_t			policy_info,
+					mach_msg_type_number_t	*count,
+					boolean_t				*get_default);
+*/
+
+/*
+ * Defined flavors.
+ */
+/*
+ * TASK_CATEGORY_POLICY:
+ *
+ * This provides information to the kernel about the role
+ * of the task in the system.
+ *
+ * Parameters:
+ *
+ * role: Enumerated as follows:
+ *
+ * TASK_UNSPECIFIED is the default, since the role is not
+ * inherited from the parent.
+ *
+ * TASK_FOREGROUND_APPLICATION should be assigned when the
+ * task is a normal UI application in the foreground from
+ * the HI point of view.
+ * **N.B. There may be more than one of these at a given time.
+ *
+ * TASK_BACKGROUND_APPLICATION should be assigned when the
+ * task is a normal UI application in the background from
+ * the HI point of view.
+ *
+ * TASK_CONTROL_APPLICATION should be assigned to the unique
+ * UI application which implements the pop-up application dialog.
+ * There can only be one task at a time with this designation,
+ * which is assigned FCFS.
+ *
+ * TASK_GRAPHICS_SERVER should be assigned to the graphics
+ * management (window) server.  There can only be one task at
+ * a time with this designation, which is assigned FCFS.
+ */
+
+#define TASK_CATEGORY_POLICY		1
+
+#define TASK_SUPPRESSION_POLICY		3
+#define TASK_POLICY_STATE		4
+#define TASK_BASE_QOS_POLICY		8
+#define TASK_OVERRIDE_QOS_POLICY	9
+#define TASK_BASE_LATENCY_QOS_POLICY	10
+#define TASK_BASE_THROUGHPUT_QOS_POLICY	11
+
+
+enum task_role {
+	TASK_RENICED = -1,
+	TASK_UNSPECIFIED = 0,
+	TASK_FOREGROUND_APPLICATION,
+	TASK_BACKGROUND_APPLICATION,
+	TASK_CONTROL_APPLICATION,
+	TASK_GRAPHICS_SERVER,
+	TASK_THROTTLE_APPLICATION,
+	TASK_NONUI_APPLICATION,
+	TASK_DEFAULT_APPLICATION
+};
+
+typedef integer_t	task_role_t;
+
+struct task_category_policy {
+	task_role_t		role;
+};
+
+typedef struct task_category_policy		task_category_policy_data_t;
+typedef struct task_category_policy		*task_category_policy_t;
+
+#define TASK_CATEGORY_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (task_category_policy_data_t) / sizeof (integer_t)))
+
+
+enum task_latency_qos {
+	LATENCY_QOS_TIER_UNSPECIFIED = 0x0,
+	LATENCY_QOS_TIER_0 = ((0xFF<<16) | 1),
+	LATENCY_QOS_TIER_1 = ((0xFF<<16) | 2),
+	LATENCY_QOS_TIER_2 = ((0xFF<<16) | 3),
+	LATENCY_QOS_TIER_3 = ((0xFF<<16) | 4),
+	LATENCY_QOS_TIER_4 = ((0xFF<<16) | 5),
+	LATENCY_QOS_TIER_5 = ((0xFF<<16) | 6)
+
+};
+typedef integer_t	task_latency_qos_t;
+enum task_throughput_qos {
+	THROUGHPUT_QOS_TIER_UNSPECIFIED = 0x0,
+	THROUGHPUT_QOS_TIER_0 = ((0xFE<<16) | 1),
+	THROUGHPUT_QOS_TIER_1 = ((0xFE<<16) | 2),
+	THROUGHPUT_QOS_TIER_2 = ((0xFE<<16) | 3),
+	THROUGHPUT_QOS_TIER_3 = ((0xFE<<16) | 4),
+	THROUGHPUT_QOS_TIER_4 = ((0xFE<<16) | 5),
+	THROUGHPUT_QOS_TIER_5 = ((0xFE<<16) | 6),
+};
+
+#define LATENCY_QOS_LAUNCH_DEFAULT_TIER LATENCY_QOS_TIER_3
+#define THROUGHPUT_QOS_LAUNCH_DEFAULT_TIER THROUGHPUT_QOS_TIER_3
+
+typedef integer_t	task_throughput_qos_t;
+
+struct task_qos_policy {
+	task_latency_qos_t task_latency_qos_tier;
+	task_throughput_qos_t task_throughput_qos_tier;
+};
+
+typedef struct task_qos_policy *task_qos_policy_t;
+#define TASK_QOS_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (struct task_qos_policy) / sizeof (integer_t)))
+
+/* These should be removed - they belong in proc_info.h */
+#define PROC_FLAG_DARWINBG           0x8000    /* process in darwin background */
+#define PROC_FLAG_EXT_DARWINBG		 0x10000   /* process in darwin background - external enforcement */
+#define PROC_FLAG_IOS_APPLEDAEMON    0x20000   /* process is apple ios daemon */
+#define PROC_FLAG_IOS_IMPPROMOTION   0x80000   /* process is apple ios daemon */
+#define PROC_FLAG_ADAPTIVE           0x100000  /* Process is adaptive */
+#define PROC_FLAG_ADAPTIVE_IMPORTANT 0x200000  /* Process is adaptive, and is currently important */
+#define PROC_FLAG_IMPORTANCE_DONOR   0x400000  /* Process is marked as an importance donor */
+#define PROC_FLAG_SUPPRESSED         0x800000  /* Process is suppressed */
+#define PROC_FLAG_APPLICATION        0x1000000 /* Process is an application */
+#define PROC_FLAG_IOS_APPLICATION PROC_FLAG_APPLICATION /* Process is an application */
+
+
+
+
+#endif	/* _MACH_TASK_POLICY_H_ */
diff -Nur cctools-877.5/include/mach/task_special_ports.h cctools-877.5-AnV/include/mach/task_special_ports.h
--- cctools-877.5/include/mach/task_special_ports.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/task_special_ports.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,127 @@
+/*
+ * Copyright (c) 2000-2010 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/task_special_ports.h
+ *
+ *	Defines codes for special_purpose task ports.  These are NOT
+ *	port identifiers - they are only used for the task_get_special_port
+ *	and task_set_special_port routines.
+ *	
+ */
+
+#ifndef	_MACH_TASK_SPECIAL_PORTS_H_
+#define _MACH_TASK_SPECIAL_PORTS_H_
+
+typedef	int	task_special_port_t;
+
+#define TASK_KERNEL_PORT	1	/* Represents task to the outside
+					   world.*/
+
+#define TASK_HOST_PORT		2	/* The host (priv) port for task.  */
+
+#define TASK_NAME_PORT		3	/* the name (unpriv) port for task */
+
+#define TASK_BOOTSTRAP_PORT	4	/* Bootstrap environment for task. */
+
+/*
+ * Evolving and likely to change.
+ */
+
+#define TASK_SEATBELT_PORT	7	/* Seatbelt compiler/DEM port for task. */
+
+/* PORT 8 was the GSSD TASK PORT which transformed to a host port */
+
+#define TASK_ACCESS_PORT	9	/* Permission check for task_for_pid. */
+
+#define TASK_DEBUG_CONTROL_PORT 10 /* debug control port */
+
+/*
+ *	Definitions for ease of use
+ */
+
+#define task_get_kernel_port(task, port)	\
+		(task_get_special_port((task), TASK_KERNEL_PORT, (port)))
+
+#define task_set_kernel_port(task, port)	\
+		(task_set_special_port((task), TASK_KERNEL_PORT, (port)))
+
+#define task_get_host_port(task, port)		\
+		(task_get_special_port((task), TASK_HOST_PORT, (port)))
+
+#define task_set_host_port(task, port)	\
+		(task_set_special_port((task), TASK_HOST_PORT, (port)))
+
+#define task_get_bootstrap_port(task, port)	\
+		(task_get_special_port((task), TASK_BOOTSTRAP_PORT, (port)))
+
+#define task_get_debug_control_port(task, port) \
+		(task_get_special_port((task), TASK_DEBUG_CONTROL_PORT, (port)))
+
+#define task_set_bootstrap_port(task, port)	\
+		(task_set_special_port((task), TASK_BOOTSTRAP_PORT, (port)))
+
+#define task_get_task_access_port(task, port)	\
+		(task_get_special_port((task), TASK_ACCESS_PORT, (port)))
+
+#define task_set_task_access_port(task, port)	\
+		(task_set_special_port((task), TASK_ACCESS_PORT, (port)))
+
+#define task_set_task_debug_control_port(task, port) \
+		(task_set_special_port((task), TASK_DEBUG_CONTROL_PORT, (port)))
+
+#endif	/* _MACH_TASK_SPECIAL_PORTS_H_ */
diff -Nur cctools-877.5/include/mach/telemetry_notification.defs cctools-877.5-AnV/include/mach/telemetry_notification.defs
--- cctools-877.5/include/mach/telemetry_notification.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/telemetry_notification.defs	2015-11-16 07:56:14 +0000
@@ -0,0 +1,20 @@
+/*
+ * Copyright (c) 2012, Apple Inc.  All rights reserved.
+ */
+
+ /*
+ *  Interface definition for the telemetry facility.
+ */
+
+subsystem
+#if	KERNEL_USER
+    KernelUser
+#endif	/* KERNEL_USER */
+    telemetry_notification 5100;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+simpleroutine	telemetry_notification(
+	RequestPort	telemetry_port	: mach_port_t; 
+	in			flags			: uint32_t);
diff -Nur cctools-877.5/include/mach/thread_act.defs cctools-877.5-AnV/include/mach/thread_act.defs
--- cctools-877.5/include/mach/thread_act.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/thread_act.defs	2015-11-16 07:56:14 +0000
@@ -0,0 +1,353 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_port.defs
+ *	Author:	Rich Draves
+ *
+ *	Exported kernel calls.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  thread_act 3600;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+#if !KERNEL && !LIBSYSCALL_INTERFACE
+#define PREFIX(NAME) _kernelrpc_ ## NAME
+#else
+#define PREFIX(NAME) NAME
+#endif
+
+/*
+ *	Destroy the target thread.
+ *
+ *	JMM - For legacy reasons this consumes a reference to the
+ *	target thread.  This will have to change in the future because
+ *	we want the interfaces to be able to be defined in more standard
+ *	IDLs and transports, and most of them do not support the notion
+ *	of reference ownership transfers (just sharing).
+ */
+routine thread_terminate(
+		target_act	: thread_act_consume_ref_t); 
+
+
+/*
+ *	Return the selected state information for the target
+ *	thr_act.  If the thr_act is currently executing, the results
+ *	may be stale.  [Flavor THREAD_STATE_FLAVOR_LIST provides a
+ *	list of valid flavors for the target thread.]
+ */
+routine act_get_state(
+		target_act	: thread_act_t;
+		flavor		: int;
+	out	old_state	: thread_state_t, CountInOut);
+
+/*
+ *	Set the selected state information for the target thread.
+ *	If the thread is currently executing, the state change
+ *	may be ill-defined.
+ */
+routine
+#ifdef KERNEL_SERVER
+act_set_state_from_user(
+#else
+act_set_state(
+#endif
+		target_act	: thread_act_t;
+		flavor		: int;
+		new_state	: thread_state_t);
+
+/*
+ * Backward compatible old-style thread routines.
+ * These have different semantics than the new activation versions.
+ *
+ *	Return the selected state information for the target
+ *	thread.  If the thread is currently executing, the results
+ *	may be stale.  [Flavor THREAD_STATE_FLAVOR_LIST provides a
+ *	list of valid flavors for the target thr_act.]
+ */
+routine thread_get_state(
+		target_act	: thread_act_t;
+		flavor		: thread_state_flavor_t;
+	out	old_state	: thread_state_t, CountInOut);
+
+/*
+ *	Set the selected state information for the target thread.
+ *	If the thread is currently executing, the state change
+ *	may be ill-defined.
+ */
+routine
+#ifdef KERNEL_SERVER
+thread_set_state_from_user(
+#else
+thread_set_state(
+#endif
+		target_act	: thread_act_t;
+		flavor		: thread_state_flavor_t;
+		new_state	: thread_state_t);
+
+/*
+ *	Increment the suspend count for the target thread.
+ *	Once this call has completed, the thread will not
+ *	execute any further user or meta- instructions.
+ *	Once suspended, a thread may not execute again until
+ *	its suspend count is zero, and the suspend count
+ *	for its task is also zero.
+ */
+routine	thread_suspend(
+		target_act	: thread_act_t);
+
+/*
+ *	Decrement the suspend count for the target thread,
+ *	if that count is not already zero.
+ */
+routine	thread_resume(
+		target_act	: thread_act_t);
+
+/*
+ *	Cause any user or meta- instructions currently being
+ *	executed by the target thread to be aborted.  [Meta-
+ *	instructions consist of the basic traps for IPC
+ *	(e.g., msg_send, msg_receive) and self-identification
+ *	(e.g., task_self, thread_self, thread_reply).  Calls
+ *	described by MiG interfaces are not meta-instructions
+ *	themselves.]
+ */
+routine thread_abort(
+		target_act	: thread_act_t);
+
+/*
+ *	Cause any user or meta- instructions currently being
+ *	executed by the target thread to be aborted so that
+ *	they are transparently restartable.  This call fails
+ *	if the abort would result in a non-restartable condition.
+ *	Retry is the caller's responsibility.  [Meta-
+ *	instructions consist of the basic traps for IPC
+ *	(e.g., msg_send, msg_receive) and self-identification
+ *	(e.g., task_self, thread_self, thread_reply).  Calls
+ *	described by MiG interfaces are not meta-instructions
+ *	themselves.]
+ */
+routine thread_abort_safely(
+		target_act	: thread_act_t);
+
+
+routine thread_depress_abort(
+		thread		: thread_act_t);
+
+
+/*
+ *	Returns the current value of the selected special port
+ *	associated with the target thread.
+ */
+routine thread_get_special_port(
+		thr_act		: thread_act_t;
+		which_port	: int;
+	out	special_port	: mach_port_t);
+
+/*
+ *	Set one of the special ports associated with the
+ *	target thread.
+ */
+routine thread_set_special_port(
+		thr_act		: thread_act_t;
+		which_port	: int;
+		special_port	: mach_port_t);
+
+/*
+ *      Returns information about the target thread.
+ */
+routine thread_info(
+                target_act      : thread_act_t;
+                flavor          : thread_flavor_t;
+        out     thread_info_out : thread_info_t, CountInOut);
+
+/*
+ * Set an exception handler for a thread on one or more exception types
+ */
+routine		thread_set_exception_ports(
+			thread		: thread_act_t;
+			exception_mask	: exception_mask_t;
+			new_port	: mach_port_t;
+			behavior	: exception_behavior_t;
+			new_flavor	: thread_state_flavor_t);
+
+/*
+ * Lookup some of the old exception handlers for a thread
+ */
+routine		thread_get_exception_ports(
+			thread		: thread_act_t;
+			exception_mask	: exception_mask_t;
+		  out	masks		: exception_mask_array_t;
+		  out	old_handlers	: exception_handler_array_t, SameCount;
+		  out	old_behaviors	: exception_behavior_array_t, SameCount;
+		  out	old_flavors	: exception_flavor_array_t, SameCount);
+
+/*
+ * Set an exception handler for a thread on one or more exception types.
+ * At the same time, return the previously defined exception handlers for
+ * those types.
+ */
+routine		thread_swap_exception_ports(
+			thread		: thread_act_t;
+			exception_mask	: exception_mask_t;
+			new_port	: mach_port_t;
+			behavior	: exception_behavior_t;
+			new_flavor	: thread_state_flavor_t;
+		  out	masks		: exception_mask_array_t;
+		  out	old_handlers	: exception_handler_array_t, SameCount;
+		  out	old_behaviors	: exception_behavior_array_t, SameCount;
+		  out	old_flavors	: exception_flavor_array_t, SameCount);
+
+/*
+ * OBSOLETE interface.
+ */
+routine PREFIX(thread_policy)(
+	thr_act			: thread_act_t;
+	policy			: policy_t;
+	base			: policy_base_t;
+	set_limit		: boolean_t);
+
+/*
+ * Set/get policy information for a thread.
+ * (Approved Mac OS X microkernel interface)
+ */
+
+routine PREFIX(thread_policy_set)(
+	thread			: thread_act_t;
+	flavor			: thread_policy_flavor_t;
+	policy_info		: thread_policy_t);
+
+routine thread_policy_get(
+	thread			: thread_act_t;
+	flavor			: thread_policy_flavor_t;
+out	policy_info		: thread_policy_t, CountInOut;
+inout	get_default		: boolean_t);
+
+/*
+ *	Removed from the kernel.
+ */
+#if KERNEL_SERVER
+skip;
+#else
+routine thread_sample(
+		thread		: thread_act_t;
+		reply		: mach_port_make_send_t);
+#endif
+
+/*
+ *	ETAP has been removed from the kernel.
+ */
+#if KERNEL_SERVER
+skip;
+#else
+routine	etap_trace_thread(
+		target_act	: thread_act_t;
+		trace_status	: boolean_t);
+#endif
+
+/*
+ *	Assign thread to processor set.
+ */
+routine	thread_assign(
+		thread		: thread_act_t;
+		new_set		: processor_set_t);
+
+/*
+ *	Assign thread to default set.
+ */
+routine thread_assign_default(
+		thread		: thread_act_t);
+
+/*
+ *	Get current assignment for thread.
+ */
+routine thread_get_assignment(
+		thread		: thread_act_t;
+	out	assigned_set	: processor_set_name_t);
+
+
+/*
+ * OBSOLETE interface.
+ */
+routine PREFIX(thread_set_policy)(
+		thr_act		: thread_act_t;
+		pset		: processor_set_t;
+		policy		: policy_t;
+		base		: policy_base_t;
+		limit		: policy_limit_t);
+
+routine thread_get_mach_voucher(
+		thr_act		: thread_act_t;
+		which		: mach_voucher_selector_t;
+	out	voucher		: ipc_voucher_t);
+
+routine thread_set_mach_voucher(
+		thr_act		: thread_act_t;
+		voucher		: ipc_voucher_t);
+	
+routine thread_swap_mach_voucher(
+		thr_act		: thread_act_t;
+		new_voucher	: ipc_voucher_t;
+	inout	old_voucher	: ipc_voucher_t);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/thread_act.h cctools-877.5-AnV/include/mach/thread_act.h
--- cctools-877.5/include/mach/thread_act.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/thread_act.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,1283 @@
+#ifndef	_thread_act_user_
+#define	_thread_act_user_
+
+/* Module thread_act */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	thread_act_MSG_COUNT
+#define	thread_act_MSG_COUNT	28
+#endif	/* thread_act_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine thread_terminate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_terminate
+(
+	thread_act_t target_act
+);
+
+/* Routine act_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t act_get_state
+(
+	thread_act_t target_act,
+	int flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine act_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t act_set_state
+(
+	thread_act_t target_act,
+	int flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+/* Routine thread_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_state
+(
+	thread_act_t target_act,
+	thread_state_flavor_t flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine thread_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_state
+(
+	thread_act_t target_act,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+/* Routine thread_suspend */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_suspend
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_resume */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_resume
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_abort */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_abort
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_abort_safely */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_abort_safely
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_depress_abort */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_depress_abort
+(
+	thread_act_t thread
+);
+
+/* Routine thread_get_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_special_port
+(
+	thread_act_t thr_act,
+	int which_port,
+	mach_port_t *special_port
+);
+
+/* Routine thread_set_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_special_port
+(
+	thread_act_t thr_act,
+	int which_port,
+	mach_port_t special_port
+);
+
+/* Routine thread_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_info
+(
+	thread_act_t target_act,
+	thread_flavor_t flavor,
+	thread_info_t thread_info_out,
+	mach_msg_type_number_t *thread_info_outCnt
+);
+
+/* Routine thread_set_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor
+);
+
+/* Routine thread_get_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine thread_swap_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_swap_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine thread_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy
+(
+	thread_act_t thr_act,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	boolean_t set_limit
+);
+
+/* Routine thread_policy_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy_set
+(
+	thread_act_t thread,
+	thread_policy_flavor_t flavor,
+	thread_policy_t policy_info,
+	mach_msg_type_number_t policy_infoCnt
+);
+
+/* Routine thread_policy_get */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy_get
+(
+	thread_act_t thread,
+	thread_policy_flavor_t flavor,
+	thread_policy_t policy_info,
+	mach_msg_type_number_t *policy_infoCnt,
+	boolean_t *get_default
+);
+
+/* Routine thread_sample */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_sample
+(
+	thread_act_t thread,
+	mach_port_t reply
+);
+
+/* Routine etap_trace_thread */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t etap_trace_thread
+(
+	thread_act_t target_act,
+	boolean_t trace_status
+);
+
+/* Routine thread_assign */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_assign
+(
+	thread_act_t thread,
+	processor_set_t new_set
+);
+
+/* Routine thread_assign_default */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_assign_default
+(
+	thread_act_t thread
+);
+
+/* Routine thread_get_assignment */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_assignment
+(
+	thread_act_t thread,
+	processor_set_name_t *assigned_set
+);
+
+/* Routine thread_set_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_policy
+(
+	thread_act_t thr_act,
+	processor_set_t pset,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	policy_limit_t limit,
+	mach_msg_type_number_t limitCnt
+);
+
+/* Routine thread_get_mach_voucher */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_mach_voucher
+(
+	thread_act_t thr_act,
+	mach_voucher_selector_t which,
+	ipc_voucher_t *voucher
+);
+
+/* Routine thread_set_mach_voucher */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_mach_voucher
+(
+	thread_act_t thr_act,
+	ipc_voucher_t voucher
+);
+
+/* Routine thread_swap_mach_voucher */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_swap_mach_voucher
+(
+	thread_act_t thr_act,
+	ipc_voucher_t new_voucher,
+	ipc_voucher_t *old_voucher
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__thread_act_subsystem__defined
+#define __Request__thread_act_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__act_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[224];
+	} __Request__act_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__thread_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[224];
+	} __Request__thread_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_abort_safely_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_depress_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__thread_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__thread_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_flavor_t flavor;
+		mach_msg_type_number_t thread_info_outCnt;
+	} __Request__thread_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__thread_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+	} __Request__thread_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__thread_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		boolean_t set_limit;
+	} __Request__thread_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+	} __Request__thread_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		boolean_t get_default;
+	} __Request__thread_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t reply;
+		/* end of the kernel processed data */
+	} __Request__thread_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		boolean_t trace_status;
+	} __Request__etap_trace_thread_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		/* end of the kernel processed data */
+	} __Request__thread_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pset;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		mach_msg_type_number_t limitCnt;
+		integer_t limit[1];
+	} __Request__thread_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_voucher_selector_t which;
+	} __Request__thread_get_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t voucher;
+		/* end of the kernel processed data */
+	} __Request__thread_set_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_voucher;
+		mach_msg_port_descriptor_t old_voucher;
+		/* end of the kernel processed data */
+	} __Request__thread_swap_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__thread_act_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__thread_act_subsystem__defined
+#define __RequestUnion__thread_act_subsystem__defined
+union __RequestUnion__thread_act_subsystem {
+	__Request__thread_terminate_t Request_thread_terminate;
+	__Request__act_get_state_t Request_act_get_state;
+	__Request__act_set_state_t Request_act_set_state;
+	__Request__thread_get_state_t Request_thread_get_state;
+	__Request__thread_set_state_t Request_thread_set_state;
+	__Request__thread_suspend_t Request_thread_suspend;
+	__Request__thread_resume_t Request_thread_resume;
+	__Request__thread_abort_t Request_thread_abort;
+	__Request__thread_abort_safely_t Request_thread_abort_safely;
+	__Request__thread_depress_abort_t Request_thread_depress_abort;
+	__Request__thread_get_special_port_t Request_thread_get_special_port;
+	__Request__thread_set_special_port_t Request_thread_set_special_port;
+	__Request__thread_info_t Request_thread_info;
+	__Request__thread_set_exception_ports_t Request_thread_set_exception_ports;
+	__Request__thread_get_exception_ports_t Request_thread_get_exception_ports;
+	__Request__thread_swap_exception_ports_t Request_thread_swap_exception_ports;
+	__Request__thread_policy_t Request_thread_policy;
+	__Request__thread_policy_set_t Request_thread_policy_set;
+	__Request__thread_policy_get_t Request_thread_policy_get;
+	__Request__thread_sample_t Request_thread_sample;
+	__Request__etap_trace_thread_t Request_etap_trace_thread;
+	__Request__thread_assign_t Request_thread_assign;
+	__Request__thread_assign_default_t Request_thread_assign_default;
+	__Request__thread_get_assignment_t Request_thread_get_assignment;
+	__Request__thread_set_policy_t Request_thread_set_policy;
+	__Request__thread_get_mach_voucher_t Request_thread_get_mach_voucher;
+	__Request__thread_set_mach_voucher_t Request_thread_set_mach_voucher;
+	__Request__thread_swap_mach_voucher_t Request_thread_swap_mach_voucher;
+};
+#endif /* !__RequestUnion__thread_act_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__thread_act_subsystem__defined
+#define __Reply__thread_act_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[224];
+	} __Reply__act_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__act_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[224];
+	} __Reply__thread_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_abort_safely_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_depress_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+	} __Reply__thread_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t thread_info_outCnt;
+		integer_t thread_info_out[12];
+	} __Reply__thread_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__thread_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__thread_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+		boolean_t get_default;
+	} __Reply__thread_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__etap_trace_thread_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t assigned_set;
+		/* end of the kernel processed data */
+	} __Reply__thread_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t voucher;
+		/* end of the kernel processed data */
+	} __Reply__thread_get_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_voucher;
+		/* end of the kernel processed data */
+	} __Reply__thread_swap_mach_voucher_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__thread_act_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__thread_act_subsystem__defined
+#define __ReplyUnion__thread_act_subsystem__defined
+union __ReplyUnion__thread_act_subsystem {
+	__Reply__thread_terminate_t Reply_thread_terminate;
+	__Reply__act_get_state_t Reply_act_get_state;
+	__Reply__act_set_state_t Reply_act_set_state;
+	__Reply__thread_get_state_t Reply_thread_get_state;
+	__Reply__thread_set_state_t Reply_thread_set_state;
+	__Reply__thread_suspend_t Reply_thread_suspend;
+	__Reply__thread_resume_t Reply_thread_resume;
+	__Reply__thread_abort_t Reply_thread_abort;
+	__Reply__thread_abort_safely_t Reply_thread_abort_safely;
+	__Reply__thread_depress_abort_t Reply_thread_depress_abort;
+	__Reply__thread_get_special_port_t Reply_thread_get_special_port;
+	__Reply__thread_set_special_port_t Reply_thread_set_special_port;
+	__Reply__thread_info_t Reply_thread_info;
+	__Reply__thread_set_exception_ports_t Reply_thread_set_exception_ports;
+	__Reply__thread_get_exception_ports_t Reply_thread_get_exception_ports;
+	__Reply__thread_swap_exception_ports_t Reply_thread_swap_exception_ports;
+	__Reply__thread_policy_t Reply_thread_policy;
+	__Reply__thread_policy_set_t Reply_thread_policy_set;
+	__Reply__thread_policy_get_t Reply_thread_policy_get;
+	__Reply__thread_sample_t Reply_thread_sample;
+	__Reply__etap_trace_thread_t Reply_etap_trace_thread;
+	__Reply__thread_assign_t Reply_thread_assign;
+	__Reply__thread_assign_default_t Reply_thread_assign_default;
+	__Reply__thread_get_assignment_t Reply_thread_get_assignment;
+	__Reply__thread_set_policy_t Reply_thread_set_policy;
+	__Reply__thread_get_mach_voucher_t Reply_thread_get_mach_voucher;
+	__Reply__thread_set_mach_voucher_t Reply_thread_set_mach_voucher;
+	__Reply__thread_swap_mach_voucher_t Reply_thread_swap_mach_voucher;
+};
+#endif /* !__RequestUnion__thread_act_subsystem__defined */
+
+#ifndef subsystem_to_name_map_thread_act
+#define subsystem_to_name_map_thread_act \
+    { "thread_terminate", 3600 },\
+    { "act_get_state", 3601 },\
+    { "act_set_state", 3602 },\
+    { "thread_get_state", 3603 },\
+    { "thread_set_state", 3604 },\
+    { "thread_suspend", 3605 },\
+    { "thread_resume", 3606 },\
+    { "thread_abort", 3607 },\
+    { "thread_abort_safely", 3608 },\
+    { "thread_depress_abort", 3609 },\
+    { "thread_get_special_port", 3610 },\
+    { "thread_set_special_port", 3611 },\
+    { "thread_info", 3612 },\
+    { "thread_set_exception_ports", 3613 },\
+    { "thread_get_exception_ports", 3614 },\
+    { "thread_swap_exception_ports", 3615 },\
+    { "thread_policy", 3616 },\
+    { "thread_policy_set", 3617 },\
+    { "thread_policy_get", 3618 },\
+    { "thread_sample", 3619 },\
+    { "etap_trace_thread", 3620 },\
+    { "thread_assign", 3621 },\
+    { "thread_assign_default", 3622 },\
+    { "thread_get_assignment", 3623 },\
+    { "thread_set_policy", 3624 },\
+    { "thread_get_mach_voucher", 3625 },\
+    { "thread_set_mach_voucher", 3626 },\
+    { "thread_swap_mach_voucher", 3627 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _thread_act_user_ */
diff -Nur cctools-877.5/include/mach/thread_info.h cctools-877.5-AnV/include/mach/thread_info.h
--- cctools-877.5/include/mach/thread_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/thread_info.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,171 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/thread_info
+ *
+ *	Thread information structure and definitions.
+ *
+ *	The defintions in this file are exported to the user.  The kernel
+ *	will translate its internal data structures to these structures
+ *	as appropriate.
+ *
+ */
+
+#ifndef	_MACH_THREAD_INFO_H_
+#define _MACH_THREAD_INFO_H_
+
+#include <mach/boolean.h>
+#include <mach/policy.h>
+#include <mach/time_value.h>
+#include <mach/message.h>
+#include <mach/machine/vm_types.h>
+
+/*
+ *	Generic information structure to allow for expansion.
+ */
+typedef	natural_t	thread_flavor_t;
+typedef	integer_t	*thread_info_t;		/* varying array of int */
+
+#define THREAD_INFO_MAX		(1024)	/* maximum array size */
+typedef	integer_t	thread_info_data_t[THREAD_INFO_MAX];
+
+/*
+ *	Currently defined information.
+ */
+#define THREAD_BASIC_INFO         	3     /* basic information */
+
+struct thread_basic_info {
+        time_value_t    user_time;      /* user run time */
+        time_value_t    system_time;    /* system run time */
+        integer_t       cpu_usage;      /* scaled cpu usage percentage */
+	policy_t	policy;		/* scheduling policy in effect */
+        integer_t       run_state;      /* run state (see below) */
+        integer_t       flags;          /* various flags (see below) */
+        integer_t       suspend_count;  /* suspend count for thread */
+        integer_t       sleep_time;     /* number of seconds that thread
+                                           has been sleeping */
+};
+
+typedef struct thread_basic_info  thread_basic_info_data_t;
+typedef struct thread_basic_info  *thread_basic_info_t;
+#define THREAD_BASIC_INFO_COUNT   ((mach_msg_type_number_t) \
+                (sizeof(thread_basic_info_data_t) / sizeof(natural_t)))
+
+#define THREAD_IDENTIFIER_INFO		4     /* thread id and other information */
+
+struct thread_identifier_info {
+	uint64_t	thread_id;	/* system-wide unique 64-bit thread id */
+	uint64_t	thread_handle;	/* handle to be used by libproc */
+	uint64_t	dispatch_qaddr;	/* libdispatch queue address */
+};
+
+typedef struct thread_identifier_info  thread_identifier_info_data_t;
+typedef struct thread_identifier_info  *thread_identifier_info_t;
+#define THREAD_IDENTIFIER_INFO_COUNT   ((mach_msg_type_number_t) \
+                (sizeof(thread_identifier_info_data_t) / sizeof(natural_t)))
+
+/*
+ *	Scale factor for usage field.
+ */
+
+#define TH_USAGE_SCALE	1000
+
+/*
+ *	Thread run states (state field).
+ */
+
+#define TH_STATE_RUNNING	1	/* thread is running normally */
+#define TH_STATE_STOPPED	2	/* thread is stopped */
+#define TH_STATE_WAITING	3	/* thread is waiting normally */
+#define TH_STATE_UNINTERRUPTIBLE 4	/* thread is in an uninterruptible
+					   wait */
+#define TH_STATE_HALTED		5	/* thread is halted at a
+					   clean point */
+
+/*
+ *	Thread flags (flags field).
+ */
+#define TH_FLAGS_SWAPPED	0x1	/* thread is swapped out */
+#define TH_FLAGS_IDLE		0x2	/* thread is an idle thread */
+
+/*
+ * Obsolete interfaces.
+ */
+
+#define THREAD_SCHED_TIMESHARE_INFO	10
+#define THREAD_SCHED_RR_INFO		11
+#define THREAD_SCHED_FIFO_INFO		12
+
+#define IO_NUM_PRIORITIES	4
+
+struct io_stat_entry {
+	uint64_t	count;
+	uint64_t	size;
+};
+
+struct io_stat_info {
+	struct io_stat_entry    disk_reads;
+	struct io_stat_entry    io_priority[IO_NUM_PRIORITIES];
+	struct io_stat_entry    paging;
+	struct io_stat_entry    metadata;
+	struct io_stat_entry    total_io;
+};
+
+typedef struct io_stat_info *io_stat_info_t;
+
+#endif	/* _MACH_THREAD_INFO_H_ */
diff -Nur cctools-877.5/include/mach/thread_policy.h cctools-877.5-AnV/include/mach/thread_policy.h
--- cctools-877.5/include/mach/thread_policy.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/thread_policy.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,262 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_THREAD_POLICY_H_
+#define _MACH_THREAD_POLICY_H_
+
+#include <mach/mach_types.h>
+
+/*
+ * These are the calls for accessing the policy parameters
+ * of a particular thread.
+ *
+ * The extra 'get_default' parameter to the second call is
+ * IN/OUT as follows:
+ * 1) if asserted on the way in it indicates that the default
+ * values should be returned, not the ones currently set, in
+ * this case 'get_default' will always be asserted on return;
+ * 2) if unasserted on the way in, the current settings are
+ * desired and if still unasserted on return, then the info
+ * returned reflects the current settings, otherwise if
+ * 'get_default' returns asserted, it means that there are no
+ * current settings due to other parameters taking precedence,
+ * and the default ones are being returned instead.
+ */
+
+typedef natural_t	thread_policy_flavor_t;
+typedef integer_t	*thread_policy_t;
+
+/*
+kern_return_t	thread_policy_set(
+					thread_t					thread,
+					thread_policy_flavor_t		flavor,
+					thread_policy_t				policy_info,
+					mach_msg_type_number_t		count);
+
+kern_return_t	thread_policy_get(
+					thread_t					thread,
+					thread_policy_flavor_t		flavor,
+					thread_policy_t				policy_info,
+					mach_msg_type_number_t		*count,
+					boolean_t					*get_default);
+*/
+
+/*
+ * Defined flavors.
+ */
+/*
+ * THREAD_STANDARD_POLICY:
+ *
+ * This is the standard (fair) scheduling mode, assigned to new
+ * threads.  The thread will be given processor time in a manner
+ * which apportions approximately equal share to long running
+ * computations.
+ *
+ * Parameters:
+ *	[none]
+ */
+
+#define THREAD_STANDARD_POLICY			1
+
+struct thread_standard_policy {
+	natural_t		no_data;
+};
+
+typedef struct thread_standard_policy	thread_standard_policy_data_t;
+typedef struct thread_standard_policy	*thread_standard_policy_t;
+
+#define THREAD_STANDARD_POLICY_COUNT	0
+
+/*
+ * THREAD_EXTENDED_POLICY:
+ *
+ * Extended form of THREAD_STANDARD_POLICY, which supplies a
+ * hint indicating whether this is a long running computation.
+ *
+ * Parameters:
+ *
+ * timeshare: TRUE (the default) results in identical scheduling
+ * behavior as THREAD_STANDARD_POLICY.
+ */
+
+#define THREAD_EXTENDED_POLICY			1
+
+struct thread_extended_policy {
+	boolean_t		timeshare;
+};
+
+typedef struct thread_extended_policy	thread_extended_policy_data_t;
+typedef struct thread_extended_policy	*thread_extended_policy_t;
+
+#define THREAD_EXTENDED_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (thread_extended_policy_data_t) / sizeof (integer_t)))
+
+/*
+ * THREAD_TIME_CONSTRAINT_POLICY:
+ *
+ * This scheduling mode is for threads which have real time
+ * constraints on their execution.
+ *
+ * Parameters:
+ *
+ * period: This is the nominal amount of time between separate
+ * processing arrivals, specified in absolute time units.  A
+ * value of 0 indicates that there is no inherent periodicity in
+ * the computation.
+ *
+ * computation: This is the nominal amount of computation
+ * time needed during a separate processing arrival, specified
+ * in absolute time units.
+ *
+ * constraint: This is the maximum amount of real time that
+ * may elapse from the start of a separate processing arrival
+ * to the end of computation for logically correct functioning,
+ * specified in absolute time units.  Must be (>= computation).
+ * Note that latency = (constraint - computation).
+ *
+ * preemptible: This indicates that the computation may be
+ * interrupted, subject to the constraint specified above.
+ */
+
+#define THREAD_TIME_CONSTRAINT_POLICY	2
+
+struct thread_time_constraint_policy {
+	uint32_t		period;
+	uint32_t		computation;
+	uint32_t		constraint;
+	boolean_t		preemptible;
+};
+
+typedef struct thread_time_constraint_policy	\
+									thread_time_constraint_policy_data_t;
+typedef struct thread_time_constraint_policy	\
+									*thread_time_constraint_policy_t;
+
+#define THREAD_TIME_CONSTRAINT_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (thread_time_constraint_policy_data_t) / sizeof (integer_t)))
+
+/*
+ * THREAD_PRECEDENCE_POLICY:
+ *
+ * This may be used to indicate the relative value of the
+ * computation compared to the other threads in the task.
+ *
+ * Parameters:
+ *
+ * importance: The importance is specified as a signed value.
+ */
+
+#define THREAD_PRECEDENCE_POLICY		3
+
+struct thread_precedence_policy {
+	integer_t		importance;
+};
+
+typedef struct thread_precedence_policy		thread_precedence_policy_data_t;
+typedef struct thread_precedence_policy		*thread_precedence_policy_t;
+
+#define THREAD_PRECEDENCE_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (thread_precedence_policy_data_t) / sizeof (integer_t)))
+
+/*
+ * THREAD_AFFINITY_POLICY:
+ *
+ * This policy is experimental.
+ * This may be used to express affinity relationships 
+ * between threads in the task. Threads with the same affinity tag will
+ * be scheduled to share an L2 cache if possible. That is, affinity tags
+ * are a hint to the scheduler for thread placement. 
+ *
+ * The namespace of affinity tags is generally local to one task. However,
+ * a child task created after the assignment of affinity tags by its parent
+ * will share that namespace. In particular, a family of forked processes
+ * may be created with a shared affinity namespace.
+ *
+ * Parameters:
+ * tag: The affinity set identifier.
+ */
+
+#define THREAD_AFFINITY_POLICY		4
+
+struct thread_affinity_policy {
+	integer_t	affinity_tag;
+};
+
+#define THREAD_AFFINITY_TAG_NULL		0
+
+typedef struct thread_affinity_policy		thread_affinity_policy_data_t;
+typedef struct thread_affinity_policy		*thread_affinity_policy_t;
+
+#define THREAD_AFFINITY_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (thread_affinity_policy_data_t) / sizeof (integer_t)))
+
+/*
+ * THREAD_BACKGROUND_POLICY:
+ */
+
+#define THREAD_BACKGROUND_POLICY	5
+
+struct thread_background_policy {
+	integer_t	priority;
+};
+
+typedef struct thread_background_policy		thread_background_policy_data_t;
+typedef struct thread_background_policy 	*thread_background_policy_t;
+
+#define THREAD_BACKGROUND_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (thread_background_policy_data_t) / sizeof (integer_t)))
+
+
+#define THREAD_LATENCY_QOS_POLICY	7
+typedef integer_t	thread_latency_qos_t;
+
+struct thread_latency_qos_policy {
+	thread_latency_qos_t thread_latency_qos_tier;
+};
+
+typedef struct thread_latency_qos_policy	thread_latency_qos_policy_data_t;
+typedef struct thread_latency_qos_policy 	*thread_latency_qos_policy_t;
+
+#define THREAD_LATENCY_QOS_POLICY_COUNT	((mach_msg_type_number_t)	\
+	    (sizeof (thread_latency_qos_policy_data_t) / sizeof (integer_t)))
+
+#define THREAD_THROUGHPUT_QOS_POLICY	8
+typedef integer_t	thread_throughput_qos_t;
+
+struct thread_throughput_qos_policy {
+	thread_throughput_qos_t thread_throughput_qos_tier;
+};
+
+typedef struct thread_throughput_qos_policy	thread_throughput_qos_policy_data_t;
+typedef struct thread_throughput_qos_policy 	*thread_throughput_qos_policy_t;
+
+#define THREAD_THROUGHPUT_QOS_POLICY_COUNT	((mach_msg_type_number_t) \
+	    (sizeof (thread_throughput_qos_policy_data_t) / sizeof (integer_t)))
+
+
+#endif	/* _MACH_THREAD_POLICY_H_ */
diff -Nur cctools-877.5/include/mach/thread_special_ports.h cctools-877.5-AnV/include/mach/thread_special_ports.h
--- cctools-877.5/include/mach/thread_special_ports.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/thread_special_ports.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,83 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/thread_special_ports.h
+ *
+ *	Defines codes for special_purpose thread ports.  These are NOT
+ *	port identifiers - they are only used for the thread_get_special_port
+ *	and thread_set_special_port routines.
+ *	
+ */
+
+#ifndef	_MACH_THREAD_SPECIAL_PORTS_H_
+#define _MACH_THREAD_SPECIAL_PORTS_H_
+
+#define THREAD_KERNEL_PORT	1	/* Represents the thread to the outside
+					   world.*/
+
+/*
+ *	Definitions for ease of use
+ */
+
+#define thread_get_kernel_port(thread, port)	\
+		(thread_get_special_port((thread), THREAD_KERNEL_PORT, (port)))
+
+#define thread_set_kernel_port(thread, port)	\
+		(thread_set_special_port((thread), THREAD_KERNEL_PORT, (port)))
+
+#endif	/* _MACH_THREAD_SPECIAL_PORTS_H_ */
diff -Nur cctools-877.5/include/mach/thread_status.h cctools-877.5-AnV/include/mach/thread_status.h
--- cctools-877.5/include/mach/thread_status.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/thread_status.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,95 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/thread_status.h
+ *	Author:	Avadis Tevanian, Jr.
+ *
+ *	This file contains the structure definitions for the user-visible
+ *	thread state.  This thread state is examined with the thread_get_state
+ *	kernel call and may be changed with the thread_set_state kernel call.
+ *
+ */
+
+#ifndef	_MACH_THREAD_STATUS_H_
+#define	_MACH_THREAD_STATUS_H_
+
+/*
+ *	The actual structure that comprises the thread state is defined
+ *	in the machine dependent module.
+ */
+#include <mach/machine/vm_types.h>
+#include <mach/machine/thread_status.h>
+#include <mach/machine/thread_state.h>
+
+/*
+ *	Generic definition for machine-dependent thread status.
+ */
+
+typedef	natural_t	*thread_state_t;	/* Variable-length array */
+
+/* THREAD_STATE_MAX is now defined in <mach/machine/thread_state.h> */
+typedef	natural_t	thread_state_data_t[THREAD_STATE_MAX];
+
+#define	THREAD_STATE_FLAVOR_LIST	0	/* List of valid flavors */
+#define THREAD_STATE_FLAVOR_LIST_NEW	128
+#define THREAD_STATE_FLAVOR_LIST_10_9	129
+
+typedef	int			thread_state_flavor_t;
+typedef thread_state_flavor_t	*thread_state_flavor_array_t;
+
+#endif	/* _MACH_THREAD_STATUS_H_ */
diff -Nur cctools-877.5/include/mach/thread_switch.h cctools-877.5-AnV/include/mach/thread_switch.h
--- cctools-877.5/include/mach/thread_switch.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/thread_switch.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,77 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_MACH_THREAD_SWITCH_H_
+#define	_MACH_THREAD_SWITCH_H_
+
+#include <mach/mach_types.h>
+#include <mach/kern_return.h>
+#include <mach/message.h>
+#include <mach/mach_traps.h>
+
+/*
+ *	Constant definitions for thread_switch trap.
+ */
+
+#define	SWITCH_OPTION_NONE			0
+#define SWITCH_OPTION_DEPRESS		1
+#define SWITCH_OPTION_WAIT			2
+
+#define valid_switch_option(opt)	(0 <= (opt) && (opt) <= 5)
+
+#endif	/* _MACH_THREAD_SWITCH_H_ */
diff -Nur cctools-877.5/include/mach/time_value.h cctools-877.5-AnV/include/mach/time_value.h
--- cctools-877.5/include/mach/time_value.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/time_value.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,96 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+
+#ifndef	_MACH_TIME_VALUE_H_
+#define	_MACH_TIME_VALUE_H_
+
+#include <mach/machine/vm_types.h>
+
+/*
+ *	Time value returned by kernel.
+ */
+
+struct time_value {
+	integer_t seconds;
+	integer_t microseconds;
+};
+
+typedef	struct time_value	time_value_t;
+
+/*
+ *	Macros to manipulate time values.  Assume that time values
+ *	are normalized (microseconds <= 999999).
+ */
+#define	TIME_MICROS_MAX	(1000000)
+
+#define	time_value_add_usec(val, micros)	{	\
+	if (((val)->microseconds += (micros))		\
+		>= TIME_MICROS_MAX) {			\
+	    (val)->microseconds -= TIME_MICROS_MAX;	\
+	    (val)->seconds++;				\
+	}						\
+}
+
+#define	time_value_add(result, addend)		{		\
+	(result)->microseconds += (addend)->microseconds;	\
+	(result)->seconds += (addend)->seconds;			\
+	if ((result)->microseconds >= TIME_MICROS_MAX) {	\
+	    (result)->microseconds -= TIME_MICROS_MAX;		\
+	    (result)->seconds++;				\
+	}							\
+}
+
+#endif	/* _MACH_TIME_VALUE_H_ */
diff -Nur cctools-877.5/include/mach/vm_attributes.h cctools-877.5-AnV/include/mach/vm_attributes.h
--- cctools-877.5/include/mach/vm_attributes.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_attributes.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,99 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/vm_attributes.h
+ *	Author:	Alessandro Forin
+ *
+ *	Virtual memory attributes definitions.
+ *
+ *	These definitions are in addition to the machine-independent
+ *	ones (e.g. protection), and are only selectively supported
+ *	on specific machine architectures.
+ *
+ */
+
+#ifndef	_MACH_VM_ATTRIBUTES_H_
+#define	_MACH_VM_ATTRIBUTES_H_
+
+/*
+ *	Types of machine-dependent attributes
+ */
+typedef unsigned int	vm_machine_attribute_t;
+
+#define	MATTR_CACHE		1	/* cachability */
+#define MATTR_MIGRATE		2	/* migrability */
+#define	MATTR_REPLICATE		4	/* replicability */
+
+/*
+ *	Values for the above, e.g. operations on attribute
+ */
+typedef int		vm_machine_attribute_val_t;
+
+#define MATTR_VAL_OFF		0	/* (generic) turn attribute off */
+#define MATTR_VAL_ON		1	/* (generic) turn attribute on */
+#define MATTR_VAL_GET		2	/* (generic) return current value */
+
+#define MATTR_VAL_CACHE_FLUSH	6	/* flush from all caches */
+#define MATTR_VAL_DCACHE_FLUSH	7	/* flush from data caches */
+#define MATTR_VAL_ICACHE_FLUSH	8	/* flush from instruction caches */
+#define MATTR_VAL_CACHE_SYNC	9	/* sync I+D caches */
+#define MATTR_VAL_CACHE_SYNC	9	/* sync I+D caches */
+
+#define MATTR_VAL_GET_INFO	10	/* get page info (stats) */
+
+#endif	/* _MACH_VM_ATTRIBUTES_H_ */
diff -Nur cctools-877.5/include/mach/vm_behavior.h cctools-877.5-AnV/include/mach/vm_behavior.h
--- cctools-877.5/include/mach/vm_behavior.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_behavior.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,78 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ *	File:	mach/vm_behavior.h
+ *
+ *	Virtual memory map behavior definitions.
+ *
+ */
+
+#ifndef	_MACH_VM_BEHAVIOR_H_
+#define _MACH_VM_BEHAVIOR_H_
+
+/*
+ *	Types defined:
+ *
+ *	vm_behavior_t	behavior codes.
+ */
+
+typedef int		vm_behavior_t;
+
+/*
+ *	Enumeration of valid values for vm_behavior_t.
+ *	These describe expected page reference behavior for 
+ *	for a given range of virtual memory.  For implementation 
+ *	details see vm/vm_fault.c
+ */
+
+
+/*
+ * The following behaviors affect the memory region's future behavior
+ * and are stored in the VM map entry data structure.
+ */
+#define VM_BEHAVIOR_DEFAULT	((vm_behavior_t) 0)	/* default */
+#define VM_BEHAVIOR_RANDOM	((vm_behavior_t) 1)	/* random */
+#define VM_BEHAVIOR_SEQUENTIAL	((vm_behavior_t) 2)	/* forward sequential */
+#define VM_BEHAVIOR_RSEQNTL	((vm_behavior_t) 3)	/* reverse sequential */
+
+/*
+ * The following "behaviors" affect the memory region only at the time of the
+ * call and are not stored in the VM map entry.
+ */
+#define VM_BEHAVIOR_WILLNEED	((vm_behavior_t) 4)	/* will need in near future */
+#define VM_BEHAVIOR_DONTNEED	((vm_behavior_t) 5)	/* dont need in near future */
+#define VM_BEHAVIOR_FREE	((vm_behavior_t) 6)	/* free memory without write-back */
+#define VM_BEHAVIOR_ZERO_WIRED_PAGES	((vm_behavior_t) 7)	/* zero out the wired pages of an entry if it is being deleted without unwiring them first */
+#define VM_BEHAVIOR_REUSABLE	((vm_behavior_t) 8)
+#define VM_BEHAVIOR_REUSE	((vm_behavior_t) 9)
+#define VM_BEHAVIOR_CAN_REUSE	((vm_behavior_t) 10)
+
+#endif	/*_MACH_VM_BEHAVIOR_H_*/
diff -Nur cctools-877.5/include/mach/vm_inherit.h cctools-877.5-AnV/include/mach/vm_inherit.h
--- cctools-877.5/include/mach/vm_inherit.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_inherit.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,89 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/vm_inherit.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *
+ *	Virtual memory map inheritance definitions.
+ *
+ */
+
+#ifndef	_MACH_VM_INHERIT_H_
+#define	_MACH_VM_INHERIT_H_
+
+/*
+ *	Types defined:
+ *
+ *	vm_inherit_t	inheritance codes.
+ */
+
+typedef unsigned int		vm_inherit_t;	/* might want to change this */
+
+/*
+ *	Enumeration of valid values for vm_inherit_t.
+ */
+
+#define	VM_INHERIT_SHARE	((vm_inherit_t) 0)	/* share with child */
+#define	VM_INHERIT_COPY		((vm_inherit_t) 1)	/* copy into child */
+#define VM_INHERIT_NONE		((vm_inherit_t) 2)	/* absent from child */
+#define	VM_INHERIT_DONATE_COPY	((vm_inherit_t) 3)	/* copy and delete */
+
+#define VM_INHERIT_DEFAULT	VM_INHERIT_COPY
+#define VM_INHERIT_LAST_VALID VM_INHERIT_NONE
+
+#endif	/* _MACH_VM_INHERIT_H_ */
diff -Nur cctools-877.5/include/mach/vm_map.defs cctools-877.5-AnV/include/mach/vm_map.defs
--- cctools-877.5/include/mach/vm_map.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_map.defs	2015-11-16 07:56:14 +0000
@@ -0,0 +1,498 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/vm_map.defs
+ *
+ *	Exported (native-sized) kernel VM calls.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  vm_map 3800;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach_debug/mach_debug_types.defs>
+
+#if !KERNEL && !LIBSYSCALL_INTERFACE
+#define PREFIX(NAME) _kernelrpc_ ## NAME
+#else
+#define PREFIX(NAME) NAME
+#endif
+
+/*
+ *      Returns information about the contents of the virtual
+ *      address space of the target task at the specified
+ *      address.  The returned protection, inheritance, sharing
+ *      and memory object values apply to the entire range described
+ *      by the address range returned; the memory object offset
+ *      corresponds to the beginning of the address range.
+ *      [If the specified address is not allocated, the next
+ *      highest address range is described.  If no addresses beyond
+ *      the one specified are allocated, the call returns KERN_NO_SPACE.]
+ */
+routine vm_region(
+                target_task     : vm_map_t;
+	inout	address		: vm_address_t;
+        out     size            : vm_size_t;
+		flavor		: vm_region_flavor_t;
+	out	info		: vm_region_info_t, CountInOut;
+        out     object_name     : memory_object_name_t =
+                                        MACH_MSG_TYPE_MOVE_SEND
+                                        ctype: mach_port_t);
+
+/*
+ *	Allocate zero-filled memory in the address space
+ *	of the target task, either at the specified address,
+ *	or wherever space can be found (if anywhere is TRUE),
+ *	of the specified size.  The address at which the
+ *	allocation actually took place is returned.
+ */
+
+#if !KERNEL && !LIBSYSCALL_INTERFACE
+skip;
+#else
+routine PREFIX(vm_allocate)(
+		target_task	: vm_task_entry_t;
+	inout	address		: vm_address_t;
+		size		: vm_size_t;
+		flags		: int);
+
+#endif
+
+/*
+ *	Deallocate the specified range from the virtual
+ *	address space of the target task.
+ */
+
+#if !KERNEL && !LIBSYSCALL_INTERFACE
+skip;
+#else
+routine PREFIX(vm_deallocate)(
+		target_task	: vm_task_entry_t;
+		address		: vm_address_t;
+		size		: vm_size_t);
+
+#endif
+
+/*
+ *	Set the current or maximum protection attribute
+ *	for the specified range of the virtual address
+ *	space of the target task.  The current protection
+ *	limits the memory access rights of threads within
+ *	the task; the maximum protection limits the accesses
+ *	that may be given in the current protection.
+ *	Protections are specified as a set of {read, write, execute}
+ *	*permissions*.
+ */
+
+#if !KERNEL && !LIBSYSCALL_INTERFACE
+skip;
+#else
+routine PREFIX(vm_protect)(
+		target_task	: vm_task_entry_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		set_maximum	: boolean_t;
+		new_protection	: vm_prot_t);
+#endif
+
+/*
+ *	Set the inheritance attribute for the specified range
+ *	of the virtual address space of the target task.
+ *	The inheritance value is one of {none, copy, share}, and
+ *	specifies how the child address space should acquire
+ *	this memory at the time of a task_create call.
+ */
+routine vm_inherit(
+		target_task	: vm_task_entry_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		new_inheritance	: vm_inherit_t);
+
+/*
+ *	Returns the contents of the specified range of the
+ *	virtual address space of the target task.  [The
+ *	range must be aligned on a virtual page boundary,
+ *	and must be a multiple of pages in extent.  The
+ *	protection on the specified range must permit reading.]
+ */
+routine PREFIX(vm_read) (
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+	out	data		: pointer_t);
+
+/* 
+ * List corrollary to vm_read, returns mapped contents of specified
+ * ranges within target address space.
+ */
+routine vm_read_list(
+		target_task 	: vm_map_t;
+	inout	data_list   	: vm_read_entry_t;
+		count		: natural_t);
+
+/*
+ *	Writes the contents of the specified range of the
+ *	virtual address space of the target task.  [The
+ *	range must be aligned on a virtual page boundary,
+ *	and must be a multiple of pages in extent.  The
+ *	protection on the specified range must permit writing.]
+ */
+routine vm_write(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		data		: pointer_t);
+
+/*
+ *	Copy the contents of the source range of the virtual
+ *	address space of the target task to the destination
+ *	range in that same address space.  [Both of the
+ *	ranges must be aligned on a virtual page boundary,
+ *	and must be multiples of pages in extent.  The
+ *	protection on the source range must permit reading,
+ *	and the protection on the destination range must
+ *	permit writing.]
+ */
+routine vm_copy(
+		target_task	: vm_map_t;
+		source_address	: vm_address_t;
+		size		: vm_size_t;
+		dest_address	: vm_address_t);
+
+/*
+ *	Returns the contents of the specified range of the
+ *	virtual address space of the target task.  [There
+ *	are no alignment restrictions, and the results will
+ *      overwrite the area pointed to by data - which must
+ *      already exist. The protection on the specified range
+ *	must permit reading.]
+ */
+routine vm_read_overwrite(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		data		: vm_address_t;
+	out	outsize		: vm_size_t);
+
+
+routine vm_msync(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		sync_flags	: vm_sync_t );
+
+/*
+ *	Set the paging behavior attribute for the specified range
+ *	of the virtual address space of the target task.
+ *	The behavior value is one of {default, random, forward 
+ *	sequential, reverse sequential} and indicates the expected
+ *	page reference pattern for the specified range.
+ */
+routine vm_behavior_set(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		new_behavior	: vm_behavior_t);
+
+
+/*
+ *	Map a user-defined memory object into the virtual address
+ *	space of the target task.  If desired (anywhere is TRUE),
+ *	the kernel will find a suitable address range of the
+ *	specified size; else, the specific address will be allocated.
+ *
+ *	The beginning address of the range will be aligned on a virtual
+ *	page boundary, be at or beyond the address specified, and
+ *	meet the mask requirements (bits turned on in the mask must not
+ *	be turned on in the result); the size of the range, in bytes,
+ *	will be rounded	up to an integral number of virtual pages.
+ *
+ *	The memory in the resulting range will be associated with the
+ *	specified memory object, with the beginning of the memory range
+ *	referring to the specified offset into the memory object.
+ *
+ *	The mapping will take the current and maximum protections and
+ *	the inheritance attributes specified; see the vm_protect and
+ *	vm_inherit calls for a description of these attributes.
+ *
+ *	If desired (copy is TRUE), the memory range will be filled
+ *	with a copy of the data from the memory object; this copy will
+ *	be private to this mapping in this target task.  Otherwise,
+ *	the memory in this mapping will be shared with other mappings
+ *	of the same memory object at the same offset (in this task or
+ *	in other tasks).  [The Mach kernel only enforces shared memory
+ *	consistency among mappings on one host with similar page alignments.
+ *	The user-defined memory manager for this object is responsible
+ *	for further consistency.]
+ */
+routine PREFIX(vm_map) (
+		target_task	: vm_task_entry_t;
+	inout	address		: vm_address_t;
+		size		: vm_size_t;
+		mask		: vm_address_t;
+		flags		: int;
+		object		: mem_entry_name_port_t;
+		offset		: vm_offset_t;
+		copy		: boolean_t;
+		cur_protection	: vm_prot_t;
+		max_protection	: vm_prot_t;
+		inheritance	: vm_inherit_t);
+
+/*
+ *	Set/Get special properties of memory associated
+ *	to some virtual address range, such as cachability, 
+ *	migrability, replicability.  Machine-dependent.
+ */
+routine vm_machine_attribute(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		attribute	: vm_machine_attribute_t;
+	inout	value		: vm_machine_attribute_val_t);
+
+/*
+ *      Map portion of a task's address space.
+ */
+routine PREFIX(vm_remap) (
+		target_task	: vm_map_t;
+	inout	target_address	: vm_address_t;
+		size		: vm_size_t;
+		mask		: vm_address_t;
+		flags		: int;
+		src_task	: vm_map_t;
+		src_address	: vm_address_t;
+		copy		: boolean_t;
+	out	cur_protection	: vm_prot_t;
+	out	max_protection	: vm_prot_t;
+		inheritance	: vm_inherit_t);
+
+/*
+ *	Require that all future virtual memory allocation
+ *	allocates wired memory.  Setting must_wire to FALSE
+ *	disables the wired future feature.
+ */
+routine task_wire(
+		target_task	: vm_map_t;
+		must_wire	: boolean_t);
+
+	
+/*
+ *	Allow application level processes to create named entries which
+ *	correspond to mapped portions of their address space.  These named
+ *	entries can then be manipulated, shared with other processes in
+ *	other address spaces and ultimately mapped in ohter address spaces
+ */
+
+routine mach_make_memory_entry(
+		target_task	:vm_map_t;
+	inout	size		:vm_size_t;
+		offset		:vm_offset_t;
+		permission	:vm_prot_t;
+	out	object_handle	:mem_entry_name_port_move_send_t;
+		parent_entry	:mem_entry_name_port_t);
+
+/*
+ *      Give the caller information on the given location in a virtual
+ *      address space.  If a page is mapped return ref and dirty info.
+ */
+routine vm_map_page_query(
+                target_map      :vm_map_t;
+                offset          :vm_offset_t;
+        out     disposition     :integer_t;
+        out     ref_count       :integer_t);
+
+/*
+ *	Returns information about a region of memory.
+ *	Includes info about the chain of objects rooted at that region.
+ *      Only available in MACH_VM_DEBUG compiled kernels,
+ *      otherwise returns KERN_FAILURE.
+ */
+routine mach_vm_region_info(
+		task		: vm_map_t;
+		address		: vm_address_t;
+	out	region		: vm_info_region_t;
+	out	objects		: vm_info_object_array_t);
+
+routine	vm_mapped_pages_info(
+		task		: vm_map_t;
+	out	pages		: page_address_array_t);
+
+#if 0
+/*
+ *    Allow application level processes to create named entries which
+ *    are backed by sub-maps which describe regions of address space.
+ *    These regions of space can have objects mapped into them and
+ *    in turn, can be mapped into target address spaces 
+ */
+
+routine	vm_region_object_create(
+		target_task	:vm_map_t;
+	in	size		:vm_size_t;
+	out	region_object	:mach_port_move_send_t);
+#else
+skip; /* was vm_region_object_create */
+#endif
+
+/*
+ *	A recursive form of vm_region which probes submaps withint the
+ *	address space.
+ */
+routine vm_region_recurse(
+                target_task     : vm_map_t;
+	inout	address		: vm_address_t;
+        out     size            : vm_size_t;
+	inout	nesting_depth	: natural_t;
+	out	info		: vm_region_recurse_info_t,CountInOut);
+
+
+/* 
+ *	The routines below are temporary, meant for transitional use
+ *	as their counterparts are moved from 32 to 64 bit data path
+ */
+
+
+routine vm_region_recurse_64(
+                target_task     : vm_map_t;
+	inout	address		: vm_address_t;
+        out     size            : vm_size_t;
+	inout	nesting_depth	: natural_t;
+	out	info		: vm_region_recurse_info_t,CountInOut);
+
+routine mach_vm_region_info_64(
+		task		: vm_map_t;
+		address		: vm_address_t;
+	out	region		: vm_info_region_64_t;
+	out	objects		: vm_info_object_array_t);
+
+routine vm_region_64(
+                target_task     : vm_map_t;
+	inout	address		: vm_address_t;
+        out     size            : vm_size_t;
+		flavor		: vm_region_flavor_t;
+	out	info		: vm_region_info_t, CountInOut;
+        out     object_name     : memory_object_name_t =
+                                        MACH_MSG_TYPE_MOVE_SEND
+                                        ctype: mach_port_t);
+
+routine mach_make_memory_entry_64(
+		target_task	:vm_map_t;
+	inout	size		:memory_object_size_t;
+		offset		:memory_object_offset_t;
+		permission	:vm_prot_t;
+	out	object_handle	:mach_port_move_send_t;
+		parent_entry	:mem_entry_name_port_t);
+
+
+
+routine vm_map_64(
+		target_task	: vm_task_entry_t;
+	inout	address		: vm_address_t;
+		size		: vm_size_t;
+		mask		: vm_address_t;
+		flags		: int;
+		object		: mem_entry_name_port_t;
+		offset		: memory_object_offset_t;
+		copy		: boolean_t;
+		cur_protection	: vm_prot_t;
+		max_protection	: vm_prot_t;
+		inheritance	: vm_inherit_t);
+
+#if 0
+/*
+ * The UPL interfaces are not ready for user-level export.
+ */
+routine vm_map_get_upl(
+		target_task	: vm_map_t;
+		address		: vm_map_offset_t;
+	inout	size		: vm_size_t;
+	out	upl		: upl_t;
+	out	page_info	: upl_page_info_array_t, CountInOut;
+	inout	flags		: integer_t;
+		force_data_sync	: integer_t);
+
+routine vm_upl_map(
+		target_task	: vm_map_t;
+		upl		: upl_t;
+	inout	address		: vm_address_t);
+
+routine vm_upl_unmap(
+		target_task	: vm_map_t;
+		upl		: upl_t);
+#else
+skip; /* was vm_map_get_upl */
+skip; /* was vm_upl_map */
+skip; /* was vm_upl_unmap */
+#endif		
+
+/*
+ *	Control behavior and investigate state of a "purgable" object in
+ *	the virtual address space of the target task.  A purgable object is
+ *	created via a call to vm_allocate() with VM_FLAGS_PURGABLE
+ *	specified.  See the routine implementation for a complete
+ *	definition of the routine.
+ */
+routine vm_purgable_control(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		control		: vm_purgable_t;
+	inout	state		: int);
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach/vm_map.h cctools-877.5-AnV/include/mach/vm_map.h
--- cctools-877.5/include/mach/vm_map.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_map.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,1379 @@
+#ifndef	_vm_map_user_
+#define	_vm_map_user_
+
+/* Module vm_map */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	vm_map_MSG_COUNT
+#define	vm_map_MSG_COUNT	31
+#endif	/* vm_map_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine vm_region */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_region
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t *size,
+	vm_region_flavor_t flavor,
+	vm_region_info_t info,
+	mach_msg_type_number_t *infoCnt,
+	mach_port_t *object_name
+);
+
+/* Routine vm_allocate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_allocate
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t size,
+	int flags
+);
+
+/* Routine vm_deallocate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_deallocate
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size
+);
+
+/* Routine vm_protect */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_protect
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	boolean_t set_maximum,
+	vm_prot_t new_protection
+);
+
+/* Routine vm_inherit */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_inherit
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_inherit_t new_inheritance
+);
+
+/* Routine vm_read */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_read
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_offset_t *data,
+	mach_msg_type_number_t *dataCnt
+);
+
+/* Routine vm_read_list */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_read_list
+(
+	vm_map_t target_task,
+	vm_read_entry_t data_list,
+	natural_t count
+);
+
+/* Routine vm_write */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_write
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_offset_t data,
+	mach_msg_type_number_t dataCnt
+);
+
+/* Routine vm_copy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_copy
+(
+	vm_map_t target_task,
+	vm_address_t source_address,
+	vm_size_t size,
+	vm_address_t dest_address
+);
+
+/* Routine vm_read_overwrite */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_read_overwrite
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_address_t data,
+	vm_size_t *outsize
+);
+
+/* Routine vm_msync */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_msync
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_sync_t sync_flags
+);
+
+/* Routine vm_behavior_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_behavior_set
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_behavior_t new_behavior
+);
+
+/* Routine vm_map */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_map
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t size,
+	vm_address_t mask,
+	int flags,
+	mem_entry_name_port_t object,
+	vm_offset_t offset,
+	boolean_t copy,
+	vm_prot_t cur_protection,
+	vm_prot_t max_protection,
+	vm_inherit_t inheritance
+);
+
+/* Routine vm_machine_attribute */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_machine_attribute
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_machine_attribute_t attribute,
+	vm_machine_attribute_val_t *value
+);
+
+/* Routine vm_remap */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_remap
+(
+	vm_map_t target_task,
+	vm_address_t *target_address,
+	vm_size_t size,
+	vm_address_t mask,
+	int flags,
+	vm_map_t src_task,
+	vm_address_t src_address,
+	boolean_t copy,
+	vm_prot_t *cur_protection,
+	vm_prot_t *max_protection,
+	vm_inherit_t inheritance
+);
+
+/* Routine task_wire */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_wire
+(
+	vm_map_t target_task,
+	boolean_t must_wire
+);
+
+/* Routine mach_make_memory_entry */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_make_memory_entry
+(
+	vm_map_t target_task,
+	vm_size_t *size,
+	vm_offset_t offset,
+	vm_prot_t permission,
+	mem_entry_name_port_t *object_handle,
+	mem_entry_name_port_t parent_entry
+);
+
+/* Routine vm_map_page_query */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_map_page_query
+(
+	vm_map_t target_map,
+	vm_offset_t offset,
+	integer_t *disposition,
+	integer_t *ref_count
+);
+
+/* Routine mach_vm_region_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_region_info
+(
+	vm_map_t task,
+	vm_address_t address,
+	vm_info_region_t *region,
+	vm_info_object_array_t *objects,
+	mach_msg_type_number_t *objectsCnt
+);
+
+/* Routine vm_mapped_pages_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_mapped_pages_info
+(
+	vm_map_t task,
+	page_address_array_t *pages,
+	mach_msg_type_number_t *pagesCnt
+);
+
+/* Routine vm_region_recurse */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_region_recurse
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t *size,
+	natural_t *nesting_depth,
+	vm_region_recurse_info_t info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine vm_region_recurse_64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_region_recurse_64
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t *size,
+	natural_t *nesting_depth,
+	vm_region_recurse_info_t info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine mach_vm_region_info_64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_region_info_64
+(
+	vm_map_t task,
+	vm_address_t address,
+	vm_info_region_64_t *region,
+	vm_info_object_array_t *objects,
+	mach_msg_type_number_t *objectsCnt
+);
+
+/* Routine vm_region_64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_region_64
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t *size,
+	vm_region_flavor_t flavor,
+	vm_region_info_t info,
+	mach_msg_type_number_t *infoCnt,
+	mach_port_t *object_name
+);
+
+/* Routine mach_make_memory_entry_64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_make_memory_entry_64
+(
+	vm_map_t target_task,
+	memory_object_size_t *size,
+	memory_object_offset_t offset,
+	vm_prot_t permission,
+	mach_port_t *object_handle,
+	mem_entry_name_port_t parent_entry
+);
+
+/* Routine vm_map_64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_map_64
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t size,
+	vm_address_t mask,
+	int flags,
+	mem_entry_name_port_t object,
+	memory_object_offset_t offset,
+	boolean_t copy,
+	vm_prot_t cur_protection,
+	vm_prot_t max_protection,
+	vm_inherit_t inheritance
+);
+
+/* Routine vm_purgable_control */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_purgable_control
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_purgable_t control,
+	int *state
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__vm_map_subsystem__defined
+#define __Request__vm_map_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_region_flavor_t flavor;
+		mach_msg_type_number_t infoCnt;
+	} __Request__vm_region_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		int flags;
+	} __Request__vm_allocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+	} __Request__vm_deallocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		boolean_t set_maximum;
+		vm_prot_t new_protection;
+	} __Request__vm_protect_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_inherit_t new_inheritance;
+	} __Request__vm_inherit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+	} __Request__vm_read_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_read_entry_t data_list;
+		natural_t count;
+	} __Request__vm_read_list_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		mach_msg_type_number_t dataCnt;
+	} __Request__vm_write_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t source_address;
+		vm_size_t size;
+		vm_address_t dest_address;
+	} __Request__vm_copy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_address_t data;
+	} __Request__vm_read_overwrite_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_sync_t sync_flags;
+	} __Request__vm_msync_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_behavior_t new_behavior;
+	} __Request__vm_behavior_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_address_t mask;
+		int flags;
+		vm_offset_t offset;
+		boolean_t copy;
+		vm_prot_t cur_protection;
+		vm_prot_t max_protection;
+		vm_inherit_t inheritance;
+	} __Request__vm_map_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_machine_attribute_t attribute;
+		vm_machine_attribute_val_t value;
+	} __Request__vm_machine_attribute_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t src_task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t target_address;
+		vm_size_t size;
+		vm_address_t mask;
+		int flags;
+		vm_address_t src_address;
+		boolean_t copy;
+		vm_inherit_t inheritance;
+	} __Request__vm_remap_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		boolean_t must_wire;
+	} __Request__task_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t parent_entry;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_size_t size;
+		vm_offset_t offset;
+		vm_prot_t permission;
+	} __Request__mach_make_memory_entry_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_offset_t offset;
+	} __Request__vm_map_page_query_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+	} __Request__mach_vm_region_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__vm_mapped_pages_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		natural_t nesting_depth;
+		mach_msg_type_number_t infoCnt;
+	} __Request__vm_region_recurse_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		natural_t nesting_depth;
+		mach_msg_type_number_t infoCnt;
+	} __Request__vm_region_recurse_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+	} __Request__mach_vm_region_info_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_region_flavor_t flavor;
+		mach_msg_type_number_t infoCnt;
+	} __Request__vm_region_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t parent_entry;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		memory_object_size_t size;
+		memory_object_offset_t offset;
+		vm_prot_t permission;
+	} __Request__mach_make_memory_entry_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_address_t mask;
+		int flags;
+		memory_object_offset_t offset;
+		boolean_t copy;
+		vm_prot_t cur_protection;
+		vm_prot_t max_protection;
+		vm_inherit_t inheritance;
+	} __Request__vm_map_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_purgable_t control;
+		int state;
+	} __Request__vm_purgable_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__vm_map_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__vm_map_subsystem__defined
+#define __RequestUnion__vm_map_subsystem__defined
+union __RequestUnion__vm_map_subsystem {
+	__Request__vm_region_t Request_vm_region;
+	__Request__vm_allocate_t Request_vm_allocate;
+	__Request__vm_deallocate_t Request_vm_deallocate;
+	__Request__vm_protect_t Request_vm_protect;
+	__Request__vm_inherit_t Request_vm_inherit;
+	__Request__vm_read_t Request_vm_read;
+	__Request__vm_read_list_t Request_vm_read_list;
+	__Request__vm_write_t Request_vm_write;
+	__Request__vm_copy_t Request_vm_copy;
+	__Request__vm_read_overwrite_t Request_vm_read_overwrite;
+	__Request__vm_msync_t Request_vm_msync;
+	__Request__vm_behavior_set_t Request_vm_behavior_set;
+	__Request__vm_map_t Request_vm_map;
+	__Request__vm_machine_attribute_t Request_vm_machine_attribute;
+	__Request__vm_remap_t Request_vm_remap;
+	__Request__task_wire_t Request_task_wire;
+	__Request__mach_make_memory_entry_t Request_mach_make_memory_entry;
+	__Request__vm_map_page_query_t Request_vm_map_page_query;
+	__Request__mach_vm_region_info_t Request_mach_vm_region_info;
+	__Request__vm_mapped_pages_info_t Request_vm_mapped_pages_info;
+	__Request__vm_region_recurse_t Request_vm_region_recurse;
+	__Request__vm_region_recurse_64_t Request_vm_region_recurse_64;
+	__Request__mach_vm_region_info_64_t Request_mach_vm_region_info_64;
+	__Request__vm_region_64_t Request_vm_region_64;
+	__Request__mach_make_memory_entry_64_t Request_mach_make_memory_entry_64;
+	__Request__vm_map_64_t Request_vm_map_64;
+	__Request__vm_purgable_control_t Request_vm_purgable_control;
+};
+#endif /* !__RequestUnion__vm_map_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__vm_map_subsystem__defined
+#define __Reply__vm_map_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object_name;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		mach_msg_type_number_t infoCnt;
+		int info[10];
+	} __Reply__vm_region_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t address;
+	} __Reply__vm_allocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_deallocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_protect_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_inherit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t dataCnt;
+	} __Reply__vm_read_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_read_entry_t data_list;
+	} __Reply__vm_read_list_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_write_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_copy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_size_t outsize;
+	} __Reply__vm_read_overwrite_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_msync_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_behavior_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t address;
+	} __Reply__vm_map_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_machine_attribute_val_t value;
+	} __Reply__vm_machine_attribute_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t target_address;
+		vm_prot_t cur_protection;
+		vm_prot_t max_protection;
+	} __Reply__vm_remap_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object_handle;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_size_t size;
+	} __Reply__mach_make_memory_entry_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		integer_t disposition;
+		integer_t ref_count;
+	} __Reply__vm_map_page_query_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t objects;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_info_region_t region;
+		mach_msg_type_number_t objectsCnt;
+	} __Reply__mach_vm_region_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t pages;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t pagesCnt;
+	} __Reply__vm_mapped_pages_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t address;
+		vm_size_t size;
+		natural_t nesting_depth;
+		mach_msg_type_number_t infoCnt;
+		int info[19];
+	} __Reply__vm_region_recurse_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t address;
+		vm_size_t size;
+		natural_t nesting_depth;
+		mach_msg_type_number_t infoCnt;
+		int info[19];
+	} __Reply__vm_region_recurse_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t objects;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_info_region_64_t region;
+		mach_msg_type_number_t objectsCnt;
+	} __Reply__mach_vm_region_info_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object_name;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		mach_msg_type_number_t infoCnt;
+		int info[10];
+	} __Reply__vm_region_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object_handle;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		memory_object_size_t size;
+	} __Reply__mach_make_memory_entry_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t address;
+	} __Reply__vm_map_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		int state;
+	} __Reply__vm_purgable_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__vm_map_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__vm_map_subsystem__defined
+#define __ReplyUnion__vm_map_subsystem__defined
+union __ReplyUnion__vm_map_subsystem {
+	__Reply__vm_region_t Reply_vm_region;
+	__Reply__vm_allocate_t Reply_vm_allocate;
+	__Reply__vm_deallocate_t Reply_vm_deallocate;
+	__Reply__vm_protect_t Reply_vm_protect;
+	__Reply__vm_inherit_t Reply_vm_inherit;
+	__Reply__vm_read_t Reply_vm_read;
+	__Reply__vm_read_list_t Reply_vm_read_list;
+	__Reply__vm_write_t Reply_vm_write;
+	__Reply__vm_copy_t Reply_vm_copy;
+	__Reply__vm_read_overwrite_t Reply_vm_read_overwrite;
+	__Reply__vm_msync_t Reply_vm_msync;
+	__Reply__vm_behavior_set_t Reply_vm_behavior_set;
+	__Reply__vm_map_t Reply_vm_map;
+	__Reply__vm_machine_attribute_t Reply_vm_machine_attribute;
+	__Reply__vm_remap_t Reply_vm_remap;
+	__Reply__task_wire_t Reply_task_wire;
+	__Reply__mach_make_memory_entry_t Reply_mach_make_memory_entry;
+	__Reply__vm_map_page_query_t Reply_vm_map_page_query;
+	__Reply__mach_vm_region_info_t Reply_mach_vm_region_info;
+	__Reply__vm_mapped_pages_info_t Reply_vm_mapped_pages_info;
+	__Reply__vm_region_recurse_t Reply_vm_region_recurse;
+	__Reply__vm_region_recurse_64_t Reply_vm_region_recurse_64;
+	__Reply__mach_vm_region_info_64_t Reply_mach_vm_region_info_64;
+	__Reply__vm_region_64_t Reply_vm_region_64;
+	__Reply__mach_make_memory_entry_64_t Reply_mach_make_memory_entry_64;
+	__Reply__vm_map_64_t Reply_vm_map_64;
+	__Reply__vm_purgable_control_t Reply_vm_purgable_control;
+};
+#endif /* !__RequestUnion__vm_map_subsystem__defined */
+
+#ifndef subsystem_to_name_map_vm_map
+#define subsystem_to_name_map_vm_map \
+    { "vm_region", 3800 },\
+    { "vm_allocate", 3801 },\
+    { "vm_deallocate", 3802 },\
+    { "vm_protect", 3803 },\
+    { "vm_inherit", 3804 },\
+    { "vm_read", 3805 },\
+    { "vm_read_list", 3806 },\
+    { "vm_write", 3807 },\
+    { "vm_copy", 3808 },\
+    { "vm_read_overwrite", 3809 },\
+    { "vm_msync", 3810 },\
+    { "vm_behavior_set", 3811 },\
+    { "vm_map", 3812 },\
+    { "vm_machine_attribute", 3813 },\
+    { "vm_remap", 3814 },\
+    { "task_wire", 3815 },\
+    { "mach_make_memory_entry", 3816 },\
+    { "vm_map_page_query", 3817 },\
+    { "mach_vm_region_info", 3818 },\
+    { "vm_mapped_pages_info", 3819 },\
+    { "vm_region_recurse", 3821 },\
+    { "vm_region_recurse_64", 3822 },\
+    { "mach_vm_region_info_64", 3823 },\
+    { "vm_region_64", 3824 },\
+    { "mach_make_memory_entry_64", 3825 },\
+    { "vm_map_64", 3826 },\
+    { "vm_purgable_control", 3830 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _vm_map_user_ */
diff -Nur cctools-877.5/include/mach/vm_page_size.h cctools-877.5-AnV/include/mach/vm_page_size.h
--- cctools-877.5/include/mach/vm_page_size.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_page_size.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,68 @@
+/*
+ * Copyright (c) 2013 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ *
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ *
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ *
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _VM_PAGE_SIZE_H_
+#define _VM_PAGE_SIZE_H_
+
+#include <Availability.h>
+#include <mach/mach_types.h>
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+
+ /*
+  *	Globally interesting numbers.
+  *	These macros assume vm_page_size is a power-of-2.
+  */
+extern	vm_size_t	vm_page_size;
+extern	vm_size_t	vm_page_mask;
+extern	int		vm_page_shift;
+
+/*
+ *	These macros assume vm_page_size is a power-of-2.
+ */
+#define trunc_page(x)	((x) & (~(vm_page_size - 1)))
+#define round_page(x)	trunc_page((x) + (vm_page_size - 1))
+
+/*
+ *	Page-size rounding macros for the fixed-width VM types.
+ */
+#define mach_vm_trunc_page(x) ((mach_vm_offset_t)(x) & ~((signed)vm_page_mask))
+#define mach_vm_round_page(x) (((mach_vm_offset_t)(x) + vm_page_mask) & ~((signed)vm_page_mask))
+
+
+extern	vm_size_t	vm_kernel_page_size	__OSX_AVAILABLE_STARTING(__MAC_10_9, __IPHONE_7_0);
+extern	vm_size_t	vm_kernel_page_mask	__OSX_AVAILABLE_STARTING(__MAC_10_9, __IPHONE_7_0);
+extern	int		vm_kernel_page_shift	__OSX_AVAILABLE_STARTING(__MAC_10_9, __IPHONE_7_0);
+
+#define trunc_page_kernel(x)   ((x) & (~vm_kernel_page_mask))
+#define round_page_kernel(x)   trunc_page_kernel((x) + vm_kernel_page_mask)
+
+__END_DECLS
+
+#endif
diff -Nur cctools-877.5/include/mach/vm_param.h cctools-877.5-AnV/include/mach/vm_param.h
--- cctools-877.5/include/mach/vm_param.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_param.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,73 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/vm_param.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *	Date:	1985
+ *
+ *	Machine independent virtual memory parameters.
+ *
+ */
+
+#ifndef	_MACH_VM_PARAM_H_
+#define _MACH_VM_PARAM_H_
+
+#include <mach/machine/vm_param.h>
+
+
+#endif	/* _MACH_VM_PARAM_H_ */
diff -Nur cctools-877.5/include/mach/vm_prot.h cctools-877.5-AnV/include/mach/vm_prot.h
--- cctools-877.5/include/mach/vm_prot.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_prot.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,140 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/vm_prot.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *
+ *	Virtual memory protection definitions.
+ *
+ */
+
+#ifndef	_MACH_VM_PROT_H_
+#define	_MACH_VM_PROT_H_
+
+/*
+ *	Types defined:
+ *
+ *	vm_prot_t		VM protection values.
+ */
+
+typedef int		vm_prot_t;
+
+/*
+ *	Protection values, defined as bits within the vm_prot_t type
+ */
+
+#define	VM_PROT_NONE	((vm_prot_t) 0x00)
+
+#define VM_PROT_READ	((vm_prot_t) 0x01)	/* read permission */
+#define VM_PROT_WRITE	((vm_prot_t) 0x02)	/* write permission */
+#define VM_PROT_EXECUTE	((vm_prot_t) 0x04)	/* execute permission */
+
+/*
+ *	The default protection for newly-created virtual memory
+ */
+
+#define VM_PROT_DEFAULT	(VM_PROT_READ|VM_PROT_WRITE)
+
+/*
+ *	The maximum privileges possible, for parameter checking.
+ */
+
+#define VM_PROT_ALL	(VM_PROT_READ|VM_PROT_WRITE|VM_PROT_EXECUTE)
+
+/*
+ *	An invalid protection value.
+ *	Used only by memory_object_lock_request to indicate no change
+ *	to page locks.  Using -1 here is a bad idea because it
+ *	looks like VM_PROT_ALL and then some.
+ */
+
+#define VM_PROT_NO_CHANGE	((vm_prot_t) 0x08)
+
+/* 
+ *      When a caller finds that he cannot obtain write permission on a
+ *      mapped entry, the following flag can be used.  The entry will
+ *      be made "needs copy" effectively copying the object (using COW),
+ *      and write permission will be added to the maximum protections
+ *      for the associated entry. 
+ */        
+
+#define VM_PROT_COPY            ((vm_prot_t) 0x10)
+
+
+/*
+ *	Another invalid protection value.
+ *	Used only by memory_object_data_request upon an object
+ *	which has specified a copy_call copy strategy. It is used
+ *	when the kernel wants a page belonging to a copy of the
+ *	object, and is only asking the object as a result of
+ *	following a shadow chain. This solves the race between pages
+ *	being pushed up by the memory manager and the kernel
+ *	walking down the shadow chain.
+ */
+
+#define VM_PROT_WANTS_COPY	((vm_prot_t) 0x10)
+
+
+/*
+ * 	Another invalid protection value.
+ *	Indicates that the other protection bits are to be applied as a mask
+ *	against the actual protection bits of the map entry.
+ */
+#define VM_PROT_IS_MASK		((vm_prot_t) 0x40)
+
+#endif	/* _MACH_VM_PROT_H_ */
diff -Nur cctools-877.5/include/mach/vm_purgable.h cctools-877.5-AnV/include/mach/vm_purgable.h
--- cctools-877.5/include/mach/vm_purgable.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_purgable.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,139 @@
+/*
+ * Copyright (c) 2003-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+/*
+ * Virtual memory map purgeable object definitions.
+ * Objects that will be needed in the future (forward cached objects) should be queued LIFO. 
+ * Objects that have been used and are cached for reuse (backward cached) should be queued FIFO.
+ * Every user of purgeable memory is entitled to using the highest volatile group (7).
+ * Only if a client wants some of its objects to definitely be purged earlier, it can put those in
+ * another group. This could be used to make all FIFO objects (in the lower group) go away before 
+ * any LIFO objects (in the higher group) go away.
+ * Objects that should not get any chance to stay around can be marked as "obsolete". They will
+ * be emptied before any other objects or pages are reclaimed. Obsolete objects are not emptied
+ * in any particular order.
+ * 'purgeable' is recognized as the correct spelling. For historical reasons, definitions 
+ * in this file are spelled 'purgable'.
+ */
+
+#ifndef	_MACH_VM_PURGABLE_H_
+#define	_MACH_VM_PURGABLE_H_
+
+/*
+ *	Types defined:
+ *
+ *	vm_purgable_t	purgeable object control codes.
+ */
+
+typedef int	vm_purgable_t;
+
+/*
+ *	Enumeration of valid values for vm_purgable_t.
+ */
+#define VM_PURGABLE_SET_STATE	((vm_purgable_t) 0)	/* set state of purgeable object */
+#define VM_PURGABLE_GET_STATE	((vm_purgable_t) 1)	/* get state of purgeable object */
+#define VM_PURGABLE_PURGE_ALL	((vm_purgable_t) 2)	/* purge all volatile objects now */
+
+#define VM_PURGABLE_NO_AGING_SHIFT	16
+#define VM_PURGABLE_NO_AGING_MASK	(0x1 << VM_PURGABLE_NO_AGING_SHIFT)
+#define VM_PURGABLE_NO_AGING 		(0x1 << VM_PURGABLE_NO_AGING_SHIFT)
+
+#define VM_PURGABLE_DEBUG_SHIFT	12
+#define VM_PURGABLE_DEBUG_MASK	(0x3 << VM_PURGABLE_DEBUG_SHIFT)
+#define VM_PURGABLE_DEBUG_EMPTY	(0x1 << VM_PURGABLE_DEBUG_SHIFT)
+#define VM_PURGABLE_DEBUG_FAULT	(0x2 << VM_PURGABLE_DEBUG_SHIFT)
+
+/*
+ * Volatile memory ordering groups (group zero objects are purged before group 1, etc...
+ * It is implementation dependent as to whether these groups are global or per-address space.
+ * (for the moment, they are global).
+ */
+#define VM_VOLATILE_GROUP_SHIFT		8
+#define VM_VOLATILE_GROUP_MASK		(7 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_DEFAULT   VM_VOLATILE_GROUP_0
+
+#define VM_VOLATILE_GROUP_0			(0 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_1			(1 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_2			(2 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_3			(3 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_4			(4 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_5			(5 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_6			(6 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_7			(7 << VM_VOLATILE_GROUP_SHIFT)
+
+/*
+ * Purgeable behavior
+ * Within the same group, FIFO objects will be emptied before objects that are added later.
+ * LIFO objects will be emptied after objects that are added later.
+ * - Input only, not returned on state queries.
+ */
+#define VM_PURGABLE_BEHAVIOR_SHIFT  6
+#define VM_PURGABLE_BEHAVIOR_MASK   (1 << VM_PURGABLE_BEHAVIOR_SHIFT)
+#define VM_PURGABLE_BEHAVIOR_FIFO   (0 << VM_PURGABLE_BEHAVIOR_SHIFT)
+#define VM_PURGABLE_BEHAVIOR_LIFO   (1 << VM_PURGABLE_BEHAVIOR_SHIFT)
+
+/*
+ * Obsolete object.
+ * Disregard volatile group, and put object into obsolete queue instead, so it is the next object
+ * to be purged.
+ * - Input only, not returned on state queries.
+ */
+#define VM_PURGABLE_ORDERING_SHIFT		5
+#define VM_PURGABLE_ORDERING_MASK		(1 << VM_PURGABLE_ORDERING_SHIFT)
+#define VM_PURGABLE_ORDERING_OBSOLETE	(1 << VM_PURGABLE_ORDERING_SHIFT)
+#define VM_PURGABLE_ORDERING_NORMAL		(0 << VM_PURGABLE_ORDERING_SHIFT)
+
+
+/*
+ * Obsolete parameter - do not use
+ */
+#define VM_VOLATILE_ORDER_SHIFT			4
+#define VM_VOLATILE_ORDER_MASK			(1 << VM_VOLATILE_ORDER_SHIFT)
+#define VM_VOLATILE_MAKE_FIRST_IN_GROUP	(1 << VM_VOLATILE_ORDER_SHIFT)
+#define VM_VOLATILE_MAKE_LAST_IN_GROUP	(0 << VM_VOLATILE_ORDER_SHIFT)
+
+/*
+ * Valid states of a purgeable object.
+ */
+#define VM_PURGABLE_STATE_MIN	0		/* minimum purgeable object state value */
+#define VM_PURGABLE_STATE_MAX	3		/* maximum purgeable object state value */
+#define VM_PURGABLE_STATE_MASK	3		/* mask to separate state from group */
+
+#define VM_PURGABLE_NONVOLATILE	0		/* purgeable object is non-volatile */
+#define VM_PURGABLE_VOLATILE	1		/* purgeable object is volatile */
+#define VM_PURGABLE_EMPTY	2		/* purgeable object is volatile and empty */
+#define VM_PURGABLE_DENY	3		/* (mark) object not purgeable */
+
+#define VM_PURGABLE_ALL_MASKS	(VM_PURGABLE_STATE_MASK | \
+				 VM_VOLATILE_ORDER_MASK | \
+				 VM_PURGABLE_ORDERING_MASK | \
+				 VM_PURGABLE_BEHAVIOR_MASK | \
+				 VM_VOLATILE_GROUP_MASK | \
+				 VM_PURGABLE_DEBUG_MASK | \
+				 VM_PURGABLE_NO_AGING_MASK)
+#endif	/* _MACH_VM_PURGABLE_H_ */
diff -Nur cctools-877.5/include/mach/vm_region.h cctools-877.5-AnV/include/mach/vm_region.h
--- cctools-877.5/include/mach/vm_region.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_region.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,344 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ *	File:	mach/vm_region.h
+ *
+ *	Define the attributes of a task's memory region
+ *
+ */
+
+#ifndef	_MACH_VM_REGION_H_
+#define _MACH_VM_REGION_H_
+
+#include <mach/boolean.h>
+#include <mach/vm_prot.h>
+#include <mach/vm_inherit.h>
+#include <mach/vm_behavior.h>
+#include <mach/vm_types.h>
+#include <mach/message.h>
+#include <mach/machine/vm_param.h>
+#include <mach/machine/vm_types.h>
+#include <mach/memory_object_types.h>
+
+#include <sys/cdefs.h>
+
+#pragma pack(4)
+
+// LP64todo: all the current tools are 32bit, obviously never worked for 64b
+// so probably should be a real 32b ID vs. ptr.
+// Current users just check for equality
+typedef uint32_t vm32_object_id_t;
+
+/*
+ *	Types defined:
+ *
+ *	vm_region_info_t	memory region attributes
+ */
+
+#define VM_REGION_INFO_MAX      (1024)
+typedef int	*vm_region_info_t;
+typedef int	*vm_region_info_64_t;
+typedef int	*vm_region_recurse_info_t;
+typedef int	*vm_region_recurse_info_64_t;
+typedef int	 vm_region_flavor_t;
+typedef int	 vm_region_info_data_t[VM_REGION_INFO_MAX];
+
+#define VM_REGION_BASIC_INFO_64		9
+struct vm_region_basic_info_64 {
+	vm_prot_t		protection;
+	vm_prot_t		max_protection;
+	vm_inherit_t		inheritance;
+	boolean_t		shared;
+	boolean_t		reserved;
+	memory_object_offset_t	offset;
+	vm_behavior_t		behavior;
+	unsigned short		user_wired_count;
+};
+typedef struct vm_region_basic_info_64		*vm_region_basic_info_64_t;
+typedef struct vm_region_basic_info_64		 vm_region_basic_info_data_64_t;
+
+#define VM_REGION_BASIC_INFO_COUNT_64	((mach_msg_type_number_t) \
+	(sizeof(vm_region_basic_info_data_64_t)/sizeof(int)))
+
+/*
+ * Passing VM_REGION_BASIC_INFO to vm_region_64
+ * automatically converts it to a VM_REGION_BASIC_INFO_64.
+ * Please use that explicitly instead.
+ */
+#define VM_REGION_BASIC_INFO		10
+
+/*
+ * This is the legacy basic info structure.  It is
+ * deprecated because it passes only a 32-bit memory object
+ * offset back - too small for many larger objects (e.g. files).
+ */
+struct vm_region_basic_info {
+	vm_prot_t		protection;
+	vm_prot_t		max_protection;
+	vm_inherit_t		inheritance;
+	boolean_t		shared;
+	boolean_t		reserved;
+	uint32_t		offset; /* too small for a real offset */
+	vm_behavior_t		behavior;
+	unsigned short		user_wired_count;
+};
+
+typedef struct vm_region_basic_info		*vm_region_basic_info_t;
+typedef struct vm_region_basic_info		 vm_region_basic_info_data_t;
+
+#define VM_REGION_BASIC_INFO_COUNT ((mach_msg_type_number_t) \
+	(sizeof(vm_region_basic_info_data_t)/sizeof(int)))
+
+#define SM_COW             1
+#define SM_PRIVATE         2
+#define SM_EMPTY           3
+#define SM_SHARED          4
+#define SM_TRUESHARED      5
+#define SM_PRIVATE_ALIASED 6
+#define SM_SHARED_ALIASED  7
+#define SM_LARGE_PAGE      8
+
+/* 
+ * For submap info,  the SM flags above are overlayed when a submap
+ * is encountered.  The field denotes whether or not machine level mapping
+ * information is being shared.  PTE's etc.  When such sharing is taking
+ * place the value returned is SM_TRUESHARED otherwise SM_PRIVATE is passed
+ * back.
+ */
+
+
+
+
+#define VM_REGION_EXTENDED_INFO	13
+struct vm_region_extended_info {
+	vm_prot_t		protection;
+        unsigned int            user_tag;
+        unsigned int            pages_resident;
+        unsigned int            pages_shared_now_private;
+        unsigned int            pages_swapped_out;
+        unsigned int            pages_dirtied;
+        unsigned int            ref_count;
+        unsigned short          shadow_depth;
+        unsigned char           external_pager;
+        unsigned char           share_mode;
+	unsigned int		pages_reusable;
+};
+typedef struct vm_region_extended_info		*vm_region_extended_info_t;
+typedef struct vm_region_extended_info		 vm_region_extended_info_data_t;
+#define VM_REGION_EXTENDED_INFO_COUNT			\
+	((mach_msg_type_number_t)			\
+	 (sizeof (vm_region_extended_info_data_t) / sizeof (natural_t)))
+
+
+
+
+#define VM_REGION_TOP_INFO	12
+
+struct vm_region_top_info {
+        unsigned int            obj_id;
+        unsigned int            ref_count;
+        unsigned int            private_pages_resident;
+        unsigned int            shared_pages_resident;
+        unsigned char           share_mode;
+};
+
+typedef struct vm_region_top_info		*vm_region_top_info_t;
+typedef struct vm_region_top_info		 vm_region_top_info_data_t;
+
+#define VM_REGION_TOP_INFO_COUNT					\
+	((mach_msg_type_number_t)					\
+	 (sizeof(vm_region_top_info_data_t) / sizeof(natural_t)))
+
+
+
+/* 
+ * vm_region_submap_info will return information on a submap or object.
+ * The user supplies a nesting level on the call.  When a walk of the
+ * user's map is done and a submap is encountered, the nesting count is
+ * checked. If the nesting count is greater than 1 the submap is entered and
+ * the offset relative to the address in the base map is examined.  If the
+ * nesting count is zero, the information on the submap is returned.
+ * The caller may thus learn about a submap and its contents by judicious
+ * choice of the base map address and nesting count.  The nesting count
+ * allows penetration of recursively mapped submaps.  If a submap is
+ * encountered as a mapped entry of another submap, the caller may bump
+ * the nesting count and call vm_region_recurse again on the target address
+ * range.  The "is_submap" field tells the caller whether or not a submap
+ * has been encountered.
+ *
+ * Object only fields are filled in through a walking of the object shadow
+ * chain (where one is present), and a walking of the resident page queue.
+ * 
+ */
+
+struct vm_region_submap_info {
+	vm_prot_t		protection;     /* present access protection */
+	vm_prot_t		max_protection; /* max avail through vm_prot */
+	vm_inherit_t		inheritance;/* behavior of map/obj on fork */
+	uint32_t		offset;		/* offset into object/map */
+        unsigned int            user_tag;	/* user tag on map entry */
+        unsigned int            pages_resident;	/* only valid for objects */
+        unsigned int            pages_shared_now_private; /* only for objects */
+        unsigned int            pages_swapped_out; /* only for objects */
+        unsigned int            pages_dirtied;   /* only for objects */
+        unsigned int            ref_count;	 /* obj/map mappers, etc */
+        unsigned short          shadow_depth; 	/* only for obj */
+        unsigned char           external_pager;  /* only for obj */
+        unsigned char           share_mode;	/* see enumeration */
+	boolean_t		is_submap;	/* submap vs obj */
+	vm_behavior_t		behavior;	/* access behavior hint */
+	vm32_object_id_t	object_id;	/* obj/map name, not a handle */
+	unsigned short		user_wired_count; 
+};
+
+typedef struct vm_region_submap_info		*vm_region_submap_info_t;
+typedef struct vm_region_submap_info		 vm_region_submap_info_data_t;
+
+#define VM_REGION_SUBMAP_INFO_COUNT					\
+	((mach_msg_type_number_t)					\
+	 (sizeof(vm_region_submap_info_data_t) / sizeof(natural_t)))
+
+struct vm_region_submap_info_64 {
+	vm_prot_t		protection;     /* present access protection */
+	vm_prot_t		max_protection; /* max avail through vm_prot */
+	vm_inherit_t		inheritance;/* behavior of map/obj on fork */
+	memory_object_offset_t	offset;		/* offset into object/map */
+        unsigned int            user_tag;	/* user tag on map entry */
+        unsigned int            pages_resident;	/* only valid for objects */
+        unsigned int            pages_shared_now_private; /* only for objects */
+        unsigned int            pages_swapped_out; /* only for objects */
+        unsigned int            pages_dirtied;   /* only for objects */
+        unsigned int            ref_count;	 /* obj/map mappers, etc */
+        unsigned short          shadow_depth; 	/* only for obj */
+        unsigned char           external_pager;  /* only for obj */
+        unsigned char           share_mode;	/* see enumeration */
+	boolean_t		is_submap;	/* submap vs obj */
+	vm_behavior_t		behavior;	/* access behavior hint */
+	vm32_object_id_t	object_id;	/* obj/map name, not a handle */
+	unsigned short		user_wired_count;
+	unsigned int		pages_reusable;
+};
+
+typedef struct vm_region_submap_info_64		*vm_region_submap_info_64_t;
+typedef struct vm_region_submap_info_64		 vm_region_submap_info_data_64_t;
+
+#define VM_REGION_SUBMAP_INFO_V1_SIZE	\
+	(sizeof (vm_region_submap_info_data_64_t))
+#define VM_REGION_SUBMAP_INFO_V0_SIZE	\
+	(VM_REGION_SUBMAP_INFO_V1_SIZE - \
+	 sizeof (unsigned int) /* pages_reusable */)
+
+#define VM_REGION_SUBMAP_INFO_V1_COUNT_64 \
+	((mach_msg_type_number_t) \
+	 (VM_REGION_SUBMAP_INFO_V1_SIZE / sizeof (natural_t)))
+#define VM_REGION_SUBMAP_INFO_V0_COUNT_64 \
+	((mach_msg_type_number_t) \
+	 (VM_REGION_SUBMAP_INFO_V0_SIZE / sizeof (natural_t)))
+
+/* set this to the latest version */
+#define VM_REGION_SUBMAP_INFO_COUNT_64		VM_REGION_SUBMAP_INFO_V1_COUNT_64
+
+struct vm_region_submap_short_info_64 {
+	vm_prot_t		protection;     /* present access protection */
+	vm_prot_t		max_protection; /* max avail through vm_prot */
+	vm_inherit_t		inheritance;/* behavior of map/obj on fork */
+	memory_object_offset_t	offset;		/* offset into object/map */
+        unsigned int            user_tag;	/* user tag on map entry */
+        unsigned int            ref_count;	 /* obj/map mappers, etc */
+        unsigned short          shadow_depth; 	/* only for obj */
+        unsigned char           external_pager;  /* only for obj */
+        unsigned char           share_mode;	/* see enumeration */
+	boolean_t		is_submap;	/* submap vs obj */
+	vm_behavior_t		behavior;	/* access behavior hint */
+	vm32_object_id_t	object_id;	/* obj/map name, not a handle */
+	unsigned short		user_wired_count; 
+};
+
+typedef struct vm_region_submap_short_info_64	*vm_region_submap_short_info_64_t;
+typedef struct vm_region_submap_short_info_64	 vm_region_submap_short_info_data_64_t;
+
+#define VM_REGION_SUBMAP_SHORT_INFO_COUNT_64				\
+	((mach_msg_type_number_t)					\
+	 (sizeof (vm_region_submap_short_info_data_64_t) / sizeof (natural_t)))
+
+
+
+struct mach_vm_read_entry {
+	mach_vm_address_t address;
+	mach_vm_size_t size;
+};
+
+struct vm_read_entry {
+	vm_address_t	address;
+	vm_size_t	size;
+};
+
+#if VM32_SUPPORT
+struct vm32_read_entry {
+	vm32_address_t	address;
+	vm32_size_t	size;
+};
+#endif
+
+
+#define VM_MAP_ENTRY_MAX  (256)
+
+typedef struct mach_vm_read_entry	mach_vm_read_entry_t[VM_MAP_ENTRY_MAX];
+typedef struct vm_read_entry		vm_read_entry_t[VM_MAP_ENTRY_MAX];
+#if VM32_SUPPORT
+typedef struct vm32_read_entry		vm32_read_entry_t[VM_MAP_ENTRY_MAX];
+#endif
+
+#pragma pack()
+
+
+#define VM_PAGE_INFO_MAX 
+typedef int *vm_page_info_t;
+typedef int vm_page_info_data_t[VM_PAGE_INFO_MAX];
+typedef int vm_page_info_flavor_t;
+
+#define VM_PAGE_INFO_BASIC		1
+struct vm_page_info_basic {
+	int			disposition;
+	int			ref_count;
+	vm_object_id_t		object_id;
+	memory_object_offset_t	offset;
+	int			depth;
+	int			__pad; /* pad to 64-bit boundary */
+};
+typedef struct vm_page_info_basic		*vm_page_info_basic_t;
+typedef struct vm_page_info_basic		vm_page_info_basic_data_t;
+
+#define VM_PAGE_INFO_BASIC_COUNT	((mach_msg_type_number_t) \
+	(sizeof(vm_page_info_basic_data_t)/sizeof(int)))
+
+
+#endif	/*_MACH_VM_REGION_H_*/
diff -Nur cctools-877.5/include/mach/vm_statistics.h cctools-877.5-AnV/include/mach/vm_statistics.h
--- cctools-877.5/include/mach/vm_statistics.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_statistics.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,413 @@
+/*
+ * Copyright (c) 2000-2009 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/vm_statistics.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young, David Golub
+ *
+ *	Virtual memory statistics structure.
+ *
+ */
+
+#ifndef	_MACH_VM_STATISTICS_H_
+#define	_MACH_VM_STATISTICS_H_
+
+#include <mach/machine/vm_types.h>
+
+
+/*
+ * vm_statistics
+ *
+ * History:
+ *	rev0 - 	original structure.
+ *	rev1 - 	added purgable info (purgable_count and purges).
+ *	rev2 - 	added speculative_count.
+ *
+ * Note: you cannot add any new fields to this structure. Add them below in
+ * 	 vm_statistics64.
+ */
+
+struct vm_statistics {
+	natural_t	free_count;		/* # of pages free */
+	natural_t	active_count;		/* # of pages active */
+	natural_t	inactive_count;		/* # of pages inactive */
+	natural_t	wire_count;		/* # of pages wired down */
+	natural_t	zero_fill_count;	/* # of zero fill pages */
+	natural_t	reactivations;		/* # of pages reactivated */
+	natural_t	pageins;		/* # of pageins */
+	natural_t	pageouts;		/* # of pageouts */
+	natural_t	faults;			/* # of faults */
+	natural_t	cow_faults;		/* # of copy-on-writes */
+	natural_t	lookups;		/* object cache lookups */
+	natural_t	hits;			/* object cache hits */
+
+	/* added for rev1 */
+	natural_t	purgeable_count;	/* # of pages purgeable */
+	natural_t	purges;			/* # of pages purged */
+
+	/* added for rev2 */
+	/*
+	 * NB: speculative pages are already accounted for in "free_count",
+	 * so "speculative_count" is the number of "free" pages that are
+	 * used to hold data that was read speculatively from disk but
+	 * haven't actually been used by anyone so far.
+	 */
+	natural_t	speculative_count;	/* # of pages speculative */
+};
+
+/* Used by all architectures */
+typedef struct vm_statistics	*vm_statistics_t;
+typedef struct vm_statistics	vm_statistics_data_t;
+
+/* 
+ * vm_statistics64
+ *
+ * History:
+ *	rev0 - 	original structure.
+ *	rev1 - 	added purgable info (purgable_count and purges).
+ *	rev2 - 	added speculative_count.
+ *	   ----
+ *	rev3 - 	changed name to vm_statistics64.
+ *		changed some fields in structure to 64-bit on 
+ *		arm, i386 and x86_64 architectures.
+ *	rev4 -  require 64-bit alignment for efficient access
+ *		in the kernel. No change to reported data.
+ *
+ */
+
+struct vm_statistics64 {
+	natural_t	free_count;		/* # of pages free */
+	natural_t	active_count;		/* # of pages active */
+	natural_t	inactive_count;		/* # of pages inactive */
+	natural_t	wire_count;		/* # of pages wired down */
+	uint64_t	zero_fill_count;	/* # of zero fill pages */
+	uint64_t	reactivations;		/* # of pages reactivated */
+	uint64_t	pageins;		/* # of pageins */
+	uint64_t	pageouts;		/* # of pageouts */
+	uint64_t	faults;			/* # of faults */
+	uint64_t	cow_faults;		/* # of copy-on-writes */
+	uint64_t	lookups;		/* object cache lookups */
+	uint64_t	hits;			/* object cache hits */
+	uint64_t	purges;			/* # of pages purged */
+	natural_t	purgeable_count;	/* # of pages purgeable */
+	/*
+	 * NB: speculative pages are already accounted for in "free_count",
+	 * so "speculative_count" is the number of "free" pages that are
+	 * used to hold data that was read speculatively from disk but
+	 * haven't actually been used by anyone so far.
+	 */
+	natural_t	speculative_count;	/* # of pages speculative */
+
+	/* added for rev1 */
+	uint64_t	decompressions;		/* # of pages decompressed */
+	uint64_t	compressions;		/* # of pages compressed */
+	uint64_t	swapins;		/* # of pages swapped in (via compression segments) */
+	uint64_t	swapouts;		/* # of pages swapped out (via compression segments) */
+	natural_t	compressor_page_count;	/* # of pages used by the compressed pager to hold all the compressed data */
+	natural_t	throttled_count;	/* # of pages throttled */
+	natural_t	external_page_count;	/* # of pages that are file-backed (non-swap) */
+	natural_t	internal_page_count;	/* # of pages that are anonymous */
+	uint64_t	total_uncompressed_pages_in_compressor; /* # of pages (uncompressed) held within the compressor. */
+} __attribute__((aligned(8)));
+
+typedef struct vm_statistics64	*vm_statistics64_t;
+typedef struct vm_statistics64	vm_statistics64_data_t;
+
+/* 
+ * VM_STATISTICS_TRUNCATE_TO_32_BIT
+ *
+ * This is used by host_statistics() to truncate and peg the 64-bit in-kernel values from
+ * vm_statistics64 to the 32-bit values of the older structure above (vm_statistics).
+ */
+#define VM_STATISTICS_TRUNCATE_TO_32_BIT(value) ((uint32_t)(((value) > UINT32_MAX ) ? UINT32_MAX : (value)))
+
+/* 
+ * vm_extmod_statistics
+ *
+ * Structure to record modifications to a task by an
+ * external agent.
+ *
+ * History:
+ *	rev0 - 	original structure.
+ */
+
+struct vm_extmod_statistics {
+	int64_t	task_for_pid_count;			/* # of times task port was looked up */
+	int64_t task_for_pid_caller_count;	/* # of times this task called task_for_pid */
+	int64_t	thread_creation_count;		/* # of threads created in task */
+	int64_t	thread_creation_caller_count;	/* # of threads created by task */
+	int64_t	thread_set_state_count;		/* # of register state sets in task */
+	int64_t	thread_set_state_caller_count;	/* # of register state sets by task */
+} __attribute__((aligned(8)));
+
+typedef struct vm_extmod_statistics *vm_extmod_statistics_t;
+typedef struct vm_extmod_statistics vm_extmod_statistics_data_t;
+
+typedef struct vm_purgeable_stat {
+	uint64_t	count;
+	uint64_t	size;
+}vm_purgeable_stat_t;
+
+struct vm_purgeable_info {
+	vm_purgeable_stat_t fifo_data[8];
+	vm_purgeable_stat_t obsolete_data;
+	vm_purgeable_stat_t lifo_data[8];
+};
+
+typedef struct vm_purgeable_info	*vm_purgeable_info_t;
+
+/* included for the vm_map_page_query call */
+
+#define VM_PAGE_QUERY_PAGE_PRESENT      0x1
+#define VM_PAGE_QUERY_PAGE_FICTITIOUS   0x2
+#define VM_PAGE_QUERY_PAGE_REF          0x4
+#define VM_PAGE_QUERY_PAGE_DIRTY        0x8
+#define VM_PAGE_QUERY_PAGE_PAGED_OUT    0x10
+#define VM_PAGE_QUERY_PAGE_COPIED       0x20
+#define VM_PAGE_QUERY_PAGE_SPECULATIVE	0x40
+#define VM_PAGE_QUERY_PAGE_EXTERNAL	0x80
+#define VM_PAGE_QUERY_PAGE_CS_VALIDATED	0x100
+#define VM_PAGE_QUERY_PAGE_CS_TAINTED	0x200
+
+
+/*
+ * VM allocation flags:
+ * 
+ * VM_FLAGS_FIXED
+ * 	(really the absence of VM_FLAGS_ANYWHERE)
+ *	Allocate new VM region at the specified virtual address, if possible.
+ * 
+ * VM_FLAGS_ANYWHERE
+ *	Allocate new VM region anywhere it would fit in the address space.
+ *
+ * VM_FLAGS_PURGABLE
+ *	Create a purgable VM object for that new VM region.
+ *
+ * VM_FLAGS_NO_PMAP_CHECK
+ *	(for DEBUG kernel config only, ignored for other configs)
+ *	Do not check that there is no stale pmap mapping for the new VM region.
+ *	This is useful for kernel memory allocations at bootstrap when building
+ *	the initial kernel address space while some memory is already in use.
+ *
+ * VM_FLAGS_OVERWRITE
+ *	The new VM region can replace existing VM regions if necessary
+ *	(to be used in combination with VM_FLAGS_FIXED).
+ *
+ * VM_FLAGS_NO_CACHE
+ *	Pages brought in to this VM region are placed on the speculative
+ *	queue instead of the active queue.  In other words, they are not
+ *	cached so that they will be stolen first if memory runs low.
+ */
+#define VM_FLAGS_FIXED		0x0000
+#define VM_FLAGS_ANYWHERE	0x0001
+#define VM_FLAGS_PURGABLE	0x0002
+#define VM_FLAGS_NO_CACHE	0x0010
+#define VM_FLAGS_OVERWRITE	0x4000	/* delete any existing mappings first */
+/*
+ * VM_FLAGS_SUPERPAGE_MASK
+ *	3 bits that specify whether large pages should be used instead of
+ *	base pages (!=0), as well as the requested page size.
+ */
+#define VM_FLAGS_SUPERPAGE_MASK	0x70000	/* bits 0x10000, 0x20000, 0x40000 */
+#define VM_FLAGS_RETURN_DATA_ADDR	0x100000 /* Return address of target data, rather than base of page */
+#define VM_FLAGS_ALIAS_MASK	0xFF000000
+#define VM_GET_FLAGS_ALIAS(flags, alias)			\
+		(alias) = ((flags) & VM_FLAGS_ALIAS_MASK) >> 24	
+#define VM_SET_FLAGS_ALIAS(flags, alias)			\
+		(flags) = (((flags) & ~VM_FLAGS_ALIAS_MASK) |	\
+		(((alias) & ~VM_FLAGS_ALIAS_MASK) << 24))
+
+/* These are the flags that we accept from user-space */
+#define VM_FLAGS_USER_ALLOCATE	(VM_FLAGS_FIXED |		\
+				 VM_FLAGS_ANYWHERE |		\
+				 VM_FLAGS_PURGABLE |		\
+				 VM_FLAGS_NO_CACHE |		\
+				 VM_FLAGS_OVERWRITE |		\
+				 VM_FLAGS_SUPERPAGE_MASK |	\
+				 VM_FLAGS_ALIAS_MASK)
+#define VM_FLAGS_USER_MAP	(VM_FLAGS_USER_ALLOCATE |	\
+				 VM_FLAGS_RETURN_DATA_ADDR)
+#define VM_FLAGS_USER_REMAP	(VM_FLAGS_FIXED |    \
+				 VM_FLAGS_ANYWHERE | \
+				 VM_FLAGS_OVERWRITE| \
+				 VM_FLAGS_RETURN_DATA_ADDR)
+
+#define VM_FLAGS_SUPERPAGE_SHIFT 16
+#define SUPERPAGE_NONE			0	/* no superpages, if all bits are 0 */
+#define SUPERPAGE_SIZE_ANY		1
+#define VM_FLAGS_SUPERPAGE_NONE     (SUPERPAGE_NONE     << VM_FLAGS_SUPERPAGE_SHIFT)
+#define VM_FLAGS_SUPERPAGE_SIZE_ANY (SUPERPAGE_SIZE_ANY << VM_FLAGS_SUPERPAGE_SHIFT)
+#define SUPERPAGE_SIZE_2MB		2
+#define VM_FLAGS_SUPERPAGE_SIZE_2MB (SUPERPAGE_SIZE_2MB<<VM_FLAGS_SUPERPAGE_SHIFT)
+
+#define VM_MEMORY_MALLOC 1
+#define VM_MEMORY_MALLOC_SMALL 2
+#define VM_MEMORY_MALLOC_LARGE 3
+#define VM_MEMORY_MALLOC_HUGE 4
+#define VM_MEMORY_SBRK 5// uninteresting -- no one should call
+#define VM_MEMORY_REALLOC 6
+#define VM_MEMORY_MALLOC_TINY 7
+#define VM_MEMORY_MALLOC_LARGE_REUSABLE 8
+#define VM_MEMORY_MALLOC_LARGE_REUSED 9
+
+#define VM_MEMORY_ANALYSIS_TOOL 10
+
+#define VM_MEMORY_MALLOC_NANO 11
+
+#define VM_MEMORY_MACH_MSG 20
+#define VM_MEMORY_IOKIT	21
+#define VM_MEMORY_STACK  30
+#define VM_MEMORY_GUARD  31
+#define	VM_MEMORY_SHARED_PMAP 32
+/* memory containing a dylib */
+#define VM_MEMORY_DYLIB	33
+#define VM_MEMORY_OBJC_DISPATCHERS 34
+
+/* Was a nested pmap (VM_MEMORY_SHARED_PMAP) which has now been unnested */
+#define	VM_MEMORY_UNSHARED_PMAP	35
+
+
+// Placeholders for now -- as we analyze the libraries and find how they
+// use memory, we can make these labels more specific.
+#define VM_MEMORY_APPKIT 40
+#define VM_MEMORY_FOUNDATION 41
+#define VM_MEMORY_COREGRAPHICS 42
+#define VM_MEMORY_CORESERVICES 43
+#define VM_MEMORY_CARBON VM_MEMORY_CORESERVICES
+#define VM_MEMORY_JAVA 44
+#define VM_MEMORY_COREDATA 45
+#define VM_MEMORY_COREDATA_OBJECTIDS 46
+#define VM_MEMORY_ATS 50
+#define VM_MEMORY_LAYERKIT 51
+#define VM_MEMORY_CGIMAGE 52
+#define VM_MEMORY_TCMALLOC 53
+
+/* private raster data (i.e. layers, some images, QGL allocator) */
+#define	VM_MEMORY_COREGRAPHICS_DATA	54
+
+/* shared image and font caches */
+#define VM_MEMORY_COREGRAPHICS_SHARED	55
+
+/* Memory used for virtual framebuffers, shadowing buffers, etc... */
+#define	VM_MEMORY_COREGRAPHICS_FRAMEBUFFERS	56
+
+/* Window backing stores, custom shadow data, and compressed backing stores */
+#define VM_MEMORY_COREGRAPHICS_BACKINGSTORES	57
+
+/* catch-all for other uses, such as the read-only shared data page */
+#define VM_MEMORY_COREGRAPHICS_MISC VM_MEMORY_COREGRAPHICS
+
+/* memory allocated by the dynamic loader for itself */
+#define VM_MEMORY_DYLD 60
+/* malloc'd memory created by dyld */
+#define VM_MEMORY_DYLD_MALLOC 61
+
+/* Used for sqlite page cache */
+#define VM_MEMORY_SQLITE 62
+
+/* JavaScriptCore heaps */
+#define VM_MEMORY_JAVASCRIPT_CORE 63
+/* memory allocated for the JIT */
+#define VM_MEMORY_JAVASCRIPT_JIT_EXECUTABLE_ALLOCATOR 64
+#define VM_MEMORY_JAVASCRIPT_JIT_REGISTER_FILE 65
+
+/* memory allocated for GLSL */
+#define VM_MEMORY_GLSL  66
+
+/* memory allocated for OpenCL.framework */
+#define VM_MEMORY_OPENCL    67
+
+/* memory allocated for QuartzCore.framework */
+#define VM_MEMORY_COREIMAGE 68
+
+/* memory allocated for WebCore Purgeable Buffers */
+#define VM_MEMORY_WEBCORE_PURGEABLE_BUFFERS 69
+
+/* ImageIO memory */
+#define VM_MEMORY_IMAGEIO	70
+
+/* CoreProfile memory */
+#define VM_MEMORY_COREPROFILE	71
+
+/* assetsd / MobileSlideShow memory */
+#define VM_MEMORY_ASSETSD	72
+
+/* libsystem_kernel os_once_alloc */
+#define VM_MEMORY_OS_ALLOC_ONCE 73
+
+/* libdispatch internal allocator */
+#define VM_MEMORY_LIBDISPATCH 74
+
+/* Accelerate.framework image backing stores */
+#define VM_MEMORY_ACCELERATE 75
+
+/* CoreUI image block data */
+#define VM_MEMORY_COREUI 76
+
+/* CoreUI image file */
+#define VM_MEMORY_COREUIFILE 77
+
+/* Genealogy buffers */
+#define VM_MEMORY_GENEALOGY 78
+
+/* Reserve 240-255 for application */
+#define VM_MEMORY_APPLICATION_SPECIFIC_1 240
+#define VM_MEMORY_APPLICATION_SPECIFIC_16 255
+
+#define VM_MAKE_TAG(tag) ((tag) << 24)
+
+#endif	/* _MACH_VM_STATISTICS_H_ */
diff -Nur cctools-877.5/include/mach/vm_sync.h cctools-877.5-AnV/include/mach/vm_sync.h
--- cctools-877.5/include/mach/vm_sync.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_sync.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,80 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ *	File:	mach/vm_sync.h
+ *
+ *	Virtual memory synchronisation definitions.
+ *
+ */
+
+#ifndef _MACH_VM_SYNC_H_
+#define _MACH_VM_SYNC_H_
+
+typedef unsigned		vm_sync_t;
+
+/*
+ *	Synchronization flags, defined as bits within the vm_sync_t type
+ */
+
+#define	VM_SYNC_ASYNCHRONOUS	((vm_sync_t) 0x01)
+#define	VM_SYNC_SYNCHRONOUS	((vm_sync_t) 0x02)
+#define VM_SYNC_INVALIDATE	((vm_sync_t) 0x04)
+#define VM_SYNC_KILLPAGES       ((vm_sync_t) 0x08)
+#define VM_SYNC_DEACTIVATE      ((vm_sync_t) 0x10)
+#define VM_SYNC_CONTIGUOUS      ((vm_sync_t) 0x20)
+#define VM_SYNC_REUSABLEPAGES	((vm_sync_t) 0x40)
+
+#endif  /* _MACH_VM_SYNC_H_ */
diff -Nur cctools-877.5/include/mach/vm_task.h cctools-877.5-AnV/include/mach/vm_task.h
--- cctools-877.5/include/mach/vm_task.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_task.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,34 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+** This file contains compatibilty wrapper header for things that are
+** generated from mach/vm_map.defs into mach/vm_map.h. 
+** 
+** This file will go away eventually - please switch.
+*/
+#include <mach/vm_map.h>
diff -Nur cctools-877.5/include/mach/vm_types.h cctools-877.5-AnV/include/mach/vm_types.h
--- cctools-877.5/include/mach/vm_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach/vm_types.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,93 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ * 
+ */
+#ifndef	_MACH_VM_TYPES_H_
+#define _MACH_VM_TYPES_H_
+
+#include <mach/port.h>
+#include <mach/machine/vm_types.h>
+
+#include <stdint.h>
+
+typedef vm_offset_t     	pointer_t;
+typedef vm_offset_t     	vm_address_t;
+
+/*
+ * We use addr64_t for 64-bit addresses that are used on both
+ * 32 and 64-bit machines.  On PPC, they are passed and returned as
+ * two adjacent 32-bit GPRs.  We use addr64_t in places where
+ * common code must be useable both on 32 and 64-bit machines.
+ */
+typedef uint64_t addr64_t;		/* Basic effective address */
+
+/*
+ * We use reg64_t for addresses that are 32 bits on a 32-bit
+ * machine, and 64 bits on a 64-bit machine, but are always
+ * passed and returned in a single GPR on PPC.  This type
+ * cannot be used in generic 32-bit c, since on a 64-bit
+ * machine the upper half of the register will be ignored
+ * by the c compiler in 32-bit mode.  In c, we can only use the
+ * type in prototypes of functions that are written in and called
+ * from assembly language.  This type is basically a comment.
+ */
+typedef	uint32_t	reg64_t;
+
+/*
+ * To minimize the use of 64-bit fields, we keep some physical
+ * addresses (that are page aligned) as 32-bit page numbers. 
+ * This limits the physical address space to 16TB of RAM.
+ */
+typedef uint32_t ppnum_t;		/* Physical page number */
+#define PPNUM_MAX UINT32_MAX
+
+
+
+typedef mach_port_t		vm_map_t;
+
+
+#define VM_MAP_NULL		((vm_map_t) 0)
+
+/*
+ * Evolving definitions, likely to change.
+ */
+
+typedef uint64_t		vm_object_offset_t;
+typedef uint64_t		vm_object_size_t;
+
+
+typedef mach_port_t		upl_t;
+typedef mach_port_t		vm_named_entry_t;
+
+
+#define UPL_NULL		((upl_t) 0)
+#define VM_NAMED_ENTRY_NULL	((vm_named_entry_t) 0)
+
+#endif	/* _MACH_VM_TYPES_H_ */
diff -Nur cctools-877.5/include/mach-o/nlist.h cctools-877.5-AnV/include/mach-o/nlist.h
--- cctools-877.5/include/mach-o/nlist.h	2014-03-31 21:27:29 +0000
+++ cctools-877.5-AnV/include/mach-o/nlist.h	2015-11-19 09:03:07 +0000
@@ -75,7 +75,7 @@
  */
 struct nlist {
 	union {
-#ifndef __LP64__
+#if !defined(__LP64__) || defined(__APPLE__)
 		char *n_name;	/* for use when in-core */
 #endif
 		uint32_t n_strx;	/* index into the string table */
diff -Nur cctools-877.5/include/mach-o/prune_trie.h cctools-877.5-AnV/include/mach-o/prune_trie.h
--- cctools-877.5/include/mach-o/prune_trie.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach-o/prune_trie.h	2015-11-19 09:03:07 +0000
@@ -0,0 +1,54 @@
+/* -*- mode: C++; c-basic-offset: 4; tab-width: 4 -*- 
+ *
+ * Copyright (c) 2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#include <stdint.h>
+
+
+#if __cplusplus
+extern "C" {
+#endif /* __cplusplus */
+
+
+/*
+ * prune_trie() is a C vended function that is used by strip(1) to prune out
+ * defined exported symbols from the export trie.  It is passed a pointer to
+ * the start of bytes of the the trie and the size.  The prune() funciton
+ * passed is called with each symbol name in the trie to determine if it is
+ * to be pruned (retuning 1) or not (returning 0).  It writes the new trie
+ * back into the trie buffer and returns the new size in trie_new_size.
+ * If the pruning succeeds, NULL is returned.  If there was an error processing
+ * the trie (e.f. it is malformed), then an error message string is returned.
+ * The error string can be freed.
+ */
+extern const char*
+prune_trie(
+	uint8_t*	trie_start,
+	uint32_t	trie_start_size,
+	int			(*prune)(const char *name),
+	uint32_t*	trie_new_size);
+
+
+#if __cplusplus
+}
+#endif /* __cplusplus */
diff -Nur cctools-877.5/include/mach-o/rld.h cctools-877.5-AnV/include/mach-o/rld.h
--- cctools-877.5/include/mach-o/rld.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach-o/rld.h	2015-11-19 09:03:07 +0000
@@ -27,9 +27,13 @@
 #ifndef _MACHO_RLD_H_
 #define _MACHO_RLD_H_
 
-#include <streams/streams.h>
+//#include <streams/streams.h>
 #include <mach-o/loader.h>
 
+#ifndef NXStream
+#define NXStream void
+#endif
+
 extern long rld_load(
     NXStream *stream,
     struct mach_header **header_addr,
diff -Nur cctools-877.5/include/mach-o/swap.h cctools-877.5-AnV/include/mach-o/swap.h
--- cctools-877.5/include/mach-o/swap.h	2014-01-14 00:21:55 +0000
+++ cctools-877.5-AnV/include/mach-o/swap.h	2015-11-19 09:03:07 +0000
@@ -35,6 +35,11 @@
 extern "C" {
 #endif /* __cplusplus */
 
+#ifndef SWAP_LONG
+#define SWAP_LONG OSSwapInt32
+#endif
+
+#ifndef _STUFF_BYTESEX_H_
 extern void swap_fat_header(
     struct fat_header *fat_header,
     enum NXByteOrder target_byte_order);
@@ -243,6 +248,7 @@
     struct dylib_table_of_contents *tocs,
     uint32_t ntocs,
     enum NXByteOrder target_byte_sex);
+#endif
 
 #ifdef __cplusplus
 }
diff -Nur cctools-877.5/include/mach_debug/hash_info.h cctools-877.5-AnV/include/mach_debug/hash_info.h
--- cctools-877.5/include/mach_debug/hash_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach_debug/hash_info.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,73 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_MACH_DEBUG_HASH_INFO_H_
+#define _MACH_DEBUG_HASH_INFO_H_
+
+/*
+ *	Remember to update the mig type definitions
+ *	in mach_debug_types.defs when adding/removing fields.
+ */
+
+typedef struct hash_info_bucket {
+	natural_t	hib_count;	/* number of records in bucket */
+} hash_info_bucket_t;
+
+typedef hash_info_bucket_t *hash_info_bucket_array_t;
+
+#endif	/* _MACH_DEBUG_HASH_INFO_H_ */
diff -Nur cctools-877.5/include/mach_debug/ipc_info.h cctools-877.5-AnV/include/mach_debug/ipc_info.h
--- cctools-877.5/include/mach_debug/ipc_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach_debug/ipc_info.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,116 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach_debug/ipc_info.h
+ *	Author:	Rich Draves
+ *	Date:	March, 1990
+ *
+ *	Definitions for the IPC debugging interface.
+ */
+
+#ifndef	_MACH_DEBUG_IPC_INFO_H_
+#define _MACH_DEBUG_IPC_INFO_H_
+
+#include <mach/boolean.h>
+#include <mach/port.h>
+#include <mach/machine/vm_types.h>
+
+/*
+ *	Remember to update the mig type definitions
+ *	in mach_debug_types.defs when adding/removing fields.
+ */
+
+typedef struct ipc_info_space {
+	natural_t iis_genno_mask;	/* generation number mask */
+	natural_t iis_table_size;	/* size of table */
+	natural_t iis_table_next;	/* next possible size of table */
+	natural_t iis_tree_size;	/* size of tree (UNUSED) */
+	natural_t iis_tree_small;	/* # of small entries in tree (UNUSED) */
+	natural_t iis_tree_hash;	/* # of hashed entries in tree (UNUSED) */
+} ipc_info_space_t;
+
+typedef struct ipc_info_space_basic {
+	natural_t iisb_genno_mask;	/* generation number mask */
+	natural_t iisb_table_size;	/* size of table */
+	natural_t iisb_table_next;	/* next possible size of table */
+	natural_t iisb_table_inuse;	/* number of entries in use */
+	natural_t iisb_reserved[2];	/* future expansion */
+} ipc_info_space_basic_t;
+
+typedef struct ipc_info_name {
+	mach_port_name_t iin_name;		/* port name, including gen number */
+/*boolean_t*/integer_t iin_collision;	/* collision at this entry? */
+	mach_port_type_t iin_type;	/* straight port type */
+	mach_port_urefs_t iin_urefs;	/* user-references */
+	natural_t iin_object;		/* object pointer/identifier */
+	natural_t iin_next;		/* marequest/next in free list */
+	natural_t iin_hash;		/* hash index */
+} ipc_info_name_t;
+
+typedef ipc_info_name_t *ipc_info_name_array_t;
+
+/* UNUSED */
+typedef struct ipc_info_tree_name {
+	ipc_info_name_t iitn_name;
+	mach_port_name_t iitn_lchild;	/* name of left child */
+	mach_port_name_t iitn_rchild;	/* name of right child */
+} ipc_info_tree_name_t;
+
+typedef ipc_info_tree_name_t *ipc_info_tree_name_array_t;
+
+#endif	/* _MACH_DEBUG_IPC_INFO_H_ */
diff -Nur cctools-877.5/include/mach_debug/lockgroup_info.h cctools-877.5-AnV/include/mach_debug/lockgroup_info.h
--- cctools-877.5/include/mach_debug/lockgroup_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach_debug/lockgroup_info.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,75 @@
+/*
+ * Copyright (c) 2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ *	File:	mach/lockgroup_info.h
+ *
+ *	Definitions for host_lockgroup_info call.
+ */
+
+#ifndef	_MACH_DEBUG_LOCKGROUP_INFO_H_
+#define	_MACH_DEBUG_LOCKGROUP_INFO_H_
+
+#include <mach/mach_types.h>
+
+#define LOCKGROUP_MAX_NAME	64
+
+#define LOCKGROUP_ATTR_STAT	0x01ULL
+
+typedef struct lockgroup_info {
+	char		lockgroup_name[LOCKGROUP_MAX_NAME];
+	uint64_t	lockgroup_attr;
+	uint64_t	lock_spin_cnt;
+	uint64_t	lock_spin_util_cnt;
+	uint64_t	lock_spin_held_cnt;
+	uint64_t	lock_spin_miss_cnt;
+	uint64_t	lock_spin_held_max;
+	uint64_t	lock_spin_held_cum;
+	uint64_t	lock_mtx_cnt;
+	uint64_t	lock_mtx_util_cnt;
+	uint64_t	lock_mtx_held_cnt;
+	uint64_t	lock_mtx_miss_cnt;
+	uint64_t	lock_mtx_wait_cnt;
+	uint64_t	lock_mtx_held_max;
+	uint64_t	lock_mtx_held_cum;
+	uint64_t	lock_mtx_wait_max;
+	uint64_t	lock_mtx_wait_cum;
+	uint64_t	lock_rw_cnt;
+	uint64_t	lock_rw_util_cnt;
+	uint64_t	lock_rw_held_cnt;
+	uint64_t	lock_rw_miss_cnt;
+	uint64_t	lock_rw_wait_cnt;
+	uint64_t	lock_rw_held_max;
+	uint64_t	lock_rw_held_cum;
+	uint64_t	lock_rw_wait_max;
+	uint64_t	lock_rw_wait_cum;
+} lockgroup_info_t;
+
+typedef lockgroup_info_t *lockgroup_info_array_t;
+
+#endif	/* _MACH_DEBUG_LOCKGROUP_INFO_H_ */
+
diff -Nur cctools-877.5/include/mach_debug/mach_debug.h cctools-877.5-AnV/include/mach_debug/mach_debug.h
--- cctools-877.5/include/mach_debug/mach_debug.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach_debug/mach_debug.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,50 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (C) Apple Computer 1998
+ * ALL Rights Reserved
+ */
+/*
+ * This file represents the interfaces that used to come
+ * from creating the user headers from the mach_debug.defs file.
+ * Because mach_debug.defs was decomposed, this file now just
+ * wraps up all the new interface headers generated from
+ * each of the new .defs resulting from that decomposition.
+ */
+#ifndef	_MACH_DEBUG_MACH_DEBUG_H_
+#define _MACH_DEBUG_MACH_DEBUG_H_
+
+#include <mach_debug/mach_debug_types.h>
+
+#include <mach/mach_host.h>
+#include <mach/mach_port.h>
+#include <mach/mach_interface.h>
+
+#endif /* _MACH_DEBUG_MACH_DEBUG_H_ */
+
+
diff -Nur cctools-877.5/include/mach_debug/mach_debug_types.defs cctools-877.5-AnV/include/mach_debug/mach_debug_types.defs
--- cctools-877.5/include/mach_debug/mach_debug_types.defs	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach_debug/mach_debug_types.defs	2015-11-16 07:56:14 +0000
@@ -0,0 +1,112 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	Mach kernel debugging interface type declarations
+ */
+
+#ifndef	_MACH_DEBUG_MACH_DEBUG_TYPES_DEFS_
+#define _MACH_DEBUG_MACH_DEBUG_TYPES_DEFS_
+
+#include <mach/std_types.defs>
+
+type zone_name_t = struct[80] of char;			/* deprecated */
+type zone_name_array_t = array[] of zone_name_t;	/* deprecated */
+
+type zone_info_t = struct[9] of integer_t;		/* deprecated */
+type zone_info_array_t = array[] of zone_info_t; 	/* deprecated */
+
+type mach_zone_name_t = struct[80] of char;
+type mach_zone_name_array_t = array[] of mach_zone_name_t;
+
+type mach_zone_info_t = struct[8] of uint64_t;
+type mach_zone_info_array_t = array[] of mach_zone_info_t;
+
+type task_zone_info_t = struct[11] of uint64_t;
+type task_zone_info_array_t = array[] of task_zone_info_t;
+
+type hash_info_bucket_t = struct[1] of natural_t;
+type hash_info_bucket_array_t = array[] of hash_info_bucket_t;
+
+type ipc_info_space_t = struct[6] of natural_t;
+type ipc_info_space_basic_t = struct[6] of natural_t;
+
+type ipc_info_name_t = struct[7] of natural_t;
+type ipc_info_name_array_t = array[] of ipc_info_name_t;
+
+type ipc_info_tree_name_t = struct[9] of natural_t;
+type ipc_info_tree_name_array_t = array[] of ipc_info_tree_name_t;
+
+type vm_info_region_t = struct[10] of natural_t;
+type vm_info_region_64_t = struct[11] of natural_t;
+type mach_vm_info_region_t = struct[14] of natural_t;
+
+type vm_info_object_t = struct[21] of natural_t;
+type vm_info_object_array_t = ^array[] of vm_info_object_t;
+
+type page_address_array_t = ^array[] of integer_t;
+
+type symtab_name_t = c_string[*:32];
+
+type lockgroup_info_t = struct[63] of integer_t;
+type lockgroup_info_array_t = array[] of lockgroup_info_t;
+
+import <mach_debug/mach_debug_types.h>;
+
+#endif	/* _MACH_DEBUG_MACH_DEBUG_TYPES_DEFS_ */
+
+/* vim: set ft=c : */
diff -Nur cctools-877.5/include/mach_debug/mach_debug_types.h cctools-877.5-AnV/include/mach_debug/mach_debug_types.h
--- cctools-877.5/include/mach_debug/mach_debug_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach_debug/mach_debug_types.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,74 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	Mach kernel debugging interface type declarations
+ */
+
+#ifndef	_MACH_DEBUG_MACH_DEBUG_TYPES_H_
+#define _MACH_DEBUG_MACH_DEBUG_TYPES_H_
+
+#include <mach_debug/ipc_info.h>
+#include <mach_debug/vm_info.h>
+#include <mach_debug/zone_info.h>
+#include <mach_debug/page_info.h>
+#include <mach_debug/hash_info.h>
+#include <mach_debug/lockgroup_info.h>
+
+typedef	char	symtab_name_t[32];
+
+#endif	/* _MACH_DEBUG_MACH_DEBUG_TYPES_H_ */
diff -Nur cctools-877.5/include/mach_debug/page_info.h cctools-877.5-AnV/include/mach_debug/page_info.h
--- cctools-877.5/include/mach_debug/page_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach_debug/page_info.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,64 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+#ifndef MACH_DEBUG_PAGE_INFO_H 
+#define MACH_DEBUG_PAGE_INFO_H 
+
+#include <mach/machine/vm_types.h>
+
+typedef	vm_offset_t	*page_address_array_t;
+#endif	/* MACH_DEBUG_PAGE_INFO_H */
diff -Nur cctools-877.5/include/mach_debug/vm_info.h cctools-877.5-AnV/include/mach_debug/vm_info.h
--- cctools-877.5/include/mach_debug/vm_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach_debug/vm_info.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,149 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ *	File:	mach_debug/vm_info.h
+ *	Author:	Rich Draves
+ *	Date:	March, 1990
+ *
+ *	Definitions for the VM debugging interface.
+ */
+
+#ifndef	_MACH_DEBUG_VM_INFO_H_
+#define _MACH_DEBUG_VM_INFO_H_
+
+#include <mach/boolean.h>
+#include <mach/machine/vm_types.h>
+#include <mach/vm_inherit.h>
+#include <mach/vm_prot.h>
+#include <mach/memory_object_types.h>
+
+#pragma pack(4)
+
+/*
+ *	Remember to update the mig type definitions
+ *	in mach_debug_types.defs when adding/removing fields.
+ */
+typedef struct mach_vm_info_region {
+	mach_vm_offset_t vir_start;	/* start of region */
+	mach_vm_offset_t vir_end;	/* end of region */
+	mach_vm_offset_t vir_object;	/* the mapped object(kernal addr) */
+	memory_object_offset_t vir_offset;	/* offset into object */
+	boolean_t vir_needs_copy;	/* does object need to be copied? */
+	vm_prot_t vir_protection;	/* protection code */
+	vm_prot_t vir_max_protection;	/* maximum protection */
+	vm_inherit_t vir_inheritance;	/* inheritance */
+	natural_t vir_wired_count;	/* number of times wired */
+	natural_t vir_user_wired_count; /* number of times user has wired */
+} mach_vm_info_region_t;
+
+typedef struct vm_info_region_64 {
+	natural_t vir_start;		/* start of region */
+	natural_t vir_end;		/* end of region */
+	natural_t vir_object;		/* the mapped object */
+	memory_object_offset_t vir_offset;	/* offset into object */
+	boolean_t vir_needs_copy;	/* does object need to be copied? */
+	vm_prot_t vir_protection;	/* protection code */
+	vm_prot_t vir_max_protection;	/* maximum protection */
+	vm_inherit_t vir_inheritance;	/* inheritance */
+	natural_t vir_wired_count;	/* number of times wired */
+	natural_t vir_user_wired_count; /* number of times user has wired */
+} vm_info_region_64_t;
+
+typedef struct vm_info_region {
+	natural_t vir_start;		/* start of region */
+	natural_t vir_end;		/* end of region */
+	natural_t vir_object;		/* the mapped object */
+	natural_t vir_offset;		/* offset into object */
+	boolean_t vir_needs_copy;	/* does object need to be copied? */
+	vm_prot_t vir_protection;	/* protection code */
+	vm_prot_t vir_max_protection;	/* maximum protection */
+	vm_inherit_t vir_inheritance;	/* inheritance */
+	natural_t vir_wired_count;	/* number of times wired */
+	natural_t vir_user_wired_count; /* number of times user has wired */
+} vm_info_region_t;
+
+
+typedef struct vm_info_object {
+	natural_t vio_object;		/* this object */
+	natural_t vio_size;		/* object size (valid if internal - but too small) */
+	unsigned int vio_ref_count;	/* number of references */
+	unsigned int vio_resident_page_count; /* number of resident pages */
+	unsigned int vio_absent_count;	/* number requested but not filled */
+	natural_t vio_copy;		/* copy object */
+	natural_t vio_shadow;		/* shadow object */
+	natural_t vio_shadow_offset;	/* offset into shadow object */
+	natural_t vio_paging_offset;	/* offset into memory object */
+	memory_object_copy_strategy_t vio_copy_strategy;
+					/* how to handle data copy */
+	vm_offset_t vio_last_alloc;	/* offset of last allocation */
+	/* many random attributes */
+	unsigned int vio_paging_in_progress;
+	boolean_t vio_pager_created;
+	boolean_t vio_pager_initialized;
+	boolean_t vio_pager_ready;
+	boolean_t vio_can_persist;
+	boolean_t vio_internal;
+	boolean_t vio_temporary;
+	boolean_t vio_alive;
+	boolean_t vio_purgable;
+	boolean_t vio_purgable_volatile;
+} vm_info_object_t;
+
+typedef vm_info_object_t *vm_info_object_array_t;
+
+#pragma pack()
+
+#endif	/* _MACH_DEBUG_VM_INFO_H_ */
diff -Nur cctools-877.5/include/mach_debug/zone_info.h cctools-877.5-AnV/include/mach_debug/zone_info.h
--- cctools-877.5/include/mach_debug/zone_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/mach_debug/zone_info.h	2015-11-16 07:56:14 +0000
@@ -0,0 +1,136 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_MACH_DEBUG_ZONE_INFO_H_
+#define _MACH_DEBUG_ZONE_INFO_H_
+
+#include <mach/boolean.h>
+#include <mach/machine/vm_types.h>
+
+/*
+ *	Legacy definitions for host_zone_info().  This interface, and
+ *	these definitions have been deprecated in favor of the new
+ *	mach_zone_info() inteface and types below.
+ */
+
+#define ZONE_NAME_MAX_LEN		80
+
+typedef struct zone_name {
+	char		zn_name[ZONE_NAME_MAX_LEN];
+} zone_name_t;
+
+typedef zone_name_t *zone_name_array_t;
+
+
+typedef struct zone_info {
+	integer_t	zi_count;	/* Number of elements used now */
+	vm_size_t	zi_cur_size;	/* current memory utilization */
+	vm_size_t	zi_max_size;	/* how large can this zone grow */
+	vm_size_t	zi_elem_size;	/* size of an element */
+	vm_size_t	zi_alloc_size;	/* size used for more memory */
+	integer_t	zi_pageable;	/* zone pageable? */
+	integer_t	zi_sleepable;	/* sleep if empty? */
+	integer_t	zi_exhaustible;	/* merely return if empty? */
+	integer_t	zi_collectable;	/* garbage collect elements? */
+} zone_info_t;
+
+typedef zone_info_t *zone_info_array_t;
+
+
+/*
+ *	Remember to update the mig type definitions
+ *	in mach_debug_types.defs when adding/removing fields.
+ */
+
+#define MACH_ZONE_NAME_MAX_LEN		80
+
+typedef struct mach_zone_name {
+	char		mzn_name[ZONE_NAME_MAX_LEN];
+} mach_zone_name_t;
+
+typedef mach_zone_name_t *mach_zone_name_array_t;
+
+typedef struct mach_zone_info_data {
+	uint64_t	mzi_count;	/* count of elements in use */
+	uint64_t	mzi_cur_size;	/* current memory utilization */
+	uint64_t	mzi_max_size;	/* how large can this zone grow */
+        uint64_t	mzi_elem_size;	/* size of an element */
+	uint64_t	mzi_alloc_size;	/* size used for more memory */
+	uint64_t	mzi_sum_size;	/* sum of all allocs (life of zone) */
+	uint64_t	mzi_exhaustible;	/* merely return if empty? */
+	uint64_t	mzi_collectable;	/* garbage collect elements? */
+} mach_zone_info_t;
+
+typedef mach_zone_info_t *mach_zone_info_array_t;
+
+typedef struct task_zone_info_data {
+	uint64_t	tzi_count;	/* count of elements in use */
+	uint64_t	tzi_cur_size;	/* current memory utilization */
+	uint64_t	tzi_max_size;	/* how large can this zone grow */
+        uint64_t	tzi_elem_size;	/* size of an element */
+	uint64_t	tzi_alloc_size;	/* size used for more memory */
+	uint64_t	tzi_sum_size;	/* sum of all allocs (life of zone) */
+	uint64_t	tzi_exhaustible;	/* merely return if empty? */
+	uint64_t	tzi_collectable;	/* garbage collect elements? */
+	uint64_t	tzi_caller_acct;	/* charged to caller (or kernel) */
+	uint64_t	tzi_task_alloc;	/* sum of all allocs by this task */
+	uint64_t	tzi_task_free;	/* sum of all frees by this task */
+} task_zone_info_t;
+
+typedef task_zone_info_t *task_zone_info_array_t;
+#endif	/* _MACH_DEBUG_ZONE_INFO_H_ */
diff -Nur cctools-877.5/include/machine/_limits.h cctools-877.5-AnV/include/machine/_limits.h
--- cctools-877.5/include/machine/_limits.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/_limits.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2004-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _BSD_MACHINE__LIMITS_H_
+#define _BSD_MACHINE__LIMITS_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "i386/_limits.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _BSD_MACHINE__LIMITS_H_ */
diff -Nur cctools-877.5/include/machine/_mcontext.h cctools-877.5-AnV/include/machine/_mcontext.h
--- cctools-877.5/include/machine/_mcontext.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/_mcontext.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#if defined (__i386__) || defined (__x86_64__)
+#include "i386/_mcontext.h"
+#else
+#error architecture not supported
+#endif
diff -Nur cctools-877.5/include/machine/_param.h cctools-877.5-AnV/include/machine/_param.h
--- cctools-877.5/include/machine/_param.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/_param.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2004-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#if defined (__i386__) || defined (__x86_64__)
+#include "i386/_param.h"
+#else
+#error architecture not supported
+#endif
diff -Nur cctools-877.5/include/machine/_types.h cctools-877.5-AnV/include/machine/_types.h
--- cctools-877.5/include/machine/_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/_types.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2003-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _BSD_MACHINE__TYPES_H_
+#define _BSD_MACHINE__TYPES_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "i386/_types.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _BSD_MACHINE__TYPES_H_ */
diff -Nur cctools-877.5/include/machine/byte_order.h cctools-877.5-AnV/include/machine/byte_order.h
--- cctools-877.5/include/machine/byte_order.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/byte_order.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1995 NeXT Computer, Inc.
+ */
+
+#ifndef	_BSD_MACHINE_BYTE_ORDER_H_
+#define _BSD_MACHINE_BYTE_ORDER_H_
+ 
+#include <architecture/byte_order.h>
+
+#endif	/* _BSD_MACHINE_BYTE_ORDER_H_ */
diff -Nur cctools-877.5/include/machine/endian.h cctools-877.5-AnV/include/machine/endian.h
--- cctools-877.5/include/machine/endian.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/endian.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright 1995 NeXT Computer, Inc. All rights reserved.
+ */
+#ifndef _BSD_MACHINE_ENDIAN_H_
+#define _BSD_MACHINE_ENDIAN_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "i386/endian.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _BSD_MACHINE_ENDIAN_H_ */
diff -Nur cctools-877.5/include/machine/fasttrap_isa.h cctools-877.5-AnV/include/machine/fasttrap_isa.h
--- cctools-877.5/include/machine/fasttrap_isa.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/fasttrap_isa.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _BSD_MACHINE_FASTTRAP_ISA_H_
+#define _BSD_MACHINE_FASTTRAP_ISA_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "i386/fasttrap_isa.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _BSD_MACHINE_FASTTRAP_ISA_H_ */
diff -Nur cctools-877.5/include/machine/limits.h cctools-877.5-AnV/include/machine/limits.h
--- cctools-877.5/include/machine/limits.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/limits.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,9 @@
+/* This is the `system' limits.h, independent of any particular
+   compiler.  GCC provides its own limits.h which can be found in
+   /usr/lib/gcc, although it is not very informative.  
+   This file is public domain.  */
+#if defined (__i386__) || defined(__x86_64__)
+#include <i386/limits.h>
+#else
+#error architecture not supported
+#endif
diff -Nur cctools-877.5/include/machine/param.h cctools-877.5-AnV/include/machine/param.h
--- cctools-877.5/include/machine/param.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/param.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright 1995 NeXT Computer, Inc. All rights reserved.
+ */
+#ifndef _BSD_MACHINE_PARAM_H_
+#define _BSD_MACHINE_PARAM_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "i386/param.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _BSD_MACHINE_PARAM_H_ */
diff -Nur cctools-877.5/include/machine/profile.h cctools-877.5-AnV/include/machine/profile.h
--- cctools-877.5/include/machine/profile.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/profile.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,42 @@
+/*
+ * Copyright (c) 1997-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * History :
+ *	29-Sep-1997  Umesh Vaishampayan
+ *		Created.
+ */
+#ifndef _BSD_MACHINE_PROFILE_H_
+#define _BSD_MACHINE_PROFILE_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "i386/profile.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _BSD_MACHINE_PROFILE_H_ */
diff -Nur cctools-877.5/include/machine/signal.h cctools-877.5-AnV/include/machine/signal.h
--- cctools-877.5/include/machine/signal.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/signal.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _BSD_MACHINE_SIGNAL_H_
+#define _BSD_MACHINE_SIGNAL_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "i386/signal.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _BSD_MACHINE_SIGNAL_H_ */
diff -Nur cctools-877.5/include/machine/types.h cctools-877.5-AnV/include/machine/types.h
--- cctools-877.5/include/machine/types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/types.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright 1995 NeXT Computer, Inc. All rights reserved.
+ */
+#ifndef _BSD_MACHINE_TYPES_H_
+#define _BSD_MACHINE_TYPES_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "i386/types.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _BSD_MACHINE_TYPES_H_ */
diff -Nur cctools-877.5/include/machine/vmparam.h cctools-877.5-AnV/include/machine/vmparam.h
--- cctools-877.5/include/machine/vmparam.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/machine/vmparam.h	2015-11-16 07:56:15 +0000
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _BSD_MACHINE_VMPARAM_H_
+#define _BSD_MACHINE_VMPARAM_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "i386/vmparam.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _BSD_MACHINE_VMPARAM_H_ */
diff -Nur cctools-877.5/include/standalone/libsa.h cctools-877.5-AnV/include/standalone/libsa.h
--- cctools-877.5/include/standalone/libsa.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/standalone/libsa.h	2015-11-19 09:03:07 +0000
@@ -42,7 +42,7 @@
 extern int bzero(char *b, int length);
 #endif
 #endif
-extern void *memset(void *s, int c, size_t n);
+//extern void *memset(void *s, int c, size_t n);
 
 /*
  * These are defined internally by GCC
@@ -64,14 +64,14 @@
  */
 
 extern int slvprintf(char *buffer, int len, const char *fmt, va_list arg);
-extern int sprintf(char *s, const char *format, ...);
+//extern int sprintf(char *s, const char *format, ...);
 
-extern char *strcat(char *s1, const char *s2);
+//extern char *strcat(char *s1, const char *s2);
 extern int strcmp(const char *s1, const char *s2);
-extern char *strcpy(char *s1, const char *s2);
+//extern char *strcpy(char *s1, const char *s2);
 char *strerror(int errnum);
 extern int strncmp(const char *s1, const char *s2, size_t n);
-extern char *strncpy(char *s1, const char *s2, size_t n);
+//extern char *strncpy(char *s1, const char *s2, size_t n);
 extern long strtol(
     const char *nptr,
     char **endptr,
@@ -90,12 +90,12 @@
 #else
 extern port_t task_self_;
 #endif
-extern kern_return_t vm_allocate(
+/*extern kern_return_t vm_allocate(
     mach_port_t target_task,
     vm_address_t *address,
     vm_size_t size,
     boolean_t anywhere
-);
+);*/
 extern kern_return_t vm_deallocate(
     mach_port_t target_task,
     vm_address_t address,
diff -Nur cctools-877.5/include/stuff/bytesex.h cctools-877.5-AnV/include/stuff/bytesex.h
--- cctools-877.5/include/stuff/bytesex.h	2015-03-10 00:33:19 +0000
+++ cctools-877.5-AnV/include/stuff/bytesex.h	2015-11-19 09:08:04 +0000
@@ -1,454 +1,467 @@
-/*
- * Copyright (c) 2004, Apple Computer, Inc. All rights reserved.
- * 
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- * 1.  Redistributions of source code must retain the above copyright
- *     notice, this list of conditions and the following disclaimer. 
- * 2.  Redistributions in binary form must reproduce the above copyright
- *     notice, this list of conditions and the following disclaimer in the
- *     documentation and/or other materials provided with the distribution. 
- * 3.  Neither the name of Apple Computer, Inc. ("Apple") nor the names of
- *     its contributors may be used to endorse or promote products derived
- *     from this software without specific prior written permission. 
- * 
- * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND
- * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
- * ARE DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR
- * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
- * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
- * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
- * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
- * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
- * POSSIBILITY OF SUCH DAMAGE.
- */
-/* bytesex.h */
-#ifndef _STUFF_BYTESEX_H_
-#define _STUFF_BYTESEX_H_
-
-#if defined(__MWERKS__) && !defined(__private_extern__)
-#define __private_extern__ __declspec(private_extern)
-#endif
-
-#include <mach-o/fat.h>
-#include <mach-o/loader.h>
-#include <mach/m68k/thread_status.h>
-#undef MACHINE_THREAD_STATE	/* need to undef these to avoid warnings */
-#undef MACHINE_THREAD_STATE_COUNT
-#undef THREAD_STATE_NONE
-#undef VALID_THREAD_STATE_FLAVOR
-#include <mach/ppc/thread_status.h>
-#undef MACHINE_THREAD_STATE	/* need to undef these to avoid warnings */
-#undef MACHINE_THREAD_STATE_COUNT
-#undef THREAD_STATE_NONE
-#undef VALID_THREAD_STATE_FLAVOR
-#include <mach/m88k/thread_status.h>
-#include <mach/i860/thread_status.h>
-#include <mach/i386/thread_status.h>
-#include <mach/hppa/thread_status.h>
-#include <mach/sparc/thread_status.h>
-#include <mach/arm/thread_status.h>
-#include <mach-o/nlist.h>
-#include <mach-o/reloc.h>
-#include <mach-o/ranlib.h>
-#include <xar/xar.h>
-#include "stuff/bool.h"
-
-enum byte_sex {
-    UNKNOWN_BYTE_SEX,
-    BIG_ENDIAN_BYTE_SEX,
-    LITTLE_ENDIAN_BYTE_SEX
-};
-
-#define SWAP_SHORT(a) ( ((a & 0xff) << 8) | ((unsigned short)(a) >> 8) )
-
-#define SWAP_INT(a)  ( ((a) << 24) | \
-		      (((a) << 8) & 0x00ff0000) | \
-		      (((a) >> 8) & 0x0000ff00) | \
-	 ((unsigned int)(a) >> 24) )
-
-#ifndef __LP64__
-#define SWAP_LONG(a) ( ((a) << 24) | \
-		      (((a) << 8) & 0x00ff0000) | \
-		      (((a) >> 8) & 0x0000ff00) | \
-	((unsigned long)(a) >> 24) )
-#endif
-
-__private_extern__ long long SWAP_LONG_LONG(
-    long long ll);
-
-__private_extern__ float SWAP_FLOAT(
-    float f);
-
-__private_extern__ double SWAP_DOUBLE(
-    double d);
-
-__private_extern__ enum byte_sex get_host_byte_sex(
-    void);
-
-__private_extern__ void swap_fat_header(
-    struct fat_header *fat_header,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_fat_arch(
-    struct fat_arch *fat_archs,
-    uint32_t nfat_arch,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_mach_header(
-    struct mach_header *mh,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_mach_header_64(
-    struct mach_header_64 *mh,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_load_command(
-    struct load_command *lc,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_segment_command(
-    struct segment_command *sg,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_segment_command_64(
-    struct segment_command_64 *sg,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_section(
-    struct section *s,
-    uint32_t nsects,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_section_64(
-    struct section_64 *s,
-    uint32_t nsects,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_symtab_command(
-    struct symtab_command *st,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_dysymtab_command(
-    struct dysymtab_command *dyst,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_symseg_command(
-    struct symseg_command *ss,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_fvmlib_command(
-    struct fvmlib_command *fl,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_dylib_command(
-    struct dylib_command *dl,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_sub_framework_command(
-    struct sub_framework_command *sub,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_sub_umbrella_command(
-    struct sub_umbrella_command *usub,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_sub_library_command(
-    struct sub_library_command *lsub,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_sub_client_command(
-    struct sub_client_command *csub,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_prebound_dylib_command(
-    struct prebound_dylib_command *pbdylib,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_dylinker_command(
-    struct dylinker_command *dyld,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_fvmfile_command(
-    struct fvmfile_command *ff,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_thread_command(
-    struct thread_command *ut,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_m68k_thread_state_regs(
-    struct m68k_thread_state_regs *cpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_m68k_thread_state_68882(
-    struct m68k_thread_state_68882 *fpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_m68k_thread_state_user_reg(
-    struct m68k_thread_state_user_reg *user_reg,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_ppc_thread_state_t(
-    ppc_thread_state_t *cpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_ppc_thread_state64_t(
-    ppc_thread_state64_t *cpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_ppc_float_state_t(
-    ppc_float_state_t *fpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_ppc_exception_state_t(
-    ppc_exception_state_t *state,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_m88k_thread_state_grf_t(
-    m88k_thread_state_grf_t *cpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_m88k_thread_state_xrf_t(
-    m88k_thread_state_xrf_t *fpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_m88k_thread_state_user_t(
-    m88k_thread_state_user_t *user,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_m88110_thread_state_impl_t(
-    m88110_thread_state_impl_t *spu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_i860_thread_state_regs(
-    struct i860_thread_state_regs *cpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_i386_thread_state(
-    i386_thread_state_t *cpu,
-    enum byte_sex target_byte_sex);
-
-/* current i386 thread states */
-#if i386_THREAD_STATE == 1
-__private_extern__ void swap_i386_float_state(
-    struct __darwin_i386_float_state *fpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_i386_exception_state(
-    i386_exception_state_t *exc,
-    enum byte_sex target_byte_sex);
-#endif /* i386_THREAD_STATE == 1 */
-
-/* i386 thread states on older releases */
-#if i386_THREAD_STATE == -1
-__private_extern__ void swap_i386_thread_fpstate(
-    i386_thread_fpstate_t *fpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_i386_thread_exceptstate(
-    i386_thread_exceptstate_t *exc,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_i386_thread_cthreadstate(
-    i386_thread_cthreadstate_t *user,
-    enum byte_sex target_byte_sex);
-#endif /* i386_THREAD_STATE == -1 */
-
-#ifdef x86_THREAD_STATE64
-__private_extern__ void swap_x86_thread_state64(
-    x86_thread_state64_t *cpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_x86_float_state64(
-    x86_float_state64_t *fpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_x86_state_hdr(
-    struct x86_state_hdr *hdr,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_x86_exception_state64(
-    x86_exception_state64_t *exc,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_x86_debug_state32(
-    x86_debug_state32_t *debug,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_x86_debug_state64(
-    x86_debug_state64_t *debug,
-    enum byte_sex target_byte_sex);
-#endif /* x86_THREAD_STATE64 */
-
-__private_extern__ void swap_hppa_integer_thread_state(
-    struct hp_pa_integer_thread_state *regs,
-    enum byte_sex target_byte_order);
-
-__private_extern__ void swap_hppa_frame_thread_state(
-  struct hp_pa_frame_thread_state *frame,
-  enum byte_sex target_byte_order);
-
-__private_extern__ void swap_hppa_fp_thread_state(
-  struct hp_pa_fp_thread_state *fp,
-  enum byte_sex target_byte_order);
-
-__private_extern__ void swap_sparc_thread_state_regs(
-  struct sparc_thread_state_regs *cpu,
-  enum byte_sex target_byte_order);
-
-__private_extern__ void swap_sparc_thread_state_fpu(
-  struct sparc_thread_state_fpu *fpu,
-  enum byte_sex target_byte_order);
-
-__private_extern__ void swap_arm_thread_state_t(
-    arm_thread_state_t *cpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_arm_thread_state64_t(
-    arm_thread_state64_t *cpu,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_ident_command(
-    struct ident_command *id_cmd,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_routines_command(
-    struct routines_command *r_cmd,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_routines_command_64(
-    struct routines_command_64 *r_cmd,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_twolevel_hints_command(
-    struct twolevel_hints_command *hints_cmd,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_prebind_cksum_command(
-    struct prebind_cksum_command *cksum_cmd,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_uuid_command(
-    struct uuid_command *uuid_cmd,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_linkedit_data_command(
-    struct linkedit_data_command *ld,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_version_min_command(
-    struct version_min_command *ver_cmd,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_rpath_command(
-    struct rpath_command *rpath_cmd,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_encryption_command(
-    struct encryption_info_command *ec,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_encryption_command_64(
-    struct encryption_info_command_64 *ec,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_linker_option_command(
-    struct linker_option_command *lo,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_dyld_info_command(
-    struct dyld_info_command *dc, 
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_entry_point_command(
-    struct entry_point_command *ep,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_source_version_command(
-    struct source_version_command *sv,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_nlist(
-    struct nlist *symbols,
-    uint32_t nsymbols,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_nlist_64(
-    struct nlist_64 *symbols,
-    uint32_t nsymbols,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_ranlib(
-    struct ranlib *ranlibs,
-    uint32_t nranlibs,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_relocation_info(
-    struct relocation_info *relocs,
-    uint32_t nrelocs,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_indirect_symbols(
-    uint32_t *indirect_symbols,
-    uint32_t nindirect_symbols,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_dylib_reference(
-    struct dylib_reference *refs,
-    uint32_t nrefs,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_dylib_module(
-    struct dylib_module *mods,
-    uint32_t nmods,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_dylib_module_64(
-    struct dylib_module_64 *mods,
-    uint32_t nmods,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_dylib_table_of_contents(
-    struct dylib_table_of_contents *tocs,
-    uint32_t ntocs,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_twolevel_hint(
-    struct twolevel_hint *hints,
-    uint32_t nhints,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_data_in_code_entry(
-    struct data_in_code_entry *dices,
-    uint32_t ndices,
-    enum byte_sex target_byte_sex);
-
-__private_extern__ void swap_xar_header(
-    struct xar_header *xar,
-    enum byte_sex target_byte_sex);
-
-/*
- * swap_object_headers() swaps the object file headers from the host byte sex
- * into the non-host byte sex.  It returns TRUE if it can and did swap the
- * headers else returns FALSE and does not touch the headers and prints an error
- * using the error() routine.
- */
-__private_extern__ enum bool swap_object_headers(
-    void *mach_header, /* either a mach_header or a mach_header_64 */
-    struct load_command *load_commands);
-
-/*
- * get_toc_byte_sex() guesses the byte sex of the table of contents of the
- * library mapped in at the address, addr, of size, size based on the first
- * object file's bytesex.  If it can't figure it out, because the library has
- * no object file members or is malformed it will return UNKNOWN_BYTE_SEX.
- */
-__private_extern__ enum byte_sex get_toc_byte_sex(
-    char *addr,
-    uint32_t size);
-
-#endif /* _STUFF_BYTESEX_H_ */
+/*
+ * Copyright (c) 2004, Apple Computer, Inc. All rights reserved.
+ * 
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1.  Redistributions of source code must retain the above copyright
+ *     notice, this list of conditions and the following disclaimer. 
+ * 2.  Redistributions in binary form must reproduce the above copyright
+ *     notice, this list of conditions and the following disclaimer in the
+ *     documentation and/or other materials provided with the distribution. 
+ * 3.  Neither the name of Apple Computer, Inc. ("Apple") nor the names of
+ *     its contributors may be used to endorse or promote products derived
+ *     from this software without specific prior written permission. 
+ * 
+ * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR
+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
+ * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+ * POSSIBILITY OF SUCH DAMAGE.
+ */
+/* bytesex.h */
+#ifndef _STUFF_BYTESEX_H_
+#define _STUFF_BYTESEX_H_
+
+#if defined(__MWERKS__) && !defined(__private_extern__)
+#define __private_extern__ __declspec(private_extern)
+#endif
+
+#if defined(__APPLE__)
+#undef __private_extern__
+#define __private_extern__
+#endif
+
+#include <mach-o/fat.h>
+#include <mach-o/loader.h>
+#include <mach/m68k/thread_status.h>
+#undef MACHINE_THREAD_STATE	/* need to undef these to avoid warnings */
+#undef MACHINE_THREAD_STATE_COUNT
+#undef THREAD_STATE_NONE
+#undef VALID_THREAD_STATE_FLAVOR
+#include <mach/ppc/thread_status.h>
+#undef MACHINE_THREAD_STATE	/* need to undef these to avoid warnings */
+#undef MACHINE_THREAD_STATE_COUNT
+#undef THREAD_STATE_NONE
+#undef VALID_THREAD_STATE_FLAVOR
+#include <mach/m88k/thread_status.h>
+#include <mach/i860/thread_status.h>
+#include <mach/i386/thread_status.h>
+#include <mach/hppa/thread_status.h>
+#include <mach/sparc/thread_status.h>
+#include <mach/arm/thread_status.h>
+#include <mach-o/nlist.h>
+#include <mach-o/reloc.h>
+#include <mach-o/ranlib.h>
+#include <xar/xar.h>
+#include "stuff/bool.h"
+
+#include <mach/i386/_structs.h>
+
+enum byte_sex {
+    UNKNOWN_BYTE_SEX,
+    BIG_ENDIAN_BYTE_SEX,
+    LITTLE_ENDIAN_BYTE_SEX
+};
+
+#define SWAP_SHORT(a) ( ((a & 0xff) << 8) | ((unsigned short)(a) >> 8) )
+
+#define SWAP_INT(a)  ( ((a) << 24) | \
+		      (((a) << 8) & 0x00ff0000) | \
+		      (((a) >> 8) & 0x0000ff00) | \
+	 ((unsigned int)(a) >> 24) )
+
+#ifndef __LP64__
+#define SWAP_LONG(a) ( ((a) << 24) | \
+		      (((a) << 8) & 0x00ff0000) | \
+		      (((a) >> 8) & 0x0000ff00) | \
+	((unsigned long)(a) >> 24) )
+#endif
+
+__private_extern__ long long SWAP_LONG_LONG(
+    long long ll);
+
+__private_extern__ float SWAP_FLOAT(
+    float f);
+
+__private_extern__ double SWAP_DOUBLE(
+    double d);
+
+__private_extern__ enum byte_sex get_host_byte_sex(
+    void);
+
+#ifndef _MACH_O_SWAP_H_
+__private_extern__ void swap_fat_header(
+    struct fat_header *fat_header,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_fat_arch(
+    struct fat_arch *fat_archs,
+    uint32_t nfat_arch,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_mach_header(
+    struct mach_header *mh,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_mach_header_64(
+    struct mach_header_64 *mh,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_load_command(
+    struct load_command *lc,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_segment_command(
+    struct segment_command *sg,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_segment_command_64(
+    struct segment_command_64 *sg,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_section(
+    struct section *s,
+    uint32_t nsects,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_section_64(
+    struct section_64 *s,
+    uint32_t nsects,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_symtab_command(
+    struct symtab_command *st,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_dysymtab_command(
+    struct dysymtab_command *dyst,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_symseg_command(
+    struct symseg_command *ss,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_fvmlib_command(
+    struct fvmlib_command *fl,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_dylib_command(
+    struct dylib_command *dl,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_sub_framework_command(
+    struct sub_framework_command *sub,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_sub_umbrella_command(
+    struct sub_umbrella_command *usub,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_sub_library_command(
+    struct sub_library_command *lsub,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_sub_client_command(
+    struct sub_client_command *csub,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_prebound_dylib_command(
+    struct prebound_dylib_command *pbdylib,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_dylinker_command(
+    struct dylinker_command *dyld,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_fvmfile_command(
+    struct fvmfile_command *ff,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_thread_command(
+    struct thread_command *ut,
+    enum byte_sex target_byte_sex);
+#endif
+
+__private_extern__ void swap_m68k_thread_state_regs(
+    struct m68k_thread_state_regs *cpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_m68k_thread_state_68882(
+    struct m68k_thread_state_68882 *fpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_m68k_thread_state_user_reg(
+    struct m68k_thread_state_user_reg *user_reg,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_ppc_thread_state_t(
+    ppc_thread_state_t *cpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_ppc_thread_state64_t(
+    ppc_thread_state64_t *cpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_ppc_float_state_t(
+    ppc_float_state_t *fpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_ppc_exception_state_t(
+    ppc_exception_state_t *state,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_m88k_thread_state_grf_t(
+    m88k_thread_state_grf_t *cpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_m88k_thread_state_xrf_t(
+    m88k_thread_state_xrf_t *fpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_m88k_thread_state_user_t(
+    m88k_thread_state_user_t *user,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_m88110_thread_state_impl_t(
+    m88110_thread_state_impl_t *spu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_i860_thread_state_regs(
+    struct i860_thread_state_regs *cpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_i386_thread_state(
+    i386_thread_state_t *cpu,
+    enum byte_sex target_byte_sex);
+
+/* current i386 thread states */
+#if i386_THREAD_STATE == 1
+__private_extern__ void swap_i386_float_state(
+    _STRUCT_X86_FLOAT_STATE32 *fpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_i386_exception_state(
+    i386_exception_state_t *exc,
+    enum byte_sex target_byte_sex);
+#endif /* i386_THREAD_STATE == 1 */
+
+/* i386 thread states on older releases */
+#if i386_THREAD_STATE == -1
+__private_extern__ void swap_i386_thread_fpstate(
+    i386_thread_fpstate_t *fpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_i386_thread_exceptstate(
+    i386_thread_exceptstate_t *exc,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_i386_thread_cthreadstate(
+    i386_thread_cthreadstate_t *user,
+    enum byte_sex target_byte_sex);
+#endif /* i386_THREAD_STATE == -1 */
+
+#ifdef x86_THREAD_STATE64
+__private_extern__ void swap_x86_thread_state64(
+    x86_thread_state64_t *cpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_x86_float_state64(
+    x86_float_state64_t *fpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_x86_state_hdr(
+    struct x86_state_hdr *hdr,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_x86_exception_state64(
+    x86_exception_state64_t *exc,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_x86_debug_state32(
+    x86_debug_state32_t *debug,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_x86_debug_state64(
+    x86_debug_state64_t *debug,
+    enum byte_sex target_byte_sex);
+#endif /* x86_THREAD_STATE64 */
+
+__private_extern__ void swap_hppa_integer_thread_state(
+    struct hp_pa_integer_thread_state *regs,
+    enum byte_sex target_byte_order);
+
+__private_extern__ void swap_hppa_frame_thread_state(
+  struct hp_pa_frame_thread_state *frame,
+  enum byte_sex target_byte_order);
+
+__private_extern__ void swap_hppa_fp_thread_state(
+  struct hp_pa_fp_thread_state *fp,
+  enum byte_sex target_byte_order);
+
+__private_extern__ void swap_sparc_thread_state_regs(
+  struct sparc_thread_state_regs *cpu,
+  enum byte_sex target_byte_order);
+
+__private_extern__ void swap_sparc_thread_state_fpu(
+  struct sparc_thread_state_fpu *fpu,
+  enum byte_sex target_byte_order);
+
+__private_extern__ void swap_arm_thread_state_t(
+    arm_thread_state_t *cpu,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_arm_thread_state64_t(
+    arm_thread_state64_t *cpu,
+    enum byte_sex target_byte_sex);
+
+#ifndef _MACH_O_SWAP_H_
+__private_extern__ void swap_ident_command(
+    struct ident_command *id_cmd,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_routines_command(
+    struct routines_command *r_cmd,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_routines_command_64(
+    struct routines_command_64 *r_cmd,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_twolevel_hints_command(
+    struct twolevel_hints_command *hints_cmd,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_prebind_cksum_command(
+    struct prebind_cksum_command *cksum_cmd,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_uuid_command(
+    struct uuid_command *uuid_cmd,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_linkedit_data_command(
+    struct linkedit_data_command *ld,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_version_min_command(
+    struct version_min_command *ver_cmd,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_rpath_command(
+    struct rpath_command *rpath_cmd,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_encryption_command(
+    struct encryption_info_command *ec,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_encryption_command_64(
+    struct encryption_info_command_64 *ec,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_linker_option_command(
+    struct linker_option_command *lo,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_dyld_info_command(
+    struct dyld_info_command *dc, 
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_entry_point_command(
+    struct entry_point_command *ep,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_source_version_command(
+    struct source_version_command *sv,
+    enum byte_sex target_byte_sex);
+
+#ifndef _MACH_O_SWAP_H_
+__private_extern__ void swap_nlist(
+    struct nlist *symbols,
+    uint32_t nsymbols,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_nlist_64(
+    struct nlist_64 *symbols,
+    uint32_t nsymbols,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_ranlib(
+    struct ranlib *ranlibs,
+    uint32_t nranlibs,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_relocation_info(
+    struct relocation_info *relocs,
+    uint32_t nrelocs,
+    enum byte_sex target_byte_sex);
+#endif
+
+__private_extern__ void swap_indirect_symbols(
+    uint32_t *indirect_symbols,
+    uint32_t nindirect_symbols,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_dylib_reference(
+    struct dylib_reference *refs,
+    uint32_t nrefs,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_dylib_module(
+    struct dylib_module *mods,
+    uint32_t nmods,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_dylib_module_64(
+    struct dylib_module_64 *mods,
+    uint32_t nmods,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_dylib_table_of_contents(
+    struct dylib_table_of_contents *tocs,
+    uint32_t ntocs,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_twolevel_hint(
+    struct twolevel_hint *hints,
+    uint32_t nhints,
+    enum byte_sex target_byte_sex);
+#endif
+
+__private_extern__ void swap_data_in_code_entry(
+    struct data_in_code_entry *dices,
+    uint32_t ndices,
+    enum byte_sex target_byte_sex);
+
+__private_extern__ void swap_xar_header(
+    struct xar_header *xar,
+    enum byte_sex target_byte_sex);
+
+/*
+ * swap_object_headers() swaps the object file headers from the host byte sex
+ * into the non-host byte sex.  It returns TRUE if it can and did swap the
+ * headers else returns FALSE and does not touch the headers and prints an error
+ * using the error() routine.
+ */
+__private_extern__ enum bool swap_object_headers(
+    void *mach_header, /* either a mach_header or a mach_header_64 */
+    struct load_command *load_commands);
+
+/*
+ * get_toc_byte_sex() guesses the byte sex of the table of contents of the
+ * library mapped in at the address, addr, of size, size based on the first
+ * object file's bytesex.  If it can't figure it out, because the library has
+ * no object file members or is malformed it will return UNKNOWN_BYTE_SEX.
+ */
+__private_extern__ enum byte_sex get_toc_byte_sex(
+    char *addr,
+    uint32_t size);
+
+#endif /* _STUFF_BYTESEX_H_ */
diff -Nur cctools-877.5/include/stuff/errors.h cctools-877.5-AnV/include/stuff/errors.h
--- cctools-877.5/include/stuff/errors.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/stuff/errors.h	2015-11-19 09:03:07 +0000
@@ -25,6 +25,7 @@
  * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  * POSSIBILITY OF SUCH DAMAGE.
  */
+
 #import "mach/mach.h"
 
 /* user defined (imported) */
diff -Nur cctools-877.5/include/stuff/macosx_deployment_target.h cctools-877.5-AnV/include/stuff/macosx_deployment_target.h
--- cctools-877.5/include/stuff/macosx_deployment_target.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/stuff/macosx_deployment_target.h	2015-11-19 09:03:07 +0000
@@ -20,6 +20,10 @@
  * 
  * @APPLE_LICENSE_HEADER_END@
  */
+
+#ifndef MACOSX_DEPLOYMENT_TARGET_H
+#define MACOSX_DEPLOYMENT_TARGET_H 1
+
 #include <mach/mach.h>
 
 struct macosx_deployment_target {
@@ -33,3 +37,5 @@
 
 __private_extern__ void put_macosx_deployment_target(
     char *target);
+
+#endif
diff -Nur cctools-877.5/include/stuff/ofile.h cctools-877.5-AnV/include/stuff/ofile.h
--- cctools-877.5/include/stuff/ofile.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/stuff/ofile.h	2015-11-19 09:03:07 +0000
@@ -142,7 +142,12 @@
     enum bool dylib_flat,
     enum bool use_member_syntax,
     void (*processor)(struct ofile *ofile, char *arch_name, void *cookie),
-    void *cookie);
+    void *cookie
+#ifdef OTOOL_NG_SUPPORT    
+    , uint64_t start_offset);
+#else
+    );
+#endif
 #ifdef OFI
 __private_extern__ NSObjectFileImageReturnCode ofile_map(
 #else
@@ -152,7 +157,12 @@
     const struct arch_flag *arch_flag,	/* can be NULL */
     const char *object_name,		/* can be NULL */
     struct ofile *ofile,
-    enum bool archives_with_fat_objects);
+    enum bool archives_with_fat_objects
+#ifdef OTOOL_NG_SUPPORT    
+    , uint64_t start_offset);
+#else
+    );
+#endif    
 #ifdef OFI
 __private_extern__ NSObjectFileImageReturnCode ofile_map_from_memory(
 #else
diff -Nur cctools-877.5/include/stuff/rnd.h cctools-877.5-AnV/include/stuff/rnd.h
--- cctools-877.5/include/stuff/rnd.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/stuff/rnd.h	2015-11-19 09:24:28 +0000
@@ -1,39 +1,43 @@
-/*
- * Copyright (c) 2004, Apple Computer, Inc. All rights reserved.
- * 
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- * 1.  Redistributions of source code must retain the above copyright
- *     notice, this list of conditions and the following disclaimer. 
- * 2.  Redistributions in binary form must reproduce the above copyright
- *     notice, this list of conditions and the following disclaimer in the
- *     documentation and/or other materials provided with the distribution. 
- * 3.  Neither the name of Apple Computer, Inc. ("Apple") nor the names of
- *     its contributors may be used to endorse or promote products derived
- *     from this software without specific prior written permission. 
- * 
- * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND
- * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
- * ARE DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR
- * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
- * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
- * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
- * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
- * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
- * POSSIBILITY OF SUCH DAMAGE.
- */
-#include <stdint.h>
-
-#if defined(__MWERKS__) && !defined(__private_extern__)
-#define __private_extern__ __declspec(private_extern)
-#endif
-
-/*
- * rnd() rounds v to a multiple of r.
- */
-__private_extern__ uint64_t rnd(
-    uint64_t v,
-    uint64_t r);
+/*
+ * Copyright (c) 2004, Apple Computer, Inc. All rights reserved.
+ * 
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1.  Redistributions of source code must retain the above copyright
+ *     notice, this list of conditions and the following disclaimer. 
+ * 2.  Redistributions in binary form must reproduce the above copyright
+ *     notice, this list of conditions and the following disclaimer in the
+ *     documentation and/or other materials provided with the distribution. 
+ * 3.  Neither the name of Apple Computer, Inc. ("Apple") nor the names of
+ *     its contributors may be used to endorse or promote products derived
+ *     from this software without specific prior written permission. 
+ * 
+ * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR
+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
+ * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+ * POSSIBILITY OF SUCH DAMAGE.
+ */
+#include <stdint.h>
+
+#ifndef __private_extern__
+#define __private_extern__ extern
+#endif
+
+#if defined(__MWERKS__) && !defined(__private_extern__)
+#define __private_extern__ __declspec(private_extern)
+#endif
+
+/*
+ * rnd() rounds v to a multiple of r.
+ */
+__private_extern__ uint64_t rnd(
+    uint64_t v,
+    uint64_t r);
diff -Nur cctools-877.5/include/sys/_endian.h cctools-877.5-AnV/include/sys/_endian.h
--- cctools-877.5/include/sys/_endian.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_endian.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,151 @@
+/*
+ * Copyright (c) 2004, 2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+/*
+ * Copyright (c) 1995 NeXT Computer, Inc. All rights reserved.
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1987, 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ */
+
+#ifndef _SYS__ENDIAN_H_
+#define	_SYS__ENDIAN_H_
+
+#include <sys/cdefs.h>
+
+/*
+ * Macros for network/external number representation conversion.
+ */
+
+#if defined(lint)
+
+__BEGIN_DECLS
+__uint16_t	ntohs(__uint16_t);
+__uint16_t	htons(__uint16_t);
+__uint32_t	ntohl(__uint32_t);
+__uint32_t	htonl(__uint32_t);
+__END_DECLS
+
+#elif __DARWIN_BYTE_ORDER == __DARWIN_BIG_ENDIAN
+
+#define ntohl(x)        ((__uint32_t)(x))
+#define ntohs(x)        ((__uint16_t)(x))
+#define htonl(x)        ((__uint32_t)(x))
+#define htons(x)        ((__uint16_t)(x))
+
+#if     defined(KERNEL) || (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+
+#define ntohll(x)       ((__uint64_t)(x))
+#define htonll(x)       ((__uint64_t)(x))
+
+#define NTOHL(x)        (x)
+#define NTOHS(x)        (x)
+#define NTOHLL(x)       (x)
+#define HTONL(x)        (x)
+#define HTONS(x)        (x)
+#define HTONLL(x)       (x)
+#endif /* defined(KERNEL) || (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)) */
+
+#else	/* __DARWIN_BYTE_ORDER == __DARWIN_LITTLE_ENDIAN */
+
+#include <libkern/_OSByteOrder.h>
+
+#define ntohs(x)	__DARWIN_OSSwapInt16(x)
+#define htons(x)	__DARWIN_OSSwapInt16(x)
+
+#define ntohl(x)	__DARWIN_OSSwapInt32(x)
+#define htonl(x)	__DARWIN_OSSwapInt32(x)
+
+#if	defined(KERNEL) || (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+
+#define ntohll(x)       __DARWIN_OSSwapInt64(x)
+#define htonll(x)       __DARWIN_OSSwapInt64(x)
+
+#define	NTOHL(x)	(x) = ntohl((__uint32_t)x)
+#define	NTOHS(x)	(x) = ntohs((__uint16_t)x)
+#define	NTOHLL(x)	(x) = ntohll((__uint64_t)x)
+#define	HTONL(x)	(x) = htonl((__uint32_t)x)
+#define	HTONS(x)	(x) = htons((__uint16_t)x)
+#define	HTONLL(x)	(x) = htonll((__uint64_t)x)
+#endif /* defined(KERNEL) || (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)) */
+#endif /* __DARWIN_BYTE_ORDER */
+#endif /* !_SYS__ENDIAN_H_ */
diff -Nur cctools-877.5/include/sys/_posix_availability.h cctools-877.5-AnV/include/sys/_posix_availability.h
--- cctools-877.5/include/sys/_posix_availability.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_posix_availability.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,73 @@
+/* Copyright (c) 2010 Apple Inc. All rights reserved.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _CDEFS_H_
+# error "Never use <sys/_posix_availability.h> directly.  Use <sys/cdefs.h> instead."
+#endif
+
+#if !defined(_DARWIN_C_SOURCE) && defined(_POSIX_C_SOURCE) && _POSIX_C_SOURCE >= 198808L
+#define ___POSIX_C_DEPRECATED_STARTING_198808L __deprecated
+#else
+#define ___POSIX_C_DEPRECATED_STARTING_198808L
+#endif
+
+#if !defined(_DARWIN_C_SOURCE) && defined(_POSIX_C_SOURCE) && _POSIX_C_SOURCE >= 199009L
+#define ___POSIX_C_DEPRECATED_STARTING_199009L __deprecated
+#else
+#define ___POSIX_C_DEPRECATED_STARTING_199009L
+#endif
+
+#if !defined(_DARWIN_C_SOURCE) && defined(_POSIX_C_SOURCE) && _POSIX_C_SOURCE >= 199209L
+#define ___POSIX_C_DEPRECATED_STARTING_199209L __deprecated
+#else
+#define ___POSIX_C_DEPRECATED_STARTING_199209L
+#endif
+
+#if !defined(_DARWIN_C_SOURCE) && defined(_POSIX_C_SOURCE) && _POSIX_C_SOURCE >= 199309L
+#define ___POSIX_C_DEPRECATED_STARTING_199309L __deprecated
+#else
+#define ___POSIX_C_DEPRECATED_STARTING_199309L
+#endif
+
+#if !defined(_DARWIN_C_SOURCE) && defined(_POSIX_C_SOURCE) && _POSIX_C_SOURCE >= 199506L
+#define ___POSIX_C_DEPRECATED_STARTING_199506L __deprecated
+#else
+#define ___POSIX_C_DEPRECATED_STARTING_199506L
+#endif
+
+#if !defined(_DARWIN_C_SOURCE) && defined(_POSIX_C_SOURCE) && _POSIX_C_SOURCE >= 200112L
+#define ___POSIX_C_DEPRECATED_STARTING_200112L __deprecated
+#else
+#define ___POSIX_C_DEPRECATED_STARTING_200112L
+#endif
+
+#if !defined(_DARWIN_C_SOURCE) && defined(_POSIX_C_SOURCE) && _POSIX_C_SOURCE >= 200809L
+#define ___POSIX_C_DEPRECATED_STARTING_200809L __deprecated
+#else
+#define ___POSIX_C_DEPRECATED_STARTING_200809L
+#endif
+
diff -Nur cctools-877.5/include/sys/_pthread/_pthread_attr_t.h cctools-877.5-AnV/include/sys/_pthread/_pthread_attr_t.h
--- cctools-877.5/include/sys/_pthread/_pthread_attr_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_pthread/_pthread_attr_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _PTHREAD_ATTR_T 
+#define _PTHREAD_ATTR_T 
+typedef __darwin_pthread_attr_t pthread_attr_t;
+#endif  /* _PTHREAD_ATTR_T */
diff -Nur cctools-877.5/include/sys/_pthread/_pthread_cond_t.h cctools-877.5-AnV/include/sys/_pthread/_pthread_cond_t.h
--- cctools-877.5/include/sys/_pthread/_pthread_cond_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_pthread/_pthread_cond_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _PTHREAD_COND_T
+#define _PTHREAD_COND_T
+typedef __darwin_pthread_cond_t pthread_cond_t;
+#endif /* _PTHREAD_COND_T */
diff -Nur cctools-877.5/include/sys/_pthread/_pthread_condattr_t.h cctools-877.5-AnV/include/sys/_pthread/_pthread_condattr_t.h
--- cctools-877.5/include/sys/_pthread/_pthread_condattr_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_pthread/_pthread_condattr_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _PTHREAD_CONDATTR_T
+#define _PTHREAD_CONDATTR_T
+typedef __darwin_pthread_condattr_t pthread_condattr_t;
+#endif /* _PTHREAD_CONDATTR_T */
diff -Nur cctools-877.5/include/sys/_pthread/_pthread_key_t.h cctools-877.5-AnV/include/sys/_pthread/_pthread_key_t.h
--- cctools-877.5/include/sys/_pthread/_pthread_key_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_pthread/_pthread_key_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _PTHREAD_KEY_T
+#define _PTHREAD_KEY_T
+typedef __darwin_pthread_key_t pthread_key_t;
+#endif /* _PTHREAD_KEY_T */
diff -Nur cctools-877.5/include/sys/_pthread/_pthread_mutex_t.h cctools-877.5-AnV/include/sys/_pthread/_pthread_mutex_t.h
--- cctools-877.5/include/sys/_pthread/_pthread_mutex_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_pthread/_pthread_mutex_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _PTHREAD_MUTEX_T
+#define _PTHREAD_MUTEX_T
+typedef __darwin_pthread_mutex_t pthread_mutex_t;
+#endif /*_PTHREAD_MUTEX_T */
diff -Nur cctools-877.5/include/sys/_pthread/_pthread_mutexattr_t.h cctools-877.5-AnV/include/sys/_pthread/_pthread_mutexattr_t.h
--- cctools-877.5/include/sys/_pthread/_pthread_mutexattr_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_pthread/_pthread_mutexattr_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _PTHREAD_MUTEXATTR_T
+#define _PTHREAD_MUTEXATTR_T
+typedef __darwin_pthread_mutexattr_t pthread_mutexattr_t;
+#endif /* _PTHREAD_MUTEXATTR_T */
diff -Nur cctools-877.5/include/sys/_pthread/_pthread_once_t.h cctools-877.5-AnV/include/sys/_pthread/_pthread_once_t.h
--- cctools-877.5/include/sys/_pthread/_pthread_once_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_pthread/_pthread_once_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _PTHREAD_ONCE_T
+#define _PTHREAD_ONCE_T
+typedef __darwin_pthread_once_t pthread_once_t;
+#endif /* _PTHREAD_ONCE_T */
diff -Nur cctools-877.5/include/sys/_pthread/_pthread_rwlock_t.h cctools-877.5-AnV/include/sys/_pthread/_pthread_rwlock_t.h
--- cctools-877.5/include/sys/_pthread/_pthread_rwlock_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_pthread/_pthread_rwlock_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _PTHREAD_RWLOCK_T
+#define _PTHREAD_RWLOCK_T
+typedef __darwin_pthread_rwlock_t pthread_rwlock_t;
+#endif /* _PTHREAD_RWLOCK_T */
diff -Nur cctools-877.5/include/sys/_pthread/_pthread_rwlockattr_t.h cctools-877.5-AnV/include/sys/_pthread/_pthread_rwlockattr_t.h
--- cctools-877.5/include/sys/_pthread/_pthread_rwlockattr_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_pthread/_pthread_rwlockattr_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _PTHREAD_RWLOCKATTR_T
+#define _PTHREAD_RWLOCKATTR_T
+typedef __darwin_pthread_rwlockattr_t pthread_rwlockattr_t;
+#endif /* _PTHREAD_RWLOCKATTR_T */
diff -Nur cctools-877.5/include/sys/_pthread/_pthread_t.h cctools-877.5-AnV/include/sys/_pthread/_pthread_t.h
--- cctools-877.5/include/sys/_pthread/_pthread_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_pthread/_pthread_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _PTHREAD_T
+#define _PTHREAD_T
+typedef __darwin_pthread_t pthread_t;
+#endif /* _PTHREAD_T */
diff -Nur cctools-877.5/include/sys/_pthread/_pthread_types.h cctools-877.5-AnV/include/sys/_pthread/_pthread_types.h
--- cctools-877.5/include/sys/_pthread/_pthread_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_pthread/_pthread_types.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,120 @@
+/*
+ * Copyright (c) 2003-2013 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _SYS__PTHREAD_TYPES_H_
+#define _SYS__PTHREAD_TYPES_H_
+
+#include <sys/cdefs.h>
+
+// pthread opaque structures
+#if defined(__LP64__)
+#define __PTHREAD_SIZE__		8176
+#define __PTHREAD_ATTR_SIZE__		56
+#define __PTHREAD_MUTEXATTR_SIZE__	8
+#define __PTHREAD_MUTEX_SIZE__		56
+#define __PTHREAD_CONDATTR_SIZE__	8
+#define __PTHREAD_COND_SIZE__		40
+#define __PTHREAD_ONCE_SIZE__		8
+#define __PTHREAD_RWLOCK_SIZE__		192
+#define __PTHREAD_RWLOCKATTR_SIZE__	16
+#else // !__LP64__
+#define __PTHREAD_SIZE__		4088
+#define __PTHREAD_ATTR_SIZE__		36
+#define __PTHREAD_MUTEXATTR_SIZE__	8
+#define __PTHREAD_MUTEX_SIZE__		40
+#define __PTHREAD_CONDATTR_SIZE__	4
+#define __PTHREAD_COND_SIZE__		24
+#define __PTHREAD_ONCE_SIZE__		4
+#define __PTHREAD_RWLOCK_SIZE__		124
+#define __PTHREAD_RWLOCKATTR_SIZE__	12
+#endif // !__LP64__
+
+struct __darwin_pthread_handler_rec {
+	void (*__routine)(void *);	// Routine to call
+	void *__arg;			// Argument to pass
+	struct __darwin_pthread_handler_rec *__next;
+};
+
+struct _opaque_pthread_attr_t {
+	long __sig;
+	char __opaque[__PTHREAD_ATTR_SIZE__];
+};
+
+struct _opaque_pthread_cond_t {
+	long __sig;
+	char __opaque[__PTHREAD_COND_SIZE__];
+};
+
+struct _opaque_pthread_condattr_t {
+	long __sig;
+	char __opaque[__PTHREAD_CONDATTR_SIZE__];
+};
+
+struct _opaque_pthread_mutex_t {
+	long __sig;
+	char __opaque[__PTHREAD_MUTEX_SIZE__];
+};
+
+struct _opaque_pthread_mutexattr_t {
+	long __sig;
+	char __opaque[__PTHREAD_MUTEXATTR_SIZE__];
+};
+
+struct _opaque_pthread_once_t {
+	long __sig;
+	char __opaque[__PTHREAD_ONCE_SIZE__];
+};
+
+struct _opaque_pthread_rwlock_t {
+	long __sig;
+	char __opaque[__PTHREAD_RWLOCK_SIZE__];
+};
+
+struct _opaque_pthread_rwlockattr_t {
+	long __sig;
+	char __opaque[__PTHREAD_RWLOCKATTR_SIZE__];
+};
+
+struct _opaque_pthread_t {
+	long __sig;
+	struct __darwin_pthread_handler_rec  *__cleanup_stack;
+	char __opaque[__PTHREAD_SIZE__];
+};
+
+typedef struct _opaque_pthread_attr_t __darwin_pthread_attr_t;
+typedef struct _opaque_pthread_cond_t __darwin_pthread_cond_t;
+typedef struct _opaque_pthread_condattr_t __darwin_pthread_condattr_t;
+typedef unsigned long __darwin_pthread_key_t;
+typedef struct _opaque_pthread_mutex_t __darwin_pthread_mutex_t;
+typedef struct _opaque_pthread_mutexattr_t __darwin_pthread_mutexattr_t;
+typedef struct _opaque_pthread_once_t __darwin_pthread_once_t;
+typedef struct _opaque_pthread_rwlock_t __darwin_pthread_rwlock_t;
+typedef struct _opaque_pthread_rwlockattr_t __darwin_pthread_rwlockattr_t;
+typedef struct _opaque_pthread_t *__darwin_pthread_t;
+
+#endif // _SYS__PTHREAD_TYPES_H_
diff -Nur cctools-877.5/include/sys/_select.h cctools-877.5-AnV/include/sys/_select.h
--- cctools-877.5/include/sys/_select.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_select.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,52 @@
+/*
+ * Copyright (c) 2005, 2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+/*
+ * This is called from sys/select.h and sys/time.h for the common prototype
+ * of select().  Setting _DARWIN_C_SOURCE or _DARWIN_UNLIMITED_SELECT uses
+ * the version of select() that does not place a limit on the first argument
+ * (nfds).  In the UNIX conformance case, values of nfds greater than
+ * FD_SETSIZE will return an error of EINVAL.
+ */
+#ifndef _SYS__SELECT_H_
+#define	_SYS__SELECT_H_
+
+int	 select(int, fd_set * __restrict, fd_set * __restrict,
+		fd_set * __restrict, struct timeval * __restrict)
+#if defined(_DARWIN_C_SOURCE) || defined(_DARWIN_UNLIMITED_SELECT)
+		__DARWIN_EXTSN_C(select)
+#else /* !_DARWIN_C_SOURCE && !_DARWIN_UNLIMITED_SELECT */
+#  if defined(__LP64__) && !__DARWIN_NON_CANCELABLE
+		__DARWIN_1050(select)
+#  else /* !__LP64__ || __DARWIN_NON_CANCELABLE */
+		__DARWIN_ALIAS_C(select)
+#  endif /* __LP64__ && !__DARWIN_NON_CANCELABLE */
+#endif /* _DARWIN_C_SOURCE || _DARWIN_UNLIMITED_SELECT */
+		;
+
+#endif /* !_SYS__SELECT_H_ */
diff -Nur cctools-877.5/include/sys/_structs.h cctools-877.5-AnV/include/sys/_structs.h
--- cctools-877.5/include/sys/_structs.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_structs.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,30 @@
+/*
+ * Copyright (c) 2004-2013 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#include <sys/cdefs.h>
+#include <sys/_types.h>
diff -Nur cctools-877.5/include/sys/_symbol_aliasing.h cctools-877.5-AnV/include/sys/_symbol_aliasing.h
--- cctools-877.5/include/sys/_symbol_aliasing.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_symbol_aliasing.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,199 @@
+/* Copyright (c) 2010 Apple Inc. All rights reserved.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _CDEFS_H_
+# error "Never use <sys/_symbol_aliasing.h> directly.  Use <sys/cdefs.h> instead."
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 20000
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_2_0(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_2_0(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 20100
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_2_1(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_2_1(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 20200
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_2_2(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_2_2(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 30000
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_3_0(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_3_0(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 30100
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_3_1(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_3_1(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 30200
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_3_2(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_3_2(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 40000
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_4_0(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_4_0(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 40100
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_4_1(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_4_1(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 40200
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_4_2(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_4_2(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 40300
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_4_3(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_4_3(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 50000
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_5_0(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_5_0(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 50100
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_5_1(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_5_1(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 60000
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_6_0(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_6_0(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 60100
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_6_1(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_6_1(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 70000
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_7_0(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_7_0(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 70100
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_7_1(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_7_1(x)
+#endif
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ >= 80000
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_8_0(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_IPHONE___IPHONE_8_0(x)
+#endif
+
+#if defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1000
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_0(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_0(x)
+#endif
+
+#if defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1010
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_1(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_1(x)
+#endif
+
+#if defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1020
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_2(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_2(x)
+#endif
+
+#if defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1030
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_3(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_3(x)
+#endif
+
+#if defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1040
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_4(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_4(x)
+#endif
+
+#if defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1050
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_5(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_5(x)
+#endif
+
+#if defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1060
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_6(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_6(x)
+#endif
+
+#if defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1070
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_7(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_7(x)
+#endif
+
+#if defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1080
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_8(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_8(x)
+#endif
+
+#if defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1090
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_9(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_9(x)
+#endif
+
+#if defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 10100
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_10(x) x
+#else
+#define __DARWIN_ALIAS_STARTING_MAC___MAC_10_10(x)
+#endif
+
diff -Nur cctools-877.5/include/sys/_types/_blkcnt_t.h cctools-877.5-AnV/include/sys/_types/_blkcnt_t.h
--- cctools-877.5/include/sys/_types/_blkcnt_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_blkcnt_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _BLKCNT_T 
+#define _BLKCNT_T 
+typedef __darwin_blkcnt_t        blkcnt_t; 
+#endif  /* _BLKCNT_T */
diff -Nur cctools-877.5/include/sys/_types/_blksize_t.h cctools-877.5-AnV/include/sys/_types/_blksize_t.h
--- cctools-877.5/include/sys/_types/_blksize_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_blksize_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _BLKSIZE_T 
+#define _BLKSIZE_T 
+typedef __darwin_blksize_t        blksize_t; 
+#endif  /* _BLKSIZE_T */
diff -Nur cctools-877.5/include/sys/_types/_clock_t.h cctools-877.5-AnV/include/sys/_types/_clock_t.h
--- cctools-877.5/include/sys/_types/_clock_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_clock_t.h	2015-11-19 09:45:11 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#define _CLOCK_T 1
+#ifndef _CLOCK_T
+#define _CLOCK_T
+typedef __darwin_clock_t        clock_t;
+#endif /* _CLOCK_T */
diff -Nur cctools-877.5/include/sys/_types/_ct_rune_t.h cctools-877.5-AnV/include/sys/_types/_ct_rune_t.h
--- cctools-877.5/include/sys/_types/_ct_rune_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_ct_rune_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _CT_RUNE_T
+#define _CT_RUNE_T
+typedef __darwin_ct_rune_t ct_rune_t;
+#endif /* _CT_RUNE_T */
diff -Nur cctools-877.5/include/sys/_types/_dev_t.h cctools-877.5-AnV/include/sys/_types/_dev_t.h
--- cctools-877.5/include/sys/_types/_dev_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_dev_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _DEV_T 
+#define _DEV_T 
+typedef __darwin_dev_t        dev_t;	/* device number */ 
+#endif  /* _DEV_T */
diff -Nur cctools-877.5/include/sys/_types/_errno_t.h cctools-877.5-AnV/include/sys/_types/_errno_t.h
--- cctools-877.5/include/sys/_types/_errno_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_errno_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _ERRNO_T
+#define _ERRNO_T
+typedef int                    errno_t;
+#endif  /* _ERRNO_T */
diff -Nur cctools-877.5/include/sys/_types/_fd_clr.h cctools-877.5-AnV/include/sys/_types/_fd_clr.h
--- cctools-877.5/include/sys/_types/_fd_clr.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_fd_clr.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,30 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef FD_CLR
+#define	FD_CLR(n, p)	__DARWIN_FD_CLR(n, p)
+#endif /* FD_CLR */
diff -Nur cctools-877.5/include/sys/_types/_fd_copy.h cctools-877.5-AnV/include/sys/_types/_fd_copy.h
--- cctools-877.5/include/sys/_types/_fd_copy.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_fd_copy.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,30 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef FD_COPY
+#define	FD_COPY(f, t)	__DARWIN_FD_COPY(f, t)
+#endif /* FD_COPY */
diff -Nur cctools-877.5/include/sys/_types/_fd_def.h cctools-877.5-AnV/include/sys/_types/_fd_def.h
--- cctools-877.5/include/sys/_types/_fd_def.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_fd_def.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,73 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _FD_SET
+#define _FD_SET
+/*
+ * Select uses bit masks of file descriptors in longs.  These macros
+ * manipulate such bit fields (the filesystem macros use chars).  The
+ * extra protection here is to permit application redefinition above
+ * the default size.
+ */
+#ifdef FD_SETSIZE
+#define	__DARWIN_FD_SETSIZE	FD_SETSIZE
+#else /* !FD_SETSIZE */
+#define	__DARWIN_FD_SETSIZE	1024
+#endif /* FD_SETSIZE */
+#define	__DARWIN_NBBY		8				/* bits in a byte */
+#define __DARWIN_NFDBITS	(sizeof(__int32_t) * __DARWIN_NBBY) /* bits per mask */
+#define	__DARWIN_howmany(x, y)	((((x) % (y)) == 0) ? ((x) / (y)) : (((x) / (y)) + 1)) /* # y's == x bits? */
+
+__BEGIN_DECLS
+typedef	struct fd_set {
+	__int32_t	fds_bits[__DARWIN_howmany(__DARWIN_FD_SETSIZE, __DARWIN_NFDBITS)];
+} fd_set;
+__END_DECLS
+
+/* This inline avoids argument side-effect issues with FD_ISSET() */
+static __inline int
+__darwin_fd_isset(int _n, const struct fd_set *_p)
+{
+	return (_p->fds_bits[(unsigned long)_n/__DARWIN_NFDBITS] & ((__int32_t)(1<<((unsigned long)_n % __DARWIN_NFDBITS))));
+}
+
+#define	__DARWIN_FD_SET(n, p)	do { int __fd = (n); ((p)->fds_bits[(unsigned long)__fd/__DARWIN_NFDBITS] |= ((__int32_t)(1<<((unsigned long)__fd % __DARWIN_NFDBITS)))); } while(0)
+#define	__DARWIN_FD_CLR(n, p)	do { int __fd = (n); ((p)->fds_bits[(unsigned long)__fd/__DARWIN_NFDBITS] &= ~((__int32_t)(1<<((unsigned long)__fd % __DARWIN_NFDBITS)))); } while(0)
+#define	__DARWIN_FD_ISSET(n, p)	__darwin_fd_isset((n), (p))
+
+#if __GNUC__ > 3 || __GNUC__ == 3 && __GNUC_MINOR__ >= 3
+/*
+ * Use the built-in bzero function instead of the library version so that
+ * we do not pollute the namespace or introduce prototype warnings.
+ */
+#define	__DARWIN_FD_ZERO(p)	__builtin_bzero(p, sizeof(*(p)))
+#else
+#define	__DARWIN_FD_ZERO(p)	bzero(p, sizeof(*(p)))
+#endif
+
+#define	__DARWIN_FD_COPY(f, t)	bcopy(f, t, sizeof(*(f)))
+#endif /* _FD_SET */
diff -Nur cctools-877.5/include/sys/_types/_fd_isset.h cctools-877.5-AnV/include/sys/_types/_fd_isset.h
--- cctools-877.5/include/sys/_types/_fd_isset.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_fd_isset.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,30 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef FD_ISSET
+#define	FD_ISSET(n, p)	__DARWIN_FD_ISSET(n, p)
+#endif /* FD_ISSET */
diff -Nur cctools-877.5/include/sys/_types/_fd_set.h cctools-877.5-AnV/include/sys/_types/_fd_set.h
--- cctools-877.5/include/sys/_types/_fd_set.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_fd_set.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,30 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef FD_SET
+#define	FD_SET(n, p)	__DARWIN_FD_SET(n, p)
+#endif /* FD_SET */
diff -Nur cctools-877.5/include/sys/_types/_fd_setsize.h cctools-877.5-AnV/include/sys/_types/_fd_setsize.h
--- cctools-877.5/include/sys/_types/_fd_setsize.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_fd_setsize.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,30 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef	FD_SETSIZE
+#define	FD_SETSIZE	__DARWIN_FD_SETSIZE
+#endif /* FD_SETSIZE */
diff -Nur cctools-877.5/include/sys/_types/_fd_zero.h cctools-877.5-AnV/include/sys/_types/_fd_zero.h
--- cctools-877.5/include/sys/_types/_fd_zero.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_fd_zero.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,30 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef FD_ZERO
+#define	FD_ZERO(p)	__DARWIN_FD_ZERO(p)
+#endif /* FD_ZERO */
diff -Nur cctools-877.5/include/sys/_types/_filesec_t.h cctools-877.5-AnV/include/sys/_types/_filesec_t.h
--- cctools-877.5/include/sys/_types/_filesec_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_filesec_t.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _FILESEC_T
+#define _FILESEC_T
+struct _filesec;
+typedef struct _filesec	*filesec_t;
+#endif /* _FILESEC_T */
diff -Nur cctools-877.5/include/sys/_types/_fsblkcnt_t.h cctools-877.5-AnV/include/sys/_types/_fsblkcnt_t.h
--- cctools-877.5/include/sys/_types/_fsblkcnt_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_fsblkcnt_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _FSBLKCNT_T
+#define _FSBLKCNT_T
+typedef __darwin_fsblkcnt_t		fsblkcnt_t;
+#endif /* _FSBLKCNT_T */
diff -Nur cctools-877.5/include/sys/_types/_fsfilcnt_t.h cctools-877.5-AnV/include/sys/_types/_fsfilcnt_t.h
--- cctools-877.5/include/sys/_types/_fsfilcnt_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_fsfilcnt_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _FSFILCNT_T
+#define _FSFILCNT_T
+typedef __darwin_fsfilcnt_t		fsfilcnt_t;
+#endif /* _FSFILCNT_T */
diff -Nur cctools-877.5/include/sys/_types/_fsid_t.h cctools-877.5-AnV/include/sys/_types/_fsid_t.h
--- cctools-877.5/include/sys/_types/_fsid_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_fsid_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ *
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ *
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ *
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _FSID_T
+#define _FSID_T
+typedef struct fsid { int32_t val[2]; } fsid_t;	/* file system id type */
+#endif /* _FSID_T */
diff -Nur cctools-877.5/include/sys/_types/_gid_t.h cctools-877.5-AnV/include/sys/_types/_gid_t.h
--- cctools-877.5/include/sys/_types/_gid_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_gid_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _GID_T 
+#define _GID_T 
+typedef __darwin_gid_t	gid_t; 
+#endif 
diff -Nur cctools-877.5/include/sys/_types/_guid_t.h cctools-877.5-AnV/include/sys/_types/_guid_t.h
--- cctools-877.5/include/sys/_types/_guid_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_guid_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,36 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _KAUTH_GUID
+#define _KAUTH_GUID
+/* Apple-style globally unique identifier */
+typedef struct {
+#define KAUTH_GUID_SIZE	16	/* 128-bit identifier */
+	unsigned char g_guid[KAUTH_GUID_SIZE];
+} guid_t;
+#define _GUID_T
+#endif /* _KAUTH_GUID */
diff -Nur cctools-877.5/include/sys/_types/_id_t.h cctools-877.5-AnV/include/sys/_types/_id_t.h
--- cctools-877.5/include/sys/_types/_id_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_id_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _ID_T 
+#define _ID_T 
+typedef __darwin_id_t	id_t;		/* can hold pid_t, gid_t, or uid_t */
+#endif /* _ID_T */
diff -Nur cctools-877.5/include/sys/_types/_in_addr_t.h cctools-877.5-AnV/include/sys/_types/_in_addr_t.h
--- cctools-877.5/include/sys/_types/_in_addr_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_in_addr_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _IN_ADDR_T
+#define _IN_ADDR_T
+typedef	__uint32_t	in_addr_t;	/* base type for internet address */
+#endif /* _IN_ADDR_T */
diff -Nur cctools-877.5/include/sys/_types/_in_port_t.h cctools-877.5-AnV/include/sys/_types/_in_port_t.h
--- cctools-877.5/include/sys/_types/_in_port_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_in_port_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _IN_PORT_T
+#define _IN_PORT_T
+typedef	__uint16_t		in_port_t;
+#endif /* _IN_PORT_T */
diff -Nur cctools-877.5/include/sys/_types/_ino64_t.h cctools-877.5-AnV/include/sys/_types/_ino64_t.h
--- cctools-877.5/include/sys/_types/_ino64_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_ino64_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _INO64_T 
+#define _INO64_T 
+typedef __darwin_ino64_t        ino64_t; 	/* 64bit inode number */
+#endif  /* _INO64_T */
diff -Nur cctools-877.5/include/sys/_types/_ino_t.h cctools-877.5-AnV/include/sys/_types/_ino_t.h
--- cctools-877.5/include/sys/_types/_ino_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_ino_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _INO_T 
+#define _INO_T 
+typedef	__darwin_ino_t		ino_t;		/* inode number */
+#endif  /* _INO_T */
diff -Nur cctools-877.5/include/sys/_types/_int16_t.h cctools-877.5-AnV/include/sys/_types/_int16_t.h
--- cctools-877.5/include/sys/_types/_int16_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_int16_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _INT16_T
+#define _INT16_T
+typedef	short			int16_t;
+#endif /* _INT16_T */
diff -Nur cctools-877.5/include/sys/_types/_int32_t.h cctools-877.5-AnV/include/sys/_types/_int32_t.h
--- cctools-877.5/include/sys/_types/_int32_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_int32_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _INT32_T
+#define _INT32_T
+typedef	int			int32_t;
+#endif /* _INT32_T */
diff -Nur cctools-877.5/include/sys/_types/_int64_t.h cctools-877.5-AnV/include/sys/_types/_int64_t.h
--- cctools-877.5/include/sys/_types/_int64_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_int64_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _INT64_T
+#define _INT64_T
+typedef	long long		int64_t;
+#endif /* _INT64_T */
diff -Nur cctools-877.5/include/sys/_types/_int8_t.h cctools-877.5-AnV/include/sys/_types/_int8_t.h
--- cctools-877.5/include/sys/_types/_int8_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_int8_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _INT8_T
+#define _INT8_T
+typedef	__signed char		int8_t;
+#endif /* _INT8_T */
diff -Nur cctools-877.5/include/sys/_types/_intptr_t.h cctools-877.5-AnV/include/sys/_types/_intptr_t.h
--- cctools-877.5/include/sys/_types/_intptr_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_intptr_t.h	2015-11-19 09:16:58 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#define _INTPTR_T 1
+#ifndef _INTPTR_T
+#define _INTPTR_T
+typedef __darwin_intptr_t	intptr_t;
+#endif /* _INTPTR_T */
diff -Nur cctools-877.5/include/sys/_types/_iovec_t.h cctools-877.5-AnV/include/sys/_types/_iovec_t.h
--- cctools-877.5/include/sys/_types/_iovec_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_iovec_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,34 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _STRUCT_IOVEC
+#define	_STRUCT_IOVEC
+struct iovec {
+	void *   iov_base;	/* [XSI] Base address of I/O memory region */
+	size_t	 iov_len;	/* [XSI] Size of region iov_base points to */
+};
+#endif /* _STRUCT_IOVEC */
diff -Nur cctools-877.5/include/sys/_types/_key_t.h cctools-877.5-AnV/include/sys/_types/_key_t.h
--- cctools-877.5/include/sys/_types/_key_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_key_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _KEY_T 
+#define _KEY_T 
+typedef __int32_t        key_t; 	/* IPC key (for Sys V IPC) */
+#endif  /* _KEY_T */
diff -Nur cctools-877.5/include/sys/_types/_mach_port_t.h cctools-877.5-AnV/include/sys/_types/_mach_port_t.h
--- cctools-877.5/include/sys/_types/_mach_port_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_mach_port_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,50 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+/* 
+ *	mach_port_t - a named port right
+ *
+ *	In user-space, "rights" are represented by the name of the
+ *	right in the Mach port namespace.  Even so, this type is
+ *	presented as a unique one to more clearly denote the presence
+ *	of a right coming along with the name. 
+ *
+ *	Often, various rights for a port held in a single name space
+ *	will coalesce and are, therefore, be identified by a single name
+ *	[this is the case for send and receive rights].  But not
+ *	always [send-once rights currently get a unique name for
+ *	each right].      
+ *
+ *	This definition of mach_port_t is only for user-space.
+ *
+ */
+
+#ifndef _MACH_PORT_T
+#define _MACH_PORT_T
+typedef __darwin_mach_port_t mach_port_t;
+#endif /* _MACH_PORT_T */
diff -Nur cctools-877.5/include/sys/_types/_mbstate_t.h cctools-877.5-AnV/include/sys/_types/_mbstate_t.h
--- cctools-877.5/include/sys/_types/_mbstate_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_mbstate_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MBSTATE_T
+#define _MBSTATE_T
+typedef __darwin_mbstate_t mbstate_t;
+#endif /* _MBSTATE_T */
diff -Nur cctools-877.5/include/sys/_types/_mode_t.h cctools-877.5-AnV/include/sys/_types/_mode_t.h
--- cctools-877.5/include/sys/_types/_mode_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_mode_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _MODE_T 
+#define _MODE_T 
+typedef	__darwin_mode_t		mode_t;
+#endif  /* _MODE_T */
diff -Nur cctools-877.5/include/sys/_types/_nlink_t.h cctools-877.5-AnV/include/sys/_types/_nlink_t.h
--- cctools-877.5/include/sys/_types/_nlink_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_nlink_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _NLINK_T 
+#define _NLINK_T 
+typedef __uint16_t        nlink_t;  	/* link count */
+#endif  /* _NLINK_T */
diff -Nur cctools-877.5/include/sys/_types/_null.h cctools-877.5-AnV/include/sys/_types/_null.h
--- cctools-877.5/include/sys/_types/_null.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_null.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,30 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef NULL 
+#define NULL  __DARWIN_NULL
+#endif  /* NULL */
diff -Nur cctools-877.5/include/sys/_types/_o_dsync.h cctools-877.5-AnV/include/sys/_types/_o_dsync.h
--- cctools-877.5/include/sys/_types/_o_dsync.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_o_dsync.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,30 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef O_DSYNC		
+#define	O_DSYNC			0x400000	/* synch I/O data integrity */
+#endif /* O_DSYNC */
diff -Nur cctools-877.5/include/sys/_types/_o_sync.h cctools-877.5-AnV/include/sys/_types/_o_sync.h
--- cctools-877.5/include/sys/_types/_o_sync.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_o_sync.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,30 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef O_SYNC		
+#define	O_SYNC			0x0080		/* synch I/O file integrity */
+#endif /* O_SYNC */
diff -Nur cctools-877.5/include/sys/_types/_off_t.h cctools-877.5-AnV/include/sys/_types/_off_t.h
--- cctools-877.5/include/sys/_types/_off_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_off_t.h	2015-11-19 09:18:15 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#define _OFF_T 1
+#ifndef _OFF_T 
+#define _OFF_T 
+typedef __darwin_off_t		off_t;
+#endif  /* _OFF_T */
diff -Nur cctools-877.5/include/sys/_types/_offsetof.h cctools-877.5-AnV/include/sys/_types/_offsetof.h
--- cctools-877.5/include/sys/_types/_offsetof.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_offsetof.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,30 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef offsetof
+#define offsetof(type, field) __offsetof(type, field)
+#endif /* offsetof */
diff -Nur cctools-877.5/include/sys/_types/_os_inline.h cctools-877.5-AnV/include/sys/_types/_os_inline.h
--- cctools-877.5/include/sys/_types/_os_inline.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_os_inline.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,34 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#if !defined(OS_INLINE)
+# if defined(__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
+#        define OS_INLINE static inline
+# else
+#        define OS_INLINE static __inline__
+# endif
+#endif /* OS_INLINE */
diff -Nur cctools-877.5/include/sys/_types/_pid_t.h cctools-877.5-AnV/include/sys/_types/_pid_t.h
--- cctools-877.5/include/sys/_types/_pid_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_pid_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _PID_T 
+#define _PID_T 
+typedef __darwin_pid_t        pid_t; 
+#endif  /* _PID_T */
diff -Nur cctools-877.5/include/sys/_types/_posix_vdisable.h cctools-877.5-AnV/include/sys/_types/_posix_vdisable.h
--- cctools-877.5/include/sys/_types/_posix_vdisable.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_posix_vdisable.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,30 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _POSIX_VDISABLE
+#define	_POSIX_VDISABLE		((unsigned char)'\377')
+#endif /* POSIX_VDISABLE */
diff -Nur cctools-877.5/include/sys/_types/_ptrdiff_t.h cctools-877.5-AnV/include/sys/_types/_ptrdiff_t.h
--- cctools-877.5/include/sys/_types/_ptrdiff_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_ptrdiff_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _PTRDIFF_T
+#define _PTRDIFF_T
+typedef __darwin_ptrdiff_t ptrdiff_t;
+#endif /* _PTRDIFF_T */
diff -Nur cctools-877.5/include/sys/_types/_rsize_t.h cctools-877.5-AnV/include/sys/_types/_rsize_t.h
--- cctools-877.5/include/sys/_types/_rsize_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_rsize_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _RSIZE_T
+#define _RSIZE_T
+typedef __darwin_size_t        rsize_t;
+#endif  /* _RSIZE_T */
diff -Nur cctools-877.5/include/sys/_types/_rune_t.h cctools-877.5-AnV/include/sys/_types/_rune_t.h
--- cctools-877.5/include/sys/_types/_rune_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_rune_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _RUNE_T 
+#define _RUNE_T 
+typedef __darwin_rune_t rune_t; 
+#endif /* _RUNE_T */
diff -Nur cctools-877.5/include/sys/_types/_s_ifmt.h cctools-877.5-AnV/include/sys/_types/_s_ifmt.h
--- cctools-877.5/include/sys/_types/_s_ifmt.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_s_ifmt.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,74 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+/*
+ * [XSI] The symbolic names for file modes for use as values of mode_t
+ * shall be defined as described in <sys/stat.h>
+ */
+#ifndef S_IFMT
+/* File type */
+#define	S_IFMT		0170000		/* [XSI] type of file mask */
+#define	S_IFIFO		0010000		/* [XSI] named pipe (fifo) */
+#define	S_IFCHR		0020000		/* [XSI] character special */
+#define	S_IFDIR		0040000		/* [XSI] directory */
+#define	S_IFBLK		0060000		/* [XSI] block special */
+#define	S_IFREG		0100000		/* [XSI] regular */
+#define	S_IFLNK		0120000		/* [XSI] symbolic link */
+#define	S_IFSOCK	0140000		/* [XSI] socket */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	S_IFWHT		0160000		/* OBSOLETE: whiteout */
+#endif
+
+/* File mode */
+/* Read, write, execute/search by owner */
+#define	S_IRWXU		0000700		/* [XSI] RWX mask for owner */
+#define	S_IRUSR		0000400		/* [XSI] R for owner */
+#define	S_IWUSR		0000200		/* [XSI] W for owner */
+#define	S_IXUSR		0000100		/* [XSI] X for owner */
+/* Read, write, execute/search by group */
+#define	S_IRWXG		0000070		/* [XSI] RWX mask for group */
+#define	S_IRGRP		0000040		/* [XSI] R for group */
+#define	S_IWGRP		0000020		/* [XSI] W for group */
+#define	S_IXGRP		0000010		/* [XSI] X for group */
+/* Read, write, execute/search by others */
+#define	S_IRWXO		0000007		/* [XSI] RWX mask for other */
+#define	S_IROTH		0000004		/* [XSI] R for other */
+#define	S_IWOTH		0000002		/* [XSI] W for other */
+#define	S_IXOTH		0000001		/* [XSI] X for other */
+
+#define	S_ISUID		0004000		/* [XSI] set user id on execution */
+#define	S_ISGID		0002000		/* [XSI] set group id on execution */
+#define	S_ISVTX		0001000		/* [XSI] directory restrcted delete */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	S_ISTXT		S_ISVTX		/* sticky bit: not supported */
+#define	S_IREAD		S_IRUSR		/* backward compatability */
+#define	S_IWRITE	S_IWUSR		/* backward compatability */
+#define	S_IEXEC		S_IXUSR		/* backward compatability */
+#endif
+#endif	/* !S_IFMT */
diff -Nur cctools-877.5/include/sys/_types/_sa_family_t.h cctools-877.5-AnV/include/sys/_types/_sa_family_t.h
--- cctools-877.5/include/sys/_types/_sa_family_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_sa_family_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _SA_FAMILY_T 
+#define _SA_FAMILY_T 
+typedef __uint8_t		sa_family_t;
+#endif  /* _SA_FAMILY_T */
diff -Nur cctools-877.5/include/sys/_types/_seek_set.h cctools-877.5-AnV/include/sys/_types/_seek_set.h
--- cctools-877.5/include/sys/_types/_seek_set.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_seek_set.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,34 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+/* whence values for lseek(2) */
+#ifndef SEEK_SET
+#define	SEEK_SET	0	/* set file offset to offset */
+#define	SEEK_CUR	1	/* set file offset to current plus offset */
+#define	SEEK_END	2	/* set file offset to EOF plus offset */
+#endif	/* !SEEK_SET */
diff -Nur cctools-877.5/include/sys/_types/_sigaltstack.h cctools-877.5-AnV/include/sys/_types/_sigaltstack.h
--- cctools-877.5/include/sys/_types/_sigaltstack.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_sigaltstack.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,44 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+/* Structure used in sigaltstack call. */
+#ifndef _STRUCT_SIGALTSTACK
+#if __DARWIN_UNIX03
+#define _STRUCT_SIGALTSTACK	struct __darwin_sigaltstack
+#else /* !__DARWIN_UNIX03 */
+#define _STRUCT_SIGALTSTACK	struct sigaltstack
+#endif /* __DARWIN_UNIX03 */
+_STRUCT_SIGALTSTACK
+{
+	void            *ss_sp;	        /* signal stack base */
+	__darwin_size_t ss_size;        /* signal stack length */
+	int             ss_flags;       /* SA_DISABLE and/or SA_ONSTACK */
+};
+typedef _STRUCT_SIGALTSTACK	stack_t; /* [???] signal stack */
+
+#endif /* _STRUCT_SIGALTSTACK */
diff -Nur cctools-877.5/include/sys/_types/_sigset_t.h cctools-877.5-AnV/include/sys/_types/_sigset_t.h
--- cctools-877.5/include/sys/_types/_sigset_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_sigset_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _SIGSET_T 
+#define _SIGSET_T 
+typedef __darwin_sigset_t		sigset_t;
+#endif  /* _SIGSET_T */
diff -Nur cctools-877.5/include/sys/_types/_size_t.h cctools-877.5-AnV/include/sys/_types/_size_t.h
--- cctools-877.5/include/sys/_types/_size_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_size_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _SIZE_T 
+#define _SIZE_T 
+typedef __darwin_size_t        size_t; 
+#endif  /* _SIZE_T */
diff -Nur cctools-877.5/include/sys/_types/_socklen_t.h cctools-877.5-AnV/include/sys/_types/_socklen_t.h
--- cctools-877.5/include/sys/_types/_socklen_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_socklen_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _SOCKLEN_T
+#define _SOCKLEN_T
+typedef	__darwin_socklen_t	socklen_t;
+#endif
+
diff -Nur cctools-877.5/include/sys/_types/_ssize_t.h cctools-877.5-AnV/include/sys/_types/_ssize_t.h
--- cctools-877.5/include/sys/_types/_ssize_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_ssize_t.h	2015-11-19 09:17:12 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#define _SSIZE_T 1
+#ifndef _SSIZE_T 
+#define _SSIZE_T 
+typedef __darwin_ssize_t        ssize_t; 
+#endif  /* _SSIZE_T */
diff -Nur cctools-877.5/include/sys/_types/_suseconds_t.h cctools-877.5-AnV/include/sys/_types/_suseconds_t.h
--- cctools-877.5/include/sys/_types/_suseconds_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_suseconds_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _SUSECONDS_T 
+#define _SUSECONDS_T 
+typedef __darwin_suseconds_t	suseconds_t;
+#endif  /* _SUSECONDS_T */
diff -Nur cctools-877.5/include/sys/_types/_time_t.h cctools-877.5-AnV/include/sys/_types/_time_t.h
--- cctools-877.5/include/sys/_types/_time_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_time_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _TIME_T 
+#define _TIME_T 
+typedef __darwin_time_t		time_t; 
+#endif  /* _TIME_T */
diff -Nur cctools-877.5/include/sys/_types/_timespec.h cctools-877.5-AnV/include/sys/_types/_timespec.h
--- cctools-877.5/include/sys/_types/_timespec.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_timespec.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,35 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _STRUCT_TIMESPEC
+#define _STRUCT_TIMESPEC	struct timespec
+_STRUCT_TIMESPEC
+{
+	__darwin_time_t	tv_sec;
+	long            tv_nsec;
+};
+#endif /* _STRUCT_TIMESPEC */
diff -Nur cctools-877.5/include/sys/_types/_timeval.h cctools-877.5-AnV/include/sys/_types/_timeval.h
--- cctools-877.5/include/sys/_types/_timeval.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_timeval.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,35 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _STRUCT_TIMEVAL
+#define _STRUCT_TIMEVAL		struct timeval
+_STRUCT_TIMEVAL
+{
+	__darwin_time_t	        tv_sec;	        /* seconds */
+	__darwin_suseconds_t    tv_usec;        /* and microseconds */
+};
+#endif /* _STRUCT_TIMEVAL */
diff -Nur cctools-877.5/include/sys/_types/_timeval32.h cctools-877.5-AnV/include/sys/_types/_timeval32.h
--- cctools-877.5/include/sys/_types/_timeval32.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_timeval32.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,35 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _STRUCT_TIMEVAL32
+#define _STRUCT_TIMEVAL32	struct timeval32
+_STRUCT_TIMEVAL32
+{
+	__int32_t		tv_sec;		/* seconds */
+	__int32_t		tv_usec;	/* and microseconds */
+};
+#endif /* _STRUCT_TIMEVAL32 */
diff -Nur cctools-877.5/include/sys/_types/_ucontext.h cctools-877.5-AnV/include/sys/_types/_ucontext.h
--- cctools-877.5/include/sys/_types/_ucontext.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_ucontext.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,50 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _STRUCT_UCONTEXT
+#if __DARWIN_UNIX03
+#define _STRUCT_UCONTEXT	struct __darwin_ucontext
+#else /* !__DARWIN_UNIX03 */
+#define _STRUCT_UCONTEXT	struct ucontext
+#endif /* __DARWIN_UNIX03 */
+_STRUCT_UCONTEXT
+{
+	int                     uc_onstack;
+	__darwin_sigset_t       uc_sigmask;     /* signal mask used by this context */
+	_STRUCT_SIGALTSTACK     uc_stack;       /* stack used by this context */
+	_STRUCT_UCONTEXT        *uc_link;       /* pointer to resuming context */
+	__darwin_size_t	        uc_mcsize;      /* size of the machine context passed in */
+	_STRUCT_MCONTEXT        *uc_mcontext;   /* pointer to machine specific context */
+#ifdef _XOPEN_SOURCE
+	_STRUCT_MCONTEXT        __mcontext_data;
+#endif /* _XOPEN_SOURCE */
+};
+
+/* user context */
+typedef _STRUCT_UCONTEXT	ucontext_t;     /* [???] user context */	
+
+#endif /* _STRUCT_UCONTEXT */
diff -Nur cctools-877.5/include/sys/_types/_ucontext64.h cctools-877.5-AnV/include/sys/_types/_ucontext64.h
--- cctools-877.5/include/sys/_types/_ucontext64.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_ucontext64.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,45 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _STRUCT_UCONTEXT64
+#if __DARWIN_UNIX03
+#define _STRUCT_UCONTEXT64	struct __darwin_ucontext64
+#else /* !__DARWIN_UNIX03 */
+#define _STRUCT_UCONTEXT64	struct ucontext64
+#endif /* __DARWIN_UNIX03 */
+_STRUCT_UCONTEXT64
+{
+	int                     uc_onstack;
+	__darwin_sigset_t       uc_sigmask;     /* signal mask used by this context */
+	_STRUCT_SIGALTSTACK     uc_stack;       /* stack used by this context */
+	_STRUCT_UCONTEXT64      *uc_link;       /* pointer to resuming context */
+	__darwin_size_t	        uc_mcsize;      /* size of the machine context passed in */
+	_STRUCT_MCONTEXT64      *uc_mcontext64;	/* pointer to machine specific context */
+};
+typedef _STRUCT_UCONTEXT64	ucontext64_t;   /* [???] user context */
+
+#endif /* _STRUCT_UCONTEXT64 */
diff -Nur cctools-877.5/include/sys/_types/_uid_t.h cctools-877.5-AnV/include/sys/_types/_uid_t.h
--- cctools-877.5/include/sys/_types/_uid_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_uid_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _UID_T 
+#define _UID_T 
+typedef __darwin_uid_t        uid_t; 
+#endif  /* _UID_T */
diff -Nur cctools-877.5/include/sys/_types/_uintptr_t.h cctools-877.5-AnV/include/sys/_types/_uintptr_t.h
--- cctools-877.5/include/sys/_types/_uintptr_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_uintptr_t.h	2015-11-19 09:17:53 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#define _UINTPTR_T 1
+#ifndef _UINTPTR_T
+#define _UINTPTR_T
+typedef unsigned long		uintptr_t;
+#endif /* _UINTPTR_T */
diff -Nur cctools-877.5/include/sys/_types/_useconds_t.h cctools-877.5-AnV/include/sys/_types/_useconds_t.h
--- cctools-877.5/include/sys/_types/_useconds_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_useconds_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _USECONDS_T
+#define _USECONDS_T
+typedef __darwin_useconds_t	useconds_t;
+#endif /* _USECONDS_T */
diff -Nur cctools-877.5/include/sys/_types/_uuid_t.h cctools-877.5-AnV/include/sys/_types/_uuid_t.h
--- cctools-877.5/include/sys/_types/_uuid_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_uuid_t.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,31 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _UUID_T
+#define _UUID_T
+typedef __darwin_uuid_t	uuid_t;
+#endif /* _UUID_T */
diff -Nur cctools-877.5/include/sys/_types/_va_list.h cctools-877.5-AnV/include/sys/_types/_va_list.h
--- cctools-877.5/include/sys/_types/_va_list.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_va_list.h	2015-11-16 07:56:31 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _VA_LIST_T
+#define _VA_LIST_T
+typedef __darwin_va_list va_list;
+#endif /* _VA_LIST_T */
diff -Nur cctools-877.5/include/sys/_types/_wchar_t.h cctools-877.5-AnV/include/sys/_types/_wchar_t.h
--- cctools-877.5/include/sys/_types/_wchar_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_wchar_t.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,35 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+/* wchar_t is a built-in type in C++ */
+#ifndef __cplusplus
+#ifndef _WCHAR_T
+#define _WCHAR_T
+typedef __darwin_wchar_t wchar_t;
+#endif /* _WCHAR_T */
+#endif /* __cplusplus */
diff -Nur cctools-877.5/include/sys/_types/_wint_t.h cctools-877.5-AnV/include/sys/_types/_wint_t.h
--- cctools-877.5/include/sys/_types/_wint_t.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types/_wint_t.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,32 @@
+/*
+ * Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _WINT_T
+#define _WINT_T
+typedef __darwin_wint_t wint_t;
+#endif /* _WINT_T */
diff -Nur cctools-877.5/include/sys/_types.h cctools-877.5-AnV/include/sys/_types.h
--- cctools-877.5/include/sys/_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/_types.h	2015-11-16 07:56:30 +0000
@@ -0,0 +1,89 @@
+/*
+ * Copyright (c) 2003-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _SYS__TYPES_H_
+#define _SYS__TYPES_H_
+
+#include <sys/cdefs.h>
+#include <machine/_types.h>
+
+/*
+ * Type definitions; takes common type definitions that must be used
+ * in multiple header files due to [XSI], removes them from the system
+ * space, and puts them in the implementation space.
+ */
+
+#ifdef __cplusplus
+#ifdef __GNUG__
+#define __DARWIN_NULL __null
+#else /* ! __GNUG__ */
+#ifdef __LP64__
+#define __DARWIN_NULL (0L)
+#else /* !__LP64__ */
+#define __DARWIN_NULL 0
+#endif /* __LP64__ */
+#endif /* __GNUG__ */
+#else /* ! __cplusplus */
+#define __DARWIN_NULL ((void *)0)
+#endif /* __cplusplus */
+
+typedef	__int64_t	__darwin_blkcnt_t;	/* total blocks */
+typedef	__int32_t	__darwin_blksize_t;	/* preferred block size */
+typedef __int32_t	__darwin_dev_t;		/* dev_t */
+typedef unsigned int	__darwin_fsblkcnt_t;	/* Used by statvfs and fstatvfs */
+typedef unsigned int	__darwin_fsfilcnt_t;	/* Used by statvfs and fstatvfs */
+typedef __uint32_t	__darwin_gid_t;		/* [???] process and group IDs */
+typedef __uint32_t	__darwin_id_t;		/* [XSI] pid_t, uid_t, or gid_t*/
+typedef __uint64_t	__darwin_ino64_t;	/* [???] Used for 64 bit inodes */
+#if __DARWIN_64_BIT_INO_T
+typedef __darwin_ino64_t __darwin_ino_t;	/* [???] Used for inodes */
+#else /* !__DARWIN_64_BIT_INO_T */
+typedef __uint32_t	__darwin_ino_t;		/* [???] Used for inodes */
+#endif /* __DARWIN_64_BIT_INO_T */
+typedef __darwin_natural_t __darwin_mach_port_name_t; /* Used by mach */
+typedef __darwin_mach_port_name_t __darwin_mach_port_t; /* Used by mach */
+typedef __uint16_t	__darwin_mode_t;	/* [???] Some file attributes */
+typedef __int64_t	__darwin_off_t;		/* [???] Used for file sizes */
+typedef __int32_t	__darwin_pid_t;		/* [???] process and group IDs */
+typedef __uint32_t	__darwin_sigset_t;	/* [???] signal set */
+typedef __int32_t	__darwin_suseconds_t;	/* [???] microseconds */
+typedef __uint32_t	__darwin_uid_t;		/* [???] user IDs */
+typedef __uint32_t	__darwin_useconds_t;	/* [???] microseconds */
+typedef	unsigned char	__darwin_uuid_t[16];
+typedef	char	__darwin_uuid_string_t[37];
+
+#include <sys/_pthread/_pthread_types.h>
+
+#if defined(__GNUC__) && (__GNUC__ == 3 && __GNUC_MINOR__ >= 5 || __GNUC__ > 3)
+#define __offsetof(type, field) __builtin_offsetof(type, field)
+#else /* !(gcc >= 3.5) */
+#define __offsetof(type, field) ((size_t)(&((type *)0)->field))
+#endif /* (gcc >= 3.5) */
+
+
+#endif	/* _SYS__TYPES_H_ */
diff -Nur cctools-877.5/include/sys/acct.h cctools-877.5-AnV/include/sys/acct.h
--- cctools-877.5/include/sys/acct.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/acct.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,107 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1990, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)acct.h	8.4 (Berkeley) 1/9/95
+ */
+#ifndef _SYS_ACCT_H_
+#define _SYS_ACCT_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+/*
+ * Accounting structures; these use a comp_t type which is a 3 bits base 8
+ * exponent, 13 bit fraction ``floating point'' number.  Units are 1/AHZ
+ * seconds.
+ */
+typedef u_int16_t comp_t;
+
+struct acct {
+	char	  ac_comm[10];	/* command name */
+	comp_t	  ac_utime;	/* user time */
+	comp_t	  ac_stime;	/* system time */
+	comp_t	  ac_etime;	/* elapsed time */
+	u_int32_t ac_btime;	/* starting time */
+	uid_t	  ac_uid;	/* user id */
+	gid_t	  ac_gid;	/* group id */
+	u_int16_t ac_mem;	/* average memory usage */
+	comp_t	  ac_io;	/* count of IO blocks */
+	dev_t	  ac_tty;	/* controlling tty */
+
+#define	AFORK	0x01		/* fork'd but not exec'd */
+#define	ASU	0x02		/* used super-user permissions */
+#define	ACOMPAT	0x04		/* used compatibility mode */
+#define	ACORE	0x08		/* dumped core */
+#define	AXSIG	0x10		/* killed by a signal */
+	u_int8_t  ac_flag;	/* accounting flags */
+};
+
+/*
+ * 1/AHZ is the granularity of the data encoded in the comp_t fields.
+ * This is not necessarily equal to hz.
+ */
+#define	AHZ	64
+
+
+#endif /* ! _SYS_ACCT_H_ */
diff -Nur cctools-877.5/include/sys/acl.h cctools-877.5-AnV/include/sys/acl.h
--- cctools-877.5/include/sys/acl.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/acl.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,211 @@
+/*
+ * Copyright (c) 2004, 2010 Apple Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _SYS_ACL_H
+#define _SYS_ACL_H
+
+#include <Availability.h>
+#include <sys/kauth.h>
+
+#define __DARWIN_ACL_READ_DATA			(1<<1)
+#define __DARWIN_ACL_LIST_DIRECTORY		__DARWIN_ACL_READ_DATA
+#define __DARWIN_ACL_WRITE_DATA			(1<<2)
+#define __DARWIN_ACL_ADD_FILE			__DARWIN_ACL_WRITE_DATA
+#define __DARWIN_ACL_EXECUTE			(1<<3)
+#define __DARWIN_ACL_SEARCH			__DARWIN_ACL_EXECUTE
+#define __DARWIN_ACL_DELETE			(1<<4)
+#define __DARWIN_ACL_APPEND_DATA		(1<<5)
+#define __DARWIN_ACL_ADD_SUBDIRECTORY		__DARWIN_ACL_APPEND_DATA
+#define __DARWIN_ACL_DELETE_CHILD		(1<<6)
+#define __DARWIN_ACL_READ_ATTRIBUTES		(1<<7)
+#define __DARWIN_ACL_WRITE_ATTRIBUTES		(1<<8)
+#define __DARWIN_ACL_READ_EXTATTRIBUTES		(1<<9)
+#define __DARWIN_ACL_WRITE_EXTATTRIBUTES	(1<<10)
+#define __DARWIN_ACL_READ_SECURITY		(1<<11)
+#define __DARWIN_ACL_WRITE_SECURITY		(1<<12)
+#define __DARWIN_ACL_CHANGE_OWNER		(1<<13)
+#define __DARWIN_ACL_SYNCHRONIZE		(1<<20)
+
+#define __DARWIN_ACL_EXTENDED_ALLOW		1
+#define __DARWIN_ACL_EXTENDED_DENY		2
+
+#define __DARWIN_ACL_ENTRY_INHERITED		(1<<4)
+#define __DARWIN_ACL_ENTRY_FILE_INHERIT		(1<<5)
+#define __DARWIN_ACL_ENTRY_DIRECTORY_INHERIT	(1<<6)
+#define __DARWIN_ACL_ENTRY_LIMIT_INHERIT	(1<<7)
+#define __DARWIN_ACL_ENTRY_ONLY_INHERIT		(1<<8)
+#define __DARWIN_ACL_FLAG_NO_INHERIT		(1<<17)
+
+/*
+ * Implementation constants.
+ *
+ * The ACL_TYPE_EXTENDED binary format permits 169 entries plus
+ * the ACL header in a page.  Give ourselves some room to grow;
+ * this limit is arbitrary.
+ */
+#define ACL_MAX_ENTRIES		128
+
+/* 23.2.2 Individual object access permissions - nonstandard */
+typedef enum {
+	ACL_READ_DATA		= __DARWIN_ACL_READ_DATA,
+	ACL_LIST_DIRECTORY	= __DARWIN_ACL_LIST_DIRECTORY,
+	ACL_WRITE_DATA		= __DARWIN_ACL_WRITE_DATA,
+	ACL_ADD_FILE		= __DARWIN_ACL_ADD_FILE,
+	ACL_EXECUTE		= __DARWIN_ACL_EXECUTE,
+	ACL_SEARCH		= __DARWIN_ACL_SEARCH,
+	ACL_DELETE		= __DARWIN_ACL_DELETE,
+	ACL_APPEND_DATA		= __DARWIN_ACL_APPEND_DATA,
+	ACL_ADD_SUBDIRECTORY	= __DARWIN_ACL_ADD_SUBDIRECTORY,
+	ACL_DELETE_CHILD	= __DARWIN_ACL_DELETE_CHILD,
+	ACL_READ_ATTRIBUTES	= __DARWIN_ACL_READ_ATTRIBUTES,
+	ACL_WRITE_ATTRIBUTES	= __DARWIN_ACL_WRITE_ATTRIBUTES,
+	ACL_READ_EXTATTRIBUTES	= __DARWIN_ACL_READ_EXTATTRIBUTES,
+	ACL_WRITE_EXTATTRIBUTES	= __DARWIN_ACL_WRITE_EXTATTRIBUTES,
+	ACL_READ_SECURITY	= __DARWIN_ACL_READ_SECURITY,
+	ACL_WRITE_SECURITY	= __DARWIN_ACL_WRITE_SECURITY,
+	ACL_CHANGE_OWNER	= __DARWIN_ACL_CHANGE_OWNER,
+	ACL_SYNCHRONIZE		= __DARWIN_ACL_SYNCHRONIZE,
+} acl_perm_t;
+
+/* 23.2.5 ACL entry tag type bits - nonstandard */
+typedef enum {
+	ACL_UNDEFINED_TAG	= 0,
+	ACL_EXTENDED_ALLOW	= __DARWIN_ACL_EXTENDED_ALLOW,
+	ACL_EXTENDED_DENY	= __DARWIN_ACL_EXTENDED_DENY
+} acl_tag_t;
+
+/* 23.2.6 Individual ACL types */
+typedef enum {
+	ACL_TYPE_EXTENDED	= 0x00000100,
+/* Posix 1003.1e types - not supported */
+	ACL_TYPE_ACCESS         = 0x00000000,
+	ACL_TYPE_DEFAULT        = 0x00000001,
+/* The following types are defined on FreeBSD/Linux - not supported */
+	ACL_TYPE_AFS            = 0x00000002,
+	ACL_TYPE_CODA           = 0x00000003,
+	ACL_TYPE_NTFS           = 0x00000004,
+	ACL_TYPE_NWFS           = 0x00000005
+} acl_type_t;
+
+/* 23.2.7 ACL qualifier constants */
+
+#define ACL_UNDEFINED_ID	NULL	/* XXX ? */
+
+/* 23.2.8 ACL Entry Constants */
+typedef enum {
+	ACL_FIRST_ENTRY		= 0,
+	ACL_NEXT_ENTRY		= -1,
+	ACL_LAST_ENTRY		= -2
+} acl_entry_id_t;
+
+/* nonstandard ACL / entry flags */
+typedef enum {
+	ACL_FLAG_DEFER_INHERIT		= (1 << 0),	/* tentative */
+	ACL_FLAG_NO_INHERIT		= __DARWIN_ACL_FLAG_NO_INHERIT,
+	ACL_ENTRY_INHERITED		= __DARWIN_ACL_ENTRY_INHERITED,
+	ACL_ENTRY_FILE_INHERIT		= __DARWIN_ACL_ENTRY_FILE_INHERIT,
+	ACL_ENTRY_DIRECTORY_INHERIT	= __DARWIN_ACL_ENTRY_DIRECTORY_INHERIT,
+	ACL_ENTRY_LIMIT_INHERIT		= __DARWIN_ACL_ENTRY_LIMIT_INHERIT,
+	ACL_ENTRY_ONLY_INHERIT		= __DARWIN_ACL_ENTRY_ONLY_INHERIT
+} acl_flag_t;
+
+/* "External" ACL types */
+
+struct _acl;
+struct _acl_entry;
+struct _acl_permset;
+struct _acl_flagset;
+
+typedef struct _acl		*acl_t;
+typedef struct _acl_entry	*acl_entry_t;
+typedef struct _acl_permset	*acl_permset_t;
+typedef struct _acl_flagset	*acl_flagset_t;
+
+typedef u_int64_t		acl_permset_mask_t;
+
+__BEGIN_DECLS
+/* 23.1.6.1 ACL Storage Management */
+extern acl_t	acl_dup(acl_t acl);
+extern int	acl_free(void *obj_p);
+extern acl_t	acl_init(int count);
+
+/* 23.1.6.2 (1) ACL Entry manipulation */
+extern int	acl_copy_entry(acl_entry_t dest_d, acl_entry_t src_d);
+extern int	acl_create_entry(acl_t *acl_p, acl_entry_t *entry_p);
+extern int	acl_create_entry_np(acl_t *acl_p, acl_entry_t *entry_p, int entry_index);
+extern int	acl_delete_entry(acl_t acl, acl_entry_t entry_d);
+extern int	acl_get_entry(acl_t acl, int entry_id, acl_entry_t *entry_p);
+extern int	acl_valid(acl_t acl);
+extern int	acl_valid_fd_np(int fd, acl_type_t type, acl_t acl);
+extern int	acl_valid_file_np(const char *path, acl_type_t type, acl_t acl);
+extern int	acl_valid_link_np(const char *path, acl_type_t type, acl_t acl);
+
+/* 23.1.6.2 (2) Manipulate permissions within an ACL entry */
+extern int	acl_add_perm(acl_permset_t permset_d, acl_perm_t perm);
+extern int	acl_calc_mask(acl_t *acl_p);	/* not supported */
+extern int	acl_clear_perms(acl_permset_t permset_d);
+extern int	acl_delete_perm(acl_permset_t permset_d, acl_perm_t perm);
+extern int	acl_get_perm_np(acl_permset_t permset_d, acl_perm_t perm);
+extern int 	acl_get_permset(acl_entry_t entry_d, acl_permset_t *permset_p);
+extern int	acl_set_permset(acl_entry_t entry_d, acl_permset_t permset_d);
+
+/* nonstandard - manipulate permissions within an ACL entry using bitmasks */
+extern int	acl_maximal_permset_mask_np(acl_permset_mask_t * mask_p) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
+extern int	acl_get_permset_mask_np(acl_entry_t entry_d, acl_permset_mask_t * mask_p) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
+extern int	acl_set_permset_mask_np(acl_entry_t entry_d, acl_permset_mask_t mask) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
+
+/* nonstandard - manipulate flags on ACLs and entries */
+extern int	acl_add_flag_np(acl_flagset_t flagset_d, acl_flag_t flag);
+extern int	acl_clear_flags_np(acl_flagset_t flagset_d);
+extern int	acl_delete_flag_np(acl_flagset_t flagset_d, acl_flag_t flag);
+extern int	acl_get_flag_np(acl_flagset_t flagset_d, acl_flag_t flag);
+extern int	acl_get_flagset_np(void *obj_p, acl_flagset_t *flagset_p);
+extern int	acl_set_flagset_np(void *obj_p, acl_flagset_t flagset_d);
+
+/* 23.1.6.2 (3) Manipulate ACL entry tag type and qualifier */
+extern void	*acl_get_qualifier(acl_entry_t entry_d);
+extern int	acl_get_tag_type(acl_entry_t entry_d, acl_tag_t *tag_type_p);
+extern int	acl_set_qualifier(acl_entry_t entry_d, const void *tag_qualifier_p);
+extern int	acl_set_tag_type(acl_entry_t entry_d, acl_tag_t tag_type);
+
+/* 23.1.6.3 ACL manipulation on an Object */
+extern int	acl_delete_def_file(const char *path_p); /* not supported */
+extern acl_t 	acl_get_fd(int fd);
+extern acl_t	acl_get_fd_np(int fd, acl_type_t type);
+extern acl_t	acl_get_file(const char *path_p, acl_type_t type);
+extern acl_t	acl_get_link_np(const char *path_p, acl_type_t type);
+extern int	acl_set_fd(int fd, acl_t acl);
+extern int	acl_set_fd_np(int fd, acl_t acl, acl_type_t acl_type);
+extern int	acl_set_file(const char *path_p, acl_type_t type, acl_t acl);
+extern int	acl_set_link_np(const char *path_p, acl_type_t type, acl_t acl);
+
+/* 23.1.6.4 ACL Format translation */
+extern ssize_t	acl_copy_ext(void *buf_p, acl_t acl, ssize_t size);
+extern ssize_t	acl_copy_ext_native(void *buf_p, acl_t acl, ssize_t size);
+extern acl_t	acl_copy_int(const void *buf_p);
+extern acl_t	acl_copy_int_native(const void *buf_p);
+extern acl_t	acl_from_text(const char *buf_p);
+extern ssize_t	acl_size(acl_t acl);
+extern char	*acl_to_text(acl_t acl, ssize_t *len_p);
+__END_DECLS
+
+#endif /* _SYS_ACL_H */
diff -Nur cctools-877.5/include/sys/aio.h cctools-877.5-AnV/include/sys/aio.h
--- cctools-877.5/include/sys/aio.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/aio.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,248 @@
+/*
+ * Copyright (c) 2003-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ *	File:	sys/aio.h
+ *	Author:	Umesh Vaishampayan [umeshv@apple.com]
+ *			05-Feb-2003	umeshv	Created.
+ *
+ *	Header file for POSIX Asynchronous IO APIs
+ *
+ */ 
+
+#ifndef _SYS_AIO_H_
+#define	_SYS_AIO_H_
+
+#include <sys/signal.h>
+#include <sys/_types.h>
+#include <sys/cdefs.h>
+
+/*
+ * [XSI] Inclusion of the <aio.h> header may make visible symbols defined
+ * in the headers <fcntl.h>, <signal.h>, <sys/types.h>, and <time.h>.
+ * 
+ * In our case, this is limited to struct timespec, off_t and ssize_t.
+ */
+#include <sys/_types/_timespec.h>
+
+#include <sys/_types/_off_t.h>
+#include <sys/_types/_ssize_t.h>
+
+/*
+ * A aio_fsync() options that the calling thread is to continue execution
+ * while the lio_listio() operation is being performed, and no notification
+ * is given when the operation is complete
+ *
+ * [XSI] from <fcntl.h>
+ */
+#include <sys/_types/_o_sync.h>
+#include <sys/_types/_o_dsync.h>
+
+struct aiocb {
+	int		aio_fildes;		/* File descriptor */
+	off_t		aio_offset;		/* File offset */
+	volatile void	*aio_buf;		/* Location of buffer */
+	size_t		aio_nbytes;		/* Length of transfer */
+	int		aio_reqprio;		/* Request priority offset */
+	struct sigevent	aio_sigevent;		/* Signal number and value */
+	int		aio_lio_opcode;		/* Operation to be performed */
+};
+
+
+/*
+ * aio_cancel() return values
+ */
+
+/*
+ * none of the requested operations could be canceled since they are
+ * already complete.
+ */
+#define	AIO_ALLDONE			0x1
+
+/* all requested operations have been canceled */
+#define	AIO_CANCELED		0x2
+
+/*
+ * some of the requested operations could not be canceled since
+ * they are in progress
+ */
+#define	AIO_NOTCANCELED		0x4
+
+
+/*
+ * lio_listio operation options
+ */
+
+#define	LIO_NOP			0x0 	/* option indicating that no transfer is requested */
+#define	LIO_READ		0x1		/* option requesting a read */
+#define	LIO_WRITE		0x2		/* option requesting a write */
+
+/*
+ * lio_listio() modes
+ */
+
+/*
+ * A lio_listio() synchronization operation indicating
+ * that the calling thread is to continue execution while
+ * the lio_listio() operation is being performed, and no
+ * notification is given when the operation is complete
+ */
+#define	LIO_NOWAIT		0x1
+
+/*
+ * A lio_listio() synchronization operation indicating
+ * that the calling thread is to suspend until the
+ * lio_listio() operation is complete.
+ */
+#define	LIO_WAIT		0x2
+
+/*
+ * Maximum number of operations in single lio_listio call
+ */
+#define	AIO_LISTIO_MAX		16
+
+
+/*
+ * Prototypes
+ */
+
+__BEGIN_DECLS
+
+/*
+ * Attempt to cancel one or more asynchronous I/O requests currently outstanding 
+ * against file descriptor fd. The aiocbp argument points to the asynchronous I/O 
+ * control block for a particular request to be canceled.  If aiocbp is NULL, then 
+ * all outstanding cancelable asynchronous I/O requests against fd shall be canceled.
+ */
+int		aio_cancel( int fd, 
+					struct aiocb * aiocbp );
+					
+/*
+ * Return the error status associated with the aiocb structure referenced by the 
+ * aiocbp argument. The error status for an asynchronous I/O operation is the errno 
+ * value that would be set by the corresponding read(), write(),  or fsync()
+ * operation.  If the operation has not yet completed, then the error status shall 
+ * be equal to [EINPROGRESS].
+ */
+int		aio_error( const struct aiocb * aiocbp );
+
+/*
+ * Asynchronously force all I/O operations associated with the file indicated by 
+ * the file descriptor aio_fildes member of the aiocb structure referenced by the 
+ * aiocbp argument and queued at the time of the call to aio_fsync() to the 
+ * synchronized I/O completion state.  The function call shall return when the
+ * synchronization request has been initiated or queued.  op O_SYNC is the only
+ * supported opertation at this time.
+ * The aiocbp argument refers to an asynchronous I/O control block. The aiocbp 
+ * value may be used as an argument to aio_error() and aio_return() in order to 
+ * determine the error status and return status, respectively, of the asynchronous 
+ * operation while it is proceeding.  When the request is queued, the error status 
+ * for the operation is [EINPROGRESS]. When all data has been successfully 
+ * transferred, the error status shall be reset to reflect the success or failure 
+ * of the operation.
+ */
+int		aio_fsync( int op, 
+				   struct aiocb * aiocbp );
+				   
+/*
+ * Read aiocbp->aio_nbytes from the file associated with aiocbp->aio_fildes into 
+ * the buffer pointed to by aiocbp->aio_buf.  The function call shall return when 
+ * the read request has been initiated or queued.
+ * The aiocbp value may be used as an argument to aio_error() and aio_return() in 
+ * order to determine the error status and return status, respectively, of the 
+ * asynchronous operation while it is proceeding. If an error condition is 
+ * encountered during queuing, the function call shall return without having 
+ * initiated or queued the request. The requested operation takes place at the 
+ * absolute position in the file as given by aio_offset, as if lseek() were called 
+ * immediately prior to the operation with an offset equal to aio_offset and a 
+ * whence equal to SEEK_SET.  After a successful call to enqueue an asynchronous 
+ * I/O operation, the value of the file offset for the file is unspecified.
+ */
+int		aio_read( struct aiocb * aiocbp );
+
+/*
+ * Return the return status associated with the aiocb structure referenced by 
+ * the aiocbp argument.  The return status for an asynchronous I/O operation is 
+ * the value that would be returned by the corresponding read(), write(), or 
+ * fsync() function call.  If the error status for the operation is equal to 
+ * [EINPROGRESS], then the return status for the operation is undefined.  The 
+ * aio_return() function may be called exactly once to retrieve the return status 
+ * of a given asynchronous operation; thereafter, if the same aiocb structure 
+ * is used in a call to aio_return() or aio_error(), an error may be returned. 
+ * When the aiocb structure referred to by aiocbp is used to submit another
+ * asynchronous operation, then aio_return() may be successfully used to 
+ * retrieve the return status of that operation.
+ */
+ssize_t	aio_return( struct aiocb * aiocbp );
+
+/*
+ * Suspend the calling thread until at least one of the asynchronous I/O 
+ * operations referenced by the aiocblist argument has completed, until a signal 
+ * interrupts the function, or, if timeout is not NULL, until the time 
+ * interval specified by timeout has passed.  If any of the aiocb structures 
+ * in the aiocblist correspond to completed asynchronous I/O operations (that is, 
+ * the error status for the operation is not equal to [EINPROGRESS]) at the 
+ * time of the call, the function shall return without suspending the calling 
+ * thread.  The aiocblist argument is an array of pointers to asynchronous I/O 
+ * control blocks.  The nent argument indicates the number of elements in the 
+ * array.  Each aiocb structure pointed to has been used in initiating an 
+ * asynchronous I/O request via aio_read(), aio_write(), or lio_listio(). This 
+ * array may contain NULL pointers, which are ignored.
+ */
+int		aio_suspend( const struct aiocb *const aiocblist[], 
+					 int nent,
+	 				 const struct timespec * timeoutp ) __DARWIN_ALIAS_C(aio_suspend);
+	 				 
+/*
+ * Write aiocbp->aio_nbytes to the file associated with aiocbp->aio_fildes from 
+ * the buffer pointed to by aiocbp->aio_buf.  The function shall return when the 
+ * write request has been initiated or, at a minimum, queued.
+ * The aiocbp argument may be used as an argument to aio_error() and aio_return() 
+ * in order to determine the error status and return status, respectively, of the 
+ * asynchronous operation while it is proceeding.
+ */
+int		aio_write( struct aiocb * aiocbp );
+
+/*
+ * Initiate a list of I/O requests with a single function call.  The mode 
+ * argument takes one of the values LIO_WAIT or LIO_NOWAIT and determines whether 
+ * the function returns when the I/O operations have been completed, or as soon 
+ * as the operations have been queued.  If the mode argument is LIO_WAIT, the 
+ * function shall wait until all I/O is complete and the sig argument shall be 
+ * ignored. 
+ * If the mode argument is LIO_NOWAIT, the function shall return immediately, and 
+ * asynchronous notification shall occur, according to the sig argument, when all 
+ * the I/O operations complete.  If sig is NULL, then no asynchronous notification
+ * shall occur.
+ */
+int		lio_listio( int mode, 
+					struct aiocb *const aiocblist[],
+	 				int nent, 
+	 				struct sigevent *sigp );
+__END_DECLS
+
+#endif /* _SYS_AIO_H_ */
diff -Nur cctools-877.5/include/sys/appleapiopts.h cctools-877.5-AnV/include/sys/appleapiopts.h
--- cctools-877.5/include/sys/appleapiopts.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/appleapiopts.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,62 @@
+/*
+ * Copyright (c) 2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef __SYS_APPLEAPIOPTS_H__
+#define __SYS_APPLEAPIOPTS_H__
+
+
+#ifndef __APPLE_API_STANDARD
+#define __APPLE_API_STANDARD
+#endif /* __APPLE_API_STANDARD */
+
+#ifndef __APPLE_API_STABLE
+#define __APPLE_API_STABLE
+#endif /* __APPLE_API_STABLE */
+
+#ifndef __APPLE_API_STRICT_CONFORMANCE
+
+#ifndef __APPLE_API_EVOLVING
+#define __APPLE_API_EVOLVING
+#endif /* __APPLE_API_EVOLVING */
+
+#ifndef __APPLE_API_UNSTABLE
+#define __APPLE_API_UNSTABLE
+#endif /* __APPLE_API_UNSTABLE */
+
+#ifndef __APPLE_API_PRIVATE
+#define __APPLE_API_PRIVATE
+#endif /* __APPLE_API_PRIVATE */
+
+#ifndef __APPLE_API_OBSOLETE
+#define __APPLE_API_OBSOLETE
+#endif /* __APPLE_API_OBSOLETE */
+
+#endif /* __APPLE_API_STRICT_CONFORMANCE */
+
+#endif /* __SYS_APPLEAPIOPTS_H__ */
+
diff -Nur cctools-877.5/include/sys/attr.h cctools-877.5-AnV/include/sys/attr.h
--- cctools-877.5/include/sys/attr.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/attr.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,479 @@
+/*
+ * Copyright (c) 2000-2010 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+/*
+ * attr.h - attribute data structures and interfaces
+ *
+ * Copyright (c) 1998, Apple Computer, Inc.  All Rights Reserved.
+ */
+
+#ifndef _SYS_ATTR_H_
+#define _SYS_ATTR_H_
+
+#include <sys/appleapiopts.h>
+
+#ifdef __APPLE_API_UNSTABLE
+#include <sys/types.h>
+#include <sys/ucred.h>
+#include <sys/time.h>
+#include <sys/cdefs.h>
+
+#define FSOPT_NOFOLLOW 		0x00000001
+#define FSOPT_NOINMEMUPDATE 	0x00000002
+#define FSOPT_REPORT_FULLSIZE	0x00000004
+/* The following option only valid when requesting ATTR_CMN_RETURNED_ATTRS */
+#define FSOPT_PACK_INVAL_ATTRS	0x00000008
+
+
+#define FSOPT_ATTR_CMN_EXTENDED	0x00000020
+
+/* we currently aren't anywhere near this amount for a valid
+ * fssearchblock.sizeofsearchparams1 or fssearchblock.sizeofsearchparams2
+ * but we put a sanity check in to avoid abuse of the value passed in from
+ * user land.
+ */
+#define SEARCHFS_MAX_SEARCHPARMS  4096
+
+typedef u_int32_t text_encoding_t;
+
+typedef u_int32_t fsobj_type_t;
+
+typedef u_int32_t fsobj_tag_t;
+
+typedef u_int32_t fsfile_type_t;
+
+typedef u_int32_t fsvolid_t;
+
+typedef struct fsobj_id {
+	u_int32_t		fid_objno;
+	u_int32_t		fid_generation;
+} fsobj_id_t;
+
+typedef u_int32_t attrgroup_t;
+
+struct attrlist {
+	u_short bitmapcount;			/* number of attr. bit sets in list (should be 5) */
+	u_int16_t reserved;			/* (to maintain 4-byte alignment) */
+	attrgroup_t commonattr;			/* common attribute group */
+	attrgroup_t volattr;			/* Volume attribute group */
+	attrgroup_t dirattr;			/* directory attribute group */
+	attrgroup_t fileattr;			/* file attribute group */
+	attrgroup_t forkattr;			/* fork attribute group */
+};
+#define ATTR_BIT_MAP_COUNT 5
+
+typedef struct attribute_set {
+	attrgroup_t commonattr;			/* common attribute group */
+	attrgroup_t volattr;			/* Volume attribute group */
+	attrgroup_t dirattr;			/* directory attribute group */
+	attrgroup_t fileattr;			/* file attribute group */
+	attrgroup_t forkattr;			/* fork attribute group */
+} attribute_set_t;
+
+typedef struct attrreference {
+	int32_t     attr_dataoffset;
+	u_int32_t   attr_length;
+} attrreference_t;
+
+/* XXX PPD This is derived from HFSVolumePriv.h and should perhaps be referenced from there? */
+
+struct diskextent {
+	u_int32_t					startblock;				/* first block allocated */
+	u_int32_t					blockcount;				/* number of blocks allocated */
+};
+
+typedef struct diskextent extentrecord[8];
+
+typedef u_int32_t vol_capabilities_set_t[4];
+
+#define VOL_CAPABILITIES_FORMAT 0
+#define VOL_CAPABILITIES_INTERFACES 1
+#define VOL_CAPABILITIES_RESERVED1 2
+#define VOL_CAPABILITIES_RESERVED2 3
+
+typedef struct vol_capabilities_attr {
+	vol_capabilities_set_t capabilities;
+	vol_capabilities_set_t valid;
+} vol_capabilities_attr_t;
+
+/*
+ * XXX this value needs to be raised - 3893388
+ */
+#define ATTR_MAX_BUFFER		8192
+
+/*
+ * VOL_CAP_FMT_PERSISTENTOBJECTIDS: When set, the volume has object IDs
+ * that are persistent (retain their values even when the volume is
+ * unmounted and remounted), and a file or directory can be looked up
+ * by ID.  Volumes that support VolFS and can support Carbon File ID
+ * references should set this bit.
+ *
+ * VOL_CAP_FMT_SYMBOLICLINKS: When set, the volume supports symbolic
+ * links.  The symlink(), readlink(), and lstat() calls all use this
+ * symbolic link.
+ *
+ * VOL_CAP_FMT_HARDLINKS: When set, the volume supports hard links.
+ * The link() call creates hard links.
+ *
+ * VOL_CAP_FMT_JOURNAL: When set, the volume is capable of supporting
+ * a journal used to speed recovery in case of unplanned shutdown
+ * (such as a power outage or crash).  This bit does not necessarily
+ * mean the volume is actively using a journal for recovery.
+ *
+ * VOL_CAP_FMT_JOURNAL_ACTIVE: When set, the volume is currently using
+ * a journal for use in speeding recovery after an unplanned shutdown.
+ * This bit can be set only if VOL_CAP_FMT_JOURNAL is also set.
+ *
+ * VOL_CAP_FMT_NO_ROOT_TIMES: When set, the volume format does not
+ * store reliable times for the root directory, so you should not
+ * depend on them to detect changes, etc.
+ *
+ * VOL_CAP_FMT_SPARSE_FILES: When set, the volume supports sparse files.
+ * That is, files which can have "holes" that have never been written
+ * to, and are not allocated on disk.  Sparse files may have an
+ * allocated size that is less than the file's logical length.
+ *
+ * VOL_CAP_FMT_ZERO_RUNS: For security reasons, parts of a file (runs)
+ * that have never been written to must appear to contain zeroes.  When
+ * this bit is set, the volume keeps track of allocated but unwritten
+ * runs of a file so that it can substitute zeroes without actually
+ * writing zeroes to the media.  This provides performance similar to
+ * sparse files, but not the space savings.
+ *
+ * VOL_CAP_FMT_CASE_SENSITIVE: When set, file and directory names are
+ * case sensitive (upper and lower case are different).  When clear,
+ * an upper case character is equivalent to a lower case character,
+ * and you can't have two names that differ solely in the case of
+ * the characters.
+ *
+ * VOL_CAP_FMT_CASE_PRESERVING: When set, file and directory names
+ * preserve the difference between upper and lower case.  If clear,
+ * the volume may change the case of some characters (typically
+ * making them all upper or all lower case).  A volume that sets
+ * VOL_CAP_FMT_CASE_SENSITIVE should also set VOL_CAP_FMT_CASE_PRESERVING.
+ *
+ * VOL_CAP_FMT_FAST_STATFS: This bit is used as a hint to upper layers
+ * (especially Carbon) that statfs() is fast enough that its results
+ * need not be cached by those upper layers.  A volume that caches
+ * the statfs information in its in-memory structures should set this bit.
+ * A volume that must always read from disk or always perform a network
+ * transaction should not set this bit.  
+ * 
+ * VOL_CAP_FMT_2TB_FILESIZE: If this bit is set the volume format supports
+ * file sizes larger than 4GB, and potentially up to 2TB; it does not
+ * indicate whether the filesystem supports files larger than that.
+ *
+ * VOL_CAP_FMT_OPENDENYMODES: When set, the volume supports open deny
+ * modes (e.g. "open for read write, deny write"; effectively, mandatory
+ * file locking based on open modes).
+ *
+ * VOL_CAP_FMT_HIDDEN_FILES: When set, the volume supports the UF_HIDDEN
+ * file flag, and the UF_HIDDEN flag is mapped to that volume's native
+ * "hidden" or "invisible" bit (which may be the invisible bit from the
+ * Finder Info extended attribute).
+ *
+ * VOL_CAP_FMT_PATH_FROM_ID:  When set, the volume supports the ability
+ * to derive a pathname to the root of the file system given only the
+ * id of an object.  This also implies that object ids on this file
+ * system are persistent and not recycled.  This is a very specialized
+ * capability and it is assumed that most file systems will not support
+ * it.  Its use is for legacy non-posix APIs like ResolveFileIDRef.
+ * 
+ * VOL_CAP_FMT_NO_VOLUME_SIZES: When set, the volume does not support 
+ * returning values for total data blocks, available blocks, or free blocks
+ * (as in f_blocks, f_bavail, or f_bfree in "struct statfs").  Historically,
+ * those values were set to 0xFFFFFFFF for volumes that did not support them.
+ * 
+ * VOL_CAP_FMT_DECMPFS_COMPRESSION: When set, the volume supports transparent
+ * decompression of compressed files using decmpfs.
+ *
+ * VOL_CAP_FMT_64BIT_OBJECT_IDS: When set, the volume uses object IDs that
+ * are 64-bit. This means that ATTR_CMN_FILEID and ATTR_CMN_PARENTID are the
+ * only legitimate attributes for obtaining object IDs from this volume and the
+ * 32-bit fid_objno fields of the fsobj_id_t returned by ATTR_CMN_OBJID,
+ * ATTR_CMN_OBJPERMID, and ATTR_CMN_PAROBJID are undefined.
+ */
+#define VOL_CAP_FMT_PERSISTENTOBJECTIDS		0x00000001
+#define VOL_CAP_FMT_SYMBOLICLINKS 		0x00000002
+#define VOL_CAP_FMT_HARDLINKS      		0x00000004
+#define VOL_CAP_FMT_JOURNAL       		0x00000008
+#define VOL_CAP_FMT_JOURNAL_ACTIVE 		0x00000010
+#define VOL_CAP_FMT_NO_ROOT_TIMES 		0x00000020
+#define VOL_CAP_FMT_SPARSE_FILES 		0x00000040
+#define VOL_CAP_FMT_ZERO_RUNS     		0x00000080
+#define VOL_CAP_FMT_CASE_SENSITIVE 		0x00000100
+#define VOL_CAP_FMT_CASE_PRESERVING		0x00000200
+#define VOL_CAP_FMT_FAST_STATFS 		0x00000400
+#define VOL_CAP_FMT_2TB_FILESIZE		0x00000800
+#define VOL_CAP_FMT_OPENDENYMODES		0x00001000
+#define VOL_CAP_FMT_HIDDEN_FILES		0x00002000
+#define VOL_CAP_FMT_PATH_FROM_ID		0x00004000
+#define VOL_CAP_FMT_NO_VOLUME_SIZES		0x00008000
+#define VOL_CAP_FMT_DECMPFS_COMPRESSION		0x00010000
+#define VOL_CAP_FMT_64BIT_OBJECT_IDS		0x00020000
+
+
+/*
+ * VOL_CAP_INT_SEARCHFS: When set, the volume implements the
+ * searchfs() system call (the vnop_searchfs vnode operation).
+ *
+ * VOL_CAP_INT_ATTRLIST: When set, the volume implements the
+ * getattrlist() and setattrlist() system calls (vnop_getattrlist
+ * and vnop_setattrlist vnode operations) for the volume, files,
+ * and directories.  The volume may or may not implement the
+ * readdirattr() system call.  XXX Is there any minimum set
+ * of attributes that should be supported?  To determine the
+ * set of supported attributes, get the ATTR_VOL_ATTRIBUTES
+ * attribute of the volume.
+ *
+ * VOL_CAP_INT_NFSEXPORT: When set, the volume implements exporting
+ * of NFS volumes.
+ *
+ * VOL_CAP_INT_READDIRATTR: When set, the volume implements the
+ * readdirattr() system call (vnop_readdirattr vnode operation).
+ *
+ * VOL_CAP_INT_EXCHANGEDATA: When set, the volume implements the
+ * exchangedata() system call (VNOP_EXCHANGE vnode operation).
+ *
+ * VOL_CAP_INT_COPYFILE: When set, the volume implements the
+ * VOP_COPYFILE vnode operation.  (XXX There should be a copyfile()
+ * system call in <unistd.h>.)
+ *
+ * VOL_CAP_INT_ALLOCATE: When set, the volume implements the
+ * VNOP_ALLOCATE vnode operation, which means it implements the
+ * F_PREALLOCATE selector of fcntl(2).
+ *
+ * VOL_CAP_INT_VOL_RENAME: When set, the volume implements the
+ * ATTR_VOL_NAME attribute for both getattrlist() and setattrlist().
+ * The volume can be renamed by setting ATTR_VOL_NAME with setattrlist().
+ *
+ * VOL_CAP_INT_ADVLOCK: When set, the volume implements POSIX style
+ * byte range locks via vnop_advlock (accessible from fcntl(2)).
+ *
+ * VOL_CAP_INT_FLOCK: When set, the volume implements whole-file flock(2)
+ * style locks via vnop_advlock.  This includes the O_EXLOCK and O_SHLOCK
+ * flags of the open(2) call.
+ *
+ * VOL_CAP_INT_EXTENDED_SECURITY: When set, the volume implements
+ * extended security (ACLs).
+ *
+ * VOL_CAP_INT_USERACCESS:  When set, the volume supports the
+ * ATTR_CMN_USERACCESS attribute (used to get the user's access
+ * mode to the file).
+ *
+ * VOL_CAP_INT_MANLOCK: When set, the volume supports AFP-style
+ * mandatory byte range locks via an ioctl().
+ *
+ * VOL_CAP_INT_EXTENDED_ATTR: When set, the volume implements
+ * native extended attribues.
+ *
+ * VOL_CAP_INT_NAMEDSTREAMS: When set, the volume supports
+ * native named streams.
+ */
+#define VOL_CAP_INT_SEARCHFS			0x00000001
+#define VOL_CAP_INT_ATTRLIST			0x00000002
+#define VOL_CAP_INT_NFSEXPORT			0x00000004
+#define VOL_CAP_INT_READDIRATTR			0x00000008
+#define VOL_CAP_INT_EXCHANGEDATA		0x00000010
+#define VOL_CAP_INT_COPYFILE			0x00000020
+#define VOL_CAP_INT_ALLOCATE			0x00000040
+#define VOL_CAP_INT_VOL_RENAME			0x00000080
+#define VOL_CAP_INT_ADVLOCK			0x00000100
+#define VOL_CAP_INT_FLOCK			0x00000200
+#define VOL_CAP_INT_EXTENDED_SECURITY		0x00000400
+#define VOL_CAP_INT_USERACCESS			0x00000800
+#define VOL_CAP_INT_MANLOCK			0x00001000
+#define VOL_CAP_INT_NAMEDSTREAMS		0x00002000
+#define VOL_CAP_INT_EXTENDED_ATTR		0x00004000
+
+typedef struct vol_attributes_attr {
+	attribute_set_t validattr;
+	attribute_set_t nativeattr;
+} vol_attributes_attr_t;
+
+#define ATTR_CMN_NAME				0x00000001
+#define ATTR_CMN_DEVID				0x00000002
+#define ATTR_CMN_FSID				0x00000004
+#define ATTR_CMN_OBJTYPE			0x00000008
+#define ATTR_CMN_OBJTAG				0x00000010
+#define ATTR_CMN_OBJID				0x00000020
+#define ATTR_CMN_OBJPERMANENTID			0x00000040
+#define ATTR_CMN_PAROBJID			0x00000080
+#define ATTR_CMN_SCRIPT				0x00000100
+#define ATTR_CMN_CRTIME				0x00000200
+#define ATTR_CMN_MODTIME			0x00000400
+#define ATTR_CMN_CHGTIME			0x00000800
+#define ATTR_CMN_ACCTIME			0x00001000
+#define ATTR_CMN_BKUPTIME			0x00002000
+#define ATTR_CMN_FNDRINFO			0x00004000
+#define ATTR_CMN_OWNERID			0x00008000
+#define ATTR_CMN_GRPID				0x00010000
+#define ATTR_CMN_ACCESSMASK			0x00020000
+#define ATTR_CMN_FLAGS				0x00040000
+
+/* The following were defined as:				*/
+/*  	#define ATTR_CMN_NAMEDATTRCOUNT		0x00080000	*/
+/* 	#define ATTR_CMN_NAMEDATTRLIST		0x00100000	*/
+/* These bits have been salvaged for use as:			*/
+/*	#define ATTR_CMN_GEN_COUNT		0x00080000	*/
+/*	#define ATTR_CMN_DOCUMENT_ID		0x00100000	*/
+/* They can only be used with the  FSOPT_ATTR_CMN_EXTENDED	*/
+/* option flag.                                           	*/
+
+#define ATTR_CMN_GEN_COUNT			0x00080000
+#define ATTR_CMN_DOCUMENT_ID			0x00100000
+
+#define ATTR_CMN_USERACCESS			0x00200000
+#define ATTR_CMN_EXTENDED_SECURITY		0x00400000
+#define ATTR_CMN_UUID				0x00800000
+#define ATTR_CMN_GRPUUID			0x01000000
+#define ATTR_CMN_FILEID				0x02000000
+#define ATTR_CMN_PARENTID			0x04000000
+#define ATTR_CMN_FULLPATH			0x08000000
+#define ATTR_CMN_ADDEDTIME			0x10000000
+#define ATTR_CMN_ERROR				0x20000000
+#define ATTR_CMN_DATA_PROTECT_FLAGS		0x40000000
+
+/*
+ * ATTR_CMN_RETURNED_ATTRS is only valid with getattrlist(2) and
+ * getattrlistbulk(2). It is always the first attribute in the return buffer.
+ */
+#define ATTR_CMN_RETURNED_ATTRS 		0x80000000	
+
+#define ATTR_CMN_VALIDMASK			0xFFFFFFFF
+#define ATTR_CMN_SETMASK			0x01C7FF00
+#define ATTR_CMN_VOLSETMASK			0x00006700
+
+#define ATTR_VOL_FSTYPE				0x00000001
+#define ATTR_VOL_SIGNATURE			0x00000002
+#define ATTR_VOL_SIZE				0x00000004
+#define ATTR_VOL_SPACEFREE			0x00000008
+#define ATTR_VOL_SPACEAVAIL			0x00000010
+#define ATTR_VOL_MINALLOCATION			0x00000020
+#define ATTR_VOL_ALLOCATIONCLUMP		0x00000040
+#define ATTR_VOL_IOBLOCKSIZE			0x00000080
+#define ATTR_VOL_OBJCOUNT			0x00000100
+#define ATTR_VOL_FILECOUNT			0x00000200
+#define ATTR_VOL_DIRCOUNT			0x00000400
+#define ATTR_VOL_MAXOBJCOUNT			0x00000800
+#define ATTR_VOL_MOUNTPOINT			0x00001000
+#define ATTR_VOL_NAME				0x00002000
+#define ATTR_VOL_MOUNTFLAGS			0x00004000
+#define ATTR_VOL_MOUNTEDDEVICE			0x00008000
+#define ATTR_VOL_ENCODINGSUSED			0x00010000
+#define ATTR_VOL_CAPABILITIES			0x00020000
+#define ATTR_VOL_UUID				0x00040000
+#define ATTR_VOL_ATTRIBUTES			0x40000000
+#define ATTR_VOL_INFO				0x80000000
+
+#define ATTR_VOL_VALIDMASK			0xC007FFFF
+#define ATTR_VOL_SETMASK			0x80002000
+
+
+/* File/directory attributes: */
+#define ATTR_DIR_LINKCOUNT			0x00000001
+#define ATTR_DIR_ENTRYCOUNT			0x00000002
+#define ATTR_DIR_MOUNTSTATUS			0x00000004
+/* ATTR_DIR_MOUNTSTATUS Flags: */
+#define	  DIR_MNTSTATUS_MNTPOINT		0x00000001
+#define	  DIR_MNTSTATUS_TRIGGER			0x00000002
+
+#define ATTR_DIR_VALIDMASK			0x00000007
+#define ATTR_DIR_SETMASK			0x00000000
+
+#define ATTR_FILE_LINKCOUNT			0x00000001
+#define ATTR_FILE_TOTALSIZE			0x00000002
+#define ATTR_FILE_ALLOCSIZE			0x00000004
+#define ATTR_FILE_IOBLOCKSIZE			0x00000008
+#define ATTR_FILE_DEVTYPE			0x00000020
+#define ATTR_FILE_FORKCOUNT			0x00000080
+#define ATTR_FILE_FORKLIST			0x00000100
+#define ATTR_FILE_DATALENGTH			0x00000200
+#define ATTR_FILE_DATAALLOCSIZE			0x00000400
+#define ATTR_FILE_RSRCLENGTH			0x00001000
+#define ATTR_FILE_RSRCALLOCSIZE			0x00002000
+
+#define ATTR_FILE_VALIDMASK			0x000037FF
+#define ATTR_FILE_SETMASK			0x00000020
+
+#define ATTR_FORK_TOTALSIZE			0x00000001
+#define ATTR_FORK_ALLOCSIZE			0x00000002
+
+#define ATTR_FORK_VALIDMASK			0x00000003
+#define ATTR_FORK_SETMASK			0x00000000
+
+/* Obsolete, implemented, not supported */
+#define ATTR_CMN_NAMEDATTRCOUNT			0x00080000
+#define ATTR_CMN_NAMEDATTRLIST			0x00100000
+#define ATTR_FILE_CLUMPSIZE			0x00000010	/* obsolete */
+#define ATTR_FILE_FILETYPE			0x00000040	/* always zero */
+#define ATTR_FILE_DATAEXTENTS			0x00000800	/* obsolete, HFS-specific */
+#define ATTR_FILE_RSRCEXTENTS			0x00004000	/* obsolete, HFS-specific */
+
+/* Required attributes for getattrlistbulk(2) */
+#define ATTR_BULK_REQUIRED (ATTR_CMN_NAME | ATTR_CMN_RETURNED_ATTRS)
+
+/*
+ * Searchfs
+ */
+#define SRCHFS_START 				0x00000001
+#define SRCHFS_MATCHPARTIALNAMES 		0x00000002
+#define SRCHFS_MATCHDIRS 			0x00000004
+#define SRCHFS_MATCHFILES 			0x00000008
+#define SRCHFS_SKIPLINKS 			0x00000010
+#define SRCHFS_SKIPINVISIBLE			0x00000020
+#define SRCHFS_SKIPPACKAGES			0x00000040
+#define SRCHFS_SKIPINAPPROPRIATE		0x00000080
+
+#define SRCHFS_NEGATEPARAMS 			0x80000000
+#define SRCHFS_VALIDOPTIONSMASK			0x800000FF
+
+struct fssearchblock {
+	struct attrlist		*returnattrs;
+	void				*returnbuffer;
+	size_t				returnbuffersize;
+	u_long				maxmatches;
+	struct timeval		timelimit;
+	void				*searchparams1;
+	size_t				sizeofsearchparams1;
+	void				*searchparams2;
+	size_t				sizeofsearchparams2;
+	struct attrlist		searchattrs;
+};
+
+
+struct searchstate {
+	uint32_t			ss_union_flags;		// for SRCHFS_START
+	uint32_t			ss_union_layer;		// 0 = top
+	u_char				ss_fsstate[548];	// fs private
+} __attribute__((packed));
+
+#define FST_EOF (-1)				/* end-of-file offset */
+
+#endif /* __APPLE_API_UNSTABLE */
+#endif /* !_SYS_ATTR_H_ */
diff -Nur cctools-877.5/include/sys/buf.h cctools-877.5-AnV/include/sys/buf.h
--- cctools-877.5/include/sys/buf.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/buf.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,1064 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1989, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)buf.h	8.9 (Berkeley) 3/30/95
+ */
+
+#ifndef _SYS_BUF_H_
+#define	_SYS_BUF_H_
+
+#include <sys/cdefs.h>
+#include <sys/kernel_types.h>
+#include <sys/ucred.h>
+#include <mach/memory_object_types.h>
+
+
+#define	B_WRITE		0x00000000	/* Write buffer (pseudo flag). */
+#define	B_READ		0x00000001	/* Read buffer. */
+#define	B_ASYNC		0x00000002	/* Start I/O, do not wait. */
+#define	B_NOCACHE	0x00000004	/* Do not cache block after use. */
+#define	B_DELWRI	0x00000008	/* Delay I/O until buffer reused. */
+#define	B_LOCKED	0x00000010	/* Locked in core (not reusable). */
+#define	B_PHYS		0x00000020	/* I/O to user memory. */
+#define B_CLUSTER	0x00000040	/* UPL based I/O generated by cluster layer */
+#define	B_PAGEIO	0x00000080	/* Page in/out */
+#define	B_META		0x00000100	/* buffer contains meta-data. */
+#define	B_RAW		0x00000200	/* Set by physio for raw transfers. */
+#define	B_FUA		0x00000400	/* Write-through disk cache(if supported) */
+#define B_PASSIVE	0x00000800	/* PASSIVE I/Os are ignored by THROTTLE I/O */
+#define	B_IOSTREAMING	0x00001000	/* sequential access pattern detected */
+#define B_THROTTLED_IO	0x00002000	/* low priority I/O (deprecated) */
+#define B_ENCRYPTED_IO	0x00004000	/* Encrypted I/O */
+#define B_STATICCONTENT 0x00008000	/* Buffer is likely to remain unaltered */
+
+/*
+ * make sure to check when adding flags that
+ * that the new flags don't overlap the definitions
+ * in buf_internal.h
+ */
+
+__BEGIN_DECLS
+
+/*!
+ @function buf_markaged
+ @abstract Mark a buffer as "aged," i.e. as a good candidate to be discarded and reused after buf_brelse().
+ @param bp Buffer to mark.
+ */
+void	buf_markaged(buf_t);
+
+/*!
+ @function buf_markinvalid
+ @abstract Mark a buffer as not having valid data and being ready for immediate reuse after buf_brelse().
+ @param bp Buffer to mark.
+ */
+void	buf_markinvalid(buf_t);
+
+/*!
+ @function buf_markdelayed
+ @abstract Mark a buffer as a delayed write: mark it dirty without actually scheduling I/O.
+ @discussion Data will be flushed to disk at some later time, not with brelse(). A sync()/fsync()
+ or pressure necessitating reuse of the buffer will cause it to be written back to disk.
+ @param bp Buffer to mark.
+ */
+void	buf_markdelayed(buf_t);
+
+void	buf_markclean(buf_t);
+
+/*!
+ @function buf_markeintr
+ @abstract Mark a buffer as having been interrupted during I/O.
+ @discussion Waiters for I/O to complete (buf_biowait()) will return with EINTR when woken up.  
+ buf_markeintr does not itself do a wakeup.
+ @param bp Buffer to mark.
+ */
+void	buf_markeintr(buf_t);
+
+/*!
+ @function buf_markfua
+ @abstract Mark a buffer for write through disk cache, if disk supports it.
+ @param bp Buffer to mark.
+ */
+void	buf_markfua(buf_t);
+
+/*!
+ @function buf_fua
+ @abstract Check if a buffer is marked for write through disk caches.
+ @param bp Buffer to test.
+ @return Nonzero if buffer is marked for write-through, 0 if not.
+ */
+int	buf_fua(buf_t);
+
+/*!
+ @function buf_valid
+ @abstract Check if a buffer contains valid data.
+ @param bp Buffer to test.
+ @return Nonzero if buffer has valid data, 0 if not.
+ */
+int	buf_valid(buf_t);
+
+/*!
+ @function buf_fromcache
+ @abstract Check if a buffer's data was found in core.
+ @discussion Will return truth after a buf_getblk that finds a valid buffer in the cache or the relevant
+ data in core (but not in a buffer).
+ @param bp Buffer to test.
+ @return Nonzero if we got this buffer's data without doing I/O, 0 if not.
+ */
+int	buf_fromcache(buf_t);
+
+/*!
+ @function buf_upl
+ @abstract Get the upl (Universal Page List) associated with a buffer.
+ @discussion Buffers allocated with buf_alloc() are not returned with a upl, and
+ traditional buffers only have a upl while an I/O is in progress.
+ @param bp Buffer whose upl to grab.
+ @return Buffer's upl if it has one, else NULL.
+ */
+void *	buf_upl(buf_t);
+
+/*!
+ @function buf_uploffset
+ @abstract Get the offset into a UPL at which this buffer begins.
+ @discussion This function should only be called on iobufs, i.e. buffers allocated with buf_alloc().
+ @param bp Buffer whose uploffset to grab.
+ @return Buffer's uploffset--does not check whether that value makes sense for this buffer.
+ */
+uint32_t buf_uploffset(buf_t);
+
+/*!
+ @function buf_rcred
+ @abstract Get the credential associated with a buffer for reading.
+ @discussion No reference is taken; if the credential is to be held on to persistently, an additional
+ reference must be taken with kauth_cred_ref.
+ @param bp Buffer whose credential to grab.
+ @return Credential if it exists, else NULL.
+ */
+kauth_cred_t buf_rcred(buf_t);
+
+/*!
+ @function buf_wcred
+ @abstract Get the credential associated with a buffer for writing.
+ @discussion No reference is taken; if the credential is to be held on to persistently, an additional
+ reference must be taken with kauth_cred_ref.
+ @param bp Buffer whose credential to grab.
+ @return Credential if it exists, else NULL.
+ */
+kauth_cred_t buf_wcred(buf_t);
+
+/*!
+ @function buf_proc
+ @abstract Get the process associated with this buffer.
+ @discussion buf_proc() will generally return NULL; a process is currently only associated with
+ a buffer in the event of a physio() call.  
+ @param bp Buffer whose associated process to find.
+ @return Associated process, possibly NULL.
+ */
+proc_t	buf_proc(buf_t);
+
+/*!
+ @function buf_dirtyoff
+ @abstract Get the starting offset of the dirty region associated with a buffer.
+ @discussion The dirty offset is zero unless someone explicitly calls buf_setdirtyoff() (which the kernel does not).
+ @param bp Buffer whose dirty offset to get.
+ @return Dirty offset (0 if not explicitly changed).
+ */
+uint32_t buf_dirtyoff(buf_t);
+
+/*!
+ @function buf_dirtyend
+ @abstract Get the ending offset of the dirty region associated with a buffer.
+ @discussion If the buffer's data was found incore and dirty, the dirty end is the size of the block; otherwise, unless
+ someone outside of xnu explicitly changes it by calling buf_setdirtyend(), it will be zero.
+ @param bp Buffer whose dirty end to get.
+ @return 0 if buffer is found clean; size of buffer if found dirty.  Can be set to any value by callers of buf_setdirtyend().
+ */
+uint32_t buf_dirtyend(buf_t);
+
+/*!
+ @function buf_setdirtyoff
+ @abstract Set the starting offset of the dirty region associated with a buffer.
+ @discussion This value is zero unless someone set it explicitly.
+ @param bp Buffer whose dirty end to set.
+ @return void.
+ */
+void	buf_setdirtyoff(buf_t, uint32_t);
+
+/*!
+ @function buf_setdirtyend
+ @abstract Set the ending offset of the dirty region associated with a buffer.
+ @discussion If the buffer's data was found incore and dirty, the dirty end is the size of the block; otherwise, unless
+ someone outside of xnu explicitly changes it by calling buf_setdirtyend(), it will be zero.
+ @param bp Buffer whose dirty end to set.
+ @return void.
+ */
+void	buf_setdirtyend(buf_t, uint32_t);
+
+/*!
+ @function buf_error
+ @abstract Get the error value associated with a buffer.
+ @discussion Errors are set with buf_seterror().
+ @param bp Buffer whose error value to retrieve.
+ @return Error value, directly.
+ */
+errno_t	buf_error(buf_t);
+
+/*!
+ @function buf_seterror
+ @abstract Set an error value on a buffer.
+ @param bp Buffer whose error value to set.
+ @return void.
+ */
+void	buf_seterror(buf_t, errno_t);
+
+/*!
+ @function buf_setflags
+ @abstract Set flags on a buffer.
+ @discussion buffer_flags |= flags
+ @param bp Buffer whose flags to set.
+ @param flags Flags to add to buffer's mask. B_LOCKED/B_NOCACHE/B_ASYNC/B_READ/B_WRITE/B_PAGEIO/B_FUA
+ @return void.
+ */
+void	buf_setflags(buf_t, int32_t);
+
+/*!
+ @function buf_clearflags
+ @abstract Clear flags on a buffer.
+ @discussion buffer_flags &= ~flags
+ @param bp Buffer whose flags to clear.
+ @param flags Flags to remove from buffer's mask. B_LOCKED/B_NOCACHE/B_ASYNC/B_READ/B_WRITE/B_PAGEIO/B_FUA
+ @return void.
+ */
+void	buf_clearflags(buf_t, int32_t);
+
+/*!
+ @function buf_flags
+ @abstract Get flags set on a buffer.
+ @discussion Valid flags are B_LOCKED/B_NOCACHE/B_ASYNC/B_READ/B_WRITE/B_PAGEIO/B_FUA.
+ @param bp Buffer whose flags to grab.
+ @return flags.
+ */
+int32_t	buf_flags(buf_t);
+
+/*!
+ @function buf_reset
+ @abstract Reset I/O flag state on a buffer.
+ @discussion Clears current flags on a buffer (internal and external) and allows some new flags to be set.
+ Used perhaps to prepare an iobuf for reuse.
+ @param bp Buffer whose flags to grab.  
+ @param flags Flags to set on buffer: B_READ, B_WRITE, B_ASYNC, B_NOCACHE.
+ @return void.
+ */
+void	buf_reset(buf_t, int32_t);
+
+/*!
+ @function buf_map
+ @abstract Get virtual mappings for buffer data.
+ @discussion For buffers created through buf_getblk() (i.e. traditional buffer cache usage), 
+ buf_map() just returns the address at which data was mapped by but_getblk().  For a B_CLUSTER buffer, i.e. an iobuf
+ whose upl state is managed manually, there are two possibilities.  If the buffer was created
+ with an underlying "real" buffer through cluster_bp(), the mapping of the "real" buffer is returned.
+ Otherwise, the buffer was created with buf_alloc() and buf_setupl() was subsequently called; buf_map()
+ will call ubc_upl_map() to get a mapping for the buffer's upl and return the start of that mapping
+ plus the buffer's upl offset (set in buf_setupl()).  In the last case, buf_unmap() must later be called
+ to tear down the mapping.  NOTE: buf_map() does not set the buffer data pointer; this must be done with buf_setdataptr().
+ @param bp Buffer whose mapping to find or create.
+ @param io_addr Destination for mapping address.
+ @return 0 for success, ENOMEM if unable to map the buffer.
+ */
+errno_t	buf_map(buf_t, caddr_t *);
+
+/*!
+ @function buf_unmap
+ @abstract Release mappings for buffer data.
+ @discussion For buffers created through buf_getblk() (i.e. traditional buffer cache usage), 
+ buf_unmap() does nothing; buf_brelse() will take care of unmapping.  For a B_CLUSTER buffer, i.e. an iobuf
+ whose upl state is managed manually, there are two possibilities.  If the buffer was created
+ with an underlying "real" buffer through cluster_bp(), buf_unmap() does nothing; buf_brelse() on the
+ underlying buffer will tear down the mapping. Otherwise, the buffer was created with buf_alloc() and 
+ buf_setupl() was subsequently called; buf_map() created the mapping.  In this case, buf_unmap() will
+ unmap the buffer.
+ @param bp Buffer whose mapping to find or create.
+ @param io_addr Destination for mapping address.
+ @return 0 for success, EINVAL if unable to unmap buffer.
+ */
+errno_t	buf_unmap(buf_t);
+
+/*!
+ @function buf_setdrvdata
+ @abstract Set driver-specific data on a buffer.
+ @param bp Buffer whose driver-data to set.
+ @param drvdata Opaque driver data.
+ @return void.
+ */
+void 	buf_setdrvdata(buf_t, void *);
+
+/*!
+ @function buf_setdrvdata
+ @abstract Get driver-specific data from a buffer.
+ @param bp Buffer whose driver data to get.
+ @return Opaque driver data.
+ */
+void *	buf_drvdata(buf_t);
+
+/*!
+ @function buf_setfsprivate
+ @abstract Set filesystem-specific data on a buffer.
+ @param bp Buffer whose filesystem data to set.
+ @param fsprivate Opaque filesystem data.
+ @return void.
+ */
+void 	buf_setfsprivate(buf_t, void *);
+
+/*!
+ @function buf_fsprivate
+ @abstract Get filesystem-specific data from a buffer.
+ @param bp Buffer whose filesystem data to get.
+ @return Opaque filesystem data.
+ */
+void *	buf_fsprivate(buf_t);
+
+/*!
+ @function buf_blkno
+ @abstract Get physical block number associated with a buffer, in the sense of VNOP_BLOCKMAP.
+ @discussion When a buffer's physical block number is the same is its logical block number, then the physical
+ block number is considered uninitialized.  A physical block number of -1 indicates that there is no valid
+ physical mapping (e.g. the logical block is invalid or corresponds to a sparse region in a file).  Physical
+ block number is normally set by the cluster layer or by buf_getblk().
+ @param bp Buffer whose physical block number to get.
+ @return Block number.
+ */
+daddr64_t buf_blkno(buf_t);
+
+/*!
+ @function buf_lblkno
+ @abstract Get logical block number associated with a buffer.
+ @discussion Logical block number is set on traditionally-used buffers by an argument passed to buf_getblk(),
+ for example by buf_bread().
+ @param bp Buffer whose logical block number to get.
+ @return Block number.
+ */
+daddr64_t buf_lblkno(buf_t);
+
+/*!
+ @function buf_setblkno
+ @abstract Set physical block number associated with a buffer.
+ @discussion Physical block number is generally set by the cluster layer or by buf_getblk().
+ @param bp Buffer whose physical block number to set.
+ @param blkno Block number to set.
+ @return void.
+ */
+void	buf_setblkno(buf_t, daddr64_t);
+
+/*!
+ @function buf_setlblkno
+ @abstract Set logical block number associated with a buffer.
+ @discussion Logical block number is set on traditionally-used buffers by an argument passed to buf_getblk(),
+ for example by buf_bread().
+ @param bp Buffer whose logical block number to set.
+ @param lblkno Block number to set.
+ @return void.
+ */
+void	buf_setlblkno(buf_t, daddr64_t);
+
+/*!
+ @function buf_count
+ @abstract Get count of valid bytes in a buffer.  This may be less than the space allocated to the buffer.
+ @param bp Buffer whose byte count to get.
+ @return Byte count.
+ */
+uint32_t buf_count(buf_t);
+
+/*!
+ @function buf_size
+ @abstract Get size of data region allocated to a buffer.
+ @discussion May be larger than amount of valid data in buffer.
+ @param bp Buffer whose size to get.
+ @return Size.
+ */
+uint32_t buf_size(buf_t);
+
+/*!
+ @function buf_resid
+ @abstract Get a count of bytes which were not consumed by an I/O on a buffer.
+ @discussion Set when an I/O operations completes.
+ @param bp Buffer whose outstanding count to get.
+ @return Count of unwritten/unread bytes.
+ */
+uint32_t buf_resid(buf_t);
+
+/*!
+ @function buf_setcount
+ @abstract Set count of valid bytes in a buffer.  This may be less than the space allocated to the buffer.
+ @param bp Buffer whose byte count to set.
+ @param bcount Count to set.
+ @return void.
+ */
+void	buf_setcount(buf_t, uint32_t);
+
+/*!
+ @function buf_setsize
+ @abstract Set size of data region allocated to a buffer.
+ @discussion May be larger than amount of valid data in buffer.  Should be used by 
+ code which is manually providing storage for an iobuf, one allocated with buf_alloc().
+ @param bp Buffer whose size to set.
+ @return void.
+ */
+void	buf_setsize(buf_t, uint32_t);
+
+/*!
+ @function buf_setresid
+ @abstract Set a count of bytes outstanding for I/O in a buffer.
+ @discussion Set when an I/O operations completes.  Examples: called by IOStorageFamily when I/O
+ completes, often called on an "original" buffer when using a manipulated buffer to perform I/O 
+ on behalf of the first.
+ @param bp Buffer whose outstanding count to set.
+ @return Count of unwritten/unread bytes.
+ */
+void	buf_setresid(buf_t, uint32_t);
+
+/*!
+ @function buf_setdataptr
+ @abstract Set the address at which a buffer's data will be stored.
+ @discussion In traditional buffer use, the data pointer will be set automatically. This routine is
+ useful with iobufs (allocated with buf_alloc()).
+ @param bp Buffer whose data pointer to set.
+ @param data Pointer to data region.
+ @return void.
+ */
+void	buf_setdataptr(buf_t, uintptr_t);
+
+/*!
+ @function buf_dataptr
+ @abstract Get the address at which a buffer's data is stored; for iobufs, this must
+ be set with buf_setdataptr().  See buf_map().
+ @param bp Buffer whose data pointer to retrieve.
+ @return Data pointer; NULL if unset.
+ */
+uintptr_t buf_dataptr(buf_t);
+
+/*!
+ @function buf_vnode
+ @abstract Get the vnode associated with a buffer.
+ @discussion Every buffer is associated with a file.  Because there is an I/O in flight,
+ there is an iocount on this vnode; it is returned WITHOUT an extra iocount, and vnode_put()
+ need NOT be called.
+ @param bp Buffer whose vnode to retrieve.
+ @return Buffer's vnode.
+ */
+vnode_t	buf_vnode(buf_t);
+
+/*!
+ @function buf_setvnode
+ @abstract Set the vnode associated with a buffer.
+ @discussion This call need not be used on traditional buffers; it is for use with iobufs.
+ @param bp Buffer whose vnode to set.
+ @param vp The vnode to attach to the buffer.
+ @return void.
+ */
+void	buf_setvnode(buf_t, vnode_t);
+
+/*!
+ @function buf_device
+ @abstract Get the device ID associated with a buffer.
+ @discussion In traditional buffer use, this value is NODEV until buf_strategy() is called unless
+ buf_getblk() was passed a device vnode.  It is set on an iobuf if buf_alloc() is passed a device 
+ vnode or if buf_setdevice() is called.
+ @param bp Buffer whose device ID to retrieve.
+ @return Device id.
+ */
+dev_t	buf_device(buf_t);
+
+/*!
+ @function buf_setdevice
+ @abstract Set the device associated with a buffer.
+ @discussion A buffer's device is set in buf_strategy() (or in buf_getblk() if the file is a device).  
+ It is also set on an iobuf if buf_alloc() is passed a device vnode.
+ @param bp Buffer whose device ID to set.
+ @param vp Device to set on the buffer.
+ @return 0 for success, EINVAL if vp is not a device file.
+ */
+errno_t	buf_setdevice(buf_t, vnode_t);
+
+/*!
+ @function buf_strategy
+ @abstract Pass an I/O request for a buffer down to the device layer.
+ @discussion This is one of the most important routines in the buffer cache layer.  For buffers obtained
+ through buf_getblk, it handles finding physical block numbers for the I/O (with VNOP_BLKTOOFF and 
+ VNOP_BLOCKMAP), packaging the I/O into page-sized chunks, and initiating I/O on the disk by calling 
+ the device's strategy routine. If a buffer's UPL has been set manually with buf_setupl(), it assumes 
+ that the request is already correctly configured with a block number and a size divisible by page size
+ and will just call directly to the device.
+ @param devvp Device on which to perform I/O
+ @param ap vnop_strategy_args structure (most importantly, a buffer).
+ @return 0 for success, or errors from filesystem or device layers.
+ */
+errno_t	buf_strategy(vnode_t, void *);
+
+/* 
+ * Flags for buf_invalblkno() 
+ */
+#define	BUF_WAIT	0x01
+
+/*!
+ @function buf_invalblkno
+ @abstract Invalidate a filesystem logical block in a file.
+ @discussion buf_invalblkno() tries to make the data for a given block in a file
+ invalid; if the buffer for that block is found in core and is not busy, we mark it 
+ invalid and call buf_brelse() (see "flags" param for what happens if the buffer is busy).
+ buf_brelse(), noticing that it is invalid, will 
+ will return the buffer to the empty-buffer list and tell the VM subsystem to abandon 
+ the relevant pages.  Data will not be written to backing store--it will be cast aside.
+ Note that this function will only work if the block in question has been
+ obtained with a buf_getblk().  If data has been read into core without using
+ traditional buffer cache routines, buf_invalblkno() will not be able to invalidate it--this
+ includes the use of iobufs.
+ @param bp Buffer whose block to invalidate.
+ @param lblkno Logical block number.
+ @param flags BUF_WAIT: wait for busy buffers to become unbusy and invalidate them then.  Otherwise,
+ just return EBUSY for busy blocks.
+ @return 0 for success, EINVAL if vp is not a device file.
+ */
+errno_t	buf_invalblkno(vnode_t, daddr64_t, int);
+
+/*!
+ @function buf_callback
+ @abstract Get the function set to be called when I/O on a buffer completes.
+ @discussion A function returned by buf_callback was originally set with buf_setcallback().
+ @param bp Buffer whose callback to get.
+ @return 0 for success, or errors from filesystem or device layers.
+ */
+void * buf_callback(buf_t);
+
+/*!
+ @function buf_setcallback
+ @abstract Set a function to be called once when I/O on a buffer completes.
+ @discussion A one-shot callout set with buf_setcallback() will be called from buf_biodone()
+ when I/O completes. It will be passed the "transaction" argument as well as the buffer.
+ buf_setcallback() also marks the buffer as B_ASYNC.
+ @param bp Buffer whose callback to set.
+ @param callback function to use as callback.
+ @param transaction Additional argument to callback function.
+ @return 0; always succeeds.
+ */
+errno_t	buf_setcallback(buf_t, void (*)(buf_t, void *), void *);
+
+/*!
+ @function buf_setupl
+ @abstract Set the UPL (Universal Page List), and offset therein, on a buffer.
+ @discussion buf_setupl() should only be called on buffers allocated with buf_alloc().
+ A subsequent call to buf_map() will map the UPL and give back the address at which data
+ begins. After buf_setupl() is called, a buffer is marked B_CLUSTER; when this is the case,
+ buf_strategy() assumes that a buffer is correctly configured to be passed to the device
+ layer without modification. Passing a NULL upl will clear the upl and the B_CLUSTER flag on the
+ buffer.
+ @param bp Buffer whose upl to set.
+ @param upl UPL to set in the buffer.
+ @parma offset Offset within upl at which relevant data begin.
+ @return 0 for success, EINVAL if the buffer was not allocated with buf_alloc().
+ */
+errno_t	buf_setupl(buf_t, upl_t, uint32_t);
+
+/*!
+ @function buf_clone
+ @abstract Clone a buffer with a restricted range and an optional callback.
+ @discussion Generates a buffer which is identical to its "bp" argument except that
+ it spans a subset of the data of the original.  The buffer to be cloned should
+ have been allocated with buf_alloc().  Checks its arguments to make sure
+ that the data subset is coherent. Optionally, adds a callback function and argument to it
+ to be called when I/O completes (as with buf_setcallback(), but B_ASYNC is not set).  If the original buffer had
+ a upl set through buf_setupl(), this upl is copied to the new buffer; otherwise, the original's
+ data pointer is used raw. The buffer must be released with buf_free().
+ @param bp Buffer to clone.
+ @param io_offset Offset, relative to start of data in original buffer, at which new buffer's data will begin. 
+ @param io_size Size of buffer region in new buffer, in the sense of buf_count().
+ @param iodone Callback to be called from buf_biodone() when I/O completes, in the sense of buf_setcallback().
+ @param arg Argument to pass to iodone() callback.
+ @return NULL if io_offset/io_size combination is invalid for the buffer to be cloned; otherwise, the new buffer.
+ */
+buf_t	buf_clone(buf_t, int, int, void (*)(buf_t, void *), void *);
+
+
+/*!
+ @function buf_create_shadow
+ @abstract Create a shadow buffer with optional private storage and an optional callback.
+ @param bp Buffer to shadow.
+ @param force_copy If TRUE, do not link the shadaow to 'bp' and if 'external_storage' == NULL,
+ force a copy of the data associated with 'bp'.
+ @param external_storage If non-NULL, associate it with the new buffer as its storage instead of the 
+ storage currently associated with 'bp'.
+ @param iodone Callback to be called from buf_biodone() when I/O completes, in the sense of buf_setcallback().
+ @param arg Argument to pass to iodone() callback.
+ @return NULL if the buffer to be shadowed is not B_META or a primary buffer (i.e. not a shadow buffer); otherwise, the new buffer.
+*/
+
+buf_t	buf_create_shadow(buf_t bp, boolean_t force_copy, uintptr_t external_storage, void (*iodone)(buf_t, void *), void *arg);
+
+
+/*!
+ @function buf_shadow
+ @abstract returns true if 'bp' is a shadow of another buffer.
+ @param bp Buffer to query.
+ @return 1 if 'bp' is a shadow, 0 otherwise.
+*/
+int	buf_shadow(buf_t bp);
+
+
+/*!
+ @function buf_alloc
+ @abstract Allocate an uninitialized buffer.
+ @discussion A buffer returned by buf_alloc() is marked as busy and as an iobuf; it has no storage set up and must be
+ set up using buf_setdataptr() or buf_setupl()/buf_map().
+ @param vp vnode to associate with the buffer: optionally NULL.  If vp is a device file, then
+ the buffer's associated device will be set. If vp is NULL, it can be set later with buf_setvnode().
+ @return New buffer.
+ */
+buf_t 	buf_alloc(vnode_t);
+
+/*!
+ @function buf_free
+ @abstract Free a buffer that was allocated with buf_alloc().
+ @discussion The storage (UPL, data pointer) associated with an iobuf must be freed manually.
+ @param bp The buffer to free.
+ @return void.
+ */
+void	buf_free(buf_t);
+
+/*
+ * flags for buf_invalidateblks
+ */
+#define	BUF_WRITE_DATA	0x0001		/* write data blocks first */
+#define	BUF_SKIP_META	0x0002		/* skip over metadata blocks */
+#define BUF_INVALIDATE_LOCKED	0x0004	/* force B_LOCKED blocks to be invalidated */
+
+/*!
+ @function buf_invalidateblks
+ @abstract Invalidate all the blocks associated with a vnode.
+ @discussion This function does for all blocks associated with a vnode what buf_invalblkno does for one block.
+ Again, it will only be able to invalidate data which were populated with traditional buffer cache routines,
+ i.e. by buf_getblk() and callers thereof. Unlike buf_invalblkno(), it can be made to write dirty data to disk
+ rather than casting it aside.
+ @param bp The buffer whose data to invalidate.
+ @param flags BUF_WRITE_DATA: write dirty data to disk with VNOP_BWRITE() before kicking buffer cache entries out.
+ BUF_SKIP_META: do not invalidate metadata blocks.
+ @param slpflag Flags to pass to "msleep" while waiting to acquire busy buffers. 
+ @param slptimeo Timeout in "hz" (1/100 second) to wait for a buffer to become unbusy before waking from sleep
+ and re-starting the scan.
+ @return 0 for success, error values from msleep().
+ */
+int	buf_invalidateblks(vnode_t, int, int, int);
+
+/*
+ * flags for buf_flushdirtyblks and buf_iterate
+ */
+#define BUF_SKIP_NONLOCKED	0x01
+#define BUF_SKIP_LOCKED		0x02
+#define BUF_SCAN_CLEAN		0x04	/* scan the clean buffers */
+#define BUF_SCAN_DIRTY		0x08	/* scan the dirty buffers */
+#define BUF_NOTIFY_BUSY		0x10	/* notify the caller about the busy pages during the scan */
+
+
+#define	BUF_RETURNED		0
+#define BUF_RETURNED_DONE	1
+#define BUF_CLAIMED		2
+#define	BUF_CLAIMED_DONE	3
+/*!
+ @function buf_flushdirtyblks
+ @abstract Write dirty file blocks to disk.
+ @param vp The vnode whose blocks to flush.
+ @param wait Wait for writes to complete before returning.
+ @param flags Can pass zero, meaning "flush all dirty buffers."  
+ BUF_SKIP_NONLOCKED: Skip buffers which are not busy when we encounter them.
+ BUF_SKIP_LOCKED: Skip buffers which are busy when we encounter them.
+ @param msg String to pass to msleep().
+ @return void.
+ */
+void	buf_flushdirtyblks(vnode_t, int, int, const char *);
+
+/*!
+ @function buf_iterate
+ @abstract Perform some operation on all buffers associated with a vnode.
+ @param vp The vnode whose buffers to scan.
+ @param callout Function to call on each buffer.  Should return one of:
+ BUF_RETURNED: buf_iterate() should call buf_brelse() on the buffer.
+ BUF_RETURNED_DONE: buf_iterate() should call buf_brelse() on the buffer and then stop iterating.
+ BUF_CLAIMED: buf_iterate() should continue iterating (and not call buf_brelse()).
+ BUF_CLAIMED_DONE: buf_iterate() should stop iterating (and not call buf_brelse()).
+ @param flag
+ BUF_SKIP_NONLOCKED: Skip buffers which are not busy when we encounter them. BUF_SKIP_LOCKED: Skip buffers which are busy when we encounter them.
+ BUF_SCAN_CLEAN: Call out on clean buffers.
+ BUF_SCAN_DIRTY: Call out on dirty buffers.
+ BUF_NOTIFY_BUSY: If a buffer cannot be acquired, pass a NULL buffer to callout; otherwise,
+ that buffer will be silently skipped.
+ @param arg Argument to pass to callout in addition to buffer.
+ @return void.
+ */
+void	buf_iterate(vnode_t, int (*)(buf_t, void *), int, void *);
+
+/*!
+ @function buf_clear
+ @abstract Zero out the storage associated with a buffer. 
+ @discussion Calls buf_map() to get the buffer's data address; for a B_CLUSTER
+ buffer (one which has had buf_setupl() called on it), it tries to map the buffer's
+ UPL into memory; should only be called once during the life cycle of an iobuf (one allocated
+ with buf_alloc()).  
+ @param bp The buffer to zero out.
+ @return void.
+ */
+void	buf_clear(buf_t);
+
+/*!
+ @function buf_bawrite
+ @abstract Start an asychronous write on a buffer.
+ @discussion Calls VNOP_BWRITE to start the process of propagating an asynchronous write down to the device layer.
+ Callers can wait for writes to complete at their discretion using buf_biowait().  When this function is called,
+ data should already have been written to the buffer's data region.
+ @param bp The buffer on which to initiate I/O.
+ @param throttle If "throttle" is nonzero and more than VNODE_ASYNC_THROTTLE writes are in progress on this file,
+ buf_bawrite() will block until the write count drops below VNODE_ASYNC_THROTTLE.  If "throttle" is zero and the write
+ count is high, it will fail with EWOULDBLOCK; the caller can decide whether to make a blocking call or pursue
+ other opportunities.
+ @return EWOULDBLOCK if write count is high and "throttle" is zero; otherwise, errors from VNOP_BWRITE.
+ */
+errno_t	buf_bawrite(buf_t);
+
+/*!
+ @function buf_bdwrite
+ @abstract Mark a buffer for delayed write.
+ @discussion Marks a buffer as waiting for delayed write and the current I/O as complete; data will be written to backing store
+ before the buffer is reused, but it will not be queued for I/O immediately.  Note that for buffers allocated
+ with buf_alloc(), there are no such guarantees; you must take care of your own flushing to disk.  If
+ the number of delayed writes pending on the system is greater than an internal limit and the caller has not
+ requested otherwise [see return_error] , buf_bdwrite() will unilaterally launch an asynchronous I/O with buf_bawrite() to keep the pile of
+ delayed writes from getting too large.
+ @param bp The buffer to mark for delayed write.
+ @param return_error If the number of pending delayed writes systemwide is larger than an internal limit,
+ return EAGAIN rather than doing an asynchronous write.
+ @return EAGAIN for return_error != 0 case, 0 for succeess, errors from buf_bawrite.
+ */
+errno_t	buf_bdwrite(buf_t);
+
+/*!
+ @function buf_bwrite
+ @abstract Write a buffer's data to backing store.
+ @discussion Once the data in a buffer has been modified, buf_bwrite() starts sending it to disk by calling
+ VNOP_STRATEGY.  Unless B_ASYNC has been set on the buffer (by buf_setflags() or otherwise), data will have 
+ been written to disk when buf_bwrite() returns.  See Bach (p 56).
+ @param bp The buffer to write to disk.
+ @return 0 for success; errors from buf_biowait().
+ */
+errno_t	buf_bwrite(buf_t);
+
+/*!
+ @function buf_biodone
+ @abstract Mark an I/O as completed.
+ @discussion buf_biodone() should be called by whosoever decides that an I/O on a buffer is complete; for example,
+ IOStorageFamily.  It clears the dirty flag on a buffer and signals on the vnode that a write has completed
+ with vnode_writedone(). If a callout or filter has been set on the buffer, that function is called.  In the case
+ of a callout, that function is expected to take care of cleaning up and freeing the buffer.
+ Otherwise, if the buffer is marked B_ASYNC (e.g. it was passed to buf_bawrite()), then buf_biodone()
+ considers itself justified in calling buf_brelse() to return it to free lists--no one is waiting for it.  Finally, 
+ waiters on the bp (e.g. in buf_biowait()) are woken up.
+ @param bp The buffer to mark as done with I/O.
+ @return void.
+ */
+void	buf_biodone(buf_t);
+
+/*!
+ @function buf_biowait
+ @abstract Wait for I/O on a buffer to complete.
+ @discussion Waits for I/O on a buffer to finish, as marked by a buf_biodone() call.  
+ @param bp The buffer to wait on.
+ @return 0 for a successful wait; nonzero the buffer has been marked as EINTR or had an error set on it.
+ */
+errno_t	buf_biowait(buf_t);
+
+/*!
+ @function buf_brelse
+ @abstract Release any claim to a buffer, sending it back to free lists.
+ @discussion buf_brelse() cleans up buffer state and releases a buffer to the free lists.  If the buffer
+ is not marked invalid and its pages are dirty (e.g. a delayed write was made), its data will be commited
+ to backing store. If it is marked invalid, its data will be discarded completely.  
+ A valid, cacheable buffer will be put on a list and kept in the buffer hash so it
+ can be found again; otherwise, it will be dissociated from its vnode and treated as empty.  Which list a valid
+ buffer is placed on depends on the use of buf_markaged(), whether it is metadata, and the B_LOCKED flag.  A
+ B_LOCKED buffer will not be available for reuse by other files, though its data may be paged out.
+ Note that buf_brelse() is intended for use with traditionally allocated buffers.
+ @param bp The buffer to release.
+ @retrn void.
+ */
+void	buf_brelse(buf_t);
+
+/*!
+ @function buf_bread
+ @abstract Synchronously read a block of a file.
+ @discussion buf_bread() is the traditional way to read a single logical block of a file through the buffer cache. 
+ It tries to find the buffer and corresponding page(s) in core, calls VNOP_STRATEGY if necessary to bring the data
+ into memory, and waits for I/O to complete.  It should not be used to read blocks of greater than 4K (one VM page) 
+ in size; use cluster routines for large reads.  Indeed, the cluster layer is a more efficient choice for reading DATA
+ unless you need some finely-tuned semantics that it cannot provide.
+ @param vp The file from which to read.
+ @param blkno The logical (filesystem) block number to read.
+ @param size Size of block; do not use for sizes > 4K.
+ @param cred Credential to store and use for reading from disk if data are not already in core.
+ @param bpp Destination pointer for buffer.
+ @return 0 for success, or an error from buf_biowait().
+ */
+errno_t	buf_bread(vnode_t, daddr64_t, int, kauth_cred_t, buf_t *);
+
+/*!
+ @function buf_breadn
+ @abstract Read a block from a file with read-ahead.
+ @discussion buf_breadn() reads one block synchronously in the style of buf_bread() and fires
+ off a specified set of asynchronous reads to improve the likelihood of future cache hits.  
+ It should not be used to read blocks of greater than 4K (one VM page) in size; use cluster 
+ routines for large reads.  Indeed, the cluster layer is a more efficient choice for reading DATA
+ unless you need some finely-tuned semantics that it cannot provide.
+ @param vp The file from which to read.
+ @param blkno The logical (filesystem) block number to read synchronously.
+ @param size Size of block; do not use for sizes > 4K.
+ @param rablks Array of logical block numbers for asynchronous read-aheads.
+ @param rasizes Array of block sizes for asynchronous read-aheads, each index corresponding to same index in "rablks."
+ @param nrablks Number of entries in read-ahead arrays.
+ @param cred Credential to store and use for reading from disk if data are not already in core.
+ @param bpp Destination pointer for buffer.
+ @return 0 for success, or an error from buf_biowait().
+ */
+errno_t	buf_breadn(vnode_t, daddr64_t, int, daddr64_t *, int *, int, kauth_cred_t, buf_t *);
+
+/*!
+ @function buf_meta_bread
+ @abstract Synchronously read a metadata block of a file.
+ @discussion buf_meta_bread() is the traditional way to read a single logical block of a file through the buffer cache. 
+ It tries to find the buffer and corresponding page(s) in core, calls VNOP_STRATEGY if necessary to bring the data
+ into memory, and waits for I/O to complete.  It should not be used to read blocks of greater than 4K (one VM page) 
+ in size; use cluster routines for large reads.  Reading meta-data through the traditional buffer cache, unlike
+ reading data, is efficient and encouraged, especially if the blocks being read are significantly smaller than page size.
+ @param vp The file from which to read.
+ @param blkno The logical (filesystem) block number to read.
+ @param size Size of block; do not use for sizes > 4K.
+ @param cred Credential to store and use for reading from disk if data are not already in core.
+ @param bpp Destination pointer for buffer.
+ @return 0 for success, or an error from buf_biowait().
+ */
+errno_t	buf_meta_bread(vnode_t, daddr64_t, int, kauth_cred_t, buf_t *);
+
+/*!
+ @function buf_meta_breadn
+ @abstract Read a metadata block from a file with read-ahead.
+ @discussion buf_meta_breadn() reads one block synchronously in the style of buf_meta_bread() and fires
+ off a specified set of asynchronous reads to improve the likelihood of future cache hits.  
+ It should not be used to read blocks of greater than 4K (one VM page) in size; use cluster 
+ routines for large reads.
+ @param vp The file from which to read.
+ @param blkno The logical (filesystem) block number to read synchronously.
+ @param size Size of block; do not use for sizes > 4K.
+ @param rablks Array of logical block numbers for asynchronous read-aheads.
+ @param rasizes Array of block sizes for asynchronous read-aheads, each index corresponding to same index in "rablks."
+ @param nrablks Number of entries in read-ahead arrays.
+ @param cred Credential to store and use for reading from disk if data are not already in core.
+ @param bpp Destination pointer for buffer.
+ @return 0 for success, or an error from buf_biowait().
+ */
+errno_t	buf_meta_breadn(vnode_t, daddr64_t, int, daddr64_t *, int *, int, kauth_cred_t, buf_t *);
+
+/*!
+ @function minphys
+ @abstract Adjust a buffer's count to be no more than maximum physical I/O transfer size for the host architecture.
+ @discussion physio() takes as a parameter a function to bound transfer sizes for each VNOP_STRATEGY() call.  minphys()
+ is a default implementation.  It calls buf_setcount() to make the buffer's count the min() of its current count
+ and the max I/O size for the host architecture.
+ @param bp The buffer whose byte count to modify.
+ @return New byte count.
+ */
+u_int	minphys(buf_t bp);
+
+/*!
+ @function physio 
+ @abstract Perform I/O on a device to/from target memory described by a uio.
+ @discussion physio() allows I/O directly from a device to user-space memory.  It waits
+ for all I/O to complete before returning.
+ @param f_strategy Strategy routine to call to initiate I/O.
+ @param bp Buffer to configure and pass to strategy routine; can be NULL.
+ @param dev Device on which to perform I/O.
+ @param flags B_READ or B_WRITE.
+ @param f_minphys Function which calls buf_setcount() to set a byte count which is suitably
+ small for the device in question.  Returns byte count that has been set (or unchanged) on the buffer.
+ @param uio UIO describing the I/O operation.
+ @param blocksize Logical block size for this vnode.
+ @return 0 for success; EFAULT for an invalid uio; errors from buf_biowait().
+ */
+int	physio(void (*)(buf_t), buf_t, dev_t, int ,  u_int (*)(buf_t), struct uio *, int );
+
+
+/*
+ * Flags for operation type in getblk()
+ */
+#define	BLK_READ	0x01	/* buffer for read */
+#define	BLK_WRITE	0x02	/* buffer for write */
+#define	BLK_META	0x10	/* buffer for metadata */
+/*
+ * modifier for above flags...  if set, getblk will only return
+ * a bp that is already valid... i.e. found in the cache
+ */
+#define BLK_ONLYVALID	0x80000000
+                                  
+/*!
+ @function buf_getblk
+ @abstract Traditional buffer cache routine to get a buffer corresponding to a logical block in a file.
+ @discussion buf_getblk() gets a buffer, not necessarily containing valid data, representing a block in a file.  
+ A metadata buffer will be returned with its own zone-allocated storage, managed by the traditional buffer-cache
+ layer, whereas data buffers will be returned hooked into backing by the UBC (which in fact controls the caching of data).
+ buf_getblk() first looks for the buffer header in cache; if the buffer is in-core but busy, buf_getblk() will wait for it to become
+ unbusy, depending on the slpflag and slptimeo parameters. If the buffer is found unbusy and is a metadata buffer,
+ it must already contain valid data and will be returned directly; data buffers will have a UPL configured to
+ prepare for interaction with the underlying UBC.  If the buffer is found in core, it will be marked as such
+ and buf_fromcache() will return truth. A buffer is allocated and initialized (but not filled with data)
+ if none is found in core. buf_bread(), buf_breadn(), buf_meta_bread(), and buf_meta_breadn() all 
+ return buffers obtained with buf_getblk().
+ @param vp File for which to get block.
+ @param blkno Logical block number.
+ @param size Size of block.
+ @param slpflag Flag to pass to msleep() while waiting for buffer to become unbusy.
+ @param slptimeo Time, in milliseconds, to wait for buffer to become unbusy.  0 means to wait indefinitely.
+ @param operation BLK_READ: want a read buffer.  BLK_WRITE: want a write buffer.  BLK_META: want a metadata buffer.  BLK_ONLYVALID: 
+ only return buffers which are found in core (do not allocate anew), and do not change buffer size.  The last remark means
+ that if a given logical block is found in core with a different size than what is requested, the buffer size will not be modified.
+ @return Buffer found in core or newly allocated, either containing valid data or ready for I/O.
+ */
+buf_t	buf_getblk(vnode_t, daddr64_t, int, int, int, int);
+
+/*!
+ @function buf_geteblk
+ @abstract Get a metadata buffer which is marked invalid and not associated with any vnode.
+ @discussion A buffer is returned with zone-allocated storage of the specified size, marked B_META and invalid. 
+ It has no vnode and is not visible in the buffer hash.  
+ @param size Size of buffer.
+ @return Always returns a new buffer.
+ */
+buf_t	buf_geteblk(int);
+
+/*!
+ @function buf_clear_redundancy_flags
+ @abstract Clear flags on a buffer.
+ @discussion buffer_redundancy_flags &= ~flags
+ @param bp Buffer whose flags to clear.
+ @param flags Flags to remove from buffer's mask
+ @return void.
+ */
+void	buf_clear_redundancy_flags(buf_t, uint32_t);
+
+/*!
+ @function buf_redundancyflags
+ @abstract Get redundancy flags set on a buffer.
+ @param bp Buffer whose redundancy flags to grab.
+ @return flags.
+ */
+uint32_t	buf_redundancy_flags(buf_t);
+
+/*!
+ @function buf_setredundancyflags
+ @abstract Set redundancy flags on a buffer.
+ @discussion buffer_redundancy_flags |= flags
+ @param bp Buffer whose flags to set.
+ @param flags Flags to add to buffer's redundancy flags
+ @return void.
+ */
+void	buf_set_redundancy_flags(buf_t, uint32_t);
+
+/*!
+ @function buf_attr
+ @abstract Gets the attributes for this buf.
+ @param bp Buffer whose attributes to get.
+ @return bufattr_t.
+ */
+bufattr_t buf_attr(buf_t);
+
+/*!
+ @function buf_markstatic
+ @abstract Mark a buffer as being likely to contain static data.
+ @param bp Buffer to mark.
+ @return void.
+ */
+ void buf_markstatic(buf_t);
+
+/*!
+ @function buf_static
+ @abstract Check if a buffer contains static data.
+ @param bp Buffer to test.
+ @return Nonzero if buffer has static data, 0 otherwise.
+ */
+int	buf_static(buf_t);
+
+
+__END_DECLS
+
+
+/* Macros to clear/set/test flags. */
+#define	SET(t, f)	(t) |= (f)
+#define	CLR(t, f)	(t) &= ~(f)
+#define	ISSET(t, f)	((t) & (f))
+
+
+#endif /* !_SYS_BUF_H_ */
diff -Nur cctools-877.5/include/sys/cdefs.h cctools-877.5-AnV/include/sys/cdefs.h
--- cctools-877.5/include/sys/cdefs.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/cdefs.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,683 @@
+/*
+ * Copyright (c) 2000-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright 1995 NeXT Computer, Inc. All rights reserved. */
+/*
+ * Copyright (c) 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * This code is derived from software contributed to Berkeley by
+ * Berkeley Software Design, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)cdefs.h	8.8 (Berkeley) 1/9/95
+ */
+
+#ifndef	_CDEFS_H_
+#define	_CDEFS_H_
+
+#if defined(__cplusplus)
+#define	__BEGIN_DECLS	extern "C" {
+#define	__END_DECLS	}
+#else
+#define	__BEGIN_DECLS
+#define	__END_DECLS
+#endif
+
+/* This SDK is designed to work with clang and specific versions of
+ * gcc >= 4.0 with Apple's patch sets */
+#if !defined(__GNUC__) || __GNUC__ < 4
+#warning "Unsupported compiler detected"
+#endif
+
+/*
+ * The __CONCAT macro is used to concatenate parts of symbol names, e.g.
+ * with "#define OLD(foo) __CONCAT(old,foo)", OLD(foo) produces oldfoo.
+ * The __CONCAT macro is a bit tricky -- make sure you don't put spaces
+ * in between its arguments.  __CONCAT can also concatenate double-quoted
+ * strings produced by the __STRING macro, but this only works with ANSI C.
+ */
+#if defined(__STDC__) || defined(__cplusplus)
+#define	__P(protos)	protos		/* full-blown ANSI C */
+#define	__CONCAT(x,y)	x ## y
+#define	__STRING(x)	#x
+
+#define	__const		const		/* define reserved names to standard */
+#define	__signed	signed
+#define	__volatile	volatile
+#if defined(__cplusplus)
+#define	__inline	inline		/* convert to C++ keyword */
+#else
+#ifndef __GNUC__
+#define	__inline			/* delete GCC keyword */
+#endif /* !__GNUC__ */
+#endif /* !__cplusplus */
+
+#else	/* !(__STDC__ || __cplusplus) */
+#define	__P(protos)	()		/* traditional C preprocessor */
+#define	__CONCAT(x,y)	x/**/y
+#define	__STRING(x)	"x"
+
+#ifndef __GNUC__
+#define	__const				/* delete pseudo-ANSI C keywords */
+#define	__inline
+#define	__signed
+#define	__volatile
+#endif	/* !__GNUC__ */
+
+/*
+ * In non-ANSI C environments, new programs will want ANSI-only C keywords
+ * deleted from the program and old programs will want them left alone.
+ * When using a compiler other than gcc, programs using the ANSI C keywords
+ * const, inline etc. as normal identifiers should define -DNO_ANSI_KEYWORDS.
+ * When using "gcc -traditional", we assume that this is the intent; if
+ * __GNUC__ is defined but __STDC__ is not, we leave the new keywords alone.
+ */
+#ifndef	NO_ANSI_KEYWORDS
+#define	const		__const			/* convert ANSI C keywords */
+#define	inline		__inline
+#define	signed		__signed
+#define	volatile	__volatile
+#endif /* !NO_ANSI_KEYWORDS */
+#endif /* !(__STDC__ || __cplusplus) */
+
+#define __dead2		__attribute__((noreturn))
+#define __pure2		__attribute__((const))
+
+/* __unused denotes variables and functions that may not be used, preventing
+ * the compiler from warning about it if not used.
+ */
+#define __unused	__attribute__((unused))
+
+/* __used forces variables and functions to be included even if it appears
+ * to the compiler that they are not used (and would thust be discarded).
+ */
+#define __used		__attribute__((used))
+
+/* __deprecated causes the compiler to produce a warning when encountering
+ * code using the deprecated functionality.
+ * __deprecated_msg() does the same, and compilers that support it will print
+ * a message along with the deprecation warning.
+ * This may require turning on such warning with the -Wdeprecated flag.
+ * __deprecated_enum_msg() should be used on enums, and compilers that support
+ * it will print the deprecation warning.
+ */
+#define __deprecated	__attribute__((deprecated))
+
+#ifdef __has_extension
+    #if __has_extension(attribute_deprecated_with_message)
+        #define __deprecated_msg(_msg) __attribute__((deprecated(_msg)))
+    #else
+        #define __deprecated_msg(_msg) __attribute__((deprecated))
+    #endif
+#elif defined(__GNUC__) && ((__GNUC__ >= 5) || ((__GNUC__ == 4) && (__GNUC_MINOR__ >= 5)))
+    #define __deprecated_msg(_msg) __attribute__((deprecated(_msg)))
+#else
+    #define __deprecated_msg(_msg) __attribute__((deprecated))
+#endif
+
+#ifdef __has_extension
+    #if __has_extension(enumerator_attributes)
+        #define __deprecated_enum_msg(_msg) __deprecated_msg(_msg)
+    #else
+        #define __deprecated_enum_msg(_msg)
+    #endif
+#else
+    #define __deprecated_enum_msg(_msg)
+#endif
+
+/* __unavailable causes the compiler to error out when encountering
+ * code using the tagged function of variable.
+ */
+#define __unavailable	__attribute__((unavailable))
+
+/* Delete pseudo-keywords wherever they are not available or needed. */
+#ifndef __dead
+#define	__dead
+#define	__pure
+#endif
+
+/*
+ * We use `__restrict' as a way to define the `restrict' type qualifier
+ * without disturbing older software that is unaware of C99 keywords.
+ */
+#if __STDC_VERSION__ < 199901
+#define __restrict
+#else
+#define __restrict	restrict
+#endif
+
+/* Declaring inline functions within headers is error-prone due to differences
+ * across various versions of the C language and extensions.  __header_inline
+ * can be used to declare inline functions within system headers.  In cases
+ * where you want to force inlining instead of letting the compiler make
+ * the decision, you can use __header_always_inline.
+ *
+ * Be aware that using inline for functions which compilers may also provide
+ * builtins can behave differently under various compilers.  If you intend to
+ * provide an inline version of such a function, you may want to use a macro
+ * instead.
+ *
+ * The check for !__GNUC__ || __clang__ is because gcc doesn't correctly
+ * support c99 inline in some cases:
+ * http://gcc.gnu.org/bugzilla/show_bug.cgi?id=55965
+ */
+
+#if defined(__cplusplus) || \
+    (__STDC_VERSION__ >= 199901L && \
+     !defined(__GNUC_GNU_INLINE__) && \
+     (!defined(__GNUC__) || defined(__clang__)))
+# define __header_inline           inline
+#elif defined(__GNUC__) && defined(__GNUC_STDC_INLINE__)
+# define __header_inline           extern __inline __attribute__((__gnu_inline__))
+#elif defined(__GNUC__)
+# define __header_inline           extern __inline
+#else
+  /* If we land here, we've encountered an unsupported compiler,
+   * so hopefully it understands static __inline as a fallback.
+   */
+# define __header_inline           static __inline
+#endif
+
+#ifdef __GNUC__
+# define __header_always_inline    __header_inline __attribute__ ((__always_inline__))
+#else
+  /* Unfortunately, we're using a compiler that we don't know how to force to
+   * inline.  Oh well.
+   */
+# define __header_always_inline    __header_inline
+#endif
+
+/*
+ * Compiler-dependent macros that bracket portions of code where the
+ * "-Wunreachable-code" warning should be ignored. Please use sparingly.
+ */
+#if defined(__clang__)
+# define __unreachable_ok_push \
+         _Pragma("clang diagnostic push") \
+         _Pragma("clang diagnostic ignored \"-Wunreachable-code\"")
+# define __unreachable_ok_pop \
+         _Pragma("clang diagnostic pop")
+#elif defined(__GNUC__) && ((__GNUC__ > 4) || (__GNUC__ == 4 && __GNUC_MINOR__ >= 6))
+# define __unreachable_ok_push \
+         _Pragma("GCC diagnostic push") \
+         _Pragma("GCC diagnostic ignored \"-Wunreachable-code\"")
+# define __unreachable_ok_pop \
+         _Pragma("GCC diagnostic pop")
+#else
+# define __unreachable_ok_push
+# define __unreachable_ok_pop
+#endif
+
+/*
+ * Compiler-dependent macros to declare that functions take printf-like
+ * or scanf-like arguments.  They are null except for versions of gcc
+ * that are known to support the features properly.  Functions declared
+ * with these attributes will cause compilation warnings if there is a
+ * mismatch between the format string and subsequent function parameter
+ * types.
+ */
+#define __printflike(fmtarg, firstvararg) \
+		__attribute__((__format__ (__printf__, fmtarg, firstvararg)))
+#define __scanflike(fmtarg, firstvararg) \
+		__attribute__((__format__ (__scanf__, fmtarg, firstvararg)))
+
+#define __IDSTRING(name,string) static const char name[] __used = string
+
+#ifndef __COPYRIGHT
+#define __COPYRIGHT(s) __IDSTRING(copyright,s)
+#endif
+
+#ifndef __RCSID
+#define __RCSID(s) __IDSTRING(rcsid,s)
+#endif
+
+#ifndef __SCCSID
+#define __SCCSID(s) __IDSTRING(sccsid,s)
+#endif
+
+#ifndef __PROJECT_VERSION
+#define __PROJECT_VERSION(s) __IDSTRING(project_version,s)
+#endif
+
+/* Source compatibility only, ID string not emitted in object file */
+#ifndef __FBSDID
+#define __FBSDID(s) 
+#endif
+
+#ifndef	__DECONST
+#define	__DECONST(type, var)	__CAST_AWAY_QUALIFIER(var, const, type)
+#endif
+
+#ifndef	__DEVOLATILE
+#define	__DEVOLATILE(type, var)	__CAST_AWAY_QUALIFIER(var, volatile, type)
+#endif
+
+#ifndef	__DEQUALIFY
+#define	__DEQUALIFY(type, var)	__CAST_AWAY_QUALIFIER(var, const volatile, type)
+#endif
+
+/*
+ * COMPILATION ENVIRONMENTS -- see compat(5) for additional detail
+ *
+ * DEFAULT	By default newly complied code will get POSIX APIs plus
+ *		Apple API extensions in scope.
+ *
+ *		Most users will use this compilation environment to avoid
+ *		behavioral differences between 32 and 64 bit code.
+ *
+ * LEGACY	Defining _NONSTD_SOURCE will get pre-POSIX APIs plus Apple
+ *		API extensions in scope.
+ *
+ *		This is generally equivalent to the Tiger release compilation
+ *		environment, except that it cannot be applied to 64 bit code;
+ *		its use is discouraged.
+ *
+ *		We expect this environment to be deprecated in the future.
+ *
+ * STRICT	Defining _POSIX_C_SOURCE or _XOPEN_SOURCE restricts the
+ *		available APIs to exactly the set of APIs defined by the
+ *		corresponding standard, based on the value defined.
+ *
+ *		A correct, portable definition for _POSIX_C_SOURCE is 200112L.
+ *		A correct, portable definition for _XOPEN_SOURCE is 600L.
+ *
+ *		Apple API extensions are not visible in this environment,
+ *		which can cause Apple specific code to fail to compile,
+ *		or behave incorrectly if prototypes are not in scope or
+ *		warnings about missing prototypes are not enabled or ignored.
+ *
+ * In any compilation environment, for correct symbol resolution to occur,
+ * function prototypes must be in scope.  It is recommended that all Apple
+ * tools users add either the "-Wall" or "-Wimplicit-function-declaration"
+ * compiler flags to their projects to be warned when a function is being
+ * used without a prototype in scope.
+ */
+
+/* These settings are particular to each product. */
+/* Platform: MacOSX */
+#define __DARWIN_ONLY_64_BIT_INO_T	0
+/* #undef __DARWIN_ONLY_UNIX_CONFORMANCE (automatically set for 64-bit) */
+#define __DARWIN_ONLY_VERS_1050		0
+
+/*
+ * The __DARWIN_ALIAS macros are used to do symbol renaming; they allow
+ * legacy code to use the old symbol, thus maintaining binary compatibility
+ * while new code can use a standards compliant version of the same function.
+ *
+ * __DARWIN_ALIAS is used by itself if the function signature has not
+ * changed, it is used along with a #ifdef check for __DARWIN_UNIX03
+ * if the signature has changed.  Because the __LP64__ environment
+ * only supports UNIX03 semantics it causes __DARWIN_UNIX03 to be
+ * defined, but causes __DARWIN_ALIAS to do no symbol mangling.
+ *
+ * As a special case, when XCode is used to target a specific version of the
+ * OS, the manifest constant __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__
+ * will be defined by the compiler, with the digits representing major version
+ * time 100 + minor version times 10 (e.g. 10.5 := 1050).  If we are targeting
+ * pre-10.5, and it is the default compilation environment, revert the
+ * compilation environment to pre-__DARWIN_UNIX03.
+ */
+#if !defined(__DARWIN_ONLY_UNIX_CONFORMANCE)
+#  if defined(__LP64__)
+#    define __DARWIN_ONLY_UNIX_CONFORMANCE 1
+#  else /* !__LP64__ */
+#    define __DARWIN_ONLY_UNIX_CONFORMANCE 0
+#  endif /* __LP64__ */
+#endif /* !__DARWIN_ONLY_UNIX_CONFORMANCE */
+
+#if !defined(__DARWIN_UNIX03)
+#  if   __DARWIN_ONLY_UNIX_CONFORMANCE
+#    if defined(_NONSTD_SOURCE)
+#      error "Can't define _NONSTD_SOURCE when only UNIX conformance is available."
+#    endif /* _NONSTD_SOURCE */
+#    define __DARWIN_UNIX03	1
+#  elif defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && ((__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__-0) < 1040)
+#    define __DARWIN_UNIX03	0
+#  elif defined(_DARWIN_C_SOURCE) || defined(_XOPEN_SOURCE) || defined(_POSIX_C_SOURCE)
+#    if defined(_NONSTD_SOURCE)
+#      error "Can't define both _NONSTD_SOURCE and any of _DARWIN_C_SOURCE, _XOPEN_SOURCE or _POSIX_C_SOURCE."
+#    endif /* _NONSTD_SOURCE */
+#    define __DARWIN_UNIX03	1
+#  elif defined(_NONSTD_SOURCE)
+#    define __DARWIN_UNIX03	0
+#  else /* default */
+#    if defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && ((__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__-0) < 1050)
+#      define __DARWIN_UNIX03	0
+#    else /* __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1050 */
+#      define __DARWIN_UNIX03	1
+#    endif /* __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1050 */
+#  endif /* _DARWIN_C_SOURCE || _XOPEN_SOURCE || _POSIX_C_SOURCE || __LP64__ */
+#endif /* !__DARWIN_UNIX03 */
+
+#if !defined(__DARWIN_64_BIT_INO_T)
+#  if   defined(_DARWIN_USE_64_BIT_INODE)
+#    if defined(_DARWIN_NO_64_BIT_INODE)
+#      error "Can't define both _DARWIN_USE_64_BIT_INODE and _DARWIN_NO_64_BIT_INODE."
+#    endif /* _DARWIN_NO_64_BIT_INODE */
+#    define __DARWIN_64_BIT_INO_T 1
+#  elif defined(_DARWIN_NO_64_BIT_INODE)
+#    if __DARWIN_ONLY_64_BIT_INO_T
+#      error "Can't define _DARWIN_NO_64_BIT_INODE when only 64-bit inodes are available."
+#    endif /* __DARWIN_ONLY_64_BIT_INO_T */
+#    define __DARWIN_64_BIT_INO_T 0
+#  else /* default */
+#    if __DARWIN_ONLY_64_BIT_INO_T
+#      define __DARWIN_64_BIT_INO_T 1
+#    elif defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && ((__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__-0) < 1060) || __DARWIN_UNIX03 == 0
+#      define __DARWIN_64_BIT_INO_T 0
+#    else /* default */
+#      define __DARWIN_64_BIT_INO_T 1
+#    endif /* __DARWIN_ONLY_64_BIT_INO_T */
+#  endif
+#endif /* !__DARWIN_64_BIT_INO_T */
+
+#if !defined(__DARWIN_VERS_1050)
+#  if   __DARWIN_ONLY_VERS_1050
+#    define __DARWIN_VERS_1050 1
+#  elif defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__) && ((__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__-0) < 1050) || __DARWIN_UNIX03 == 0
+#    define __DARWIN_VERS_1050 0
+#  else /* default */
+#    define __DARWIN_VERS_1050 1
+#  endif
+#endif /* !__DARWIN_VERS_1050 */
+
+#if !defined(__DARWIN_NON_CANCELABLE)
+#    define __DARWIN_NON_CANCELABLE 0
+#endif /* !__DARWIN_NON_CANCELABLE */
+
+/*
+ * symbol suffixes used for symbol versioning
+ */
+#if __DARWIN_UNIX03
+#  if __DARWIN_ONLY_UNIX_CONFORMANCE
+#    define __DARWIN_SUF_UNIX03		/* nothing */
+#  else /* !__DARWIN_ONLY_UNIX_CONFORMANCE */
+#    define __DARWIN_SUF_UNIX03		"$UNIX2003"
+#  endif /* __DARWIN_ONLY_UNIX_CONFORMANCE */
+
+#  if __DARWIN_64_BIT_INO_T
+#    if __DARWIN_ONLY_64_BIT_INO_T
+#      define __DARWIN_SUF_64_BIT_INO_T	/* nothing */
+#    else /* !__DARWIN_ONLY_64_BIT_INO_T */
+#      define __DARWIN_SUF_64_BIT_INO_T	"$INODE64"
+#    endif /* __DARWIN_ONLY_64_BIT_INO_T */
+#  else /* !__DARWIN_64_BIT_INO_T */
+#    define __DARWIN_SUF_64_BIT_INO_T	/* nothing */
+#  endif /* __DARWIN_64_BIT_INO_T */
+
+#  if __DARWIN_VERS_1050
+#    if __DARWIN_ONLY_VERS_1050
+#      define __DARWIN_SUF_1050		/* nothing */
+#    else /* !__DARWIN_ONLY_VERS_1050 */
+#      define __DARWIN_SUF_1050		"$1050"
+#    endif /* __DARWIN_ONLY_VERS_1050 */
+#  else /* !__DARWIN_VERS_1050 */
+#    define __DARWIN_SUF_1050		/* nothing */
+#  endif /* __DARWIN_VERS_1050 */
+
+#  if __DARWIN_NON_CANCELABLE
+#    define __DARWIN_SUF_NON_CANCELABLE	"$NOCANCEL"
+#  else /* !__DARWIN_NON_CANCELABLE */
+#    define __DARWIN_SUF_NON_CANCELABLE	/* nothing */
+#  endif /* __DARWIN_NON_CANCELABLE */
+
+#else /* !__DARWIN_UNIX03 */
+#  define __DARWIN_SUF_UNIX03		/* nothing */
+#  define __DARWIN_SUF_64_BIT_INO_T	/* nothing */
+#  define __DARWIN_SUF_NON_CANCELABLE	/* nothing */
+#  define __DARWIN_SUF_1050		/* nothing */
+#endif /* __DARWIN_UNIX03 */
+
+#define __DARWIN_SUF_EXTSN		"$DARWIN_EXTSN"
+
+/*
+ * symbol versioning macros
+ */
+#define __DARWIN_ALIAS(sym)		__asm("_" __STRING(sym) __DARWIN_SUF_UNIX03)
+#define __DARWIN_ALIAS_C(sym)		__asm("_" __STRING(sym) __DARWIN_SUF_NON_CANCELABLE __DARWIN_SUF_UNIX03)
+#define __DARWIN_ALIAS_I(sym)		__asm("_" __STRING(sym) __DARWIN_SUF_64_BIT_INO_T __DARWIN_SUF_UNIX03)
+#define __DARWIN_NOCANCEL(sym)  	__asm("_" __STRING(sym) __DARWIN_SUF_NON_CANCELABLE)
+#define __DARWIN_INODE64(sym)		__asm("_" __STRING(sym) __DARWIN_SUF_64_BIT_INO_T)
+
+#define __DARWIN_1050(sym)		__asm("_" __STRING(sym) __DARWIN_SUF_1050)
+#define __DARWIN_1050ALIAS(sym)		__asm("_" __STRING(sym) __DARWIN_SUF_1050 __DARWIN_SUF_UNIX03)
+#define __DARWIN_1050ALIAS_C(sym)	__asm("_" __STRING(sym) __DARWIN_SUF_1050 __DARWIN_SUF_NON_CANCELABLE __DARWIN_SUF_UNIX03)
+#define __DARWIN_1050ALIAS_I(sym)	__asm("_" __STRING(sym) __DARWIN_SUF_1050 __DARWIN_SUF_64_BIT_INO_T __DARWIN_SUF_UNIX03)
+#define __DARWIN_1050INODE64(sym)	__asm("_" __STRING(sym) __DARWIN_SUF_1050 __DARWIN_SUF_64_BIT_INO_T)
+
+#define __DARWIN_EXTSN(sym)		__asm("_" __STRING(sym) __DARWIN_SUF_EXTSN)
+#define __DARWIN_EXTSN_C(sym)		__asm("_" __STRING(sym) __DARWIN_SUF_EXTSN __DARWIN_SUF_NON_CANCELABLE)
+
+/*
+ * symbol release macros
+ */
+#include <sys/_symbol_aliasing.h>
+
+#if defined(__ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__)
+#define __DARWIN_ALIAS_STARTING(_mac, _iphone, x)   __DARWIN_ALIAS_STARTING_IPHONE_##_iphone(x)
+#elif defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__)
+#define __DARWIN_ALIAS_STARTING(_mac, _iphone, x)   __DARWIN_ALIAS_STARTING_MAC_##_mac(x)
+#else
+#define __DARWIN_ALIAS_STARTING(_mac, _iphone, x)
+#endif
+
+
+/*
+ * POSIX.1 requires that the macros we test be defined before any standard
+ * header file is included.  This permits us to convert values for feature
+ * testing, as necessary, using only _POSIX_C_SOURCE.
+ *
+ * Here's a quick run-down of the versions:
+ *  defined(_POSIX_SOURCE)		1003.1-1988
+ *  _POSIX_C_SOURCE == 1L		1003.1-1990
+ *  _POSIX_C_SOURCE == 2L		1003.2-1992 C Language Binding Option
+ *  _POSIX_C_SOURCE == 199309L		1003.1b-1993
+ *  _POSIX_C_SOURCE == 199506L		1003.1c-1995, 1003.1i-1995,
+ *					and the omnibus ISO/IEC 9945-1: 1996
+ *  _POSIX_C_SOURCE == 200112L		1003.1-2001
+ *  _POSIX_C_SOURCE == 200809L		1003.1-2008
+ *
+ * In addition, the X/Open Portability Guide, which is now the Single UNIX
+ * Specification, defines a feature-test macro which indicates the version of
+ * that specification, and which subsumes _POSIX_C_SOURCE.
+ */
+
+/* Deal with IEEE Std. 1003.1-1990, in which _POSIX_C_SOURCE == 1L. */
+#if defined(_POSIX_C_SOURCE) && _POSIX_C_SOURCE == 1L
+#undef _POSIX_C_SOURCE
+#define	_POSIX_C_SOURCE		199009L
+#endif
+
+/* Deal with IEEE Std. 1003.2-1992, in which _POSIX_C_SOURCE == 2L. */
+#if defined(_POSIX_C_SOURCE) && _POSIX_C_SOURCE == 2L
+#undef _POSIX_C_SOURCE
+#define	_POSIX_C_SOURCE		199209L
+#endif
+
+/* Deal with various X/Open Portability Guides and Single UNIX Spec. */
+#ifdef _XOPEN_SOURCE
+#if _XOPEN_SOURCE - 0L >= 700L && (!defined(_POSIX_C_SOURCE) || _POSIX_C_SOURCE - 0L < 200809L)
+#undef _POSIX_C_SOURCE
+#define _POSIX_C_SOURCE         200809L
+#elif _XOPEN_SOURCE - 0L >= 600L && (!defined(_POSIX_C_SOURCE) || _POSIX_C_SOURCE - 0L < 200112L)
+#undef _POSIX_C_SOURCE
+#define	_POSIX_C_SOURCE		200112L
+#elif _XOPEN_SOURCE - 0L >= 500L && (!defined(_POSIX_C_SOURCE) || _POSIX_C_SOURCE - 0L < 199506L)
+#undef _POSIX_C_SOURCE
+#define	_POSIX_C_SOURCE		199506L
+#endif
+#endif
+
+/*
+ * Deal with all versions of POSIX.  The ordering relative to the tests above is
+ * important.
+ */
+#if defined(_POSIX_SOURCE) && !defined(_POSIX_C_SOURCE)
+#define _POSIX_C_SOURCE         198808L
+#endif
+
+/* POSIX C deprecation macros */
+#include <sys/_posix_availability.h>
+
+#define __POSIX_C_DEPRECATED(ver) ___POSIX_C_DEPRECATED_STARTING_##ver
+
+/*
+ * Set a single macro which will always be defined and can be used to determine
+ * the appropriate namespace.  For POSIX, these values will correspond to
+ * _POSIX_C_SOURCE value.  Currently there are two additional levels corresponding
+ * to ANSI (_ANSI_SOURCE) and Darwin extensions (_DARWIN_C_SOURCE)
+ */
+#define __DARWIN_C_ANSI         010000L
+#define __DARWIN_C_FULL         900000L
+
+#if   defined(_ANSI_SOURCE)
+#define __DARWIN_C_LEVEL        __DARWIN_C_ANSI
+#elif defined(_POSIX_C_SOURCE) && !defined(_DARWIN_C_SOURCE) && !defined(_NONSTD_SOURCE)
+#define __DARWIN_C_LEVEL        _POSIX_C_SOURCE
+#else
+#define __DARWIN_C_LEVEL        __DARWIN_C_FULL
+#endif
+
+/* If the developer has neither requested a strict language mode nor a version
+ * of POSIX, turn on functionality provided by __STDC_WANT_LIB_EXT1__ as part
+ * of __DARWIN_C_FULL.
+ */
+#if !defined(__STDC_WANT_LIB_EXT1__) && !defined(__STRICT_ANSI__) && __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define __STDC_WANT_LIB_EXT1__ 1
+#endif
+
+/*
+ * long long is not supported in c89 (__STRICT_ANSI__), but g++ -ansi and
+ * c99 still want long longs.  While not perfect, we allow long longs for
+ * g++.
+ */
+#define	__DARWIN_NO_LONG_LONG	(defined(__STRICT_ANSI__) \
+				&& (__STDC_VERSION__-0 < 199901L) \
+				&& !defined(__GNUG__))
+
+/*****************************************
+ *  Public darwin-specific feature macros
+ *****************************************/
+
+/*
+ * _DARWIN_FEATURE_64_BIT_INODE indicates that the ino_t type is 64-bit, and
+ * structures modified for 64-bit inodes (like struct stat) will be used.
+ */
+#if __DARWIN_64_BIT_INO_T
+#define _DARWIN_FEATURE_64_BIT_INODE		1
+#endif
+
+/*
+ * _DARWIN_FEATURE_64_ONLY_BIT_INODE indicates that the ino_t type may only
+ * be 64-bit; there is no support for 32-bit ino_t when this macro is defined
+ * (and non-zero).  There is no struct stat64 either, as the regular
+ * struct stat will already be the 64-bit version.
+ */
+#if __DARWIN_ONLY_64_BIT_INO_T
+#define _DARWIN_FEATURE_ONLY_64_BIT_INODE	1
+#endif
+
+/*
+ * _DARWIN_FEATURE_ONLY_VERS_1050 indicates that only those APIs updated
+ * in 10.5 exists; no pre-10.5 variants are available.
+ */
+#if __DARWIN_ONLY_VERS_1050
+#define _DARWIN_FEATURE_ONLY_VERS_1050		1
+#endif
+
+/*
+ * _DARWIN_FEATURE_ONLY_UNIX_CONFORMANCE indicates only UNIX conforming API
+ * are available (the legacy BSD APIs are not available)
+ */
+#if __DARWIN_ONLY_UNIX_CONFORMANCE
+#define _DARWIN_FEATURE_ONLY_UNIX_CONFORMANCE	1
+#endif
+
+/*
+ * _DARWIN_FEATURE_UNIX_CONFORMANCE indicates whether UNIX conformance is on,
+ * and specifies the conformance level (3 is SUSv3)
+ */
+#if __DARWIN_UNIX03
+#define _DARWIN_FEATURE_UNIX_CONFORMANCE	3
+#endif
+
+/* 
+ * This macro casts away the qualifier from the variable
+ *
+ * Note: use at your own risk, removing qualifiers can result in
+ * catastrophic run-time failures.
+ */
+#ifndef __CAST_AWAY_QUALIFIER
+#define __CAST_AWAY_QUALIFIER(variable, qualifier, type)  (type) (long)(variable)
+#endif
+
+/*
+ * __XNU_PRIVATE_EXTERN is a linkage decoration indicating that a symbol can be
+ * used from other compilation units, but not other libraries or executables.
+ */
+#ifndef __XNU_PRIVATE_EXTERN
+#define __XNU_PRIVATE_EXTERN __attribute__((visibility("hidden")))
+#endif
+
+/*
+ * Architecture validation for current SDK
+ */
+#if !defined(__sys_cdefs_arch_unknown__) && defined(__i386__)
+#elif !defined(__sys_cdefs_arch_unknown__) && defined(__x86_64__)
+#else
+#error Unsupported architecture
+#endif
+
+#endif /* !_CDEFS_H_ */
diff -Nur cctools-877.5/include/sys/conf.h cctools-877.5-AnV/include/sys/conf.h
--- cctools-877.5/include/sys/conf.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/conf.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,100 @@
+/*
+ * Copyright (c) 2000-2012 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)conf.h	8.5 (Berkeley) 1/9/95
+ */
+
+#ifndef _SYS_CONF_H_
+#define _SYS_CONF_H_ 1
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/queue.h>
+#include <stdint.h>
+
+/*
+ * Definitions of device driver entry switches
+ */
+
+struct buf;
+struct proc;
+struct tty;
+struct uio;
+struct vnode;
+
+/*
+ * Types for d_type.
+ * These are returned by ioctl FIODTYPE
+ */
+#define	D_TAPE	1
+#define	D_DISK	2
+#define	D_TTY	3
+
+  
+
+
+
+
+#endif /* _SYS_CONF_H_ */
diff -Nur cctools-877.5/include/sys/dir.h cctools-877.5-AnV/include/sys/dir.h
--- cctools-877.5/include/sys/dir.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/dir.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,89 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1989, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)dir.h	8.2 (Berkeley) 1/4/94
+ */
+
+/*
+ * The information in this file should be obtained from <dirent.h>
+ * and is provided solely (and temporarily) for backward compatibility.
+ */
+
+#ifndef _SYS_DIR_H_
+#define	_SYS_DIR_H_
+
+#include <dirent.h>
+
+/*
+ * Backwards compatibility.
+ */
+#define direct dirent
+
+/*
+ * The DIRSIZ macro gives the minimum record length which will hold
+ * the directory entry.  This requires the amount of space in struct direct
+ * without the d_name field, plus enough space for the name with a terminating
+ * null byte (dp->d_namlen+1), rounded up to a 4 byte boundary.
+ */
+#undef DIRSIZ
+#define DIRSIZ(dp) \
+    (((unsigned long)&((struct direct *)0)->d_name + (dp)->d_namlen+1 + 3) & ~3)
+
+#endif /* !_SYS_DIR_H_ */
diff -Nur cctools-877.5/include/sys/dirent.h cctools-877.5-AnV/include/sys/dirent.h
--- cctools-877.5/include/sys/dirent.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/dirent.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,140 @@
+/*
+ * Copyright (c) 2000-2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1989, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)dirent.h	8.3 (Berkeley) 8/10/94
+ */
+
+/*
+ * The dirent structure defines the format of directory entries.
+ *
+ * A directory entry has a struct dirent at the front of it, containing its
+ * inode number, the length of the entry, and the length of the name
+ * contained in the entry.  These are followed by the name padded to a 4
+ * byte boundary with null bytes.  All names are guaranteed null terminated.
+ * The maximum length of a name in a directory is MAXNAMLEN when 32-bit
+ * ino_t is in effect; (MAXPATHLEN - 1) when 64-bit ino_t is in effect.
+ */
+
+#ifndef _SYS_DIRENT_H 
+#define _SYS_DIRENT_H 
+
+#include <sys/_types.h>
+#include <sys/cdefs.h>
+
+#include <sys/_types/_ino_t.h>
+
+
+#define __DARWIN_MAXNAMLEN	255
+
+#pragma pack(4)
+
+#if !__DARWIN_64_BIT_INO_T
+struct dirent {
+	ino_t d_ino;			/* file number of entry */
+	__uint16_t d_reclen;		/* length of this record */
+	__uint8_t  d_type; 		/* file type, see below */
+	__uint8_t  d_namlen;		/* length of string in d_name */
+	char d_name[__DARWIN_MAXNAMLEN + 1];	/* name must be no longer than this */
+};
+#endif /* !__DARWIN_64_BIT_INO_T */
+
+#pragma pack()
+
+#define __DARWIN_MAXPATHLEN	1024
+
+#define __DARWIN_STRUCT_DIRENTRY { \
+	__uint64_t  d_ino;      /* file number of entry */ \
+	__uint64_t  d_seekoff;  /* seek offset (optional, used by servers) */ \
+	__uint16_t  d_reclen;   /* length of this record */ \
+	__uint16_t  d_namlen;   /* length of string in d_name */ \
+	__uint8_t   d_type;     /* file type, see below */ \
+	char      d_name[__DARWIN_MAXPATHLEN]; /* entry name (up to MAXPATHLEN bytes) */ \
+}
+
+#if __DARWIN_64_BIT_INO_T
+struct dirent __DARWIN_STRUCT_DIRENTRY;
+#endif /* __DARWIN_64_BIT_INO_T */
+
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	d_fileno	d_ino		/* backward compatibility */
+#define	MAXNAMLEN	__DARWIN_MAXNAMLEN
+/*
+ * File types
+ */
+#define	DT_UNKNOWN	 0
+#define	DT_FIFO		 1
+#define	DT_CHR		 2
+#define	DT_DIR		 4
+#define	DT_BLK		 6
+#define	DT_REG		 8
+#define	DT_LNK		10
+#define	DT_SOCK		12
+#define	DT_WHT		14
+
+/*
+ * Convert between stat structure types and directory types.
+ */
+#define	IFTODT(mode)	(((mode) & 0170000) >> 12)
+#define	DTTOIF(dirtype)	((dirtype) << 12)
+#endif
+
+#endif /* _SYS_DIRENT_H  */
diff -Nur cctools-877.5/include/sys/disk.h cctools-877.5-AnV/include/sys/disk.h
--- cctools-877.5/include/sys/disk.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/disk.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,159 @@
+/*
+ * Copyright (c) 1998-2014 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef	_SYS_DISK_H_
+#define	_SYS_DISK_H_
+
+#include <stdint.h>
+#include <sys/ioctl.h>
+
+
+/*
+ * Definitions
+ *
+ * ioctl                                 description
+ * ------------------------------------- ---------------------------------------
+ * DKIOCEJECT                            eject media
+ * DKIOCSYNCHRONIZECACHE                 flush media
+ *
+ * DKIOCFORMAT                           format media
+ * DKIOCGETFORMATCAPACITIES              get media's formattable capacities
+ *
+ * DKIOCGETBLOCKSIZE                     get media's block size
+ * DKIOCGETBLOCKCOUNT                    get media's block count
+ * DKIOCGETFIRMWAREPATH                  get media's firmware path
+ *
+ * DKIOCISFORMATTED                      is media formatted?
+ * DKIOCISWRITABLE                       is media writable?
+ *
+ * DKIOCREQUESTIDLE                      idle media
+ * DKIOCUNMAP                            delete unused data
+ *
+ * DKIOCGETMAXBLOCKCOUNTREAD             get maximum block count for reads
+ * DKIOCGETMAXBLOCKCOUNTWRITE            get maximum block count for writes
+ * DKIOCGETMAXBYTECOUNTREAD              get maximum byte count for reads
+ * DKIOCGETMAXBYTECOUNTWRITE             get maximum byte count for writes
+ *
+ * DKIOCGETMAXSEGMENTCOUNTREAD           get maximum segment count for reads
+ * DKIOCGETMAXSEGMENTCOUNTWRITE          get maximum segment count for writes
+ * DKIOCGETMAXSEGMENTBYTECOUNTREAD       get maximum segment byte count for reads
+ * DKIOCGETMAXSEGMENTBYTECOUNTWRITE      get maximum segment byte count for writes
+ *
+ * DKIOCGETMINSEGMENTALIGNMENTBYTECOUNT  get minimum segment alignment in bytes
+ * DKIOCGETMAXSEGMENTADDRESSABLEBITCOUNT get maximum segment width in bits
+ *
+ * DKIOCGETFEATURES                      get device's feature set
+ * DKIOCGETPHYSICALBLOCKSIZE             get device's block size
+ * DKIOCGETCOMMANDPOOLSIZE               get device's queue depth
+ */
+
+#define DK_FEATURE_PRIORITY                   0x00000004
+#define DK_FEATURE_UNMAP                      0x00000010
+
+typedef struct
+{
+    uint64_t               offset;
+    uint64_t               length;
+} dk_extent_t;
+
+typedef struct
+{
+    char                   path[128];
+} dk_firmware_path_t;
+
+typedef struct
+{
+    uint64_t               blockCount;
+    uint32_t               blockSize;
+
+    uint8_t                reserved0096[4];        /* reserved, clear to zero */
+} dk_format_capacity_t;
+
+typedef struct
+{
+    dk_format_capacity_t * capacities;
+    uint32_t               capacitiesCount;        /* use zero to probe count */
+
+#ifdef __LP64__
+    uint8_t                reserved0096[4];        /* reserved, clear to zero */
+#else /* !__LP64__ */
+    uint8_t                reserved0064[8];        /* reserved, clear to zero */
+#endif /* !__LP64__ */
+} dk_format_capacities_t;
+
+typedef struct
+{
+    dk_extent_t *          extents;
+    uint32_t               extentsCount;
+
+    uint32_t               options;
+
+#ifndef __LP64__
+    uint8_t                reserved0096[4];        /* reserved, clear to zero */
+#endif /* !__LP64__ */
+} dk_unmap_t;
+
+
+
+#define DKIOCEJECT                            _IO('d', 21)
+#define DKIOCSYNCHRONIZECACHE                 _IO('d', 22)
+
+#define DKIOCFORMAT                           _IOW('d', 26, dk_format_capacity_t)
+#define DKIOCGETFORMATCAPACITIES              _IOWR('d', 26, dk_format_capacities_t)
+
+#define DKIOCGETBLOCKSIZE                     _IOR('d', 24, uint32_t)
+#define DKIOCGETBLOCKCOUNT                    _IOR('d', 25, uint64_t)
+#define DKIOCGETFIRMWAREPATH                  _IOR('d', 28, dk_firmware_path_t)
+
+#define DKIOCISFORMATTED                      _IOR('d', 23, uint32_t)
+#define DKIOCISWRITABLE                       _IOR('d', 29, uint32_t)
+
+#define DKIOCREQUESTIDLE                      _IO('d', 30)
+#define DKIOCUNMAP                            _IOW('d', 31, dk_unmap_t)
+#define _DKIOCCORESTORAGE		      _IO('d', 32)
+
+#define DKIOCGETMAXBLOCKCOUNTREAD             _IOR('d', 64, uint64_t)
+#define DKIOCGETMAXBLOCKCOUNTWRITE            _IOR('d', 65, uint64_t)
+#define DKIOCGETMAXBYTECOUNTREAD              _IOR('d', 70, uint64_t)
+#define DKIOCGETMAXBYTECOUNTWRITE             _IOR('d', 71, uint64_t)
+
+#define DKIOCGETMAXSEGMENTCOUNTREAD           _IOR('d', 66, uint64_t)
+#define DKIOCGETMAXSEGMENTCOUNTWRITE          _IOR('d', 67, uint64_t)
+#define DKIOCGETMAXSEGMENTBYTECOUNTREAD       _IOR('d', 68, uint64_t)
+#define DKIOCGETMAXSEGMENTBYTECOUNTWRITE      _IOR('d', 69, uint64_t)
+
+#define DKIOCGETMINSEGMENTALIGNMENTBYTECOUNT  _IOR('d', 74, uint64_t)
+#define DKIOCGETMAXSEGMENTADDRESSABLEBITCOUNT _IOR('d', 75, uint64_t)
+
+#define DKIOCGETFEATURES                      _IOR('d', 76, uint32_t)
+#define DKIOCGETPHYSICALBLOCKSIZE             _IOR('d', 77, uint32_t)
+#define DKIOCGETCOMMANDPOOLSIZE               _IOR('d', 78, uint32_t)
+
+
+
+#endif	/* _SYS_DISK_H_ */
diff -Nur cctools-877.5/include/sys/dkstat.h cctools-877.5-AnV/include/sys/dkstat.h
--- cctools-877.5/include/sys/dkstat.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/dkstat.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,73 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)dkstat.h	8.2 (Berkeley) 1/21/94
+ */
+
+#ifndef	_SYS_DKSTAT_H_
+#define	_SYS_DKSTAT_H_
+
+
+#endif	/* _SYS_DKSTAT_H_ */
diff -Nur cctools-877.5/include/sys/domain.h cctools-877.5-AnV/include/sys/domain.h
--- cctools-877.5/include/sys/domain.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/domain.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,69 @@
+/*
+ * Copyright (c) 2000-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ *
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ *
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ *
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1998, 1999 Apple Computer, Inc. All Rights Reserved */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)domain.h	8.1 (Berkeley) 6/2/93
+ * $FreeBSD: src/sys/sys/domain.h,v 1.14 1999/12/29 04:24:40 peter Exp $
+ */
+
+#ifndef _SYS_DOMAIN_H_
+#define _SYS_DOMAIN_H_
+
+#endif	/* _SYS_DOMAIN_H_ */
diff -Nur cctools-877.5/include/sys/dtrace.h cctools-877.5-AnV/include/sys/dtrace.h
--- cctools-877.5/include/sys/dtrace.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/dtrace.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,2555 @@
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License (the "License").
+ * You may not use this file except in compliance with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+
+/*
+ * Portions copyright (c) 2011, Joyent, Inc. All rights reserved.
+ */
+
+/*
+ * Copyright 2007 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef _SYS_DTRACE_H
+#define _SYS_DTRACE_H
+
+/* #pragma ident	"@(#)dtrace.h	1.37	07/06/05 SMI" */
+
+#ifdef  __cplusplus
+extern "C" {
+#endif
+
+/*
+ * DTrace Dynamic Tracing Software: Kernel Interfaces
+ *
+ * Note: The contents of this file are private to the implementation of the
+ * Solaris system and DTrace subsystem and are subject to change at any time
+ * without notice.  Applications and drivers using these interfaces will fail
+ * to run on future releases.  These interfaces should not be used for any
+ * purpose except those expressly outlined in dtrace(7D) and libdtrace(3LIB).
+ * Please refer to the "Solaris Dynamic Tracing Guide" for more information.
+ */
+
+#ifndef _ASM
+
+#if !defined(__APPLE__)
+#include <sys/types.h>
+#include <sys/modctl.h>
+#include <sys/processor.h>
+#include <sys/systm.h>
+#include <sys/ctf_api.h>
+#include <sys/cyclic.h>
+#include <sys/int_limits.h>
+#else /* is Apple Mac OS X */
+
+#if defined(__LP64__)
+#if !defined(_LP64)
+#define _LP64 /* Solaris vs. Darwin */
+#endif
+#else
+#if !defined(_ILP32)
+#define _ILP32 /* Solaris vs. Darwin */
+#endif
+#endif
+
+
+#if defined(__BIG_ENDIAN__)
+#if !defined(_BIG_ENDIAN)
+#define _BIG_ENDIAN /* Solaris vs. Darwin */
+#endif
+#elif defined(__LITTLE_ENDIAN__)
+#if !defined(_LITTLE_ENDIAN)
+#define _LITTLE_ENDIAN /* Solaris vs. Darwin */
+#endif
+#else
+#error Unknown endian-ness
+#endif
+
+#include <sys/types.h>
+#include <sys/param.h>
+#include <stdint.h>
+
+#ifndef NULL
+#define NULL ((void *)0) /* quiets many warnings */
+#endif
+
+#define SEC			1
+#define MILLISEC	1000
+#define MICROSEC	1000000
+#define NANOSEC		1000000000
+
+#define S_ROUND(x, a)   ((x) + (((a) ? (a) : 1) - 1) & ~(((a) ? (a) : 1) - 1))
+#define P2ROUNDUP(x, align)             (-(-(x) & -(align)))
+
+#define	CTF_MODEL_ILP32	1	/* object data model is ILP32 */
+#define	CTF_MODEL_LP64	2	/* object data model is LP64 */
+#ifdef __LP64__
+#define	CTF_MODEL_NATIVE	CTF_MODEL_LP64
+#else
+#define	CTF_MODEL_NATIVE	CTF_MODEL_ILP32
+#endif
+
+typedef uint8_t		uchar_t;
+typedef uint16_t	ushort_t;
+typedef uint32_t	uint_t;
+typedef unsigned long	ulong_t;
+typedef uint64_t	u_longlong_t;
+typedef int64_t		longlong_t;
+typedef int64_t		off64_t;
+typedef int			processorid_t;
+typedef int64_t		hrtime_t;
+
+typedef enum { B_FALSE = 0, B_TRUE = 1 } _dtrace_boolean;
+
+typedef uint8_t UUID[16]; /* For modctl use in dtrace.h */
+
+struct modctl; /* In lieu of Solaris <sys/modctl.h> */
+/* NOTHING */  /* In lieu of Solaris <sys/processor.h> */
+#include <sys/ioctl.h> /* In lieu of Solaris <sys/systm.h> */
+/* In lieu of Solaris <sys/ctf_api.h> */
+typedef struct ctf_file ctf_file_t;
+typedef long ctf_id_t;
+/* NOTHING */ /* In lieu of Solaris <sys/cyclic.h> */
+/* NOTHING */ /* In lieu of Solaris <sys/int_limits.h> */
+
+typedef uint32_t        zoneid_t;
+
+#include <sys/dtrace_glue.h>
+
+#include <stdarg.h> 
+typedef va_list __va_list;
+
+/* Solaris proc_t is the struct. Darwin's proc_t is a pointer to it. */
+#define proc_t struct proc /* Steer clear of the Darwin typedef for proc_t */
+#endif /* __APPLE__ */
+
+/*
+ * DTrace Universal Constants and Typedefs
+ */
+#define	DTRACE_CPUALL		-1	/* all CPUs */
+#define	DTRACE_IDNONE		0	/* invalid probe identifier */
+#define	DTRACE_EPIDNONE		0	/* invalid enabled probe identifier */
+#define	DTRACE_AGGIDNONE	0	/* invalid aggregation identifier */
+#define	DTRACE_AGGVARIDNONE	0	/* invalid aggregation variable ID */
+#define	DTRACE_CACHEIDNONE	0	/* invalid predicate cache */
+#define	DTRACE_PROVNONE		0	/* invalid provider identifier */
+#define	DTRACE_METAPROVNONE	0	/* invalid meta-provider identifier */
+#define	DTRACE_ARGNONE		-1	/* invalid argument index */
+
+#define	DTRACE_PROVNAMELEN	64
+#define	DTRACE_MODNAMELEN	64
+#define	DTRACE_FUNCNAMELEN	128
+#define	DTRACE_NAMELEN		64
+#define	DTRACE_FULLNAMELEN	(DTRACE_PROVNAMELEN + DTRACE_MODNAMELEN + \
+				DTRACE_FUNCNAMELEN + DTRACE_NAMELEN + 4)
+#define	DTRACE_ARGTYPELEN	128
+
+typedef uint32_t dtrace_id_t;		/* probe identifier */
+typedef uint32_t dtrace_epid_t;		/* enabled probe identifier */
+typedef uint32_t dtrace_aggid_t;	/* aggregation identifier */
+typedef int64_t dtrace_aggvarid_t;	/* aggregation variable identifier */
+typedef uint16_t dtrace_actkind_t;	/* action kind */
+typedef int64_t dtrace_optval_t;	/* option value */
+typedef uint32_t dtrace_cacheid_t;	/* predicate cache identifier */
+
+typedef enum dtrace_probespec {
+        DTRACE_PROBESPEC_NONE = -1,
+        DTRACE_PROBESPEC_PROVIDER = 0,
+        DTRACE_PROBESPEC_MOD,
+        DTRACE_PROBESPEC_FUNC,
+        DTRACE_PROBESPEC_NAME
+} dtrace_probespec_t;
+
+/*
+ * DTrace Intermediate Format (DIF)
+ *
+ * The following definitions describe the DTrace Intermediate Format (DIF), a
+ * a RISC-like instruction set and program encoding used to represent
+ * predicates and actions that can be bound to DTrace probes.  The constants
+ * below defining the number of available registers are suggested minimums; the
+ * compiler should use DTRACEIOC_CONF to dynamically obtain the number of
+ * registers provided by the current DTrace implementation.
+ */
+#define	DIF_VERSION_1	1		/* DIF version 1: Solaris 10 Beta */
+#define	DIF_VERSION_2	2		/* DIF version 2: Solaris 10 FCS */
+#define	DIF_VERSION	DIF_VERSION_2	/* latest DIF instruction set version */
+#define	DIF_DIR_NREGS	8		/* number of DIF integer registers */
+#define	DIF_DTR_NREGS	8		/* number of DIF tuple registers */
+
+#define	DIF_OP_OR	1		/* or	r1, r2, rd */
+#define	DIF_OP_XOR	2		/* xor	r1, r2, rd */
+#define	DIF_OP_AND	3		/* and	r1, r2, rd */
+#define	DIF_OP_SLL	4		/* sll	r1, r2, rd */
+#define	DIF_OP_SRL	5		/* srl	r1, r2, rd */
+#define	DIF_OP_SUB	6		/* sub	r1, r2, rd */
+#define	DIF_OP_ADD	7		/* add	r1, r2, rd */
+#define	DIF_OP_MUL	8		/* mul	r1, r2, rd */
+#define	DIF_OP_SDIV	9		/* sdiv	r1, r2, rd */
+#define	DIF_OP_UDIV	10		/* udiv r1, r2, rd */
+#define	DIF_OP_SREM	11		/* srem r1, r2, rd */
+#define	DIF_OP_UREM	12		/* urem r1, r2, rd */
+#define	DIF_OP_NOT	13		/* not	r1, rd */
+#define	DIF_OP_MOV	14		/* mov	r1, rd */
+#define	DIF_OP_CMP	15		/* cmp	r1, r2 */
+#define	DIF_OP_TST	16		/* tst  r1 */
+#define	DIF_OP_BA	17		/* ba	label */
+#define	DIF_OP_BE	18		/* be	label */
+#define	DIF_OP_BNE	19		/* bne	label */
+#define	DIF_OP_BG	20		/* bg	label */
+#define	DIF_OP_BGU	21		/* bgu	label */
+#define	DIF_OP_BGE	22		/* bge	label */
+#define	DIF_OP_BGEU	23		/* bgeu	label */
+#define	DIF_OP_BL	24		/* bl	label */
+#define	DIF_OP_BLU	25		/* blu	label */
+#define	DIF_OP_BLE	26		/* ble	label */
+#define	DIF_OP_BLEU	27		/* bleu	label */
+#define	DIF_OP_LDSB	28		/* ldsb	[r1], rd */
+#define	DIF_OP_LDSH	29		/* ldsh	[r1], rd */
+#define	DIF_OP_LDSW	30		/* ldsw [r1], rd */
+#define	DIF_OP_LDUB	31		/* ldub	[r1], rd */
+#define	DIF_OP_LDUH	32		/* lduh	[r1], rd */
+#define	DIF_OP_LDUW	33		/* lduw	[r1], rd */
+#define	DIF_OP_LDX	34		/* ldx	[r1], rd */
+#define	DIF_OP_RET	35		/* ret	rd */
+#define	DIF_OP_NOP	36		/* nop */
+#define	DIF_OP_SETX	37		/* setx	intindex, rd */
+#define	DIF_OP_SETS	38		/* sets strindex, rd */
+#define	DIF_OP_SCMP	39		/* scmp	r1, r2 */
+#define	DIF_OP_LDGA	40		/* ldga	var, ri, rd */
+#define	DIF_OP_LDGS	41		/* ldgs var, rd */
+#define	DIF_OP_STGS	42		/* stgs var, rs */
+#define	DIF_OP_LDTA	43		/* ldta var, ri, rd */
+#define	DIF_OP_LDTS	44		/* ldts var, rd */
+#define	DIF_OP_STTS	45		/* stts var, rs */
+#define	DIF_OP_SRA	46		/* sra	r1, r2, rd */
+#define	DIF_OP_CALL	47		/* call	subr, rd */
+#define	DIF_OP_PUSHTR	48		/* pushtr type, rs, rr */
+#define	DIF_OP_PUSHTV	49		/* pushtv type, rs, rv */
+#define	DIF_OP_POPTS	50		/* popts */
+#define	DIF_OP_FLUSHTS	51		/* flushts */
+#define	DIF_OP_LDGAA	52		/* ldgaa var, rd */
+#define	DIF_OP_LDTAA	53		/* ldtaa var, rd */
+#define	DIF_OP_STGAA	54		/* stgaa var, rs */
+#define	DIF_OP_STTAA	55		/* sttaa var, rs */
+#define	DIF_OP_LDLS	56		/* ldls	var, rd */
+#define	DIF_OP_STLS	57		/* stls	var, rs */
+#define	DIF_OP_ALLOCS	58		/* allocs r1, rd */
+#define	DIF_OP_COPYS	59		/* copys  r1, r2, rd */
+#define	DIF_OP_STB	60		/* stb	r1, [rd] */
+#define	DIF_OP_STH	61		/* sth	r1, [rd] */
+#define	DIF_OP_STW	62		/* stw	r1, [rd] */
+#define	DIF_OP_STX	63		/* stx	r1, [rd] */
+#define	DIF_OP_ULDSB	64		/* uldsb [r1], rd */
+#define	DIF_OP_ULDSH	65		/* uldsh [r1], rd */
+#define	DIF_OP_ULDSW	66		/* uldsw [r1], rd */
+#define	DIF_OP_ULDUB	67		/* uldub [r1], rd */
+#define	DIF_OP_ULDUH	68		/* ulduh [r1], rd */
+#define	DIF_OP_ULDUW	69		/* ulduw [r1], rd */
+#define	DIF_OP_ULDX	70		/* uldx  [r1], rd */
+#define	DIF_OP_RLDSB	71		/* rldsb [r1], rd */
+#define	DIF_OP_RLDSH	72		/* rldsh [r1], rd */
+#define	DIF_OP_RLDSW	73		/* rldsw [r1], rd */
+#define	DIF_OP_RLDUB	74		/* rldub [r1], rd */
+#define	DIF_OP_RLDUH	75		/* rlduh [r1], rd */
+#define	DIF_OP_RLDUW	76		/* rlduw [r1], rd */
+#define	DIF_OP_RLDX	77		/* rldx  [r1], rd */
+#define	DIF_OP_XLATE	78		/* xlate xlrindex, rd */
+#define	DIF_OP_XLARG	79		/* xlarg xlrindex, rd */
+
+#define	DIF_INTOFF_MAX		0xffff	/* highest integer table offset */
+#define	DIF_STROFF_MAX		0xffff	/* highest string table offset */
+#define	DIF_REGISTER_MAX	0xff	/* highest register number */
+#define	DIF_VARIABLE_MAX	0xffff	/* highest variable identifier */
+#define	DIF_SUBROUTINE_MAX	0xffff	/* highest subroutine code */
+
+#define	DIF_VAR_ARRAY_MIN	0x0000	/* lowest numbered array variable */
+#define	DIF_VAR_ARRAY_UBASE	0x0080	/* lowest user-defined array */
+#define	DIF_VAR_ARRAY_MAX	0x00ff	/* highest numbered array variable */
+
+#define	DIF_VAR_OTHER_MIN	0x0100	/* lowest numbered scalar or assc */
+#define	DIF_VAR_OTHER_UBASE	0x0500	/* lowest user-defined scalar or assc */
+#define	DIF_VAR_OTHER_MAX	0xffff	/* highest numbered scalar or assc */
+
+#define	DIF_VAR_ARGS		0x0000	/* arguments array */
+#define	DIF_VAR_REGS		0x0001	/* registers array */
+#define	DIF_VAR_UREGS		0x0002	/* user registers array */
+#define	DIF_VAR_CURTHREAD	0x0100	/* thread pointer */
+#define	DIF_VAR_TIMESTAMP	0x0101	/* timestamp */
+#define	DIF_VAR_VTIMESTAMP	0x0102	/* virtual timestamp */
+#define	DIF_VAR_IPL		0x0103	/* interrupt priority level */
+#define	DIF_VAR_EPID		0x0104	/* enabled probe ID */
+#define	DIF_VAR_ID		0x0105	/* probe ID */
+#define	DIF_VAR_ARG0		0x0106	/* first argument */
+#define	DIF_VAR_ARG1		0x0107	/* second argument */
+#define	DIF_VAR_ARG2		0x0108	/* third argument */
+#define	DIF_VAR_ARG3		0x0109	/* fourth argument */
+#define	DIF_VAR_ARG4		0x010a	/* fifth argument */
+#define	DIF_VAR_ARG5		0x010b	/* sixth argument */
+#define	DIF_VAR_ARG6		0x010c	/* seventh argument */
+#define	DIF_VAR_ARG7		0x010d	/* eighth argument */
+#define	DIF_VAR_ARG8		0x010e	/* ninth argument */
+#define	DIF_VAR_ARG9		0x010f	/* tenth argument */
+#define	DIF_VAR_STACKDEPTH	0x0110	/* stack depth */
+#define	DIF_VAR_CALLER		0x0111	/* caller */
+#define	DIF_VAR_PROBEPROV	0x0112	/* probe provider */
+#define	DIF_VAR_PROBEMOD	0x0113	/* probe module */
+#define	DIF_VAR_PROBEFUNC	0x0114	/* probe function */
+#define	DIF_VAR_PROBENAME	0x0115	/* probe name */
+#define	DIF_VAR_PID		0x0116	/* process ID */
+#define	DIF_VAR_TID		0x0117	/* (per-process) thread ID */
+#define	DIF_VAR_EXECNAME	0x0118	/* name of executable */
+#define	DIF_VAR_ZONENAME	0x0119	/* zone name associated with process */
+#define	DIF_VAR_WALLTIMESTAMP	0x011a	/* wall-clock timestamp */
+#define	DIF_VAR_USTACKDEPTH	0x011b	/* user-land stack depth */
+#define	DIF_VAR_UCALLER		0x011c	/* user-level caller */
+#define	DIF_VAR_PPID		0x011d	/* parent process ID */
+#define	DIF_VAR_UID		0x011e	/* process user ID */
+#define	DIF_VAR_GID		0x011f	/* process group ID */
+#define	DIF_VAR_ERRNO		0x0120	/* thread errno */
+#if defined(__APPLE__)
+#define DIF_VAR_PTHREAD_SELF	0x0200	/* Apple specific PTHREAD_SELF (Not currently supported!) */
+#define DIF_VAR_DISPATCHQADDR	0x0201	/* Apple specific dispatch queue addr */
+#define DIF_VAR_MACHTIMESTAMP	0x0202	/* mach_absolute_timestamp() */
+#endif /* __APPLE __ */
+
+#define	DIF_SUBR_RAND			0
+#define	DIF_SUBR_MUTEX_OWNED		1
+#define	DIF_SUBR_MUTEX_OWNER		2
+#define	DIF_SUBR_MUTEX_TYPE_ADAPTIVE	3
+#define	DIF_SUBR_MUTEX_TYPE_SPIN	4
+#define	DIF_SUBR_RW_READ_HELD		5
+#define	DIF_SUBR_RW_WRITE_HELD		6
+#define	DIF_SUBR_RW_ISWRITER		7
+#define	DIF_SUBR_COPYIN			8
+#define	DIF_SUBR_COPYINSTR		9
+#define	DIF_SUBR_SPECULATION		10
+#define	DIF_SUBR_PROGENYOF		11
+#define	DIF_SUBR_STRLEN			12
+#define	DIF_SUBR_COPYOUT		13
+#define	DIF_SUBR_COPYOUTSTR		14
+#define	DIF_SUBR_ALLOCA			15
+#define	DIF_SUBR_BCOPY			16
+#define	DIF_SUBR_COPYINTO		17
+#define	DIF_SUBR_MSGDSIZE		18
+#define	DIF_SUBR_MSGSIZE		19
+#define	DIF_SUBR_GETMAJOR		20
+#define	DIF_SUBR_GETMINOR		21
+#define	DIF_SUBR_DDI_PATHNAME		22
+#define	DIF_SUBR_STRJOIN		23
+#define	DIF_SUBR_LLTOSTR		24
+#define	DIF_SUBR_BASENAME		25
+#define	DIF_SUBR_DIRNAME		26
+#define	DIF_SUBR_CLEANPATH		27
+#define	DIF_SUBR_STRCHR			28
+#define	DIF_SUBR_STRRCHR		29
+#define	DIF_SUBR_STRSTR			30
+#define	DIF_SUBR_STRTOK			31
+#define	DIF_SUBR_SUBSTR			32
+#define	DIF_SUBR_INDEX			33
+#define	DIF_SUBR_RINDEX			34
+#define	DIF_SUBR_HTONS			35
+#define	DIF_SUBR_HTONL			36
+#define	DIF_SUBR_HTONLL			37
+#define	DIF_SUBR_NTOHS			38
+#define	DIF_SUBR_NTOHL			39
+#define	DIF_SUBR_NTOHLL			40
+#define	DIF_SUBR_INET_NTOP		41
+#define	DIF_SUBR_INET_NTOA		42
+#define	DIF_SUBR_INET_NTOA6		43
+#define	DIF_SUBR_TOUPPER		44
+#define	DIF_SUBR_TOLOWER		45
+#if !defined(__APPLE__)
+
+#define DIF_SUBR_MAX			45      /* max subroutine value */
+#else
+#define DIF_SUBR_COREPROFILE		46
+
+#define DIF_SUBR_MAX			46      /* max subroutine value */
+#endif /* __APPLE__ */
+
+typedef uint32_t dif_instr_t;
+
+#define DIF_INSTR_OP(i)                 (((i) >> 24) & 0xff)
+#define DIF_INSTR_R1(i)                 (((i) >> 16) & 0xff)
+#define DIF_INSTR_R2(i)                 (((i) >>  8) & 0xff)
+#define DIF_INSTR_RD(i)                 ((i) & 0xff)
+#define DIF_INSTR_RS(i)                 ((i) & 0xff)
+#define DIF_INSTR_LABEL(i)              ((i) & 0xffffff)
+#define DIF_INSTR_VAR(i)                (((i) >>  8) & 0xffff)
+#define DIF_INSTR_INTEGER(i)            (((i) >>  8) & 0xffff)
+#define DIF_INSTR_STRING(i)             (((i) >>  8) & 0xffff)
+#define DIF_INSTR_SUBR(i)               (((i) >>  8) & 0xffff)
+#define DIF_INSTR_TYPE(i)               (((i) >> 16) & 0xff)
+#define DIF_INSTR_XLREF(i)              (((i) >>  8) & 0xffff)
+
+#define DIF_INSTR_FMT(op, r1, r2, d) \
+        (((op) << 24) | ((r1) << 16) | ((r2) << 8) | (d))
+
+#define DIF_INSTR_NOT(r1, d)            (DIF_INSTR_FMT(DIF_OP_NOT, r1, 0, d))
+#define DIF_INSTR_MOV(r1, d)            (DIF_INSTR_FMT(DIF_OP_MOV, r1, 0, d))
+#define DIF_INSTR_CMP(op, r1, r2)       (DIF_INSTR_FMT(op, r1, r2, 0))
+#define DIF_INSTR_TST(r1)               (DIF_INSTR_FMT(DIF_OP_TST, r1, 0, 0))
+#define DIF_INSTR_BRANCH(op, label)     (((op) << 24) | (label))
+#define DIF_INSTR_LOAD(op, r1, d)       (DIF_INSTR_FMT(op, r1, 0, d))
+#define DIF_INSTR_STORE(op, r1, d)      (DIF_INSTR_FMT(op, r1, 0, d))
+#define DIF_INSTR_SETX(i, d)            ((DIF_OP_SETX << 24) | ((i) << 8) | (d))
+#define DIF_INSTR_SETS(s, d)            ((DIF_OP_SETS << 24) | ((s) << 8) | (d))
+#define DIF_INSTR_RET(d)                (DIF_INSTR_FMT(DIF_OP_RET, 0, 0, d))
+#define DIF_INSTR_NOP                   (DIF_OP_NOP << 24)
+#define DIF_INSTR_LDA(op, v, r, d)      (DIF_INSTR_FMT(op, v, r, d))
+#define DIF_INSTR_LDV(op, v, d)         (((op) << 24) | ((v) << 8) | (d))
+#define DIF_INSTR_STV(op, v, rs)        (((op) << 24) | ((v) << 8) | (rs))
+#define DIF_INSTR_CALL(s, d)            ((DIF_OP_CALL << 24) | ((s) << 8) | (d))
+#define DIF_INSTR_PUSHTS(op, t, r2, rs) (DIF_INSTR_FMT(op, t, r2, rs))
+#define DIF_INSTR_POPTS                 (DIF_OP_POPTS << 24)
+#define DIF_INSTR_FLUSHTS               (DIF_OP_FLUSHTS << 24)
+#define DIF_INSTR_ALLOCS(r1, d)         (DIF_INSTR_FMT(DIF_OP_ALLOCS, r1, 0, d))
+#define DIF_INSTR_COPYS(r1, r2, d)      (DIF_INSTR_FMT(DIF_OP_COPYS, r1, r2, d))
+#define DIF_INSTR_XLATE(op, r, d)       (((op) << 24) | ((r) << 8) | (d))
+
+#define DIF_REG_R0      0               /* %r0 is always set to zero */
+
+/*
+ * A DTrace Intermediate Format Type (DIF Type) is used to represent the types
+ * of variables, function and associative array arguments, and the return type
+ * for each DIF object (shown below).  It contains a description of the type,
+ * its size in bytes, and a module identifier.
+ */
+typedef struct dtrace_diftype {
+        uint8_t dtdt_kind;              /* type kind (see below) */
+        uint8_t dtdt_ckind;             /* type kind in CTF */
+        uint8_t dtdt_flags;             /* type flags (see below) */
+        uint8_t dtdt_pad;               /* reserved for future use */
+        uint32_t dtdt_size;             /* type size in bytes (unless string) */
+} dtrace_diftype_t;
+
+#define DIF_TYPE_CTF            0       /* type is a CTF type */
+#define DIF_TYPE_STRING         1       /* type is a D string */
+
+#define DIF_TF_BYREF            0x1     /* type is passed by reference */
+
+/*
+ * A DTrace Intermediate Format variable record is used to describe each of the
+ * variables referenced by a given DIF object.  It contains an integer variable
+ * identifier along with variable scope and properties, as shown below.  The
+ * size of this structure must be sizeof (int) aligned.
+ */
+typedef struct dtrace_difv {
+        uint32_t dtdv_name;             /* variable name index in dtdo_strtab */
+        uint32_t dtdv_id;               /* variable reference identifier */
+        uint8_t dtdv_kind;              /* variable kind (see below) */
+        uint8_t dtdv_scope;             /* variable scope (see below) */
+        uint16_t dtdv_flags;            /* variable flags (see below) */
+        dtrace_diftype_t dtdv_type;     /* variable type (see above) */
+} dtrace_difv_t;
+
+#define DIFV_KIND_ARRAY         0       /* variable is an array of quantities */
+#define DIFV_KIND_SCALAR        1       /* variable is a scalar quantity */
+
+#define DIFV_SCOPE_GLOBAL       0       /* variable has global scope */
+#define DIFV_SCOPE_THREAD       1       /* variable has thread scope */
+#define DIFV_SCOPE_LOCAL        2       /* variable has local scope */
+
+#define DIFV_F_REF              0x1     /* variable is referenced by DIFO */
+#define DIFV_F_MOD              0x2     /* variable is written by DIFO */
+
+/*
+ * DTrace Actions
+ *
+ * The upper byte determines the class of the action; the low bytes determines
+ * the specific action within that class.  The classes of actions are as
+ * follows:
+ *
+ *   [ no class ]                  <= May record process- or kernel-related data
+ *   DTRACEACT_PROC                <= Only records process-related data
+ *   DTRACEACT_PROC_DESTRUCTIVE    <= Potentially destructive to processes
+ *   DTRACEACT_KERNEL              <= Only records kernel-related data
+ *   DTRACEACT_KERNEL_DESTRUCTIVE  <= Potentially destructive to the kernel
+ *   DTRACEACT_SPECULATIVE         <= Speculation-related action
+ *   DTRACEACT_AGGREGATION         <= Aggregating action
+ */
+#define DTRACEACT_NONE                  0       /* no action */
+#define DTRACEACT_DIFEXPR               1       /* action is DIF expression */
+#define DTRACEACT_EXIT                  2       /* exit() action */
+#define DTRACEACT_PRINTF                3       /* printf() action */
+#define DTRACEACT_PRINTA                4       /* printa() action */
+#define DTRACEACT_LIBACT                5       /* library-controlled action */
+#define DTRACEACT_TRACEMEM              6       /* tracemem() action */
+#define DTRACEACT_TRACEMEM_DYNSIZE      7       /* dynamic tracemem() size */
+
+#if defined(__APPLE__)
+#define DTRACEACT_APPLEBINARY           50      /* Apple DT perf. tool action */
+#endif /* __APPLE__ */
+
+#define DTRACEACT_PROC                  0x0100
+#define DTRACEACT_USTACK                (DTRACEACT_PROC + 1)
+#define DTRACEACT_JSTACK                (DTRACEACT_PROC + 2)
+#define DTRACEACT_USYM                  (DTRACEACT_PROC + 3)
+#define DTRACEACT_UMOD                  (DTRACEACT_PROC + 4)
+#define DTRACEACT_UADDR                 (DTRACEACT_PROC + 5)
+
+#define DTRACEACT_PROC_DESTRUCTIVE      0x0200
+#define DTRACEACT_STOP                  (DTRACEACT_PROC_DESTRUCTIVE + 1)
+#define DTRACEACT_RAISE                 (DTRACEACT_PROC_DESTRUCTIVE + 2)
+#define DTRACEACT_SYSTEM                (DTRACEACT_PROC_DESTRUCTIVE + 3)
+#define DTRACEACT_FREOPEN               (DTRACEACT_PROC_DESTRUCTIVE + 4)
+	
+#if defined(__APPLE__)
+/*
+ * Dtrace stop() will task_suspend the currently running process.
+ * Dtrace pidresume(pid) will task_resume it.
+ */
+	
+#define DTRACEACT_PIDRESUME		(DTRACEACT_PROC_DESTRUCTIVE + 50)
+#endif /* __APPLE__ */	
+
+#define DTRACEACT_PROC_CONTROL          0x0300
+
+#define DTRACEACT_KERNEL                0x0400
+#define DTRACEACT_STACK                 (DTRACEACT_KERNEL + 1)
+#define DTRACEACT_SYM                   (DTRACEACT_KERNEL + 2)
+#define DTRACEACT_MOD                   (DTRACEACT_KERNEL + 3)
+
+#define DTRACEACT_KERNEL_DESTRUCTIVE    0x0500
+#define DTRACEACT_BREAKPOINT            (DTRACEACT_KERNEL_DESTRUCTIVE + 1)
+#define DTRACEACT_PANIC                 (DTRACEACT_KERNEL_DESTRUCTIVE + 2)
+#define DTRACEACT_CHILL                 (DTRACEACT_KERNEL_DESTRUCTIVE + 3)
+
+#define DTRACEACT_SPECULATIVE           0x0600
+#define DTRACEACT_SPECULATE             (DTRACEACT_SPECULATIVE + 1)
+#define DTRACEACT_COMMIT                (DTRACEACT_SPECULATIVE + 2)
+#define DTRACEACT_DISCARD               (DTRACEACT_SPECULATIVE + 3)
+
+#define DTRACEACT_CLASS(x)              ((x) & 0xff00)
+
+#define DTRACEACT_ISDESTRUCTIVE(x)      \
+        (DTRACEACT_CLASS(x) == DTRACEACT_PROC_DESTRUCTIVE || \
+        DTRACEACT_CLASS(x) == DTRACEACT_KERNEL_DESTRUCTIVE)
+
+#define DTRACEACT_ISSPECULATIVE(x)      \
+        (DTRACEACT_CLASS(x) == DTRACEACT_SPECULATIVE)
+
+#define DTRACEACT_ISPRINTFLIKE(x)       \
+        ((x) == DTRACEACT_PRINTF || (x) == DTRACEACT_PRINTA || \
+        (x) == DTRACEACT_SYSTEM || (x) == DTRACEACT_FREOPEN)
+
+/*
+ * DTrace Aggregating Actions
+ *
+ * These are functions f(x) for which the following is true:
+ *
+ *    f(f(x_0) U f(x_1) U ... U f(x_n)) = f(x_0 U x_1 U ... U x_n)
+ *
+ * where x_n is a set of arbitrary data.  Aggregating actions are in their own
+ * DTrace action class, DTTRACEACT_AGGREGATION.  The macros provided here allow
+ * for easier processing of the aggregation argument and data payload for a few
+ * aggregating actions (notably:  quantize(), lquantize(), and ustack()).
+ */
+#define DTRACEACT_AGGREGATION           0x0700
+#define DTRACEAGG_COUNT                 (DTRACEACT_AGGREGATION + 1)
+#define DTRACEAGG_MIN                   (DTRACEACT_AGGREGATION + 2)
+#define DTRACEAGG_MAX                   (DTRACEACT_AGGREGATION + 3)
+#define DTRACEAGG_AVG                   (DTRACEACT_AGGREGATION + 4)
+#define DTRACEAGG_SUM                   (DTRACEACT_AGGREGATION + 5)
+#define DTRACEAGG_STDDEV                (DTRACEACT_AGGREGATION + 6)
+#define DTRACEAGG_QUANTIZE              (DTRACEACT_AGGREGATION + 7)
+#define DTRACEAGG_LQUANTIZE             (DTRACEACT_AGGREGATION + 8)
+#define DTRACEAGG_LLQUANTIZE            (DTRACEACT_AGGREGATION + 9)
+
+#define DTRACEACT_ISAGG(x)              \
+        (DTRACEACT_CLASS(x) == DTRACEACT_AGGREGATION)
+
+#if !defined(__APPLE__)  /* Quiet compiler warning. */
+#define DTRACE_QUANTIZE_NBUCKETS        \
+        (((sizeof (uint64_t) * NBBY) - 1) * 2 + 1)
+
+#define DTRACE_QUANTIZE_ZEROBUCKET      ((sizeof (uint64_t) * NBBY) - 1)
+#else
+#define DTRACE_QUANTIZE_NBUCKETS        \
+        (int)(((sizeof (uint64_t) * NBBY) - 1) * 2 + 1)
+
+#define DTRACE_QUANTIZE_ZEROBUCKET      (int64_t)((sizeof (uint64_t) * NBBY) - 1)
+#endif /* __APPLE __*/
+
+#define DTRACE_QUANTIZE_BUCKETVAL(buck)                                 \
+        (int64_t)((buck) < DTRACE_QUANTIZE_ZEROBUCKET ?                 \
+        -(1LL << (DTRACE_QUANTIZE_ZEROBUCKET - 1 - (buck))) :           \
+        (buck) == DTRACE_QUANTIZE_ZEROBUCKET ? 0 :                      \
+        1LL << ((buck) - DTRACE_QUANTIZE_ZEROBUCKET - 1))
+
+#define DTRACE_LQUANTIZE_STEPSHIFT              48
+#define DTRACE_LQUANTIZE_STEPMASK               ((uint64_t)UINT16_MAX << 48)
+#define DTRACE_LQUANTIZE_LEVELSHIFT             32
+#define DTRACE_LQUANTIZE_LEVELMASK              ((uint64_t)UINT16_MAX << 32)
+#define DTRACE_LQUANTIZE_BASESHIFT              0
+#define DTRACE_LQUANTIZE_BASEMASK               UINT32_MAX
+
+#define DTRACE_LQUANTIZE_STEP(x)                \
+        (uint16_t)(((x) & DTRACE_LQUANTIZE_STEPMASK) >> \
+        DTRACE_LQUANTIZE_STEPSHIFT)
+
+#define DTRACE_LQUANTIZE_LEVELS(x)              \
+        (uint16_t)(((x) & DTRACE_LQUANTIZE_LEVELMASK) >> \
+        DTRACE_LQUANTIZE_LEVELSHIFT)
+
+#define DTRACE_LQUANTIZE_BASE(x)                \
+        (int32_t)(((x) & DTRACE_LQUANTIZE_BASEMASK) >> \
+        DTRACE_LQUANTIZE_BASESHIFT)
+
+#define  DTRACE_LLQUANTIZE_FACTORSHIFT          48
+#define  DTRACE_LLQUANTIZE_FACTORMASK           ((uint64_t)UINT16_MAX << 48)
+#define  DTRACE_LLQUANTIZE_LOWSHIFT             32
+#define  DTRACE_LLQUANTIZE_LOWMASK              ((uint64_t)UINT16_MAX << 32)
+#define  DTRACE_LLQUANTIZE_HIGHSHIFT            16
+#define  DTRACE_LLQUANTIZE_HIGHMASK             ((uint64_t)UINT16_MAX << 16)
+#define  DTRACE_LLQUANTIZE_NSTEPSHIFT           0
+#define  DTRACE_LLQUANTIZE_NSTEPMASK            UINT16_MAX
+
+#define  DTRACE_LLQUANTIZE_FACTOR(x)   \
+        (uint16_t)(((x) & DTRACE_LLQUANTIZE_FACTORMASK) >> \
+        DTRACE_LLQUANTIZE_FACTORSHIFT)
+
+#define  DTRACE_LLQUANTIZE_LOW(x)    \
+        (uint16_t)(((x) & DTRACE_LLQUANTIZE_LOWMASK) >> \
+        DTRACE_LLQUANTIZE_LOWSHIFT)
+
+#define  DTRACE_LLQUANTIZE_HIGH(x)   \
+        (uint16_t)(((x) & DTRACE_LLQUANTIZE_HIGHMASK) >> \
+        DTRACE_LLQUANTIZE_HIGHSHIFT)
+
+#define  DTRACE_LLQUANTIZE_NSTEP(x)    \
+        (uint16_t)(((x) & DTRACE_LLQUANTIZE_NSTEPMASK) >> \
+        DTRACE_LLQUANTIZE_NSTEPSHIFT)
+
+#define DTRACE_USTACK_NFRAMES(x)        (uint32_t)((x) & UINT32_MAX)
+#define DTRACE_USTACK_STRSIZE(x)        (uint32_t)((x) >> 32)
+#define DTRACE_USTACK_ARG(x, y)         \
+        ((((uint64_t)(y)) << 32) | ((x) & UINT32_MAX))
+
+#if !defined(__APPLE__)
+
+#ifndef _LP64
+#ifndef _LITTLE_ENDIAN
+#define DTRACE_PTR(type, name)  uint32_t name##pad; type *name
+#else
+#define DTRACE_PTR(type, name)  type *name; uint32_t name##pad
+#endif
+#else
+#define DTRACE_PTR(type, name)  type *name
+#endif
+
+#else
+
+#ifndef _LP64
+#define DTRACE_PTR(type, name)  user_addr_t name
+#else
+#define DTRACE_PTR(type, name)  type *name
+#endif
+
+#endif /* __APPLE__ */
+
+/*
+ * DTrace Object Format (DOF)
+ *
+ * DTrace programs can be persistently encoded in the DOF format so that they
+ * may be embedded in other programs (for example, in an ELF file) or in the
+ * dtrace driver configuration file for use in anonymous tracing.  The DOF
+ * format is versioned and extensible so that it can be revised and so that
+ * internal data structures can be modified or extended compatibly.  All DOF
+ * structures use fixed-size types, so the 32-bit and 64-bit representations
+ * are identical and consumers can use either data model transparently.
+ *
+ * The file layout is structured as follows:
+ *
+ * +---------------+-------------------+----- ... ----+---- ... ------+
+ * |   dof_hdr_t   |  dof_sec_t[ ... ] |   loadable   | non-loadable  |
+ * | (file header) | (section headers) | section data | section data  |
+ * +---------------+-------------------+----- ... ----+---- ... ------+
+ * |<------------ dof_hdr.dofh_loadsz --------------->|               |
+ * |<------------ dof_hdr.dofh_filesz ------------------------------->|
+ *
+ * The file header stores meta-data including a magic number, data model for
+ * the instrumentation, data encoding, and properties of the DIF code within.
+ * The header describes its own size and the size of the section headers.  By
+ * convention, an array of section headers follows the file header, and then
+ * the data for all loadable sections and unloadable sections.  This permits
+ * consumer code to easily download the headers and all loadable data into the
+ * DTrace driver in one contiguous chunk, omitting other extraneous sections.
+ *
+ * The section headers describe the size, offset, alignment, and section type
+ * for each section.  Sections are described using a set of #defines that tell
+ * the consumer what kind of data is expected.  Sections can contain links to
+ * other sections by storing a dof_secidx_t, an index into the section header
+ * array, inside of the section data structures.  The section header includes
+ * an entry size so that sections with data arrays can grow their structures.
+ *
+ * The DOF data itself can contain many snippets of DIF (i.e. >1 DIFOs), which
+ * are represented themselves as a collection of related DOF sections.  This
+ * permits us to change the set of sections associated with a DIFO over time,
+ * and also permits us to encode DIFOs that contain different sets of sections.
+ * When a DOF section wants to refer to a DIFO, it stores the dof_secidx_t of a
+ * section of type DOF_SECT_DIFOHDR.  This section's data is then an array of
+ * dof_secidx_t's which in turn denote the sections associated with this DIFO.
+ *
+ * This loose coupling of the file structure (header and sections) to the
+ * structure of the DTrace program itself (ECB descriptions, action
+ * descriptions, and DIFOs) permits activities such as relocation processing
+ * to occur in a single pass without having to understand D program structure.
+ *
+ * Finally, strings are always stored in ELF-style string tables along with a
+ * string table section index and string table offset.  Therefore strings in
+ * DOF are always arbitrary-length and not bound to the current implementation.
+ */
+
+#define DOF_ID_SIZE     16      /* total size of dofh_ident[] in bytes */
+
+typedef struct dof_hdr {
+        uint8_t dofh_ident[DOF_ID_SIZE]; /* identification bytes (see below) */
+        uint32_t dofh_flags;            /* file attribute flags (if any) */
+        uint32_t dofh_hdrsize;          /* size of file header in bytes */
+        uint32_t dofh_secsize;          /* size of section header in bytes */
+        uint32_t dofh_secnum;           /* number of section headers */
+        uint64_t dofh_secoff;           /* file offset of section headers */
+        uint64_t dofh_loadsz;           /* file size of loadable portion */
+        uint64_t dofh_filesz;           /* file size of entire DOF file */
+        uint64_t dofh_pad;              /* reserved for future use */
+} dof_hdr_t;
+
+#define DOF_ID_MAG0     0       /* first byte of magic number */
+#define DOF_ID_MAG1     1       /* second byte of magic number */
+#define DOF_ID_MAG2     2       /* third byte of magic number */
+#define DOF_ID_MAG3     3       /* fourth byte of magic number */
+#define DOF_ID_MODEL    4       /* DOF data model (see below) */
+#define DOF_ID_ENCODING 5       /* DOF data encoding (see below) */
+#define DOF_ID_VERSION  6       /* DOF file format major version (see below) */
+#define DOF_ID_DIFVERS  7       /* DIF instruction set version */
+#define DOF_ID_DIFIREG  8       /* DIF integer registers used by compiler */
+#define DOF_ID_DIFTREG  9       /* DIF tuple registers used by compiler */
+#define DOF_ID_PAD      10      /* start of padding bytes (all zeroes) */
+
+#define DOF_MAG_MAG0    0x7F    /* DOF_ID_MAG[0-3] */
+#define DOF_MAG_MAG1    'D'
+#define DOF_MAG_MAG2    'O'
+#define DOF_MAG_MAG3    'F'
+
+#define DOF_MAG_STRING  "\177DOF"
+#define DOF_MAG_STRLEN  4
+
+#define DOF_MODEL_NONE  0       /* DOF_ID_MODEL */
+#define DOF_MODEL_ILP32 1
+#define DOF_MODEL_LP64  2
+
+#ifdef _LP64
+#define DOF_MODEL_NATIVE        DOF_MODEL_LP64
+#else
+#define DOF_MODEL_NATIVE        DOF_MODEL_ILP32
+#endif
+
+#define DOF_ENCODE_NONE 0       /* DOF_ID_ENCODING */
+#define DOF_ENCODE_LSB  1
+#define DOF_ENCODE_MSB  2
+
+#ifdef _BIG_ENDIAN
+#define DOF_ENCODE_NATIVE       DOF_ENCODE_MSB
+#else
+#define DOF_ENCODE_NATIVE       DOF_ENCODE_LSB
+#endif
+
+#define	DOF_VERSION_1	1	/* DOF version 1: Solaris 10 FCS */
+#define	DOF_VERSION_2	2	/* DOF version 2: Solaris Express 6/06 */
+#if !defined(__APPLE__)
+#define	DOF_VERSION	DOF_VERSION_2	/* Latest DOF version */
+#else
+#define	DOF_VERSION_3	3	/* DOF version 3: Minimum version for Leopard */
+#define	DOF_VERSION	DOF_VERSION_3	/* Latest DOF version */
+#endif /* __APPLE__ */
+
+#define DOF_FL_VALID    0       /* mask of all valid dofh_flags bits */
+
+typedef uint32_t dof_secidx_t;  /* section header table index type */
+typedef uint32_t dof_stridx_t;  /* string table index type */
+
+#define DOF_SECIDX_NONE (-1U)   /* null value for section indices */
+#define DOF_STRIDX_NONE (-1U)   /* null value for string indices */
+
+typedef struct dof_sec {
+        uint32_t dofs_type;     /* section type (see below) */
+        uint32_t dofs_align;    /* section data memory alignment */
+        uint32_t dofs_flags;    /* section flags (if any) */
+        uint32_t dofs_entsize;  /* size of section entry (if table) */
+        uint64_t dofs_offset;   /* offset of section data within file */
+        uint64_t dofs_size;     /* size of section data in bytes */
+} dof_sec_t;
+
+#define	DOF_SECT_NONE		0	/* null section */
+#define	DOF_SECT_COMMENTS	1	/* compiler comments */
+#define	DOF_SECT_SOURCE		2	/* D program source code */
+#define	DOF_SECT_ECBDESC	3	/* dof_ecbdesc_t */
+#define	DOF_SECT_PROBEDESC	4	/* dof_probedesc_t */
+#define	DOF_SECT_ACTDESC	5	/* dof_actdesc_t array */
+#define	DOF_SECT_DIFOHDR	6	/* dof_difohdr_t (variable length) */
+#define	DOF_SECT_DIF		7	/* uint32_t array of byte code */
+#define	DOF_SECT_STRTAB		8	/* string table */
+#define	DOF_SECT_VARTAB		9	/* dtrace_difv_t array */
+#define	DOF_SECT_RELTAB		10	/* dof_relodesc_t array */
+#define	DOF_SECT_TYPTAB		11	/* dtrace_diftype_t array */
+#define	DOF_SECT_URELHDR	12	/* dof_relohdr_t (user relocations) */
+#define	DOF_SECT_KRELHDR	13	/* dof_relohdr_t (kernel relocations) */
+#define	DOF_SECT_OPTDESC	14	/* dof_optdesc_t array */
+#define	DOF_SECT_PROVIDER	15	/* dof_provider_t */
+#define	DOF_SECT_PROBES		16	/* dof_probe_t array */
+#define	DOF_SECT_PRARGS		17	/* uint8_t array (probe arg mappings) */
+#define	DOF_SECT_PROFFS		18	/* uint32_t array (probe arg offsets) */
+#define	DOF_SECT_INTTAB		19	/* uint64_t array */
+#define	DOF_SECT_UTSNAME	20	/* struct utsname */
+#define	DOF_SECT_XLTAB		21	/* dof_xlref_t array */
+#define	DOF_SECT_XLMEMBERS	22	/* dof_xlmember_t array */
+#define	DOF_SECT_XLIMPORT	23	/* dof_xlator_t */
+#define	DOF_SECT_XLEXPORT	24	/* dof_xlator_t */
+#define	DOF_SECT_PREXPORT	25	/* dof_secidx_t array (exported objs) */
+#define	DOF_SECT_PRENOFFS	26	/* uint32_t array (enabled offsets) */
+
+#define DOF_SECF_LOAD           1       /* section should be loaded */
+
+typedef struct dof_ecbdesc {
+        dof_secidx_t dofe_probes;       /* link to DOF_SECT_PROBEDESC */
+        dof_secidx_t dofe_pred;         /* link to DOF_SECT_DIFOHDR */
+        dof_secidx_t dofe_actions;      /* link to DOF_SECT_ACTDESC */
+        uint32_t dofe_pad;              /* reserved for future use */
+        uint64_t dofe_uarg;             /* user-supplied library argument */
+} dof_ecbdesc_t;
+
+typedef struct dof_probedesc {
+        dof_secidx_t dofp_strtab;       /* link to DOF_SECT_STRTAB section */
+        dof_stridx_t dofp_provider;     /* provider string */
+        dof_stridx_t dofp_mod;          /* module string */
+        dof_stridx_t dofp_func;         /* function string */
+        dof_stridx_t dofp_name;         /* name string */
+        uint32_t dofp_id;               /* probe identifier (or zero) */
+} dof_probedesc_t;
+
+typedef struct dof_actdesc {
+        dof_secidx_t dofa_difo;         /* link to DOF_SECT_DIFOHDR */
+        dof_secidx_t dofa_strtab;       /* link to DOF_SECT_STRTAB section */
+        uint32_t dofa_kind;             /* action kind (DTRACEACT_* constant) */
+        uint32_t dofa_ntuple;           /* number of subsequent tuple actions */
+        uint64_t dofa_arg;              /* kind-specific argument */
+        uint64_t dofa_uarg;             /* user-supplied argument */
+} dof_actdesc_t;
+
+typedef struct dof_difohdr {
+        dtrace_diftype_t dofd_rtype;    /* return type for this fragment */
+        dof_secidx_t dofd_links[1];     /* variable length array of indices */
+} dof_difohdr_t;
+
+typedef struct dof_relohdr {
+        dof_secidx_t dofr_strtab;       /* link to DOF_SECT_STRTAB for names */
+        dof_secidx_t dofr_relsec;       /* link to DOF_SECT_RELTAB for relos */
+        dof_secidx_t dofr_tgtsec;       /* link to section we are relocating */
+} dof_relohdr_t;
+
+typedef struct dof_relodesc {
+        dof_stridx_t dofr_name;         /* string name of relocation symbol */
+        uint32_t dofr_type;             /* relo type (DOF_RELO_* constant) */
+        uint64_t dofr_offset;           /* byte offset for relocation */
+        uint64_t dofr_data;             /* additional type-specific data */
+} dof_relodesc_t;
+
+#define DOF_RELO_NONE   0               /* empty relocation entry */
+#define DOF_RELO_SETX   1               /* relocate setx value */
+
+typedef struct dof_optdesc {
+        uint32_t dofo_option;           /* option identifier */
+        dof_secidx_t dofo_strtab;       /* string table, if string option */
+        uint64_t dofo_value;            /* option value or string index */
+} dof_optdesc_t;
+
+typedef uint32_t dof_attr_t;            /* encoded stability attributes */
+
+#define DOF_ATTR(n, d, c)       (((n) << 24) | ((d) << 16) | ((c) << 8))
+#define DOF_ATTR_NAME(a)        (((a) >> 24) & 0xff)
+#define DOF_ATTR_DATA(a)        (((a) >> 16) & 0xff)
+#define DOF_ATTR_CLASS(a)       (((a) >>  8) & 0xff)
+
+typedef struct dof_provider {
+	dof_secidx_t dofpv_strtab;	/* link to DOF_SECT_STRTAB section */
+	dof_secidx_t dofpv_probes;	/* link to DOF_SECT_PROBES section */
+	dof_secidx_t dofpv_prargs;	/* link to DOF_SECT_PRARGS section */
+	dof_secidx_t dofpv_proffs;	/* link to DOF_SECT_PROFFS section */
+	dof_stridx_t dofpv_name;	/* provider name string */
+	dof_attr_t dofpv_provattr;	/* provider attributes */
+	dof_attr_t dofpv_modattr;	/* module attributes */
+	dof_attr_t dofpv_funcattr;	/* function attributes */
+	dof_attr_t dofpv_nameattr;	/* name attributes */
+	dof_attr_t dofpv_argsattr;	/* args attributes */
+	dof_secidx_t dofpv_prenoffs;	/* link to DOF_SECT_PRENOFFS section */
+} dof_provider_t;
+
+typedef struct dof_probe {
+	uint64_t dofpr_addr;		/* probe base address or offset */
+	dof_stridx_t dofpr_func;	/* probe function string */
+	dof_stridx_t dofpr_name;	/* probe name string */
+	dof_stridx_t dofpr_nargv;	/* native argument type strings */
+	dof_stridx_t dofpr_xargv;	/* translated argument type strings */
+	uint32_t dofpr_argidx;		/* index of first argument mapping */
+	uint32_t dofpr_offidx;		/* index of first offset entry */
+	uint8_t dofpr_nargc;		/* native argument count */
+	uint8_t dofpr_xargc;		/* translated argument count */
+	uint16_t dofpr_noffs;		/* number of offset entries for probe */
+	uint32_t dofpr_enoffidx;	/* index of first is-enabled offset */
+	uint16_t dofpr_nenoffs;		/* number of is-enabled offsets */
+	uint16_t dofpr_pad1;		/* reserved for future use */
+	uint32_t dofpr_pad2;		/* reserved for future use */
+} dof_probe_t;
+
+typedef struct dof_xlator {
+        dof_secidx_t dofxl_members;     /* link to DOF_SECT_XLMEMBERS section */
+        dof_secidx_t dofxl_strtab;      /* link to DOF_SECT_STRTAB section */
+        dof_stridx_t dofxl_argv;        /* input parameter type strings */
+        uint32_t dofxl_argc;            /* input parameter list length */
+        dof_stridx_t dofxl_type;        /* output type string name */
+        dof_attr_t dofxl_attr;          /* output stability attributes */
+} dof_xlator_t;
+
+typedef struct dof_xlmember {
+        dof_secidx_t dofxm_difo;        /* member link to DOF_SECT_DIFOHDR */
+        dof_stridx_t dofxm_name;        /* member name */
+        dtrace_diftype_t dofxm_type;    /* member type */
+} dof_xlmember_t;
+
+typedef struct dof_xlref {
+        dof_secidx_t dofxr_xlator;      /* link to DOF_SECT_XLATORS section */
+        uint32_t dofxr_member;          /* index of referenced dof_xlmember */
+        uint32_t dofxr_argn;            /* index of argument for DIF_OP_XLARG */
+} dof_xlref_t;
+
+/*
+ * DTrace Intermediate Format Object (DIFO)
+ *
+ * A DIFO is used to store the compiled DIF for a D expression, its return
+ * type, and its string and variable tables.  The string table is a single
+ * buffer of character data into which sets instructions and variable
+ * references can reference strings using a byte offset.  The variable table
+ * is an array of dtrace_difv_t structures that describe the name and type of
+ * each variable and the id used in the DIF code.  This structure is described
+ * above in the DIF section of this header file.  The DIFO is used at both
+ * user-level (in the library) and in the kernel, but the structure is never
+ * passed between the two: the DOF structures form the only interface.  As a
+ * result, the definition can change depending on the presence of _KERNEL.
+ */
+typedef struct dtrace_difo {
+        dif_instr_t *dtdo_buf;          /* instruction buffer */
+        uint64_t *dtdo_inttab;          /* integer table (optional) */
+        char *dtdo_strtab;              /* string table (optional) */
+        dtrace_difv_t *dtdo_vartab;     /* variable table (optional) */
+        uint_t dtdo_len;                /* length of instruction buffer */
+        uint_t dtdo_intlen;             /* length of integer table */
+        uint_t dtdo_strlen;             /* length of string table */
+        uint_t dtdo_varlen;             /* length of variable table */
+        dtrace_diftype_t dtdo_rtype;    /* return type */
+        uint_t dtdo_refcnt;             /* owner reference count */
+        uint_t dtdo_destructive;        /* invokes destructive subroutines */
+#ifndef _KERNEL
+        dof_relodesc_t *dtdo_kreltab;   /* kernel relocations */
+        dof_relodesc_t *dtdo_ureltab;   /* user relocations */
+        struct dt_node **dtdo_xlmtab;   /* translator references */
+        uint_t dtdo_krelen;             /* length of krelo table */
+        uint_t dtdo_urelen;             /* length of urelo table */
+        uint_t dtdo_xlmlen;             /* length of translator table */
+#endif
+} dtrace_difo_t;
+
+/*
+ * DTrace Enabling Description Structures
+ *
+ * When DTrace is tracking the description of a DTrace enabling entity (probe,
+ * predicate, action, ECB, record, etc.), it does so in a description
+ * structure.  These structures all end in "desc", and are used at both
+ * user-level and in the kernel -- but (with the exception of
+ * dtrace_probedesc_t) they are never passed between them.  Typically,
+ * user-level will use the description structures when assembling an enabling.
+ * It will then distill those description structures into a DOF object (see
+ * above), and send it into the kernel.  The kernel will again use the
+ * description structures to create a description of the enabling as it reads
+ * the DOF.  When the description is complete, the enabling will be actually
+ * created -- turning it into the structures that represent the enabling
+ * instead of merely describing it.  Not surprisingly, the description
+ * structures bear a strong resemblance to the DOF structures that act as their
+ * conduit.
+ */
+struct dtrace_predicate;
+
+typedef struct dtrace_probedesc {
+        dtrace_id_t dtpd_id;                    /* probe identifier */
+        char dtpd_provider[DTRACE_PROVNAMELEN]; /* probe provider name */
+        char dtpd_mod[DTRACE_MODNAMELEN];       /* probe module name */
+        char dtpd_func[DTRACE_FUNCNAMELEN];     /* probe function name */
+        char dtpd_name[DTRACE_NAMELEN];         /* probe name */
+} dtrace_probedesc_t;
+
+typedef struct dtrace_repldesc {
+        dtrace_probedesc_t dtrpd_match;         /* probe descr. to match */
+        dtrace_probedesc_t dtrpd_create;        /* probe descr. to create */
+} dtrace_repldesc_t;
+
+typedef struct dtrace_preddesc {
+        dtrace_difo_t *dtpdd_difo;              /* pointer to DIF object */
+        struct dtrace_predicate *dtpdd_predicate; /* pointer to predicate */
+} dtrace_preddesc_t;
+
+typedef struct dtrace_actdesc {
+        dtrace_difo_t *dtad_difo;               /* pointer to DIF object */
+        struct dtrace_actdesc *dtad_next;       /* next action */
+        dtrace_actkind_t dtad_kind;             /* kind of action */
+        uint32_t dtad_ntuple;                   /* number in tuple */
+        uint64_t dtad_arg;                      /* action argument */
+        uint64_t dtad_uarg;                     /* user argument */
+        int dtad_refcnt;                        /* reference count */
+} dtrace_actdesc_t;
+
+typedef struct dtrace_ecbdesc {
+        dtrace_actdesc_t *dted_action;          /* action description(s) */
+        dtrace_preddesc_t dted_pred;            /* predicate description */
+        dtrace_probedesc_t dted_probe;          /* probe description */
+        uint64_t dted_uarg;                     /* library argument */
+        int dted_refcnt;                        /* reference count */
+} dtrace_ecbdesc_t;
+
+/*
+ * DTrace Metadata Description Structures
+ *
+ * DTrace separates the trace data stream from the metadata stream.  The only
+ * metadata tokens placed in the data stream are enabled probe identifiers
+ * (EPIDs) or (in the case of aggregations) aggregation identifiers.  In order
+ * to determine the structure of the data, DTrace consumers pass the token to
+ * the kernel, and receive in return a corresponding description of the enabled
+ * probe (via the dtrace_eprobedesc structure) or the aggregation (via the
+ * dtrace_aggdesc structure).  Both of these structures are expressed in terms
+ * of record descriptions (via the dtrace_recdesc structure) that describe the
+ * exact structure of the data.  Some record descriptions may also contain a
+ * format identifier; this additional bit of metadata can be retrieved from the
+ * kernel, for which a format description is returned via the dtrace_fmtdesc
+ * structure.  Note that all four of these structures must be bitness-neutral
+ * to allow for a 32-bit DTrace consumer on a 64-bit kernel.
+ */
+typedef struct dtrace_recdesc {
+        dtrace_actkind_t dtrd_action;           /* kind of action */
+        uint32_t dtrd_size;                     /* size of record */
+        uint32_t dtrd_offset;                   /* offset in ECB's data */
+        uint16_t dtrd_alignment;                /* required alignment */
+        uint16_t dtrd_format;                   /* format, if any */
+        uint64_t dtrd_arg;                      /* action argument */
+        uint64_t dtrd_uarg;                     /* user argument */
+} dtrace_recdesc_t;
+
+typedef struct dtrace_eprobedesc {
+        dtrace_epid_t dtepd_epid;               /* enabled probe ID */
+        dtrace_id_t dtepd_probeid;              /* probe ID */
+        uint64_t dtepd_uarg;                    /* library argument */
+        uint32_t dtepd_size;                    /* total size */
+        int dtepd_nrecs;                        /* number of records */
+        dtrace_recdesc_t dtepd_rec[1];          /* records themselves */
+} dtrace_eprobedesc_t;
+
+typedef struct dtrace_aggdesc {
+	DTRACE_PTR(char, dtagd_name);		/* not filled in by kernel */
+	dtrace_aggvarid_t dtagd_varid;		/* not filled in by kernel */
+	int dtagd_flags;			/* not filled in by kernel */
+	dtrace_aggid_t dtagd_id;		/* aggregation ID */
+	dtrace_epid_t dtagd_epid;		/* enabled probe ID */
+	uint32_t dtagd_size;			/* size in bytes */
+	int dtagd_nrecs;			/* number of records */
+	uint32_t dtagd_pad;			/* explicit padding */
+	dtrace_recdesc_t dtagd_rec[1];		/* record descriptions */
+} dtrace_aggdesc_t;
+
+typedef struct dtrace_fmtdesc {
+        DTRACE_PTR(char, dtfd_string);          /* format string */
+        int dtfd_length;                        /* length of format string */
+        uint16_t dtfd_format;                   /* format identifier */
+} dtrace_fmtdesc_t;
+
+#define DTRACE_SIZEOF_EPROBEDESC(desc)                          \
+        (sizeof (dtrace_eprobedesc_t) + ((desc)->dtepd_nrecs ?  \
+        (((desc)->dtepd_nrecs - 1) * sizeof (dtrace_recdesc_t)) : 0))
+
+#define DTRACE_SIZEOF_AGGDESC(desc)                             \
+        (sizeof (dtrace_aggdesc_t) + ((desc)->dtagd_nrecs ?     \
+        (((desc)->dtagd_nrecs - 1) * sizeof (dtrace_recdesc_t)) : 0))
+
+/*
+ * DTrace Option Interface
+ *
+ * Run-time DTrace options are set and retrieved via DOF_SECT_OPTDESC sections
+ * in a DOF image.  The dof_optdesc structure contains an option identifier and
+ * an option value.  The valid option identifiers are found below; the mapping
+ * between option identifiers and option identifying strings is maintained at
+ * user-level.  Note that the value of DTRACEOPT_UNSET is such that all of the
+ * following are potentially valid option values:  all positive integers, zero
+ * and negative one.  Some options (notably "bufpolicy" and "bufresize") take
+ * predefined tokens as their values; these are defined with
+ * DTRACEOPT_{option}_{token}.
+ */
+#define	DTRACEOPT_BUFSIZE	0	/* buffer size */
+#define	DTRACEOPT_BUFPOLICY	1	/* buffer policy */
+#define	DTRACEOPT_DYNVARSIZE	2	/* dynamic variable size */
+#define	DTRACEOPT_AGGSIZE	3	/* aggregation size */
+#define	DTRACEOPT_SPECSIZE	4	/* speculation size */
+#define	DTRACEOPT_NSPEC		5	/* number of speculations */
+#define	DTRACEOPT_STRSIZE	6	/* string size */
+#define	DTRACEOPT_CLEANRATE	7	/* dynvar cleaning rate */
+#define	DTRACEOPT_CPU		8	/* CPU to trace */
+#define	DTRACEOPT_BUFRESIZE	9	/* buffer resizing policy */
+#define	DTRACEOPT_GRABANON	10	/* grab anonymous state, if any */
+#define	DTRACEOPT_FLOWINDENT	11	/* indent function entry/return */
+#define	DTRACEOPT_QUIET		12	/* only output explicitly traced data */
+#define	DTRACEOPT_STACKFRAMES	13	/* number of stack frames */
+#define	DTRACEOPT_USTACKFRAMES	14	/* number of user stack frames */
+#define	DTRACEOPT_AGGRATE	15	/* aggregation snapshot rate */
+#define	DTRACEOPT_SWITCHRATE	16	/* buffer switching rate */
+#define	DTRACEOPT_STATUSRATE	17	/* status rate */
+#define	DTRACEOPT_DESTRUCTIVE	18	/* destructive actions allowed */
+#define	DTRACEOPT_STACKINDENT	19	/* output indent for stack traces */
+#define	DTRACEOPT_RAWBYTES	20	/* always print bytes in raw form */
+#define	DTRACEOPT_JSTACKFRAMES	21	/* number of jstack() frames */
+#define	DTRACEOPT_JSTACKSTRSIZE	22	/* size of jstack() string table */
+#define	DTRACEOPT_AGGSORTKEY	23	/* sort aggregations by key */
+#define	DTRACEOPT_AGGSORTREV	24	/* reverse-sort aggregations */
+#define	DTRACEOPT_AGGSORTPOS	25	/* agg. position to sort on */
+#define	DTRACEOPT_AGGSORTKEYPOS	26	/* agg. key position to sort on */
+#define	DTRACEOPT_AGGHIST	27 	/* histogram aggregation output */
+#define	DTRACEOPT_AGGPACK	28 	/* packed aggregation output */
+#define	DTRACEOPT_AGGZOOM	29 	/* zoomed aggregation scaling */
+#if !defined(__APPLE__)
+#define DTRACEOPT_MAX           30      /* number of options */
+#else
+#define DTRACEOPT_STACKSYMBOLS  30      /* clear to prevent stack symbolication */
+#define DTRACEOPT_MAX           31      /* number of options */
+#endif /* __APPLE__ */
+
+#define	DTRACEOPT_UNSET		(dtrace_optval_t)-2	/* unset option */
+
+#define	DTRACEOPT_BUFPOLICY_RING	0	/* ring buffer */
+#define	DTRACEOPT_BUFPOLICY_FILL	1	/* fill buffer, then stop */
+#define	DTRACEOPT_BUFPOLICY_SWITCH	2	/* switch buffers */
+
+#define DTRACEOPT_BUFRESIZE_AUTO        0       /* automatic resizing */
+#define DTRACEOPT_BUFRESIZE_MANUAL      1       /* manual resizing */
+
+/*
+ * DTrace Buffer Interface
+ *
+ * In order to get a snapshot of the principal or aggregation buffer,
+ * user-level passes a buffer description to the kernel with the dtrace_bufdesc
+ * structure.  This describes which CPU user-level is interested in, and
+ * where user-level wishes the kernel to snapshot the buffer to (the
+ * dtbd_data field).  The kernel uses the same structure to pass back some
+ * information regarding the buffer:  the size of data actually copied out, the
+ * number of drops, the number of errors, and the offset of the oldest record.
+ * If the buffer policy is a "switch" policy, taking a snapshot of the
+ * principal buffer has the additional effect of switching the active and
+ * inactive buffers.  Taking a snapshot of the aggregation buffer _always_ has
+ * the additional effect of switching the active and inactive buffers.
+ */
+typedef struct dtrace_bufdesc {
+        uint64_t dtbd_size;                     /* size of buffer */
+        uint32_t dtbd_cpu;                      /* CPU or DTRACE_CPUALL */
+        uint32_t dtbd_errors;                   /* number of errors */
+        uint64_t dtbd_drops;                    /* number of drops */
+        DTRACE_PTR(char, dtbd_data);            /* data */
+        uint64_t dtbd_oldest;                   /* offset of oldest record */
+} dtrace_bufdesc_t;
+
+/*
+ * DTrace Status
+ *
+ * The status of DTrace is relayed via the dtrace_status structure.  This
+ * structure contains members to count drops other than the capacity drops
+ * available via the buffer interface (see above).  This consists of dynamic
+ * drops (including capacity dynamic drops, rinsing drops and dirty drops), and
+ * speculative drops (including capacity speculative drops, drops due to busy
+ * speculative buffers and drops due to unavailable speculative buffers).
+ * Additionally, the status structure contains a field to indicate the number
+ * of "fill"-policy buffers have been filled and a boolean field to indicate
+ * that exit() has been called.  If the dtst_exiting field is non-zero, no
+ * further data will be generated until tracing is stopped (at which time any
+ * enablings of the END action will be processed); if user-level sees that
+ * this field is non-zero, tracing should be stopped as soon as possible.
+ */
+typedef struct dtrace_status {
+        uint64_t dtst_dyndrops;                 /* dynamic drops */
+        uint64_t dtst_dyndrops_rinsing;         /* dyn drops due to rinsing */
+        uint64_t dtst_dyndrops_dirty;           /* dyn drops due to dirty */
+        uint64_t dtst_specdrops;                /* speculative drops */
+        uint64_t dtst_specdrops_busy;           /* spec drops due to busy */
+        uint64_t dtst_specdrops_unavail;        /* spec drops due to unavail */
+        uint64_t dtst_errors;                   /* total errors */
+        uint64_t dtst_filled;                   /* number of filled bufs */
+        uint64_t dtst_stkstroverflows;          /* stack string tab overflows */
+        uint64_t dtst_dblerrors;                /* errors in ERROR probes */
+        char dtst_killed;                       /* non-zero if killed */
+        char dtst_exiting;                      /* non-zero if exit() called */
+        char dtst_pad[6];                       /* pad out to 64-bit align */
+} dtrace_status_t;
+
+/*
+ * DTrace Configuration
+ *
+ * User-level may need to understand some elements of the kernel DTrace
+ * configuration in order to generate correct DIF.  This information is
+ * conveyed via the dtrace_conf structure.
+ */
+typedef struct dtrace_conf {
+        uint_t dtc_difversion;                  /* supported DIF version */
+        uint_t dtc_difintregs;                  /* # of DIF integer registers */
+        uint_t dtc_diftupregs;                  /* # of DIF tuple registers */
+        uint_t dtc_ctfmodel;                    /* CTF data model */
+        uint_t dtc_pad[8];                      /* reserved for future use */
+} dtrace_conf_t;
+
+/*
+ * DTrace Faults
+ *
+ * The constants below DTRACEFLT_LIBRARY indicate probe processing faults;
+ * constants at or above DTRACEFLT_LIBRARY indicate faults in probe
+ * postprocessing at user-level.  Probe processing faults induce an ERROR
+ * probe and are replicated in unistd.d to allow users' ERROR probes to decode
+ * the error condition using thse symbolic labels.
+ */
+#define DTRACEFLT_UNKNOWN               0       /* Unknown fault */
+#define DTRACEFLT_BADADDR               1       /* Bad address */
+#define DTRACEFLT_BADALIGN              2       /* Bad alignment */
+#define DTRACEFLT_ILLOP                 3       /* Illegal operation */
+#define DTRACEFLT_DIVZERO               4       /* Divide-by-zero */
+#define DTRACEFLT_NOSCRATCH             5       /* Out of scratch space */
+#define DTRACEFLT_KPRIV                 6       /* Illegal kernel access */
+#define DTRACEFLT_UPRIV                 7       /* Illegal user access */
+#define DTRACEFLT_TUPOFLOW              8       /* Tuple stack overflow */
+#define	DTRACEFLT_BADSTACK		9	/* Bad stack */
+
+#define DTRACEFLT_LIBRARY               1000    /* Library-level fault */
+
+/*
+ * DTrace Argument Types
+ *
+ * Because it would waste both space and time, argument types do not reside
+ * with the probe.  In order to determine argument types for args[X]
+ * variables, the D compiler queries for argument types on a probe-by-probe
+ * basis.  (This optimizes for the common case that arguments are either not
+ * used or used in an untyped fashion.)  Typed arguments are specified with a
+ * string of the type name in the dtragd_native member of the argument
+ * description structure.  Typed arguments may be further translated to types
+ * of greater stability; the provider indicates such a translated argument by
+ * filling in the dtargd_xlate member with the string of the translated type.
+ * Finally, the provider may indicate which argument value a given argument
+ * maps to by setting the dtargd_mapping member -- allowing a single argument
+ * to map to multiple args[X] variables.
+ */
+typedef struct dtrace_argdesc {
+        dtrace_id_t dtargd_id;                  /* probe identifier */
+        int dtargd_ndx;                         /* arg number (-1 iff none) */
+        int dtargd_mapping;                     /* value mapping */
+        char dtargd_native[DTRACE_ARGTYPELEN];  /* native type name */
+        char dtargd_xlate[DTRACE_ARGTYPELEN];   /* translated type name */
+} dtrace_argdesc_t;
+
+/*
+ * DTrace Stability Attributes
+ *
+ * Each DTrace provider advertises the name and data stability of each of its
+ * probe description components, as well as its architectural dependencies.
+ * The D compiler can query the provider attributes (dtrace_pattr_t below) in
+ * order to compute the properties of an input program and report them.
+ */
+typedef uint8_t dtrace_stability_t;     /* stability code (see attributes(5)) */
+typedef uint8_t dtrace_class_t;         /* architectural dependency class */
+
+#define	DTRACE_STABILITY_INTERNAL	0	/* private to DTrace itself */
+#define	DTRACE_STABILITY_PRIVATE	1	/* private to Sun (see docs) */
+#define	DTRACE_STABILITY_OBSOLETE	2	/* scheduled for removal */
+#define	DTRACE_STABILITY_EXTERNAL	3	/* not controlled by Sun */
+#define	DTRACE_STABILITY_UNSTABLE	4	/* new or rapidly changing */
+#define	DTRACE_STABILITY_EVOLVING	5	/* less rapidly changing */
+#define	DTRACE_STABILITY_STABLE		6	/* mature interface from Sun */
+#define	DTRACE_STABILITY_STANDARD	7	/* industry standard */
+#define	DTRACE_STABILITY_MAX		7	/* maximum valid stability */
+
+#define	DTRACE_CLASS_UNKNOWN	0	/* unknown architectural dependency */
+#define	DTRACE_CLASS_CPU	1	/* CPU-module-specific */
+#define	DTRACE_CLASS_PLATFORM	2	/* platform-specific (uname -i) */
+#define	DTRACE_CLASS_GROUP	3	/* hardware-group-specific (uname -m) */
+#define	DTRACE_CLASS_ISA	4	/* ISA-specific (uname -p) */
+#define	DTRACE_CLASS_COMMON	5	/* common to all systems */
+#define	DTRACE_CLASS_MAX	5	/* maximum valid class */
+
+#define	DTRACE_PRIV_NONE	0x0000
+#define	DTRACE_PRIV_KERNEL	0x0001
+#define	DTRACE_PRIV_USER	0x0002
+#define	DTRACE_PRIV_PROC	0x0004
+#define	DTRACE_PRIV_OWNER	0x0008
+#define	DTRACE_PRIV_ZONEOWNER	0x0010
+
+#define	DTRACE_PRIV_ALL	\
+	(DTRACE_PRIV_KERNEL | DTRACE_PRIV_USER | \
+	DTRACE_PRIV_PROC | DTRACE_PRIV_OWNER | DTRACE_PRIV_ZONEOWNER)
+
+typedef struct dtrace_ppriv {
+	uint32_t dtpp_flags;			/* privilege flags */
+	uid_t dtpp_uid;				/* user ID */
+	zoneid_t dtpp_zoneid;			/* zone ID */
+} dtrace_ppriv_t;
+
+typedef struct dtrace_attribute {
+        dtrace_stability_t dtat_name;           /* entity name stability */
+        dtrace_stability_t dtat_data;           /* entity data stability */
+        dtrace_class_t dtat_class;              /* entity data dependency */
+} dtrace_attribute_t;
+
+typedef struct dtrace_pattr {
+        dtrace_attribute_t dtpa_provider;       /* provider attributes */
+        dtrace_attribute_t dtpa_mod;            /* module attributes */
+        dtrace_attribute_t dtpa_func;           /* function attributes */
+        dtrace_attribute_t dtpa_name;           /* name attributes */
+        dtrace_attribute_t dtpa_args;           /* args[] attributes */
+} dtrace_pattr_t;
+
+typedef struct dtrace_providerdesc {
+        char dtvd_name[DTRACE_PROVNAMELEN];     /* provider name */
+        dtrace_pattr_t dtvd_attr;               /* stability attributes */
+        dtrace_ppriv_t dtvd_priv;               /* privileges required */
+} dtrace_providerdesc_t;
+
+/*
+ * DTrace Pseudodevice Interface
+ *
+ * DTrace is controlled through ioctl(2)'s to the in-kernel dtrace:dtrace
+ * pseudodevice driver.  These ioctls comprise the user-kernel interface to
+ * DTrace.
+ */
+#if !defined(__APPLE__)
+#define DTRACEIOC               (('d' << 24) | ('t' << 16) | ('r' << 8))
+#define DTRACEIOC_PROVIDER      (DTRACEIOC | 1)         /* provider query */
+#define DTRACEIOC_PROBES        (DTRACEIOC | 2)         /* probe query */
+#define DTRACEIOC_BUFSNAP       (DTRACEIOC | 4)         /* snapshot buffer */
+#define DTRACEIOC_PROBEMATCH    (DTRACEIOC | 5)         /* match probes */
+#define DTRACEIOC_ENABLE        (DTRACEIOC | 6)         /* enable probes */
+#define DTRACEIOC_AGGSNAP       (DTRACEIOC | 7)         /* snapshot agg. */
+#define DTRACEIOC_EPROBE        (DTRACEIOC | 8)         /* get eprobe desc. */
+#define DTRACEIOC_PROBEARG      (DTRACEIOC | 9)         /* get probe arg */
+#define DTRACEIOC_CONF          (DTRACEIOC | 10)        /* get config. */
+#define DTRACEIOC_STATUS        (DTRACEIOC | 11)        /* get status */
+#define DTRACEIOC_GO            (DTRACEIOC | 12)        /* start tracing */
+#define DTRACEIOC_STOP          (DTRACEIOC | 13)        /* stop tracing */
+#define DTRACEIOC_AGGDESC       (DTRACEIOC | 15)        /* get agg. desc. */
+#define DTRACEIOC_FORMAT        (DTRACEIOC | 16)        /* get format str */
+#define DTRACEIOC_DOFGET        (DTRACEIOC | 17)        /* get DOF */
+#define DTRACEIOC_REPLICATE     (DTRACEIOC | 18)        /* replicate enab */
+#else
+/* coding this as IOC_VOID allows this driver to handle its own copyin/copuout */
+#define DTRACEIOC               _IO('d',0)
+#define DTRACEIOC_PROVIDER      (DTRACEIOC | 1)         /* provider query */
+#define DTRACEIOC_PROBES        (DTRACEIOC | 2)         /* probe query */
+#define DTRACEIOC_BUFSNAP       (DTRACEIOC | 4)         /* snapshot buffer */
+#define DTRACEIOC_PROBEMATCH    (DTRACEIOC | 5)         /* match probes */
+#define DTRACEIOC_ENABLE        (DTRACEIOC | 6)         /* enable probes */
+#define DTRACEIOC_AGGSNAP       (DTRACEIOC | 7)         /* snapshot agg. */
+#define DTRACEIOC_EPROBE        (DTRACEIOC | 8)         /* get eprobe desc. */
+#define DTRACEIOC_PROBEARG      (DTRACEIOC | 9)         /* get probe arg */
+#define DTRACEIOC_CONF          (DTRACEIOC | 10)        /* get config. */
+#define DTRACEIOC_STATUS        (DTRACEIOC | 11)        /* get status */
+#define DTRACEIOC_GO            (DTRACEIOC | 12)        /* start tracing */
+#define DTRACEIOC_STOP          (DTRACEIOC | 13)        /* stop tracing */
+#define DTRACEIOC_AGGDESC       (DTRACEIOC | 15)        /* get agg. desc. */
+#define DTRACEIOC_FORMAT        (DTRACEIOC | 16)        /* get format str */
+#define DTRACEIOC_DOFGET        (DTRACEIOC | 17)        /* get DOF */
+#define DTRACEIOC_REPLICATE     (DTRACEIOC | 18)        /* replicate enab */
+#define DTRACEIOC_MODUUIDSLIST	(DTRACEIOC | 30)	/* APPLE ONLY, query for modules with missing symbols */
+#define DTRACEIOC_PROVMODSYMS	(DTRACEIOC | 31)	/* APPLE ONLY, provide missing symbols for a given module */
+#define DTRACEIOC_PROCWAITFOR	(DTRACEIOC | 32)	/* APPLE ONLY, wait for process exec */
+
+/*
+ * The following structs are used to provide symbol information to the kernel from userspace.
+ */
+
+typedef struct dtrace_symbol {
+	uint64_t	dtsym_addr;			/* address of the symbol */
+	uint64_t	dtsym_size;			/* size of the symbol, must be uint64_t to maintain alignment when called by 64b uproc in i386 kernel */
+	char 		dtsym_name[DTRACE_FUNCNAMELEN];	/* symbol name */
+} dtrace_symbol_t;
+
+typedef struct dtrace_module_symbols {
+	UUID		dtmodsyms_uuid;
+	uint64_t	dtmodsyms_count;
+	dtrace_symbol_t	dtmodsyms_symbols[1];
+} dtrace_module_symbols_t;
+
+#define DTRACE_MODULE_SYMBOLS_SIZE(count) (sizeof(dtrace_module_symbols_t) + ((count - 1) * sizeof(dtrace_symbol_t)))
+
+typedef struct dtrace_module_uuids_list {
+	uint64_t	dtmul_count;
+	UUID		dtmul_uuid[1];
+} dtrace_module_uuids_list_t;
+
+#define DTRACE_MODULE_UUIDS_LIST_SIZE(count) (sizeof(dtrace_module_uuids_list_t) + ((count - 1) * sizeof(UUID)))
+
+typedef struct dtrace_procdesc {
+	char		p_comm[MAXCOMLEN+1];
+	pid_t		p_pid;
+} dtrace_procdesc_t;
+
+#endif /* __APPLE__ */
+
+/*
+ * DTrace Helpers
+ *
+ * In general, DTrace establishes probes in processes and takes actions on
+ * processes without knowing their specific user-level structures.  Instead of
+ * existing in the framework, process-specific knowledge is contained by the
+ * enabling D program -- which can apply process-specific knowledge by making
+ * appropriate use of DTrace primitives like copyin() and copyinstr() to
+ * operate on user-level data.  However, there may exist some specific probes
+ * of particular semantic relevance that the application developer may wish to
+ * explicitly export.  For example, an application may wish to export a probe
+ * at the point that it begins and ends certain well-defined transactions.  In
+ * addition to providing probes, programs may wish to offer assistance for
+ * certain actions.  For example, in highly dynamic environments (e.g., Java),
+ * it may be difficult to obtain a stack trace in terms of meaningful symbol
+ * names (the translation from instruction addresses to corresponding symbol
+ * names may only be possible in situ); these environments may wish to define
+ * a series of actions to be applied in situ to obtain a meaningful stack
+ * trace.
+ *
+ * These two mechanisms -- user-level statically defined tracing and assisting
+ * DTrace actions -- are provided via DTrace _helpers_.  Helpers are specified
+ * via DOF, but unlike enabling DOF, helper DOF may contain definitions of
+ * providers, probes and their arguments.  If a helper wishes to provide
+ * action assistance, probe descriptions and corresponding DIF actions may be
+ * specified in the helper DOF.  For such helper actions, however, the probe
+ * description describes the specific helper:  all DTrace helpers have the
+ * provider name "dtrace" and the module name "helper", and the name of the
+ * helper is contained in the function name (for example, the ustack() helper
+ * is named "ustack").  Any helper-specific name may be contained in the name
+ * (for example, if a helper were to have a constructor, it might be named
+ * "dtrace:helper:<helper>:init").  Helper actions are only called when the
+ * action that they are helping is taken.  Helper actions may only return DIF
+ * expressions, and may only call the following subroutines:
+ *
+ *    alloca()      <= Allocates memory out of the consumer's scratch space
+ *    bcopy()       <= Copies memory to scratch space
+ *    copyin()      <= Copies memory from user-level into consumer's scratch
+ *    copyinto()    <= Copies memory into a specific location in scratch
+ *    copyinstr()   <= Copies a string into a specific location in scratch
+ *
+ * Helper actions may only access the following built-in variables:
+ *
+ *    curthread     <= Current kthread_t pointer
+ *    tid           <= Current thread identifier
+ *    pid           <= Current process identifier
+ *    ppid          <= Parent process identifier
+ *    uid           <= Current user ID
+ *    gid           <= Current group ID
+ *    execname      <= Current executable name
+ *    zonename      <= Current zone name
+ *
+ * Helper actions may not manipulate or allocate dynamic variables, but they
+ * may have clause-local and statically-allocated global variables.  The
+ * helper action variable state is specific to the helper action -- variables
+ * used by the helper action may not be accessed outside of the helper
+ * action, and the helper action may not access variables that like outside
+ * of it.  Helper actions may not load from kernel memory at-large; they are
+ * restricting to loading current user state (via copyin() and variants) and
+ * scratch space.  As with probe enablings, helper actions are executed in
+ * program order.  The result of the helper action is the result of the last
+ * executing helper expression.
+ *
+ * Helpers -- composed of either providers/probes or probes/actions (or both)
+ * -- are added by opening the "helper" minor node, and issuing an ioctl(2)
+ * (DTRACEHIOC_ADDDOF) that specifies the dof_helper_t structure. This
+ * encapsulates the name and base address of the user-level library or
+ * executable publishing the helpers and probes as well as the DOF that
+ * contains the definitions of those helpers and probes.
+ *
+ * The DTRACEHIOC_ADD and DTRACEHIOC_REMOVE are left in place for legacy
+ * helpers and should no longer be used.  No other ioctls are valid on the
+ * helper minor node.
+ */
+#if !defined(__APPLE__)
+#define DTRACEHIOC              (('d' << 24) | ('t' << 16) | ('h' << 8))
+#define DTRACEHIOC_ADD          (DTRACEHIOC | 1)        /* add helper */
+#define DTRACEHIOC_REMOVE       (DTRACEHIOC | 2)        /* remove helper */
+#define DTRACEHIOC_ADDDOF       (DTRACEHIOC | 3)        /* add helper DOF */
+#else
+#define DTRACEHIOC_REMOVE	_IO('h', 2)			/* remove helper */
+#define DTRACEHIOC_ADDDOF	_IOW('h', 4, user_addr_t)	/* add helper DOF */
+#endif /* __APPLE__ */
+
+typedef struct dof_helper {
+        char dofhp_mod[DTRACE_MODNAMELEN];      /* executable or library name */
+        uint64_t dofhp_addr;                    /* base address of object */
+        uint64_t dofhp_dof;                     /* address of helper DOF */
+} dof_helper_t;
+
+#if defined(__APPLE__)
+/*
+ * This structure is used to register one or more dof_helper_t(s).
+ * For counts greater than one, malloc the structure as if the
+ * dofiod_helpers field was "count" sized. The kernel will copyin
+ * data of size:
+ *
+ * sizeof(dof_ioctl_data_t) + ((count - 1) * sizeof(dof_helper_t))
+ */
+typedef struct dof_ioctl_data {
+	/*
+	 * This field must be 64 bits to keep the alignment the same
+	 * when 64 bit user procs are sending data to 32 bit xnu
+	 */
+	uint64_t dofiod_count;
+	dof_helper_t dofiod_helpers[1];
+} dof_ioctl_data_t;
+
+#define DOF_IOCTL_DATA_T_SIZE(count) (sizeof(dof_ioctl_data_t) + ((count - 1) * sizeof(dof_helper_t)))
+
+#endif
+
+#define DTRACEMNR_DTRACE        "dtrace"        /* node for DTrace ops */
+#if !defined(__APPLE__)
+#define	DTRACEMNR_HELPER	"helper"	/* node for helpers */
+#else
+#define DTRACEMNR_HELPER        "dtracehelper"  /* node for helpers */
+#endif /* __APPLE__ */
+#define DTRACEMNRN_DTRACE       0               /* minor for DTrace ops */
+#define DTRACEMNRN_HELPER       1               /* minor for helpers */
+#define DTRACEMNRN_CLONE        2               /* first clone minor */
+
+#ifdef _KERNEL
+
+/*
+ * DTrace Provider API
+ *
+ * The following functions are implemented by the DTrace framework and are
+ * used to implement separate in-kernel DTrace providers.  Common functions
+ * are provided in uts/common/os/dtrace.c.  ISA-dependent subroutines are
+ * defined in uts/<isa>/dtrace/dtrace_asm.s or uts/<isa>/dtrace/dtrace_isa.c.
+ *
+ * The provider API has two halves:  the API that the providers consume from
+ * DTrace, and the API that providers make available to DTrace.
+ *
+ * 1 Framework-to-Provider API
+ *
+ * 1.1  Overview
+ *
+ * The Framework-to-Provider API is represented by the dtrace_pops structure
+ * that the provider passes to the framework when registering itself.  This
+ * structure consists of the following members:
+ *
+ *   dtps_provide()          <-- Provide all probes, all modules
+ *   dtps_provide_module()   <-- Provide all probes in specified module
+ *   dtps_enable()           <-- Enable specified probe
+ *   dtps_disable()          <-- Disable specified probe
+ *   dtps_suspend()          <-- Suspend specified probe
+ *   dtps_resume()           <-- Resume specified probe
+ *   dtps_getargdesc()       <-- Get the argument description for args[X]
+ *   dtps_getargval()        <-- Get the value for an argX or args[X] variable
+ *   dtps_usermode()         <-- Find out if the probe was fired in user mode
+ *   dtps_destroy()          <-- Destroy all state associated with this probe
+ *
+ * 1.2  void dtps_provide(void *arg, const dtrace_probedesc_t *spec)
+ *
+ * 1.2.1  Overview
+ *
+ *   Called to indicate that the provider should provide all probes.  If the
+ *   specified description is non-NULL, dtps_provide() is being called because
+ *   no probe matched a specified probe -- if the provider has the ability to
+ *   create custom probes, it may wish to create a probe that matches the
+ *   specified description.
+ *
+ * 1.2.2  Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_register().  The
+ *   second argument is a pointer to a probe description that the provider may
+ *   wish to consider when creating custom probes.  The provider is expected to
+ *   call back into the DTrace framework via dtrace_probe_create() to create
+ *   any necessary probes.  dtps_provide() may be called even if the provider
+ *   has made available all probes; the provider should check the return value
+ *   of dtrace_probe_create() to handle this case.  Note that the provider need
+ *   not implement both dtps_provide() and dtps_provide_module(); see
+ *   "Arguments and Notes" for dtrace_register(), below.
+ *
+ * 1.2.3  Return value
+ *
+ *   None.
+ *
+ * 1.2.4  Caller's context
+ *
+ *   dtps_provide() is typically called from open() or ioctl() context, but may
+ *   be called from other contexts as well.  The DTrace framework is locked in
+ *   such a way that providers may not register or unregister.  This means that
+ *   the provider may not call any DTrace API that affects its registration with
+ *   the framework, including dtrace_register(), dtrace_unregister(),
+ *   dtrace_invalidate(), and dtrace_condense().  However, the context is such
+ *   that the provider may (and indeed, is expected to) call probe-related
+ *   DTrace routines, including dtrace_probe_create(), dtrace_probe_lookup(),
+ *   and dtrace_probe_arg().
+ *
+ * 1.3  void dtps_provide_module(void *arg, struct modctl *mp)
+ *
+ * 1.3.1  Overview
+ *
+ *   Called to indicate that the provider should provide all probes in the
+ *   specified module.
+ *
+ * 1.3.2  Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_register().  The
+ *   second argument is a pointer to a modctl structure that indicates the
+ *   module for which probes should be created.
+ *
+ * 1.3.3  Return value
+ *
+ *   None.
+ *
+ * 1.3.4  Caller's context
+ *
+ *   dtps_provide_module() may be called from open() or ioctl() context, but
+ *   may also be called from a module loading context.  mod_lock is held, and
+ *   the DTrace framework is locked in such a way that providers may not
+ *   register or unregister.  This means that the provider may not call any
+ *   DTrace API that affects its registration with the framework, including
+ *   dtrace_register(), dtrace_unregister(), dtrace_invalidate(), and
+ *   dtrace_condense().  However, the context is such that the provider may (and
+ *   indeed, is expected to) call probe-related DTrace routines, including
+ *   dtrace_probe_create(), dtrace_probe_lookup(), and dtrace_probe_arg().  Note
+ *   that the provider need not implement both dtps_provide() and
+ *   dtps_provide_module(); see "Arguments and Notes" for dtrace_register(),
+ *   below.
+ *
+ * 1.4  int dtps_enable(void *arg, dtrace_id_t id, void *parg)
+ *
+ * 1.4.1  Overview
+ *
+ *   Called to enable the specified probe.
+ *
+ * 1.4.2  Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_register().  The
+ *   second argument is the identifier of the probe to be enabled.  The third
+ *   argument is the probe argument as passed to dtrace_probe_create().
+ *   dtps_enable() will be called when a probe transitions from not being
+ *   enabled at all to having one or more ECB.  The number of ECBs associated
+ *   with the probe may change without subsequent calls into the provider.
+ *   When the number of ECBs drops to zero, the provider will be explicitly
+ *   told to disable the probe via dtps_disable().  dtrace_probe() should never
+ *   be called for a probe identifier that hasn't been explicitly enabled via
+ *   dtps_enable().
+ *
+ * 1.4.3  Return value
+ *
+ *   On success, dtps_enable() should return 0. On failure, -1 should be
+ *   returned.
+ *
+ * 1.4.4  Caller's context
+ *
+ *   The DTrace framework is locked in such a way that it may not be called
+ *   back into at all.  cpu_lock is held.  mod_lock is not held and may not
+ *   be acquired.
+ *
+ * 1.5  void dtps_disable(void *arg, dtrace_id_t id, void *parg)
+ *
+ * 1.5.1  Overview
+ *
+ *   Called to disable the specified probe.
+ *
+ * 1.5.2  Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_register().  The
+ *   second argument is the identifier of the probe to be disabled.  The third
+ *   argument is the probe argument as passed to dtrace_probe_create().
+ *   dtps_disable() will be called when a probe transitions from being enabled
+ *   to having zero ECBs.  dtrace_probe() should never be called for a probe
+ *   identifier that has been explicitly enabled via dtps_disable().
+ *
+ * 1.5.3  Return value
+ *
+ *   None.
+ *
+ * 1.5.4  Caller's context
+ *
+ *   The DTrace framework is locked in such a way that it may not be called
+ *   back into at all.  cpu_lock is held.  mod_lock is not held and may not
+ *   be acquired.
+ *
+ * 1.6  void dtps_suspend(void *arg, dtrace_id_t id, void *parg)
+ *
+ * 1.6.1  Overview
+ *
+ *   Called to suspend the specified enabled probe.  This entry point is for
+ *   providers that may need to suspend some or all of their probes when CPUs
+ *   are being powered on or when the boot monitor is being entered for a
+ *   prolonged period of time.
+ *
+ * 1.6.2  Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_register().  The
+ *   second argument is the identifier of the probe to be suspended.  The
+ *   third argument is the probe argument as passed to dtrace_probe_create().
+ *   dtps_suspend will only be called on an enabled probe.  Providers that
+ *   provide a dtps_suspend entry point will want to take roughly the action
+ *   that it takes for dtps_disable.
+ *
+ * 1.6.3  Return value
+ *
+ *   None.
+ *
+ * 1.6.4  Caller's context
+ *
+ *   Interrupts are disabled.  The DTrace framework is in a state such that the
+ *   specified probe cannot be disabled or destroyed for the duration of
+ *   dtps_suspend().  As interrupts are disabled, the provider is afforded
+ *   little latitude; the provider is expected to do no more than a store to
+ *   memory.
+ *
+ * 1.7  void dtps_resume(void *arg, dtrace_id_t id, void *parg)
+ *
+ * 1.7.1  Overview
+ *
+ *   Called to resume the specified enabled probe.  This entry point is for
+ *   providers that may need to resume some or all of their probes after the
+ *   completion of an event that induced a call to dtps_suspend().
+ *
+ * 1.7.2  Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_register().  The
+ *   second argument is the identifier of the probe to be resumed.  The
+ *   third argument is the probe argument as passed to dtrace_probe_create().
+ *   dtps_resume will only be called on an enabled probe.  Providers that
+ *   provide a dtps_resume entry point will want to take roughly the action
+ *   that it takes for dtps_enable.
+ *
+ * 1.7.3  Return value
+ *
+ *   None.
+ *
+ * 1.7.4  Caller's context
+ *
+ *   Interrupts are disabled.  The DTrace framework is in a state such that the
+ *   specified probe cannot be disabled or destroyed for the duration of
+ *   dtps_resume().  As interrupts are disabled, the provider is afforded
+ *   little latitude; the provider is expected to do no more than a store to
+ *   memory.
+ *
+ * 1.8  void dtps_getargdesc(void *arg, dtrace_id_t id, void *parg,
+ *           dtrace_argdesc_t *desc)
+ *
+ * 1.8.1  Overview
+ *
+ *   Called to retrieve the argument description for an args[X] variable.
+ *
+ * 1.8.2  Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_register(). The
+ *   second argument is the identifier of the current probe. The third
+ *   argument is the probe argument as passed to dtrace_probe_create(). The
+ *   fourth argument is a pointer to the argument description.  This
+ *   description is both an input and output parameter:  it contains the
+ *   index of the desired argument in the dtargd_ndx field, and expects
+ *   the other fields to be filled in upon return.  If there is no argument
+ *   corresponding to the specified index, the dtargd_ndx field should be set
+ *   to DTRACE_ARGNONE.
+ *
+ * 1.8.3  Return value
+ *
+ *   None.  The dtargd_ndx, dtargd_native, dtargd_xlate and dtargd_mapping
+ *   members of the dtrace_argdesc_t structure are all output values.
+ *
+ * 1.8.4  Caller's context
+ *
+ *   dtps_getargdesc() is called from ioctl() context. mod_lock is held, and
+ *   the DTrace framework is locked in such a way that providers may not
+ *   register or unregister.  This means that the provider may not call any
+ *   DTrace API that affects its registration with the framework, including
+ *   dtrace_register(), dtrace_unregister(), dtrace_invalidate(), and
+ *   dtrace_condense().
+ *
+ * 1.9  uint64_t dtps_getargval(void *arg, dtrace_id_t id, void *parg,
+ *               int argno, int aframes)
+ *
+ * 1.9.1  Overview
+ *
+ *   Called to retrieve a value for an argX or args[X] variable.
+ *
+ * 1.9.2  Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_register(). The
+ *   second argument is the identifier of the current probe. The third
+ *   argument is the probe argument as passed to dtrace_probe_create(). The
+ *   fourth argument is the number of the argument (the X in the example in
+ *   1.9.1). The fifth argument is the number of stack frames that were used
+ *   to get from the actual place in the code that fired the probe to
+ *   dtrace_probe() itself, the so-called artificial frames. This argument may
+ *   be used to descend an appropriate number of frames to find the correct
+ *   values. If this entry point is left NULL, the dtrace_getarg() built-in
+ *   function is used.
+ *
+ * 1.9.3  Return value
+ *
+ *   The value of the argument.
+ *
+ * 1.9.4  Caller's context
+ *
+ *   This is called from within dtrace_probe() meaning that interrupts
+ *   are disabled. No locks should be taken within this entry point.
+ *
+ * 1.10  int dtps_usermode(void *arg, dtrace_id_t id, void *parg)
+ *
+ * 1.10.1  Overview
+ *
+ *   Called to determine if the probe was fired in a user context.
+ *
+ * 1.10.2  Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_register(). The
+ *   second argument is the identifier of the current probe. The third
+ *   argument is the probe argument as passed to dtrace_probe_create().  This
+ *   entry point must not be left NULL for providers whose probes allow for
+ *   mixed mode tracing, that is to say those probes that can fire during
+ *   kernel- _or_ user-mode execution
+ *
+ * 1.10.3  Return value
+ *
+ *   A boolean value.
+ *
+ * 1.10.4  Caller's context
+ *
+ *   This is called from within dtrace_probe() meaning that interrupts
+ *   are disabled. No locks should be taken within this entry point.
+ *
+ * 1.11 void dtps_destroy(void *arg, dtrace_id_t id, void *parg)
+ *
+ * 1.11.1 Overview
+ *
+ *   Called to destroy the specified probe.
+ *
+ * 1.11.2 Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_register().  The
+ *   second argument is the identifier of the probe to be destroyed.  The third
+ *   argument is the probe argument as passed to dtrace_probe_create().  The
+ *   provider should free all state associated with the probe.  The framework
+ *   guarantees that dtps_destroy() is only called for probes that have either
+ *   been disabled via dtps_disable() or were never enabled via dtps_enable().
+ *   Once dtps_disable() has been called for a probe, no further call will be
+ *   made specifying the probe.
+ *
+ * 1.11.3 Return value
+ *
+ *   None.
+ *
+ * 1.11.4 Caller's context
+ *
+ *   The DTrace framework is locked in such a way that it may not be called
+ *   back into at all.  mod_lock is held.  cpu_lock is not held, and may not be
+ *   acquired.
+ *
+ *
+ * 2 Provider-to-Framework API
+ *
+ * 2.1  Overview
+ *
+ * The Provider-to-Framework API provides the mechanism for the provider to
+ * register itself with the DTrace framework, to create probes, to lookup
+ * probes and (most importantly) to fire probes.  The Provider-to-Framework
+ * consists of:
+ *
+ *   dtrace_register()       <-- Register a provider with the DTrace framework
+ *   dtrace_unregister()     <-- Remove a provider's DTrace registration
+ *   dtrace_invalidate()     <-- Invalidate the specified provider
+ *   dtrace_condense()       <-- Remove a provider's unenabled probes
+ *   dtrace_attached()       <-- Indicates whether or not DTrace has attached
+ *   dtrace_probe_create()   <-- Create a DTrace probe
+ *   dtrace_probe_lookup()   <-- Lookup a DTrace probe based on its name
+ *   dtrace_probe_arg()      <-- Return the probe argument for a specific probe
+ *   dtrace_probe()          <-- Fire the specified probe
+ *
+ * 2.2  int dtrace_register(const char *name, const dtrace_pattr_t *pap,
+ *          uint32_t priv, cred_t *cr, const dtrace_pops_t *pops, void *arg,
+ *          dtrace_provider_id_t *idp)
+ *
+ * 2.2.1  Overview
+ *
+ *   dtrace_register() registers the calling provider with the DTrace
+ *   framework.  It should generally be called by DTrace providers in their
+ *   attach(9E) entry point.
+ *
+ * 2.2.2  Arguments and Notes
+ *
+ *   The first argument is the name of the provider.  The second argument is a
+ *   pointer to the stability attributes for the provider.  The third argument
+ *   is the privilege flags for the provider, and must be some combination of:
+ *
+ *     DTRACE_PRIV_NONE     <= All users may enable probes from this provider
+ *
+ *     DTRACE_PRIV_PROC     <= Any user with privilege of PRIV_DTRACE_PROC may
+ *                             enable probes from this provider
+ *
+ *     DTRACE_PRIV_USER     <= Any user with privilege of PRIV_DTRACE_USER may
+ *                             enable probes from this provider
+ *
+ *     DTRACE_PRIV_KERNEL   <= Any user with privilege of PRIV_DTRACE_KERNEL
+ *                             may enable probes from this provider
+ *
+ *     DTRACE_PRIV_OWNER    <= This flag places an additional constraint on
+ *                             the privilege requirements above. These probes
+ *                             require either (a) a user ID matching the user
+ *                             ID of the cred passed in the fourth argument
+ *                             or (b) the PRIV_PROC_OWNER privilege.
+ *
+ *     DTRACE_PRIV_ZONEOWNER<= This flag places an additional constraint on
+ *                             the privilege requirements above. These probes
+ *                             require either (a) a zone ID matching the zone
+ *                             ID of the cred passed in the fourth argument
+ *                             or (b) the PRIV_PROC_ZONE privilege.
+ *
+ *   Note that these flags designate the _visibility_ of the probes, not
+ *   the conditions under which they may or may not fire.
+ *
+ *   The fourth argument is the credential that is associated with the
+ *   provider.  This argument should be NULL if the privilege flags don't
+ *   include DTRACE_PRIV_OWNER or DTRACE_PRIV_ZONEOWNER.  If non-NULL, the
+ *   framework stashes the uid and zoneid represented by this credential
+ *   for use at probe-time, in implicit predicates.  These limit visibility
+ *   of the probes to users and/or zones which have sufficient privilege to
+ *   access them.
+ *
+ *   The fifth argument is a DTrace provider operations vector, which provides
+ *   the implementation for the Framework-to-Provider API.  (See Section 1,
+ *   above.)  This must be non-NULL, and each member must be non-NULL.  The
+ *   exceptions to this are (1) the dtps_provide() and dtps_provide_module()
+ *   members (if the provider so desires, _one_ of these members may be left
+ *   NULL -- denoting that the provider only implements the other) and (2)
+ *   the dtps_suspend() and dtps_resume() members, which must either both be
+ *   NULL or both be non-NULL.
+ *
+ *   The sixth argument is a cookie to be specified as the first argument for
+ *   each function in the Framework-to-Provider API.  This argument may have
+ *   any value.
+ *
+ *   The final argument is a pointer to dtrace_provider_id_t.  If
+ *   dtrace_register() successfully completes, the provider identifier will be
+ *   stored in the memory pointed to be this argument.  This argument must be
+ *   non-NULL.
+ *
+ * 2.2.3  Return value
+ *
+ *   On success, dtrace_register() returns 0 and stores the new provider's
+ *   identifier into the memory pointed to by the idp argument.  On failure,
+ *   dtrace_register() returns an errno:
+ *
+ *     EINVAL   The arguments passed to dtrace_register() were somehow invalid.
+ *              This may because a parameter that must be non-NULL was NULL,
+ *              because the name was invalid (either empty or an illegal
+ *              provider name) or because the attributes were invalid.
+ *
+ *   No other failure code is returned.
+ *
+ * 2.2.4  Caller's context
+ *
+ *   dtrace_register() may induce calls to dtrace_provide(); the provider must
+ *   hold no locks across dtrace_register() that may also be acquired by
+ *   dtrace_provide().  cpu_lock and mod_lock must not be held.
+ *
+ * 2.3  int dtrace_unregister(dtrace_provider_t id)
+ *
+ * 2.3.1  Overview
+ *
+ *   Unregisters the specified provider from the DTrace framework.  It should
+ *   generally be called by DTrace providers in their detach(9E) entry point.
+ *
+ * 2.3.2  Arguments and Notes
+ *
+ *   The only argument is the provider identifier, as returned from a
+ *   successful call to dtrace_register().  As a result of calling
+ *   dtrace_unregister(), the DTrace framework will call back into the provider
+ *   via the dtps_destroy() entry point.  Once dtrace_unregister() successfully
+ *   completes, however, the DTrace framework will no longer make calls through
+ *   the Framework-to-Provider API.
+ *
+ * 2.3.3  Return value
+ *
+ *   On success, dtrace_unregister returns 0.  On failure, dtrace_unregister()
+ *   returns an errno:
+ *
+ *     EBUSY    There are currently processes that have the DTrace pseudodevice
+ *              open, or there exists an anonymous enabling that hasn't yet
+ *              been claimed.
+ *
+ *   No other failure code is returned.
+ *
+ * 2.3.4  Caller's context
+ *
+ *   Because a call to dtrace_unregister() may induce calls through the
+ *   Framework-to-Provider API, the caller may not hold any lock across
+ *   dtrace_register() that is also acquired in any of the Framework-to-
+ *   Provider API functions.  Additionally, mod_lock may not be held.
+ *
+ * 2.4  void dtrace_invalidate(dtrace_provider_id_t id)
+ *
+ * 2.4.1  Overview
+ *
+ *   Invalidates the specified provider.  All subsequent probe lookups for the
+ *   specified provider will fail, but its probes will not be removed.
+ *
+ * 2.4.2  Arguments and note
+ *
+ *   The only argument is the provider identifier, as returned from a
+ *   successful call to dtrace_register().  In general, a provider's probes
+ *   always remain valid; dtrace_invalidate() is a mechanism for invalidating
+ *   an entire provider, regardless of whether or not probes are enabled or
+ *   not.  Note that dtrace_invalidate() will _not_ prevent already enabled
+ *   probes from firing -- it will merely prevent any new enablings of the
+ *   provider's probes.
+ *
+ * 2.5 int dtrace_condense(dtrace_provider_id_t id)
+ *
+ * 2.5.1  Overview
+ *
+ *   Removes all the unenabled probes for the given provider. This function is
+ *   not unlike dtrace_unregister(), except that it doesn't remove the
+ *   provider just as many of its associated probes as it can.
+ *
+ * 2.5.2  Arguments and Notes
+ *
+ *   As with dtrace_unregister(), the sole argument is the provider identifier
+ *   as returned from a successful call to dtrace_register().  As a result of
+ *   calling dtrace_condense(), the DTrace framework will call back into the
+ *   given provider's dtps_destroy() entry point for each of the provider's
+ *   unenabled probes.
+ *
+ * 2.5.3  Return value
+ *
+ *   Currently, dtrace_condense() always returns 0.  However, consumers of this
+ *   function should check the return value as appropriate; its behavior may
+ *   change in the future.
+ *
+ * 2.5.4  Caller's context
+ *
+ *   As with dtrace_unregister(), the caller may not hold any lock across
+ *   dtrace_condense() that is also acquired in the provider's entry points.
+ *   Also, mod_lock may not be held.
+ *
+ * 2.6 int dtrace_attached()
+ *
+ * 2.6.1  Overview
+ *
+ *   Indicates whether or not DTrace has attached.
+ *
+ * 2.6.2  Arguments and Notes
+ *
+ *   For most providers, DTrace makes initial contact beyond registration.
+ *   That is, once a provider has registered with DTrace, it waits to hear
+ *   from DTrace to create probes.  However, some providers may wish to
+ *   proactively create probes without first being told by DTrace to do so.
+ *   If providers wish to do this, they must first call dtrace_attached() to
+ *   determine if DTrace itself has attached.  If dtrace_attached() returns 0,
+ *   the provider must not make any other Provider-to-Framework API call.
+ *
+ * 2.6.3  Return value
+ *
+ *   dtrace_attached() returns 1 if DTrace has attached, 0 otherwise.
+ *
+ * 2.7  int dtrace_probe_create(dtrace_provider_t id, const char *mod,
+ *          const char *func, const char *name, int aframes, void *arg)
+ *
+ * 2.7.1  Overview
+ *
+ *   Creates a probe with specified module name, function name, and name.
+ *
+ * 2.7.2  Arguments and Notes
+ *
+ *   The first argument is the provider identifier, as returned from a
+ *   successful call to dtrace_register().  The second, third, and fourth
+ *   arguments are the module name, function name, and probe name,
+ *   respectively.  Of these, module name and function name may both be NULL
+ *   (in which case the probe is considered to be unanchored), or they may both
+ *   be non-NULL.  The name must be non-NULL, and must point to a non-empty
+ *   string.
+ *
+ *   The fifth argument is the number of artificial stack frames that will be
+ *   found on the stack when dtrace_probe() is called for the new probe.  These
+ *   artificial frames will be automatically be pruned should the stack() or
+ *   stackdepth() functions be called as part of one of the probe's ECBs.  If
+ *   the parameter doesn't add an artificial frame, this parameter should be
+ *   zero.
+ *
+ *   The final argument is a probe argument that will be passed back to the
+ *   provider when a probe-specific operation is called.  (e.g., via
+ *   dtps_enable(), dtps_disable(), etc.)
+ *
+ *   Note that it is up to the provider to be sure that the probe that it
+ *   creates does not already exist -- if the provider is unsure of the probe's
+ *   existence, it should assure its absence with dtrace_probe_lookup() before
+ *   calling dtrace_probe_create().
+ *
+ * 2.7.3  Return value
+ *
+ *   dtrace_probe_create() always succeeds, and always returns the identifier
+ *   of the newly-created probe.
+ *
+ * 2.7.4  Caller's context
+ *
+ *   While dtrace_probe_create() is generally expected to be called from
+ *   dtps_provide() and/or dtps_provide_module(), it may be called from other
+ *   non-DTrace contexts.  Neither cpu_lock nor mod_lock may be held.
+ *
+ * 2.8  dtrace_id_t dtrace_probe_lookup(dtrace_provider_t id, const char *mod,
+ *          const char *func, const char *name)
+ *
+ * 2.8.1  Overview
+ *
+ *   Looks up a probe based on provdider and one or more of module name,
+ *   function name and probe name.
+ *
+ * 2.8.2  Arguments and Notes
+ *
+ *   The first argument is the provider identifier, as returned from a
+ *   successful call to dtrace_register().  The second, third, and fourth
+ *   arguments are the module name, function name, and probe name,
+ *   respectively.  Any of these may be NULL; dtrace_probe_lookup() will return
+ *   the identifier of the first probe that is provided by the specified
+ *   provider and matches all of the non-NULL matching criteria.
+ *   dtrace_probe_lookup() is generally used by a provider to be check the
+ *   existence of a probe before creating it with dtrace_probe_create().
+ *
+ * 2.8.3  Return value
+ *
+ *   If the probe exists, returns its identifier.  If the probe does not exist,
+ *   return DTRACE_IDNONE.
+ *
+ * 2.8.4  Caller's context
+ *
+ *   While dtrace_probe_lookup() is generally expected to be called from
+ *   dtps_provide() and/or dtps_provide_module(), it may also be called from
+ *   other non-DTrace contexts.  Neither cpu_lock nor mod_lock may be held.
+ *
+ * 2.9  void *dtrace_probe_arg(dtrace_provider_t id, dtrace_id_t probe)
+ *
+ * 2.9.1  Overview
+ *
+ *   Returns the probe argument associated with the specified probe.
+ *
+ * 2.9.2  Arguments and Notes
+ *
+ *   The first argument is the provider identifier, as returned from a
+ *   successful call to dtrace_register().  The second argument is a probe
+ *   identifier, as returned from dtrace_probe_lookup() or
+ *   dtrace_probe_create().  This is useful if a probe has multiple
+ *   provider-specific components to it:  the provider can create the probe
+ *   once with provider-specific state, and then add to the state by looking
+ *   up the probe based on probe identifier.
+ *
+ * 2.9.3  Return value
+ *
+ *   Returns the argument associated with the specified probe.  If the
+ *   specified probe does not exist, or if the specified probe is not provided
+ *   by the specified provider, NULL is returned.
+ *
+ * 2.9.4  Caller's context
+ *
+ *   While dtrace_probe_arg() is generally expected to be called from
+ *   dtps_provide() and/or dtps_provide_module(), it may also be called from
+ *   other non-DTrace contexts.  Neither cpu_lock nor mod_lock may be held.
+ *
+ * 2.10  void dtrace_probe(dtrace_id_t probe, uintptr_t arg0, uintptr_t arg1,
+ *              uintptr_t arg2, uintptr_t arg3, uintptr_t arg4)
+ *
+ * 2.10.1  Overview
+ *
+ *   The epicenter of DTrace:  fires the specified probes with the specified
+ *   arguments.
+ *
+ * 2.10.2  Arguments and Notes
+ *
+ *   The first argument is a probe identifier as returned by
+ *   dtrace_probe_create() or dtrace_probe_lookup().  The second through sixth
+ *   arguments are the values to which the D variables "arg0" through "arg4"
+ *   will be mapped.
+ *
+ *   dtrace_probe() should be called whenever the specified probe has fired --
+ *   however the provider defines it.
+ *
+ * 2.10.3  Return value
+ *
+ *   None.
+ *
+ * 2.10.4  Caller's context
+ *
+ *   dtrace_probe() may be called in virtually any context:  kernel, user,
+ *   interrupt, high-level interrupt, with arbitrary adaptive locks held, with
+ *   dispatcher locks held, with interrupts disabled, etc.  The only latitude
+ *   that must be afforded to DTrace is the ability to make calls within
+ *   itself (and to its in-kernel subroutines) and the ability to access
+ *   arbitrary (but mapped) memory.  On some platforms, this constrains
+ *   context.  For example, on UltraSPARC, dtrace_probe() cannot be called
+ *   from any context in which TL is greater than zero.  dtrace_probe() may
+ *   also not be called from any routine which may be called by dtrace_probe()
+ *   -- which includes functions in the DTrace framework and some in-kernel
+ *   DTrace subroutines.  All such functions "dtrace_"; providers that
+ *   instrument the kernel arbitrarily should be sure to not instrument these
+ *   routines.
+ */
+typedef struct dtrace_pops {
+        void (*dtps_provide)(void *arg, const dtrace_probedesc_t *spec);
+        void (*dtps_provide_module)(void *arg, struct modctl *mp);
+        int (*dtps_enable)(void *arg, dtrace_id_t id, void *parg);
+        void (*dtps_disable)(void *arg, dtrace_id_t id, void *parg);
+        void (*dtps_suspend)(void *arg, dtrace_id_t id, void *parg);
+        void (*dtps_resume)(void *arg, dtrace_id_t id, void *parg);
+        void (*dtps_getargdesc)(void *arg, dtrace_id_t id, void *parg,
+            dtrace_argdesc_t *desc);
+        uint64_t (*dtps_getargval)(void *arg, dtrace_id_t id, void *parg,
+            int argno, int aframes);
+        int (*dtps_usermode)(void *arg, dtrace_id_t id, void *parg);
+        void (*dtps_destroy)(void *arg, dtrace_id_t id, void *parg);
+} dtrace_pops_t;
+
+typedef uintptr_t       dtrace_provider_id_t;
+
+extern int dtrace_register(const char *, const dtrace_pattr_t *, uint32_t,
+    cred_t *, const dtrace_pops_t *, void *, dtrace_provider_id_t *);
+extern int dtrace_unregister(dtrace_provider_id_t);
+extern int dtrace_condense(dtrace_provider_id_t);
+extern void dtrace_invalidate(dtrace_provider_id_t);
+extern dtrace_id_t dtrace_probe_lookup(dtrace_provider_id_t, const char *,
+    const char *, const char *);
+extern dtrace_id_t dtrace_probe_create(dtrace_provider_id_t, const char *,
+    const char *, const char *, int, void *);
+extern void *dtrace_probe_arg(dtrace_provider_id_t, dtrace_id_t);
+#if !defined(__APPLE__)
+extern void dtrace_probe(dtrace_id_t, uintptr_t arg0, uintptr_t arg1,
+    uintptr_t arg2, uintptr_t arg3, uintptr_t arg4);
+#else
+extern void dtrace_probe(dtrace_id_t, uint64_t arg0, uint64_t arg1,
+    uint64_t arg2, uint64_t arg3, uint64_t arg4);
+#endif /* __APPLE__ */
+
+/*
+ * DTrace Meta Provider API
+ *
+ * The following functions are implemented by the DTrace framework and are
+ * used to implement meta providers. Meta providers plug into the DTrace
+ * framework and are used to instantiate new providers on the fly. At
+ * present, there is only one type of meta provider and only one meta
+ * provider may be registered with the DTrace framework at a time. The
+ * sole meta provider type provides user-land static tracing facilities
+ * by taking meta probe descriptions and adding a corresponding provider
+ * into the DTrace framework.
+ *
+ * 1 Framework-to-Provider
+ *
+ * 1.1 Overview
+ *
+ * The Framework-to-Provider API is represented by the dtrace_mops structure
+ * that the meta provider passes to the framework when registering itself as
+ * a meta provider. This structure consists of the following members:
+ *
+ *   dtms_create_probe()        <-- Add a new probe to a created provider
+ *   dtms_provide_pid()         <-- Create a new provider for a given process
+ *   dtms_remove_pid()          <-- Remove a previously created provider
+ *
+ * 1.2  void dtms_create_probe(void *arg, void *parg,
+ *           dtrace_helper_probedesc_t *probedesc);
+ *
+ * 1.2.1  Overview
+ *
+ *   Called by the DTrace framework to create a new probe in a provider
+ *   created by this meta provider.
+ *
+ * 1.2.2  Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_meta_register().
+ *   The second argument is the provider cookie for the associated provider;
+ *   this is obtained from the return value of dtms_provide_pid(). The third
+ *   argument is the helper probe description.
+ *
+ * 1.2.3  Return value
+ *
+ *   None
+ *
+ * 1.2.4  Caller's context
+ *
+ *   dtms_create_probe() is called from either ioctl() or module load context.
+ *   The DTrace framework is locked in such a way that meta providers may not
+ *   register or unregister. This means that the meta provider cannot call
+ *   dtrace_meta_register() or dtrace_meta_unregister(). However, the context is
+ *   such that the provider may (and is expected to) call provider-related
+ *   DTrace provider APIs including dtrace_probe_create().
+ *
+ * 1.3  void *dtms_provide_pid(void *arg, dtrace_meta_provider_t *mprov,
+ *            pid_t pid)
+ *
+ * 1.3.1  Overview
+ *
+ *   Called by the DTrace framework to instantiate a new provider given the
+ *   description of the provider and probes in the mprov argument. The
+ *   meta provider should call dtrace_register() to insert the new provider
+ *   into the DTrace framework.
+ *
+ * 1.3.2  Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_meta_register().
+ *   The second argument is a pointer to a structure describing the new
+ *   helper provider. The third argument is the process identifier for
+ *   process associated with this new provider. Note that the name of the
+ *   provider as passed to dtrace_register() should be the contatenation of
+ *   the dtmpb_provname member of the mprov argument and the processs
+ *   identifier as a string.
+ *
+ * 1.3.3  Return value
+ *
+ *   The cookie for the provider that the meta provider creates. This is
+ *   the same value that it passed to dtrace_register().
+ *
+ * 1.3.4  Caller's context
+ *
+ *   dtms_provide_pid() is called from either ioctl() or module load context.
+ *   The DTrace framework is locked in such a way that meta providers may not
+ *   register or unregister. This means that the meta provider cannot call
+ *   dtrace_meta_register() or dtrace_meta_unregister(). However, the context
+ *   is such that the provider may -- and is expected to --  call
+ *   provider-related DTrace provider APIs including dtrace_register().
+ *
+ * 1.4  void dtms_remove_pid(void *arg, dtrace_meta_provider_t *mprov,
+ *           pid_t pid)
+ *
+ * 1.4.1  Overview
+ *
+ *   Called by the DTrace framework to remove a provider that had previously
+ *   been instantiated via the dtms_provide_pid() entry point. The meta
+ *   provider need not remove the provider immediately, but this entry
+ *   point indicates that the provider should be removed as soon as possible
+ *   using the dtrace_unregister() API.
+ *
+ * 1.4.2  Arguments and notes
+ *
+ *   The first argument is the cookie as passed to dtrace_meta_register().
+ *   The second argument is a pointer to a structure describing the helper
+ *   provider. The third argument is the process identifier for process
+ *   associated with this new provider.
+ *
+ * 1.4.3  Return value
+ *
+ *   None
+ *
+ * 1.4.4  Caller's context
+ *
+ *   dtms_remove_pid() is called from either ioctl() or exit() context.
+ *   The DTrace framework is locked in such a way that meta providers may not
+ *   register or unregister. This means that the meta provider cannot call
+ *   dtrace_meta_register() or dtrace_meta_unregister(). However, the context
+ *   is such that the provider may -- and is expected to -- call
+ *   provider-related DTrace provider APIs including dtrace_unregister().
+ */
+typedef struct dtrace_helper_probedesc {
+	char *dthpb_mod;			/* probe module */
+	char *dthpb_func; 			/* probe function */
+	char *dthpb_name; 			/* probe name */
+	uint64_t dthpb_base;			/* base address */
+#if !defined(__APPLE__)
+	uint32_t *dthpb_offs;			/* offsets array */
+	uint32_t *dthpb_enoffs;			/* is-enabled offsets array */
+#else
+	int32_t *dthpb_offs;			/* (signed) offsets array */
+	int32_t *dthpb_enoffs;			/* (signed) is-enabled offsets array */
+#endif
+	uint32_t dthpb_noffs;			/* offsets count */
+	uint32_t dthpb_nenoffs;			/* is-enabled offsets count */
+	uint8_t *dthpb_args;			/* argument mapping array */
+	uint8_t dthpb_xargc;			/* translated argument count */
+	uint8_t dthpb_nargc;			/* native argument count */
+	char *dthpb_xtypes;			/* translated types strings */
+	char *dthpb_ntypes;			/* native types strings */
+} dtrace_helper_probedesc_t;
+
+typedef struct dtrace_helper_provdesc {
+        char *dthpv_provname;                   /* provider name */
+        dtrace_pattr_t dthpv_pattr;             /* stability attributes */
+} dtrace_helper_provdesc_t;
+
+typedef struct dtrace_mops {
+        void (*dtms_create_probe)(void *, void *, dtrace_helper_probedesc_t *);
+        void *(*dtms_provide_pid)(void *, dtrace_helper_provdesc_t *, pid_t);
+        void (*dtms_remove_pid)(void *, dtrace_helper_provdesc_t *, pid_t);
+} dtrace_mops_t;
+
+typedef uintptr_t       dtrace_meta_provider_id_t;
+
+extern int dtrace_meta_register(const char *, const dtrace_mops_t *, void *,
+    dtrace_meta_provider_id_t *);
+extern int dtrace_meta_unregister(dtrace_meta_provider_id_t);
+
+/*
+ * DTrace Kernel Hooks
+ *
+ * The following functions are implemented by the base kernel and form a set of
+ * hooks used by the DTrace framework.  DTrace hooks are implemented in either
+ * uts/common/os/dtrace_subr.c, an ISA-specific assembly file, or in a
+ * uts/<platform>/os/dtrace_subr.c corresponding to each hardware platform.
+ */
+
+typedef enum dtrace_vtime_state {
+        DTRACE_VTIME_INACTIVE = 0,      /* No DTrace, no TNF */
+        DTRACE_VTIME_ACTIVE,            /* DTrace virtual time, no TNF */
+        DTRACE_VTIME_INACTIVE_TNF,      /* No DTrace, TNF active */
+        DTRACE_VTIME_ACTIVE_TNF         /* DTrace virtual time _and_ TNF */
+} dtrace_vtime_state_t;
+
+extern dtrace_vtime_state_t dtrace_vtime_active;
+extern void dtrace_vtime_switch(kthread_t *next);
+extern void dtrace_vtime_enable_tnf(void);
+extern void dtrace_vtime_disable_tnf(void);
+extern void dtrace_vtime_enable(void);
+extern void dtrace_vtime_disable(void);
+
+#if !defined(__APPLE__)
+struct regs;
+
+extern int (*dtrace_pid_probe_ptr)(struct regs *);
+extern int (*dtrace_return_probe_ptr)(struct regs *);
+#else
+#if defined (__i386__) || defined(__x86_64__)
+extern int (*dtrace_pid_probe_ptr)(x86_saved_state_t *regs);
+extern int (*dtrace_return_probe_ptr)(x86_saved_state_t* regs);
+#else
+#error architecture not supported
+#endif
+#endif /* __APPLE__ */
+extern void (*dtrace_fasttrap_fork_ptr)(proc_t *, proc_t *);
+extern void (*dtrace_fasttrap_exec_ptr)(proc_t *);
+extern void (*dtrace_fasttrap_exit_ptr)(proc_t *);
+extern void dtrace_fasttrap_fork(proc_t *, proc_t *);
+
+typedef uintptr_t dtrace_icookie_t;
+typedef void (*dtrace_xcall_t)(void *);
+
+extern dtrace_icookie_t dtrace_interrupt_disable(void);
+extern void dtrace_interrupt_enable(dtrace_icookie_t);
+
+extern void dtrace_membar_producer(void);
+extern void dtrace_membar_consumer(void);
+
+extern void (*dtrace_cpu_init)(processorid_t);
+#if !defined(__APPLE__)
+extern void (*dtrace_modload)(struct modctl *);
+extern void (*dtrace_modunload)(struct modctl *);
+#else
+extern int (*dtrace_modload)(struct kmod_info *, uint32_t);
+extern int (*dtrace_modunload)(struct kmod_info *);
+#endif /* __APPLE__ */
+extern void (*dtrace_helpers_cleanup)(proc_t*);
+extern void (*dtrace_helpers_fork)(proc_t *parent, proc_t *child);
+extern void (*dtrace_cpustart_init)(void);
+extern void (*dtrace_cpustart_fini)(void);
+
+extern void (*dtrace_kreloc_init)(void);
+extern void (*dtrace_kreloc_fini)(void);
+
+extern void (*dtrace_debugger_init)(void);
+extern void (*dtrace_debugger_fini)(void);
+extern dtrace_cacheid_t dtrace_predcache_id;
+
+extern hrtime_t dtrace_gethrtime(void);
+extern void dtrace_sync(void);
+extern void dtrace_toxic_ranges(void (*)(uintptr_t, uintptr_t));
+extern void dtrace_xcall(processorid_t, dtrace_xcall_t, void *);
+
+extern int dtrace_safe_defer_signal(void);
+extern void dtrace_safe_synchronous_signal(void);
+
+extern int dtrace_mach_aframes(void);
+
+#if !defined(__APPLE__)
+#if defined(__i386) || defined(__amd64)
+extern int dtrace_instr_size(uchar_t *instr);
+extern int dtrace_instr_size_isa(uchar_t *, model_t, int *);
+extern void dtrace_invop_add(int (*)(uintptr_t, uintptr_t *, uintptr_t));
+extern void dtrace_invop_remove(int (*)(uintptr_t, uintptr_t *, uintptr_t));
+extern void dtrace_invop_callsite(void);
+#endif
+
+#ifdef __sparc
+extern int dtrace_blksuword32(uintptr_t, uint32_t *, int);
+extern void dtrace_getfsr(uint64_t *);
+#endif
+#else
+#if defined(__i386__) || defined(__x86_64__)
+extern int dtrace_instr_size(uchar_t *instr);
+extern int dtrace_instr_size_isa(uchar_t *, model_t, int *);
+extern void dtrace_invop_add(int (*)(uintptr_t, uintptr_t *, uintptr_t));
+extern void dtrace_invop_remove(int (*)(uintptr_t, uintptr_t *, uintptr_t));
+extern void *dtrace_invop_callsite_pre;
+extern void *dtrace_invop_callsite_post;
+#endif
+
+    
+#undef proc_t
+#endif /* __APPLE__ */
+
+#define DTRACE_CPUFLAG_ISSET(flag) \
+        (cpu_core[CPU->cpu_id].cpuc_dtrace_flags & (flag))
+
+#define DTRACE_CPUFLAG_SET(flag) \
+        (cpu_core[CPU->cpu_id].cpuc_dtrace_flags |= (flag))
+
+#define DTRACE_CPUFLAG_CLEAR(flag) \
+        (cpu_core[CPU->cpu_id].cpuc_dtrace_flags &= ~(flag))
+
+#endif /* _KERNEL */
+
+#endif  /* _ASM */
+
+#if !defined(__APPLE__)
+#if defined(__i386) || defined(__amd64)
+
+#define	DTRACE_INVOP_PUSHL_EBP		1
+#define	DTRACE_INVOP_POPL_EBP		2
+#define	DTRACE_INVOP_LEAVE		3
+#define	DTRACE_INVOP_NOP		4
+#define	DTRACE_INVOP_RET		5
+
+#endif
+#else
+#if defined(__i386__) || defined(__x86_64__)
+
+#define DTRACE_INVOP_PUSHL_EBP          1
+#define DTRACE_INVOP_POPL_EBP           2
+#define DTRACE_INVOP_LEAVE              3
+#define DTRACE_INVOP_NOP                4
+#define DTRACE_INVOP_RET                5
+
+#endif
+
+
+#endif /* __APPLE__ */
+
+#ifdef  __cplusplus
+}
+#endif
+
+#endif  /* _SYS_DTRACE_H */
diff -Nur cctools-877.5/include/sys/dtrace_glue.h cctools-877.5-AnV/include/sys/dtrace_glue.h
--- cctools-877.5/include/sys/dtrace_glue.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/dtrace_glue.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,567 @@
+/*
+ * Copyright (c) 2005-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _DTRACE_GLUE_H
+#define _DTRACE_GLUE_H
+
+#ifdef KERNEL_BUILD
+
+#include <libkern/libkern.h>
+#include <kern/locks.h>
+#include <kern/thread_call.h>
+#include <kern/thread.h>
+#include <machine/machine_routines.h>
+#include <sys/syslog.h>
+#include <sys/ucred.h>
+#include <stdarg.h>
+#include <mach/kmod.h>
+#include <libkern/OSAtomic.h>
+
+#if defined(__i386__) || defined(__x86_64__)
+#include <i386/mp.h>
+#endif
+
+/*
+ * cmn_err
+ */
+#define	CE_CONT		0	/* continuation		*/
+#define	CE_NOTE		1	/* notice		*/
+#define	CE_WARN		2	/* warning		*/
+#define	CE_PANIC	3	/* panic		*/
+#define	CE_IGNORE	4	/* print nothing	*/
+
+extern void cmn_err( int, const char *, ... );
+
+/*
+ * pid/proc
+ */
+
+/* Solaris proc_t is the struct. Darwin's proc_t is a pointer to it. */
+#define proc_t struct proc /* Steer clear of the Darwin typedef for proc_t */
+#define curproc ((struct proc *)current_proc()) /* Called from probe context, must blacklist */
+
+proc_t* sprlock(pid_t pid);
+void sprunlock(proc_t *p);
+
+/*
+ * uread/uwrite
+ */
+
+int uread(proc_t *p, void *buf, user_size_t len, user_addr_t a);
+int uwrite(proc_t *p, void *buf, user_size_t len, user_addr_t a);
+
+/*
+ * fuword / suword
+ */
+
+int fuword8(user_addr_t, uint8_t *);
+int fuword16(user_addr_t, uint16_t *);
+int fuword32(user_addr_t, uint32_t *);
+int fuword64(user_addr_t, uint64_t *);
+
+void fuword8_noerr(user_addr_t, uint8_t *);
+void fuword16_noerr(user_addr_t, uint16_t *);
+void fuword32_noerr(user_addr_t, uint32_t *);
+void fuword64_noerr(user_addr_t, uint64_t *);
+
+int suword64(user_addr_t, uint64_t value);
+int suword32(user_addr_t, uint32_t value);
+int suword16(user_addr_t, uint16_t value);
+int suword8(user_addr_t, uint8_t value);
+
+/*
+ * cpuvar
+ */
+extern lck_mtx_t cpu_lock;
+extern lck_mtx_t cyc_lock;
+extern lck_mtx_t mod_lock;
+
+/*
+ * wrap_timer_call: wrapper of timer_call for cyclic timers.
+ */
+struct wrap_timer_call;
+
+/*
+ * Per-CPU data.
+ */
+typedef struct dtrace_cpu {
+	processorid_t   cpu_id;                    /* CPU number */
+	struct dtrace_cpu *cpu_next;                 /* next existing CPU */
+	lck_rw_t        cpu_ft_lock;               /* DTrace: fasttrap lock */
+	uintptr_t       cpu_dtrace_caller;         /* DTrace: caller, if any */
+	hrtime_t        cpu_dtrace_chillmark;      /* DTrace: chill mark time */
+	hrtime_t        cpu_dtrace_chilled;        /* DTrace: total chill time */
+	boolean_t       cpu_dtrace_invop_underway; /* DTrace gaurds against invalid op re-entrancy */
+
+	/* Local cyclic timers on this CPU */
+	LIST_HEAD(cyc_list_head, wrap_timer_call) cpu_cyc_list;
+} dtrace_cpu_t;
+
+extern dtrace_cpu_t *cpu_list;
+
+/*
+ * The cpu_core structure consists of per-CPU state available in any context.
+ * On some architectures, this may mean that the page(s) containing the
+ * NCPU-sized array of cpu_core structures must be locked in the TLB -- it
+ * is up to the platform to assure that this is performed properly.  Note that
+ * the structure is sized to avoid false sharing.
+ */
+#define	CPU_CACHE_COHERENCE_SIZE	64
+
+typedef struct cpu_core {
+	uint64_t	cpuc_dtrace_illval;     /* DTrace illegal value */
+	lck_mtx_t	cpuc_pid_lock;          /* DTrace pid provider lock */
+	uint16_t	cpuc_dtrace_flags;      /* DTrace flags */
+        uint64_t	cpuc_missing_tos;	/* Addr. of top most stack frame if missing */
+        uint8_t		cpuc_pad[CPU_CACHE_COHERENCE_SIZE - sizeof(uint64_t) - sizeof(lck_mtx_t) - sizeof(uint16_t) - sizeof(uint64_t) ];	/* padding */
+} cpu_core_t;
+
+extern cpu_core_t *cpu_core;
+
+extern unsigned int dtrace_max_cpus;		/* max number of enabled cpus */
+#define NCPU	    dtrace_max_cpus
+
+extern int cpu_number(void); /* From #include <kern/cpu_number.h>. Called from probe context, must blacklist. */
+
+#define	CPU		(&(cpu_list[cpu_number()]))	/* Pointer to current CPU */
+#define	CPU_ON_INTR(cpup) ml_at_interrupt_context() /* always invoked on current cpu */
+
+/*
+ * Routines used to register interest in cpu's being added to or removed
+ * from the system.
+ */
+typedef enum {
+	CPU_INIT,
+	CPU_CONFIG,
+	CPU_UNCONFIG,
+	CPU_ON,
+	CPU_OFF,
+	CPU_CPUPART_IN,
+	CPU_CPUPART_OUT
+} cpu_setup_t;
+
+typedef int cpu_setup_func_t(cpu_setup_t, int, void *);
+
+extern void register_cpu_setup_func(cpu_setup_func_t *, void *);
+extern void unregister_cpu_setup_func(cpu_setup_func_t *, void *);
+
+/*
+ * CPU_DTRACE
+ */
+
+/*
+ * DTrace flags.
+ */
+#define	CPU_DTRACE_NOFAULT	0x0001	/* Don't fault */
+#define	CPU_DTRACE_DROP		0x0002	/* Drop this ECB */
+#define	CPU_DTRACE_BADADDR	0x0004	/* DTrace fault: bad address */
+#define	CPU_DTRACE_BADALIGN	0x0008	/* DTrace fault: bad alignment */
+#define	CPU_DTRACE_DIVZERO	0x0010	/* DTrace fault: divide by zero */
+#define	CPU_DTRACE_ILLOP	0x0020	/* DTrace fault: illegal operation */
+#define	CPU_DTRACE_NOSCRATCH	0x0040	/* DTrace fault: out of scratch */
+#define	CPU_DTRACE_KPRIV	0x0080	/* DTrace fault: bad kernel access */
+#define	CPU_DTRACE_UPRIV	0x0100	/* DTrace fault: bad user access */
+#define	CPU_DTRACE_TUPOFLOW	0x0200	/* DTrace fault: tuple stack overflow */
+#define CPU_DTRACE_USTACK_FP	0x0400  /* pid provider hint to ustack() */
+#define	CPU_DTRACE_ENTRY	0x0800	/* pid provider hint to ustack() */
+#define CPU_DTRACE_BADSTACK 0x1000  /* DTrace fault: bad stack */
+
+#define	CPU_DTRACE_FAULT	(CPU_DTRACE_BADADDR | CPU_DTRACE_BADALIGN | \
+				CPU_DTRACE_DIVZERO | CPU_DTRACE_ILLOP | \
+				CPU_DTRACE_NOSCRATCH | CPU_DTRACE_KPRIV | \
+				CPU_DTRACE_UPRIV | CPU_DTRACE_TUPOFLOW | \
+				CPU_DTRACE_BADSTACK)
+#define	CPU_DTRACE_ERROR	(CPU_DTRACE_FAULT | CPU_DTRACE_DROP)
+
+/*
+ * Loadable Modules
+ */
+
+/* Keep the compiler happy */
+struct dtrace_module_symbols;
+
+/* Solaris' modctl structure, greatly simplified, shadowing parts of xnu kmod structure. */
+typedef struct modctl {
+	struct modctl	*mod_next;
+	struct modctl	*mod_stale;     // stale module chain
+	uint32_t	mod_id;		// the kext unique identifier
+	char		mod_modname[KMOD_MAX_NAME];
+	int		mod_loadcnt;
+	char		mod_loaded;
+	uint16_t	mod_flags;	// See flags below
+	int		mod_nenabled;	// # of enabled DTrace probes in module
+	vm_address_t	mod_address;	// starting address (of Mach-o header blob)
+	vm_size_t	mod_size;	// total size (of blob)
+	UUID		mod_uuid;
+	struct dtrace_module_symbols* mod_user_symbols;
+} modctl_t;
+
+/* Definitions for mod_flags */
+#define MODCTL_IS_MACH_KERNEL			0x01  // This module represents /mach_kernel
+#define MODCTL_HAS_KERNEL_SYMBOLS		0x02  // Kernel symbols (nlist) are available
+#define MODCTL_FBT_PROBES_PROVIDED      	0x04  // fbt probes have been provided
+#define MODCTL_FBT_INVALID			0x08  // Module is invalid for fbt probes
+#define MODCTL_SDT_PROBES_PROVIDED		0x10  // sdt probes have been provided
+#define MODCTL_SDT_INVALID			0x20  // Module is invalid for sdt probes
+#define MODCTL_HAS_UUID				0x40  // Module has UUID
+#define MODCTL_FBT_PRIVATE_PROBES_PROVIDED	0x80  // fbt private probes have been provided
+#define MODCTL_FBT_PROVIDE_PRIVATE_PROBES	0x100 // fbt provider must provide private probes
+
+/* Simple/singular mod_flags accessors */
+#define MOD_IS_MACH_KERNEL(mod)			(mod->mod_flags & MODCTL_IS_MACH_KERNEL)
+#define MOD_HAS_KERNEL_SYMBOLS(mod)		(mod->mod_flags & MODCTL_HAS_KERNEL_SYMBOLS)
+#define MOD_HAS_USERSPACE_SYMBOLS(mod)		(mod->mod_user_symbols) /* No point in duplicating state in the flags bits */
+#define MOD_FBT_PROBES_PROVIDED(mod)   		(mod->mod_flags & MODCTL_FBT_PROBES_PROVIDED)
+#define MOD_FBT_INVALID(mod)			(mod->mod_flags & MODCTL_FBT_INVALID)
+#define MOD_SDT_PROBES_PROVIDED(mod)   		(mod->mod_flags & MODCTL_SDT_PROBES_PROVIDED)
+#define MOD_SDT_INVALID(mod)			(mod->mod_flags & MODCTL_SDT_INVALID)
+#define MOD_HAS_UUID(mod)			(mod->mod_flags & MODCTL_HAS_UUID)
+#define MOD_FBT_PRIVATE_PROBES_PROVIDED(mod)	(mod->mod_flags & MODCTL_FBT_PRIVATE_PROBES_PROVIDED)
+#define MOD_FBT_PROVIDE_PRIVATE_PROBES(mod)	(mod->mod_flags & MODCTL_FBT_PROVIDE_PRIVATE_PROBES)
+
+/* Compound accessors */
+#define MOD_FBT_PRIVATE_PROBES_DONE(mod)	(MOD_FBT_PRIVATE_PROBES_PROVIDED(mod) || !MOD_FBT_PROVIDE_PRIVATE_PROBES(mod))
+#define MOD_FBT_DONE(mod)			((MOD_FBT_PROBES_PROVIDED(mod) && MOD_FBT_PRIVATE_PROBES_DONE(mod)) || MOD_FBT_INVALID(mod))
+#define MOD_SDT_DONE(mod)			(MOD_SDT_PROBES_PROVIDED(mod) || MOD_SDT_INVALID(mod))
+#define MOD_SYMBOLS_DONE(mod)			(MOD_FBT_DONE(mod) && MOD_SDT_DONE(mod))
+
+extern modctl_t *dtrace_modctl_list;
+
+/*
+ * cred_t
+ */
+/* Privileges */
+#define PRIV_DTRACE_KERNEL        3
+#define PRIV_DTRACE_PROC          4
+#define PRIV_DTRACE_USER          5
+#define PRIV_PROC_OWNER          30
+#define PRIV_PROC_ZONE           35
+#define	PRIV_ALL			(-1)	/* All privileges required */
+
+/* Privilege sets */
+#define PRIV_EFFECTIVE            0
+
+typedef struct ucred cred_t;
+#define cr_suid cr_svuid
+#define cr_sgid cr_svgid
+
+extern cred_t *dtrace_CRED(void); /* Safe to call from probe context. */
+#define CRED() kauth_cred_get() /* Can't be called from probe context! */
+extern int PRIV_POLICY_CHOICE(void *, int, int);
+extern int PRIV_POLICY_ONLY(void *, int, int);
+extern gid_t crgetgid(const cred_t *);
+extern uid_t crgetuid(const cred_t *);
+#define crgetzoneid(x) ((zoneid_t)0)
+
+#define crhold(a) {}
+#define crfree(a) {}
+
+/*
+ * "cyclic"
+ */
+#define	CY_LOW_LEVEL		0
+#define	CY_LOCK_LEVEL		1
+#define	CY_HIGH_LEVEL		2
+#define	CY_SOFT_LEVELS		2
+#define	CY_LEVELS			3
+
+typedef uintptr_t cyclic_id_t;
+typedef cyclic_id_t *cyclic_id_list_t;
+typedef uint16_t cyc_level_t;
+typedef void (*cyc_func_t)(void *);
+
+#define	CYCLIC_NONE		((cyclic_id_t)0)
+
+typedef struct cyc_time {
+	hrtime_t cyt_when;
+	hrtime_t cyt_interval;
+} cyc_time_t;
+
+typedef struct cyc_handler {
+	cyc_func_t cyh_func;
+	void *cyh_arg;
+	cyc_level_t cyh_level;
+} cyc_handler_t;
+
+typedef struct cyc_omni_handler {
+	void (*cyo_online)(void *, dtrace_cpu_t *, cyc_handler_t *, cyc_time_t *);
+	void (*cyo_offline)(void *, dtrace_cpu_t *, void *);
+	void *cyo_arg;
+} cyc_omni_handler_t;
+
+extern void dtrace_install_cpu_hooks(void);
+
+extern cyclic_id_t cyclic_add(cyc_handler_t *, cyc_time_t *);
+extern void cyclic_remove(cyclic_id_t);
+
+extern cyclic_id_list_t cyclic_add_omni(cyc_omni_handler_t *);
+extern void cyclic_remove_omni(cyclic_id_list_t);
+
+extern cyclic_id_t cyclic_timer_add(cyc_handler_t *, cyc_time_t *);
+extern void cyclic_timer_remove(cyclic_id_t);
+
+/*
+ * timeout / untimeout (converted to dtrace_timeout / dtrace_untimeout due to name collision)
+ */
+
+thread_call_t dtrace_timeout(void (*func)(void *, void *), void* arg, uint64_t nanos);
+
+/*
+ * ddi
+ */
+
+#define DDI_SUCCESS			0
+#define DDI_FAILURE			-1
+
+#define	DDI_DEV_T_NONE	((dev_t)-1)
+#define	DDI_DEV_T_ANY	((dev_t)-2)
+#define	DDI_MAJOR_T_UNKNOWN	((major_t)0)
+
+#define DDI_PSEUDO "ddi_pseudo"
+
+typedef enum {
+	DDI_ATTACH = 0,
+	DDI_RESUME = 1,
+	DDI_PM_RESUME = 2
+} ddi_attach_cmd_t;
+
+typedef enum {
+	DDI_DETACH = 0,
+	DDI_SUSPEND = 1,
+	DDI_PM_SUSPEND = 2,
+	DDI_HOTPLUG_DETACH = 3		/* detach, don't try to auto-unconfig */
+} ddi_detach_cmd_t;
+
+#define	DDI_PROP_SUCCESS	0
+
+#define DDI_PROP_DONTPASS   1
+typedef uint_t major_t;
+typedef uint_t minor_t;
+
+typedef struct __dev_info *dev_info_t;
+
+extern void ddi_report_dev(dev_info_t *);
+extern int ddi_soft_state_init(void **, size_t, size_t);
+extern void *ddi_get_soft_state(void *, int);
+extern int ddi_soft_state_free(void *, int);
+extern int ddi_soft_state_zalloc(void *, int);
+extern void ddi_soft_state_fini(void **);
+
+int ddi_getprop(dev_t dev, dev_info_t *dip, int flags, const char *name, int defvalue);
+
+extern int ddi_prop_free(void *);
+extern int ddi_prop_lookup_int_array(dev_t, dev_info_t *, uint_t, const char *, int **, uint_t *);
+
+extern int ddi_driver_major(dev_info_t *);
+
+extern int ddi_create_minor_node(dev_info_t *, const char *, int, minor_t, const char *, int);
+extern void ddi_remove_minor_node(dev_info_t *, char *);
+
+extern major_t getemajor(dev_t);
+extern minor_t getminor(dev_t);
+
+extern dev_t makedevice(major_t, minor_t);
+
+/*
+ * Kernel Debug Interface
+ */
+
+typedef enum kdi_dtrace_set {
+	KDI_DTSET_DTRACE_ACTIVATE,
+	KDI_DTSET_DTRACE_DEACTIVATE,
+	KDI_DTSET_KMDB_BPT_ACTIVATE,
+	KDI_DTSET_KMDB_BPT_DEACTIVATE
+} kdi_dtrace_set_t;
+
+extern int kdi_dtrace_set(kdi_dtrace_set_t);
+extern void debug_enter(char *);
+
+/*
+ * DTrace specific zone allocation
+ */
+
+/*
+ * To break dtrace memory usage out in a trackable
+ * fashion, uncomment the #define below. This will
+ * enable emulation of the general kalloc.XXX zones
+ * for most dtrace allocations. (kalloc.large is not
+ * emulated)
+ *
+ * #define DTRACE_MEMORY_ZONES 1
+ *
+ */
+
+#if defined(DTRACE_MEMORY_ZONES)
+void dtrace_alloc_init(void);
+void *dtrace_alloc(vm_size_t);
+void dtrace_free(void *, vm_size_t);
+#endif
+
+/*
+ * kmem
+ */
+
+#define KM_SLEEP	0x00000000
+#define KM_NOSLEEP	0x00000001
+
+typedef struct vmem vmem_t;
+typedef struct kmem_cache kmem_cache_t;
+
+#define kmem_alloc dt_kmem_alloc /* Avoid clash with Darwin's kmem_alloc */
+#define kmem_free dt_kmem_free /* Avoid clash with Darwin's kmem_free */
+#define kmem_zalloc dt_kmem_zalloc /* Avoid clash with Darwin's kmem_zalloc */
+extern void *dt_kmem_alloc(size_t, int);
+extern void dt_kmem_free(void *, size_t);
+extern void *dt_kmem_zalloc(size_t, int);
+
+extern void *dt_kmem_alloc_aligned(size_t, size_t, int);
+extern void *dt_kmem_zalloc_aligned(size_t, size_t, int);
+extern void dt_kmem_free_aligned(void*, size_t);
+
+extern kmem_cache_t *
+kmem_cache_create(const char *, size_t, size_t, int (*)(void *, void *, int),
+	void (*)(void *, void *), void (*)(void *), void *, vmem_t *, int);
+extern void *kmem_cache_alloc(kmem_cache_t *, int);
+extern void kmem_cache_free(kmem_cache_t *, void *);
+extern void kmem_cache_destroy(kmem_cache_t *);
+
+/*
+ * kthread
+ */
+
+typedef struct _kthread kthread_t; /* For dtrace_vtime_switch(), dtrace_panicked and dtrace_errthread */
+
+/*
+ * proc
+ */
+
+#define DATAMODEL_MASK  0x0FF00000
+
+#define DATAMODEL_ILP32 0x00100000
+#define DATAMODEL_LP64  0x00200000
+
+#define DATAMODEL_NONE  0
+
+#if     defined(__LP64__)
+#define DATAMODEL_NATIVE        DATAMODEL_LP64
+#else
+#define DATAMODEL_NATIVE        DATAMODEL_ILP32
+#endif  /* __LP64__ */
+
+typedef unsigned int model_t; /* For dtrace_instr_size_isa() prototype in <sys/dtrace.h> */
+
+/*
+ * taskq
+ */
+
+#define	TQ_SLEEP	0x00	/* Can block for memory */
+
+typedef uint_t pri_t;
+typedef struct taskq taskq_t;
+typedef void (task_func_t)(void *);
+typedef uintptr_t taskqid_t;
+
+extern taskq_t	*taskq_create(const char *, int, pri_t, int, int, uint_t);
+extern taskqid_t taskq_dispatch(taskq_t *, task_func_t, void *, uint_t);
+extern void	taskq_destroy(taskq_t *);
+
+extern pri_t maxclsyspri;
+
+/*
+ * vmem
+ */
+
+#define	VMC_IDENTIFIER	0x00040000	/* not backed by memory */
+#define	VM_SLEEP	0x00000000	/* same as KM_SLEEP */
+#define	VM_BESTFIT	0x00000100
+
+extern void *vmem_alloc(vmem_t *, size_t, int);
+extern vmem_t *vmem_create(const char *, void *, size_t, size_t, void *,
+					void *, vmem_t *, size_t, int);
+extern void vmem_destroy(vmem_t *);
+extern void vmem_free(vmem_t *vmp, void *vaddr, size_t size);
+
+/*
+ * Atomic
+ */
+
+static inline void atomic_add_32( uint32_t *theAddress, int32_t theAmount )
+{
+	(void)OSAddAtomic( theAmount, theAddress );
+}
+
+#if defined(__i386__) || defined(__x86_64__)
+static inline void atomic_add_64( uint64_t *theAddress, int64_t theAmount )
+{
+	(void)OSAddAtomic64( theAmount, (SInt64 *)theAddress );
+}
+#endif
+
+/*
+ * Miscellaneous
+ */
+
+typedef uintptr_t pc_t;
+typedef uintptr_t greg_t; /* For dtrace_impl.h prototype of dtrace_getfp() */
+extern struct regs *find_user_regs( thread_t thread);
+extern vm_offset_t dtrace_get_cpu_int_stack_top(void);
+extern vm_offset_t max_valid_stack_address(void); /* kern/thread.h */
+
+extern volatile int panicwait; /* kern/debug.c */
+#define panic_quiesce (panicwait)
+
+#define	IS_P2ALIGNED(v, a) ((((uintptr_t)(v)) & ((uintptr_t)(a) - 1)) == 0)
+
+extern void delay( int ); /* kern/clock.h */
+
+extern int vuprintf(const char *, va_list);
+
+extern hrtime_t dtrace_abs_to_nano(uint64_t);
+
+__private_extern__ const char * strstr(const char *, const char *);
+
+#undef proc_t
+
+/*
+ * Safe counted string compare against a literal string. The sizeof() intentionally
+ * counts the trailing NUL, and so ensures that all the characters in the literal
+ * can participate in the comparison.
+ */
+#define LIT_STRNEQL(s1, lit_s2) (0 == strncmp( (s1), (lit_s2), sizeof((lit_s2)) ))
+
+/*
+ * Safe counted string compare of a literal against the beginning of a string. Here
+ * the sizeof() is reduced by 1 so that the trailing null of the literal does not
+ * participate in the comparison.
+ */
+#define LIT_STRNSTART(s1, lit_s2) (0 == strncmp( (s1), (lit_s2), sizeof((lit_s2)) - 1 ))
+
+#define KERNELBASE VM_MIN_KERNEL_ADDRESS
+#endif /* KERNEL_BUILD */
+#endif /* _DTRACE_GLUE_H */
+
diff -Nur cctools-877.5/include/sys/dtrace_impl.h cctools-877.5-AnV/include/sys/dtrace_impl.h
--- cctools-877.5/include/sys/dtrace_impl.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/dtrace_impl.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,1378 @@
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License (the "License").
+ * You may not use this file except in compliance with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+
+/*
+ * Copyright 2007 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef _SYS_DTRACE_IMPL_H
+#define	_SYS_DTRACE_IMPL_H
+
+/* #pragma ident	"@(#)dtrace_impl.h	1.23	07/02/16 SMI" */
+
+#ifdef	__cplusplus
+extern "C" {
+#endif
+
+/*
+ * DTrace Dynamic Tracing Software: Kernel Implementation Interfaces
+ *
+ * Note: The contents of this file are private to the implementation of the
+ * Solaris system and DTrace subsystem and are subject to change at any time
+ * without notice.  Applications and drivers using these interfaces will fail
+ * to run on future releases.  These interfaces should not be used for any
+ * purpose except those expressly outlined in dtrace(7D) and libdtrace(3LIB).
+ * Please refer to the "Solaris Dynamic Tracing Guide" for more information.
+ */
+
+#include <sys/dtrace.h>
+
+/*
+ * DTrace Implementation Locks
+ */
+extern lck_mtx_t dtrace_procwaitfor_lock;
+
+/*
+ * DTrace Implementation Constants and Typedefs
+ */
+#define	DTRACE_MAXPROPLEN		128
+#define	DTRACE_DYNVAR_CHUNKSIZE		256
+
+struct dtrace_probe;
+struct dtrace_ecb;
+struct dtrace_predicate;
+struct dtrace_action;
+struct dtrace_provider;
+struct dtrace_state;
+
+typedef struct dtrace_probe dtrace_probe_t;
+typedef struct dtrace_ecb dtrace_ecb_t;
+typedef struct dtrace_predicate dtrace_predicate_t;
+typedef struct dtrace_action dtrace_action_t;
+typedef struct dtrace_provider dtrace_provider_t;
+typedef struct dtrace_meta dtrace_meta_t;
+typedef struct dtrace_state dtrace_state_t;
+typedef uint32_t dtrace_optid_t;
+typedef uint32_t dtrace_specid_t;
+typedef uint64_t dtrace_genid_t;
+
+/*
+ * DTrace Probes
+ *
+ * The probe is the fundamental unit of the DTrace architecture.  Probes are
+ * created by DTrace providers, and managed by the DTrace framework.  A probe
+ * is identified by a unique <provider, module, function, name> tuple, and has
+ * a unique probe identifier assigned to it.  (Some probes are not associated
+ * with a specific point in text; these are called _unanchored probes_ and have
+ * no module or function associated with them.)  Probes are represented as a
+ * dtrace_probe structure.  To allow quick lookups based on each element of the
+ * probe tuple, probes are hashed by each of provider, module, function and
+ * name.  (If a lookup is performed based on a regular expression, a
+ * dtrace_probekey is prepared, and a linear search is performed.) Each probe
+ * is additionally pointed to by a linear array indexed by its identifier.  The
+ * identifier is the provider's mechanism for indicating to the DTrace
+ * framework that a probe has fired:  the identifier is passed as the first
+ * argument to dtrace_probe(), where it is then mapped into the corresponding
+ * dtrace_probe structure.  From the dtrace_probe structure, dtrace_probe() can
+ * iterate over the probe's list of enabling control blocks; see "DTrace
+ * Enabling Control Blocks", below.)
+ */
+struct dtrace_probe {
+	dtrace_id_t dtpr_id;			/* probe identifier */
+	dtrace_ecb_t *dtpr_ecb;			/* ECB list; see below */
+	dtrace_ecb_t *dtpr_ecb_last;		/* last ECB in list */
+	void *dtpr_arg;				/* provider argument */
+	dtrace_cacheid_t dtpr_predcache;	/* predicate cache ID */
+	int dtpr_aframes;			/* artificial frames */
+	dtrace_provider_t *dtpr_provider;	/* pointer to provider */
+	char *dtpr_mod;				/* probe's module name */
+	char *dtpr_func;			/* probe's function name */
+	char *dtpr_name;			/* probe's name */
+	dtrace_probe_t *dtpr_nextmod;		/* next in module hash */
+	dtrace_probe_t *dtpr_prevmod;		/* previous in module hash */
+	dtrace_probe_t *dtpr_nextfunc;		/* next in function hash */
+	dtrace_probe_t *dtpr_prevfunc;		/* previous in function hash */
+	dtrace_probe_t *dtpr_nextname;		/* next in name hash */
+	dtrace_probe_t *dtpr_prevname;		/* previous in name hash */
+	dtrace_genid_t dtpr_gen;		/* probe generation ID */
+};
+
+typedef int dtrace_probekey_f(const char *, const char *, int);
+
+typedef struct dtrace_probekey {
+	const char *dtpk_prov;			/* provider name to match */
+	dtrace_probekey_f *dtpk_pmatch;		/* provider matching function */
+	const char *dtpk_mod;			/* module name to match */
+	dtrace_probekey_f *dtpk_mmatch;		/* module matching function */
+	const char *dtpk_func;			/* func name to match */
+	dtrace_probekey_f *dtpk_fmatch;		/* func matching function */
+	const char *dtpk_name;			/* name to match */
+	dtrace_probekey_f *dtpk_nmatch;		/* name matching function */
+	dtrace_id_t dtpk_id;			/* identifier to match */
+} dtrace_probekey_t;
+
+typedef struct dtrace_hashbucket {
+	struct dtrace_hashbucket *dthb_next;	/* next on hash chain */
+	dtrace_probe_t *dthb_chain;		/* chain of probes */
+	int dthb_len;				/* number of probes here */
+} dtrace_hashbucket_t;
+
+typedef struct dtrace_hash {
+	dtrace_hashbucket_t **dth_tab;		/* hash table */
+	int dth_size;				/* size of hash table */
+	int dth_mask;				/* mask to index into table */
+	int dth_nbuckets;			/* total number of buckets */
+	uintptr_t dth_nextoffs;			/* offset of next in probe */
+	uintptr_t dth_prevoffs;			/* offset of prev in probe */
+	uintptr_t dth_stroffs;			/* offset of str in probe */
+} dtrace_hash_t;
+
+/*
+ * DTrace Enabling Control Blocks
+ *
+ * When a provider wishes to fire a probe, it calls into dtrace_probe(),
+ * passing the probe identifier as the first argument.  As described above,
+ * dtrace_probe() maps the identifier into a pointer to a dtrace_probe_t
+ * structure.  This structure contains information about the probe, and a
+ * pointer to the list of Enabling Control Blocks (ECBs).  Each ECB points to
+ * DTrace consumer state, and contains an optional predicate, and a list of
+ * actions.  (Shown schematically below.)  The ECB abstraction allows a single
+ * probe to be multiplexed across disjoint consumers, or across disjoint
+ * enablings of a single probe within one consumer.
+ *
+ *   Enabling Control Block
+ *        dtrace_ecb_t
+ * +------------------------+
+ * | dtrace_epid_t ---------+--------------> Enabled Probe ID (EPID)
+ * | dtrace_state_t * ------+--------------> State associated with this ECB
+ * | dtrace_predicate_t * --+---------+
+ * | dtrace_action_t * -----+----+    |
+ * | dtrace_ecb_t * ---+    |    |    |       Predicate (if any)
+ * +-------------------+----+    |    |       dtrace_predicate_t
+ *                     |         |    +---> +--------------------+
+ *                     |         |          | dtrace_difo_t * ---+----> DIFO
+ *                     |         |          +--------------------+
+ *                     |         |
+ *            Next ECB |         |           Action
+ *            (if any) |         |       dtrace_action_t
+ *                     :         +--> +-------------------+
+ *                     :              | dtrace_actkind_t -+------> kind
+ *                     v              | dtrace_difo_t * --+------> DIFO (if any)
+ *                                    | dtrace_recdesc_t -+------> record descr.
+ *                                    | dtrace_action_t * +------+
+ *                                    +-------------------+      |
+ *                                                               | Next action
+ *                               +-------------------------------+  (if any)
+ *                               |
+ *                               |           Action
+ *                               |       dtrace_action_t
+ *                               +--> +-------------------+
+ *                                    | dtrace_actkind_t -+------> kind
+ *                                    | dtrace_difo_t * --+------> DIFO (if any)
+ *                                    | dtrace_action_t * +------+
+ *                                    +-------------------+      |
+ *                                                               | Next action
+ *                               +-------------------------------+  (if any)
+ *                               |
+ *                               :
+ *                               v
+ *
+ *
+ * dtrace_probe() iterates over the ECB list.  If the ECB needs less space
+ * than is available in the principal buffer, the ECB is processed:  if the
+ * predicate is non-NULL, the DIF object is executed.  If the result is
+ * non-zero, the action list is processed, with each action being executed
+ * accordingly.  When the action list has been completely executed, processing
+ * advances to the next ECB.  processing advances to the next ECB.  If the
+ * result is non-zero; For each ECB, it first determines the The ECB
+ * abstraction allows disjoint consumers to multiplex on single probes.
+ */
+struct dtrace_ecb {
+	dtrace_epid_t dte_epid;			/* enabled probe ID */
+	uint32_t dte_alignment;			/* required alignment */
+	size_t dte_needed;			/* bytes needed */
+	size_t dte_size;			/* total size of payload */
+	dtrace_predicate_t *dte_predicate;	/* predicate, if any */
+	dtrace_action_t *dte_action;		/* actions, if any */
+	dtrace_ecb_t *dte_next;			/* next ECB on probe */
+	dtrace_state_t *dte_state;		/* pointer to state */
+	uint32_t dte_cond;			/* security condition */
+	dtrace_probe_t *dte_probe;		/* pointer to probe */
+	dtrace_action_t *dte_action_last;	/* last action on ECB */
+	uint64_t dte_uarg;			/* library argument */
+};
+
+struct dtrace_predicate {
+	dtrace_difo_t *dtp_difo;		/* DIF object */
+	dtrace_cacheid_t dtp_cacheid;		/* cache identifier */
+	int dtp_refcnt;				/* reference count */
+};
+
+struct dtrace_action {
+	dtrace_actkind_t dta_kind;		/* kind of action */
+	uint16_t dta_intuple;			/* boolean:  in aggregation */
+	uint32_t dta_refcnt;			/* reference count */
+	dtrace_difo_t *dta_difo;		/* pointer to DIFO */
+	dtrace_recdesc_t dta_rec;		/* record description */
+	dtrace_action_t *dta_prev;		/* previous action */
+	dtrace_action_t *dta_next;		/* next action */
+};
+
+typedef struct dtrace_aggregation {
+	dtrace_action_t dtag_action;		/* action; must be first */
+	dtrace_aggid_t dtag_id;			/* identifier */
+	dtrace_ecb_t *dtag_ecb;			/* corresponding ECB */
+	dtrace_action_t *dtag_first;		/* first action in tuple */
+	uint32_t dtag_base;			/* base of aggregation */
+	uint8_t dtag_hasarg;			/* boolean:  has argument */
+	uint64_t dtag_initial;			/* initial value */
+	void (*dtag_aggregate)(uint64_t *, uint64_t, uint64_t);
+} dtrace_aggregation_t;
+
+/*
+ * DTrace Buffers
+ *
+ * Principal buffers, aggregation buffers, and speculative buffers are all
+ * managed with the dtrace_buffer structure.  By default, this structure
+ * includes twin data buffers -- dtb_tomax and dtb_xamot -- that serve as the
+ * active and passive buffers, respectively.  For speculative buffers,
+ * dtb_xamot will be NULL; for "ring" and "fill" buffers, dtb_xamot will point
+ * to a scratch buffer.  For all buffer types, the dtrace_buffer structure is
+ * always allocated on a per-CPU basis; a single dtrace_buffer structure is
+ * never shared among CPUs.  (That is, there is never true sharing of the
+ * dtrace_buffer structure; to prevent false sharing of the structure, it must
+ * always be aligned to the coherence granularity -- generally 64 bytes.)
+ *
+ * One of the critical design decisions of DTrace is that a given ECB always
+ * stores the same quantity and type of data.  This is done to assure that the
+ * only metadata required for an ECB's traced data is the EPID.  That is, from
+ * the EPID, the consumer can determine the data layout.  (The data buffer
+ * layout is shown schematically below.)  By assuring that one can determine
+ * data layout from the EPID, the metadata stream can be separated from the
+ * data stream -- simplifying the data stream enormously.
+ *
+ *      base of data buffer --->  +------+--------------------+------+
+ *                                | EPID | data               | EPID |
+ *                                +------+--------+------+----+------+
+ *                                | data          | EPID | data      |
+ *                                +---------------+------+-----------+
+ *                                | data, cont.                      |
+ *                                +------+--------------------+------+
+ *                                | EPID | data               |      |
+ *                                +------+--------------------+      |
+ *                                |                ||                |
+ *                                |                ||                |
+ *                                |                \/                |
+ *                                :                                  :
+ *                                .                                  .
+ *                                .                                  .
+ *                                .                                  .
+ *                                :                                  :
+ *                                |                                  |
+ *     limit of data buffer --->  +----------------------------------+
+ *
+ * When evaluating an ECB, dtrace_probe() determines if the ECB's needs of the
+ * principal buffer (both scratch and payload) exceed the available space.  If
+ * the ECB's needs exceed available space (and if the principal buffer policy
+ * is the default "switch" policy), the ECB is dropped, the buffer's drop count
+ * is incremented, and processing advances to the next ECB.  If the ECB's needs
+ * can be met with the available space, the ECB is processed, but the offset in
+ * the principal buffer is only advanced if the ECB completes processing
+ * without error.
+ *
+ * When a buffer is to be switched (either because the buffer is the principal
+ * buffer with a "switch" policy or because it is an aggregation buffer), a
+ * cross call is issued to the CPU associated with the buffer.  In the cross
+ * call context, interrupts are disabled, and the active and the inactive
+ * buffers are atomically switched.  This involves switching the data pointers,
+ * copying the various state fields (offset, drops, errors, etc.) into their
+ * inactive equivalents, and clearing the state fields.  Because interrupts are
+ * disabled during this procedure, the switch is guaranteed to appear atomic to
+ * dtrace_probe().
+ *
+ * DTrace Ring Buffering
+ *
+ * To process a ring buffer correctly, one must know the oldest valid record.
+ * Processing starts at the oldest record in the buffer and continues until
+ * the end of the buffer is reached.  Processing then resumes starting with
+ * the record stored at offset 0 in the buffer, and continues until the
+ * youngest record is processed.  If trace records are of a fixed-length,
+ * determining the oldest record is trivial:
+ *
+ *   - If the ring buffer has not wrapped, the oldest record is the record
+ *     stored at offset 0.
+ *
+ *   - If the ring buffer has wrapped, the oldest record is the record stored
+ *     at the current offset.
+ *
+ * With variable length records, however, just knowing the current offset
+ * doesn't suffice for determining the oldest valid record:  assuming that one
+ * allows for arbitrary data, one has no way of searching forward from the
+ * current offset to find the oldest valid record.  (That is, one has no way
+ * of separating data from metadata.) It would be possible to simply refuse to
+ * process any data in the ring buffer between the current offset and the
+ * limit, but this leaves (potentially) an enormous amount of otherwise valid
+ * data unprocessed.
+ *
+ * To effect ring buffering, we track two offsets in the buffer:  the current
+ * offset and the _wrapped_ offset.  If a request is made to reserve some
+ * amount of data, and the buffer has wrapped, the wrapped offset is
+ * incremented until the wrapped offset minus the current offset is greater
+ * than or equal to the reserve request.  This is done by repeatedly looking
+ * up the ECB corresponding to the EPID at the current wrapped offset, and
+ * incrementing the wrapped offset by the size of the data payload
+ * corresponding to that ECB.  If this offset is greater than or equal to the
+ * limit of the data buffer, the wrapped offset is set to 0.  Thus, the
+ * current offset effectively "chases" the wrapped offset around the buffer.
+ * Schematically:
+ *
+ *      base of data buffer --->  +------+--------------------+------+
+ *                                | EPID | data               | EPID |
+ *                                +------+--------+------+----+------+
+ *                                | data          | EPID | data      |
+ *                                +---------------+------+-----------+
+ *                                | data, cont.                      |
+ *                                +------+---------------------------+
+ *                                | EPID | data                      |
+ *           current offset --->  +------+---------------------------+
+ *                                | invalid data                     |
+ *           wrapped offset --->  +------+--------------------+------+
+ *                                | EPID | data               | EPID |
+ *                                +------+--------+------+----+------+
+ *                                | data          | EPID | data      |
+ *                                +---------------+------+-----------+
+ *                                :                                  :
+ *                                .                                  .
+ *                                .        ... valid data ...        .
+ *                                .                                  .
+ *                                :                                  :
+ *                                +------+-------------+------+------+
+ *                                | EPID | data        | EPID | data |
+ *                                +------+------------++------+------+
+ *                                | data, cont.       | leftover     |
+ *     limit of data buffer --->  +-------------------+--------------+
+ *
+ * If the amount of requested buffer space exceeds the amount of space
+ * available between the current offset and the end of the buffer:
+ *
+ *  (1)  all words in the data buffer between the current offset and the limit
+ *       of the data buffer (marked "leftover", above) are set to
+ *       DTRACE_EPIDNONE
+ *
+ *  (2)  the wrapped offset is set to zero
+ *
+ *  (3)  the iteration process described above occurs until the wrapped offset
+ *       is greater than the amount of desired space.
+ *
+ * The wrapped offset is implemented by (re-)using the inactive offset.
+ * In a "switch" buffer policy, the inactive offset stores the offset in
+ * the inactive buffer; in a "ring" buffer policy, it stores the wrapped
+ * offset.
+ *
+ * DTrace Scratch Buffering
+ *
+ * Some ECBs may wish to allocate dynamically-sized temporary scratch memory.
+ * To accommodate such requests easily, scratch memory may be allocated in
+ * the buffer beyond the current offset plus the needed memory of the current
+ * ECB.  If there isn't sufficient room in the buffer for the requested amount
+ * of scratch space, the allocation fails and an error is generated.  Scratch
+ * memory is tracked in the dtrace_mstate_t and is automatically freed when
+ * the ECB ceases processing.  Note that ring buffers cannot allocate their
+ * scratch from the principal buffer -- lest they needlessly overwrite older,
+ * valid data.  Ring buffers therefore have their own dedicated scratch buffer
+ * from which scratch is allocated.
+ */
+#define	DTRACEBUF_RING		0x0001		/* bufpolicy set to "ring" */
+#define	DTRACEBUF_FILL		0x0002		/* bufpolicy set to "fill" */
+#define	DTRACEBUF_NOSWITCH	0x0004		/* do not switch buffer */
+#define	DTRACEBUF_WRAPPED	0x0008		/* ring buffer has wrapped */
+#define	DTRACEBUF_DROPPED	0x0010		/* drops occurred */
+#define	DTRACEBUF_ERROR		0x0020		/* errors occurred */
+#define	DTRACEBUF_FULL		0x0040		/* "fill" buffer is full */
+#define	DTRACEBUF_CONSUMED	0x0080		/* buffer has been consumed */
+#define	DTRACEBUF_INACTIVE	0x0100		/* buffer is not yet active */
+
+typedef struct dtrace_buffer {
+	uint64_t dtb_offset;			/* current offset in buffer */
+	uint64_t dtb_size;			/* size of buffer */
+	uint32_t dtb_flags;			/* flags */
+	uint32_t dtb_drops;			/* number of drops */
+	caddr_t dtb_tomax;			/* active buffer */
+	caddr_t dtb_xamot;			/* inactive buffer */
+	uint32_t dtb_xamot_flags;		/* inactive flags */
+	uint32_t dtb_xamot_drops;		/* drops in inactive buffer */
+	uint64_t dtb_xamot_offset;		/* offset in inactive buffer */
+	uint32_t dtb_errors;			/* number of errors */
+	uint32_t dtb_xamot_errors;		/* errors in inactive buffer */
+#ifndef _LP64
+	uint64_t dtb_pad1;
+#endif
+} dtrace_buffer_t;
+
+/*
+ * DTrace Aggregation Buffers
+ *
+ * Aggregation buffers use much of the same mechanism as described above
+ * ("DTrace Buffers").  However, because an aggregation is fundamentally a
+ * hash, there exists dynamic metadata associated with an aggregation buffer
+ * that is not associated with other kinds of buffers.  This aggregation
+ * metadata is _only_ relevant for the in-kernel implementation of
+ * aggregations; it is not actually relevant to user-level consumers.  To do
+ * this, we allocate dynamic aggregation data (hash keys and hash buckets)
+ * starting below the _limit_ of the buffer, and we allocate data from the
+ * _base_ of the buffer.  When the aggregation buffer is copied out, _only_ the
+ * data is copied out; the metadata is simply discarded.  Schematically,
+ * aggregation buffers look like:
+ *
+ *      base of data buffer --->  +-------+------+-----------+-------+
+ *                                | aggid | key  | value     | aggid |
+ *                                +-------+------+-----------+-------+
+ *                                | key                              |
+ *                                +-------+-------+-----+------------+
+ *                                | value | aggid | key | value      |
+ *                                +-------+------++-----+------+-----+
+ *                                | aggid | key  | value       |     |
+ *                                +-------+------+-------------+     |
+ *                                |                ||                |
+ *                                |                ||                |
+ *                                |                \/                |
+ *                                :                                  :
+ *                                .                                  .
+ *                                .                                  .
+ *                                .                                  .
+ *                                :                                  :
+ *                                |                /\                |
+ *                                |                ||   +------------+
+ *                                |                ||   |            |
+ *                                +---------------------+            |
+ *                                | hash keys                        |
+ *                                | (dtrace_aggkey structures)       |
+ *                                |                                  |
+ *                                +----------------------------------+
+ *                                | hash buckets                     |
+ *                                | (dtrace_aggbuffer structure)     |
+ *                                |                                  |
+ *     limit of data buffer --->  +----------------------------------+
+ *
+ *
+ * As implied above, just as we assure that ECBs always store a constant
+ * amount of data, we assure that a given aggregation -- identified by its
+ * aggregation ID -- always stores data of a constant quantity and type.
+ * As with EPIDs, this allows the aggregation ID to serve as the metadata for a
+ * given record.
+ *
+ * Note that the size of the dtrace_aggkey structure must be sizeof (uintptr_t)
+ * aligned.  (If this the structure changes such that this becomes false, an
+ * assertion will fail in dtrace_aggregate().)
+ */
+typedef struct dtrace_aggkey {
+	uint32_t dtak_hashval;			/* hash value */
+	uint32_t dtak_action:4;			/* action -- 4 bits */
+	uint32_t dtak_size:28;			/* size -- 28 bits */
+	caddr_t dtak_data;			/* data pointer */
+	struct dtrace_aggkey *dtak_next;	/* next in hash chain */
+} dtrace_aggkey_t;
+
+typedef struct dtrace_aggbuffer {
+	uintptr_t dtagb_hashsize;		/* number of buckets */
+	uintptr_t dtagb_free;			/* free list of keys */
+	dtrace_aggkey_t **dtagb_hash;		/* hash table */
+} dtrace_aggbuffer_t;
+
+/*
+ * DTrace Speculations
+ *
+ * Speculations have a per-CPU buffer and a global state.  Once a speculation
+ * buffer has been comitted or discarded, it cannot be reused until all CPUs
+ * have taken the same action (commit or discard) on their respective
+ * speculative buffer.  However, because DTrace probes may execute in arbitrary
+ * context, other CPUs cannot simply be cross-called at probe firing time to
+ * perform the necessary commit or discard.  The speculation states thus
+ * optimize for the case that a speculative buffer is only active on one CPU at
+ * the time of a commit() or discard() -- for if this is the case, other CPUs
+ * need not take action, and the speculation is immediately available for
+ * reuse.  If the speculation is active on multiple CPUs, it must be
+ * asynchronously cleaned -- potentially leading to a higher rate of dirty
+ * speculative drops.  The speculation states are as follows:
+ *
+ *  DTRACESPEC_INACTIVE       <= Initial state; inactive speculation
+ *  DTRACESPEC_ACTIVE         <= Allocated, but not yet speculatively traced to
+ *  DTRACESPEC_ACTIVEONE      <= Speculatively traced to on one CPU
+ *  DTRACESPEC_ACTIVEMANY     <= Speculatively traced to on more than one CPU
+ *  DTRACESPEC_COMMITTING     <= Currently being commited on one CPU
+ *  DTRACESPEC_COMMITTINGMANY <= Currently being commited on many CPUs
+ *  DTRACESPEC_DISCARDING     <= Currently being discarded on many CPUs
+ *
+ * The state transition diagram is as follows:
+ *
+ *     +----------------------------------------------------------+
+ *     |                                                          |
+ *     |                      +------------+                      |
+ *     |  +-------------------| COMMITTING |<-----------------+   |
+ *     |  |                   +------------+                  |   |
+ *     |  | copied spec.            ^             commit() on |   | discard() on
+ *     |  | into principal          |              active CPU |   | active CPU
+ *     |  |                         | commit()                |   |
+ *     V  V                         |                         |   |
+ * +----------+                 +--------+                +-----------+
+ * | INACTIVE |---------------->| ACTIVE |--------------->| ACTIVEONE |
+ * +----------+  speculation()  +--------+  speculate()   +-----------+
+ *     ^  ^                         |                         |   |
+ *     |  |                         | discard()               |   |
+ *     |  | asynchronously          |            discard() on |   | speculate()
+ *     |  | cleaned                 V            inactive CPU |   | on inactive
+ *     |  |                   +------------+                  |   | CPU
+ *     |  +-------------------| DISCARDING |<-----------------+   |
+ *     |                      +------------+                      |
+ *     | asynchronously             ^                             |
+ *     | copied spec.               |       discard()             |
+ *     | into principal             +------------------------+    |
+ *     |                                                     |    V
+ *  +----------------+             commit()              +------------+
+ *  | COMMITTINGMANY |<----------------------------------| ACTIVEMANY |
+ *  +----------------+                                   +------------+
+ */
+typedef enum dtrace_speculation_state {
+	DTRACESPEC_INACTIVE = 0,
+	DTRACESPEC_ACTIVE,
+	DTRACESPEC_ACTIVEONE,
+	DTRACESPEC_ACTIVEMANY,
+	DTRACESPEC_COMMITTING,
+	DTRACESPEC_COMMITTINGMANY,
+	DTRACESPEC_DISCARDING
+} dtrace_speculation_state_t;
+
+typedef struct dtrace_speculation {
+	dtrace_speculation_state_t dtsp_state;	/* current speculation state */
+	int dtsp_cleaning;			/* non-zero if being cleaned */
+	dtrace_buffer_t *dtsp_buffer;		/* speculative buffer */
+} dtrace_speculation_t;
+
+/*
+ * DTrace Dynamic Variables
+ *
+ * The dynamic variable problem is obviously decomposed into two subproblems:
+ * allocating new dynamic storage, and freeing old dynamic storage.  The
+ * presence of the second problem makes the first much more complicated -- or
+ * rather, the absence of the second renders the first trivial.  This is the
+ * case with aggregations, for which there is effectively no deallocation of
+ * dynamic storage.  (Or more accurately, all dynamic storage is deallocated
+ * when a snapshot is taken of the aggregation.)  As DTrace dynamic variables
+ * allow for both dynamic allocation and dynamic deallocation, the
+ * implementation of dynamic variables is quite a bit more complicated than
+ * that of their aggregation kin.
+ *
+ * We observe that allocating new dynamic storage is tricky only because the
+ * size can vary -- the allocation problem is much easier if allocation sizes
+ * are uniform.  We further observe that in D, the size of dynamic variables is
+ * actually _not_ dynamic -- dynamic variable sizes may be determined by static
+ * analysis of DIF text.  (This is true even of putatively dynamically-sized
+ * objects like strings and stacks, the sizes of which are dictated by the
+ * "stringsize" and "stackframes" variables, respectively.)  We exploit this by
+ * performing this analysis on all DIF before enabling any probes.  For each
+ * dynamic load or store, we calculate the dynamically-allocated size plus the
+ * size of the dtrace_dynvar structure plus the storage required to key the
+ * data.  For all DIF, we take the largest value and dub it the _chunksize_.
+ * We then divide dynamic memory into two parts:  a hash table that is wide
+ * enough to have every chunk in its own bucket, and a larger region of equal
+ * chunksize units.  Whenever we wish to dynamically allocate a variable, we
+ * always allocate a single chunk of memory.  Depending on the uniformity of
+ * allocation, this will waste some amount of memory -- but it eliminates the
+ * non-determinism inherent in traditional heap fragmentation.
+ *
+ * Dynamic objects are allocated by storing a non-zero value to them; they are
+ * deallocated by storing a zero value to them.  Dynamic variables are
+ * complicated enormously by being shared between CPUs.  In particular,
+ * consider the following scenario:
+ *
+ *                 CPU A                                 CPU B
+ *  +---------------------------------+   +---------------------------------+
+ *  |                                 |   |                                 |
+ *  | allocates dynamic object a[123] |   |                                 |
+ *  | by storing the value 345 to it  |   |                                 |
+ *  |                               --------->                              |
+ *  |                                 |   | wishing to load from object     |
+ *  |                                 |   | a[123], performs lookup in      |
+ *  |                                 |   | dynamic variable space          |
+ *  |                               <---------                              |
+ *  | deallocates object a[123] by    |   |                                 |
+ *  | storing 0 to it                 |   |                                 |
+ *  |                                 |   |                                 |
+ *  | allocates dynamic object b[567] |   | performs load from a[123]       |
+ *  | by storing the value 789 to it  |   |                                 |
+ *  :                                 :   :                                 :
+ *  .                                 .   .                                 .
+ *
+ * This is obviously a race in the D program, but there are nonetheless only
+ * two valid values for CPU B's load from a[123]:  345 or 0.  Most importantly,
+ * CPU B may _not_ see the value 789 for a[123].
+ *
+ * There are essentially two ways to deal with this:
+ *
+ *  (1)  Explicitly spin-lock variables.  That is, if CPU B wishes to load
+ *       from a[123], it needs to lock a[123] and hold the lock for the
+ *       duration that it wishes to manipulate it.
+ *
+ *  (2)  Avoid reusing freed chunks until it is known that no CPU is referring
+ *       to them.
+ *
+ * The implementation of (1) is rife with complexity, because it requires the
+ * user of a dynamic variable to explicitly decree when they are done using it.
+ * Were all variables by value, this perhaps wouldn't be debilitating -- but
+ * dynamic variables of non-scalar types are tracked by reference.  That is, if
+ * a dynamic variable is, say, a string, and that variable is to be traced to,
+ * say, the principal buffer, the DIF emulation code returns to the main
+ * dtrace_probe() loop a pointer to the underlying storage, not the contents of
+ * the storage.  Further, code calling on DIF emulation would have to be aware
+ * that the DIF emulation has returned a reference to a dynamic variable that
+ * has been potentially locked.  The variable would have to be unlocked after
+ * the main dtrace_probe() loop is finished with the variable, and the main
+ * dtrace_probe() loop would have to be careful to not call any further DIF
+ * emulation while the variable is locked to avoid deadlock.  More generally,
+ * if one were to implement (1), DIF emulation code dealing with dynamic
+ * variables could only deal with one dynamic variable at a time (lest deadlock
+ * result).  To sum, (1) exports too much subtlety to the users of dynamic
+ * variables -- increasing maintenance burden and imposing serious constraints
+ * on future DTrace development.
+ *
+ * The implementation of (2) is also complex, but the complexity is more
+ * manageable.  We need to be sure that when a variable is deallocated, it is
+ * not placed on a traditional free list, but rather on a _dirty_ list.  Once a
+ * variable is on a dirty list, it cannot be found by CPUs performing a
+ * subsequent lookup of the variable -- but it may still be in use by other
+ * CPUs.  To assure that all CPUs that may be seeing the old variable have
+ * cleared out of probe context, a dtrace_sync() can be issued.  Once the
+ * dtrace_sync() has completed, it can be known that all CPUs are done
+ * manipulating the dynamic variable -- the dirty list can be atomically
+ * appended to the free list.  Unfortunately, there's a slight hiccup in this
+ * mechanism:  dtrace_sync() may not be issued from probe context.  The
+ * dtrace_sync() must be therefore issued asynchronously from non-probe
+ * context.  For this we rely on the DTrace cleaner, a cyclic that runs at the
+ * "cleanrate" frequency.  To ease this implementation, we define several chunk
+ * lists:
+ *
+ *   - Dirty.  Deallocated chunks, not yet cleaned.  Not available.
+ *
+ *   - Rinsing.  Formerly dirty chunks that are currently being asynchronously
+ *     cleaned.  Not available, but will be shortly.  Dynamic variable
+ *     allocation may not spin or block for availability, however.
+ *
+ *   - Clean.  Clean chunks, ready for allocation -- but not on the free list.
+ *
+ *   - Free.  Available for allocation.
+ *
+ * Moreover, to avoid absurd contention, _each_ of these lists is implemented
+ * on a per-CPU basis.  This is only for performance, not correctness; chunks
+ * may be allocated from another CPU's free list.  The algorithm for allocation
+ * then is this:
+ *
+ *   (1)  Attempt to atomically allocate from current CPU's free list.  If list
+ *        is non-empty and allocation is successful, allocation is complete.
+ *
+ *   (2)  If the clean list is non-empty, atomically move it to the free list,
+ *        and reattempt (1).
+ *
+ *   (3)  If the dynamic variable space is in the CLEAN state, look for free
+ *        and clean lists on other CPUs by setting the current CPU to the next
+ *        CPU, and reattempting (1).  If the next CPU is the current CPU (that
+ *        is, if all CPUs have been checked), atomically switch the state of
+ *        the dynamic variable space based on the following:
+ *
+ *        - If no free chunks were found and no dirty chunks were found,
+ *          atomically set the state to EMPTY.
+ *
+ *        - If dirty chunks were found, atomically set the state to DIRTY.
+ *
+ *        - If rinsing chunks were found, atomically set the state to RINSING.
+ *
+ *   (4)  Based on state of dynamic variable space state, increment appropriate
+ *        counter to indicate dynamic drops (if in EMPTY state) vs. dynamic
+ *        dirty drops (if in DIRTY state) vs. dynamic rinsing drops (if in
+ *        RINSING state).  Fail the allocation.
+ *
+ * The cleaning cyclic operates with the following algorithm:  for all CPUs
+ * with a non-empty dirty list, atomically move the dirty list to the rinsing
+ * list.  Perform a dtrace_sync().  For all CPUs with a non-empty rinsing list,
+ * atomically move the rinsing list to the clean list.  Perform another
+ * dtrace_sync().  By this point, all CPUs have seen the new clean list; the
+ * state of the dynamic variable space can be restored to CLEAN.
+ *
+ * There exist two final races that merit explanation.  The first is a simple
+ * allocation race:
+ *
+ *                 CPU A                                 CPU B
+ *  +---------------------------------+   +---------------------------------+
+ *  |                                 |   |                                 |
+ *  | allocates dynamic object a[123] |   | allocates dynamic object a[123] |
+ *  | by storing the value 345 to it  |   | by storing the value 567 to it  |
+ *  |                                 |   |                                 |
+ *  :                                 :   :                                 :
+ *  .                                 .   .                                 .
+ *
+ * Again, this is a race in the D program.  It can be resolved by having a[123]
+ * hold the value 345 or a[123] hold the value 567 -- but it must be true that
+ * a[123] have only _one_ of these values.  (That is, the racing CPUs may not
+ * put the same element twice on the same hash chain.)  This is resolved
+ * simply:  before the allocation is undertaken, the start of the new chunk's
+ * hash chain is noted.  Later, after the allocation is complete, the hash
+ * chain is atomically switched to point to the new element.  If this fails
+ * (because of either concurrent allocations or an allocation concurrent with a
+ * deletion), the newly allocated chunk is deallocated to the dirty list, and
+ * the whole process of looking up (and potentially allocating) the dynamic
+ * variable is reattempted.
+ *
+ * The final race is a simple deallocation race:
+ *
+ *                 CPU A                                 CPU B
+ *  +---------------------------------+   +---------------------------------+
+ *  |                                 |   |                                 |
+ *  | deallocates dynamic object      |   | deallocates dynamic object      |
+ *  | a[123] by storing the value 0   |   | a[123] by storing the value 0   |
+ *  | to it                           |   | to it                           |
+ *  |                                 |   |                                 |
+ *  :                                 :   :                                 :
+ *  .                                 .   .                                 .
+ *
+ * Once again, this is a race in the D program, but it is one that we must
+ * handle without corrupting the underlying data structures.  Because
+ * deallocations require the deletion of a chunk from the middle of a hash
+ * chain, we cannot use a single-word atomic operation to remove it.  For this,
+ * we add a spin lock to the hash buckets that is _only_ used for deallocations
+ * (allocation races are handled as above).  Further, this spin lock is _only_
+ * held for the duration of the delete; before control is returned to the DIF
+ * emulation code, the hash bucket is unlocked.
+ */
+typedef struct dtrace_key {
+	uint64_t dttk_value;			/* data value or data pointer */
+	uint64_t dttk_size;			/* 0 if by-val, >0 if by-ref */
+} dtrace_key_t;
+
+typedef struct dtrace_tuple {
+	uint32_t dtt_nkeys;			/* number of keys in tuple */
+	uint32_t dtt_pad;			/* padding */
+	dtrace_key_t dtt_key[1];		/* array of tuple keys */
+} dtrace_tuple_t;
+
+typedef struct dtrace_dynvar {
+	uint64_t dtdv_hashval;			/* hash value -- 0 if free */
+	struct dtrace_dynvar *dtdv_next;	/* next on list or hash chain */
+	void *dtdv_data;			/* pointer to data */
+	dtrace_tuple_t dtdv_tuple;		/* tuple key */
+} dtrace_dynvar_t;
+
+typedef enum dtrace_dynvar_op {
+	DTRACE_DYNVAR_ALLOC,
+	DTRACE_DYNVAR_NOALLOC,
+	DTRACE_DYNVAR_DEALLOC
+} dtrace_dynvar_op_t;
+
+typedef struct dtrace_dynhash {
+	dtrace_dynvar_t *dtdh_chain;		/* hash chain for this bucket */
+	uintptr_t dtdh_lock;			/* deallocation lock */
+#ifdef _LP64
+	uintptr_t dtdh_pad[6];			/* pad to avoid false sharing */
+#else
+	uintptr_t dtdh_pad[14];			/* pad to avoid false sharing */
+#endif
+} dtrace_dynhash_t;
+
+typedef struct dtrace_dstate_percpu {
+	dtrace_dynvar_t *dtdsc_free;		/* free list for this CPU */
+	dtrace_dynvar_t *dtdsc_dirty;		/* dirty list for this CPU */
+	dtrace_dynvar_t *dtdsc_rinsing;		/* rinsing list for this CPU */
+	dtrace_dynvar_t *dtdsc_clean;		/* clean list for this CPU */
+	uint64_t dtdsc_drops;			/* number of capacity drops */
+	uint64_t dtdsc_dirty_drops;		/* number of dirty drops */
+	uint64_t dtdsc_rinsing_drops;		/* number of rinsing drops */
+#ifdef _LP64
+	uint64_t dtdsc_pad;			/* pad to avoid false sharing */
+#else
+	uint64_t dtdsc_pad[2];			/* pad to avoid false sharing */
+#endif
+} dtrace_dstate_percpu_t;
+
+typedef enum dtrace_dstate_state {
+	DTRACE_DSTATE_CLEAN = 0,
+	DTRACE_DSTATE_EMPTY,
+	DTRACE_DSTATE_DIRTY,
+	DTRACE_DSTATE_RINSING
+} dtrace_dstate_state_t;
+
+typedef struct dtrace_dstate {
+	void *dtds_base;			/* base of dynamic var. space */
+	size_t dtds_size;			/* size of dynamic var. space */
+	size_t dtds_hashsize;			/* number of buckets in hash */
+	size_t dtds_chunksize;			/* size of each chunk */
+	dtrace_dynhash_t *dtds_hash;		/* pointer to hash table */
+	dtrace_dstate_state_t dtds_state;	/* current dynamic var. state */
+	dtrace_dstate_percpu_t *dtds_percpu;	/* per-CPU dyn. var. state */
+} dtrace_dstate_t;
+
+/*
+ * DTrace Variable State
+ *
+ * The DTrace variable state tracks user-defined variables in its dtrace_vstate
+ * structure.  Each DTrace consumer has exactly one dtrace_vstate structure,
+ * but some dtrace_vstate structures may exist without a corresponding DTrace
+ * consumer (see "DTrace Helpers", below).  As described in <sys/dtrace.h>,
+ * user-defined variables can have one of three scopes:
+ *
+ *  DIFV_SCOPE_GLOBAL  =>  global scope
+ *  DIFV_SCOPE_THREAD  =>  thread-local scope (i.e. "self->" variables)
+ *  DIFV_SCOPE_LOCAL   =>  clause-local scope (i.e. "this->" variables)
+ *
+ * The variable state tracks variables by both their scope and their allocation
+ * type:
+ *
+ *  - The dtvs_globals and dtvs_locals members each point to an array of
+ *    dtrace_statvar structures.  These structures contain both the variable
+ *    metadata (dtrace_difv structures) and the underlying storage for all
+ *    statically allocated variables, including statically allocated
+ *    DIFV_SCOPE_GLOBAL variables and all DIFV_SCOPE_LOCAL variables.
+ *
+ *  - The dtvs_tlocals member points to an array of dtrace_difv structures for
+ *    DIFV_SCOPE_THREAD variables.  As such, this array tracks _only_ the
+ *    variable metadata for DIFV_SCOPE_THREAD variables; the underlying storage
+ *    is allocated out of the dynamic variable space.
+ *
+ *  - The dtvs_dynvars member is the dynamic variable state associated with the
+ *    variable state.  The dynamic variable state (described in "DTrace Dynamic
+ *    Variables", above) tracks all DIFV_SCOPE_THREAD variables and all
+ *    dynamically-allocated DIFV_SCOPE_GLOBAL variables.
+ */
+typedef struct dtrace_statvar {
+	uint64_t dtsv_data;			/* data or pointer to it */
+	size_t dtsv_size;			/* size of pointed-to data */
+	int dtsv_refcnt;			/* reference count */
+	dtrace_difv_t dtsv_var;			/* variable metadata */
+} dtrace_statvar_t;
+
+typedef struct dtrace_vstate {
+	dtrace_state_t *dtvs_state;		/* back pointer to state */
+	dtrace_statvar_t **dtvs_globals;	/* statically-allocated glbls */
+	int dtvs_nglobals;			/* number of globals */
+	dtrace_difv_t *dtvs_tlocals;		/* thread-local metadata */
+	int dtvs_ntlocals;			/* number of thread-locals */
+	dtrace_statvar_t **dtvs_locals;		/* clause-local data */
+	int dtvs_nlocals;			/* number of clause-locals */
+	dtrace_dstate_t dtvs_dynvars;		/* dynamic variable state */
+} dtrace_vstate_t;
+
+/*
+ * DTrace Machine State
+ *
+ * In the process of processing a fired probe, DTrace needs to track and/or
+ * cache some per-CPU state associated with that particular firing.  This is
+ * state that is always discarded after the probe firing has completed, and
+ * much of it is not specific to any DTrace consumer, remaining valid across
+ * all ECBs.  This state is tracked in the dtrace_mstate structure.
+ */
+#define	DTRACE_MSTATE_ARGS		0x00000001
+#define	DTRACE_MSTATE_PROBE		0x00000002
+#define	DTRACE_MSTATE_EPID		0x00000004
+#define	DTRACE_MSTATE_TIMESTAMP		0x00000008
+#define	DTRACE_MSTATE_STACKDEPTH	0x00000010
+#define	DTRACE_MSTATE_CALLER		0x00000020
+#define	DTRACE_MSTATE_IPL		0x00000040
+#define	DTRACE_MSTATE_FLTOFFS		0x00000080
+#define	DTRACE_MSTATE_WALLTIMESTAMP	0x00000100
+#define	DTRACE_MSTATE_USTACKDEPTH	0x00000200
+#define	DTRACE_MSTATE_UCALLER		0x00000400
+#define	DTRACE_MSTATE_MACHTIMESTAMP	0x00000800
+
+typedef struct dtrace_mstate {
+	uintptr_t dtms_scratch_base;		/* base of scratch space */
+	uintptr_t dtms_scratch_ptr;		/* current scratch pointer */
+	size_t dtms_scratch_size;		/* scratch size */
+	uint32_t dtms_present;			/* variables that are present */
+	uint64_t dtms_arg[5];			/* cached arguments */
+	dtrace_epid_t dtms_epid;		/* current EPID */
+	uint64_t dtms_timestamp;		/* cached timestamp */
+	hrtime_t dtms_walltimestamp;		/* cached wall timestamp */
+	uint64_t dtms_machtimestamp;		/* cached mach absolute timestamp */
+	int dtms_stackdepth;			/* cached stackdepth */
+	int dtms_ustackdepth;			/* cached ustackdepth */
+	struct dtrace_probe *dtms_probe;	/* current probe */
+	uintptr_t dtms_caller;			/* cached caller */
+	uint64_t dtms_ucaller;			/* cached user-level caller */
+	int dtms_ipl;				/* cached interrupt pri lev */
+	int dtms_fltoffs;			/* faulting DIFO offset */
+	uintptr_t dtms_strtok;			/* saved strtok() pointer */
+	uint32_t dtms_access;			/* memory access rights */
+	dtrace_difo_t *dtms_difo;		/* current dif object */
+} dtrace_mstate_t;
+
+#define	DTRACE_COND_OWNER	0x1
+#define	DTRACE_COND_USERMODE	0x2
+#define	DTRACE_COND_ZONEOWNER	0x4
+
+#define	DTRACE_PROBEKEY_MAXDEPTH	8	/* max glob recursion depth */
+
+/*
+ * Access flag used by dtrace_mstate.dtms_access.
+ */
+#define	DTRACE_ACCESS_KERNEL	0x1		/* the priv to read kmem */
+
+
+/*
+ * DTrace Activity
+ *
+ * Each DTrace consumer is in one of several states, which (for purposes of
+ * avoiding yet-another overloading of the noun "state") we call the current
+ * _activity_.  The activity transitions on dtrace_go() (from DTRACIOCGO), on
+ * dtrace_stop() (from DTRACIOCSTOP) and on the exit() action.  Activities may
+ * only transition in one direction; the activity transition diagram is a
+ * directed acyclic graph.  The activity transition diagram is as follows:
+ *
+ *
+ * +----------+                   +--------+                   +--------+
+ * | INACTIVE |------------------>| WARMUP |------------------>| ACTIVE |
+ * +----------+   dtrace_go(),    +--------+   dtrace_go(),    +--------+
+ *                before BEGIN        |        after BEGIN       |  |  |
+ *                                    |                          |  |  |
+ *                      exit() action |                          |  |  |
+ *                     from BEGIN ECB |                          |  |  |
+ *                                    |                          |  |  |
+ *                                    v                          |  |  |
+ *                               +----------+     exit() action  |  |  |
+ * +-----------------------------| DRAINING |<-------------------+  |  |
+ * |                             +----------+                       |  |
+ * |                                  |                             |  |
+ * |                   dtrace_stop(), |                             |  |
+ * |                     before END   |                             |  |
+ * |                                  |                             |  |
+ * |                                  v                             |  |
+ * | +---------+                 +----------+                       |  |
+ * | | STOPPED |<----------------| COOLDOWN |<----------------------+  |
+ * | +---------+  dtrace_stop(), +----------+     dtrace_stop(),       |
+ * |                after END                       before END         |
+ * |                                                                   |
+ * |                              +--------+                           |
+ * +----------------------------->| KILLED |<--------------------------+
+ *       deadman timeout or       +--------+     deadman timeout or
+ *        killed consumer                         killed consumer
+ *
+ * Note that once a DTrace consumer has stopped tracing, there is no way to
+ * restart it; if a DTrace consumer wishes to restart tracing, it must reopen
+ * the DTrace pseudodevice.
+ */
+typedef enum dtrace_activity {
+	DTRACE_ACTIVITY_INACTIVE = 0,		/* not yet running */
+	DTRACE_ACTIVITY_WARMUP,			/* while starting */
+	DTRACE_ACTIVITY_ACTIVE,			/* running */
+	DTRACE_ACTIVITY_DRAINING,		/* before stopping */
+	DTRACE_ACTIVITY_COOLDOWN,		/* while stopping */
+	DTRACE_ACTIVITY_STOPPED,		/* after stopping */
+	DTRACE_ACTIVITY_KILLED			/* killed */
+} dtrace_activity_t;
+
+
+/*
+ * APPLE NOTE:  DTrace dof modes implementation
+ *
+ * DTrace has four "dof modes". They are:
+ *
+ * DTRACE_DOF_MODE_NEVER	Never load any dof, period.
+ * DTRACE_DOF_MODE_LAZY_ON	Defer loading dof until later
+ * DTRACE_DOF_MODE_LAZY_OFF	Load all deferred dof now, and any new dof 
+ * DTRACE_DOF_MODE_NON_LAZY	Load all dof immediately.
+ *
+ * It is legal to transition between the two lazy modes. The NEVER and
+ * NON_LAZY modes are permanent, and must not change once set.
+ *
+ * The current dof mode is kept in dtrace_dof_mode, which is protected by the
+ * dtrace_dof_mode_lock. This is a RW lock, reads require shared access, writes
+ * require exclusive access. Because NEVER and NON_LAZY are permanent states,
+ * it is legal to test for those modes without holding the dof mode lock.
+ *
+ * Lock ordering is dof mode lock before any dtrace lock, and before the
+ * process p_dtrace_sprlock. In general, other locks should not be held when
+ * taking the dof mode lock. Acquiring the dof mode lock in exclusive mode
+ * will block process fork, exec, and exit, so it should be held exclusive
+ * for as short a time as possible.
+ */
+
+#define DTRACE_DOF_MODE_NEVER 		0
+#define DTRACE_DOF_MODE_LAZY_ON		1
+#define DTRACE_DOF_MODE_LAZY_OFF	2
+#define DTRACE_DOF_MODE_NON_LAZY	3
+
+/*
+ * dtrace kernel symbol modes are used to control when the kernel may dispose of
+ * symbol information used by the fbt/sdt provider. The kernel itself, as well as
+ * every kext, has symbol table/nlist info that has historically been preserved
+ * for dtrace's use. This allowed dtrace to be lazy about allocating fbt/sdt probes,
+ * at the expense of keeping the symbol info in the kernel permanently.
+ *
+ * Starting in 10.7+, fbt probes may be created from userspace, in the same
+ * fashion as pid probes. The kernel allows dtrace "first right of refusal"
+ * whenever symbol data becomes available (such as a kext load). If dtrace is
+ * active, it will immediately read/copy the needed data, and then the kernel
+ * may free it. If dtrace is not active, it returns immediately, having done
+ * no work or allocations, and the symbol data is freed. Should dtrace need
+ * this data later, it is expected that the userspace client will push the
+ * data into the kernel via ioctl calls.
+ *
+ * The kernel symbol modes are used to control what dtrace does with symbol data:
+ *
+ * DTRACE_KERNEL_SYMBOLS_NEVER			Effectively disables fbt/sdt
+ * DTRACE_KERNEL_SYMBOLS_FROM_KERNEL		Immediately read/copy symbol data
+ * DTRACE_KERNEL_SYMBOLS_FROM_USERSPACE		Wait for symbols from userspace
+ * DTRACE_KERNEL_SYMBOLS_ALWAYS_FROM_KERNEL	Immediately read/copy symbol data
+ *
+ * It is legal to transition between DTRACE_KERNEL_SYMBOLS_FROM_KERNEL and 
+ * DTRACE_KERNEL_SYMBOLS_FROM_USERSPACE. The DTRACE_KERNEL_SYMBOLS_NEVER and
+ * DTRACE_KERNEL_SYMBOLS_ALWAYS_FROM_KERNEL are permanent modes, intended to
+ * disable fbt probes entirely, or prevent any symbols being loaded from
+ * userspace.
+*
+ * The kernel symbol mode is kept in dtrace_kernel_symbol_mode, which is protected
+ * by the dtrace_lock.
+ */
+
+#define DTRACE_KERNEL_SYMBOLS_NEVER 			0
+#define DTRACE_KERNEL_SYMBOLS_FROM_KERNEL		1
+#define DTRACE_KERNEL_SYMBOLS_FROM_USERSPACE		2
+#define DTRACE_KERNEL_SYMBOLS_ALWAYS_FROM_KERNEL	3
+	
+
+/*
+ * DTrace Helper Implementation
+ *
+ * A description of the helper architecture may be found in <sys/dtrace.h>.
+ * Each process contains a pointer to its helpers in its p_dtrace_helpers
+ * member.  This is a pointer to a dtrace_helpers structure, which contains an
+ * array of pointers to dtrace_helper structures, helper variable state (shared
+ * among a process's helpers) and a generation count.  (The generation count is
+ * used to provide an identifier when a helper is added so that it may be
+ * subsequently removed.)  The dtrace_helper structure is self-explanatory,
+ * containing pointers to the objects needed to execute the helper.  Note that
+ * helpers are _duplicated_ across fork(2), and destroyed on exec(2).  No more
+ * than dtrace_helpers_max are allowed per-process.
+ */
+#define	DTRACE_HELPER_ACTION_USTACK	0
+#define	DTRACE_NHELPER_ACTIONS		1
+
+typedef struct dtrace_helper_action {
+	int dtha_generation;			/* helper action generation */
+	int dtha_nactions;			/* number of actions */
+	dtrace_difo_t *dtha_predicate;		/* helper action predicate */
+	dtrace_difo_t **dtha_actions;		/* array of actions */
+	struct dtrace_helper_action *dtha_next;	/* next helper action */
+} dtrace_helper_action_t;
+
+typedef struct dtrace_helper_provider {
+	int dthp_generation;			/* helper provider generation */
+	uint32_t dthp_ref;			/* reference count */
+	dof_helper_t dthp_prov;			/* DOF w/ provider and probes */
+} dtrace_helper_provider_t;
+
+typedef struct dtrace_helpers {
+	dtrace_helper_action_t **dthps_actions;	/* array of helper actions */
+	dtrace_vstate_t dthps_vstate;		/* helper action var. state */
+	dtrace_helper_provider_t **dthps_provs;	/* array of providers */
+	uint_t dthps_nprovs;			/* count of providers */
+	uint_t dthps_maxprovs;			/* provider array size */
+	int dthps_generation;			/* current generation */
+	pid_t dthps_pid;			/* pid of associated proc */
+	int dthps_deferred;			/* helper in deferred list */
+	struct dtrace_helpers *dthps_next;	/* next pointer */
+	struct dtrace_helpers *dthps_prev;	/* prev pointer */
+} dtrace_helpers_t;
+
+/*
+ * DTrace Helper Action Tracing
+ *
+ * Debugging helper actions can be arduous.  To ease the development and
+ * debugging of helpers, DTrace contains a tracing-framework-within-a-tracing-
+ * framework: helper tracing.  If dtrace_helptrace_enabled is non-zero (which
+ * it is by default on DEBUG kernels), all helper activity will be traced to a
+ * global, in-kernel ring buffer.  Each entry includes a pointer to the specific
+ * helper, the location within the helper, and a trace of all local variables.
+ * The ring buffer may be displayed in a human-readable format with the
+ * ::dtrace_helptrace mdb(1) dcmd.
+ */
+#define	DTRACE_HELPTRACE_NEXT	(-1)
+#define	DTRACE_HELPTRACE_DONE	(-2)
+#define	DTRACE_HELPTRACE_ERR	(-3)
+
+typedef struct dtrace_helptrace {
+	dtrace_helper_action_t	*dtht_helper;	/* helper action */
+	int dtht_where;				/* where in helper action */
+	int dtht_nlocals;			/* number of locals */
+	int dtht_fault;				/* type of fault (if any) */
+	int dtht_fltoffs;			/* DIF offset */
+	uint64_t dtht_illval;			/* faulting value */
+	uint64_t dtht_locals[1];		/* local variables */
+} dtrace_helptrace_t;
+
+/*
+ * DTrace Credentials
+ *
+ * In probe context, we have limited flexibility to examine the credentials
+ * of the DTrace consumer that created a particular enabling.  We use
+ * the Least Privilege interfaces to cache the consumer's cred pointer and
+ * some facts about that credential in a dtrace_cred_t structure. These
+ * can limit the consumer's breadth of visibility and what actions the
+ * consumer may take.
+ */
+#define	DTRACE_CRV_ALLPROC		0x01
+#define	DTRACE_CRV_KERNEL		0x02
+#define	DTRACE_CRV_ALLZONE		0x04
+
+#define	DTRACE_CRV_ALL		(DTRACE_CRV_ALLPROC | DTRACE_CRV_KERNEL | \
+	DTRACE_CRV_ALLZONE)
+
+#define	DTRACE_CRA_PROC				0x0001
+#define	DTRACE_CRA_PROC_CONTROL			0x0002
+#define	DTRACE_CRA_PROC_DESTRUCTIVE_ALLUSER	0x0004
+#define	DTRACE_CRA_PROC_DESTRUCTIVE_ALLZONE	0x0008
+#define	DTRACE_CRA_PROC_DESTRUCTIVE_CREDCHG	0x0010
+#define	DTRACE_CRA_KERNEL			0x0020
+#define	DTRACE_CRA_KERNEL_DESTRUCTIVE		0x0040
+
+#define	DTRACE_CRA_ALL		(DTRACE_CRA_PROC | \
+	DTRACE_CRA_PROC_CONTROL | \
+	DTRACE_CRA_PROC_DESTRUCTIVE_ALLUSER | \
+	DTRACE_CRA_PROC_DESTRUCTIVE_ALLZONE | \
+	DTRACE_CRA_PROC_DESTRUCTIVE_CREDCHG | \
+	DTRACE_CRA_KERNEL | \
+	DTRACE_CRA_KERNEL_DESTRUCTIVE)
+
+typedef struct dtrace_cred {
+	cred_t			*dcr_cred;
+	uint8_t			dcr_destructive;
+	uint8_t			dcr_visible;
+	uint16_t		dcr_action;
+} dtrace_cred_t;
+
+/*
+ * DTrace Consumer State
+ *
+ * Each DTrace consumer has an associated dtrace_state structure that contains
+ * its in-kernel DTrace state -- including options, credentials, statistics and
+ * pointers to ECBs, buffers, speculations and formats.  A dtrace_state
+ * structure is also allocated for anonymous enablings.  When anonymous state
+ * is grabbed, the grabbing consumers dts_anon pointer is set to the grabbed
+ * dtrace_state structure.
+ */
+struct dtrace_state {
+	dev_t dts_dev;				/* device */
+	int dts_necbs;				/* total number of ECBs */
+	dtrace_ecb_t **dts_ecbs;		/* array of ECBs */
+	dtrace_epid_t dts_epid;			/* next EPID to allocate */
+	size_t dts_needed;			/* greatest needed space */
+	struct dtrace_state *dts_anon;		/* anon. state, if grabbed */
+	dtrace_activity_t dts_activity;		/* current activity */
+	dtrace_vstate_t dts_vstate;		/* variable state */
+	dtrace_buffer_t *dts_buffer;		/* principal buffer */
+	dtrace_buffer_t *dts_aggbuffer;		/* aggregation buffer */
+	dtrace_speculation_t *dts_speculations;	/* speculation array */
+	int dts_nspeculations;			/* number of speculations */
+	int dts_naggregations;			/* number of aggregations */
+	dtrace_aggregation_t **dts_aggregations; /* aggregation array */
+	vmem_t *dts_aggid_arena;		/* arena for aggregation IDs */
+	uint64_t dts_errors;			/* total number of errors */
+	uint32_t dts_speculations_busy;		/* number of spec. busy */
+	uint32_t dts_speculations_unavail;	/* number of spec unavail */
+	uint32_t dts_stkstroverflows;		/* stack string tab overflows */
+	uint32_t dts_dblerrors;			/* errors in ERROR probes */
+	uint32_t dts_reserve;			/* space reserved for END */
+	hrtime_t dts_laststatus;		/* time of last status */
+	cyclic_id_t dts_cleaner;		/* cleaning cyclic */
+	cyclic_id_t dts_deadman;		/* deadman cyclic */
+	hrtime_t dts_alive;			/* time last alive */
+	char dts_speculates;			/* boolean: has speculations */
+	char dts_destructive;			/* boolean: has dest. actions */
+	int dts_nformats;			/* number of formats */
+	char **dts_formats;			/* format string array */
+	dtrace_optval_t dts_options[DTRACEOPT_MAX]; /* options */
+	dtrace_cred_t dts_cred;			/* credentials */
+	size_t dts_nretained;			/* number of retained enabs */
+	uint64_t dts_arg_error_illval;
+};
+
+struct dtrace_provider {
+	dtrace_pattr_t dtpv_attr;		/* provider attributes */
+	dtrace_ppriv_t dtpv_priv;		/* provider privileges */
+	dtrace_pops_t dtpv_pops;		/* provider operations */
+	char *dtpv_name;			/* provider name */
+	void *dtpv_arg;				/* provider argument */
+	uint_t dtpv_defunct;			/* boolean: defunct provider */
+	struct dtrace_provider *dtpv_next;	/* next provider */
+	uint64_t dtpv_probe_count;		/* number of associated probes */
+	uint64_t dtpv_ecb_count;		/* number of associated enabled ECBs */
+};
+
+struct dtrace_meta {
+	dtrace_mops_t dtm_mops;			/* meta provider operations */
+	char *dtm_name;				/* meta provider name */
+	void *dtm_arg;				/* meta provider user arg */
+	uint64_t dtm_count;			/* number of associated providers */
+};
+
+/*
+ * DTrace Enablings
+ *
+ * A dtrace_enabling structure is used to track a collection of ECB
+ * descriptions -- before they have been turned into actual ECBs.  This is
+ * created as a result of DOF processing, and is generally used to generate
+ * ECBs immediately thereafter.  However, enablings are also generally
+ * retained should the probes they describe be created at a later time; as
+ * each new module or provider registers with the framework, the retained
+ * enablings are reevaluated, with any new match resulting in new ECBs.  To
+ * prevent probes from being matched more than once, the enabling tracks the
+ * last probe generation matched, and only matches probes from subsequent
+ * generations.
+ */
+typedef struct dtrace_enabling {
+	dtrace_ecbdesc_t **dten_desc;		/* all ECB descriptions */
+	int dten_ndesc;				/* number of ECB descriptions */
+	int dten_maxdesc;			/* size of ECB array */
+	dtrace_vstate_t *dten_vstate;		/* associated variable state */
+	dtrace_genid_t dten_probegen;		/* matched probe generation */
+	dtrace_ecbdesc_t *dten_current;		/* current ECB description */
+	int dten_error;				/* current error value */
+	int dten_primed;			/* boolean: set if primed */
+	struct dtrace_enabling *dten_prev;	/* previous enabling */
+	struct dtrace_enabling *dten_next;	/* next enabling */
+} dtrace_enabling_t;
+
+/*
+ * DTrace Anonymous Enablings
+ *
+ * Anonymous enablings are DTrace enablings that are not associated with a
+ * controlling process, but rather derive their enabling from DOF stored as
+ * properties in the dtrace.conf file.  If there is an anonymous enabling, a
+ * DTrace consumer state and enabling are created on attach.  The state may be
+ * subsequently grabbed by the first consumer specifying the "grabanon"
+ * option.  As long as an anonymous DTrace enabling exists, dtrace(7D) will
+ * refuse to unload.
+ */
+typedef struct dtrace_anon {
+	dtrace_state_t *dta_state;		/* DTrace consumer state */
+	dtrace_enabling_t *dta_enabling;	/* pointer to enabling */
+	processorid_t dta_beganon;		/* which CPU BEGIN ran on */
+} dtrace_anon_t;
+
+/*
+ * DTrace Error Debugging
+ */
+#if DEBUG
+#define	DTRACE_ERRDEBUG
+#endif
+
+#ifdef DTRACE_ERRDEBUG
+
+typedef struct dtrace_errhash {
+	const char	*dter_msg;	/* error message */
+	int		dter_count;	/* number of times seen */
+} dtrace_errhash_t;
+
+#define	DTRACE_ERRHASHSZ	256	/* must be > number of err msgs */
+
+#endif	/* DTRACE_ERRDEBUG */
+
+/*
+ * DTrace Toxic Ranges
+ *
+ * DTrace supports safe loads from probe context; if the address turns out to
+ * be invalid, a bit will be set by the kernel indicating that DTrace
+ * encountered a memory error, and DTrace will propagate the error to the user
+ * accordingly.  However, there may exist some regions of memory in which an
+ * arbitrary load can change system state, and from which it is impossible to
+ * recover from such a load after it has been attempted.  Examples of this may
+ * include memory in which programmable I/O registers are mapped (for which a
+ * read may have some implications for the device) or (in the specific case of
+ * UltraSPARC-I and -II) the virtual address hole.  The platform is required
+ * to make DTrace aware of these toxic ranges; DTrace will then check that
+ * target addresses are not in a toxic range before attempting to issue a
+ * safe load.
+ */
+typedef struct dtrace_toxrange {
+	uintptr_t	dtt_base;		/* base of toxic range */
+	uintptr_t	dtt_limit;		/* limit of toxic range */
+} dtrace_toxrange_t;
+
+extern uint64_t dtrace_getarg(int, int);
+extern int dtrace_getipl(void);
+extern uintptr_t dtrace_caller(int);
+extern uint32_t dtrace_cas32(uint32_t *, uint32_t, uint32_t);
+extern void *dtrace_casptr(void *, void *, void *);
+extern void dtrace_copyin(user_addr_t, uintptr_t, size_t, volatile uint16_t *);
+extern void dtrace_copyinstr(user_addr_t, uintptr_t, size_t, volatile uint16_t *);
+extern void dtrace_copyout(uintptr_t, user_addr_t, size_t, volatile uint16_t *);
+extern void dtrace_copyoutstr(uintptr_t, user_addr_t, size_t, volatile uint16_t *);
+extern void dtrace_getpcstack(pc_t *, int, int, uint32_t *);
+extern uint64_t dtrace_getreg(struct regs *, uint_t);
+extern int dtrace_getstackdepth(int);
+extern void dtrace_getupcstack(uint64_t *, int);
+extern void dtrace_getufpstack(uint64_t *, uint64_t *, int);
+extern int dtrace_getustackdepth(void);
+extern uintptr_t dtrace_fulword(void *);
+extern uint8_t dtrace_fuword8(user_addr_t);
+extern uint16_t dtrace_fuword16(user_addr_t);
+extern uint32_t dtrace_fuword32(user_addr_t);
+extern uint64_t dtrace_fuword64(user_addr_t);
+extern int dtrace_proc_waitfor(dtrace_procdesc_t*);
+extern void dtrace_probe_error(dtrace_state_t *, dtrace_epid_t, int, int,
+    int, uint64_t);
+extern int dtrace_assfail(const char *, const char *, int);
+extern int dtrace_attached(void);
+extern hrtime_t dtrace_gethrestime(void);
+extern void dtrace_isa_init(void);
+
+extern void dtrace_copy(uintptr_t, uintptr_t, size_t);
+extern void dtrace_copystr(uintptr_t, uintptr_t, size_t, volatile uint16_t *);
+
+/*
+ * DTrace restriction checks
+ */
+extern boolean_t dtrace_is_restricted(void);
+extern boolean_t dtrace_can_attach_to_proc(proc_t);
+
+/*
+ * DTrace Assertions
+ *
+ * DTrace calls ASSERT from probe context.  To assure that a failed ASSERT
+ * does not induce a markedly more catastrophic failure (e.g., one from which
+ * a dump cannot be gleaned), DTrace must define its own ASSERT to be one that
+ * may safely be called from probe context.  This header file must thus be
+ * included by any DTrace component that calls ASSERT from probe context, and
+ * _only_ by those components.  (The only exception to this is kernel
+ * debugging infrastructure at user-level that doesn't depend on calling
+ * ASSERT.)
+ */
+#undef ASSERT
+#if DEBUG
+#define	ASSERT(EX)	((void)((EX) || \
+			dtrace_assfail(#EX, __FILE__, __LINE__)))
+#else
+#define	ASSERT(X)	((void)0)
+#endif
+
+#ifdef	__cplusplus
+}
+#endif
+
+#endif /* _SYS_DTRACE_IMPL_H */
+
diff -Nur cctools-877.5/include/sys/errno.h cctools-877.5-AnV/include/sys/errno.h
--- cctools-877.5/include/sys/errno.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/errno.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,266 @@
+/*
+ * Copyright (c) 2000-2012 Apple, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1989, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)errno.h	8.5 (Berkeley) 1/21/94
+ */
+
+#ifndef	_SYS_ERRNO_H_
+#define	_SYS_ERRNO_H_
+
+#include <sys/cdefs.h>
+
+
+#if defined(__STDC_WANT_LIB_EXT1__) && __STDC_WANT_LIB_EXT1__ >= 1
+#include <sys/_types/_errno_t.h>
+#endif
+
+__BEGIN_DECLS
+extern int * __error(void);
+#define errno (*__error())
+__END_DECLS
+
+/*
+ * Error codes
+ */
+
+#define	EPERM		1		/* Operation not permitted */
+#define	ENOENT		2		/* No such file or directory */
+#define	ESRCH		3		/* No such process */
+#define	EINTR		4		/* Interrupted system call */
+#define	EIO		5		/* Input/output error */
+#define	ENXIO		6		/* Device not configured */
+#define	E2BIG		7		/* Argument list too long */
+#define	ENOEXEC		8		/* Exec format error */
+#define	EBADF		9		/* Bad file descriptor */
+#define	ECHILD		10		/* No child processes */
+#define	EDEADLK		11		/* Resource deadlock avoided */
+					/* 11 was EAGAIN */
+#define	ENOMEM		12		/* Cannot allocate memory */
+#define	EACCES		13		/* Permission denied */
+#define	EFAULT		14		/* Bad address */
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define	ENOTBLK		15		/* Block device required */
+#endif
+#define	EBUSY		16		/* Device / Resource busy */
+#define	EEXIST		17		/* File exists */
+#define	EXDEV		18		/* Cross-device link */
+#define	ENODEV		19		/* Operation not supported by device */
+#define	ENOTDIR		20		/* Not a directory */
+#define	EISDIR		21		/* Is a directory */
+#define	EINVAL		22		/* Invalid argument */
+#define	ENFILE		23		/* Too many open files in system */
+#define	EMFILE		24		/* Too many open files */
+#define	ENOTTY		25		/* Inappropriate ioctl for device */
+#define	ETXTBSY		26		/* Text file busy */
+#define	EFBIG		27		/* File too large */
+#define	ENOSPC		28		/* No space left on device */
+#define	ESPIPE		29		/* Illegal seek */
+#define	EROFS		30		/* Read-only file system */
+#define	EMLINK		31		/* Too many links */
+#define	EPIPE		32		/* Broken pipe */
+
+/* math software */
+#define	EDOM		33		/* Numerical argument out of domain */
+#define	ERANGE		34		/* Result too large */
+
+/* non-blocking and interrupt i/o */
+#define	EAGAIN		35		/* Resource temporarily unavailable */
+#define	EWOULDBLOCK	EAGAIN		/* Operation would block */
+#define	EINPROGRESS	36		/* Operation now in progress */
+#define	EALREADY	37		/* Operation already in progress */
+
+/* ipc/network software -- argument errors */
+#define	ENOTSOCK	38		/* Socket operation on non-socket */
+#define	EDESTADDRREQ	39		/* Destination address required */
+#define	EMSGSIZE	40		/* Message too long */
+#define	EPROTOTYPE	41		/* Protocol wrong type for socket */
+#define	ENOPROTOOPT	42		/* Protocol not available */
+#define	EPROTONOSUPPORT	43		/* Protocol not supported */
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define	ESOCKTNOSUPPORT	44		/* Socket type not supported */
+#endif
+#define ENOTSUP		45		/* Operation not supported */
+#if !__DARWIN_UNIX03 && !defined(KERNEL)
+/*
+ * This is the same for binary and source copmpatability, unless compiling
+ * the kernel itself, or compiling __DARWIN_UNIX03; if compiling for the
+ * kernel, the correct value will be returned.  If compiling non-POSIX
+ * source, the kernel return value will be converted by a stub in libc, and
+ * if compiling source with __DARWIN_UNIX03, the conversion in libc is not
+ * done, and the caller gets the expected (discrete) value.
+ */
+#define	EOPNOTSUPP	 ENOTSUP	/* Operation not supported on socket */
+#endif /* !__DARWIN_UNIX03 && !KERNEL */
+
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define	EPFNOSUPPORT	46		/* Protocol family not supported */
+#endif
+#define	EAFNOSUPPORT	47		/* Address family not supported by protocol family */
+#define	EADDRINUSE	48		/* Address already in use */
+#define	EADDRNOTAVAIL	49		/* Can't assign requested address */
+
+/* ipc/network software -- operational errors */
+#define	ENETDOWN	50		/* Network is down */
+#define	ENETUNREACH	51		/* Network is unreachable */
+#define	ENETRESET	52		/* Network dropped connection on reset */
+#define	ECONNABORTED	53		/* Software caused connection abort */
+#define	ECONNRESET	54		/* Connection reset by peer */
+#define	ENOBUFS		55		/* No buffer space available */
+#define	EISCONN		56		/* Socket is already connected */
+#define	ENOTCONN	57		/* Socket is not connected */
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define	ESHUTDOWN	58		/* Can't send after socket shutdown */
+#define	ETOOMANYREFS	59		/* Too many references: can't splice */
+#endif
+#define	ETIMEDOUT	60		/* Operation timed out */
+#define	ECONNREFUSED	61		/* Connection refused */
+
+#define	ELOOP		62		/* Too many levels of symbolic links */
+#define	ENAMETOOLONG	63		/* File name too long */
+
+/* should be rearranged */
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define	EHOSTDOWN	64		/* Host is down */
+#endif
+#define	EHOSTUNREACH	65		/* No route to host */
+#define	ENOTEMPTY	66		/* Directory not empty */
+
+/* quotas & mush */
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define	EPROCLIM	67		/* Too many processes */
+#define	EUSERS		68		/* Too many users */
+#endif
+#define	EDQUOT		69		/* Disc quota exceeded */
+
+/* Network File System */
+#define	ESTALE		70		/* Stale NFS file handle */
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define	EREMOTE		71		/* Too many levels of remote in path */
+#define	EBADRPC		72		/* RPC struct is bad */
+#define	ERPCMISMATCH	73		/* RPC version wrong */
+#define	EPROGUNAVAIL	74		/* RPC prog. not avail */
+#define	EPROGMISMATCH	75		/* Program version wrong */
+#define	EPROCUNAVAIL	76		/* Bad procedure for program */
+#endif
+
+#define	ENOLCK		77		/* No locks available */
+#define	ENOSYS		78		/* Function not implemented */
+
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define	EFTYPE		79		/* Inappropriate file type or format */
+#define	EAUTH		80		/* Authentication error */
+#define	ENEEDAUTH	81		/* Need authenticator */
+
+/* Intelligent device errors */
+#define	EPWROFF		82	/* Device power is off */
+#define	EDEVERR		83	/* Device error, e.g. paper out */
+#endif
+
+#define	EOVERFLOW	84		/* Value too large to be stored in data type */
+
+/* Program loading errors */
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define EBADEXEC	85	/* Bad executable */
+#define EBADARCH	86	/* Bad CPU type in executable */
+#define ESHLIBVERS	87	/* Shared library version mismatch */
+#define EBADMACHO	88	/* Malformed Macho file */
+#endif
+
+#define	ECANCELED	89		/* Operation canceled */
+
+#define EIDRM		90		/* Identifier removed */
+#define ENOMSG		91		/* No message of desired type */   
+#define EILSEQ		92		/* Illegal byte sequence */
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define ENOATTR		93		/* Attribute not found */
+#endif
+
+#define EBADMSG		94		/* Bad message */
+#define EMULTIHOP	95		/* Reserved */
+#define	ENODATA		96		/* No message available on STREAM */
+#define ENOLINK		97		/* Reserved */
+#define ENOSR		98		/* No STREAM resources */
+#define ENOSTR		99		/* Not a STREAM */
+#define	EPROTO		100		/* Protocol error */
+#define ETIME		101		/* STREAM ioctl timeout */
+
+#if __DARWIN_UNIX03 || defined(KERNEL)
+/* This value is only discrete when compiling __DARWIN_UNIX03, or KERNEL */
+#define	EOPNOTSUPP	102		/* Operation not supported on socket */
+#endif /* __DARWIN_UNIX03 || KERNEL */
+
+#define ENOPOLICY	103		/* No such policy registered */
+
+#if __DARWIN_C_LEVEL >= 200809L
+#define ENOTRECOVERABLE 104		/* State not recoverable */
+#define EOWNERDEAD      105		/* Previous owner died */
+#endif
+
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define	EQFULL		106		/* Interface output queue is full */
+#define	ELAST		106		/* Must be equal largest errno */
+#endif
+
+#endif /* _SYS_ERRNO_H_ */
diff -Nur cctools-877.5/include/sys/ev.h cctools-877.5-AnV/include/sys/ev.h
--- cctools-877.5/include/sys/ev.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ev.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,81 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1998 Apple Computer, Inc. All rights reserved */
+
+#ifndef _SYS_EV_H_
+#define _SYS_EV_H_
+
+
+#include <sys/appleapiopts.h>
+
+#include <sys/queue.h>
+#include <sys/cdefs.h>
+
+struct eventreq {
+  int      er_type;
+#define EV_FD 1    // file descriptor
+  int      er_handle;
+  void    *er_data;
+  int      er_rcnt;
+  int      er_wcnt;
+  int      er_ecnt;
+  int      er_eventbits;
+#define EV_RE  1
+#define EV_WR  2
+#define EV_EX  4
+#define EV_RM  8
+#define EV_MASK 0xf
+};
+
+typedef struct eventreq *er_t;
+
+#define EV_RBYTES 0x100
+#define EV_WBYTES 0x200
+#define EV_RWBYTES (EV_RBYTES|EV_WBYTES)
+#define EV_RCLOSED 0x400
+#define EV_RCONN   0x800
+#define EV_WCLOSED 0x1000
+#define EV_WCONN   0x2000
+#define EV_OOB     0x4000
+#define EV_FIN     0x8000
+#define EV_RESET   0x10000
+#define EV_TIMEOUT 0x20000
+#define EV_DMASK   0xffffff00
+
+
+
+__BEGIN_DECLS
+int	modwatch(er_t, int);
+int	watchevent(er_t, int);
+int	waitevent(er_t, struct timeval *);
+__END_DECLS
+
+
+
+
+#endif /* _SYS_EV_H_ */
diff -Nur cctools-877.5/include/sys/event.h cctools-877.5-AnV/include/sys/event.h
--- cctools-877.5/include/sys/event.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/event.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,330 @@
+/*
+ * Copyright (c) 2003-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*-
+ * Copyright (c) 1999,2000,2001 Jonathan Lemon <jlemon@FreeBSD.org>
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	$FreeBSD: src/sys/sys/event.h,v 1.5.2.5 2001/12/14 19:21:22 jlemon Exp $
+ */
+
+#ifndef _SYS_EVENT_H_
+#define _SYS_EVENT_H_
+
+#include <machine/types.h>
+#include <sys/cdefs.h>
+#include <stdint.h>
+
+#define EVFILT_READ		(-1)
+#define EVFILT_WRITE		(-2)
+#define EVFILT_AIO		(-3)	/* attached to aio requests */
+#define EVFILT_VNODE		(-4)	/* attached to vnodes */
+#define EVFILT_PROC		(-5)	/* attached to struct proc */
+#define EVFILT_SIGNAL		(-6)	/* attached to struct proc */
+#define EVFILT_TIMER		(-7)	/* timers */
+#define EVFILT_MACHPORT         (-8)	/* Mach portsets */
+#define EVFILT_FS		(-9)	/* Filesystem events */
+#define EVFILT_USER             (-10)   /* User events */
+					/* (-11) unused */
+#define EVFILT_VM		(-12)	/* Virtual memory events */
+
+
+#define EVFILT_SYSCOUNT		14
+#define EVFILT_THREADMARKER	EVFILT_SYSCOUNT /* Internal use only */
+
+#pragma pack(4)
+
+struct kevent {
+	uintptr_t	ident;		/* identifier for this event */
+	int16_t		filter;		/* filter for event */
+	uint16_t	flags;		/* general flags */
+	uint32_t	fflags;		/* filter-specific flags */
+	intptr_t	data;		/* filter-specific data */
+	void		*udata;		/* opaque user data identifier */
+};
+
+
+#pragma pack()
+
+struct kevent64_s {
+	uint64_t	ident;		/* identifier for this event */
+	int16_t		filter;		/* filter for event */
+	uint16_t	flags;		/* general flags */
+	uint32_t	fflags;		/* filter-specific flags */
+	int64_t		data;		/* filter-specific data */
+	uint64_t	udata;		/* opaque user data identifier */
+	uint64_t	ext[2];		/* filter-specific extensions */
+};
+
+#define EV_SET(kevp, a, b, c, d, e, f) do {	\
+	struct kevent *__kevp__ = (kevp);	\
+	__kevp__->ident = (a);			\
+	__kevp__->filter = (b);			\
+	__kevp__->flags = (c);			\
+	__kevp__->fflags = (d);			\
+	__kevp__->data = (e);			\
+	__kevp__->udata = (f);			\
+} while(0)
+
+#define EV_SET64(kevp, a, b, c, d, e, f, g, h) do {	\
+	struct kevent64_s *__kevp__ = (kevp);		\
+	__kevp__->ident = (a);				\
+	__kevp__->filter = (b);				\
+	__kevp__->flags = (c);				\
+	__kevp__->fflags = (d);				\
+	__kevp__->data = (e);				\
+	__kevp__->udata = (f);				\
+	__kevp__->ext[0] = (g);				\
+	__kevp__->ext[1] = (h);				\
+} while(0)
+
+/* actions */
+#define EV_ADD		0x0001		/* add event to kq (implies enable) */
+#define EV_DELETE	0x0002		/* delete event from kq */
+#define EV_ENABLE	0x0004		/* enable event */
+#define EV_DISABLE	0x0008		/* disable event (not reported) */
+#define EV_RECEIPT	0x0040		/* force EV_ERROR on success, data == 0 */
+
+/* flags */
+#define EV_ONESHOT	0x0010		/* only report one occurrence */
+#define EV_CLEAR	0x0020		/* clear event state after reporting */
+#define EV_DISPATCH     0x0080          /* disable event after reporting */
+
+#define EV_SYSFLAGS	0xF000		/* reserved by system */
+#define EV_FLAG0	0x1000		/* filter-specific flag */
+#define EV_FLAG1	0x2000		/* filter-specific flag */
+
+/* returned values */
+#define EV_EOF		0x8000		/* EOF detected */
+#define EV_ERROR	0x4000		/* error, data contains errno */
+
+/*
+ * Filter specific flags for EVFILT_READ
+ *
+ * The default behavior for EVFILT_READ is to make the "read" determination
+ * relative to the current file descriptor read pointer. The EV_POLL
+ * flag indicates the determination should be made via poll(2) semantics
+ * (which always returns true for regular files - regardless of the amount
+ * of unread data in the file).
+ *
+ * On input, EV_OOBAND specifies that only OOB data should be looked for.
+ * The returned data count is the number of bytes beyond the current OOB marker.
+ *
+ * On output, EV_OOBAND indicates that OOB data is present
+ * If it was not specified as an input parameter, then the data count is the
+ * number of bytes before the current OOB marker. If at the marker, the
+ * data count indicates the number of bytes available after it.  In either
+ * case, it's the amount of data one could expect to receive next.
+ */
+#define EV_POLL	EV_FLAG0
+#define EV_OOBAND	EV_FLAG1
+
+/*
+ * data/hint fflags for EVFILT_USER, shared with userspace
+ */
+
+/*
+ * On input, NOTE_TRIGGER causes the event to be triggered for output.
+ */
+#define NOTE_TRIGGER	0x01000000
+
+/*
+ * On input, the top two bits of fflags specifies how the lower twenty four 
+ * bits should be applied to the stored value of fflags.
+ *
+ * On output, the top two bits will always be set to NOTE_FFNOP and the
+ * remaining twenty four bits will contain the stored fflags value.
+ */
+#define NOTE_FFNOP      0x00000000              /* ignore input fflags */
+#define NOTE_FFAND      0x40000000              /* and fflags */
+#define NOTE_FFOR       0x80000000              /* or fflags */
+#define NOTE_FFCOPY     0xc0000000              /* copy fflags */
+#define NOTE_FFCTRLMASK 0xc0000000              /* mask for operations */
+#define NOTE_FFLAGSMASK	0x00ffffff 
+
+/*
+ * data/hint fflags for EVFILT_{READ|WRITE}, shared with userspace
+ *
+ * The default behavior for EVFILT_READ is to make the determination
+ * realtive to the current file descriptor read pointer.
+ */
+#define NOTE_LOWAT	0x00000001		/* low water mark */
+/*
+ * data/hint fflags for EVFILT_VNODE, shared with userspace
+ */
+#define	NOTE_DELETE	0x00000001		/* vnode was removed */
+#define	NOTE_WRITE	0x00000002		/* data contents changed */
+#define	NOTE_EXTEND	0x00000004		/* size increased */
+#define	NOTE_ATTRIB	0x00000008		/* attributes changed */
+#define	NOTE_LINK	0x00000010		/* link count changed */
+#define	NOTE_RENAME	0x00000020		/* vnode was renamed */
+#define	NOTE_REVOKE	0x00000040		/* vnode access was revoked */
+#define NOTE_NONE	0x00000080		/* No specific vnode event: to test for EVFILT_READ activation*/
+
+/*
+ * data/hint fflags for EVFILT_PROC, shared with userspace
+ *
+ * Please note that EVFILT_PROC and EVFILT_SIGNAL share the same knote list
+ * that hangs off the proc structure. They also both play games with the hint
+ * passed to KNOTE(). If NOTE_SIGNAL is passed as a hint, then the lower bits
+ * of the hint contain the signal. IF NOTE_FORK is passed, then the lower bits
+ * contain the PID of the child (but the pid does not get passed through in
+ * the actual kevent).
+ */
+enum {
+	eNoteReapDeprecated __deprecated_enum_msg("This kqueue(2) EVFILT_PROC flag is deprecated") = 0x10000000
+};
+
+#define	NOTE_EXIT		0x80000000	/* process exited */
+#define	NOTE_FORK		0x40000000	/* process forked */
+#define	NOTE_EXEC		0x20000000	/* process exec'd */
+#define	NOTE_REAP		((unsigned int)eNoteReapDeprecated /* 0x10000000 */)	/* process reaped */
+#define	NOTE_SIGNAL		0x08000000	/* shared with EVFILT_SIGNAL */
+#define	NOTE_EXITSTATUS		0x04000000	/* exit status to be returned, valid for child process only */
+#define	NOTE_EXIT_DETAIL	0x02000000	/* provide details on reasons for exit */
+
+#define	NOTE_PDATAMASK	0x000fffff		/* mask for signal & exit status */
+#define	NOTE_PCTRLMASK	(~NOTE_PDATAMASK)
+
+/*
+ * If NOTE_EXITSTATUS is present, provide additional info about exiting process.
+ */
+enum {
+	eNoteExitReparentedDeprecated __deprecated_enum_msg("This kqueue(2) EVFILT_PROC flag is no longer sent") = 0x00080000 
+};
+#define NOTE_EXIT_REPARENTED	((unsigned int)eNoteExitReparentedDeprecated)	/* exited while reparented */
+
+/*
+ * If NOTE_EXIT_DETAIL is present, these bits indicate specific reasons for exiting.
+ */
+#define NOTE_EXIT_DETAIL_MASK		0x00070000
+#define	NOTE_EXIT_DECRYPTFAIL		0x00010000 
+#define	NOTE_EXIT_MEMORY		0x00020000
+#define NOTE_EXIT_CSERROR		0x00040000
+
+
+/*
+ * data/hint fflags for EVFILT_VM, shared with userspace.
+ */
+#define NOTE_VM_PRESSURE			0x80000000              /* will react on memory pressure */
+#define NOTE_VM_PRESSURE_TERMINATE		0x40000000              /* will quit on memory pressure, possibly after cleaning up dirty state */
+#define NOTE_VM_PRESSURE_SUDDEN_TERMINATE	0x20000000		/* will quit immediately on memory pressure */
+#define NOTE_VM_ERROR				0x10000000              /* there was an error */
+
+
+/*
+ * data/hint fflags for EVFILT_TIMER, shared with userspace.
+ * The default is a (repeating) interval timer with the data
+ * specifying the timeout interval in milliseconds.
+ *
+ * All timeouts are implicitly EV_CLEAR events.
+ */
+#define NOTE_SECONDS	0x00000001		/* data is seconds         */
+#define NOTE_USECONDS	0x00000002		/* data is microseconds    */
+#define NOTE_NSECONDS	0x00000004		/* data is nanoseconds     */
+#define NOTE_ABSOLUTE	0x00000008		/* absolute timeout        */
+						/* ... implicit EV_ONESHOT */
+#define NOTE_LEEWAY	0x00000010		/* ext[1] holds leeway for power aware timers */
+#define NOTE_CRITICAL	0x00000020		/* system does minimal timer coalescing */
+#define NOTE_BACKGROUND	0x00000040		/* system does maximum timer coalescing */
+
+/*
+ * data/hint fflags for EVFILT_MACHPORT, shared with userspace.
+ *
+ * Only portsets are supported at this time.
+ *
+ * The fflags field can optionally contain the MACH_RCV_MSG, MACH_RCV_LARGE,
+ * and related trailer receive options as defined in <mach/message.h>.
+ * The presence of these flags directs the kevent64() call to attempt to receive
+ * the message during kevent delivery, rather than just indicate that a message exists.
+ * On setup, The ext[0] field contains the receive buffer pointer and ext[1] contains
+ * the receive buffer length.  Upon event delivery, the actual received message size
+ * is returned in ext[1].  As with mach_msg(), the buffer must be large enough to
+ * receive the message and the requested (or default) message trailers.  In addition,
+ * the fflags field contains the return code normally returned by mach_msg().
+ *
+ * If no message receipt options were provided in the fflags field on setup, no
+ * message is received by this call. Instead, on output, the data field simply
+ * contains the name of the actual port detected with a message waiting.
+ */
+
+/*
+ * DEPRECATED!!!!!!!!!
+ * NOTE_TRACK, NOTE_TRACKERR, and NOTE_CHILD are no longer supported as of 10.5
+ */
+/* additional flags for EVFILT_PROC */
+#define	NOTE_TRACK	0x00000001		/* follow across forks */
+#define	NOTE_TRACKERR	0x00000002		/* could not track child */
+#define	NOTE_CHILD	0x00000004		/* am a child process */
+
+
+
+/* Temporay solution for BootX to use inode.h till kqueue moves to vfs layer */
+#include <sys/queue.h> 
+struct knote;
+SLIST_HEAD(klist, knote);
+
+
+
+struct timespec;
+
+__BEGIN_DECLS
+int     kqueue(void);
+int     kevent(int kq, const struct kevent *changelist, int nchanges,
+		    struct kevent *eventlist, int nevents,
+		    const struct timespec *timeout);
+int     kevent64(int kq, const struct kevent64_s *changelist, 
+		    int nchanges, struct kevent64_s *eventlist, 
+		    int nevents, unsigned int flags, 
+		    const struct timespec *timeout);
+__END_DECLS
+
+
+
+
+#endif /* !_SYS_EVENT_H_ */
diff -Nur cctools-877.5/include/sys/fasttrap.h cctools-877.5-AnV/include/sys/fasttrap.h
--- cctools-877.5/include/sys/fasttrap.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/fasttrap.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,120 @@
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License (the "License").
+ * You may not use this file except in compliance with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+
+/*
+ * Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef	_SYS_FASTTRAP_H
+#define	_SYS_FASTTRAP_H
+
+/* #pragma ident	"@(#)fasttrap.h	1.5	06/03/30 SMI" */
+
+#include <sys/fasttrap_isa.h>
+#include <sys/dtrace.h>
+#include <sys/types.h>
+
+#ifdef	__cplusplus
+extern "C" {
+#endif
+
+#if !defined(__APPLE__)
+#define	FASTTRAPIOC		(('m' << 24) | ('r' << 16) | ('f' << 8))
+#else
+#define	FASTTRAPIOC		_IO('d', 0)
+#endif /* __APPLE__ */
+#define	FASTTRAPIOC_MAKEPROBE	(FASTTRAPIOC | 1)
+#define	FASTTRAPIOC_GETINSTR	(FASTTRAPIOC | 2)
+
+typedef enum fasttrap_probe_type {
+	DTFTP_NONE = 0,
+	DTFTP_ENTRY,
+	DTFTP_RETURN,
+	DTFTP_OFFSETS,
+	DTFTP_POST_OFFSETS,
+	DTFTP_IS_ENABLED
+} fasttrap_probe_type_t;
+
+#if defined(__APPLE__)
+typedef enum fasttrap_provider_type {
+	DTFTP_PROVIDER_NONE = 0,
+	DTFTP_PROVIDER_USDT, 
+	DTFTP_PROVIDER_PID,
+	DTFTP_PROVIDER_OBJC,
+	DTFTP_PROVIDER_ONESHOT
+} fasttrap_provider_type_t;
+
+/* Moved from fasttrap.c */
+#define	FASTTRAP_PID_NAME		"pid"
+#define	FASTTRAP_OBJC_NAME		"objc"
+#define	FASTTRAP_ONESHOT_NAME		"oneshot"
+
+#endif
+
+typedef struct fasttrap_probe_spec {
+	pid_t				ftps_pid;
+#if defined(__APPLE__)
+	fasttrap_provider_type_t	ftps_provider_type;
+	fasttrap_probe_type_t		ftps_probe_type;
+#endif
+	char				ftps_func[DTRACE_FUNCNAMELEN];
+	char				ftps_mod[DTRACE_MODNAMELEN];
+
+#if defined(__APPLE__)
+#if !defined(__LP64__)
+	uint32_t			pad; /* Explicit pad to keep ILP32 and LP64 lined up. */
+#endif
+#endif
+	uint64_t			ftps_pc;
+	uint64_t			ftps_size;
+	uint64_t			ftps_noffs;
+	uint64_t			ftps_offs[1];
+} fasttrap_probe_spec_t;
+
+typedef struct fasttrap_instr_query {
+	uint64_t		ftiq_pc;
+	pid_t			ftiq_pid;
+	fasttrap_instr_t	ftiq_instr;
+} fasttrap_instr_query_t;
+
+/*
+ * To support the fasttrap provider from very early in a process's life,
+ * the run-time linker, ld.so.1, has a program header of type PT_SUNWDTRACE
+ * which points to a data object which must be PT_SUNWDTRACE_SIZE bytes.
+ * This structure mimics the fasttrap provider section of the ulwp_t structure.
+ * When the fasttrap provider is changed to require new or different
+ * instructions, the data object in ld.so.1 and the thread initializers in libc
+ * (libc_init() and _thrp_create()) need to be updated to include the new
+ * instructions, and PT_SUNWDTRACE needs to be changed to a new unique number
+ * (while the old value gets assigned something like PT_SUNWDTRACE_1). Since the
+ * linker must be backward compatible with old Solaris releases, it must have
+ * program headers for each of the PT_SUNWDTRACE versions. The kernel's
+ * elfexec() function only has to look for the latest version of the
+ * PT_SUNWDTRACE program header.
+ */
+#define	PT_SUNWDTRACE_SIZE	FASTTRAP_SUNWDTRACE_SIZE
+
+#ifdef	__cplusplus
+}
+#endif
+
+#endif	/* _SYS_FASTTRAP_H */
diff -Nur cctools-877.5/include/sys/fasttrap_isa.h cctools-877.5-AnV/include/sys/fasttrap_isa.h
--- cctools-877.5/include/sys/fasttrap_isa.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/fasttrap_isa.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,48 @@
+/*
+ * Copyright (c) 2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1989 Carnegie-Mellon University
+ * Copyright (c) 1988 Carnegie-Mellon University
+ * All rights reserved.  The CMU software License Agreement specifies
+ * the terms and conditions for use and redistribution.
+ */
+/*
+ * HISTORY
+ */
+
+#ifndef	_SYS_FASTTRAP_ISA_H_
+#define _SYS_FASTTRAP_ISA_H_
+
+/*
+ * Machine dependent constants
+ */
+
+#include <machine/fasttrap_isa.h>
+
+#endif	/* _SYS_FASTTRAP_ISA_H_ */
diff -Nur cctools-877.5/include/sys/fcntl.h cctools-877.5-AnV/include/sys/fcntl.h
--- cctools-877.5/include/sys/fcntl.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/fcntl.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,495 @@
+/*
+ * Copyright (c) 2000-2013 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1983, 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)fcntl.h	8.3 (Berkeley) 1/21/94
+ */
+
+
+#ifndef _SYS_FCNTL_H_
+#define	_SYS_FCNTL_H_
+
+/*
+ * This file includes the definitions for open and fcntl
+ * described by POSIX for <fcntl.h>; it also includes
+ * related kernel definitions.
+ */
+#include <sys/_types.h>
+#include <sys/cdefs.h>
+#include <Availability.h>
+
+/* We should not be exporting size_t here.  Temporary for gcc bootstrapping. */
+#include <sys/_types/_size_t.h>
+#include <sys/_types/_mode_t.h>
+#include <sys/_types/_off_t.h>
+#include <sys/_types/_pid_t.h>
+
+/*
+ * File status flags: these are used by open(2), fcntl(2).
+ * They are also used (indirectly) in the kernel file structure f_flags,
+ * which is a superset of the open/fcntl flags.  Open flags and f_flags
+ * are inter-convertible using OFLAGS(fflags) and FFLAGS(oflags).
+ * Open/fcntl flags begin with O_; kernel-internal flags begin with F.
+ */
+/* open-only flags */
+#define	O_RDONLY	0x0000		/* open for reading only */
+#define	O_WRONLY	0x0001		/* open for writing only */
+#define	O_RDWR		0x0002		/* open for reading and writing */
+#define	O_ACCMODE	0x0003		/* mask for above modes */
+
+/*
+ * Kernel encoding of open mode; separate read and write bits that are
+ * independently testable: 1 greater than the above.
+ *
+ * XXX
+ * FREAD and FWRITE are excluded from the #ifdef KERNEL so that TIOCFLUSH,
+ * which was documented to use FREAD/FWRITE, continues to work.
+ */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	FREAD		0x0001
+#define	FWRITE		0x0002
+#endif
+#define	O_NONBLOCK	0x0004		/* no delay */
+#define	O_APPEND	0x0008		/* set append mode */
+
+#include <sys/_types/_o_sync.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	O_SHLOCK	0x0010		/* open with shared file lock */
+#define	O_EXLOCK	0x0020		/* open with exclusive file lock */
+#define	O_ASYNC		0x0040		/* signal pgrp when data ready */
+#define	O_FSYNC		O_SYNC		/* source compatibility: do not use */
+#define O_NOFOLLOW  0x0100      /* don't follow symlinks */
+#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+#define	O_CREAT		0x0200		/* create if nonexistant */
+#define	O_TRUNC		0x0400		/* truncate to zero length */
+#define	O_EXCL		0x0800		/* error if already exists */
+
+#if __DARWIN_C_LEVEL >= 200809L 
+/*
+ * Descriptor value for the current working directory
+ */
+#define AT_FDCWD	-2
+
+/*
+ * Flags for the at functions
+ */
+#define AT_EACCESS		0x0010	/* Use effective ids in access check */
+#define AT_SYMLINK_NOFOLLOW	0x0020	/* Act on the symlink itself not the target */
+#define AT_SYMLINK_FOLLOW	0x0040	/* Act on target of symlink */
+#define AT_REMOVEDIR		0x0080	/* Path refers to directory */
+#endif
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	O_EVTONLY	0x8000		/* descriptor requested for event notifications only */
+#endif
+
+
+#define	O_NOCTTY	0x20000		/* don't assign controlling terminal */
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define O_DIRECTORY	0x100000
+#define O_SYMLINK	0x200000	/* allow open of a symlink */
+#endif
+
+#include <sys/_types/_o_dsync.h>
+
+
+#if __DARWIN_C_LEVEL >= 200809L
+#define	O_CLOEXEC	0x1000000	/* implicitly set FD_CLOEXEC */
+#endif
+
+
+
+
+/* Data Protection Flags */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define O_DP_GETRAWENCRYPTED	0x0001
+#endif
+
+
+
+/*
+ * The O_* flags used to have only F* names, which were used in the kernel
+ * and by fcntl.  We retain the F* names for the kernel f_flags field
+ * and for backward compatibility for fcntl.
+ */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	FAPPEND		O_APPEND	/* kernel/compat */
+#define	FASYNC		O_ASYNC		/* kernel/compat */
+#define	FFSYNC		O_FSYNC		/* kernel */
+#define	FFDSYNC		O_DSYNC		/* kernel */
+#define	FNONBLOCK	O_NONBLOCK	/* kernel */
+#define	FNDELAY		O_NONBLOCK	/* compat */
+#define	O_NDELAY	O_NONBLOCK	/* compat */
+#endif
+
+/*
+ * Flags used for copyfile(2)
+ */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define CPF_OVERWRITE 1
+#define CPF_IGNORE_MODE 2
+#define CPF_MASK (CPF_OVERWRITE|CPF_IGNORE_MODE)
+#endif
+
+/*
+ * Constants used for fcntl(2)
+ */
+
+/* command values */
+#define	F_DUPFD		0		/* duplicate file descriptor */
+#define	F_GETFD		1		/* get file descriptor flags */
+#define	F_SETFD		2		/* set file descriptor flags */
+#define	F_GETFL		3		/* get file status flags */
+#define	F_SETFL		4		/* set file status flags */
+#define	F_GETOWN	5		/* get SIGIO/SIGURG proc/pgrp */
+#define F_SETOWN	6		/* set SIGIO/SIGURG proc/pgrp */
+#define	F_GETLK		7		/* get record locking information */
+#define	F_SETLK		8		/* set record locking information */
+#define	F_SETLKW	9		/* F_SETLK; wait if blocked */
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define F_SETLKWTIMEOUT 10		/* F_SETLK; wait if blocked, return on timeout */
+#endif /* __DARWIN_C_LEVEL >= __DARWIN_C_FULL */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define F_FLUSH_DATA    40
+#define F_CHKCLEAN      41              /* Used for regression test */
+#define F_PREALLOCATE   42		/* Preallocate storage */
+#define F_SETSIZE       43		/* Truncate a file without zeroing space */	
+#define F_RDADVISE      44              /* Issue an advisory read async with no copy to user */
+#define F_RDAHEAD       45              /* turn read ahead off/on for this fd */
+/*
+ * 46,47 used to be F_READBOOTSTRAP and F_WRITEBOOTSTRAP 
+ */
+#define F_NOCACHE       48              /* turn data caching off/on for this fd */
+#define F_LOG2PHYS	49		/* file offset to device offset */
+#define F_GETPATH       50              /* return the full path of the fd */
+#define F_FULLFSYNC     51		/* fsync + ask the drive to flush to the media */
+#define F_PATHPKG_CHECK 52              /* find which component (if any) is a package */
+#define F_FREEZE_FS     53              /* "freeze" all fs operations */
+#define F_THAW_FS       54              /* "thaw" all fs operations */
+#define	F_GLOBAL_NOCACHE 55		/* turn data caching off/on (globally) for this file */
+
+
+#define F_ADDSIGS	59		/* add detached signatures */
+
+
+#define F_ADDFILESIGS	61		/* add signature from same file (used by dyld for shared libs) */
+
+#define F_NODIRECT	62		/* used in conjunction with F_NOCACHE to indicate that DIRECT, synchonous writes */
+                                        /* should not be used (i.e. its ok to temporaily create cached pages) */
+
+#define F_GETPROTECTIONCLASS	63		/* Get the protection class of a file from the EA, returns int */
+#define F_SETPROTECTIONCLASS	64		/* Set the protection class of a file for the EA, requires int */
+
+#define F_LOG2PHYS_EXT  65		/* file offset to device offset, extended */
+
+#define	F_GETLKPID		66		/* get record locking information, per-process */
+
+/* See F_DUPFD_CLOEXEC below for 67 */
+
+
+#define F_SETBACKINGSTORE	70	/* Mark the file as being the backing store for another filesystem */
+#define F_GETPATH_MTMINFO	71 	/* return the full path of the FD, but error in specific mtmd circumstances */
+
+#define F_GETCODEDIR		72	/* Returns the code directory, with associated hashes, to the caller */
+
+#define F_SETNOSIGPIPE		73	/* No SIGPIPE generated on EPIPE */
+#define F_GETNOSIGPIPE		74	/* Status of SIGPIPE for this fd */
+
+#define F_TRANSCODEKEY		75 	/* For some cases, we need to rewrap the key for AKS/MKB */
+
+#define F_SINGLE_WRITER		76	/* file being written to a by single writer... if throttling enabled, writes */
+                                        /* may be broken into smaller chunks with throttling in between */
+
+#define F_GETPROTECTIONLEVEL	77	/* Get the protection version number for this filesystem */
+
+#define F_FINDSIGS		78	/* Add detached code signatures (used by dyld for shared libs) */
+
+
+
+// FS-specific fcntl()'s numbers begin at 0x00010000 and go up
+#define FCNTL_FS_SPECIFIC_BASE  0x00010000
+
+#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+
+#if __DARWIN_C_LEVEL >= 200809L
+#define	F_DUPFD_CLOEXEC		67	/* mark the dup with FD_CLOEXEC */
+#endif
+
+/* file descriptor flags (F_GETFD, F_SETFD) */
+#define	FD_CLOEXEC	1		/* close-on-exec flag */
+
+/* record locking flags (F_GETLK, F_SETLK, F_SETLKW) */
+#define	F_RDLCK		1		/* shared or read lock */
+#define	F_UNLCK		2		/* unlock */
+#define	F_WRLCK		3		/* exclusive or write lock */
+
+
+/*
+ * [XSI] The values used for l_whence shall be defined as described
+ * in <unistd.h>
+ */
+#include <sys/_types/_seek_set.h>
+
+/*
+ * [XSI] The symbolic names for file modes for use as values of mode_t
+ * shall be defined as described in <sys/stat.h>
+ */
+#include <sys/_types/_s_ifmt.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/* allocate flags (F_PREALLOCATE) */
+
+#define F_ALLOCATECONTIG  0x00000002    /* allocate contigious space */
+#define F_ALLOCATEALL     0x00000004	/* allocate all requested space or no space at all */
+
+/* Position Modes (fst_posmode) for F_PREALLOCATE */
+
+#define F_PEOFPOSMODE 3			/* Make it past all of the SEEK pos modes so that */
+					/* we can keep them in sync should we desire */	
+#define F_VOLPOSMODE	4		/* specify volume starting postion */
+#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+
+/*
+ * Advisory file segment locking data type -
+ * information passed to system by user
+ */
+struct flock {
+	off_t	l_start;	/* starting offset */
+	off_t	l_len;		/* len = 0 means until end of file */
+	pid_t	l_pid;		/* lock owner */
+	short	l_type;		/* lock type: read/write, etc. */
+	short	l_whence;	/* type of l_start */
+};
+
+#include <sys/_types/_timespec.h>
+
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+/*
+ * Advisory file segment locking with time out -
+ * Information passed to system by user for F_SETLKWTIMEOUT
+ */
+struct flocktimeout {
+	struct flock    fl;             /* flock passed for file locking */
+	struct timespec timeout;        /* timespec struct for timeout */
+};
+#endif /* __DARWIN_C_LEVEL >= __DARWIN_C_FULL */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/*
+ * advisory file read data type -
+ * information passed by user to system
+ */
+
+
+struct radvisory {
+       off_t   ra_offset;
+       int     ra_count;
+};
+
+
+/** Information the user passes in to get the codeblobs out of the kernel */
+typedef struct fcodeblobs {
+	void 		*f_cd_hash;
+	size_t		f_hash_size;
+	void		*f_cd_buffer;
+	size_t		f_cd_size;
+	unsigned int	*f_out_size;
+	int		f_arch;
+	int		__padding;
+} fcodeblobs_t;
+
+
+/*
+ * detached code signatures data type -
+ * information passed by user to system used by F_ADDSIGS and F_ADDFILESIGS.
+ * F_ADDFILESIGS is a shortcut for files that contain their own signature and
+ * doesn't require mapping of the file in order to load the signature.
+ */
+typedef struct fsignatures {
+	off_t		fs_file_start;
+	void		*fs_blob_start;
+	size_t		fs_blob_size;
+} fsignatures_t;
+
+/* lock operations for flock(2) */
+#define	LOCK_SH		0x01		/* shared file lock */
+#define	LOCK_EX		0x02		/* exclusive file lock */
+#define	LOCK_NB		0x04		/* don't block when locking */
+#define	LOCK_UN		0x08		/* unlock file */
+
+/*  fstore_t type used by F_DEALLOCATE and F_PREALLOCATE commands */
+
+typedef struct fstore {
+	unsigned int fst_flags;	/* IN: flags word */
+	int 	fst_posmode;	/* IN: indicates use of offset field */
+	off_t	fst_offset;	/* IN: start of the region */
+	off_t	fst_length;	/* IN: size of the region */
+	off_t   fst_bytesalloc;	/* OUT: number of bytes allocated */
+} fstore_t;
+
+/* fbootstraptransfer_t used by F_READBOOTSTRAP and F_WRITEBOOTSTRAP commands */
+
+typedef struct fbootstraptransfer {
+  off_t fbt_offset;             /* IN: offset to start read/write */
+  size_t fbt_length;          /* IN: number of bytes to transfer */
+  void *fbt_buffer;             /* IN: buffer to be read/written */
+} fbootstraptransfer_t;
+
+
+/*
+ * For F_LOG2PHYS this information is passed back to user
+ * Currently only devoffset is returned - that is the VOP_BMAP
+ * result - the disk device address corresponding to the
+ * current file offset (likely set with an lseek).
+ *
+ * The flags could hold an indication of whether the # of 
+ * contiguous bytes reflects the true extent length on disk,
+ * or is an advisory value that indicates there is at least that
+ * many bytes contiguous.  For some filesystems it might be too
+ * inefficient to provide anything beyond the advisory value.
+ * Flags and contiguous bytes return values are not yet implemented.
+ * For them the fcntl will nedd to switch from using BMAP to CMAP
+ * and a per filesystem type flag will be needed to interpret the
+ * contiguous bytes count result from CMAP.
+ *
+ * F_LOG2PHYS_EXT is a variant of F_LOG2PHYS that uses a passed in
+ * file offset and length instead of the current file offset.
+ * F_LOG2PHYS_EXT operates on the same structure as F_LOG2PHYS, but
+ * treats it as an in/out.
+ */
+#pragma pack(4)
+
+struct log2phys {
+	unsigned int	l2p_flags;	 /* unused so far */
+	off_t		l2p_contigbytes; /* F_LOG2PHYS:     unused so far */
+					 /* F_LOG2PHYS_EXT: IN:  number of bytes to be queried */
+					 /*                 OUT: number of contiguous bytes at this position */
+	off_t		l2p_devoffset;   /* F_LOG2PHYS:     OUT: bytes into device */
+					 /* F_LOG2PHYS_EXT: IN:  bytes into file */
+					 /*                 OUT: bytes into device */
+};
+
+#pragma pack()
+
+#define	O_POPUP	   0x80000000   /* force window to popup on open */
+#define	O_ALERT	   0x20000000	/* small, clean popup window */
+
+
+#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+
+#include <sys/_types/_filesec_t.h>
+
+typedef enum {
+	FILESEC_OWNER = 1,
+	FILESEC_GROUP = 2,
+	FILESEC_UUID = 3,
+	FILESEC_MODE = 4,
+	FILESEC_ACL = 5,
+	FILESEC_GRPUUID = 6,
+
+/* XXX these are private to the implementation */
+	FILESEC_ACL_RAW = 100,
+	FILESEC_ACL_ALLOCSIZE = 101
+} filesec_property_t;
+
+/* XXX backwards compatibility */
+#define FILESEC_GUID FILESEC_UUID
+#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+
+__BEGIN_DECLS
+int	open(const char *, int, ...) __DARWIN_ALIAS_C(open);
+#if __DARWIN_C_LEVEL >= 200809L
+int	openat(int, const char *, int, ...) __DARWIN_NOCANCEL(openat) __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+#endif
+int	creat(const char *, mode_t) __DARWIN_ALIAS_C(creat);
+int	fcntl(int, int, ...) __DARWIN_ALIAS_C(fcntl);
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+
+int	openx_np(const char *, int, filesec_t);
+/* 
+ * data-protected non-portable open(2) :
+ int open_dprotected_np(user_addr_t path, int flags, int class, int dpflags, int mode)
+ */ 
+int open_dprotected_np ( const char *, int, int, int, ...);
+int	flock(int, int);
+filesec_t filesec_init(void);
+filesec_t filesec_dup(filesec_t);
+void	filesec_free(filesec_t);
+int	filesec_get_property(filesec_t, filesec_property_t, void *);
+int	filesec_query_property(filesec_t, filesec_property_t, int *);
+int	filesec_set_property(filesec_t, filesec_property_t, const void *);
+int	filesec_unset_property(filesec_t, filesec_property_t) __OSX_AVAILABLE_STARTING(__MAC_10_6, __IPHONE_3_2);
+#define _FILESEC_UNSET_PROPERTY	((void *)0)
+#define _FILESEC_REMOVE_ACL	((void *)1)
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+__END_DECLS
+
+#endif /* !_SYS_FCNTL_H_ */
diff -Nur cctools-877.5/include/sys/file.h cctools-877.5-AnV/include/sys/file.h
--- cctools-877.5/include/sys/file.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/file.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,86 @@
+/*
+ * Copyright (c) 2000-2008 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995, 1997 Apple Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1989, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)file.h	8.3 (Berkeley) 1/9/95
+ */
+
+#ifndef _SYS_FILE_H_
+#define	_SYS_FILE_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/types.h>
+#include <sys/fcntl.h>
+#include <sys/unistd.h>
+#include <sys/queue.h>
+#include <sys/cdefs.h>
+
+
+#ifndef _KAUTH_CRED_T
+#define	_KAUTH_CRED_T
+struct ucred;
+typedef struct ucred *kauth_cred_t;
+struct posix_cred;
+typedef struct posix_cred *posix_cred_t;
+#endif	/* !_KAUTH_CRED_T */
+
+__BEGIN_DECLS
+
+__END_DECLS
+#endif /* !_SYS_FILE_H_ */
diff -Nur cctools-877.5/include/sys/filedesc.h cctools-877.5-AnV/include/sys/filedesc.h
--- cctools-877.5/include/sys/filedesc.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/filedesc.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,87 @@
+/*
+ * Copyright (c) 2000-2012 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995, 1997 Apple Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)filedesc.h	8.1 (Berkeley) 6/2/93
+ */
+
+#ifndef _SYS_FILEDESC_H_
+#define	_SYS_FILEDESC_H_
+
+#include <sys/appleapiopts.h>
+
+/*
+ * This structure is used for the management of descriptors.  It may be
+ * shared by multiple processes.
+ *
+ * A process is initially started out with NDFILE descriptors [XXXstored within
+ * this structureXXX], selected to be enough for typical applications based on
+ * the historical limit of 20 open files (and the usage of descriptors by
+ * shells).  If these descriptors are exhausted, a larger descriptor table
+ * may be allocated, up to a process' resource limit; [XXXthe internal arrays
+ * are then unusedXXX].  The initial expansion is set to NDEXTENT; each time
+ * it runs out, it is doubled until the resource limit is reached. NDEXTENT
+ * should be selected to be the biggest multiple of OFILESIZE (see below)
+ * that will fit in a power-of-two sized piece of memory.
+ */
+#define NDFILE		25		/* 125 bytes */
+#define NDEXTENT	50		/* 250 bytes in 256-byte alloc. */ 
+
+
+#endif /* !_SYS_FILEDESC_H_ */
diff -Nur cctools-877.5/include/sys/filio.h cctools-877.5-AnV/include/sys/filio.h
--- cctools-877.5/include/sys/filio.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/filio.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,84 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1990, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)filio.h	8.1 (Berkeley) 3/28/94
+ */
+
+#ifndef	_SYS_FILIO_H_
+#define	_SYS_FILIO_H_
+
+#include <sys/ioccom.h>
+
+/* Generic file-descriptor ioctl's. */
+#define	FIOCLEX		 _IO('f', 1)		/* set close on exec on fd */
+#define	FIONCLEX	 _IO('f', 2)		/* remove close on exec */
+#define	FIONREAD	_IOR('f', 127, int)	/* get # bytes to read */
+#define	FIONBIO		_IOW('f', 126, int)	/* set/clear non-blocking i/o */
+#define	FIOASYNC	_IOW('f', 125, int)	/* set/clear async i/o */
+#define	FIOSETOWN	_IOW('f', 124, int)	/* set owner */
+#define	FIOGETOWN	_IOR('f', 123, int)	/* get owner */
+#define	FIODTYPE	_IOR('f', 122, int)	/* get d_type */
+
+#endif /* !_SYS_FILIO_H_ */
diff -Nur cctools-877.5/include/sys/ioccom.h cctools-877.5-AnV/include/sys/ioccom.h
--- cctools-877.5/include/sys/ioccom.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ioccom.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,99 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1990, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)ioccom.h	8.2 (Berkeley) 3/28/94
+ */
+
+#ifndef	_SYS_IOCCOM_H_
+#define	_SYS_IOCCOM_H_
+
+#include <sys/_types.h>
+
+/*
+ * Ioctl's have the command encoded in the lower word, and the size of
+ * any in or out parameters in the upper word.  The high 3 bits of the
+ * upper word are used to encode the in/out status of the parameter.
+ */
+#define	IOCPARM_MASK	0x1fff		/* parameter length, at most 13 bits */
+#define	IOCPARM_LEN(x)	(((x) >> 16) & IOCPARM_MASK)
+#define	IOCBASECMD(x)	((x) & ~(IOCPARM_MASK << 16))
+#define	IOCGROUP(x)	(((x) >> 8) & 0xff)
+
+#define	IOCPARM_MAX	(IOCPARM_MASK + 1)	/* max size of ioctl args */
+				/* no parameters */
+#define	IOC_VOID	(__uint32_t)0x20000000
+				/* copy parameters out */
+#define	IOC_OUT		(__uint32_t)0x40000000
+				/* copy parameters in */
+#define	IOC_IN		(__uint32_t)0x80000000
+				/* copy paramters in and out */
+#define	IOC_INOUT	(IOC_IN|IOC_OUT)
+				/* mask for IN/OUT/VOID */
+#define	IOC_DIRMASK	(__uint32_t)0xe0000000
+
+#define	_IOC(inout,group,num,len) \
+	(inout | ((len & IOCPARM_MASK) << 16) | ((group) << 8) | (num))
+#define	_IO(g,n)	_IOC(IOC_VOID,	(g), (n), 0)
+#define	_IOR(g,n,t)	_IOC(IOC_OUT,	(g), (n), sizeof(t))
+#define	_IOW(g,n,t)	_IOC(IOC_IN,	(g), (n), sizeof(t))
+/* this should be _IORW, but stdio got there first */
+#define	_IOWR(g,n,t)	_IOC(IOC_INOUT,	(g), (n), sizeof(t))
+
+#endif /* !_SYS_IOCCOM_H_ */
diff -Nur cctools-877.5/include/sys/ioctl.h cctools-877.5-AnV/include/sys/ioctl.h
--- cctools-877.5/include/sys/ioctl.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ioctl.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,110 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1990, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)ioctl.h	8.6 (Berkeley) 3/28/94
+ */
+
+#ifndef	_SYS_IOCTL_H_
+#define	_SYS_IOCTL_H_
+
+#include <sys/ttycom.h>
+
+/*
+ * Pun for SunOS prior to 3.2.  SunOS 3.2 and later support TIOCGWINSZ
+ * and TIOCSWINSZ (yes, even 3.2-3.5, the fact that it wasn't documented
+ * nonwithstanding).
+ */
+struct ttysize {
+	unsigned short	ts_lines;
+	unsigned short	ts_cols;
+	unsigned short	ts_xxx;
+	unsigned short	ts_yyy;
+};
+#define	TIOCGSIZE	TIOCGWINSZ
+#define	TIOCSSIZE	TIOCSWINSZ
+
+#include <sys/ioccom.h>
+
+#include <sys/filio.h>
+#include <sys/sockio.h>
+
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+int	ioctl(int, unsigned long, ...);
+__END_DECLS
+#endif /* !_SYS_IOCTL_H_ */
+
+/*
+ * Keep outside _SYS_IOCTL_H_
+ * Compatability with old terminal driver
+ *
+ * Source level -> #define USE_OLD_TTY
+ * Kernel level -> always on
+ */
+#if defined(USE_OLD_TTY) || BSD_KERNEL_PRIVATE
+#include <sys/ioctl_compat.h>
+#endif /* !_SYS_IOCTL_H_ */
diff -Nur cctools-877.5/include/sys/ioctl_compat.h cctools-877.5-AnV/include/sys/ioctl_compat.h
--- cctools-877.5/include/sys/ioctl_compat.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ioctl_compat.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,204 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)ioctl_compat.h	8.4 (Berkeley) 1/21/94
+ */
+
+#ifndef _SYS_IOCTL_COMPAT_H_
+#define	_SYS_IOCTL_COMPAT_H_
+
+#include <sys/ttychars.h>
+#include <sys/ttydev.h>
+
+struct tchars {
+	char	t_intrc;	/* interrupt */
+	char	t_quitc;	/* quit */
+	char	t_startc;	/* start output */
+	char	t_stopc;	/* stop output */
+	char	t_eofc;		/* end-of-file */
+	char	t_brkc;		/* input delimiter (like nl) */
+};
+
+struct ltchars {
+	char	t_suspc;	/* stop process signal */
+	char	t_dsuspc;	/* delayed stop process signal */
+	char	t_rprntc;	/* reprint line */
+	char	t_flushc;	/* flush output (toggles) */
+	char	t_werasc;	/* word erase */
+	char	t_lnextc;	/* literal next character */
+};
+
+/*
+ * Structure for TIOCGETP and TIOCSETP ioctls.
+ */
+#ifndef _SGTTYB_
+#define	_SGTTYB_
+struct sgttyb {
+	char	sg_ispeed;		/* input speed */
+	char	sg_ospeed;		/* output speed */
+	char	sg_erase;		/* erase character */
+	char	sg_kill;		/* kill character */
+	short	sg_flags;		/* mode flags */
+};
+#endif
+
+#ifdef USE_OLD_TTY
+# undef  TIOCGETD
+# define TIOCGETD	_IOR('t', 0, int)	/* get line discipline */
+# undef  TIOCSETD
+# define TIOCSETD	_IOW('t', 1, int)	/* set line discipline */
+#else
+# define OTIOCGETD	_IOR('t', 0, int)	/* get line discipline */
+# define OTIOCSETD	_IOW('t', 1, int)	/* set line discipline */
+#endif
+#define	TIOCHPCL	_IO('t', 2)		/* hang up on last close */
+#define	TIOCGETP	_IOR('t', 8,struct sgttyb)/* get parameters -- gtty */
+#define	TIOCSETP	_IOW('t', 9,struct sgttyb)/* set parameters -- stty */
+#define	TIOCSETN	_IOW('t',10,struct sgttyb)/* as above, but no flushtty*/
+#define	TIOCSETC	_IOW('t',17,struct tchars)/* set special characters */
+#define	TIOCGETC	_IOR('t',18,struct tchars)/* get special characters */
+#define		TANDEM		0x00000001	/* send stopc on out q full */
+#define		CBREAK		0x00000002	/* half-cooked mode */
+#define		LCASE		0x00000004	/* simulate lower case */
+#define		ECHO		0x00000008	/* echo input */
+#define		CRMOD		0x00000010	/* map \r to \r\n on output */
+#define		RAW		0x00000020	/* no i/o processing */
+#define		ODDP		0x00000040	/* get/send odd parity */
+#define		EVENP		0x00000080	/* get/send even parity */
+#define		ANYP		0x000000c0	/* get any parity/send none */
+#define		NLDELAY		0x00000300	/* \n delay */
+#define		TBDELAY		0x00000c00	/* horizontal tab delay */
+#define		XTABS		0x00000c00	/* expand tabs on output */
+#define		CRDELAY		0x00003000	/* \r delay */
+#define		VTDELAY		0x00004000	/* vertical tab delay */
+#define		BSDELAY		0x00008000	/* \b delay */
+#ifndef	_SYS_TERMIOS_H_
+/*
+ * These manifest constants have the same names as those in <sys/termios.h>,
+ * so you are not permitted to have both definitions in scope simultaneously
+ * in the same compilation unit.
+ */
+#define			NL0	0x00000000
+#define			NL1	0x00000100	/* tty 37 */
+#define			NL2	0x00000200	/* vt05 */
+#define			NL3	0x00000300
+#define			TAB0	0x00000000
+#define			TAB1	0x00000400	/* tty 37 */
+#define			TAB2	0x00000800
+#define			CR0	0x00000000
+#define			CR1	0x00001000	/* tn 300 */
+#define			CR2	0x00002000	/* tty 37 */
+#define			CR3	0x00003000	/* concept 100 */
+#define			FF0	0x00000000
+#define			FF1	0x00004000	/* tty 37 */
+#define			BS0	0x00000000
+#define			BS1	0x00008000
+#endif	/* !_SYS_TERMIOS_H_ */
+#define		ALLDELAY	(NLDELAY|TBDELAY|CRDELAY|VTDELAY|BSDELAY)
+#define		CRTBS		0x00010000	/* do backspacing for crt */
+#define		PRTERA		0x00020000	/* \ ... / erase */
+#define		CRTERA		0x00040000	/* " \b " to wipe out char */
+#define		TILDE		0x00080000	/* hazeltine tilde kludge */
+#define		MDMBUF		0x00100000	/*start/stop output on carrier*/
+#define		LITOUT		0x00200000	/* literal output */
+#define		TOSTOP		0x00400000	/*SIGSTOP on background output*/
+#define		FLUSHO		0x00800000	/* flush output to terminal */
+#define		NOHANG		0x01000000	/* (no-op) was no SIGHUP on carrier drop */
+#define		L001000		0x02000000
+#define		CRTKIL		0x04000000	/* kill line with " \b " */
+#define		PASS8		0x08000000
+#define		CTLECH		0x10000000	/* echo control chars as ^X */
+#define		PENDIN		0x20000000	/* tp->t_rawq needs reread */
+#define		DECCTQ		0x40000000	/* only ^Q starts after ^S */
+#define		NOFLSH		0x80000000	/* no output flush on signal */
+#define	TIOCLBIS	_IOW('t', 127, int)	/* bis local mode bits */
+#define	TIOCLBIC	_IOW('t', 126, int)	/* bic local mode bits */
+#define	TIOCLSET	_IOW('t', 125, int)	/* set entire local mode word */
+#define	TIOCLGET	_IOR('t', 124, int)	/* get local modes */
+#define		LCRTBS		(CRTBS>>16)
+#define		LPRTERA		(PRTERA>>16)
+#define		LCRTERA		(CRTERA>>16)
+#define		LTILDE		(TILDE>>16)
+#define		LMDMBUF		(MDMBUF>>16)
+#define		LLITOUT		(LITOUT>>16)
+#define		LTOSTOP		(TOSTOP>>16)
+#define		LFLUSHO		(FLUSHO>>16)
+#define		LNOHANG		(NOHANG>>16)
+#define		LCRTKIL		(CRTKIL>>16)
+#define		LPASS8		(PASS8>>16)
+#define		LCTLECH		(CTLECH>>16)
+#define		LPENDIN		(PENDIN>>16)
+#define		LDECCTQ		(DECCTQ>>16)
+#define		LNOFLSH		(NOFLSH>>16)
+#define	TIOCSLTC	_IOW('t',117,struct ltchars)/* set local special chars*/
+#define	TIOCGLTC	_IOR('t',116,struct ltchars)/* get local special chars*/
+#define OTIOCCONS	_IO('t', 98)	/* for hp300 -- sans int arg */
+#define	OTTYDISC	0
+#define	NETLDISC	1
+#define	NTTYDISC	2
+
+#define TIOCGSID	_IOR('t', 99, int)	/* For svr4 -- get session id */
+
+#endif /* !_SYS_IOCTL_COMPAT_H_ */
diff -Nur cctools-877.5/include/sys/ipc.h cctools-877.5-AnV/include/sys/ipc.h
--- cctools-877.5/include/sys/ipc.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ipc.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,177 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1988 University of Utah.
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * This code is derived from software contributed to Berkeley by
+ * the Systems Programming Group of the University of Utah Computer
+ * Science Department.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)ipc.h	8.4 (Berkeley) 2/19/95
+ */
+
+/*
+ * SVID compatible ipc.h file
+ */
+#ifndef _SYS_IPC_H_
+#define _SYS_IPC_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+#include <sys/_types.h>
+
+/*
+ * [XSI] The uid_t, gid_t, mode_t, and key_t types SHALL be defined as
+ * described in <sys/types.h>.
+ */
+#include <sys/_types/_uid_t.h>
+#include <sys/_types/_gid_t.h>
+#include <sys/_types/_mode_t.h>
+#include <sys/_types/_key_t.h>
+
+
+#pragma pack(4)
+
+/*
+ * Technically, we should force all code references to the new structure
+ * definition, not in just the standards conformance case, and leave the
+ * legacy interface there for binary compatibility only.  Currently, we
+ * are only forcing this for programs requesting standards conformance.
+ */
+#if __DARWIN_UNIX03 || defined(KERNEL)
+/*
+ * [XSI] Information used in determining permission to perform an IPC
+ * operation
+ */
+struct ipc_perm
+{
+	uid_t		uid;		/* [XSI] Owner's user ID */
+	gid_t		gid;		/* [XSI] Owner's group ID */
+	uid_t		cuid;		/* [XSI] Creator's user ID */
+	gid_t		cgid;		/* [XSI] Creator's group ID */
+	mode_t		mode;		/* [XSI] Read/write permission */
+	unsigned short	_seq;		/* Reserved for internal use */
+	key_t		_key;		/* Reserved for internal use */
+};
+#define	__ipc_perm_new	ipc_perm
+#else	/* !__DARWIN_UNIX03 */
+#define	ipc_perm	__ipc_perm_old
+#endif	/* !__DARWIN_UNIX03 */
+
+#if !__DARWIN_UNIX03
+/*
+ * Legacy structure; this structure is maintained for binary backward
+ * compatability with previous versions of the interface.  New code
+ * should not use this interface, since ID values may be truncated.
+ */
+struct __ipc_perm_old {
+	__uint16_t	cuid;		/* Creator's user ID */
+	__uint16_t	cgid;		/* Creator's group ID */
+	__uint16_t	uid;		/* Owner's user ID */
+	__uint16_t	gid;		/* Owner's group ID */
+	mode_t		mode;		/* Read/Write permission */
+	__uint16_t	seq;		/* Reserved for internal use */
+	key_t		key;		/* Reserved for internal use */
+};
+#endif	/* !__DARWIN_UNIX03 */
+
+#pragma pack()
+
+/*
+ * [XSI] Definitions shall be provided for the following constants:
+ */
+
+/* Mode bits */
+#define	IPC_CREAT	001000		/* Create entry if key does not exist */
+#define	IPC_EXCL	002000		/* Fail if key exists */
+#define	IPC_NOWAIT	004000		/* Error if request must wait */
+
+/* Keys */
+#define	IPC_PRIVATE	((key_t)0)	/* Private key */
+
+/* Control commands */
+#define	IPC_RMID	0		/* Remove identifier */
+#define	IPC_SET		1		/* Set options */
+#define	IPC_STAT	2		/* Get options */
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+
+/* common mode bits */
+#define	IPC_R		000400		/* Read permission */
+#define	IPC_W		000200		/* Write/alter permission */
+#define	IPC_M		010000		/* Modify control info permission */
+
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+
+
+
+__BEGIN_DECLS
+/* [XSI] */
+key_t	ftok(const char *, int);
+__END_DECLS
+
+
+#endif /* !_SYS_IPC_H_ */
diff -Nur cctools-877.5/include/sys/kauth.h cctools-877.5-AnV/include/sys/kauth.h
--- cctools-877.5/include/sys/kauth.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/kauth.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,406 @@
+/*
+ * Copyright (c) 2004-2010 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+#ifndef _SYS_KAUTH_H
+#define _SYS_KAUTH_H
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <mach/boolean.h>
+#include <sys/_types.h>		/* __offsetof() */
+#include <sys/syslimits.h>	/* NGROUPS_MAX */
+
+#ifdef __APPLE_API_EVOLVING
+
+/*
+ * Identities.
+ */
+
+#define KAUTH_UID_NONE	(~(uid_t)0 - 100)	/* not a valid UID */
+#define KAUTH_GID_NONE	(~(gid_t)0 - 100)	/* not a valid GID */
+
+#include <sys/_types/_guid_t.h>
+
+/* NT Security Identifier, structure as defined by Microsoft */
+#pragma pack(1)    /* push packing of 1 byte */
+typedef struct {
+	u_int8_t		sid_kind;
+	u_int8_t		sid_authcount;
+	u_int8_t		sid_authority[6];
+#define KAUTH_NTSID_MAX_AUTHORITIES 16
+	u_int32_t	sid_authorities[KAUTH_NTSID_MAX_AUTHORITIES];
+} ntsid_t;
+#pragma pack()    /* pop packing to previous packing level */
+#define _NTSID_T
+
+/* valid byte count inside a SID structure */
+#define KAUTH_NTSID_HDRSIZE	(8)
+#define KAUTH_NTSID_SIZE(_s)	(KAUTH_NTSID_HDRSIZE + ((_s)->sid_authcount * sizeof(u_int32_t)))
+
+/*
+ * External lookup message payload; this structure is shared between the
+ * kernel group membership resolver, and the user space group membership
+ * resolver daemon, and is use to communicate resolution requests from the
+ * kernel to user space, and the result of that request from user space to
+ * the kernel.
+ */
+struct kauth_identity_extlookup {
+	u_int32_t	el_seqno;	/* request sequence number */
+	u_int32_t	el_result;	/* lookup result */
+#define KAUTH_EXTLOOKUP_SUCCESS		0	/* results here are good */
+#define KAUTH_EXTLOOKUP_BADRQ		1	/* request badly formatted */
+#define KAUTH_EXTLOOKUP_FAILURE		2	/* transient failure during lookup */
+#define KAUTH_EXTLOOKUP_FATAL		3	/* permanent failure during lookup */
+#define KAUTH_EXTLOOKUP_INPROG		100	/* request in progress */
+	u_int32_t	el_flags;
+#define KAUTH_EXTLOOKUP_VALID_UID	(1<<0)
+#define KAUTH_EXTLOOKUP_VALID_UGUID	(1<<1)
+#define KAUTH_EXTLOOKUP_VALID_USID	(1<<2)
+#define KAUTH_EXTLOOKUP_VALID_GID	(1<<3)
+#define KAUTH_EXTLOOKUP_VALID_GGUID	(1<<4)
+#define KAUTH_EXTLOOKUP_VALID_GSID	(1<<5)
+#define KAUTH_EXTLOOKUP_WANT_UID	(1<<6)
+#define KAUTH_EXTLOOKUP_WANT_UGUID	(1<<7)
+#define KAUTH_EXTLOOKUP_WANT_USID	(1<<8)
+#define KAUTH_EXTLOOKUP_WANT_GID	(1<<9)
+#define KAUTH_EXTLOOKUP_WANT_GGUID	(1<<10)
+#define KAUTH_EXTLOOKUP_WANT_GSID	(1<<11)
+#define KAUTH_EXTLOOKUP_WANT_MEMBERSHIP	(1<<12)
+#define KAUTH_EXTLOOKUP_VALID_MEMBERSHIP (1<<13)
+#define KAUTH_EXTLOOKUP_ISMEMBER	(1<<14)
+#define KAUTH_EXTLOOKUP_VALID_PWNAM	(1<<15)
+#define	KAUTH_EXTLOOKUP_WANT_PWNAM	(1<<16)
+#define KAUTH_EXTLOOKUP_VALID_GRNAM	(1<<17)
+#define	KAUTH_EXTLOOKUP_WANT_GRNAM	(1<<18)
+#define	KAUTH_EXTLOOKUP_VALID_SUPGRPS	(1<<19)
+#define	KAUTH_EXTLOOKUP_WANT_SUPGRPS	(1<<20)
+
+	__darwin_pid_t	el_info_pid;		/* request on behalf of PID */
+	u_int64_t	el_extend;		/* extension field */
+	u_int32_t	el_info_reserved_1;	/* reserved (APPLE) */
+
+	uid_t		el_uid;		/* user ID */
+	guid_t		el_uguid;	/* user GUID */
+	u_int32_t	el_uguid_valid;	/* TTL on translation result (seconds) */
+	ntsid_t		el_usid;	/* user NT SID */
+	u_int32_t	el_usid_valid;	/* TTL on translation result (seconds) */
+	gid_t		el_gid;		/* group ID */
+	guid_t		el_gguid;	/* group GUID */
+	u_int32_t	el_gguid_valid;	/* TTL on translation result (seconds) */
+	ntsid_t		el_gsid;	/* group SID */
+	u_int32_t	el_gsid_valid;	/* TTL on translation result (seconds) */
+	u_int32_t	el_member_valid; /* TTL on group lookup result */
+ 	u_int32_t	el_sup_grp_cnt;  /* count of supplemental groups up to NGROUPS */
+ 	gid_t		el_sup_groups[NGROUPS_MAX];	/* supplemental group list */
+};
+
+struct kauth_cache_sizes {
+	u_int32_t kcs_group_size;
+	u_int32_t kcs_id_size;
+};
+
+#define KAUTH_EXTLOOKUP_REGISTER	(0)
+#define KAUTH_EXTLOOKUP_RESULT		(1<<0)
+#define KAUTH_EXTLOOKUP_WORKER		(1<<1)
+#define	KAUTH_EXTLOOKUP_DEREGISTER	(1<<2)
+#define	KAUTH_GET_CACHE_SIZES		(1<<3)
+#define	KAUTH_SET_CACHE_SIZES		(1<<4)
+#define	KAUTH_CLEAR_CACHES		(1<<5)
+
+
+
+/*
+ * Generic Access Control Lists.
+ */
+#if defined(KERNEL) || defined (_SYS_ACL_H)
+
+typedef u_int32_t kauth_ace_rights_t;
+
+/* Access Control List Entry (ACE) */
+struct kauth_ace {
+	guid_t		ace_applicable;
+	u_int32_t	ace_flags;
+#define KAUTH_ACE_KINDMASK		0xf
+#define KAUTH_ACE_PERMIT		1
+#define KAUTH_ACE_DENY			2
+#define KAUTH_ACE_AUDIT			3	/* not implemented */
+#define KAUTH_ACE_ALARM			4	/* not implemented */
+#define	KAUTH_ACE_INHERITED		(1<<4)
+#define KAUTH_ACE_FILE_INHERIT		(1<<5)
+#define KAUTH_ACE_DIRECTORY_INHERIT	(1<<6)
+#define KAUTH_ACE_LIMIT_INHERIT		(1<<7)
+#define KAUTH_ACE_ONLY_INHERIT		(1<<8)
+#define KAUTH_ACE_SUCCESS		(1<<9)	/* not implemented (AUDIT/ALARM) */
+#define KAUTH_ACE_FAILURE		(1<<10)	/* not implemented (AUDIT/ALARM) */
+/* All flag bits controlling ACE inheritance */
+#define KAUTH_ACE_INHERIT_CONTROL_FLAGS		\
+		(KAUTH_ACE_FILE_INHERIT |	\
+		 KAUTH_ACE_DIRECTORY_INHERIT |	\
+		 KAUTH_ACE_LIMIT_INHERIT |	\
+		 KAUTH_ACE_ONLY_INHERIT)
+	kauth_ace_rights_t ace_rights;		/* scope specific */
+	/* These rights are never tested, but may be present in an ACL */
+#define KAUTH_ACE_GENERIC_ALL		(1<<21) 
+#define KAUTH_ACE_GENERIC_EXECUTE	(1<<22)
+#define KAUTH_ACE_GENERIC_WRITE		(1<<23)
+#define KAUTH_ACE_GENERIC_READ		(1<<24)
+
+};
+
+#ifndef _KAUTH_ACE
+#define _KAUTH_ACE
+typedef struct kauth_ace *kauth_ace_t;
+#endif
+
+
+/* Access Control List */
+struct kauth_acl {
+	u_int32_t	acl_entrycount;
+	u_int32_t	acl_flags;
+	
+	struct kauth_ace acl_ace[1];
+};
+
+/*
+ * XXX this value needs to be raised - 3893388
+ */
+#define KAUTH_ACL_MAX_ENTRIES		128
+
+/*
+ * The low 16 bits of the flags field are reserved for filesystem
+ * internal use and must be preserved by all APIs.  This includes
+ * round-tripping flags through user-space interfaces.
+ */
+#define KAUTH_ACL_FLAGS_PRIVATE	(0xffff)
+
+/*
+ * The high 16 bits of the flags are used to store attributes and
+ * to request specific handling of the ACL.
+ */
+
+/* inheritance will be deferred until the first rename operation */
+#define KAUTH_ACL_DEFER_INHERIT	(1<<16)
+/* this ACL must not be overwritten as part of an inheritance operation */
+#define KAUTH_ACL_NO_INHERIT	(1<<17)
+
+/* acl_entrycount that tells us the ACL is not valid */
+#define KAUTH_FILESEC_NOACL ((u_int32_t)(-1))
+
+/*
+ * If the acl_entrycount field is KAUTH_FILESEC_NOACL, then the size is the
+ * same as a kauth_acl structure; the intent is to put an actual entrycount of
+ * KAUTH_FILESEC_NOACL on disk to distinguish a kauth_filesec_t with an empty
+ * entry (Windows treats this as "deny all") from one that merely indicates a
+ * file group and/or owner guid values.
+ */
+#define KAUTH_ACL_SIZE(c)	(__offsetof(struct kauth_acl, acl_ace) + ((u_int32_t)(c) != KAUTH_FILESEC_NOACL ? ((c) * sizeof(struct kauth_ace)) : 0))
+#define KAUTH_ACL_COPYSIZE(p)	KAUTH_ACL_SIZE((p)->acl_entrycount)
+
+
+#ifndef _KAUTH_ACL
+#define _KAUTH_ACL
+typedef struct kauth_acl *kauth_acl_t;
+#endif
+
+
+
+/*
+ * Extended File Security.
+ */
+
+/* File Security information */
+struct kauth_filesec {
+	u_int32_t	fsec_magic;
+#define KAUTH_FILESEC_MAGIC	0x012cc16d
+	guid_t		fsec_owner;
+	guid_t		fsec_group;
+
+	struct kauth_acl fsec_acl;
+};
+
+/* backwards compatibility */
+#define fsec_entrycount fsec_acl.acl_entrycount
+#define fsec_flags 	fsec_acl.acl_flags
+#define fsec_ace	fsec_acl.acl_ace
+#define KAUTH_FILESEC_FLAGS_PRIVATE	KAUTH_ACL_FLAGS_PRIVATE
+#define KAUTH_FILESEC_DEFER_INHERIT	KAUTH_ACL_DEFER_INHERIT
+#define KAUTH_FILESEC_NO_INHERIT	KAUTH_ACL_NO_INHERIT
+#define KAUTH_FILESEC_NONE	((kauth_filesec_t)0)
+#define KAUTH_FILESEC_WANTED	((kauth_filesec_t)1)
+	
+#ifndef _KAUTH_FILESEC
+#define _KAUTH_FILESEC
+typedef struct kauth_filesec *kauth_filesec_t;
+#endif
+
+#define KAUTH_FILESEC_SIZE(c)		(__offsetof(struct kauth_filesec, fsec_acl) + __offsetof(struct kauth_acl, acl_ace) + (c) * sizeof(struct kauth_ace))
+#define KAUTH_FILESEC_COPYSIZE(p)	KAUTH_FILESEC_SIZE(((p)->fsec_entrycount == KAUTH_FILESEC_NOACL) ? 0 : (p)->fsec_entrycount)
+#define KAUTH_FILESEC_COUNT(s)		(((s)  - KAUTH_FILESEC_SIZE(0)) / sizeof(struct kauth_ace))
+#define KAUTH_FILESEC_VALID(s)		((s) >= KAUTH_FILESEC_SIZE(0) && (((s) - KAUTH_FILESEC_SIZE(0)) % sizeof(struct kauth_ace)) == 0)
+
+#define KAUTH_FILESEC_XATTR	"com.apple.system.Security"
+
+/* Allowable first arguments to kauth_filesec_acl_setendian() */
+#define	KAUTH_ENDIAN_HOST	0x00000001	/* set host endianness */
+#define	KAUTH_ENDIAN_DISK	0x00000002	/* set disk endianness */
+
+#endif /* KERNEL || <sys/acl.h> */
+
+
+
+/* Actions, also rights bits in an ACE */
+
+#if defined(KERNEL) || defined (_SYS_ACL_H)
+#define KAUTH_VNODE_READ_DATA			(1<<1)
+#define KAUTH_VNODE_LIST_DIRECTORY		KAUTH_VNODE_READ_DATA
+#define KAUTH_VNODE_WRITE_DATA			(1<<2)
+#define KAUTH_VNODE_ADD_FILE			KAUTH_VNODE_WRITE_DATA
+#define KAUTH_VNODE_EXECUTE			(1<<3)
+#define KAUTH_VNODE_SEARCH			KAUTH_VNODE_EXECUTE
+#define KAUTH_VNODE_DELETE			(1<<4)
+#define KAUTH_VNODE_APPEND_DATA			(1<<5)
+#define KAUTH_VNODE_ADD_SUBDIRECTORY		KAUTH_VNODE_APPEND_DATA
+#define KAUTH_VNODE_DELETE_CHILD		(1<<6)
+#define KAUTH_VNODE_READ_ATTRIBUTES		(1<<7)
+#define KAUTH_VNODE_WRITE_ATTRIBUTES		(1<<8)
+#define KAUTH_VNODE_READ_EXTATTRIBUTES		(1<<9)
+#define KAUTH_VNODE_WRITE_EXTATTRIBUTES		(1<<10)
+#define KAUTH_VNODE_READ_SECURITY		(1<<11)
+#define KAUTH_VNODE_WRITE_SECURITY		(1<<12)
+#define KAUTH_VNODE_TAKE_OWNERSHIP		(1<<13)
+
+/* backwards compatibility only */
+#define KAUTH_VNODE_CHANGE_OWNER		KAUTH_VNODE_TAKE_OWNERSHIP
+
+/* For Windows interoperability only */
+#define KAUTH_VNODE_SYNCHRONIZE			(1<<20)
+
+/* (1<<21) - (1<<24) are reserved for generic rights bits */
+
+/* Actions not expressed as rights bits */
+/*
+ * Authorizes the vnode as the target of a hard link.
+ */
+#define KAUTH_VNODE_LINKTARGET			(1<<25)
+
+/*
+ * Indicates that other steps have been taken to authorise the action,
+ * but authorisation should be denied for immutable objects.
+ */
+#define KAUTH_VNODE_CHECKIMMUTABLE		(1<<26)
+
+/* Action modifiers */
+/*
+ * The KAUTH_VNODE_ACCESS bit is passed to the callback if the authorisation
+ * request in progress is advisory, rather than authoritative.  Listeners
+ * performing consequential work (i.e. not strictly checking authorisation)
+ * may test this flag to avoid performing unnecessary work.
+ *
+ * This bit will never be present in an ACE.
+ */
+#define KAUTH_VNODE_ACCESS			(1<<31)
+
+/*
+ * The KAUTH_VNODE_NOIMMUTABLE bit is passed to the callback along with the
+ * KAUTH_VNODE_WRITE_SECURITY bit (and no others) to indicate that the
+ * caller wishes to change one or more of the immutable flags, and the
+ * state of these flags should not be considered when authorizing the request.
+ * The system immutable flags are only ignored when the system securelevel
+ * is low enough to allow their removal.
+ */
+#define KAUTH_VNODE_NOIMMUTABLE			(1<<30)
+
+
+/*
+ * fake right that is composed by the following...
+ * vnode must have search for owner, group and world allowed
+ * plus there must be no deny modes present for SEARCH... this fake
+ * right is used by the fast lookup path to avoid checking
+ * for an exact match on the last credential to lookup
+ * the component being acted on
+ */
+#define KAUTH_VNODE_SEARCHBYANYONE		(1<<29)
+
+
+/*
+ * when passed as an 'action' to "vnode_uncache_authorized_actions"
+ * it indicates that all of the cached authorizations for that
+ * vnode should be invalidated 
+ */
+#define	KAUTH_INVALIDATE_CACHED_RIGHTS		((kauth_action_t)~0)
+
+
+
+/* The expansions of the GENERIC bits at evaluation time */
+#define KAUTH_VNODE_GENERIC_READ_BITS	(KAUTH_VNODE_READ_DATA |		\
+					KAUTH_VNODE_READ_ATTRIBUTES |		\
+					KAUTH_VNODE_READ_EXTATTRIBUTES |	\
+					KAUTH_VNODE_READ_SECURITY)
+ 
+#define KAUTH_VNODE_GENERIC_WRITE_BITS	(KAUTH_VNODE_WRITE_DATA |		\
+					KAUTH_VNODE_APPEND_DATA |		\
+					KAUTH_VNODE_DELETE |			\
+					KAUTH_VNODE_DELETE_CHILD |		\
+					KAUTH_VNODE_WRITE_ATTRIBUTES |		\
+					KAUTH_VNODE_WRITE_EXTATTRIBUTES |	\
+					KAUTH_VNODE_WRITE_SECURITY)
+ 
+#define KAUTH_VNODE_GENERIC_EXECUTE_BITS (KAUTH_VNODE_EXECUTE)
+ 
+#define KAUTH_VNODE_GENERIC_ALL_BITS	(KAUTH_VNODE_GENERIC_READ_BITS |	\
+					KAUTH_VNODE_GENERIC_WRITE_BITS |	\
+					KAUTH_VNODE_GENERIC_EXECUTE_BITS)
+ 
+/*
+ * Some sets of bits, defined here for convenience.
+ */
+#define KAUTH_VNODE_WRITE_RIGHTS	(KAUTH_VNODE_ADD_FILE |				\
+					KAUTH_VNODE_ADD_SUBDIRECTORY |			\
+					KAUTH_VNODE_DELETE_CHILD |			\
+					KAUTH_VNODE_WRITE_DATA |			\
+					KAUTH_VNODE_APPEND_DATA |			\
+					KAUTH_VNODE_DELETE |				\
+					KAUTH_VNODE_WRITE_ATTRIBUTES |			\
+					KAUTH_VNODE_WRITE_EXTATTRIBUTES |		\
+					KAUTH_VNODE_WRITE_SECURITY |			\
+	    				KAUTH_VNODE_TAKE_OWNERSHIP |			\
+					KAUTH_VNODE_LINKTARGET |			\
+					KAUTH_VNODE_CHECKIMMUTABLE)
+
+
+#endif /* KERNEL || <sys/acl.h> */
+
+
+#endif /* __APPLE_API_EVOLVING */
+#endif /* _SYS_KAUTH_H */
diff -Nur cctools-877.5/include/sys/kdebug.h cctools-877.5-AnV/include/sys/kdebug.h
--- cctools-877.5/include/sys/kdebug.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/kdebug.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,736 @@
+/*
+ * Copyright (c) 2000-2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+/* 	Copyright (c) 1997 Apple Computer, Inc.  All rights reserved. 
+ *
+ * kdebug.h -   kernel_debug definitions
+ *
+ */
+
+#ifndef BSD_SYS_KDEBUG_H
+#define BSD_SYS_KDEBUG_H
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+#ifdef __APPLE_API_UNSTABLE
+
+#include <mach/clock_types.h>
+#include <stdint.h>
+#if	defined(KERNEL_BUILD)
+#include <kdebug.h>
+#endif /* KERNEL_BUILD */
+
+
+typedef enum
+{
+	KD_CALLBACK_KDEBUG_ENABLED,   		// Trace is now enabled. No arguments
+	KD_CALLBACK_KDEBUG_DISABLED,  		// Trace is now disabled. No arguments
+	KD_CALLBACK_SYNC_FLUSH,      		// Request the latest entries from the IOP, and block until complete. No arguments
+	KD_CALLBACK_TYPEFILTER_CHANGED,		// Typefilter is enabled. A read-only pointer to the typefilter is provided, but is only valid while in the callback.
+} kd_callback_type;
+typedef void (*kd_callback_fn) (void* context, kd_callback_type reason, void* arg);
+
+struct kd_callback {
+	kd_callback_fn	func;
+	void*		context;
+	char		iop_name[8]; // null-terminated string with name of core.
+};
+
+typedef struct kd_callback kd_callback_t;
+
+/*
+ * Registers an IOP for participation in tracing. 
+ *  
+ * The registered callback function will be called with the 
+ * supplied context as the first argument, followed by a 
+ * kd_callback_type and an associated void* argument. 
+ *  
+ * The return value is a nonzero coreid that shall be used in 
+ * kernel_debug_enter() to refer to your IOP. If the allocation 
+ * failed, then 0 will be returned. 
+ *  
+ *  
+ * Caveats: 
+ * Note that not all callback calls will indicate a change in 
+ * state (e.g. disabling trace twice would send two disable 
+ * notifications). 
+ *  
+ */
+extern int kernel_debug_register_callback(kd_callback_t callback);
+
+extern void kernel_debug_enter(
+	uint32_t	coreid,
+	uint32_t	debugid,
+	uint64_t	timestamp,
+	uintptr_t	arg1,
+	uintptr_t	arg2,
+	uintptr_t	arg3,
+	uintptr_t	arg4,
+	uintptr_t	threadid
+	);
+
+
+/*
+ * state bits for hfs_update event
+ */
+#define DBG_HFS_UPDATE_ACCTIME   0x01
+#define DBG_HFS_UPDATE_MODTIME	 0x02
+#define DBG_HFS_UPDATE_CHGTIME	 0x04
+#define DBG_HFS_UPDATE_MODIFIED	 0x08
+#define DBG_HFS_UPDATE_FORCE	 0x10
+#define DBG_HFS_UPDATE_DATEADDED 0x20
+
+
+/*
+ * types of faults that vm_fault handles
+ * and creates trace entries for
+ */
+#define DBG_ZERO_FILL_FAULT   1
+#define DBG_PAGEIN_FAULT      2
+#define DBG_COW_FAULT         3
+#define DBG_CACHE_HIT_FAULT   4
+#define DBG_NZF_PAGE_FAULT    5
+#define DBG_GUARD_FAULT	      6	
+#define DBG_PAGEINV_FAULT     7
+#define DBG_PAGEIND_FAULT     8
+#define DBG_COMPRESSOR_FAULT  9
+#define DBG_COMPRESSOR_SWAPIN_FAULT  10
+
+
+/* The debug code consists of the following 
+*
+* ----------------------------------------------------------------------
+*|              |               |                               |Func   |
+*| Class (8)    | SubClass (8)  |          Code (14)            |Qual(2)|
+* ----------------------------------------------------------------------
+* The class specifies the higher level 
+*/
+
+/* The Function qualifiers  */
+#define DBG_FUNC_START		1
+#define DBG_FUNC_END		2
+#define DBG_FUNC_NONE		0
+
+
+/* The Kernel Debug Classes  */
+#define DBG_MACH		1
+#define DBG_NETWORK		2	
+#define DBG_FSYSTEM		3
+#define DBG_BSD			4
+#define DBG_IOKIT		5
+#define DBG_DRIVERS		6
+#define DBG_TRACE           	7
+#define DBG_DLIL	        8
+#define DBG_WORKQUEUE		9
+#define DBG_CORESTORAGE		10
+#define DBG_CG         		11
+#define DBG_MISC		20
+#define DBG_SECURITY		30
+#define DBG_DYLD           	31
+#define DBG_QT              	32
+#define DBG_APPS            	33
+#define DBG_LAUNCHD         	34
+#define DBG_PERF                37
+#define DBG_IMPORTANCE          38
+#define DBG_BANK                40
+#define DBG_XPC                 41
+#define DBG_ATM                 42
+
+#define DBG_MIG			255
+
+/* **** The Kernel Debug Sub Classes for Mach (DBG_MACH) **** */
+#define	DBG_MACH_EXCP_KTRAP_x86	0x02	/* Kernel Traps on x86 */
+#define	DBG_MACH_EXCP_DFLT	0x03	/* Data Translation Fault */
+#define	DBG_MACH_EXCP_IFLT	0x04	/* Inst Translation Fault */
+#define	DBG_MACH_EXCP_INTR	0x05	/* Interrupts */
+#define	DBG_MACH_EXCP_ALNG	0x06	/* Alignment Exception */
+#define	DBG_MACH_EXCP_UTRAP_x86	0x07	/* User Traps on x86 */
+#define	DBG_MACH_EXCP_FP	0x08	/* FP Unavail */
+#define	DBG_MACH_EXCP_DECI	0x09	/* Decrementer Interrupt */
+#define	DBG_MACH_CHUD		0x0A	/* CHUD */
+#define	DBG_MACH_EXCP_SC	0x0C	/* System Calls */
+#define	DBG_MACH_EXCP_TRACE	0x0D	/* Trace exception */
+#define	DBG_MACH_EXCP_EMUL	0x0E	/* Instruction emulated */
+#define	DBG_MACH_IHDLR		0x10	/* Interrupt Handlers */
+#define	DBG_MACH_IPC		0x20	/* Inter Process Comm */
+#define	DBG_MACH_VM		0x30	/* Virtual Memory */
+#define	DBG_MACH_LEAKS		0x31    /* alloc/free */
+#define	DBG_MACH_SCHED		0x40	/* Scheduler */
+#define	DBG_MACH_MSGID_INVALID	0x50	/* Messages - invalid */
+#define DBG_MACH_LOCKS		0x60	/* new lock APIs */
+#define DBG_MACH_PMAP		0x70	/* pmap */
+/* #define unused		0x80    */
+#define DBG_MACH_MP		0x90	/* MP related */
+#define DBG_MACH_VM_PRESSURE	0xA0	/* Memory Pressure Events */
+#define DBG_MACH_STACKSHOT		0xA1	/* Stackshot/Microstackshot subsystem */
+#define DBG_MACH_SFI			0xA2	/* Selective Forced Idle (SFI) */
+#define DBG_MACH_ENERGY_PERF	0xA3 /* Energy/performance resource stats */
+
+/* Codes for Scheduler (DBG_MACH_SCHED) */     
+#define MACH_SCHED              0x0     /* Scheduler */
+#define MACH_STACK_ATTACH       0x1     /* stack_attach() */
+#define MACH_STACK_HANDOFF      0x2     /* stack_handoff() */
+#define MACH_CALL_CONT          0x3     /* call_continuation() */
+#define MACH_CALLOUT            0x4     /* callouts */
+#define MACH_STACK_DETACH       0x5
+#define MACH_MAKE_RUNNABLE      0x6     /* make thread runnable */
+#define	MACH_PROMOTE            0x7	/* promoted due to resource */
+#define	MACH_DEMOTE             0x8	/* promotion undone */
+#define MACH_IDLE               0x9	/* processor idling */
+#define MACH_STACK_DEPTH        0xa	/* stack depth at switch */
+#define MACH_MOVED              0xb	/* did not use original scheduling decision */
+#define MACH_FAIRSHARE_ENTER    0xc	/* move to fairshare band */
+#define MACH_FAIRSHARE_EXIT     0xd	/* exit fairshare band */
+#define MACH_FAILSAFE           0xe	/* tripped fixed-pri/RT failsafe */
+#define MACH_BLOCK              0xf	/* thread block */
+#define MACH_WAIT		0x10	/* thread wait assertion */
+#define	MACH_GET_URGENCY	0x14	/* Urgency queried by platform */
+#define	MACH_URGENCY		0x15	/* Urgency (RT/BG/NORMAL) communicated
+   					 * to platform
+					 */
+#define	MACH_REDISPATCH		0x16	/* "next thread" thread redispatched */
+#define	MACH_REMOTE_AST		0x17	/* AST signal issued to remote processor */
+
+#define	MACH_SCHED_CHOOSE_PROCESSOR	0x18	/* Result of choose_processor */
+#define MACH_DEEP_IDLE          0x19	/* deep idle on master processor */
+#define MACH_SCHED_DECAY_PRIORITY	0x1a	/* timeshare thread priority decayed/restored */
+#define MACH_CPU_THROTTLE_DISABLE	0x1b	/* Global CPU Throttle Disable */
+#define MACH_RW_PROMOTE            0x1c	/* promoted due to RW lock promotion */
+#define MACH_RW_DEMOTE             0x1d	/* promotion due to RW lock undone */
+#define MACH_SCHED_MAINTENANCE     0x1f /* periodic maintenance thread */
+#define MACH_DISPATCH              0x20 /* context switch completed */
+#define MACH_QUANTUM_HANDOFF       0x21 /* quantum handoff occurred */
+#define MACH_MULTIQ_DEQUEUE        0x22 /* Result of multiq dequeue */
+#define MACH_SCHED_THREAD_SWITCH   0x23 /* attempt direct context switch to hinted thread */
+#define MACH_SCHED_SMT_BALANCE     0x24 /* SMT load balancing ASTs */
+
+/* Variants for MACH_MULTIQ_DEQUEUE */
+#define MACH_MULTIQ_BOUND     1
+#define MACH_MULTIQ_GROUP     2
+#define MACH_MULTIQ_GLOBAL    3
+
+/* Codes for IPC (DBG_MACH_IPC) */
+#define	MACH_TASK_SUSPEND			0x0	/* Suspended a task */
+#define	MACH_TASK_RESUME 		  	0x1	/* Resumed a task */
+#define MACH_THREAD_SET_VOUCHER 		0x2
+#define MACH_IPC_MSG_SEND			0x3	/* mach msg send, uniq msg info */
+#define MACH_IPC_MSG_RECV			0x4	/* mach_msg receive */
+#define MACH_IPC_MSG_RECV_VOUCHER_REFUSED	0x5	/* mach_msg receive, voucher refused */
+#define MACH_IPC_KMSG_FREE			0x6	/* kernel free of kmsg data */
+#define MACH_IPC_VOUCHER_CREATE			0x7	/* Voucher added to global voucher hashtable */
+#define MACH_IPC_VOUCHER_CREATE_ATTR_DATA	0x8	/* Attr data for newly created voucher */
+#define MACH_IPC_VOUCHER_DESTROY		0x9	/* Voucher removed from global voucher hashtable */
+
+/* Codes for pmap (DBG_MACH_PMAP) */     
+#define PMAP__CREATE		0x0
+#define PMAP__DESTROY		0x1
+#define PMAP__PROTECT		0x2
+#define PMAP__PAGE_PROTECT	0x3
+#define PMAP__ENTER		0x4
+#define PMAP__REMOVE		0x5
+#define PMAP__NEST		0x6
+#define PMAP__UNNEST		0x7
+#define PMAP__FLUSH_TLBS	0x8
+#define PMAP__UPDATE_INTERRUPT	0x9
+#define PMAP__ATTRIBUTE_CLEAR	0xa
+#define PMAP__REUSABLE		0xb
+#define PMAP__QUERY_RESIDENT	0xc
+#define PMAP__FLUSH_KERN_TLBS	0xd
+#define PMAP__FLUSH_DELAYED_TLBS	0xe
+#define PMAP__FLUSH_TLBS_TO	0xf
+
+/* Codes for Stackshot/Microstackshot (DBG_MACH_STACKSHOT) */
+#define MICROSTACKSHOT_RECORD	0x0
+#define MICROSTACKSHOT_GATHER	0x1
+
+/* Codes for Selective Forced Idle (DBG_MACH_SFI) */
+#define SFI_SET_WINDOW			0x0
+#define SFI_CANCEL_WINDOW		0x1
+#define SFI_SET_CLASS_OFFTIME	0x2
+#define SFI_CANCEL_CLASS_OFFTIME	0x3
+#define SFI_THREAD_DEFER		0x4
+#define SFI_OFF_TIMER			0x5
+#define SFI_ON_TIMER			0x6
+#define SFI_WAIT_CANCELED		0x7
+#define SFI_PID_SET_MANAGED		0x8
+#define SFI_PID_CLEAR_MANAGED	0x9
+
+/* **** The Kernel Debug Sub Classes for Network (DBG_NETWORK) **** */
+#define DBG_NETIP	1	/* Internet Protocol */
+#define DBG_NETARP	2	/* Address Resolution Protocol */
+#define	DBG_NETUDP	3	/* User Datagram Protocol */
+#define	DBG_NETTCP	4	/* Transmission Control Protocol */
+#define	DBG_NETICMP	5	/* Internet Control Message Protocol */
+#define	DBG_NETIGMP	6	/* Internet Group Management Protocol */
+#define	DBG_NETRIP	7	/* Routing Information Protocol */
+#define	DBG_NETOSPF	8	/* Open Shortest Path First */
+#define	DBG_NETISIS	9	/* Intermediate System to Intermediate System */
+#define	DBG_NETSNMP	10	/* Simple Network Management Protocol */
+#define DBG_NETSOCK	11	/* Socket Layer */
+
+/* For Apple talk */
+#define	DBG_NETAARP	100	/* Apple ARP */
+#define	DBG_NETDDP	101	/* Datagram Delivery Protocol */
+#define	DBG_NETNBP	102	/* Name Binding Protocol */
+#define	DBG_NETZIP	103	/* Zone Information Protocol */
+#define	DBG_NETADSP	104	/* Name Binding Protocol */
+#define	DBG_NETATP	105	/* Apple Transaction Protocol */
+#define	DBG_NETASP	106	/* Apple Session Protocol */
+#define	DBG_NETAFP	107	/* Apple Filing Protocol */
+#define	DBG_NETRTMP	108	/* Routing Table Maintenance Protocol */
+#define	DBG_NETAURP	109	/* Apple Update Routing Protocol */
+
+#define	DBG_NETIPSEC	128	/* IPsec Protocol  */
+#define	DBG_NETVMNET	129	/* VMNet */
+
+/* **** The Kernel Debug Sub Classes for IOKIT (DBG_IOKIT) **** */
+#define DBG_IOINTC			0	/* Interrupt controller */
+#define DBG_IOWORKLOOP		1	/* Work from work loop */
+#define DBG_IOINTES			2	/* Interrupt event source */
+#define DBG_IOCLKES			3	/* Clock event source */
+#define DBG_IOCMDQ			4	/* Command queue latencies */
+#define DBG_IOMCURS			5	/* Memory Cursor */
+#define DBG_IOMDESC			6	/* Memory Descriptors */
+#define DBG_IOPOWER			7	/* Power Managerment */
+#define DBG_IOSERVICE		8	/* Matching etc. */
+
+/* **** 9-32 reserved for internal IOKit usage **** */
+
+#define DBG_IOSTORAGE		32	/* Storage layers */
+#define	DBG_IONETWORK		33	/* Network layers */
+#define	DBG_IOKEYBOARD		34	/* Keyboard */
+#define	DBG_IOHID		35	/* HID Devices */
+#define	DBG_IOAUDIO		36	/* Audio */
+#define	DBG_IOSERIAL		37	/* Serial */
+#define	DBG_IOTTY		38	/* TTY layers */
+#define DBG_IOSAM		39	/* SCSI Architecture Model layers */
+#define DBG_IOPARALLELATA   	40	/* Parallel ATA */
+#define DBG_IOPARALLELSCSI	41	/* Parallel SCSI */
+#define DBG_IOSATA		42	/* Serial-ATA */
+#define DBG_IOSAS		43	/* SAS */
+#define DBG_IOFIBRECHANNEL	44	/* FiberChannel */
+#define DBG_IOUSB		45	/* USB */
+#define DBG_IOBLUETOOTH		46	/* Bluetooth */
+#define DBG_IOFIREWIRE		47	/* FireWire */
+#define DBG_IOINFINIBAND	48	/* Infiniband */
+#define DBG_IOCPUPM		49	/* CPU Power Management */
+#define DBG_IOGRAPHICS		50	/* Graphics */
+#define DBG_HIBERNATE		51	/* hibernation related events */
+#define DBG_IOTHUNDERBOLT	52	/* Thunderbolt */
+
+
+/* Backwards compatibility */
+#define	DBG_IOPOINTING		DBG_IOHID			/* OBSOLETE: Use DBG_IOHID instead */
+#define DBG_IODISK			DBG_IOSTORAGE		/* OBSOLETE: Use DBG_IOSTORAGE instead */
+
+/* **** The Kernel Debug Sub Classes for Device Drivers (DBG_DRIVERS) **** */
+#define DBG_DRVSTORAGE		1	/* Storage layers */
+#define	DBG_DRVNETWORK		2	/* Network layers */
+#define	DBG_DRVKEYBOARD		3	/* Keyboard */
+#define	DBG_DRVHID			4	/* HID Devices */
+#define	DBG_DRVAUDIO		5	/* Audio */
+#define	DBG_DRVSERIAL		7	/* Serial */
+#define DBG_DRVSAM			8	/* SCSI Architecture Model layers */
+#define DBG_DRVPARALLELATA  9	/* Parallel ATA */
+#define DBG_DRVPARALLELSCSI	10	/* Parallel SCSI */
+#define DBG_DRVSATA			11	/* Serial ATA */
+#define DBG_DRVSAS			12	/* SAS */
+#define DBG_DRVFIBRECHANNEL	13	/* FiberChannel */
+#define DBG_DRVUSB			14	/* USB */
+#define DBG_DRVBLUETOOTH	15	/* Bluetooth */
+#define DBG_DRVFIREWIRE		16	/* FireWire */
+#define DBG_DRVINFINIBAND	17	/* Infiniband */
+#define DBG_DRVGRAPHICS		18  /* Graphics */
+#define DBG_DRVSD		19 	/* Secure Digital */
+#define DBG_DRVNAND		20	/* NAND drivers and layers */
+#define DBG_SSD			21	/* SSD */
+#define DBG_DRVSPI		22	/* SPI */
+
+/* Backwards compatibility */
+#define	DBG_DRVPOINTING		DBG_DRVHID		/* OBSOLETE: Use DBG_DRVHID instead */
+#define DBG_DRVDISK			DBG_DRVSTORAGE	/* OBSOLETE: Use DBG_DRVSTORAGE instead */
+
+/* **** The Kernel Debug Sub Classes for the DLIL Layer (DBG_DLIL) **** */
+#define DBG_DLIL_STATIC 1       /* Static DLIL code */
+#define DBG_DLIL_PR_MOD 2       /* DLIL Protocol Module */
+#define DBG_DLIL_IF_MOD 3       /* DLIL Interface Module */
+#define DBG_DLIL_PR_FLT 4       /* DLIL Protocol Filter */
+#define DBG_DLIL_IF_FLT 5       /* DLIL Interface FIlter */
+
+/* The Kernel Debug Sub Classes for File System (DBG_FSYSTEM) */
+#define DBG_FSRW      1       /* reads and writes to the filesystem */
+#define DBG_DKRW      2       /* reads and writes to the disk */
+#define DBG_FSVN      3       /* vnode operations (inc. locking/unlocking) */
+#define DBG_FSLOOOKUP 4       /* namei and other lookup-related operations */
+#define DBG_JOURNAL   5       /* journaling operations */
+#define DBG_IOCTL     6       /* ioctl to the disk */
+#define DBG_BOOTCACHE 7       /* bootcache operations */
+#define DBG_HFS       8       /* HFS-specific events; see bsd/hfs/hfs_kdebug.h */
+#define DBG_EXFAT     0xE     /* ExFAT-specific events; see the exfat project */
+#define DBG_MSDOS     0xF     /* FAT-specific events; see the msdosfs project */
+#define DBG_ACFS      0x10    /* Xsan-specific events; see the XsanFS project */
+#define DBG_THROTTLE  0x11    /* I/O Throttling events */	
+#define DBG_CONTENT_PROT 0xCF /* Content Protection Events: see bsd/sys/cprotect.h */
+
+/* The Kernel Debug Sub Classes for BSD */
+#define DBG_BSD_PROC		0x01	/* process/signals related */
+#define DBG_BSD_MEMSTAT		0x02	/* memorystatus / jetsam operations */
+#define	DBG_BSD_EXCP_SC		0x0C	/* System Calls */
+#define	DBG_BSD_AIO		0x0D	/* aio (POSIX async IO) */
+#define DBG_BSD_SC_EXTENDED_INFO 0x0E	/* System Calls, extended info */
+#define DBG_BSD_SC_EXTENDED_INFO2 0x0F	/* System Calls, extended info */
+
+
+/* The Codes for BSD subcode class DBG_BSD_PROC */
+#define BSD_PROC_EXIT		1	/* process exit */
+#define BSD_PROC_FRCEXIT 	2	/* Kernel force termination */
+
+/* Codes for BSD subcode class DBG_BSD_MEMSTAT */
+#define BSD_MEMSTAT_SCAN             1  /* memorystatus thread awake */
+#define BSD_MEMSTAT_JETSAM           2  /* LRU jetsam */
+#define BSD_MEMSTAT_JETSAM_HIWAT     3  /* highwater jetsam */
+#define BSD_MEMSTAT_FREEZE           4  /* freeze process */
+#define BSD_MEMSTAT_LATENCY_COALESCE 5  /* delay imposed to coalesce jetsam reports */
+#define BSD_MEMSTAT_UPDATE           6  /* priority update */	
+#define BSD_MEMSTAT_IDLE_DEMOTE      7  /* idle demotion fired */
+#define BSD_MEMSTAT_CLEAR_ERRORS     8  /* reset termination error state */
+#define BSD_MEMSTAT_DIRTY_TRACK      9  /* track the process state */
+#define BSD_MEMSTAT_DIRTY_SET       10  /* set the process state */
+#define BSD_MEMSTAT_DIRTY_CLEAR     11  /* clear the process state */
+
+/* The Kernel Debug Sub Classes for DBG_TRACE */
+#define DBG_TRACE_DATA      0
+#define DBG_TRACE_STRING    1
+#define	DBG_TRACE_INFO	    2
+
+/*
+ * TRACE_DATA_NEWTHREAD			0x1
+ * TRACE_DATA_EXEC			0x2
+ */
+#define TRACE_DATA_THREAD_TERMINATE	0x3	/* thread has been queued for deallocation and can no longer run */
+
+/* The Kernel Debug Sub Classes for DBG_CORESTORAGE */
+#define DBG_CS_IO	0
+
+/* The Kernel Debug Sub Classes for DBG_SECURITY */
+#define	DBG_SEC_KERNEL	0	/* raw entropy collected by the kernel */
+
+/* Sub-class codes for CoreGraphics (DBG_CG) are defined in its component. */
+
+/* The Kernel Debug Sub Classes for DBG_MISC */
+#define DBG_EVENT	0x10
+#define	DBG_BUFFER	0x20
+
+/* The Kernel Debug Sub Classes for DBG_DYLD */
+#define DBG_DYLD_STRING   5
+
+/* The Kernel Debug modifiers for the DBG_DKRW sub class */
+#define DKIO_DONE 	0x01
+#define DKIO_READ	0x02
+#define DKIO_ASYNC	0x04
+#define DKIO_META	0x08
+#define DKIO_PAGING	0x10
+#define DKIO_THROTTLE	0x20 /* Deprecated, still provided so fs_usage doesn't break */
+#define DKIO_PASSIVE	0x40
+#define DKIO_NOCACHE	0x80
+#define DKIO_TIER_MASK	0xF00
+#define DKIO_TIER_SHIFT	8
+
+/* Kernel Debug Sub Classes for Applications (DBG_APPS) */
+#define DBG_APP_LOGINWINDOW     0x03
+#define DBG_APP_AUDIO           0x04
+#define DBG_APP_SAMBA           0x80
+
+/* Kernel Debug codes for Throttling (DBG_THROTTLE) */
+#define OPEN_THROTTLE_WINDOW	0x1
+#define PROCESS_THROTTLED	0x2	
+#define IO_THROTTLE_DISABLE	0x3
+
+
+/* Subclasses for MACH Importance Policies (DBG_IMPORTANCE) */
+/* TODO: Split up boost and task policy? */
+#define IMP_ASSERTION           0x10    /* Task takes/drops a boost assertion */
+#define IMP_BOOST               0x11    /* Task boost level changed */
+#define IMP_MSG                 0x12    /* boosting message sent by donating task on donating port */
+#define IMP_WATCHPORT           0x13    /* port marked as watchport, and boost was transferred to the watched task */
+#define IMP_TASK_SUPPRESSION    0x17    /* Task changed suppression behaviors */
+#define IMP_TASK_APPTYPE        0x18    /* Task launched with apptype */
+#define IMP_UPDATE              0x19    /* Requested -> effective calculation */
+#define IMP_USYNCH_QOS_OVERRIDE 0x1A    /* Userspace synchronization applied QoS override to resource owning thread */
+#define IMP_DONOR_CHANGE        0x1B    /* The iit_donor bit changed */
+#define IMP_MAIN_THREAD_QOS     0x1C    /* The task's main thread QoS was set */
+/* DBG_IMPORTANCE subclasses  0x20 - 0x3F reserved for task policy flavors */
+
+/* Codes for IMP_ASSERTION */
+#define IMP_HOLD                0x2     /* Task holds a boost assertion */
+#define IMP_DROP                0x4     /* Task drops a boost assertion */
+#define IMP_EXTERN              0x8     /* boost assertion moved from kernel to userspace responsibility (externalized) */
+
+/* Codes for IMP_BOOST */
+#define IMP_BOOSTED             0x1
+#define IMP_UNBOOSTED           0x2     /* Task drops a boost assertion */
+
+/* Codes for IMP_MSG */
+#define IMP_MSG_SEND            0x1     /* boosting message sent by donating task on donating port */
+#define IMP_MSG_DELV            0x2     /* boosting message delivered to task */
+
+/* Codes for IMP_UPDATE */
+#define IMP_UPDATE_TASK_CREATE  0x1
+
+/* Codes for IMP_USYNCH_QOS_OVERRIDE */
+#define IMP_USYNCH_ADD_OVERRIDE		0x0		/* add override for a contended resource */
+#define IMP_USYNCH_REMOVE_OVERRIDE	0x1		/* remove override for a contended resource */
+
+/* Codes for IMP_DONOR_CHANGE */
+#define IMP_DONOR_UPDATE_LIVE_DONOR_STATE	0x0
+#define IMP_DONOR_INIT_DONOR_STATE		0x1
+
+/* Subclasses for MACH Bank Voucher Attribute Manager (DBG_BANK) */
+#define BANK_ACCOUNT_INFO		0x10	/* Trace points related to bank account struct */
+#define BANK_TASK_INFO			0x11	/* Trace points related to bank task struct */
+
+/* Subclasses for MACH ATM Voucher Attribute Manager (ATM) */
+#define ATM_SUBAID_INFO			0x10	
+#define ATM_GETVALUE_INFO		0x20	
+#define ATM_UNREGISTER_INFO		0x30	
+
+/* Codes for BANK_ACCOUNT_INFO */
+#define BANK_SETTLE_CPU_TIME		0x1	/* Bank ledger(chit) rolled up to tasks. */
+
+/* Codes for ATM_SUBAID_INFO */
+#define ATM_MIN_CALLED				0x1
+#define ATM_MIN_LINK_LIST			0x2
+
+/* Codes for ATM_GETVALUE_INFO */
+#define ATM_VALUE_REPLACED			0x1
+#define ATM_VALUE_ADDED 			0x2
+
+/* Codes for ATM_UNREGISTER_INFO */
+#define ATM_VALUE_UNREGISTERED			0x1
+#define ATM_VALUE_DIFF_MAILBOX			0x2
+
+/**********************************************************************/
+
+#define KDBG_CODE(Class, SubClass, code) (((Class & 0xff) << 24) | ((SubClass & 0xff) << 16) | ((code & 0x3fff)  << 2))
+
+#define KDBG_MIGCODE(msgid) ((DBG_MIG << 24) | (((msgid) & 0x3fffff)  << 2))
+
+#define MACHDBG_CODE(SubClass, code) KDBG_CODE(DBG_MACH, SubClass, code)
+#define NETDBG_CODE(SubClass, code) KDBG_CODE(DBG_NETWORK, SubClass, code)
+#define FSDBG_CODE(SubClass, code) KDBG_CODE(DBG_FSYSTEM, SubClass, code)
+#define BSDDBG_CODE(SubClass, code) KDBG_CODE(DBG_BSD, SubClass, code)
+#define IOKDBG_CODE(SubClass, code) KDBG_CODE(DBG_IOKIT, SubClass, code)
+#define DRVDBG_CODE(SubClass, code) KDBG_CODE(DBG_DRIVERS, SubClass, code)
+#define TRACEDBG_CODE(SubClass,code) KDBG_CODE(DBG_TRACE, SubClass, code)
+#define MISCDBG_CODE(SubClass,code) KDBG_CODE(DBG_MISC, SubClass, code)
+#define DLILDBG_CODE(SubClass,code) KDBG_CODE(DBG_DLIL, SubClass, code)
+#define SECURITYDBG_CODE(SubClass,code) KDBG_CODE(DBG_SECURITY, SubClass, code)
+#define DYLDDBG_CODE(SubClass,code) KDBG_CODE(DBG_DYLD, SubClass, code)
+#define QTDBG_CODE(SubClass,code) KDBG_CODE(DBG_QT, SubClass, code)
+#define APPSDBG_CODE(SubClass,code) KDBG_CODE(DBG_APPS, SubClass, code)
+#define CPUPM_CODE(code) IOKDBG_CODE(DBG_IOCPUPM, code)
+
+#define KMEM_ALLOC_CODE MACHDBG_CODE(DBG_MACH_LEAKS, 0)
+#define KMEM_ALLOC_CODE_2 MACHDBG_CODE(DBG_MACH_LEAKS, 1)
+#define KMEM_FREE_CODE MACHDBG_CODE(DBG_MACH_LEAKS, 2)
+#define KMEM_FREE_CODE_2 MACHDBG_CODE(DBG_MACH_LEAKS, 3)
+#define ZALLOC_CODE MACHDBG_CODE(DBG_MACH_LEAKS, 4)
+#define ZALLOC_CODE_2 MACHDBG_CODE(DBG_MACH_LEAKS, 5)
+#define ZFREE_CODE MACHDBG_CODE(DBG_MACH_LEAKS, 6)
+#define ZFREE_CODE_2 MACHDBG_CODE(DBG_MACH_LEAKS, 7)
+
+#define PMAP_CODE(code) MACHDBG_CODE(DBG_MACH_PMAP, code)
+
+
+#define IMPORTANCE_CODE(SubClass, code) KDBG_CODE(DBG_IMPORTANCE, (SubClass), (code))
+#define BANK_CODE(SubClass, code) KDBG_CODE(DBG_BANK, (SubClass), (code))
+#define ATM_CODE(SubClass, code) KDBG_CODE(DBG_ATM, (SubClass), (code))
+
+/*   Usage:
+* kernel_debug((KDBG_CODE(DBG_NETWORK, DNET_PROTOCOL, 51) | DBG_FUNC_START), 
+*	offset, 0, 0, 0,0) 
+* 
+* For ex, 
+* 
+* #include <sys/kdebug.h>
+* 
+* #define DBG_NETIPINIT NETDBG_CODE(DBG_NETIP,1)
+* 
+* 
+* void
+* ip_init()
+* {
+*	register struct protosw *pr;
+*	register int i;
+* 	
+*	KERNEL_DEBUG(DBG_NETIPINIT | DBG_FUNC_START, 0,0,0,0,0)
+* 	--------
+*	KERNEL_DEBUG(DBG_NETIPINIT, 0,0,0,0,0)
+* 	--------
+*	KERNEL_DEBUG(DBG_NETIPINIT | DBG_FUNC_END, 0,0,0,0,0)
+* }
+*
+
+*/
+
+extern unsigned int kdebug_enable;
+#define KDEBUG_ENABLE_TRACE   0x1
+#define KDEBUG_ENABLE_ENTROPY 0x2		/* Obsolescent */
+#define KDEBUG_ENABLE_CHUD    0x4
+#define KDEBUG_ENABLE_PPT     0x8
+
+/*
+ * Infer the supported kernel debug event level from config option.
+ * Use (KDEBUG_LEVEL >= KDEBUG_LEVEL_STANDARD) as a guard to protect
+ * unaudited debug code. 
+ */
+#define KDEBUG_LEVEL_NONE     0
+#define KDEBUG_LEVEL_IST      1
+#define KDEBUG_LEVEL_STANDARD 2
+#define KDEBUG_LEVEL_FULL     3
+
+#if NO_KDEBUG
+#define KDEBUG_LEVEL KDEBUG_LEVEL_NONE    
+#elif IST_KDEBUG
+#define KDEBUG_LEVEL KDEBUG_LEVEL_IST
+#elif KDEBUG
+#define KDEBUG_LEVEL KDEBUG_LEVEL_FULL
+#else
+#define KDEBUG_LEVEL KDEBUG_LEVEL_STANDARD
+#endif
+
+#if (KDEBUG_LEVEL >= KDEBUG_LEVEL_STANDARD)
+#define KERNEL_DEBUG_CONSTANT(x,a,b,c,d,e)				\
+do {									\
+	if (kdebug_enable & ~KDEBUG_ENABLE_PPT)						\
+        kernel_debug(x,(uintptr_t)a,(uintptr_t)b,(uintptr_t)c,		\
+		       (uintptr_t)d,(uintptr_t)e);			\
+} while(0)
+
+#define KERNEL_DEBUG_CONSTANT1(x,a,b,c,d,e)				\
+do {									\
+	if (kdebug_enable & ~KDEBUG_ENABLE_PPT)						\
+        kernel_debug1(x,(uintptr_t)a,(uintptr_t)b,(uintptr_t)c,		\
+			(uintptr_t)d,(uintptr_t)e);			\
+} while(0)
+
+#define KERNEL_DEBUG_EARLY(x,a,b,c,d)					\
+do {									\
+        kernel_debug_early((uint32_t)x,  (uintptr_t)a, (uintptr_t)b,	\
+		           (uintptr_t)c, (uintptr_t)d);			\
+} while(0)
+#else /* (KDEBUG_LEVEL >= KDEBUG_LEVEL_STANDARD) */
+#define KERNEL_DEBUG_CONSTANT(x,a,b,c,d,e) do { } while(0)
+#define KERNEL_DEBUG_CONSTANT1(x,a,b,c,d,e) do { } while(0)
+#define KERNEL_DEBUG_EARLY(x,a,b,c,d) do { } while(0)
+#endif /* (KDEBUG_LEVEL >= KDEBUG_LEVEL_STANDARD) */
+
+/* 
+ * Specify KDEBUG_PPT to indicate that the event belongs to the
+ * limited PPT set.
+ */
+#define KDEBUG_COMMON (KDEBUG_ENABLE_TRACE|KDEBUG_ENABLE_CHUD|KDEBUG_ENABLE_PPT)
+#define KDEBUG_TRACE  (KDEBUG_ENABLE_TRACE|KDEBUG_ENABLE_CHUD)
+#define KDEBUG_PPT    (KDEBUG_ENABLE_PPT)
+
+/*
+ * KERNEL_DEBUG_CONSTANT_IST events provide an audited subset of
+ * tracepoints for userland system tracing tools.
+ */
+#if (KDEBUG_LEVEL >= KDEBUG_LEVEL_IST)
+#define KERNEL_DEBUG_CONSTANT_IST(type,x,a,b,c,d,e)				\
+do {									\
+	if (kdebug_enable & type)						\
+        kernel_debug(x,(uintptr_t)a,(uintptr_t)b,(uintptr_t)c,		\
+			(uintptr_t)d,(uintptr_t)e);			\
+} while(0)
+#else /* (KDEBUG_LEVEL >= KDEBUG_LEVEL_IST) */
+#define KERNEL_DEBUG_CONSTANT_IST(type,x,a,b,c,d,e) do { } while(0)
+#endif /* (KDEBUG_LEVEL >= KDEBUG_LEVEL_IST) */
+
+#if NO_KDEBUG
+#define __kdebug_constant_only __unused
+#endif
+
+extern void kernel_debug(
+		uint32_t  debugid,
+		uintptr_t arg1,
+		uintptr_t arg2,
+		uintptr_t arg3,
+		uintptr_t arg4,
+		uintptr_t arg5);
+
+extern void kernel_debug1(
+		uint32_t  debugid,
+		uintptr_t arg1,
+		uintptr_t arg2,
+		uintptr_t arg3,
+		uintptr_t arg4,
+		uintptr_t arg5);
+
+extern void kernel_debug_early(
+		uint32_t  debugid,
+		uintptr_t arg1,
+		uintptr_t arg2,
+		uintptr_t arg3,
+		uintptr_t arg4);
+
+extern void kernel_debug_string(
+		const char *message);
+
+#if (KDEBUG_LEVEL >= KDEBUG_LEVEL_FULL)
+#define KERNEL_DEBUG(x,a,b,c,d,e)					\
+do {									\
+	if (kdebug_enable & ~KDEBUG_ENABLE_PPT)				\
+        kernel_debug((uint32_t)x,  (uintptr_t)a, (uintptr_t)b,		\
+		     (uintptr_t)c, (uintptr_t)d, (uintptr_t)e);		\
+} while(0)
+
+#define KERNEL_DEBUG1(x,a,b,c,d,e)					\
+do {									\
+	if (kdebug_enable & ~KDEBUG_ENABLE_PPT)				\
+        kernel_debug1((uint32_t)x,  (uintptr_t)a, (uintptr_t)b,		\
+		      (uintptr_t)c, (uintptr_t)d, (uintptr_t)e);	\
+} while(0)
+#else /* (KDEBUG_LEVEL >= KDEBUG_LEVEL_FULL) */
+#define KERNEL_DEBUG(x,a,b,c,d,e) do {} while (0)
+#define KERNEL_DEBUG1(x,a,b,c,d,e) do {} while (0)
+
+#define __kdebug_only __unused
+#endif /* (KDEBUG_LEVEL >= KDEBUG_LEVEL_FULL) */
+
+
+
+#endif /* __APPLE_API_UNSTABLE */
+__END_DECLS
+
+
+
+#endif /* !BSD_SYS_KDEBUG_H */
diff -Nur cctools-877.5/include/sys/kern_control.h cctools-877.5-AnV/include/sys/kern_control.h
--- cctools-877.5/include/sys/kern_control.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/kern_control.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,149 @@
+/*
+ * Copyright (c) 2000-2004, 2012-2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*!
+	@header kern_control.h
+	This header defines an API to communicate between a kernel
+	extension and a process outside of the kernel.
+ */
+
+#ifndef KPI_KERN_CONTROL_H
+#define KPI_KERN_CONTROL_H
+
+
+#include <sys/appleapiopts.h>
+
+/*
+ * Define Controller event subclass, and associated events.
+ * Subclass of KEV_SYSTEM_CLASS
+ */
+
+/*!
+	@defined KEV_CTL_SUBCLASS
+    @discussion The kernel event subclass for kernel control events.
+*/
+#define KEV_CTL_SUBCLASS        2
+
+/*!
+	@defined KEV_CTL_REGISTERED
+    @discussion The event code indicating a new controller was
+    	registered. The data portion will contain a ctl_event_data.
+*/
+#define KEV_CTL_REGISTERED      1       /* a new controller appears */
+
+/*!
+	@defined KEV_CTL_DEREGISTERED
+    @discussion The event code indicating a controller was unregistered.
+    	The data portion will contain a ctl_event_data.
+*/
+#define KEV_CTL_DEREGISTERED    2       /* a controller disappears */
+
+/*!
+	@struct ctl_event_data
+	@discussion This structure is used for KEV_CTL_SUBCLASS kernel
+		events.
+	@field ctl_id The kernel control id.
+	@field ctl_unit The kernel control unit.
+*/
+struct ctl_event_data {
+    u_int32_t	ctl_id;			/* Kernel Controller ID */
+    u_int32_t 	ctl_unit;
+};
+
+/*
+ * Controls destined to the Controller Manager.
+ */
+
+/*!
+	@defined CTLIOCGCOUNT
+    @discussion The CTLIOCGCOUNT ioctl can be used to determine the
+    	number of kernel controllers registered.
+*/
+#define CTLIOCGCOUNT    _IOR('N', 2, int)		/* get number of control structures registered */
+
+/*!
+	@defined CTLIOCGINFO
+    @discussion The CTLIOCGINFO ioctl can be used to convert a kernel
+    	control name to a kernel control id.
+*/
+#define CTLIOCGINFO     _IOWR('N', 3, struct ctl_info)	/* get id from name */
+
+
+/*!
+	@defined MAX_KCTL_NAME
+    @discussion Kernel control names must be no longer than
+    	MAX_KCTL_NAME.
+*/
+#define MAX_KCTL_NAME	96
+
+/*
+ * Controls destined to the Controller Manager.
+ */
+
+/*!
+	@struct ctl_info
+	@discussion This structure is used with the CTLIOCGINFO ioctl to
+		translate from a kernel control name to a control id.
+	@field ctl_id The kernel control id, filled out upon return.
+	@field ctl_name The kernel control name to find.
+*/
+struct ctl_info {
+    u_int32_t	ctl_id; 				/* Kernel Controller ID  */
+    char	ctl_name[MAX_KCTL_NAME];		/* Kernel Controller Name (a C string) */
+};
+
+
+/*!
+	@struct sockaddr_ctl
+	@discussion The controller address structure is used to establish
+		contact between a user client and a kernel controller. The
+		sc_id/sc_unit uniquely identify each controller. sc_id is a
+		unique identifier assigned to the controller. The identifier can
+		be assigned by the system at registration time or be a 32-bit
+		creator code obtained from Apple Computer. sc_unit is a unit
+		number for this sc_id, and is privately used by the kernel
+		controller to identify several instances of the controller.
+	@field sc_len The length of the structure.
+	@field sc_family AF_SYSTEM.
+	@field ss_sysaddr AF_SYS_KERNCONTROL.
+	@field sc_id Controller unique identifier.
+	@field sc_unit Kernel controller private unit number.
+	@field sc_reserved Reserved, must be set to zero.
+*/
+struct sockaddr_ctl {
+    u_char	sc_len;		/* depends on size of bundle ID string */
+    u_char	sc_family;	/* AF_SYSTEM */
+    u_int16_t 	ss_sysaddr;	/* AF_SYS_KERNCONTROL */
+    u_int32_t	sc_id; 		/* Controller unique identifier  */
+    u_int32_t 	sc_unit;	/* Developer private unit number */
+    u_int32_t 	sc_reserved[5];
+};
+
+
+
+#endif /* KPI_KERN_CONTROL_H */
+
diff -Nur cctools-877.5/include/sys/kern_event.h cctools-877.5-AnV/include/sys/kern_event.h
--- cctools-877.5/include/sys/kern_event.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/kern_event.h	2015-11-16 07:56:32 +0000
@@ -0,0 +1,222 @@
+/*
+ * Copyright (c) 2000-2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ *
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ *
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ *
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1998, 1999 Apple Computer, Inc. All Rights Reserved */
+/*!
+	@header kern_event.h
+	This header defines in-kernel functions for generating kernel events as
+	well as functions for receiving kernel events using a kernel event
+	socket.
+ */
+
+#ifndef SYS_KERN_EVENT_H
+#define	SYS_KERN_EVENT_H
+
+#include <sys/appleapiopts.h>
+#include <sys/ioccom.h>
+#include <sys/sys_domain.h>
+
+#define	KEV_SNDSPACE	(4 * 1024)
+#define	KEV_RECVSPACE	(32 * 1024)
+
+#define	KEV_ANY_VENDOR		0
+#define	KEV_ANY_CLASS		0
+#define	KEV_ANY_SUBCLASS	0
+
+/*
+ * Vendor Code
+ */
+
+/*!
+	@defined KEV_VENDOR_APPLE
+	@discussion Apple generated kernel events use the hard coded vendor code
+	value of 1. Third party kernel events use a dynamically allocated vendor
+	code. The vendor code can be found using the SIOCGKEVVENDOR ioctl.
+*/
+#define	KEV_VENDOR_APPLE	1
+
+/*
+ * Definition of top-level classifications for KEV_VENDOR_APPLE
+ */
+
+/*!
+	@defined KEV_NETWORK_CLASS
+	@discussion Network kernel event class.
+ */
+#define	KEV_NETWORK_CLASS	1
+
+/*!
+	@defined KEV_IOKIT_CLASS
+	@discussion IOKit kernel event class.
+ */
+#define	KEV_IOKIT_CLASS		2
+
+/*!
+	@defined KEV_SYSTEM_CLASS
+	@discussion System kernel event class.
+ */
+#define	KEV_SYSTEM_CLASS	3
+
+/*!
+	@defined KEV_APPLESHARE_CLASS
+	@discussion AppleShare kernel event class.
+ */
+#define	KEV_APPLESHARE_CLASS	4
+
+/*!
+	@defined KEV_FIREWALL_CLASS
+	@discussion Firewall kernel event class.
+ */
+#define	KEV_FIREWALL_CLASS	5
+
+/*!
+	@defined KEV_IEEE80211_CLASS
+	@discussion IEEE 802.11 kernel event class.
+ */
+#define	KEV_IEEE80211_CLASS	6
+
+/*!
+	@struct kern_event_msg
+	@discussion This structure is prepended to all kernel events. This
+		structure is used to determine the format of the remainder of
+		the kernel event. This structure will appear on all messages
+		received on a kernel event socket. To post a kernel event, a
+		slightly different structure is used.
+	@field total_size Total size of the kernel event message including the
+		header.
+	@field vendor_code The vendor code indicates which vendor generated the
+		kernel event. This gives every vendor a unique set of classes
+		and subclasses to use. Use the SIOCGKEVVENDOR ioctl to look up
+		vendor codes for vendors other than Apple. Apple uses
+		KEV_VENDOR_APPLE.
+	@field kev_class The class of the kernel event.
+	@field kev_subclass The subclass of the kernel event.
+	@field id Monotonically increasing value.
+	@field event_code The event code.
+	@field event_data Any additional data about this event. Format will
+		depend on the vendor_code, kev_class, kev_subclass, and
+		event_code. The length of the event_data can be determined
+		using total_size - KEV_MSG_HEADER_SIZE.
+ */
+struct kern_event_msg {
+	u_int32_t	total_size;	/* Size of entire event msg */
+	u_int32_t	vendor_code;	/* For non-Apple extensibility */
+	u_int32_t	kev_class;	/* Layer of event source */
+	u_int32_t	kev_subclass;	/* Component within layer */
+	u_int32_t	id;		/* Monotonically increasing value */
+	u_int32_t	event_code;	/* unique code */
+	u_int32_t	event_data[1];	/* One or more data words */
+};
+
+/*!
+	@defined KEV_MSG_HEADER_SIZE
+	@discussion Size of the header portion of the kern_event_msg structure.
+		This accounts for everything right up to event_data. The size
+		of the data can be found by subtracting KEV_MSG_HEADER_SIZE
+		from the total size from the kern_event_msg.
+ */
+#define	KEV_MSG_HEADER_SIZE (offsetof(struct kern_event_msg, event_data[0]))
+
+/*!
+	@struct kev_request
+	@discussion This structure is used with the SIOCSKEVFILT and
+		SIOCGKEVFILT to set and get the control filter setting for a
+		kernel control socket.
+	@field total_size Total size of the kernel event message including the
+		header.
+	@field vendor_code All kernel events that don't match this vendor code
+		will be ignored. KEV_ANY_VENDOR can be used to receive kernel
+		events with any vendor code.
+	@field kev_class All kernel events that don't match this class will be
+		ignored. KEV_ANY_CLASS can be used to receive kernel events with
+		any class.
+	@field kev_subclass All kernel events that don't match this subclass
+		will be ignored. KEV_ANY_SUBCLASS can be used to receive kernel
+		events with any subclass.
+ */
+struct kev_request {
+	u_int32_t	vendor_code;
+	u_int32_t	kev_class;
+	u_int32_t	kev_subclass;
+};
+
+/*!
+	@defined KEV_VENDOR_CODE_MAX_STR_LEN
+	@discussion This define sets the maximum length of a string that can be
+		used to identify a vendor or kext when looking up a vendor code.
+ */
+#define	KEV_VENDOR_CODE_MAX_STR_LEN	200
+
+/*!
+	@struct kev_vendor_code
+	@discussion This structure is used with the SIOCGKEVVENDOR ioctl to
+		convert from a string identifying a kext or vendor, in the
+		form of a bundle identifier, to a vendor code.
+	@field vendor_code After making the SIOCGKEVVENDOR ioctl call, this will
+		be filled in with the vendor code if there is one.
+	@field vendor_string A bundle style identifier.
+ */
+#pragma pack(4)
+struct kev_vendor_code {
+	u_int32_t	vendor_code;
+	char		vendor_string[KEV_VENDOR_CODE_MAX_STR_LEN];
+};
+#pragma pack()
+
+/*!
+	@defined SIOCGKEVID
+	@discussion Retrieve the current event id. Each event generated will
+		have a new id. The next event to be generated will have an id
+		of id+1.
+ */
+#define	SIOCGKEVID	_IOR('e', 1, u_int32_t)
+
+/*!
+	@defined SIOCSKEVFILT
+	@discussion Set the kernel event filter for this socket. Kernel events
+		not matching this filter will not be received on this socket.
+ */
+#define	SIOCSKEVFILT	_IOW('e', 2, struct kev_request)
+
+/*!
+	@defined SIOCGKEVFILT
+	@discussion Retrieve the kernel event filter for this socket. Kernel
+		events not matching this filter will not be received on this
+		socket.
+ */
+#define	SIOCGKEVFILT	_IOR('e', 3, struct kev_request)
+
+/*!
+	@defined SIOCGKEVVENDOR
+	@discussion Lookup the vendor code for the specified vendor. ENOENT will
+		be returned if a vendor code for that vendor string does not
+		exist.
+ */
+#define	SIOCGKEVVENDOR	_IOWR('e', 4, struct kev_vendor_code)
+
+
+#endif /* SYS_KERN_EVENT_H */
diff -Nur cctools-877.5/include/sys/kernel.h cctools-877.5-AnV/include/sys/kernel.h
--- cctools-877.5/include/sys/kernel.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/kernel.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,74 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)kernel.h	8.3 (Berkeley) 1/21/94
+ */
+#ifndef	_SYS_KERNEL_H_
+#define _SYS_KERNEL_H_
+
+#include <sys/appleapiopts.h>
+
+
+#endif	/* !_SYS_KERNEL_H_ */
diff -Nur cctools-877.5/include/sys/kernel_types.h cctools-877.5-AnV/include/sys/kernel_types.h
--- cctools-877.5/include/sys/kernel_types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/kernel_types.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,136 @@
+/*
+ * Copyright (c) 2004-2010 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _KERN_SYS_KERNELTYPES_H_
+#define _KERN_SYS_KERNELTYPES_H_
+
+#include <sys/cdefs.h>
+#include <sys/types.h>
+#include <stdint.h>
+
+#ifdef BSD_BUILD
+/* Macros(?) to clear/set/test flags. */
+#define	SET(t, f)	(t) |= (f)
+#define	CLR(t, f)	(t) &= ~(f)
+#define	ISSET(t, f)	((t) & (f))
+#endif
+
+
+typedef int64_t daddr64_t;
+
+#ifndef BSD_BUILD
+struct buf;
+typedef struct buf * buf_t;
+
+struct file;
+typedef struct file * file_t;
+
+#ifndef __LP64__
+struct ucred;
+typedef struct ucred * ucred_t;
+#endif
+
+struct mount;
+typedef struct mount * mount_t;
+
+struct vnode;
+typedef struct vnode * vnode_t;
+
+struct proc;
+typedef struct proc * proc_t;
+
+struct uio;
+typedef struct uio * uio_t;
+
+struct vfs_context;
+typedef struct vfs_context * vfs_context_t;
+
+struct vfstable;
+typedef struct vfstable * vfstable_t;
+
+struct __ifnet;
+struct __mbuf;
+struct __pkthdr;
+struct __socket;
+struct __sockopt;
+struct __ifaddr;
+struct __ifmultiaddr;
+struct __ifnet_filter;
+struct __rtentry;
+struct __if_clone;
+struct __bufattr;
+
+typedef	struct __ifnet*			ifnet_t;
+typedef	struct __mbuf*			mbuf_t;
+typedef	struct __pkthdr*		pkthdr_t;
+typedef	struct __socket*		socket_t;
+typedef struct __sockopt*		sockopt_t;
+typedef struct __ifaddr*		ifaddr_t;
+typedef struct __ifmultiaddr*	ifmultiaddr_t;
+typedef struct __ifnet_filter*	interface_filter_t;
+typedef struct __rtentry*		route_t;
+typedef struct __if_clone*		if_clone_t;
+typedef struct __bufattr*		bufattr_t;
+
+#else /* BSD_BUILD */
+
+typedef struct buf * buf_t;
+typedef struct file * file_t;
+#ifndef __LP64__
+typedef struct ucred * ucred_t;
+#endif
+typedef struct mount * mount_t;
+typedef struct vnode * vnode_t;
+typedef struct proc * proc_t;
+typedef struct uio * uio_t;
+typedef struct user_iovec * user_iovec_t;
+typedef struct vfs_context * vfs_context_t;
+typedef struct vfstable * vfstable_t;
+
+
+#endif /* !BSD_BUILD */
+
+#include <sys/_types/_guid_t.h>
+
+#ifndef _KAUTH_ACE
+#define _KAUTH_ACE
+struct kauth_ace;
+typedef struct kauth_ace * kauth_ace_t;
+#endif
+#ifndef _KAUTH_ACL
+#define _KAUTH_ACL
+struct kauth_acl;
+typedef struct kauth_acl * kauth_acl_t;
+#endif
+#ifndef _KAUTH_FILESEC
+#define _KAUTH_FILESEC
+struct kauth_filesec;
+typedef struct kauth_filesec * kauth_filesec_t;
+#endif
+
+#endif /* !_KERN_SYS_KERNELTYPES_H_ */
diff -Nur cctools-877.5/include/sys/lctx.h cctools-877.5-AnV/include/sys/lctx.h
--- cctools-877.5/include/sys/lctx.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/lctx.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,26 @@
+/*
+ * $Id: lctx.h,v 1.1.6.2 2006/03/03 23:20:46 msteil Exp $
+ */
+
+#ifndef _SYS_LCTX_H_
+#define _SYS_LCTX_H_
+
+#include <sys/syscall.h>
+
+static __inline pid_t
+getlcid(pid_t pid)
+{
+        return (syscall(SYS_getlcid, pid));
+}
+
+static __inline int
+setlcid(pid_t pid, pid_t lcid)
+{
+        return (syscall(SYS_setlcid, pid, lcid));
+}
+
+#define LCID_PROC_SELF  (0)
+#define LCID_REMOVE     (-1)
+#define LCID_CREATE     (0)
+
+#endif	/* !_SYS_LCTX_H_ */
diff -Nur cctools-877.5/include/sys/loadable_fs.h cctools-877.5-AnV/include/sys/loadable_fs.h
--- cctools-877.5/include/sys/loadable_fs.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/loadable_fs.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,123 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*	@(#)loadable_fs.h	2.0	26/06/90	(c) 1990 NeXT	*/
+
+/* XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
+ *
+ * W I L L    D R A S T I C A L L Y   C H A N G E   S O O N 
+ * U S E   A T  Y O U R   O W N  R I S K
+ *
+ * XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX */
+
+
+/* 
+ * loadable_fs.h - message struct for loading and initializing loadable
+ *		   file systems.
+ */
+
+#ifndef	_SYS_LOADABLE_FS_
+#define _SYS_LOADABLE_FS_
+
+
+/*
+ * Constants for Loadable FS Utilities (in "/System/Library/Filesystems")
+ *
+ * Example of a /usr/filesystems directory
+ *
+ * /usr/filesystems/dos.fs/dos.util		utility with which WSM 
+ *							communicates
+ * /usr/filesystems/dos.fs/dos.name 		"DOS Floppy" 
+ * /usr/filesystems/dos.fs/dos_reloc		actual loadable filesystem
+ * /usr/filesystems/dos.fs/dos.openfs.tiff	"open folder" icon 
+ * /usr/filesystems/dos.fs/dos.fs.tiff		"closed folder" icon 
+ */
+#define FS_DIR_LOCATION		"/System/Library/Filesystems"
+#define FS_DIR_SUFFIX		".fs"
+#define FS_UTIL_SUFFIX		".util"
+#define FS_OPEN_SUFFIX		".openfs.tiff"
+#define FS_CLOSED_SUFFIX	".fs.tiff"
+#define FS_NAME_SUFFIX		".name"
+#define FS_LABEL_SUFFIX		".label"
+
+/*
+ * .util program commands - all sent in the form "-p" or "-m" ... as argv[1].
+ */
+#define FSUC_PROBE		'p'	/* probe FS for mount or init */
+	/* example usage: foo.util -p fd0 removable writable */ 
+
+#define FSUC_PROBEFORINIT	'P'	/* probe FS for init only */
+	/* example usage: foo.util -P fd0 removable */ 
+
+#define FSUC_MOUNT		'm'	/* mount FS */
+	/* example usage: foo.util -m fd0 /bar removable writable */ 
+
+#define FSUC_REPAIR		'r'	/* repair ('fsck') FS */ 
+	/* example usage: foo.util -r fd0 removable */
+
+#define	FSUC_INITIALIZE		'i'	/* initialize FS */
+	/* example usage: foo.util -i fd0 removable */ 
+
+#define FSUC_UNMOUNT		'u'	/* unmount FS */
+	/* example usage: foo.util -u fd0 /bar */ 
+
+/* The following is not used by Workspace Manager */
+#define FSUC_MOUNT_FORCE	'M'	/* like FSUC_MOUNT, but proceed even on
+					 * error. */
+/*
+ * Return codes from .util program
+ */
+#define FSUR_RECOGNIZED		(-1)	/* response to FSUC_PROBE; implies that
+					 * a mount is possible */
+#define FSUR_UNRECOGNIZED	(-2)	/* negative response to FSUC_PROBE */
+#define FSUR_IO_SUCCESS		(-3)	/* mount, unmount, repair succeeded */
+#define FSUR_IO_FAIL		(-4)	/* unrecoverable I/O error */
+#define FSUR_IO_UNCLEAN		(-5)	/* mount failed, file system not clean 
+					 */
+#define FSUR_INVAL		(-6)	/* invalid argument */
+#define FSUR_LOADERR		(-7)	/* kern_loader error */
+#define FSUR_INITRECOGNIZED	(-8)	/* response to FSUC_PROBE or 
+					 * FSUC_PROBEFORINIT, implies that
+					 * initialization is possible */
+
+/*
+ *	mount parameters passed from WSM to the .util program.
+ */
+#define	DEVICE_READONLY		"readonly"
+#define	DEVICE_WRITABLE		"writable"
+
+#define	DEVICE_REMOVABLE	"removable"
+#define	DEVICE_FIXED		"fixed"
+
+/*
+ *	Additional parameters to the mount command - used by WSM when they
+ *	appear in the /etc/mtab file.
+ */
+#define	MNTOPT_FS		"filesystem=" /* e.g. "filesystem=DOS" */
+#define	MNTOPT_REMOVABLE	"removable"
+
+#endif	/* _SYS_LOADABLE_FS_ */
diff -Nur cctools-877.5/include/sys/lock.h cctools-877.5-AnV/include/sys/lock.h
--- cctools-877.5/include/sys/lock.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/lock.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,76 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995, 1997 Apple Computer, Inc. All Rights Reserved */
+/* 
+ * Copyright (c) 1995
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * This code contains ideas from software contributed to Berkeley by
+ * Avadis Tevanian, Jr., Michael Wayne Young, and the Mach Operating
+ * System project at Carnegie-Mellon University.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)lock.h	8.12 (Berkeley) 5/19/95
+ */
+
+#ifndef	_SYS_LOCK_H_
+#define	_SYS_LOCK_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/types.h>
+#include <sys/cdefs.h>
+
+
+#endif	/* _SYS_LOCK_H_ */
diff -Nur cctools-877.5/include/sys/lockf.h cctools-877.5-AnV/include/sys/lockf.h
--- cctools-877.5/include/sys/lockf.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/lockf.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,118 @@
+/*
+ * Copyright (c) 2004-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * This code is derived from software contributed to Berkeley by
+ * Scooter Morris at Genentech Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)lockf.h	8.1 (Berkeley) 6/11/93
+ * $FreeBSD: src/sys/sys/lockf.h,v 1.16 2004/04/07 04:19:49 imp Exp $
+ */
+
+#ifndef _SYS_LOCKF_H_
+#define	_SYS_LOCKF_H_
+
+#include <sys/queue.h>
+#include <sys/cdefs.h>
+
+struct vnop_advlock_args;
+struct vnode;
+
+#ifdef MALLOC_DECLARE
+MALLOC_DECLARE(M_LOCKF);
+#endif
+
+#if IMPORTANCE_INHERITANCE
+#define LF_NOT_BOOSTED  0
+#define LF_BOOSTED      1
+#endif /* IMPORTANCE_INHERITANCE */
+
+/*
+ * The lockf structure is a kernel structure which contains the information
+ * associated with a byte range lock.  The lockf structures are linked into
+ * the vnode structure.  Locks are sorted by the starting byte of the lock for
+ * efficiency after they have been committed; uncommitted locks are on the list
+ * head so they may quickly be accessed, and are both short lived and transient.
+ */
+TAILQ_HEAD(locklist, lockf);
+
+#pragma pack(4)
+
+struct lockf {
+	short	lf_flags;	    /* Semantics: F_POSIX, F_FLOCK, F_WAIT */
+	short	lf_type;	 /* Lock type: F_RDLCK, F_WRLCK */
+	off_t	lf_start;	    /* Byte # of the start of the lock */
+	off_t	lf_end;		    /* Byte # of the end of the lock (-1=EOF) */
+	caddr_t	lf_id;		    /* Id of the resource holding the lock */
+	struct	lockf **lf_head;    /* Back pointer to the head of the locf list */
+	struct vnode *lf_vnode;	    /* Back pointer to the inode */
+	struct	lockf *lf_next;	    /* Pointer to the next lock on this inode */
+	struct	locklist lf_blkhd;  /* List of requests blocked on this lock */
+	TAILQ_ENTRY(lockf) lf_block;/* A request waiting for a lock */
+#if IMPORTANCE_INHERITANCE
+	int     lf_boosted;         /* Is the owner of the lock boosted */
+#endif /* IMPORTANCE_INHERITANCE */
+};
+
+#pragma pack()
+
+/* Maximum length of sleep chains to traverse to try and detect deadlock. */
+#define MAXDEPTH 50
+
+__BEGIN_DECLS
+
+
+__END_DECLS
+
+#endif /* !_SYS_LOCKF_H_ */
diff -Nur cctools-877.5/include/sys/lockstat.h cctools-877.5-AnV/include/sys/lockstat.h
--- cctools-877.5/include/sys/lockstat.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/lockstat.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,159 @@
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License, Version 1.0 only
+ * (the "License").  You may not use this file except in compliance
+ * with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+/*
+ * Copyright 1997-2003 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef _SYS_LOCKSTAT_H
+#define	_SYS_LOCKSTAT_H
+#endif
+
+/* #pragma ident	"@(#)lockstat.h	1.6	05/06/08 SMI" */
+
+#ifdef	__cplusplus
+extern "C" {
+#endif
+
+/*
+ * Spin locks - we have less variants
+ */
+#define	LS_LCK_SPIN_LOCK_ACQUIRE	0
+#define	LS_LCK_SPIN_LOCK_SPIN		1
+#define	LS_LCK_SPIN_UNLOCK_RELEASE	2
+/*
+ * Mutexes can also have interlock-spin events, which are
+ * unique to our lock implementation.
+ */
+#define	LS_LCK_MTX_LOCK_ACQUIRE			3
+#define	LS_LCK_MTX_LOCK_BLOCK			5
+#define	LS_LCK_MTX_LOCK_SPIN			6
+#define	LS_LCK_MTX_LOCK_ILK_SPIN		7
+#define	LS_LCK_MTX_TRY_LOCK_ACQUIRE		8
+#define	LS_LCK_MTX_TRY_SPIN_LOCK_ACQUIRE	9
+#define	LS_LCK_MTX_UNLOCK_RELEASE		10
+
+#define LS_LCK_MTX_LOCK_SPIN_ACQUIRE		39
+/*
+ * Provide a parallel set for indirect mutexes
+ */
+#define	LS_LCK_MTX_EXT_LOCK_ACQUIRE			17
+#define	LS_LCK_MTX_EXT_LOCK_BLOCK			18
+#define	LS_LCK_MTX_EXT_LOCK_SPIN			19
+#define	LS_LCK_MTX_EXT_LOCK_ILK_SPIN		20
+#define	LS_LCK_MTX_TRY_EXT_LOCK_ACQUIRE		21
+#define	LS_LCK_MTX_EXT_UNLOCK_RELEASE		22
+/*
+ * Our reader-writer locks support a blocking upgrade primitive, as
+ * well as the possibility of spinning on the interlock.
+ */
+#define	LS_LCK_RW_LOCK_SHARED_ACQUIRE		23
+#define	LS_LCK_RW_LOCK_SHARED_BLOCK		24
+#define	LS_LCK_RW_LOCK_SHARED_SPIN		25
+
+#define	LS_LCK_RW_LOCK_EXCL_ACQUIRE		26
+#define	LS_LCK_RW_LOCK_EXCL_BLOCK		27
+#define	LS_LCK_RW_LOCK_EXCL_SPIN		28
+
+#define	LS_LCK_RW_DONE_RELEASE			29
+
+#define	LS_LCK_RW_TRY_LOCK_SHARED_ACQUIRE	30
+#define	LS_LCK_RW_TRY_LOCK_SHARED_SPIN		31
+
+#define	LS_LCK_RW_TRY_LOCK_EXCL_ACQUIRE		32
+#define	LS_LCK_RW_TRY_LOCK_EXCL_ILK_SPIN	33
+
+#define	LS_LCK_RW_LOCK_SHARED_TO_EXCL_UPGRADE	34
+#define	LS_LCK_RW_LOCK_SHARED_TO_EXCL_SPIN	35
+#define	LS_LCK_RW_LOCK_SHARED_TO_EXCL_BLOCK	36
+
+#define	LS_LCK_RW_LOCK_EXCL_TO_SHARED_DOWNGRADE	37
+#define	LS_LCK_RW_LOCK_EXCL_TO_SHARED_ILK_SPIN	38
+
+#define	LS_NPROBES			40
+#define LS_LCK_INVALID			LS_NPROBES
+
+/*
+ * Name the various locking functions...
+ */
+#define	LS_LCK_MTX_LOCK			"lck_mtx_lock"
+#define	LS_LCK_MTX_SPIN_LOCK		"lck_mtx_spin_lock"
+#define	LS_LCK_MTX_UNLOCK		"lck_mtx_unlock"
+#define	LS_LCK_MTX_TRY_LOCK		"lck_mtx_try_lock"
+#define	LS_LCK_MTX_TRY_SPIN_LOCK	"lck_mtx_try_spin_lock"
+#define	LS_LCK_MTX_EXT_LOCK		"lck_mtx_ext_lock"
+#define	LS_LCK_MTX_EXT_UNLOCK		"lck_mtx_ext_unlock"
+#define	LS_LCK_MTX_EXT_TRY_LOCK		"lck_mtx_ext_try_lock"
+#define	LS_LCK_MTX_LOCK_SPIN_LOCK	"lck_mtx_lock_spin"
+
+#define	LS_LCK_SPIN_LOCK		"lck_spin_lock"
+#define	LS_LCK_SPIN_TRY_LOCK		"lck_spin_try_lock"
+#define	LS_LCK_SPIN_UNLOCK		"lck_spin_unlock"
+#define	LS_LCK_RW_LOCK_SHARED		"lck_rw_lock_shared"
+#define	LS_LCK_RW_LOCK_EXCL		"lck_rw_lock_exclusive"
+#define	LS_LCK_RW_DONE			"lck_rw_done"
+#define	LS_LCK_RW_TRY_LOCK_EXCL		"lck_rw_try_lock_exclusive"
+#define	LS_LCK_RW_TRY_LOCK_SHARED	"lck_rw_try_lock_shared"
+#define	LS_LCK_RW_LOCK_SHARED_TO_EXCL	"lck_rw_shared_to_exclusive"
+#define	LS_LCK_RW_LOCK_EXCL_TO_SHARED	"lck_rw_exclusive_to_shared"
+
+#define	LS_ACQUIRE			"acquire"
+#define	LS_RELEASE			"release"
+#define	LS_SPIN				"spin"
+#define	LS_BLOCK			"block"
+#define	LS_UPGRADE			"upgrade"
+#define	LS_DOWNGRADE			"downgrade"
+
+#define	LS_TYPE_ADAPTIVE		"adaptive"
+#define	LS_TYPE_SPIN			"spin"
+#define	LS_TYPE_ILK			"interlock"	/* OS X only */
+#define	LS_TYPE_THREAD			"thread"	/* Solaris only */
+#define	LS_TYPE_RW			"rw"
+#define	LS_TYPE_RWUPGRADE		"rwupgrade"	/* OS X only */
+
+#define	LSA_ACQUIRE			(LS_TYPE_ADAPTIVE "-" LS_ACQUIRE)
+#define	LSA_RELEASE			(LS_TYPE_ADAPTIVE "-" LS_RELEASE)
+#define	LSA_SPIN			(LS_TYPE_ADAPTIVE "-" LS_SPIN)
+#define	LSA_BLOCK			(LS_TYPE_ADAPTIVE "-" LS_BLOCK)
+#define	LSA_ILK_SPIN			(LS_TYPE_ILK "-" LS_SPIN)
+#define	LSS_ACQUIRE			(LS_TYPE_SPIN "-" LS_ACQUIRE)
+#define	LSS_RELEASE			(LS_TYPE_SPIN "-" LS_RELEASE)
+#define	LSS_SPIN			(LS_TYPE_SPIN "-" LS_SPIN)
+#define	LSR_ACQUIRE			(LS_TYPE_RW "-" LS_ACQUIRE)
+#define	LSR_RELEASE			(LS_TYPE_RW "-" LS_RELEASE)
+#define	LSR_BLOCK			(LS_TYPE_RW "-" LS_BLOCK)
+#define	LSR_SPIN			(LS_TYPE_RW "-" LS_SPIN)
+#define	LSR_UPGRADE			(LS_TYPE_RW "-" LS_UPGRADE)
+#define	LSR_UPGRADE_BLOCK		(LS_TYPE_RWUPGRADE "-" LS_BLOCK)
+#define	LSR_DOWNGRADE			(LS_TYPE_RW "-" LS_DOWNGRADE)
+#define	LST_SPIN			(LS_TYPE_THREAD "-" LS_SPIN)
+
+#ifndef _ASM
+
+#include <stdint.h>
+
+#ifdef	__cplusplus
+}
+#endif
+
+#endif	/* _SYS_LOCKSTAT_H */
+
diff -Nur cctools-877.5/include/sys/malloc.h cctools-877.5-AnV/include/sys/malloc.h
--- cctools-877.5/include/sys/malloc.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/malloc.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,78 @@
+/*
+ * Copyright (c) 2000-2013 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1998, 1999 Apple Computer, Inc. All Rights Reserved */
+/* Copyright (c) 1995, 1997 Apple Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1987, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)malloc.h	8.5 (Berkeley) 5/3/95
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+#ifndef _SYS_MALLOC_H_
+#define	_SYS_MALLOC_H_
+
+#include <sys/appleapiopts.h>
+
+
+
+#endif	/* _SYS_MALLOC_H_ */
diff -Nur cctools-877.5/include/sys/mbuf.h cctools-877.5-AnV/include/sys/mbuf.h
--- cctools-877.5/include/sys/mbuf.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/mbuf.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,200 @@
+/*
+ * Copyright (c) 1999-2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ *
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ *
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ *
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1998, 1999 Apple Computer, Inc. All Rights Reserved */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Mach Operating System
+ * Copyright (c) 1987 Carnegie-Mellon University
+ * All rights reserved.  The CMU software License Agreement specifies
+ * the terms and conditions for use and redistribution.
+ */
+/*
+ * Copyright (c) 1994 NeXT Computer, Inc. All rights reserved.
+ *
+ * Copyright (c) 1982, 1986, 1988 Regents of the University of California.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *      This product includes software developed by the University of
+ *      California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)mbuf.h	8.3 (Berkeley) 1/21/94
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+#ifndef	_SYS_MBUF_H_
+#define	_SYS_MBUF_H_
+
+#include <sys/cdefs.h>
+#include <sys/appleapiopts.h>
+
+
+/* mbuf types */
+#define	MT_FREE		0	/* should be on free list */
+#define	MT_DATA		1	/* dynamic (data) allocation */
+#define	MT_HEADER	2	/* packet header */
+#define	MT_SOCKET	3	/* socket structure */
+#define	MT_PCB		4	/* protocol control block */
+#define	MT_RTABLE	5	/* routing tables */
+#define	MT_HTABLE	6	/* IMP host tables */
+#define	MT_ATABLE	7	/* address resolution tables */
+#define	MT_SONAME	8	/* socket name */
+#define	MT_SOOPTS	10	/* socket options */
+#define	MT_FTABLE	11	/* fragment reassembly header */
+#define	MT_RIGHTS	12	/* access rights */
+#define	MT_IFADDR	13	/* interface address */
+#define	MT_CONTROL	14	/* extra-data protocol message */
+#define	MT_OOBDATA	15	/* expedited data  */
+#define	MT_TAG		16	/* volatile metadata associated to pkts */
+#define	MT_MAX		32	/* enough? */
+
+
+/*
+ * Mbuf statistics (legacy).
+ */
+struct mbstat {
+	u_int32_t	m_mbufs;	/* mbufs obtained from page pool */
+	u_int32_t	m_clusters;	/* clusters obtained from page pool */
+	u_int32_t	m_spare;	/* spare field */
+	u_int32_t	m_clfree;	/* free clusters */
+	u_int32_t	m_drops;	/* times failed to find space */
+	u_int32_t	m_wait;		/* times waited for space */
+	u_int32_t	m_drain;	/* times drained protocols for space */
+	u_short		m_mtypes[256];	/* type specific mbuf allocations */
+	u_int32_t	m_mcfail;	/* times m_copym failed */
+	u_int32_t	m_mpfail;	/* times m_pullup failed */
+	u_int32_t	m_msize;	/* length of an mbuf */
+	u_int32_t	m_mclbytes;	/* length of an mbuf cluster */
+	u_int32_t	m_minclsize;	/* min length of data to allocate a cluster */
+	u_int32_t	m_mlen;		/* length of data in an mbuf */
+	u_int32_t	m_mhlen;	/* length of data in a header mbuf */
+	u_int32_t	m_bigclusters;	/* clusters obtained from page pool */
+	u_int32_t	m_bigclfree;	/* free clusters */
+	u_int32_t	m_bigmclbytes;	/* length of an mbuf cluster */
+};
+
+/* Compatibillity with 10.3 */
+struct ombstat {
+	u_int32_t	m_mbufs;	/* mbufs obtained from page pool */
+	u_int32_t	m_clusters;	/* clusters obtained from page pool */
+	u_int32_t	m_spare;	/* spare field */
+	u_int32_t	m_clfree;	/* free clusters */
+	u_int32_t	m_drops;	/* times failed to find space */
+	u_int32_t	m_wait;		/* times waited for space */
+	u_int32_t	m_drain;	/* times drained protocols for space */
+	u_short		m_mtypes[256];	/* type specific mbuf allocations */
+	u_int32_t	m_mcfail;	/* times m_copym failed */
+	u_int32_t	m_mpfail;	/* times m_pullup failed */
+	u_int32_t	m_msize;	/* length of an mbuf */
+	u_int32_t	m_mclbytes;	/* length of an mbuf cluster */
+	u_int32_t	m_minclsize;	/* min length of data to allocate a cluster */
+	u_int32_t	m_mlen;		/* length of data in an mbuf */
+	u_int32_t	m_mhlen;	/* length of data in a header mbuf */
+};
+
+/*
+ * mbuf class statistics.
+ */
+#define	MAX_MBUF_CNAME	15
+
+
+typedef struct mb_class_stat {
+	char		mbcl_cname[MAX_MBUF_CNAME + 1]; /* class name */
+	u_int32_t	mbcl_size;	/* buffer size */
+	u_int32_t	mbcl_total;	/* # of buffers created */
+	u_int32_t	mbcl_active;	/* # of active buffers */
+	u_int32_t	mbcl_infree;	/* # of available buffers */
+	u_int32_t	mbcl_slab_cnt;	/* # of available slabs */
+#if defined(KERNEL) || defined(__LP64__)
+	u_int32_t	mbcl_pad;	/* padding */
+#endif /* KERNEL || __LP64__ */
+	u_int64_t	mbcl_alloc_cnt;	/* # of times alloc is called */
+	u_int64_t	mbcl_free_cnt;	/* # of times free is called */
+	u_int64_t	mbcl_notified;	/* # of notified wakeups */
+	u_int64_t	mbcl_purge_cnt;	/* # of purges so far */
+	u_int64_t	mbcl_fail_cnt;	/* # of allocation failures */
+	u_int32_t	mbcl_ctotal;	/* total only for this class */
+	u_int32_t	mbcl_release_cnt; /* amount of memory returned */
+	/*
+	 * Cache layer statistics
+	 */
+	u_int32_t	mbcl_mc_state;	/* cache state (see below) */
+	u_int32_t	mbcl_mc_cached;	/* # of cached buffers */
+	u_int32_t	mbcl_mc_waiter_cnt;  /* # waiters on the cache */
+	u_int32_t	mbcl_mc_wretry_cnt;  /* # of wait retries */
+	u_int32_t	mbcl_mc_nwretry_cnt; /* # of no-wait retry attempts */
+	u_int32_t	mbcl_peak_reported; /* last usage peak reported */
+	u_int32_t	mbcl_reserved[7];    /* for future use */
+} mb_class_stat_t;
+
+#define	MCS_DISABLED	0	/* cache is permanently disabled */
+#define	MCS_ONLINE	1	/* cache is online */
+#define	MCS_PURGING	2	/* cache is being purged */
+#define	MCS_OFFLINE	3	/* cache is offline (resizing) */
+
+
+typedef struct mb_stat {
+	u_int32_t	mbs_cnt;	/* number of classes */
+#if defined(KERNEL) || defined(__LP64__)
+	u_int32_t	mbs_pad;	/* padding */
+#endif /* KERNEL || __LP64__ */
+	mb_class_stat_t	mbs_class[1];	/* class array */
+} mb_stat_t;
+
+
+
+#endif	/* !_SYS_MBUF_H_ */
diff -Nur cctools-877.5/include/sys/mman.h cctools-877.5-AnV/include/sys/mman.h
--- cctools-877.5/include/sys/mman.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/mman.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,221 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)mman.h	8.1 (Berkeley) 6/2/93
+ */
+
+/*
+ * Currently unsupported:
+ *
+ * [TYM]	POSIX_TYPED_MEM_ALLOCATE
+ * [TYM]	POSIX_TYPED_MEM_ALLOCATE_CONTIG
+ * [TYM]	POSIX_TYPED_MEM_MAP_ALLOCATABLE
+ * [TYM]	struct posix_typed_mem_info
+ * [TYM]	posix_mem_offset()
+ * [TYM]	posix_typed_mem_get_info()
+ * [TYM]	posix_typed_mem_open()
+ */
+
+#ifndef	_SYS_MMAN_H_
+#define _SYS_MMAN_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+#include <sys/_types.h>
+
+/*
+ * [various] The mode_t, off_t, and size_t types shall be defined as
+ * described in <sys/types.h>
+ */
+#include <sys/_types/_mode_t.h>
+#include <sys/_types/_off_t.h>
+#include <sys/_types/_size_t.h>
+
+/*
+ * Protections are chosen from these bits, or-ed together
+ */
+#define	PROT_NONE	0x00	/* [MC2] no permissions */
+#define	PROT_READ	0x01	/* [MC2] pages can be read */
+#define	PROT_WRITE	0x02	/* [MC2] pages can be written */
+#define	PROT_EXEC	0x04	/* [MC2] pages can be executed */
+
+/*
+ * Flags contain sharing type and options.
+ * Sharing types; choose one.
+ */
+#define	MAP_SHARED	0x0001		/* [MF|SHM] share changes */
+#define	MAP_PRIVATE	0x0002		/* [MF|SHM] changes are private */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	MAP_COPY	MAP_PRIVATE	/* Obsolete */
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/*
+ * Other flags
+ */
+#define	MAP_FIXED	 0x0010	/* [MF|SHM] interpret addr exactly */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	MAP_RENAME	 0x0020	/* Sun: rename private pages to file */
+#define	MAP_NORESERVE	 0x0040	/* Sun: don't reserve needed swap area */
+#define	MAP_RESERVED0080 0x0080	/* previously unimplemented MAP_INHERIT */
+#define	MAP_NOEXTEND	 0x0100	/* for MAP_FILE, don't change file size */
+#define	MAP_HASSEMAPHORE 0x0200	/* region may contain semaphores */
+#define MAP_NOCACHE	 0x0400 /* don't cache pages for this mapping */
+#define MAP_JIT		 0x0800 /* Allocate a region that will be used for JIT purposes */
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/*
+ * Process memory locking
+ */
+#define MCL_CURRENT	0x0001	/* [ML] Lock only current memory */
+#define MCL_FUTURE	0x0002	/* [ML] Lock all future memory as well */
+
+/*
+ * Error return from mmap()
+ */
+#define MAP_FAILED	((void *)-1)	/* [MF|SHM] mmap failed */
+
+/*
+ * msync() flags
+ */
+#define MS_ASYNC	0x0001	/* [MF|SIO] return immediately */
+#define MS_INVALIDATE	0x0002	/* [MF|SIO] invalidate all cached data */
+#define	MS_SYNC		0x0010	/* [MF|SIO] msync synchronously */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define MS_KILLPAGES    0x0004  /* invalidate pages, leave mapped */
+#define MS_DEACTIVATE   0x0008  /* deactivate pages, leave mapped */
+
+/*
+ * Mapping type
+ */
+#define	MAP_FILE	0x0000	/* map from file (default) */
+#define	MAP_ANON	0x1000	/* allocated from memory, swap space */
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+
+/*
+ * Advice to madvise
+ */
+#define	POSIX_MADV_NORMAL	0	/* [MC1] no further special treatment */
+#define	POSIX_MADV_RANDOM	1	/* [MC1] expect random page refs */
+#define	POSIX_MADV_SEQUENTIAL	2	/* [MC1] expect sequential page refs */
+#define	POSIX_MADV_WILLNEED	3	/* [MC1] will need these pages */
+#define	POSIX_MADV_DONTNEED	4	/* [MC1] dont need these pages */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	MADV_NORMAL		POSIX_MADV_NORMAL
+#define	MADV_RANDOM		POSIX_MADV_RANDOM
+#define	MADV_SEQUENTIAL		POSIX_MADV_SEQUENTIAL
+#define	MADV_WILLNEED		POSIX_MADV_WILLNEED
+#define	MADV_DONTNEED		POSIX_MADV_DONTNEED
+#define	MADV_FREE		5	/* pages unneeded, discard contents */
+#define	MADV_ZERO_WIRED_PAGES	6	/* zero the wired pages that have not been unwired before the entry is deleted */
+#define MADV_FREE_REUSABLE	7	/* pages can be reused (by anyone) */
+#define MADV_FREE_REUSE		8	/* caller wants to reuse those pages */
+#define MADV_CAN_REUSE		9
+
+/*
+ * Return bits from mincore
+ */
+#define	MINCORE_INCORE	 	 0x1	 /* Page is incore */
+#define	MINCORE_REFERENCED	 0x2	 /* Page has been referenced by us */
+#define	MINCORE_MODIFIED	 0x4	 /* Page has been modified by us */
+#define	MINCORE_REFERENCED_OTHER 0x8	 /* Page has been referenced */
+#define	MINCORE_MODIFIED_OTHER	0x10	 /* Page has been modified */
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+
+
+__BEGIN_DECLS
+/* [ML] */
+int	mlockall(int);
+int	munlockall(void);
+/* [MR] */
+int	mlock(const void *, size_t);
+#ifndef _MMAP
+#define	_MMAP
+/* [MC3]*/
+void *	mmap(void *, size_t, int, int, int, off_t) __DARWIN_ALIAS(mmap);
+#endif
+/* [MPR] */
+int	mprotect(void *, size_t, int) __DARWIN_ALIAS(mprotect);
+/* [MF|SIO] */
+int	msync(void *, size_t, int) __DARWIN_ALIAS_C(msync);
+/* [MR] */
+int	munlock(const void *, size_t);
+/* [MC3]*/
+int	munmap(void *, size_t) __DARWIN_ALIAS(munmap);
+/* [SHM] */
+int	shm_open(const char *, int, ...);
+int	shm_unlink(const char *);
+/* [ADV] */
+int	posix_madvise(void *, size_t, int);
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+int	madvise(void *, size_t, int);
+int	mincore(const void *, size_t, char *);
+int	minherit(void *, size_t, int);
+#endif
+
+
+__END_DECLS
+
+#endif /* !_SYS_MMAN_H_ */
diff -Nur cctools-877.5/include/sys/mount.h cctools-877.5-AnV/include/sys/mount.h
--- cctools-877.5/include/sys/mount.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/mount.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,404 @@
+/*
+ * Copyright (c) 2000-2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1989, 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)mount.h	8.21 (Berkeley) 5/20/95
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+
+#ifndef _SYS_MOUNT_H_
+#define	_SYS_MOUNT_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/attr.h>		/* needed for vol_capabilities_attr_t */
+
+#include <stdint.h>
+#include <sys/ucred.h>
+#include <sys/queue.h>		/* XXX needed for user builds */
+#include <Availability.h>
+
+#include <sys/_types/_fsid_t.h> /* file system id type */
+
+/*
+ * file system statistics
+ */
+
+#define	MFSNAMELEN	15	/* length of fs type name, not inc. null */
+#define	MFSTYPENAMELEN	16	/* length of fs type name including null */
+
+#if __DARWIN_64_BIT_INO_T
+#define	MNAMELEN	MAXPATHLEN	/* length of buffer for returned name */
+#else /* ! __DARWIN_64_BIT_INO_T */
+#define	MNAMELEN	90		/* length of buffer for returned name */
+#endif /* __DARWIN_64_BIT_INO_T */
+
+#define __DARWIN_STRUCT_STATFS64 { \
+	uint32_t	f_bsize;	/* fundamental file system block size */ \
+	int32_t		f_iosize;	/* optimal transfer block size */ \
+	uint64_t	f_blocks;	/* total data blocks in file system */ \
+	uint64_t	f_bfree;	/* free blocks in fs */ \
+	uint64_t	f_bavail;	/* free blocks avail to non-superuser */ \
+	uint64_t	f_files;	/* total file nodes in file system */ \
+	uint64_t	f_ffree;	/* free file nodes in fs */ \
+	fsid_t		f_fsid;		/* file system id */ \
+	uid_t		f_owner;	/* user that mounted the filesystem */ \
+	uint32_t	f_type;		/* type of filesystem */ \
+	uint32_t	f_flags;	/* copy of mount exported flags */ \
+	uint32_t	f_fssubtype;	/* fs sub-type (flavor) */ \
+	char		f_fstypename[MFSTYPENAMELEN];	/* fs type name */ \
+	char		f_mntonname[MAXPATHLEN];	/* directory on which mounted */ \
+	char		f_mntfromname[MAXPATHLEN];	/* mounted filesystem */ \
+	uint32_t	f_reserved[8];	/* For future use */ \
+}
+
+#if !__DARWIN_ONLY_64_BIT_INO_T
+
+struct statfs64 __DARWIN_STRUCT_STATFS64;
+
+#endif /* !__DARWIN_ONLY_64_BIT_INO_T */
+
+#if __DARWIN_64_BIT_INO_T
+
+struct statfs __DARWIN_STRUCT_STATFS64;
+
+#else /* !__DARWIN_64_BIT_INO_T */
+
+/*
+ * LP64 - WARNING - must be kept in sync with struct user_statfs in mount_internal.h.
+ */
+struct statfs {
+	short	f_otype;		/* TEMPORARY SHADOW COPY OF f_type */
+	short	f_oflags;		/* TEMPORARY SHADOW COPY OF f_flags */
+	long	f_bsize;		/* fundamental file system block size */
+	long	f_iosize;		/* optimal transfer block size */
+	long	f_blocks;		/* total data blocks in file system */
+	long	f_bfree;		/* free blocks in fs */
+	long	f_bavail;		/* free blocks avail to non-superuser */
+	long	f_files;		/* total file nodes in file system */
+	long	f_ffree;		/* free file nodes in fs */
+	fsid_t	f_fsid;			/* file system id */
+	uid_t	f_owner;		/* user that mounted the filesystem */
+	short	f_reserved1;	/* spare for later */
+	short	f_type;			/* type of filesystem */
+	long	f_flags;		/* copy of mount exported flags */
+	long    f_reserved2[2];	/* reserved for future use */
+	char	f_fstypename[MFSNAMELEN]; /* fs type name */
+	char	f_mntonname[MNAMELEN];	/* directory on which mounted */
+	char	f_mntfromname[MNAMELEN];/* mounted filesystem */
+	char	f_reserved3;	/* For alignment */
+	long	f_reserved4[4];	/* For future use */
+};
+
+#endif /* __DARWIN_64_BIT_INO_T */
+
+#pragma pack(4)
+
+struct vfsstatfs {
+	uint32_t	f_bsize;	/* fundamental file system block size */
+	size_t		f_iosize;	/* optimal transfer block size */
+	uint64_t	f_blocks;	/* total data blocks in file system */
+	uint64_t	f_bfree;	/* free blocks in fs */
+	uint64_t	f_bavail;	/* free blocks avail to non-superuser */
+	uint64_t	f_bused;	/* free blocks avail to non-superuser */
+	uint64_t	f_files;	/* total file nodes in file system */
+	uint64_t	f_ffree;	/* free file nodes in fs */
+	fsid_t		f_fsid;		/* file system id */
+	uid_t		f_owner;	/* user that mounted the filesystem */
+	uint64_t	f_flags;	/* copy of mount exported flags */ 
+	char		f_fstypename[MFSTYPENAMELEN];/* fs type name inclus */
+	char		f_mntonname[MAXPATHLEN];/* directory on which mounted */
+	char		f_mntfromname[MAXPATHLEN];/* mounted filesystem */
+	uint32_t	f_fssubtype;     /* fs sub-type (flavor) */
+	void		*f_reserved[2];		/* For future use == 0 */
+};
+
+#pragma pack()
+
+
+/*
+ * User specifiable flags.
+ *
+ * Unmount uses MNT_FORCE flag.
+ */
+#define	MNT_RDONLY	0x00000001	/* read only filesystem */
+#define	MNT_SYNCHRONOUS	0x00000002	/* file system written synchronously */
+#define	MNT_NOEXEC	0x00000004	/* can't exec from filesystem */
+#define	MNT_NOSUID	0x00000008	/* don't honor setuid bits on fs */
+#define	MNT_NODEV	0x00000010	/* don't interpret special files */
+#define	MNT_UNION	0x00000020	/* union with underlying filesystem */
+#define	MNT_ASYNC	0x00000040	/* file system written asynchronously */
+#define	MNT_CPROTECT	0x00000080	/* file system supports content protection */
+
+/*
+ * NFS export related mount flags.
+ */
+#define	MNT_EXPORTED	0x00000100	/* file system is exported */
+
+/*
+ * MAC labeled / "quarantined" flag
+ */
+#define MNT_QUARANTINE	0x00000400	/* file system is quarantined */
+
+/*
+ * Flags set by internal operations.
+ */
+#define	MNT_LOCAL	0x00001000	/* filesystem is stored locally */
+#define	MNT_QUOTA	0x00002000	/* quotas are enabled on filesystem */
+#define	MNT_ROOTFS	0x00004000	/* identifies the root filesystem */
+#define	MNT_DOVOLFS	0x00008000	/* FS supports volfs (deprecated flag in Mac OS X 10.5) */
+
+
+#define MNT_DONTBROWSE	0x00100000	/* file system is not appropriate path to user data */
+#define MNT_IGNORE_OWNERSHIP 0x00200000 /* VFS will ignore ownership information on filesystem objects */
+#define MNT_AUTOMOUNTED 0x00400000	/* filesystem was mounted by automounter */
+#define MNT_JOURNALED   0x00800000  	/* filesystem is journaled */
+#define MNT_NOUSERXATTR	0x01000000	/* Don't allow user extended attributes */
+#define MNT_DEFWRITE	0x02000000	/* filesystem should defer writes */
+#define MNT_MULTILABEL	0x04000000	/* MAC support for individual labels */
+#define MNT_NOATIME	0x10000000	/* disable update of file access time */
+
+/* backwards compatibility only */
+#define MNT_UNKNOWNPERMISSIONS MNT_IGNORE_OWNERSHIP
+
+
+/*
+ * XXX I think that this could now become (~(MNT_CMDFLAGS))
+ * but the 'mount' program may need changing to handle this.
+ */
+#define	MNT_VISFLAGMASK	(MNT_RDONLY	| MNT_SYNCHRONOUS | MNT_NOEXEC	| \
+			MNT_NOSUID	| MNT_NODEV	| MNT_UNION	| \
+			MNT_ASYNC	| MNT_EXPORTED	| MNT_QUARANTINE | \
+			MNT_LOCAL	| MNT_QUOTA | \
+			MNT_ROOTFS	| MNT_DOVOLFS	| MNT_DONTBROWSE | \
+			MNT_IGNORE_OWNERSHIP | MNT_AUTOMOUNTED | MNT_JOURNALED | \
+			MNT_NOUSERXATTR | MNT_DEFWRITE	| MNT_MULTILABEL | \
+			MNT_NOATIME | MNT_CPROTECT)
+/*
+ * External filesystem command modifier flags.
+ * Unmount can use the MNT_FORCE flag.
+ * XXX These are not STATES and really should be somewhere else.
+ * External filesystem control flags.
+ */
+#define	MNT_UPDATE	0x00010000	/* not a real mount, just an update */
+#define	MNT_NOBLOCK	0x00020000	/* don't block unmount if not responding */
+#define	MNT_RELOAD	0x00040000	/* reload filesystem data */
+#define	MNT_FORCE	0x00080000	/* force unmount or readonly change */
+#define MNT_CMDFLAGS	(MNT_UPDATE|MNT_NOBLOCK|MNT_RELOAD|MNT_FORCE)
+
+
+
+/*
+ * Sysctl CTL_VFS definitions.
+ *
+ * Second level identifier specifies which filesystem. Second level
+ * identifier VFS_GENERIC returns information about all filesystems.
+ */
+#define	VFS_GENERIC		0	/* generic filesystem information */
+#define VFS_NUMMNTOPS		1	/* int: total num of vfs mount/unmount operations */
+/*
+ * Third level identifiers for VFS_GENERIC are given below; third
+ * level identifiers for specific filesystems are given in their
+ * mount specific header files.
+ */
+#define VFS_MAXTYPENUM	1	/* int: highest defined filesystem type */
+#define VFS_CONF	2	/* struct: vfsconf for filesystem given
+				   as next argument */
+
+/*
+ * Flags for various system call interfaces.
+ *
+ * waitfor flags to vfs_sync() and getfsstat()
+ */
+#define MNT_WAIT	1	/* synchronized I/O file integrity completion */
+#define MNT_NOWAIT	2	/* start all I/O, but do not wait for it */
+#define	MNT_DWAIT	4	/* synchronized I/O data integrity completion */
+
+
+struct mount;
+typedef struct mount * mount_t;
+struct vnode;
+typedef struct vnode * vnode_t;
+
+/* Reserved fields preserve binary compatibility */
+struct vfsconf {
+	uint32_t vfc_reserved1;		/* opaque */
+	char	vfc_name[MFSNAMELEN];	/* filesystem type name */
+	int	vfc_typenum;		/* historic filesystem type number */
+	int	vfc_refcount;		/* number mounted of this type */
+	int	vfc_flags;		/* permanent flags */
+	uint32_t vfc_reserved2;		/* opaque */
+	uint32_t vfc_reserved3;		/* opaque */
+};
+
+struct vfsidctl {
+	int		vc_vers;	/* should be VFSIDCTL_VERS1 (below) */
+	fsid_t		vc_fsid;	/* fsid to operate on. */
+	void		*vc_ptr;	/* pointer to data structure. */
+	size_t		vc_len;		/* sizeof said structure. */
+	u_int32_t	vc_spare[12];	/* spare (must be zero). */
+};
+
+
+/* vfsidctl API version. */
+#define VFS_CTL_VERS1	0x01
+
+
+/*
+ * New style VFS sysctls, do not reuse/conflict with the namespace for
+ * private sysctls.
+ */
+#define VFS_CTL_STATFS	0x00010001	/* statfs */
+#define VFS_CTL_UMOUNT	0x00010002	/* unmount */
+#define VFS_CTL_QUERY	0x00010003	/* anything wrong? (vfsquery) */
+#define VFS_CTL_NEWADDR	0x00010004	/* reconnect to new address */
+#define VFS_CTL_TIMEO	0x00010005	/* set timeout for vfs notification */
+#define VFS_CTL_NOLOCKS	0x00010006	/* disable file locking */
+#define VFS_CTL_SADDR	0x00010007	/* get server address */
+#define VFS_CTL_DISC    0x00010008	/* server disconnected */
+#define VFS_CTL_SERVERINFO  0x00010009  /* information about fs server */
+#define VFS_CTL_NSTATUS 0x0001000A	/* netfs mount status */
+
+struct vfsquery {
+	u_int32_t	vq_flags;
+	u_int32_t	vq_spare[31];
+};
+
+struct vfs_server {
+     int32_t  vs_minutes;                       /* minutes until server goes down. */
+     u_int8_t vs_server_name[MAXHOSTNAMELEN*3]; /* UTF8 server name to display (null terminated) */
+};
+
+/*
+ * NetFS mount status - returned by VFS_CTL_NSTATUS
+ */
+struct netfs_status {
+	u_int32_t	ns_status;		// Current status of mount (vfsquery flags)
+	char		ns_mountopts[512];	// Significant mount options
+	uint32_t	ns_waittime;		// Time waiting for reply (sec)
+	uint32_t	ns_threadcount;		// Number of threads blocked on network calls
+	uint64_t	ns_threadids[0];	// Thread IDs of those blocked threads
+};
+
+/* vfsquery flags */
+#define VQ_NOTRESP	0x0001	/* server down */
+#define VQ_NEEDAUTH	0x0002	/* server bad auth */
+#define VQ_LOWDISK	0x0004	/* we're low on space */
+#define VQ_MOUNT	0x0008	/* new filesystem arrived */
+#define VQ_UNMOUNT	0x0010	/* filesystem has left */
+#define VQ_DEAD		0x0020	/* filesystem is dead, needs force unmount */
+#define VQ_ASSIST	0x0040	/* filesystem needs assistance from external program */
+#define VQ_NOTRESPLOCK	0x0080	/* server lockd down */
+#define VQ_UPDATE	0x0100	/* filesystem information has changed */
+#define VQ_VERYLOWDISK	0x0200	/* file system has *very* little disk space left */
+#define VQ_SYNCEVENT	0x0400	/* a sync just happened (not set by kernel starting Mac OS X 10.9) */
+#define VQ_SERVEREVENT  0x0800  /* server issued notification/warning */
+#define VQ_FLAG1000	0x1000	/* placeholder */
+#define VQ_FLAG2000	0x2000	/* placeholder */
+#define VQ_FLAG4000	0x4000	/* placeholder */
+#define VQ_FLAG8000	0x8000	/* placeholder */
+
+
+
+
+/*
+ * Generic file handle
+ */
+#define	NFS_MAX_FH_SIZE		NFSV4_MAX_FH_SIZE
+#define	NFSV4_MAX_FH_SIZE	128
+#define	NFSV3_MAX_FH_SIZE	64
+#define	NFSV2_MAX_FH_SIZE	32
+struct fhandle {
+	int		fh_len;				/* length of file handle */
+	unsigned char	fh_data[NFS_MAX_FH_SIZE];	/* file handle value */
+};
+typedef struct fhandle	fhandle_t;
+
+
+__BEGIN_DECLS
+int	fhopen(const struct fhandle *, int);
+int	fstatfs(int, struct statfs *) __DARWIN_INODE64(fstatfs);
+#if !__DARWIN_ONLY_64_BIT_INO_T
+int	fstatfs64(int, struct statfs64 *) __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5,__MAC_10_6,__IPHONE_NA,__IPHONE_NA);
+#endif /* !__DARWIN_ONLY_64_BIT_INO_T */
+int	getfh(const char *, fhandle_t *);
+int	getfsstat(struct statfs *, int, int) __DARWIN_INODE64(getfsstat);
+#if !__DARWIN_ONLY_64_BIT_INO_T
+int	getfsstat64(struct statfs64 *, int, int) __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5,__MAC_10_6,__IPHONE_NA,__IPHONE_NA);
+#endif /* !__DARWIN_ONLY_64_BIT_INO_T */
+int	getmntinfo(struct statfs **, int) __DARWIN_INODE64(getmntinfo);
+#if !__DARWIN_ONLY_64_BIT_INO_T
+int	getmntinfo64(struct statfs64 **, int) __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5,__MAC_10_6,__IPHONE_NA,__IPHONE_NA);
+#endif /* !__DARWIN_ONLY_64_BIT_INO_T */
+int	mount(const char *, const char *, int, void *);
+int	statfs(const char *, struct statfs *) __DARWIN_INODE64(statfs);
+#if !__DARWIN_ONLY_64_BIT_INO_T
+int	statfs64(const char *, struct statfs64 *) __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5,__MAC_10_6,__IPHONE_NA,__IPHONE_NA);
+#endif /* !__DARWIN_ONLY_64_BIT_INO_T */
+int	unmount(const char *, int);
+int	getvfsbyname(const char *, struct vfsconf *);
+__END_DECLS
+
+#endif /* !_SYS_MOUNT_H_ */
diff -Nur cctools-877.5/include/sys/msg.h cctools-877.5-AnV/include/sys/msg.h
--- cctools-877.5/include/sys/msg.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/msg.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,227 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*	$NetBSD: msg.h,v 1.4 1994/06/29 06:44:43 cgd Exp $	*/
+
+/*
+ * SVID compatible msg.h file
+ *
+ * Author:  Daniel Boulet
+ *
+ * Copyright 1993 Daniel Boulet and RTMX Inc.
+ *
+ * This system call was implemented by Daniel Boulet under contract from RTMX.
+ *
+ * Redistribution and use in source forms, with and without modification,
+ * are permitted provided that this entire comment appears intact.
+ *
+ * Redistribution in binary form may occur without any restrictions.
+ * Obviously, it would be nice if you gave credit where credit is due
+ * but requiring it would be too onerous.
+ *
+ * This software is provided ``AS IS'' without any warranties of any kind.
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+#ifndef _SYS_MSG_H_
+#define _SYS_MSG_H_
+
+#include <sys/appleapiopts.h>
+
+#include <sys/_types.h>
+#include <sys/cdefs.h>
+
+/*
+ * [XSI] All of the symbols from <sys/ipc.h> SHALL be defined when this
+ * header is included
+ */
+#include <sys/ipc.h>
+
+
+/*
+ * [XSI] The pid_t, time_t, key_t, size_t, and ssize_t types shall be
+ * defined as described in <sys/types.h>.
+ *
+ * NOTE:	The definition of the key_t type is implicit from the
+ *		inclusion of <sys/ipc.h>
+ */
+#include <sys/_types/_pid_t.h>
+#include <sys/_types/_time_t.h>
+#include <sys/_types/_size_t.h>
+#include <sys/_types/_ssize_t.h>
+
+/* [XSI] Used for the number of messages in the message queue */
+typedef unsigned long		msgqnum_t;
+
+/* [XSI] Used for the number of bytes allowed in a message queue */
+typedef unsigned long		msglen_t;
+
+/*
+ * Possible values for the fifth parameter to msgrcv(), in addition to the
+ * IPC_NOWAIT flag, which is permitted.
+ */
+#define MSG_NOERROR	010000		/* [XSI] No error if big message */
+
+
+/*
+ * Technically, we should force all code references to the new structure
+ * definition, not in just the standards conformance case, and leave the
+ * legacy interface there for binary compatibility only.  Currently, we
+ * are only forcing this for programs requesting standards conformance.
+ */
+#if __DARWIN_UNIX03 || defined(KERNEL)
+#pragma pack(4)
+/*
+ * Structure used internally.
+ * 
+ * Structure whose address is passed as the third parameter to msgctl()
+ * when the second parameter is IPC_SET or IPC_STAT.  In the case of the
+ * IPC_SET command, only the msg_perm.{uid|gid|perm} and msg_qbytes are
+ * honored.  In the case of IPC_STAT, only the fields indicated as [XSI]
+ * mandated fields are guaranteed to meaningful: DO NOT depend on the
+ * contents of the other fields.
+ *
+ * NOTES:	Reserved fields are not preserved across IPC_SET/IPC_STAT.
+ */
+#if (defined(_POSIX_C_SOURCE) && !defined(_DARWIN_C_SOURCE))
+struct msqid_ds
+#else
+#define	msqid_ds	__msqid_ds_new
+struct __msqid_ds_new
+#endif
+{
+	struct __ipc_perm_new	msg_perm; /* [XSI] msg queue permissions */
+	__int32_t	msg_first;	/* RESERVED: kernel use only */
+	__int32_t	msg_last;	/* RESERVED: kernel use only */
+	msglen_t	msg_cbytes;	/* # of bytes on the queue */
+	msgqnum_t	msg_qnum;	/* [XSI] number of msgs on the queue */
+	msglen_t	msg_qbytes;	/* [XSI] max bytes on the queue */
+	pid_t		msg_lspid;	/* [XSI] pid of last msgsnd() */
+	pid_t		msg_lrpid;	/* [XSI] pid of last msgrcv() */
+	time_t		msg_stime;	/* [XSI] time of last msgsnd() */
+	__int32_t	msg_pad1;	/* RESERVED: DO NOT USE */
+	time_t		msg_rtime;	/* [XSI] time of last msgrcv() */
+	__int32_t	msg_pad2;	/* RESERVED: DO NOT USE */
+	time_t		msg_ctime;	/* [XSI] time of last msgctl() */
+	__int32_t	msg_pad3;	/* RESERVED: DO NOT USE */
+	__int32_t	msg_pad4[4];	/* RESERVED: DO NOT USE */
+};
+#pragma pack()
+#else	/* !__DARWIN_UNIX03 */
+#define	msqid_ds	__msqid_ds_old
+#endif	/* !__DARWIN_UNIX03 */
+
+#if !__DARWIN_UNIX03
+struct __msqid_ds_old {
+	struct __ipc_perm_old	msg_perm; /* [XSI] msg queue permissions */
+	__int32_t	msg_first;	/* RESERVED: kernel use only */
+	__int32_t	msg_last;	/* RESERVED: kernel use only */
+	msglen_t	msg_cbytes;	/* # of bytes on the queue */
+	msgqnum_t	msg_qnum;	/* [XSI] number of msgs on the queue */
+	msglen_t	msg_qbytes;	/* [XSI] max bytes on the queue */
+	pid_t		msg_lspid;	/* [XSI] pid of last msgsnd() */
+	pid_t		msg_lrpid;	/* [XSI] pid of last msgrcv() */
+	time_t		msg_stime;	/* [XSI] time of last msgsnd() */
+	__int32_t	msg_pad1;	/* RESERVED: DO NOT USE */
+	time_t		msg_rtime;	/* [XSI] time of last msgrcv() */
+	__int32_t	msg_pad2;	/* RESERVED: DO NOT USE */
+	time_t		msg_ctime;	/* [XSI] time of last msgctl() */
+	__int32_t	msg_pad3;	/* RESERVED: DO NOT USE */
+	__int32_t	msg_pad4[4];	/* RESERVED: DO NOT USE */
+};
+#endif	/* !__DARWIN_UNIX03 */
+
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#ifdef __APPLE_API_UNSTABLE
+/* XXX kernel only; protect with macro later */
+
+struct msg {
+	struct msg	*msg_next;	/* next msg in the chain */
+	long		msg_type;	/* type of this message */
+    					/* >0 -> type of this message */
+    					/* 0 -> free header */
+	unsigned short	msg_ts;		/* size of this message */
+	short		msg_spot;	/* location of msg start in buffer */
+	struct label	*label;		/* MAC label */
+};
+
+/*
+ * Example structure describing a message whose address is to be passed as
+ * the second argument to the functions msgrcv() and msgsnd().  The only
+ * actual hard requirement is that the first field be of type long, and
+ * contain the message type.  The user is encouraged to define their own
+ * application specific structure; this definition is included solely for
+ * backward compatability with existing source code.
+ */
+struct mymsg {
+	long	mtype;		/* message type (+ve integer) */
+	char	mtext[1];	/* message body */
+};
+
+/*
+ * Based on the configuration parameters described in an SVR2 (yes, two)
+ * config(1m) man page.
+ *
+ * Each message is broken up and stored in segments that are msgssz bytes
+ * long.  For efficiency reasons, this should be a power of two.  Also,
+ * it doesn't make sense if it is less than 8 or greater than about 256.
+ * Consequently, msginit in kern/sysv_msg.c checks that msgssz is a power of
+ * two between 8 and 1024 inclusive (and panic's if it isn't).
+ */
+struct msginfo {
+	int	msgmax,		/* max chars in a message */
+		msgmni,		/* max message queue identifiers */
+		msgmnb,		/* max chars in a queue */
+		msgtql,		/* max messages in system */
+		msgssz,		/* size of a message segment (see notes above) */
+		msgseg;		/* number of message segments */
+};
+#endif	/* __APPLE_API_UNSTABLE */
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+
+__BEGIN_DECLS
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+int msgsys(int, ...);
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+int msgctl(int, int, struct msqid_ds *) __DARWIN_ALIAS(msgctl);
+int msgget(key_t, int);
+ssize_t msgrcv(int, void *, size_t, long, int) __DARWIN_ALIAS_C(msgrcv);
+int msgsnd(int, const void *, size_t, int) __DARWIN_ALIAS_C(msgsnd);
+__END_DECLS
+
+
+#endif /* !_SYS_MSG_H_ */
+
+
diff -Nur cctools-877.5/include/sys/msgbuf.h cctools-877.5-AnV/include/sys/msgbuf.h
--- cctools-877.5/include/sys/msgbuf.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/msgbuf.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,79 @@
+/*
+ * Copyright (c) 2000-2010 Apple, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1981, 1984, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)msgbuf.h	8.1 (Berkeley) 6/2/93
+ */
+#ifndef	_SYS_MSGBUF_H_
+#define _SYS_MSGBUF_H_
+
+#include <sys/cdefs.h>
+
+#define	MAX_MSG_BSIZE	(1*1024*1024)
+struct	msgbuf {
+#define	MSG_MAGIC	0x063061
+	int		msg_magic;
+	int		msg_size;
+	int		msg_bufx;		/* write pointer */
+	int		msg_bufr;		/* read pointer */
+	char	*msg_bufc;		/* buffer */
+};
+
+
+#endif	/* !_SYS_MSGBUF_H_ */
diff -Nur cctools-877.5/include/sys/netport.h cctools-877.5-AnV/include/sys/netport.h
--- cctools-877.5/include/sys/netport.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/netport.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,53 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/* 
+ * Copyright (c) 1987,1988,1989 Carnegie-Mellon University All rights reserved.
+ */
+#ifndef	_SYS_NETPORT_H_
+#define _SYS_NETPORT_H_
+
+typedef uint32_t	netaddr_t;
+
+/*
+ * Network Port structure.
+ */
+typedef struct {
+    long	np_uid_high;
+    long	np_uid_low;
+} np_uid_t;
+
+typedef struct {
+    netaddr_t	np_receiver;
+    netaddr_t	np_owner;
+    np_uid_t	np_puid;
+    np_uid_t	np_sid;
+} network_port_t;
+
+#endif	/* !_SYS_NETPORT_H_ */
+
diff -Nur cctools-877.5/include/sys/param.h cctools-877.5-AnV/include/sys/param.h
--- cctools-877.5/include/sys/param.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/param.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,253 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995, 1997 Apple Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1989, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)param.h	8.3 (Berkeley) 4/4/95
+ */
+
+#ifndef	_SYS_PARAM_H_
+#define _SYS_PARAM_H_
+
+#define	BSD	199506		/* System version (year & month). */
+#define BSD4_3	1
+#define BSD4_4	1
+
+#define NeXTBSD	1995064		/* NeXTBSD version (year, month, release) */
+#define NeXTBSD4_0 0		/* NeXTBSD 4.0 */
+
+#include <sys/_types.h>
+#include <sys/_types/_null.h>
+
+#ifndef LOCORE
+#include <sys/types.h>
+#endif
+
+/*
+ * Machine-independent constants (some used in following include files).
+ * Redefined constants are from POSIX 1003.1 limits file.
+ *
+ * MAXCOMLEN should be >= sizeof(ac_comm) (see <acct.h>)
+ * MAXLOGNAME should be >= UT_NAMESIZE (see <utmp.h>)
+ */
+#include <sys/syslimits.h>
+
+#define	MAXCOMLEN	16		/* max command name remembered */
+#define	MAXINTERP	64		/* max interpreter file name length */
+#define	MAXLOGNAME	255		/* max login name length */
+#define	MAXUPRC		CHILD_MAX	/* max simultaneous processes */
+#define	NCARGS		ARG_MAX		/* max bytes for an exec function */
+#define	NGROUPS		NGROUPS_MAX	/* max number groups */
+#define	NOFILE		256		/* default max open files per process */
+#define	NOGROUP		65535		/* marker for empty group set member */
+#define MAXHOSTNAMELEN	256		/* max hostname size */
+#define MAXDOMNAMELEN	256		/* maximum domain name length */
+
+/* Machine type dependent parameters. */
+#include <machine/param.h>
+
+/* More types and definitions used throughout the kernel. */
+#include <limits.h>
+
+/* Signals. */
+#include <sys/signal.h>
+
+/*
+ * Priorities.  Note that with 32 run queues, differences less than 4 are
+ * insignificant.
+ */
+#define	PSWP	0
+#define	PVM	4
+#define	PINOD	8
+#define	PRIBIO	16
+#define	PVFS	20
+#define	PZERO	22		/* No longer magic, shouldn't be here.  XXX */
+#define	PSOCK	24
+#define	PWAIT	32
+#define	PLOCK	36
+#define	PPAUSE	40
+#define	PUSER	50
+#define	MAXPRI	127		/* Priorities range from 0 through MAXPRI. */
+
+#define	PRIMASK	0x0ff
+#define	PCATCH	0x100		/* OR'd with pri for tsleep to check signals */
+#define PTTYBLOCK 0x200		/* for tty SIGTTOU and SIGTTIN blocking */
+#define PDROP	0x400		/* OR'd with pri to stop re-aquistion of mutex upon wakeup */
+#define PSPIN	0x800		/* OR'd with pri to require mutex in spin mode upon wakeup */
+
+#define	NBPW	sizeof(int)	/* number of bytes per word (integer) */
+
+#define	CMASK	022		/* default file mask: S_IWGRP|S_IWOTH */
+#define	NODEV	(dev_t)(-1)	/* non-existent device */
+
+/*
+ * Clustering of hardware pages on machines with ridiculously small
+ * page sizes is done here.  The paging subsystem deals with units of
+ * CLSIZE pte's describing NBPG (from machine/param.h) pages each.
+ */
+#define	CLBYTES		(CLSIZE*NBPG)
+#define	CLOFSET		(CLSIZE*NBPG-1)	/* for clusters, like PGOFSET */
+#define	claligned(x)	((((int)(x))&CLOFSET)==0)
+#define	CLOFF		CLOFSET
+#define	CLSHIFT		(PGSHIFT+CLSIZELOG2)
+
+#if CLSIZE==1
+#define	clbase(i)	(i)
+#define	clrnd(i)	(i)
+#else
+/* Give the base virtual address (first of CLSIZE). */
+#define	clbase(i)	((i) &~ (CLSIZE-1))
+/* Round a number of clicks up to a whole cluster. */
+#define	clrnd(i)	(((i) + (CLSIZE-1)) &~ (CLSIZE-1))
+#endif
+
+#define	CBLOCK	64		/* Clist block size, must be a power of 2. */
+#define CBQSIZE	(CBLOCK/NBBY)	/* Quote bytes/cblock - can do better. */
+				/* Data chars/clist. */
+#define	CBSIZE	(CBLOCK - sizeof(struct cblock *) - CBQSIZE)
+#define	CROUND	(CBLOCK - 1)	/* Clist rounding. */
+
+/*
+ * File system parameters and macros.
+ *
+ * The file system is made out of blocks of at most MAXPHYS units, with
+ * smaller units (fragments) only in the last direct block.  MAXBSIZE
+ * primarily determines the size of buffers in the buffer pool.  It may be
+ * made larger than MAXPHYS without any effect on existing file systems;
+ * however making it smaller may make some file systems unmountable.
+ * We set this to track the value of MAX_UPL_TRANSFER_BYTES from
+ * osfmk/mach/memory_object_types.h to bound it at the maximum UPL size.
+ */
+#define	MAXBSIZE	(256 * 4096)
+#define MAXPHYSIO	MAXPHYS
+#define MAXFRAG 	8
+
+#define	MAXPHYSIO_WIRED	(16 * 1024 * 1024)
+
+/*
+ * MAXPATHLEN defines the longest permissable path length after expanding
+ * symbolic links. It is used to allocate a temporary buffer from the buffer
+ * pool in which to do the name expansion, hence should be a power of two,
+ * and must be less than or equal to MAXBSIZE.  MAXSYMLINKS defines the
+ * maximum number of symbolic links that may be expanded in a path name.
+ * It should be set high enough to allow all legitimate uses, but halt
+ * infinite loops reasonably quickly.
+ */
+#define	MAXPATHLEN	PATH_MAX
+#define MAXSYMLINKS	32
+
+/* Bit map related macros. */
+#define	setbit(a,i)	(((char *)(a))[(i)/NBBY] |= 1<<((i)%NBBY))
+#define	clrbit(a,i)	(((char *)(a))[(i)/NBBY] &= ~(1<<((i)%NBBY)))
+#define	isset(a,i)	(((char *)(a))[(i)/NBBY] & (1<<((i)%NBBY)))
+#define	isclr(a,i)	((((char *)(a))[(i)/NBBY] & (1<<((i)%NBBY))) == 0)
+
+/* Macros for counting and rounding. */
+#ifndef howmany
+#define	howmany(x, y)	((((x) % (y)) == 0) ? ((x) / (y)) : (((x) / (y)) + 1))
+#endif
+#define	roundup(x, y)	((((x) % (y)) == 0) ? \
+			(x) : ((x) + ((y) - ((x) % (y)))))
+#define powerof2(x)	((((x)-1)&(x))==0)
+
+/* Macros for min/max. */
+#ifndef MIN
+#define	MIN(a,b) (((a)<(b))?(a):(b))
+#endif /* MIN */
+#ifndef MAX
+#define	MAX(a,b) (((a)>(b))?(a):(b))
+#endif	/* MAX */
+
+/*
+ * Constants for setting the parameters of the kernel memory allocator.
+ *
+ * 2 ** MINBUCKET is the smallest unit of memory that will be
+ * allocated. It must be at least large enough to hold a pointer.
+ *
+ * Units of memory less or equal to MAXALLOCSAVE will permanently
+ * allocate physical memory; requests for these size pieces of
+ * memory are quite fast. Allocations greater than MAXALLOCSAVE must
+ * always allocate and free physical memory; requests for these
+ * size allocations should be done infrequently as they will be slow.
+ *
+ * Constraints: CLBYTES <= MAXALLOCSAVE <= 2 ** (MINBUCKET + 14), and
+ * MAXALLOCSIZE must be a power of two.
+ */
+#define MINBUCKET	4		/* 4 => min allocation of 16 bytes */
+#define MAXALLOCSAVE	(2 * CLBYTES)
+
+/*
+ * Scale factor for scaled integers used to count %cpu time and load avgs.
+ *
+ * The number of CPU `tick's that map to a unique `%age' can be expressed
+ * by the formula (1 / (2 ^ (FSHIFT - 11))).  The maximum load average that
+ * can be calculated (assuming 32 bits) can be closely approximated using
+ * the formula (2 ^ (2 * (16 - FSHIFT))) for (FSHIFT < 15).
+ *
+ * For the scheduler to maintain a 1:1 mapping of CPU `tick' to `%age',
+ * FSHIFT must be at least 11; this gives us a maximum load avg of ~1024.
+ */
+#define	FSHIFT	11		/* bits to right of fixed binary point */
+#define FSCALE	(1<<FSHIFT)
+
+#endif	/* _SYS_PARAM_H_ */
diff -Nur cctools-877.5/include/sys/paths.h cctools-877.5-AnV/include/sys/paths.h
--- cctools-877.5/include/sys/paths.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/paths.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,44 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*	@(#)paths.h	1.0	11/13/00	*/
+
+#ifndef _SYS_PATHS_H_
+#define	_SYS_PATHS_H_
+
+#include <sys/appleapiopts.h>
+
+#ifdef __APPLE_API_PRIVATE
+
+/* Provides support for system wide forks */
+#define _PATH_FORKSPECIFIER    "/..namedfork/"
+#define _PATH_DATANAME         "data"
+#define _PATH_RSRCNAME         "rsrc"
+#define _PATH_RSRCFORKSPEC     "/..namedfork/rsrc"
+
+#endif /* __APPLE_API_PRIVATE */
+#endif /* !_SYS_PATHS_H_ */
diff -Nur cctools-877.5/include/sys/pipe.h cctools-877.5-AnV/include/sys/pipe.h
--- cctools-877.5/include/sys/pipe.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/pipe.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,138 @@
+/*
+ * Copyright (c) 2004-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1996 John S. Dyson
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice immediately at the beginning of the file, without modification,
+ *    this list of conditions, and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. Absolutely no warranty of function or purpose is made by the author
+ *    John S. Dyson.
+ * 4. This work was done expressly for inclusion into FreeBSD.  Other use
+ *    is allowed if this notation is included.
+ * 5. Modifications may be freely made to this file if the above conditions
+ *    are met.
+ *
+ * $FreeBSD: src/sys/sys/pipe.h,v 1.24 2003/08/13 20:01:38 alc Exp $
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2006 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+#ifndef _SYS_PIPE_H_
+#define _SYS_PIPE_H_
+
+#include <sys/queue.h>			/* for TAILQ macros */
+#include <sys/ev.h>
+#include <sys/cdefs.h>
+
+/*
+ * Pipe buffer size, keep moderate in value, pipes take kva space.
+ */
+#ifndef PIPE_SIZE
+#define PIPE_SIZE	16384
+#endif
+
+#define PIPE_KVAMAX	(1024 * 1024 * 16)
+
+#ifndef BIG_PIPE_SIZE
+#define BIG_PIPE_SIZE	(64*1024)
+#endif
+
+#ifndef SMALL_PIPE_SIZE
+#define SMALL_PIPE_SIZE	PAGE_SIZE
+#endif
+
+/*
+ * PIPE_MINDIRECT MUST be smaller than PIPE_SIZE and MUST be bigger
+ * than PIPE_BUF.
+ */
+#ifndef PIPE_MINDIRECT
+#define PIPE_MINDIRECT	8192
+#endif
+
+#define PIPENPAGES	(BIG_PIPE_SIZE / PAGE_SIZE + 1)
+
+/*
+ * Pipe buffer information.
+ * Separate in, out, cnt are used to simplify calculations.
+ * Buffered write is active when the buffer.cnt field is set.
+ */
+struct pipebuf {
+	u_int	cnt;		/* number of chars currently in buffer */
+	u_int	in;		/* in pointer */
+	u_int	out;		/* out pointer */
+	u_int	size;		/* size of buffer */
+	caddr_t	buffer;		/* kva of buffer */
+};
+
+
+#ifdef PIPE_DIRECT
+/*
+ * Information to support direct transfers between processes for pipes.
+ */
+struct pipemapping {
+	vm_offset_t	kva;		/* kernel virtual address */
+	vm_size_t	cnt;		/* number of chars in buffer */
+	vm_size_t	pos;		/* current position of transfer */
+	int		npages;		/* number of pages */
+	vm_page_t	ms[PIPENPAGES];	/* pages in source process */
+};
+#endif
+
+/*
+ * Bits in pipe_state.
+ */
+#define PIPE_ASYNC	0x004	/* Async? I/O. */
+#define PIPE_WANTR	0x008	/* Reader wants some characters. */
+#define PIPE_WANTW	0x010	/* Writer wants space to put characters. */
+#define PIPE_WANT	0x020	/* Pipe is wanted to be run-down. */
+#define PIPE_SEL	0x040	/* Pipe has a select active. */
+#define PIPE_EOF	0x080	/* Pipe is in EOF condition. */
+#define PIPE_LOCKFL	0x100	/* Process has exclusive access to pointers/data. */
+#define PIPE_LWANT	0x200	/* Process wants exclusive access to pointers/data. */
+#define PIPE_DIRECTW	0x400	/* Pipe direct write active. */
+#define PIPE_DIRECTOK	0x800	/* Direct mode ok. */
+#define PIPE_KNOTE	0x1000   /* Pipe has kernel events activated */
+#define PIPE_DRAIN	0x2000  /* Waiting for I/O to drop for a close.  Treated like EOF;
+					only separate for easier debugging. */
+#define PIPE_WSELECT	0x4000  /* Some thread has done an FWRITE select on the pipe */
+#define PIPE_DEAD	0x8000  /* Pipe is dead and needs garbage collection */
+
+
+#endif /* !_SYS_PIPE_H_ */
diff -Nur cctools-877.5/include/sys/poll.h cctools-877.5-AnV/include/sys/poll.h
--- cctools-877.5/include/sys/poll.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/poll.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,119 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*-
+ * Copyright (c) 1997 Peter Wemm <peter@freebsd.org>
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. The name of the author may not be used to endorse or promote products
+ *    derived from this software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ */
+
+#ifndef _SYS_POLL_H_
+#define	_SYS_POLL_H_
+
+/*
+ * This file is intended to be compatible with the traditional poll.h.
+ */
+
+/*
+ * Requestable events.  If poll(2) finds any of these set, they are
+ * copied to revents on return.
+ */
+#define	POLLIN		0x0001		/* any readable data available */
+#define	POLLPRI		0x0002		/* OOB/Urgent readable data */
+#define	POLLOUT		0x0004		/* file descriptor is writeable */
+#define	POLLRDNORM	0x0040		/* non-OOB/URG data available */
+#define	POLLWRNORM	POLLOUT		/* no write type differentiation */
+#define	POLLRDBAND	0x0080		/* OOB/Urgent readable data */
+#define	POLLWRBAND	0x0100		/* OOB/Urgent data can be written */
+
+/*
+ * FreeBSD extensions: polling on a regular file might return one
+ * of these events (currently only supported on local filesystems).
+ */
+#define	POLLEXTEND	0x0200		/* file may have been extended */
+#define	POLLATTRIB	0x0400		/* file attributes may have changed */
+#define	POLLNLINK	0x0800		/* (un)link/rename may have happened */
+#define	POLLWRITE	0x1000		/* file's contents may have changed */
+
+/*
+ * These events are set if they occur regardless of whether they were
+ * requested.
+ */
+#define	POLLERR		0x0008		/* some poll error occurred */
+#define	POLLHUP		0x0010		/* file descriptor was "hung up" */
+#define	POLLNVAL	0x0020		/* requested events "invalid" */
+
+#define	POLLSTANDARD	(POLLIN|POLLPRI|POLLOUT|POLLRDNORM|POLLRDBAND|\
+			 POLLWRBAND|POLLERR|POLLHUP|POLLNVAL)
+
+struct pollfd
+{
+	int     fd;
+	short   events;
+	short   revents;
+};
+
+typedef unsigned int nfds_t;
+
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+
+/*
+ * This is defined here (instead of <poll.h>) because this is where
+ * traditional SVR4 code will look to find it.
+ */
+extern int poll (struct pollfd *, nfds_t, int) __DARWIN_ALIAS_C(poll);
+
+__END_DECLS
+
+
+#endif /* !_SYS_POLL_H_ */
diff -Nur cctools-877.5/include/sys/posix_sem.h cctools-877.5-AnV/include/sys/posix_sem.h
--- cctools-877.5/include/sys/posix_sem.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/posix_sem.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,80 @@
+
+/*
+ * Copyright (c) 1999-2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ *	Copyright (c) 1990, 1996-1998 Apple Computer, Inc.
+ *	All Rights Reserved.
+ */
+/*
+ * posix_shm.c : Support for POSIX semaphore APIs
+ *
+ *	File:	posix_sem.c
+ *	Author:	Ananthakrishna Ramesh
+ *
+ * HISTORY
+ * 2-Sep-1999	A.Ramesh
+ *	Created for MacOSX
+ *
+ */
+
+#ifndef	_SYS_POSIX_SEM_H_
+#define _SYS_POSIX_SEM_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/types.h>
+#include <sys/proc.h>
+
+struct label;
+
+#define	PSEMNAMLEN	31	/* maximum name segment length we bother with */
+
+struct pseminfo {
+	unsigned int	psem_flags;
+	unsigned int	psem_usecount;
+	mode_t		psem_mode;
+	uid_t		psem_uid;
+	gid_t		psem_gid;
+	char		psem_name[PSEMNAMLEN + 1];	/* segment name */
+	void *		psem_semobject;
+	struct label *  psem_label;
+	pid_t		psem_creator_pid;
+	uint64_t	psem_creator_uniqueid;
+};
+
+#define PSEMINFO_NULL (struct pseminfo *)0
+
+#define	PSEM_NONE	1
+#define	PSEM_DEFINED	2
+#define	PSEM_ALLOCATED	4
+#define	PSEM_MAPPED	8
+#define	PSEM_INUSE	0x10
+#define	PSEM_REMOVED	0x20
+#define	PSEM_INCREATE	0x40
+#define	PSEM_INDELETE	0x80
+
+#endif
diff -Nur cctools-877.5/include/sys/posix_shm.h cctools-877.5-AnV/include/sys/posix_shm.h
--- cctools-877.5/include/sys/posix_shm.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/posix_shm.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,82 @@
+/*
+ * Copyright (c) 1999-2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ *	Copyright (c) 1990, 1996-1998 Apple Computer, Inc.
+ *	All Rights Reserved.
+ */
+/*
+ * posix_shm.c : Support for POSIX shared memory APIs
+ *
+ *	File:	posix_shm.c
+ *	Author:	Ananthakrishna Ramesh
+ *
+ * HISTORY
+ * 2-Sep-1999	A.Ramesh
+ *	Created for MacOSX
+ *
+ */
+
+#ifndef	_SYS_POSIX_SHM_H_
+#define _SYS_POSIX_SHM_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/types.h>
+#include <sys/proc.h>
+
+struct label;
+
+#define	PSHMNAMLEN	31	/* maximum name segment length we bother with */
+
+struct pshminfo {
+	unsigned int	pshm_flags;
+	unsigned int	pshm_usecount;
+	off_t		pshm_length;
+	mode_t		pshm_mode;
+	uid_t		pshm_uid;
+	gid_t		pshm_gid;
+	char		pshm_name[PSHMNAMLEN + 1];	/* segment name */
+	void *		pshm_memobject;
+#if DIAGNOSTIC
+	unsigned int 	pshm_readcount;
+	unsigned int 	pshm_writecount;
+	struct proc *	pshm_proc;
+#endif /* DIAGNOSTIC */
+	struct label *	pshm_label;
+};
+#define PSHMINFO_NULL (struct pshminfo *)0
+
+#define	PSHM_NONE	1
+#define	PSHM_DEFINED	2
+#define	PSHM_ALLOCATED	4
+#define	PSHM_MAPPED	8
+#define	PSHM_INUSE	0x10
+#define	PSHM_REMOVED	0x20
+#define	PSHM_INCREATE	0x40
+#define	PSHM_INDELETE	0x80
+
+#endif
diff -Nur cctools-877.5/include/sys/proc.h cctools-877.5-AnV/include/sys/proc.h
--- cctools-877.5/include/sys/proc.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/proc.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,223 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995, 1997 Apple Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1986, 1989, 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)proc.h	8.15 (Berkeley) 5/19/95
+ */
+
+#ifndef _SYS_PROC_H_
+#define	_SYS_PROC_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/select.h>			/* For struct selinfo. */
+#include <sys/queue.h>
+#include <sys/lock.h>
+#include <sys/param.h>
+#include <sys/event.h>
+#include <mach/boolean.h>
+
+
+struct session;
+struct pgrp;
+struct proc;
+
+/* Exported fields for kern sysctls */
+struct extern_proc {
+	union {
+		struct {
+			struct	proc *__p_forw;	/* Doubly-linked run/sleep queue. */
+			struct	proc *__p_back;
+		} p_st1;
+		struct timeval __p_starttime; 	/* process start time */
+	} p_un;
+#define p_forw p_un.p_st1.__p_forw
+#define p_back p_un.p_st1.__p_back
+#define p_starttime p_un.__p_starttime
+	struct	vmspace *p_vmspace;	/* Address space. */
+	struct	sigacts *p_sigacts;	/* Signal actions, state (PROC ONLY). */
+	int	p_flag;			/* P_* flags. */
+	char	p_stat;			/* S* process status. */
+	pid_t	p_pid;			/* Process identifier. */
+	pid_t	p_oppid;	 /* Save parent pid during ptrace. XXX */
+	int	p_dupfd;	 /* Sideways return value from fdopen. XXX */
+	/* Mach related  */
+	caddr_t user_stack;	/* where user stack was allocated */
+	void	*exit_thread;	/* XXX Which thread is exiting? */
+	int		p_debugger;		/* allow to debug */
+	boolean_t	sigwait;	/* indication to suspend */
+	/* scheduling */
+	u_int	p_estcpu;	 /* Time averaged value of p_cpticks. */
+	int	p_cpticks;	 /* Ticks of cpu time. */
+	fixpt_t	p_pctcpu;	 /* %cpu for this process during p_swtime */
+	void	*p_wchan;	 /* Sleep address. */
+	char	*p_wmesg;	 /* Reason for sleep. */
+	u_int	p_swtime;	 /* Time swapped in or out. */
+	u_int	p_slptime;	 /* Time since last blocked. */
+	struct	itimerval p_realtimer;	/* Alarm timer. */
+	struct	timeval p_rtime;	/* Real time. */
+	u_quad_t p_uticks;		/* Statclock hits in user mode. */
+	u_quad_t p_sticks;		/* Statclock hits in system mode. */
+	u_quad_t p_iticks;		/* Statclock hits processing intr. */
+	int	p_traceflag;		/* Kernel trace points. */
+	struct	vnode *p_tracep;	/* Trace to vnode. */
+	int	p_siglist;		/* DEPRECATED. */
+	struct	vnode *p_textvp;	/* Vnode of executable. */
+	int	p_holdcnt;		/* If non-zero, don't swap. */
+	sigset_t p_sigmask;	/* DEPRECATED. */
+	sigset_t p_sigignore;	/* Signals being ignored. */
+	sigset_t p_sigcatch;	/* Signals being caught by user. */
+	u_char	p_priority;	/* Process priority. */
+	u_char	p_usrpri;	/* User-priority based on p_cpu and p_nice. */
+	char	p_nice;		/* Process "nice" value. */
+	char	p_comm[MAXCOMLEN+1];
+	struct 	pgrp *p_pgrp;	/* Pointer to process group. */
+	struct	user *p_addr;	/* Kernel virtual addr of u-area (PROC ONLY). */
+	u_short	p_xstat;	/* Exit status for wait; also stop signal. */
+	u_short	p_acflag;	/* Accounting flags. */
+	struct	rusage *p_ru;	/* Exit information. XXX */
+};
+
+
+/* Status values. */
+#define	SIDL	1		/* Process being created by fork. */
+#define	SRUN	2		/* Currently runnable. */
+#define	SSLEEP	3		/* Sleeping on an address. */
+#define	SSTOP	4		/* Process debugging or suspension. */
+#define	SZOMB	5		/* Awaiting collection by parent. */
+
+/* These flags are kept in extern_proc.p_flag. */
+#define	P_ADVLOCK	0x00000001	/* Process may hold POSIX adv. lock */
+#define	P_CONTROLT	0x00000002	/* Has a controlling terminal */
+#define	P_LP64		0x00000004	/* Process is LP64 */
+#define	P_NOCLDSTOP	0x00000008	/* No SIGCHLD when children stop */
+
+#define	P_PPWAIT	0x00000010	/* Parent waiting for chld exec/exit */
+#define	P_PROFIL	0x00000020	/* Has started profiling */
+#define	P_SELECT	0x00000040	/* Selecting; wakeup/waiting danger */
+#define	P_CONTINUED	0x00000080	/* Process was stopped and continued */
+
+#define	P_SUGID		0x00000100	/* Has set privileges since last exec */
+#define	P_SYSTEM	0x00000200	/* Sys proc: no sigs, stats or swap */
+#define	P_TIMEOUT	0x00000400	/* Timing out during sleep */
+#define	P_TRACED	0x00000800	/* Debugged process being traced */
+
+#define	P_DISABLE_ASLR	0x00001000	/* Disable address space layout randomization */
+#define	P_WEXIT		0x00002000	/* Working on exiting */
+#define	P_EXEC		0x00004000	/* Process called exec. */
+
+/* Should be moved to machine-dependent areas. */
+#define	P_OWEUPC	0x00008000	/* Owe process an addupc() call at next ast. */
+
+#define	P_AFFINITY	0x00010000	/* xxx */
+#define	P_TRANSLATED	0x00020000	/* xxx */
+#define	P_CLASSIC	P_TRANSLATED	/* xxx */
+/*
+#define	P_FSTRACE	0x10000	/ * tracing via file system (elsewhere?) * /
+#define	P_SSTEP		0x20000	/ * process needs single-step fixup ??? * /
+*/
+
+#define	P_DELAYIDLESLEEP 0x00040000	/* Process is marked to delay idle sleep on disk IO */
+#define	P_CHECKOPENEVT 	0x00080000	/* check if a vnode has the OPENEVT flag set on open */
+
+#define	P_DEPENDENCY_CAPABLE	0x00100000	/* process is ok to call vfs_markdependency() */
+#define	P_REBOOT	0x00200000	/* Process called reboot() */
+#define	P_RESV6		0x00400000	/* used to be P_TBE */
+#define	P_RESV7		0x00800000	/* (P_SIGEXC)signal exceptions */
+
+#define	P_THCWD		0x01000000	/* process has thread cwd  */
+#define	P_RESV9		0x02000000	/* (P_VFORK)process has vfork children */
+#define	P_RESV10 	0x04000000	/* used to be P_NOATTACH */
+#define	P_RESV11	0x08000000	/* (P_INVFORK) proc in vfork */
+
+#define	P_NOSHLIB	0x10000000	/* no shared libs are in use for proc */
+					/* flag set on exec */
+#define	P_FORCEQUOTA	0x20000000	/* Force quota for root */
+#define	P_NOCLDWAIT	0x40000000	/* No zombies when chil procs exit */
+#define	P_NOREMOTEHANG	0x80000000	/* Don't hang on remote FS ops */
+
+#define	P_INMEM		0		/* Obsolete: retained for compilation */
+#define	P_NOSWAP	0		/* Obsolete: retained for compilation */
+#define	P_PHYSIO	0		/* Obsolete: retained for compilation */
+#define	P_FSTRACE	0		/* Obsolete: retained for compilation */
+#define	P_SSTEP		0		/* Obsolete: retained for compilation */
+
+#define P_DIRTY_TRACK                           0x00000001      /* track dirty state */
+#define P_DIRTY_ALLOW_IDLE_EXIT                 0x00000002      /* process can be idle-exited when clean */
+#define P_DIRTY_DEFER                           0x00000004      /* defer initial opt-in to idle-exit */
+#define P_DIRTY                                 0x00000008      /* process is dirty */
+#define P_DIRTY_SHUTDOWN                        0x00000010      /* process is dirty during shutdown */
+#define P_DIRTY_TERMINATED                      0x00000020      /* process has been marked for termination */
+#define P_DIRTY_BUSY                            0x00000040      /* serialization flag */
+#define P_DIRTY_MARKED                          0x00000080      /* marked dirty previously */
+#define P_DIRTY_DEFER_IN_PROGRESS               0x00000100      /* deferral to idle-band in process */
+#define P_DIRTY_LAUNCH_IN_PROGRESS              0x00000200      /* launch is in progress */
+
+#define P_DIRTY_IS_DIRTY                        (P_DIRTY | P_DIRTY_SHUTDOWN)
+#define P_DIRTY_IDLE_EXIT_ENABLED               (P_DIRTY_TRACK|P_DIRTY_ALLOW_IDLE_EXIT)
+
+
+
+
+#endif	/* !_SYS_PROC_H_ */
diff -Nur cctools-877.5/include/sys/proc_info.h cctools-877.5-AnV/include/sys/proc_info.h
--- cctools-877.5/include/sys/proc_info.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/proc_info.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,730 @@
+/*
+ * Copyright (c) 2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _SYS_PROC_INFO_H
+#define _SYS_PROC_INFO_H
+
+#include <sys/cdefs.h>
+#include <sys/param.h>
+#include <sys/types.h>
+#include <sys/stat.h>
+#include <sys/mount.h>
+#include <sys/socket.h>
+#include <sys/un.h>
+#include <sys/kern_control.h>
+#include <net/if.h>
+#include <net/route.h>
+#include <netinet/in.h>
+#include <netinet/tcp.h>
+#include <mach/machine.h>
+
+__BEGIN_DECLS
+
+
+#define PROC_ALL_PIDS		1
+#define PROC_PGRP_ONLY		2
+#define PROC_TTY_ONLY		3
+#define PROC_UID_ONLY		4
+#define PROC_RUID_ONLY		5
+#define PROC_PPID_ONLY		6
+
+struct proc_bsdinfo {
+	uint32_t		pbi_flags;		/* 64bit; emulated etc */
+	uint32_t		pbi_status;
+	uint32_t		pbi_xstatus;
+	uint32_t		pbi_pid;
+	uint32_t		pbi_ppid;
+	uid_t			pbi_uid;
+	gid_t			pbi_gid;
+	uid_t			pbi_ruid;
+	gid_t			pbi_rgid;
+	uid_t			pbi_svuid;
+	gid_t			pbi_svgid;
+	uint32_t		rfu_1;			/* reserved */
+	char			pbi_comm[MAXCOMLEN];
+	char			pbi_name[2*MAXCOMLEN];	/* empty if no name is registered */
+	uint32_t		pbi_nfiles;
+	uint32_t		pbi_pgid;
+	uint32_t		pbi_pjobc;
+	uint32_t		e_tdev;			/* controlling tty dev */
+	uint32_t		e_tpgid;		/* tty process group id */
+	int32_t			pbi_nice;
+	uint64_t		pbi_start_tvsec;
+	uint64_t		pbi_start_tvusec;
+};
+
+
+struct proc_bsdshortinfo {
+        uint32_t                pbsi_pid;		/* process id */
+        uint32_t                pbsi_ppid;		/* process parent id */
+        uint32_t                pbsi_pgid;		/* process perp id */
+	uint32_t                pbsi_status;		/* p_stat value, SZOMB, SRUN, etc */
+	char                    pbsi_comm[MAXCOMLEN];	/* upto 16 characters of process name */
+	uint32_t                pbsi_flags;              /* 64bit; emulated etc */
+        uid_t                   pbsi_uid;		/* current uid on process */
+        gid_t                   pbsi_gid;		/* current gid on process */
+        uid_t                   pbsi_ruid;		/* current ruid on process */
+        gid_t                   pbsi_rgid;		/* current tgid on process */
+        uid_t                   pbsi_svuid;		/* current svuid on process */
+        gid_t                   pbsi_svgid;		/* current svgid on process */
+        uint32_t                pbsi_rfu;		/* reserved for future use*/
+};
+
+
+
+
+/* pbi_flags values */
+#define PROC_FLAG_SYSTEM	1	/*  System process */
+#define PROC_FLAG_TRACED	2	/* process currently being traced, possibly by gdb */
+#define PROC_FLAG_INEXIT	4	/* process is working its way in exit() */
+#define PROC_FLAG_PPWAIT	8
+#define PROC_FLAG_LP64		0x10	/* 64bit process */
+#define PROC_FLAG_SLEADER	0x20	/* The process is the session leader */
+#define PROC_FLAG_CTTY		0x40	/* process has a control tty */
+#define PROC_FLAG_CONTROLT	0x80	/* Has a controlling terminal */
+#define PROC_FLAG_THCWD		0x100	/* process has a thread with cwd */
+/* process control bits for resource starvation */
+#define PROC_FLAG_PC_THROTTLE	0x200	/* In resource starvation situations, this process is to be throttled */
+#define PROC_FLAG_PC_SUSP	0x400	/* In resource starvation situations, this process is to be suspended */
+#define PROC_FLAG_PC_KILL	0x600	/* In resource starvation situations, this process is to be terminated */
+#define PROC_FLAG_PC_MASK	0x600
+/* process action bits for resource starvation */
+#define PROC_FLAG_PA_THROTTLE	0x800	/* The process is currently throttled due to resource starvation */
+#define PROC_FLAG_PA_SUSP	0x1000	/* The process is currently suspended due to resource starvation */
+#define PROC_FLAG_PSUGID        0x2000	 /* process has set privileges since last exec */
+#define PROC_FLAG_EXEC		0x4000	 /* process has called exec  */
+
+
+struct proc_taskinfo {
+	uint64_t		pti_virtual_size;	/* virtual memory size (bytes) */
+	uint64_t		pti_resident_size;	/* resident memory size (bytes) */
+	uint64_t		pti_total_user;		/* total time */
+	uint64_t		pti_total_system;
+	uint64_t		pti_threads_user;	/* existing threads only */
+	uint64_t		pti_threads_system;
+	int32_t			pti_policy;		/* default policy for new threads */
+	int32_t			pti_faults;		/* number of page faults */
+	int32_t			pti_pageins;		/* number of actual pageins */
+	int32_t			pti_cow_faults;		/* number of copy-on-write faults */
+	int32_t			pti_messages_sent;	/* number of messages sent */
+	int32_t			pti_messages_received;	/* number of messages received */
+	int32_t			pti_syscalls_mach;	/* number of mach system calls */
+	int32_t			pti_syscalls_unix;	/* number of unix system calls */
+	int32_t			pti_csw;          	/* number of context switches */
+	int32_t			pti_threadnum;		/* number of threads in the task */
+	int32_t			pti_numrunning;		/* number of running threads */
+	int32_t			pti_priority;		/* task priority*/
+};
+
+struct proc_taskallinfo {
+	struct proc_bsdinfo	pbsd;
+	struct proc_taskinfo	ptinfo;
+};
+
+#define MAXTHREADNAMESIZE 64
+
+struct proc_threadinfo {
+	uint64_t		pth_user_time;    	/* user run time */
+	uint64_t		pth_system_time;  	/* system run time */
+	int32_t			pth_cpu_usage;    	/* scaled cpu usage percentage */
+	int32_t			pth_policy;		/* scheduling policy in effect */
+	int32_t			pth_run_state;    	/* run state (see below) */
+	int32_t			pth_flags;        	/* various flags (see below) */
+	int32_t			pth_sleep_time;   	/* number of seconds that thread */
+	int32_t			pth_curpri;		/* cur priority*/
+	int32_t			pth_priority;		/*  priority*/
+	int32_t			pth_maxpriority;	/* max priority*/
+	char			pth_name[MAXTHREADNAMESIZE];	/* thread name, if any */
+};
+
+struct proc_regioninfo {
+	uint32_t		pri_protection;
+	uint32_t		pri_max_protection;
+	uint32_t		pri_inheritance;
+	uint32_t		pri_flags;		/* shared, external pager, is submap */
+	uint64_t		pri_offset;
+	uint32_t		pri_behavior;
+	uint32_t		pri_user_wired_count;
+	uint32_t		pri_user_tag;
+	uint32_t		pri_pages_resident;
+	uint32_t		pri_pages_shared_now_private;
+	uint32_t		pri_pages_swapped_out;
+	uint32_t		pri_pages_dirtied;
+	uint32_t		pri_ref_count;
+	uint32_t		pri_shadow_depth;
+	uint32_t		pri_share_mode;
+	uint32_t		pri_private_pages_resident;
+	uint32_t		pri_shared_pages_resident;
+	uint32_t		pri_obj_id;
+	uint32_t		pri_depth;
+	uint64_t		pri_address;
+	uint64_t		pri_size;
+};
+
+#define PROC_REGION_SUBMAP	1
+#define PROC_REGION_SHARED	2
+
+#define SM_COW             1
+#define SM_PRIVATE         2
+#define SM_EMPTY           3
+#define SM_SHARED          4
+#define SM_TRUESHARED      5
+#define SM_PRIVATE_ALIASED 6
+#define SM_SHARED_ALIASED  7
+#define SM_LARGE_PAGE      8
+
+
+/*
+ *	Thread run states (state field).
+ */
+
+#define TH_STATE_RUNNING	1	/* thread is running normally */
+#define TH_STATE_STOPPED	2	/* thread is stopped */
+#define TH_STATE_WAITING	3	/* thread is waiting normally */
+#define TH_STATE_UNINTERRUPTIBLE 4	/* thread is in an uninterruptible
+					   wait */
+#define TH_STATE_HALTED		5	/* thread is halted at a
+					   clean point */
+
+/*
+ *	Thread flags (flags field).
+ */
+#define TH_FLAGS_SWAPPED	0x1	/* thread is swapped out */
+#define TH_FLAGS_IDLE		0x2	/* thread is an idle thread */
+
+
+struct proc_workqueueinfo {
+	uint32_t	pwq_nthreads;		/* total number of workqueue threads */
+	uint32_t	pwq_runthreads;		/* total number of running workqueue threads */
+	uint32_t	pwq_blockedthreads;	/* total number of blocked workqueue threads */
+	uint32_t	pwq_state;
+};
+
+/*
+ *	workqueue state (pwq_state field)
+ */
+#define WQ_EXCEEDED_CONSTRAINED_THREAD_LIMIT	0x1
+#define WQ_EXCEEDED_TOTAL_THREAD_LIMIT		0x2
+
+
+struct proc_fileinfo {
+	uint32_t		fi_openflags;
+	uint32_t		fi_status;	
+	off_t			fi_offset;
+	int32_t			fi_type;
+	uint32_t		fi_guardflags;
+};
+
+/* stats flags in proc_fileinfo */
+#define PROC_FP_SHARED	1	/* shared by more than one fd */
+#define PROC_FP_CLEXEC	2	/* close on exec */
+#define PROC_FP_GUARDED	4	/* guarded fd */
+
+#define PROC_FI_GUARD_CLOSE		(1u << 0)
+#define PROC_FI_GUARD_DUP		(1u << 1)
+#define PROC_FI_GUARD_SOCKET_IPC	(1u << 2)
+#define PROC_FI_GUARD_FILEPORT		(1u << 3)
+
+/*
+ * A copy of stat64 with static sized fields.
+ */
+struct vinfo_stat {
+	uint32_t	vst_dev;	/* [XSI] ID of device containing file */
+	uint16_t	vst_mode;	/* [XSI] Mode of file (see below) */
+	uint16_t	vst_nlink;	/* [XSI] Number of hard links */
+	uint64_t	vst_ino;	/* [XSI] File serial number */
+	uid_t		vst_uid;	/* [XSI] User ID of the file */
+	gid_t		vst_gid;	/* [XSI] Group ID of the file */
+	int64_t		vst_atime;	/* [XSI] Time of last access */
+	int64_t		vst_atimensec;	/* nsec of last access */
+	int64_t		vst_mtime;	/* [XSI] Last data modification time */
+	int64_t		vst_mtimensec;	/* last data modification nsec */
+	int64_t		vst_ctime;	/* [XSI] Time of last status change */
+	int64_t		vst_ctimensec;	/* nsec of last status change */
+	int64_t		vst_birthtime;	/*  File creation time(birth)  */
+	int64_t		vst_birthtimensec;	/* nsec of File creation time */
+	off_t		vst_size;	/* [XSI] file size, in bytes */
+	int64_t		vst_blocks;	/* [XSI] blocks allocated for file */
+	int32_t		vst_blksize;	/* [XSI] optimal blocksize for I/O */
+	uint32_t	vst_flags;	/* user defined flags for file */
+	uint32_t	vst_gen;	/* file generation number */
+	uint32_t	vst_rdev;	/* [XSI] Device ID */
+	int64_t		vst_qspare[2];	/* RESERVED: DO NOT USE! */
+};
+
+struct vnode_info {
+	struct vinfo_stat	vi_stat;
+	int			vi_type;
+	int			vi_pad;
+	fsid_t			vi_fsid;
+};
+
+struct vnode_info_path {
+	struct vnode_info	vip_vi;
+	char			vip_path[MAXPATHLEN];	/* tail end of it  */
+};
+
+struct vnode_fdinfo {
+	struct proc_fileinfo	pfi;
+	struct vnode_info	pvi;
+};
+
+struct vnode_fdinfowithpath {
+	struct proc_fileinfo	pfi;
+	struct vnode_info_path	pvip;
+};
+
+struct proc_regionwithpathinfo {
+	struct proc_regioninfo	prp_prinfo;
+	struct vnode_info_path	prp_vip;
+};
+
+struct proc_vnodepathinfo {
+	struct vnode_info_path	pvi_cdir;
+	struct vnode_info_path	pvi_rdir;
+};
+
+struct proc_threadwithpathinfo {
+	struct proc_threadinfo	pt;
+	struct vnode_info_path	pvip;
+};
+
+/*
+ *  Socket 
+ */
+
+
+/*
+ * IPv4 and IPv6 Sockets
+ */
+
+#define INI_IPV4        0x1
+#define INI_IPV6        0x2
+
+struct in4in6_addr {
+	u_int32_t		i46a_pad32[3];
+	struct in_addr		i46a_addr4;
+};
+
+struct in_sockinfo {
+	int					insi_fport;		/* foreign port */
+	int					insi_lport;		/* local port */
+	uint64_t				insi_gencnt;		/* generation count of this instance */
+	uint32_t				insi_flags;		/* generic IP/datagram flags */
+	uint32_t				insi_flow;
+
+	uint8_t					insi_vflag;		/* ini_IPV4 or ini_IPV6 */
+	uint8_t					insi_ip_ttl;		/* time to live proto */
+	uint32_t				rfu_1;			/* reserved */
+	/* protocol dependent part */
+	union {
+		struct in4in6_addr	ina_46;
+		struct in6_addr		ina_6;
+	}					insi_faddr;		/* foreign host table entry */
+	union {
+		struct in4in6_addr	ina_46;
+		struct in6_addr		ina_6;
+	}					insi_laddr;		/* local host table entry */
+	struct {
+		u_char			in4_tos;			/* type of service */
+	}					insi_v4;
+	struct {
+		uint8_t			in6_hlim;
+		int			in6_cksum;
+		u_short			in6_ifindex;
+		short			in6_hops;
+	}					insi_v6;
+};
+
+/*
+ * TCP Sockets
+ */
+
+#define TSI_T_REXMT		0	/* retransmit */
+#define TSI_T_PERSIST		1	/* retransmit persistence */
+#define TSI_T_KEEP		2	/* keep alive */
+#define TSI_T_2MSL		3	/* 2*msl quiet time timer */
+#define TSI_T_NTIMERS		4
+
+#define TSI_S_CLOSED		0	/* closed */
+#define TSI_S_LISTEN		1	/* listening for connection */
+#define TSI_S_SYN_SENT		2	/* active, have sent syn */
+#define TSI_S_SYN_RECEIVED	3	/* have send and received syn */
+#define TSI_S_ESTABLISHED	4	/* established */
+#define TSI_S__CLOSE_WAIT	5	/* rcvd fin, waiting for close */
+#define TSI_S_FIN_WAIT_1	6	/* have closed, sent fin */
+#define TSI_S_CLOSING		7	/* closed xchd FIN; await FIN ACK */
+#define TSI_S_LAST_ACK		8	/* had fin and close; await FIN ACK */
+#define TSI_S_FIN_WAIT_2	9	/* have closed, fin is acked */
+#define TSI_S_TIME_WAIT		10	/* in 2*msl quiet wait after close */
+#define TSI_S_RESERVED		11	/* pseudo state: reserved */
+
+struct tcp_sockinfo {
+	struct in_sockinfo		tcpsi_ini;
+	int				tcpsi_state;
+	int				tcpsi_timer[TSI_T_NTIMERS];
+	int				tcpsi_mss;
+	uint32_t			tcpsi_flags;
+	uint32_t			rfu_1;		/* reserved */
+	uint64_t			tcpsi_tp;	/* opaque handle of TCP protocol control block */
+};
+
+/*
+ * Unix Domain Sockets
+ */
+
+
+struct un_sockinfo {
+	uint64_t				unsi_conn_so;	/* opaque handle of connected socket */
+	uint64_t				unsi_conn_pcb;	/* opaque handle of connected protocol control block */
+	union {
+		struct sockaddr_un	ua_sun;
+		char			ua_dummy[SOCK_MAXADDRLEN];
+	}					unsi_addr;	/* bound address */
+	union {
+		struct sockaddr_un	ua_sun;
+		char			ua_dummy[SOCK_MAXADDRLEN];
+	}					unsi_caddr;	/* address of socket connected to */
+};
+
+/*
+ * PF_NDRV Sockets
+ */
+
+struct ndrv_info {
+	uint32_t	ndrvsi_if_family;
+	uint32_t	ndrvsi_if_unit;
+	char		ndrvsi_if_name[IF_NAMESIZE];
+};
+
+/*
+ * Kernel Event Sockets
+ */
+
+struct kern_event_info {
+	uint32_t	kesi_vendor_code_filter;
+	uint32_t	kesi_class_filter;
+	uint32_t	kesi_subclass_filter;
+};	
+
+/*
+ * Kernel Control Sockets
+ */
+
+struct kern_ctl_info {
+	uint32_t	kcsi_id;
+	uint32_t	kcsi_reg_unit;
+	uint32_t	kcsi_flags;                	/* support flags */
+	uint32_t	kcsi_recvbufsize;          	/* request more than the default buffer size */
+	uint32_t	kcsi_sendbufsize;          	/* request more than the default buffer size */
+	uint32_t	kcsi_unit;
+	char		kcsi_name[MAX_KCTL_NAME];	/* unique nke identifier, provided by DTS */
+};
+
+/* soi_state */
+
+#define SOI_S_NOFDREF		0x0001	/* no file table ref any more */
+#define SOI_S_ISCONNECTED	0x0002	/* socket connected to a peer */
+#define SOI_S_ISCONNECTING	0x0004	/* in process of connecting to peer */
+#define SOI_S_ISDISCONNECTING	0x0008	/* in process of disconnecting */
+#define SOI_S_CANTSENDMORE	0x0010	/* can't send more data to peer */
+#define SOI_S_CANTRCVMORE	0x0020	/* can't receive more data from peer */
+#define SOI_S_RCVATMARK		0x0040	/* at mark on input */
+#define SOI_S_PRIV		0x0080	/* privileged for broadcast, raw... */
+#define SOI_S_NBIO		0x0100	/* non-blocking ops */
+#define SOI_S_ASYNC		0x0200	/* async i/o notify */
+#define SOI_S_INCOMP		0x0800	/* Unaccepted, incomplete connection */
+#define SOI_S_COMP		0x1000	/* unaccepted, complete connection */
+#define SOI_S_ISDISCONNECTED	0x2000	/* socket disconnected from peer */
+#define SOI_S_DRAINING		0x4000	/* close waiting for blocked system calls to drain */
+
+struct sockbuf_info {
+	uint32_t		sbi_cc;
+	uint32_t		sbi_hiwat;			/* SO_RCVBUF, SO_SNDBUF */
+	uint32_t		sbi_mbcnt;
+	uint32_t		sbi_mbmax;
+	uint32_t		sbi_lowat;
+	short			sbi_flags;
+	short			sbi_timeo;
+};
+
+enum {
+	SOCKINFO_GENERIC	= 0,
+	SOCKINFO_IN		= 1,
+	SOCKINFO_TCP		= 2,
+	SOCKINFO_UN		= 3,
+	SOCKINFO_NDRV		= 4,
+	SOCKINFO_KERN_EVENT	= 5,
+	SOCKINFO_KERN_CTL	= 6
+};
+
+struct socket_info {
+	struct vinfo_stat			soi_stat;
+	uint64_t				soi_so;		/* opaque handle of socket */
+	uint64_t				soi_pcb;	/* opaque handle of protocol control block */
+	int					soi_type;
+	int					soi_protocol;
+	int					soi_family;
+	short					soi_options;
+	short					soi_linger;
+	short					soi_state;
+	short					soi_qlen;
+	short					soi_incqlen;
+	short					soi_qlimit;
+	short					soi_timeo;
+	u_short					soi_error;
+	uint32_t				soi_oobmark;
+	struct sockbuf_info			soi_rcv;
+	struct sockbuf_info			soi_snd;
+	int					soi_kind;
+	uint32_t				rfu_1;		/* reserved */
+	union {
+		struct in_sockinfo	pri_in;			/* SOCKINFO_IN */
+		struct tcp_sockinfo	pri_tcp;		/* SOCKINFO_TCP */
+		struct un_sockinfo	pri_un;			/* SOCKINFO_UN */
+		struct ndrv_info	pri_ndrv;		/* SOCKINFO_NDRV */
+		struct kern_event_info	pri_kern_event;		/* SOCKINFO_KERN_EVENT */
+		struct kern_ctl_info	pri_kern_ctl;		/* SOCKINFO_KERN_CTL */
+	}					soi_proto;
+};
+
+struct socket_fdinfo {
+	struct proc_fileinfo	pfi;
+	struct socket_info	psi;
+};
+
+
+
+struct psem_info {
+	struct vinfo_stat	psem_stat;
+	char			psem_name[MAXPATHLEN];
+};
+
+struct psem_fdinfo {
+	struct proc_fileinfo	pfi;
+	struct psem_info	pseminfo;
+};
+
+
+
+struct pshm_info  {
+	struct vinfo_stat	pshm_stat;
+	uint64_t		pshm_mappaddr;
+	char			pshm_name[MAXPATHLEN];
+};
+
+struct pshm_fdinfo {
+	struct proc_fileinfo	pfi;
+	struct pshm_info	pshminfo;
+};
+
+
+struct pipe_info {
+	struct vinfo_stat	pipe_stat;
+	uint64_t		pipe_handle;
+	uint64_t		pipe_peerhandle;
+	int			pipe_status;
+	int			rfu_1;	/* reserved */
+};
+
+struct pipe_fdinfo {
+	struct proc_fileinfo	pfi;
+	struct pipe_info	pipeinfo;
+};
+
+
+struct kqueue_info {
+	struct vinfo_stat	kq_stat;
+	uint32_t		kq_state;
+	uint32_t		rfu_1;	/* reserved */
+};
+#define PROC_KQUEUE_SELECT	1
+#define PROC_KQUEUE_SLEEP	2
+
+struct kqueue_fdinfo {
+	struct proc_fileinfo	pfi;
+	struct kqueue_info	kqueueinfo;
+};
+
+struct appletalk_info {
+	struct vinfo_stat	atalk_stat;
+};
+
+struct appletalk_fdinfo {
+	struct proc_fileinfo	pfi;
+	struct appletalk_info	appletalkinfo;
+};
+
+
+
+/* defns of process file desc type */
+#define PROX_FDTYPE_ATALK	0
+#define PROX_FDTYPE_VNODE	1
+#define PROX_FDTYPE_SOCKET	2
+#define PROX_FDTYPE_PSHM	3
+#define PROX_FDTYPE_PSEM	4
+#define PROX_FDTYPE_KQUEUE	5
+#define PROX_FDTYPE_PIPE	6
+#define PROX_FDTYPE_FSEVENTS	7
+
+struct proc_fdinfo {
+	int32_t			proc_fd;
+	uint32_t		proc_fdtype;	
+};
+
+struct proc_fileportinfo {
+	uint32_t		proc_fileport;
+	uint32_t		proc_fdtype;
+};
+
+/* Flavors for proc_pidinfo() */
+#define PROC_PIDLISTFDS			1
+#define PROC_PIDLISTFD_SIZE		(sizeof(struct proc_fdinfo))
+
+#define PROC_PIDTASKALLINFO		2
+#define PROC_PIDTASKALLINFO_SIZE	(sizeof(struct proc_taskallinfo))
+
+#define PROC_PIDTBSDINFO		3
+#define PROC_PIDTBSDINFO_SIZE		(sizeof(struct proc_bsdinfo))
+
+#define PROC_PIDTASKINFO		4
+#define PROC_PIDTASKINFO_SIZE		(sizeof(struct proc_taskinfo))
+
+#define PROC_PIDTHREADINFO		5
+#define PROC_PIDTHREADINFO_SIZE		(sizeof(struct proc_threadinfo))
+
+#define PROC_PIDLISTTHREADS		6
+#define PROC_PIDLISTTHREADS_SIZE	(2* sizeof(uint32_t))
+
+
+#define PROC_PIDREGIONINFO		7
+#define PROC_PIDREGIONINFO_SIZE		(sizeof(struct proc_regioninfo))
+
+#define PROC_PIDREGIONPATHINFO		8
+#define PROC_PIDREGIONPATHINFO_SIZE	(sizeof(struct proc_regionwithpathinfo))
+
+#define PROC_PIDVNODEPATHINFO		9
+#define PROC_PIDVNODEPATHINFO_SIZE	(sizeof(struct proc_vnodepathinfo))
+
+#define PROC_PIDTHREADPATHINFO		10
+#define PROC_PIDTHREADPATHINFO_SIZE	(sizeof(struct proc_threadwithpathinfo))
+
+#define PROC_PIDPATHINFO		11
+#define PROC_PIDPATHINFO_SIZE		(MAXPATHLEN)
+#define PROC_PIDPATHINFO_MAXSIZE	(4*MAXPATHLEN)
+
+#define PROC_PIDWORKQUEUEINFO		12
+#define PROC_PIDWORKQUEUEINFO_SIZE	(sizeof(struct proc_workqueueinfo))
+
+#define PROC_PIDT_SHORTBSDINFO		13
+#define PROC_PIDT_SHORTBSDINFO_SIZE	(sizeof(struct proc_bsdshortinfo))
+
+#define PROC_PIDLISTFILEPORTS		14
+#define PROC_PIDLISTFILEPORTS_SIZE	(sizeof(struct proc_fileportinfo))
+
+#define PROC_PIDTHREADID64INFO		15
+#define PROC_PIDTHREADID64INFO_SIZE	(sizeof(struct proc_threadinfo))
+
+#define PROC_PID_RUSAGE			16
+#define PROC_PID_RUSAGE_SIZE		0
+
+
+/* Flavors for proc_pidfdinfo */
+
+#define PROC_PIDFDVNODEINFO		1
+#define PROC_PIDFDVNODEINFO_SIZE	(sizeof(struct vnode_fdinfo))
+
+#define PROC_PIDFDVNODEPATHINFO		2
+#define PROC_PIDFDVNODEPATHINFO_SIZE	(sizeof(struct vnode_fdinfowithpath))
+
+#define PROC_PIDFDSOCKETINFO		3
+#define PROC_PIDFDSOCKETINFO_SIZE	(sizeof(struct socket_fdinfo))
+
+#define PROC_PIDFDPSEMINFO		4
+#define PROC_PIDFDPSEMINFO_SIZE		(sizeof(struct psem_fdinfo))
+
+#define PROC_PIDFDPSHMINFO		5
+#define PROC_PIDFDPSHMINFO_SIZE		(sizeof(struct pshm_fdinfo))
+
+#define PROC_PIDFDPIPEINFO		6
+#define PROC_PIDFDPIPEINFO_SIZE		(sizeof(struct pipe_fdinfo))
+
+#define PROC_PIDFDKQUEUEINFO		7
+#define PROC_PIDFDKQUEUEINFO_SIZE	(sizeof(struct kqueue_fdinfo))
+
+#define PROC_PIDFDATALKINFO		8
+#define PROC_PIDFDATALKINFO_SIZE	(sizeof(struct appletalk_fdinfo))
+
+/* Flavors for proc_pidfileportinfo */
+
+#define PROC_PIDFILEPORTVNODEPATHINFO	2	/* out: vnode_fdinfowithpath */
+#define PROC_PIDFILEPORTVNODEPATHINFO_SIZE	\
+					PROC_PIDFDVNODEPATHINFO_SIZE
+
+#define PROC_PIDFILEPORTSOCKETINFO	3	/* out: socket_fdinfo */
+#define PROC_PIDFILEPORTSOCKETINFO_SIZE	PROC_PIDFDSOCKETINFO_SIZE
+
+#define PROC_PIDFILEPORTPSHMINFO	5	/* out: pshm_fdinfo */
+#define PROC_PIDFILEPORTPSHMINFO_SIZE	PROC_PIDFDPSHMINFO_SIZE
+
+#define PROC_PIDFILEPORTPIPEINFO	6	/* out: pipe_fdinfo */
+#define PROC_PIDFILEPORTPIPEINFO_SIZE	PROC_PIDFDPIPEINFO_SIZE
+
+/* used for proc_setcontrol */
+#define PROC_SELFSET_PCONTROL		1
+
+#define PROC_SELFSET_THREADNAME		2
+#define PROC_SELFSET_THREADNAME_SIZE	(MAXTHREADNAMESIZE -1)
+
+#define PROC_SELFSET_VMRSRCOWNER	3
+
+#define PROC_SELFSET_DELAYIDLESLEEP	4
+
+/* used for proc_dirtycontrol */
+#define PROC_DIRTYCONTROL_TRACK         1
+#define PROC_DIRTYCONTROL_SET           2
+#define PROC_DIRTYCONTROL_GET           3
+#define PROC_DIRTYCONTROL_CLEAR         4
+
+/* proc_track_dirty() flags */
+#define PROC_DIRTY_TRACK                0x1
+#define PROC_DIRTY_ALLOW_IDLE_EXIT      0x2
+#define PROC_DIRTY_DEFER                0x4
+#define PROC_DIRTY_LAUNCH_IN_PROGRESS   0x8
+
+/* proc_get_dirty() flags */
+#define PROC_DIRTY_TRACKED              0x1
+#define PROC_DIRTY_ALLOWS_IDLE_EXIT     0x2
+#define PROC_DIRTY_IS_DIRTY             0x4
+#define PROC_DIRTY_LAUNCH_IS_IN_PROGRESS   0x8
+
+
+
+__END_DECLS
+
+#endif /*_SYS_PROC_INFO_H */
diff -Nur cctools-877.5/include/sys/protosw.h cctools-877.5-AnV/include/sys/protosw.h
--- cctools-877.5/include/sys/protosw.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/protosw.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,75 @@
+/*
+ * Copyright (c) 2000-2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ *
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ *
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ *
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1998, 1999 Apple Computer, Inc. All Rights Reserved */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)protosw.h	8.1 (Berkeley) 6/2/93
+ * $FreeBSD: src/sys/sys/protosw.h,v 1.28.2.2 2001/07/03 11:02:01 ume Exp $
+ */
+
+#ifndef _SYS_PROTOSW_H_
+#define	_SYS_PROTOSW_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+/* XXX: this will go away */
+#define	PR_SLOWHZ	2		/* 2 slow timeouts per second */
+
+#endif	/* !_SYS_PROTOSW_H_ */
diff -Nur cctools-877.5/include/sys/ptrace.h cctools-877.5-AnV/include/sys/ptrace.h
--- cctools-877.5/include/sys/ptrace.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ptrace.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,99 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1984, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)ptrace.h	8.2 (Berkeley) 1/4/94
+ */
+
+#ifndef	_SYS_PTRACE_H_
+#define	_SYS_PTRACE_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+#define	PT_TRACE_ME	0	/* child declares it's being traced */
+#define	PT_READ_I	1	/* read word in child's I space */
+#define	PT_READ_D	2	/* read word in child's D space */
+#define	PT_READ_U	3	/* read word in child's user structure */
+#define	PT_WRITE_I	4	/* write word in child's I space */
+#define	PT_WRITE_D	5	/* write word in child's D space */
+#define	PT_WRITE_U	6	/* write word in child's user structure */
+#define	PT_CONTINUE	7	/* continue the child */
+#define	PT_KILL		8	/* kill the child process */
+#define	PT_STEP		9	/* single step the child */
+#define	PT_ATTACH	10	/* trace some running process */
+#define	PT_DETACH	11	/* stop tracing a process */
+#define	PT_SIGEXC	12	/* signals as exceptions for current_proc */
+#define PT_THUPDATE	13	/* signal for thread# */
+#define PT_ATTACHEXC	14	/* attach to running process with signal exception */
+
+#define	PT_FORCEQUOTA	30	/* Enforce quota for root */
+#define	PT_DENY_ATTACH	31
+
+#define	PT_FIRSTMACH	32	/* for machine-specific requests */
+
+__BEGIN_DECLS
+
+
+int	ptrace(int _request, pid_t _pid, caddr_t _addr, int _data);
+
+
+__END_DECLS
+
+#endif	/* !_SYS_PTRACE_H_ */
diff -Nur cctools-877.5/include/sys/qos.h cctools-877.5-AnV/include/sys/qos.h
--- cctools-877.5/include/sys/qos.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/qos.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,194 @@
+/*
+ * Copyright (c) 2013-2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ *
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ *
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ *
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _SYS_QOS_H
+#define _SYS_QOS_H
+
+#include <sys/cdefs.h>
+#include <Availability.h>
+
+/*!
+ * @typedef qos_class_t
+ *
+ * @abstract
+ * An abstract thread quality of service (QOS) classification.
+ *
+ * @discussion
+ * Thread quality of service (QOS) classes are ordered abstract representations
+ * of the nature of work that is expected to be performed by a pthread, dispatch
+ * queue, or NSOperation. Each class specifies a maximum thread scheduling
+ * priority for that band (which may be used in combination with a relative
+ * priority offset within the band), as well as quality of service
+ * characteristics for timer latency, CPU throughput, I/O throughput, network
+ * socket traffic management behavior and more.
+ *
+ * A best effort is made to allocate available system resources to every QOS
+ * class. Quality of service degredation only occurs during system resource
+ * contention, proportionally to the QOS class. That said, QOS classes
+ * representing user-initiated work attempt to achieve peak throughput while
+ * QOS classes for other work attempt to achieve peak energy and thermal
+ * efficiency, even in the absence of contention. Finally, the use of QOS
+ * classes does not allow threads to supersede any limits that may be applied
+ * to the overall process.
+ */
+
+/*!
+ * @constant QOS_CLASS_USER_INTERACTIVE
+ * @abstract A QOS class which indicates work performed by this thread
+ * is interactive with the user.
+ * @discussion Such work is requested to run at high priority relative to other
+ * work on the system. Specifying this QOS class is a request to run with
+ * nearly all available system CPU and I/O bandwidth even under contention.
+ * This is not an energy-efficient QOS class to use for large tasks. The use of
+ * this QOS class should be limited to critical interaction with the user such
+ * as handling events on the main event loop, view drawing, animation, etc.
+ *
+ * @constant QOS_CLASS_USER_INITIATED
+ * @abstract A QOS class which indicates work performed by this thread
+ * was initiated by the user and that the user is likely waiting for the
+ * results.
+ * @discussion Such work is requested to run at a priority below critical user-
+ * interactive work, but relatively higher than other work on the system. This
+ * is not an energy-efficient QOS class to use for large tasks and the use of
+ * this QOS class should be limited to operations where the user is immediately
+ * waiting for the results.
+ *
+ * @constant QOS_CLASS_DEFAULT
+ * @abstract A default QOS class used by the system in cases where more specific
+ * QOS class information is not available.
+ * @discussion Such work is requested to run at a priority below critical user-
+ * interactive and user-initiated work, but relatively higher than utility and
+ * background tasks. Threads created by pthread_create() without an attribute
+ * specifying a QOS class will default to QOS_CLASS_DEFAULT. This QOS class
+ * value is not intended to be used as a work classification, it should only be
+ * set when propagating or restoring QOS class values provided by the system.
+ *
+ * @constant QOS_CLASS_UTILITY
+ * @abstract A QOS class which indicates work performed by this thread
+ * may or may not be initiated by the user and that the user is unlikely to be
+ * immediately waiting for the results.
+ * @discussion Such work is requested to run at a priority below critical user-
+ * interactive and user-initiated work, but relatively higher than low-level
+ * system maintenance tasks. The use of this QOS class indicates the work should
+ * be run in an energy and thermally-efficient manner.
+ *
+ * @constant QOS_CLASS_BACKGROUND
+ * @abstract A QOS class which indicates work performed by this thread was not
+ * initiated by the user and that the user may be unaware of the results.
+ * @discussion Such work is requested to run at a priority below other work.
+ * The use of this QOS class indicates the work should be run in the most energy
+ * and thermally-efficient manner.
+ *
+ * @constant QOS_CLASS_UNSPECIFIED
+ * @abstract A QOS class value which indicates the absence or removal of QOS
+ * class information.
+ * @discussion As an API return value, may indicate that threads or pthread
+ * attributes were configured with legacy API incompatible or in conflict with
+ * the QOS class system.
+ */
+
+#define __QOS_ENUM(name, type, ...) enum { __VA_ARGS__ }; typedef type name##_t
+#define __QOS_CLASS_AVAILABLE_STARTING(...)
+
+#if defined(__has_feature) && defined(__has_extension)
+#if __has_feature(objc_fixed_enum) || __has_extension(cxx_strong_enums)
+#undef __QOS_ENUM
+#define __QOS_ENUM(name, type, ...) typedef enum : type { __VA_ARGS__ } name##_t
+#endif
+#if __has_feature(enumerator_attributes)
+#undef __QOS_CLASS_AVAILABLE_STARTING
+#define __QOS_CLASS_AVAILABLE_STARTING __OSX_AVAILABLE_STARTING
+#endif
+#endif
+
+__QOS_ENUM(qos_class, unsigned int,
+	QOS_CLASS_USER_INTERACTIVE
+			__QOS_CLASS_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0) = 0x21,
+	QOS_CLASS_USER_INITIATED
+			__QOS_CLASS_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0) = 0x19,
+	QOS_CLASS_DEFAULT
+			__QOS_CLASS_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0) = 0x15,
+	QOS_CLASS_UTILITY
+			__QOS_CLASS_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0) = 0x11,
+	QOS_CLASS_BACKGROUND
+			__QOS_CLASS_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0) = 0x09,
+	QOS_CLASS_UNSPECIFIED
+			__QOS_CLASS_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0) = 0x00,
+);
+
+#undef __QOS_ENUM
+
+/*!
+ * @constant QOS_MIN_RELATIVE_PRIORITY
+ * @abstract The minimum relative priority that may be specified within a
+ * QOS class. These priorities are relative only within a given QOS class
+ * and meaningful only for the current process.
+ */
+#define QOS_MIN_RELATIVE_PRIORITY (-15)
+
+/* Userspace (only) definitions */
+
+#ifndef KERNEL
+
+__BEGIN_DECLS
+
+/*!
+ * @function qos_class_self
+ *
+ * @abstract
+ * Returns the requested QOS class of the current thread.
+ *
+ * @return
+ * One of the QOS class values in qos_class_t.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0)
+qos_class_t
+qos_class_self(void);
+
+/*!
+ * @function qos_class_main
+ *
+ * @abstract
+ * Returns the initial requested QOS class of the main thread.
+ *
+ * @discussion
+ * The QOS class that the main thread of a process is created with depends on
+ * the type of process (e.g. application or daemon) and on how it has been
+ * launched.
+ *
+ * This function returns that initial requested QOS class value chosen by the
+ * system to enable propagation of that classification to matching work not
+ * executing on the main thread.
+ *
+ * @return
+ * One of the QOS class values in qos_class_t.
+ */
+__OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0)
+qos_class_t
+qos_class_main(void);
+
+__END_DECLS
+
+#endif // KERNEL
+
+#endif // _SYS_QOS_H
diff -Nur cctools-877.5/include/sys/queue.h cctools-877.5-AnV/include/sys/queue.h
--- cctools-877.5/include/sys/queue.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/queue.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,837 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*-
+ * Copyright (c) 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)queue.h	8.5 (Berkeley) 8/20/94
+ */
+
+#ifndef _SYS_QUEUE_H_
+#define	_SYS_QUEUE_H_
+
+/*
+ * This file defines five types of data structures: singly-linked lists,
+ * singly-linked tail queues, lists, tail queues, and circular queues.
+ *
+ * A singly-linked list is headed by a single forward pointer. The elements
+ * are singly linked for minimum space and pointer manipulation overhead at
+ * the expense of O(n) removal for arbitrary elements. New elements can be
+ * added to the list after an existing element or at the head of the list.
+ * Elements being removed from the head of the list should use the explicit
+ * macro for this purpose for optimum efficiency. A singly-linked list may
+ * only be traversed in the forward direction.  Singly-linked lists are ideal
+ * for applications with large datasets and few or no removals or for
+ * implementing a LIFO queue.
+ *
+ * A singly-linked tail queue is headed by a pair of pointers, one to the
+ * head of the list and the other to the tail of the list. The elements are
+ * singly linked for minimum space and pointer manipulation overhead at the
+ * expense of O(n) removal for arbitrary elements. New elements can be added
+ * to the list after an existing element, at the head of the list, or at the
+ * end of the list. Elements being removed from the head of the tail queue
+ * should use the explicit macro for this purpose for optimum efficiency.
+ * A singly-linked tail queue may only be traversed in the forward direction.
+ * Singly-linked tail queues are ideal for applications with large datasets
+ * and few or no removals or for implementing a FIFO queue.
+ *
+ * A list is headed by a single forward pointer (or an array of forward
+ * pointers for a hash table header). The elements are doubly linked
+ * so that an arbitrary element can be removed without a need to
+ * traverse the list. New elements can be added to the list before
+ * or after an existing element or at the head of the list. A list
+ * may only be traversed in the forward direction.
+ *
+ * A tail queue is headed by a pair of pointers, one to the head of the
+ * list and the other to the tail of the list. The elements are doubly
+ * linked so that an arbitrary element can be removed without a need to
+ * traverse the list. New elements can be added to the list before or
+ * after an existing element, at the head of the list, or at the end of
+ * the list. A tail queue may be traversed in either direction.
+ *
+ * A circle queue is headed by a pair of pointers, one to the head of the
+ * list and the other to the tail of the list. The elements are doubly
+ * linked so that an arbitrary element can be removed without a need to
+ * traverse the list. New elements can be added to the list before or after
+ * an existing element, at the head of the list, or at the end of the list.
+ * A circle queue may be traversed in either direction, but has a more
+ * complex end of list detection.
+ * Note that circle queues are deprecated, because, as the removal log
+ * in FreeBSD states, "CIRCLEQs are a disgrace to everything Knuth taught
+ * us in Volume 1 Chapter 2. [...] Use TAILQ instead, it provides the same
+ * functionality." Code using them will continue to compile, but they
+ * are no longer documented on the man page.
+ *
+ * For details on the use of these macros, see the queue(3) manual page.
+ *
+ *
+ *				SLIST	LIST	STAILQ	TAILQ	CIRCLEQ
+ * _HEAD			+	+	+	+	+
+ * _HEAD_INITIALIZER		+	+	+	+	-
+ * _ENTRY			+	+	+	+	+
+ * _INIT			+	+	+	+	+
+ * _EMPTY			+	+	+	+	+
+ * _FIRST			+	+	+	+	+
+ * _NEXT			+	+	+	+	+
+ * _PREV			-	-	-	+	+
+ * _LAST			-	-	+	+	+
+ * _FOREACH			+	+	+	+	+
+ * _FOREACH_SAFE		+	+	+	+	-
+ * _FOREACH_REVERSE		-	-	-	+	-
+ * _FOREACH_REVERSE_SAFE	-	-	-	+	-
+ * _INSERT_HEAD			+	+	+	+	+
+ * _INSERT_BEFORE		-	+	-	+	+
+ * _INSERT_AFTER		+	+	+	+	+
+ * _INSERT_TAIL			-	-	+	+	+
+ * _CONCAT			-	-	+	+	-
+ * _REMOVE_AFTER		+	-	+	-	-
+ * _REMOVE_HEAD			+	-	+	-	-
+ * _REMOVE_HEAD_UNTIL		-	-	+	-	-
+ * _REMOVE			+	+	+	+	+
+ * _SWAP			-	+	+	+	-
+ *
+ */
+#ifdef QUEUE_MACRO_DEBUG
+/* Store the last 2 places the queue element or head was altered */
+struct qm_trace {
+	char * lastfile;
+	int lastline;
+	char * prevfile;
+	int prevline;
+};
+
+#define	TRACEBUF	struct qm_trace trace;
+#define	TRASHIT(x)	do {(x) = (void *)-1;} while (0)
+
+#define	QMD_TRACE_HEAD(head) do {					\
+	(head)->trace.prevline = (head)->trace.lastline;		\
+	(head)->trace.prevfile = (head)->trace.lastfile;		\
+	(head)->trace.lastline = __LINE__;				\
+	(head)->trace.lastfile = __FILE__;				\
+} while (0)
+
+#define	QMD_TRACE_ELEM(elem) do {					\
+	(elem)->trace.prevline = (elem)->trace.lastline;		\
+	(elem)->trace.prevfile = (elem)->trace.lastfile;		\
+	(elem)->trace.lastline = __LINE__;				\
+	(elem)->trace.lastfile = __FILE__;				\
+} while (0)
+
+#else
+#define	QMD_TRACE_ELEM(elem)
+#define	QMD_TRACE_HEAD(head)
+#define	TRACEBUF
+#define	TRASHIT(x)
+#endif	/* QUEUE_MACRO_DEBUG */
+
+/*
+ * Horrible macros to enable use of code that was meant to be C-specific
+ *   (and which push struct onto type) in C++; without these, C++ code
+ *   that uses these macros in the context of a class will blow up
+ *   due to "struct" being preprended to "type" by the macros, causing
+ *   inconsistent use of tags.
+ *
+ * This approach is necessary because these are macros; we have to use
+ *   these on a per-macro basis (because the queues are implemented as
+ *   macros, disabling this warning in the scope of the header file is
+ *   insufficient), whuch means we can't use #pragma, and have to use
+ *   _Pragma.  We only need to use these for the queue macros that
+ *   prepend "struct" to "type" and will cause C++ to blow up.
+ */
+#if defined(__clang__) && defined(__cplusplus)
+#define __MISMATCH_TAGS_PUSH						\
+	_Pragma("clang diagnostic push")				\
+	_Pragma("clang diagnostic ignored \"-Wmismatched-tags\"")
+#define __MISMATCH_TAGS_POP						\
+	_Pragma("clang diagnostic pop")
+#else
+#define __MISMATCH_TAGS_PUSH
+#define __MISMATCH_TAGS_POP
+#endif
+
+/*
+ * Singly-linked List declarations.
+ */
+#define	SLIST_HEAD(name, type)						\
+__MISMATCH_TAGS_PUSH							\
+struct name {								\
+	struct type *slh_first;	/* first element */			\
+}									\
+__MISMATCH_TAGS_POP
+
+#define	SLIST_HEAD_INITIALIZER(head)					\
+	{ NULL }
+
+#define	SLIST_ENTRY(type)						\
+__MISMATCH_TAGS_PUSH							\
+struct {								\
+	struct type *sle_next;	/* next element */			\
+}									\
+__MISMATCH_TAGS_POP
+
+/*
+ * Singly-linked List functions.
+ */
+#define	SLIST_EMPTY(head)	((head)->slh_first == NULL)
+
+#define	SLIST_FIRST(head)	((head)->slh_first)
+
+#define	SLIST_FOREACH(var, head, field)					\
+	for ((var) = SLIST_FIRST((head));				\
+	    (var);							\
+	    (var) = SLIST_NEXT((var), field))
+
+#define	SLIST_FOREACH_SAFE(var, head, field, tvar)			\
+	for ((var) = SLIST_FIRST((head));				\
+	    (var) && ((tvar) = SLIST_NEXT((var), field), 1);		\
+	    (var) = (tvar))
+
+#define	SLIST_FOREACH_PREVPTR(var, varp, head, field)			\
+	for ((varp) = &SLIST_FIRST((head));				\
+	    ((var) = *(varp)) != NULL;					\
+	    (varp) = &SLIST_NEXT((var), field))
+
+#define	SLIST_INIT(head) do {						\
+	SLIST_FIRST((head)) = NULL;					\
+} while (0)
+
+#define	SLIST_INSERT_AFTER(slistelm, elm, field) do {			\
+	SLIST_NEXT((elm), field) = SLIST_NEXT((slistelm), field);	\
+	SLIST_NEXT((slistelm), field) = (elm);				\
+} while (0)
+
+#define	SLIST_INSERT_HEAD(head, elm, field) do {			\
+	SLIST_NEXT((elm), field) = SLIST_FIRST((head));			\
+	SLIST_FIRST((head)) = (elm);					\
+} while (0)
+
+#define	SLIST_NEXT(elm, field)	((elm)->field.sle_next)
+
+#define	SLIST_REMOVE(head, elm, type, field)				\
+__MISMATCH_TAGS_PUSH							\
+do {									\
+	if (SLIST_FIRST((head)) == (elm)) {				\
+		SLIST_REMOVE_HEAD((head), field);			\
+	}								\
+	else {								\
+		struct type *curelm = SLIST_FIRST((head));		\
+		while (SLIST_NEXT(curelm, field) != (elm))		\
+			curelm = SLIST_NEXT(curelm, field);		\
+		SLIST_REMOVE_AFTER(curelm, field);			\
+	}								\
+	TRASHIT((elm)->field.sle_next);					\
+} while (0)								\
+__MISMATCH_TAGS_POP
+
+#define SLIST_REMOVE_AFTER(elm, field) do {				\
+	SLIST_NEXT(elm, field) =					\
+	    SLIST_NEXT(SLIST_NEXT(elm, field), field);			\
+} while (0)
+
+#define	SLIST_REMOVE_HEAD(head, field) do {				\
+	SLIST_FIRST((head)) = SLIST_NEXT(SLIST_FIRST((head)), field);	\
+} while (0)
+
+/*
+ * Singly-linked Tail queue declarations.
+ */
+#define	STAILQ_HEAD(name, type)						\
+__MISMATCH_TAGS_PUSH							\
+struct name {								\
+	struct type *stqh_first;/* first element */			\
+	struct type **stqh_last;/* addr of last next element */		\
+}									\
+__MISMATCH_TAGS_POP
+
+#define	STAILQ_HEAD_INITIALIZER(head)					\
+	{ NULL, &(head).stqh_first }
+
+#define	STAILQ_ENTRY(type)						\
+__MISMATCH_TAGS_PUSH							\
+struct {								\
+	struct type *stqe_next;	/* next element */			\
+}									\
+__MISMATCH_TAGS_POP
+
+/*
+ * Singly-linked Tail queue functions.
+ */
+#define	STAILQ_CONCAT(head1, head2) do {				\
+	if (!STAILQ_EMPTY((head2))) {					\
+		*(head1)->stqh_last = (head2)->stqh_first;		\
+		(head1)->stqh_last = (head2)->stqh_last;		\
+		STAILQ_INIT((head2));					\
+	}								\
+} while (0)
+
+#define	STAILQ_EMPTY(head)	((head)->stqh_first == NULL)
+
+#define	STAILQ_FIRST(head)	((head)->stqh_first)
+
+#define	STAILQ_FOREACH(var, head, field)				\
+	for((var) = STAILQ_FIRST((head));				\
+	   (var);							\
+	   (var) = STAILQ_NEXT((var), field))
+
+
+#define	STAILQ_FOREACH_SAFE(var, head, field, tvar)			\
+	for ((var) = STAILQ_FIRST((head));				\
+	    (var) && ((tvar) = STAILQ_NEXT((var), field), 1);		\
+	    (var) = (tvar))
+
+#define	STAILQ_INIT(head) do {						\
+	STAILQ_FIRST((head)) = NULL;					\
+	(head)->stqh_last = &STAILQ_FIRST((head));			\
+} while (0)
+
+#define	STAILQ_INSERT_AFTER(head, tqelm, elm, field) do {		\
+	if ((STAILQ_NEXT((elm), field) = STAILQ_NEXT((tqelm), field)) == NULL)\
+		(head)->stqh_last = &STAILQ_NEXT((elm), field);		\
+	STAILQ_NEXT((tqelm), field) = (elm);				\
+} while (0)
+
+#define	STAILQ_INSERT_HEAD(head, elm, field) do {			\
+	if ((STAILQ_NEXT((elm), field) = STAILQ_FIRST((head))) == NULL)	\
+		(head)->stqh_last = &STAILQ_NEXT((elm), field);		\
+	STAILQ_FIRST((head)) = (elm);					\
+} while (0)
+
+#define	STAILQ_INSERT_TAIL(head, elm, field) do {			\
+	STAILQ_NEXT((elm), field) = NULL;				\
+	*(head)->stqh_last = (elm);					\
+	(head)->stqh_last = &STAILQ_NEXT((elm), field);			\
+} while (0)
+
+#define	STAILQ_LAST(head, type, field)					\
+__MISMATCH_TAGS_PUSH							\
+	(STAILQ_EMPTY((head)) ?						\
+		NULL :							\
+	        ((struct type *)(void *)				\
+		((char *)((head)->stqh_last) - __offsetof(struct type, field))))\
+__MISMATCH_TAGS_POP
+
+#define	STAILQ_NEXT(elm, field)	((elm)->field.stqe_next)
+
+#define	STAILQ_REMOVE(head, elm, type, field)				\
+__MISMATCH_TAGS_PUSH							\
+do {									\
+	if (STAILQ_FIRST((head)) == (elm)) {				\
+		STAILQ_REMOVE_HEAD((head), field);			\
+	}								\
+	else {								\
+		struct type *curelm = STAILQ_FIRST((head));		\
+		while (STAILQ_NEXT(curelm, field) != (elm))		\
+			curelm = STAILQ_NEXT(curelm, field);		\
+		STAILQ_REMOVE_AFTER(head, curelm, field);		\
+	}								\
+	TRASHIT((elm)->field.stqe_next);				\
+} while (0)								\
+__MISMATCH_TAGS_POP
+
+#define	STAILQ_REMOVE_HEAD(head, field) do {				\
+	if ((STAILQ_FIRST((head)) =					\
+	     STAILQ_NEXT(STAILQ_FIRST((head)), field)) == NULL)		\
+		(head)->stqh_last = &STAILQ_FIRST((head));		\
+} while (0)
+
+#define STAILQ_REMOVE_HEAD_UNTIL(head, elm, field) do {                 \
+       if ((STAILQ_FIRST((head)) = STAILQ_NEXT((elm), field)) == NULL) \
+               (head)->stqh_last = &STAILQ_FIRST((head));              \
+} while (0)
+
+#define STAILQ_REMOVE_AFTER(head, elm, field) do {			\
+	if ((STAILQ_NEXT(elm, field) =					\
+	     STAILQ_NEXT(STAILQ_NEXT(elm, field), field)) == NULL)	\
+		(head)->stqh_last = &STAILQ_NEXT((elm), field);		\
+} while (0)
+
+#define STAILQ_SWAP(head1, head2, type)					\
+__MISMATCH_TAGS_PUSH							\
+do {									\
+	struct type *swap_first = STAILQ_FIRST(head1);			\
+	struct type **swap_last = (head1)->stqh_last;			\
+	STAILQ_FIRST(head1) = STAILQ_FIRST(head2);			\
+	(head1)->stqh_last = (head2)->stqh_last;			\
+	STAILQ_FIRST(head2) = swap_first;				\
+	(head2)->stqh_last = swap_last;					\
+	if (STAILQ_EMPTY(head1))					\
+		(head1)->stqh_last = &STAILQ_FIRST(head1);		\
+	if (STAILQ_EMPTY(head2))					\
+		(head2)->stqh_last = &STAILQ_FIRST(head2);		\
+} while (0)								\
+__MISMATCH_TAGS_POP
+
+
+/*
+ * List declarations.
+ */
+#define	LIST_HEAD(name, type)						\
+__MISMATCH_TAGS_PUSH							\
+struct name {								\
+	struct type *lh_first;	/* first element */			\
+}									\
+__MISMATCH_TAGS_POP
+
+#define	LIST_HEAD_INITIALIZER(head)					\
+	{ NULL }
+
+#define	LIST_ENTRY(type)						\
+__MISMATCH_TAGS_PUSH							\
+struct {								\
+	struct type *le_next;	/* next element */			\
+	struct type **le_prev;	/* address of previous next element */	\
+}									\
+__MISMATCH_TAGS_POP
+
+/*
+ * List functions.
+ */
+
+#if (defined(_KERNEL) && defined(INVARIANTS)) || defined(QUEUE_MACRO_DEBUG)
+#define	QMD_LIST_CHECK_HEAD(head, field) do {				\
+	if (LIST_FIRST((head)) != NULL &&				\
+	    LIST_FIRST((head))->field.le_prev !=			\
+	     &LIST_FIRST((head)))					\
+		panic("Bad list head %p first->prev != head", (head));	\
+} while (0)
+
+#define	QMD_LIST_CHECK_NEXT(elm, field) do {				\
+	if (LIST_NEXT((elm), field) != NULL &&				\
+	    LIST_NEXT((elm), field)->field.le_prev !=			\
+	     &((elm)->field.le_next))					\
+	     	panic("Bad link elm %p next->prev != elm", (elm));	\
+} while (0)
+
+#define	QMD_LIST_CHECK_PREV(elm, field) do {				\
+	if (*(elm)->field.le_prev != (elm))				\
+		panic("Bad link elm %p prev->next != elm", (elm));	\
+} while (0)
+#else
+#define	QMD_LIST_CHECK_HEAD(head, field)
+#define	QMD_LIST_CHECK_NEXT(elm, field)
+#define	QMD_LIST_CHECK_PREV(elm, field)
+#endif /* (_KERNEL && INVARIANTS) || QUEUE_MACRO_DEBUG */
+
+#define	LIST_EMPTY(head)	((head)->lh_first == NULL)
+
+#define	LIST_FIRST(head)	((head)->lh_first)
+
+#define	LIST_FOREACH(var, head, field)					\
+	for ((var) = LIST_FIRST((head));				\
+	    (var);							\
+	    (var) = LIST_NEXT((var), field))
+
+#define	LIST_FOREACH_SAFE(var, head, field, tvar)			\
+	for ((var) = LIST_FIRST((head));				\
+	    (var) && ((tvar) = LIST_NEXT((var), field), 1);		\
+	    (var) = (tvar))
+
+#define	LIST_INIT(head) do {						\
+	LIST_FIRST((head)) = NULL;					\
+} while (0)
+
+#define	LIST_INSERT_AFTER(listelm, elm, field) do {			\
+	QMD_LIST_CHECK_NEXT(listelm, field);				\
+	if ((LIST_NEXT((elm), field) = LIST_NEXT((listelm), field)) != NULL)\
+		LIST_NEXT((listelm), field)->field.le_prev =		\
+		    &LIST_NEXT((elm), field);				\
+	LIST_NEXT((listelm), field) = (elm);				\
+	(elm)->field.le_prev = &LIST_NEXT((listelm), field);		\
+} while (0)
+
+#define	LIST_INSERT_BEFORE(listelm, elm, field) do {			\
+	QMD_LIST_CHECK_PREV(listelm, field);				\
+	(elm)->field.le_prev = (listelm)->field.le_prev;		\
+	LIST_NEXT((elm), field) = (listelm);				\
+	*(listelm)->field.le_prev = (elm);				\
+	(listelm)->field.le_prev = &LIST_NEXT((elm), field);		\
+} while (0)
+
+#define	LIST_INSERT_HEAD(head, elm, field) do {				\
+	QMD_LIST_CHECK_HEAD((head), field);				\
+	if ((LIST_NEXT((elm), field) = LIST_FIRST((head))) != NULL)	\
+		LIST_FIRST((head))->field.le_prev = &LIST_NEXT((elm), field);\
+	LIST_FIRST((head)) = (elm);					\
+	(elm)->field.le_prev = &LIST_FIRST((head));			\
+} while (0)
+
+#define	LIST_NEXT(elm, field)	((elm)->field.le_next)
+
+#define	LIST_REMOVE(elm, field) do {					\
+	QMD_LIST_CHECK_NEXT(elm, field);				\
+	QMD_LIST_CHECK_PREV(elm, field);				\
+	if (LIST_NEXT((elm), field) != NULL)				\
+		LIST_NEXT((elm), field)->field.le_prev = 		\
+		    (elm)->field.le_prev;				\
+	*(elm)->field.le_prev = LIST_NEXT((elm), field);		\
+	TRASHIT((elm)->field.le_next);					\
+	TRASHIT((elm)->field.le_prev);					\
+} while (0)
+
+#define LIST_SWAP(head1, head2, type, field)				\
+__MISMATCH_TAGS_PUSH							\
+do {									\
+	struct type *swap_tmp = LIST_FIRST((head1));			\
+	LIST_FIRST((head1)) = LIST_FIRST((head2));			\
+	LIST_FIRST((head2)) = swap_tmp;					\
+	if ((swap_tmp = LIST_FIRST((head1))) != NULL)			\
+		swap_tmp->field.le_prev = &LIST_FIRST((head1));		\
+	if ((swap_tmp = LIST_FIRST((head2))) != NULL)			\
+		swap_tmp->field.le_prev = &LIST_FIRST((head2));		\
+} while (0)								\
+__MISMATCH_TAGS_POP
+
+/*
+ * Tail queue declarations.
+ */
+#define	TAILQ_HEAD(name, type)						\
+__MISMATCH_TAGS_PUSH							\
+struct name {								\
+	struct type *tqh_first;	/* first element */			\
+	struct type **tqh_last;	/* addr of last next element */		\
+	TRACEBUF							\
+}									\
+__MISMATCH_TAGS_POP
+
+#define	TAILQ_HEAD_INITIALIZER(head)					\
+	{ NULL, &(head).tqh_first }
+
+#define	TAILQ_ENTRY(type)						\
+__MISMATCH_TAGS_PUSH							\
+struct {								\
+	struct type *tqe_next;	/* next element */			\
+	struct type **tqe_prev;	/* address of previous next element */	\
+	TRACEBUF							\
+}									\
+__MISMATCH_TAGS_POP
+
+/*
+ * Tail queue functions.
+ */
+#define	TAILQ_CONCAT(head1, head2, field) do {				\
+	if (!TAILQ_EMPTY(head2)) {					\
+		*(head1)->tqh_last = (head2)->tqh_first;		\
+		(head2)->tqh_first->field.tqe_prev = (head1)->tqh_last;	\
+		(head1)->tqh_last = (head2)->tqh_last;			\
+		TAILQ_INIT((head2));					\
+		QMD_TRACE_HEAD(head1);					\
+		QMD_TRACE_HEAD(head2);					\
+	}								\
+} while (0)
+
+#define	TAILQ_EMPTY(head)	((head)->tqh_first == NULL)
+
+#define	TAILQ_FIRST(head)	((head)->tqh_first)
+
+#define	TAILQ_FOREACH(var, head, field)					\
+	for ((var) = TAILQ_FIRST((head));				\
+	    (var);							\
+	    (var) = TAILQ_NEXT((var), field))
+
+#define	TAILQ_FOREACH_SAFE(var, head, field, tvar)			\
+	for ((var) = TAILQ_FIRST((head));				\
+	    (var) && ((tvar) = TAILQ_NEXT((var), field), 1);		\
+	    (var) = (tvar))
+
+#define	TAILQ_FOREACH_REVERSE(var, head, headname, field)		\
+	for ((var) = TAILQ_LAST((head), headname);			\
+	    (var);							\
+	    (var) = TAILQ_PREV((var), headname, field))
+
+#define	TAILQ_FOREACH_REVERSE_SAFE(var, head, headname, field, tvar)	\
+	for ((var) = TAILQ_LAST((head), headname);			\
+	    (var) && ((tvar) = TAILQ_PREV((var), headname, field), 1);	\
+	    (var) = (tvar))
+
+#define	TAILQ_INIT(head) do {						\
+	TAILQ_FIRST((head)) = NULL;					\
+	(head)->tqh_last = &TAILQ_FIRST((head));			\
+	QMD_TRACE_HEAD(head);						\
+} while (0)
+
+#define	TAILQ_INSERT_AFTER(head, listelm, elm, field) do {		\
+	if ((TAILQ_NEXT((elm), field) = TAILQ_NEXT((listelm), field)) != NULL)\
+		TAILQ_NEXT((elm), field)->field.tqe_prev = 		\
+		    &TAILQ_NEXT((elm), field);				\
+	else {								\
+		(head)->tqh_last = &TAILQ_NEXT((elm), field);		\
+		QMD_TRACE_HEAD(head);					\
+	}								\
+	TAILQ_NEXT((listelm), field) = (elm);				\
+	(elm)->field.tqe_prev = &TAILQ_NEXT((listelm), field);		\
+	QMD_TRACE_ELEM(&(elm)->field);					\
+	QMD_TRACE_ELEM(&listelm->field);				\
+} while (0)
+
+#define	TAILQ_INSERT_BEFORE(listelm, elm, field) do {			\
+	(elm)->field.tqe_prev = (listelm)->field.tqe_prev;		\
+	TAILQ_NEXT((elm), field) = (listelm);				\
+	*(listelm)->field.tqe_prev = (elm);				\
+	(listelm)->field.tqe_prev = &TAILQ_NEXT((elm), field);		\
+	QMD_TRACE_ELEM(&(elm)->field);					\
+	QMD_TRACE_ELEM(&listelm->field);				\
+} while (0)
+
+#define	TAILQ_INSERT_HEAD(head, elm, field) do {			\
+	if ((TAILQ_NEXT((elm), field) = TAILQ_FIRST((head))) != NULL)	\
+		TAILQ_FIRST((head))->field.tqe_prev =			\
+		    &TAILQ_NEXT((elm), field);				\
+	else								\
+		(head)->tqh_last = &TAILQ_NEXT((elm), field);		\
+	TAILQ_FIRST((head)) = (elm);					\
+	(elm)->field.tqe_prev = &TAILQ_FIRST((head));			\
+	QMD_TRACE_HEAD(head);						\
+	QMD_TRACE_ELEM(&(elm)->field);					\
+} while (0)
+
+#define	TAILQ_INSERT_TAIL(head, elm, field) do {			\
+	TAILQ_NEXT((elm), field) = NULL;				\
+	(elm)->field.tqe_prev = (head)->tqh_last;			\
+	*(head)->tqh_last = (elm);					\
+	(head)->tqh_last = &TAILQ_NEXT((elm), field);			\
+	QMD_TRACE_HEAD(head);						\
+	QMD_TRACE_ELEM(&(elm)->field);					\
+} while (0)
+
+#define	TAILQ_LAST(head, headname)					\
+__MISMATCH_TAGS_PUSH							\
+	(*(((struct headname *)((head)->tqh_last))->tqh_last))		\
+__MISMATCH_TAGS_POP
+
+#define	TAILQ_NEXT(elm, field) ((elm)->field.tqe_next)
+
+#define	TAILQ_PREV(elm, headname, field)				\
+__MISMATCH_TAGS_PUSH							\
+	(*(((struct headname *)((elm)->field.tqe_prev))->tqh_last))	\
+__MISMATCH_TAGS_POP
+
+#define	TAILQ_REMOVE(head, elm, field) do {				\
+	if ((TAILQ_NEXT((elm), field)) != NULL)				\
+		TAILQ_NEXT((elm), field)->field.tqe_prev = 		\
+		    (elm)->field.tqe_prev;				\
+	else {								\
+		(head)->tqh_last = (elm)->field.tqe_prev;		\
+		QMD_TRACE_HEAD(head);					\
+	}								\
+	*(elm)->field.tqe_prev = TAILQ_NEXT((elm), field);		\
+	TRASHIT((elm)->field.tqe_next);					\
+	TRASHIT((elm)->field.tqe_prev);					\
+	QMD_TRACE_ELEM(&(elm)->field);					\
+} while (0)
+
+/*
+ * Why did they switch to spaces for this one macro?
+ */
+#define TAILQ_SWAP(head1, head2, type, field)                           \
+__MISMATCH_TAGS_PUSH                                                    \
+do {                                                                    \
+	struct type *swap_first = (head1)->tqh_first;                   \
+	struct type **swap_last = (head1)->tqh_last;                    \
+	(head1)->tqh_first = (head2)->tqh_first;                        \
+	(head1)->tqh_last = (head2)->tqh_last;                          \
+	(head2)->tqh_first = swap_first;                                \
+	(head2)->tqh_last = swap_last;                                  \
+	if ((swap_first = (head1)->tqh_first) != NULL)                  \
+		swap_first->field.tqe_prev = &(head1)->tqh_first;       \
+	else                                                            \
+		(head1)->tqh_last = &(head1)->tqh_first;                \
+	if ((swap_first = (head2)->tqh_first) != NULL)                  \
+		swap_first->field.tqe_prev = &(head2)->tqh_first;       \
+	else                                                            \
+		(head2)->tqh_last = &(head2)->tqh_first;                \
+} while (0)                                                             \
+__MISMATCH_TAGS_POP
+
+/*
+ * Circular queue definitions.
+ */
+#define CIRCLEQ_HEAD(name, type)					\
+__MISMATCH_TAGS_PUSH							\
+struct name {								\
+	struct type *cqh_first;		/* first element */		\
+	struct type *cqh_last;		/* last element */		\
+}									\
+__MISMATCH_TAGS_POP
+
+#define CIRCLEQ_ENTRY(type)						\
+__MISMATCH_TAGS_PUSH							\
+struct {								\
+	struct type *cqe_next;		/* next element */		\
+	struct type *cqe_prev;		/* previous element */		\
+}									\
+__MISMATCH_TAGS_POP
+
+/*
+ * Circular queue functions.
+ */
+#define CIRCLEQ_EMPTY(head) ((head)->cqh_first == (void *)(head))
+
+#define CIRCLEQ_FIRST(head) ((head)->cqh_first)
+
+#define CIRCLEQ_FOREACH(var, head, field)				\
+	for((var) = (head)->cqh_first;					\
+	    (var) != (void *)(head);					\
+	    (var) = (var)->field.cqe_next)
+
+#define	CIRCLEQ_INIT(head) do {						\
+	(head)->cqh_first = (void *)(head);				\
+	(head)->cqh_last = (void *)(head);				\
+} while (0)
+
+#define CIRCLEQ_INSERT_AFTER(head, listelm, elm, field) do {		\
+	(elm)->field.cqe_next = (listelm)->field.cqe_next;		\
+	(elm)->field.cqe_prev = (listelm);				\
+	if ((listelm)->field.cqe_next == (void *)(head))		\
+		(head)->cqh_last = (elm);				\
+	else								\
+		(listelm)->field.cqe_next->field.cqe_prev = (elm);	\
+	(listelm)->field.cqe_next = (elm);				\
+} while (0)
+
+#define CIRCLEQ_INSERT_BEFORE(head, listelm, elm, field) do {		\
+	(elm)->field.cqe_next = (listelm);				\
+	(elm)->field.cqe_prev = (listelm)->field.cqe_prev;		\
+	if ((listelm)->field.cqe_prev == (void *)(head))		\
+		(head)->cqh_first = (elm);				\
+	else								\
+		(listelm)->field.cqe_prev->field.cqe_next = (elm);	\
+	(listelm)->field.cqe_prev = (elm);				\
+} while (0)
+
+#define CIRCLEQ_INSERT_HEAD(head, elm, field) do {			\
+	(elm)->field.cqe_next = (head)->cqh_first;			\
+	(elm)->field.cqe_prev = (void *)(head);				\
+	if ((head)->cqh_last == (void *)(head))				\
+		(head)->cqh_last = (elm);				\
+	else								\
+		(head)->cqh_first->field.cqe_prev = (elm);		\
+	(head)->cqh_first = (elm);					\
+} while (0)
+
+#define CIRCLEQ_INSERT_TAIL(head, elm, field) do {			\
+	(elm)->field.cqe_next = (void *)(head);				\
+	(elm)->field.cqe_prev = (head)->cqh_last;			\
+	if ((head)->cqh_first == (void *)(head))			\
+		(head)->cqh_first = (elm);				\
+	else								\
+		(head)->cqh_last->field.cqe_next = (elm);		\
+	(head)->cqh_last = (elm);					\
+} while (0)
+
+#define CIRCLEQ_LAST(head) ((head)->cqh_last)
+
+#define CIRCLEQ_NEXT(elm,field) ((elm)->field.cqe_next)
+
+#define CIRCLEQ_PREV(elm,field) ((elm)->field.cqe_prev)
+
+#define	CIRCLEQ_REMOVE(head, elm, field) do {				\
+	if ((elm)->field.cqe_next == (void *)(head))			\
+		(head)->cqh_last = (elm)->field.cqe_prev;		\
+	else								\
+		(elm)->field.cqe_next->field.cqe_prev =			\
+		    (elm)->field.cqe_prev;				\
+	if ((elm)->field.cqe_prev == (void *)(head))			\
+		(head)->cqh_first = (elm)->field.cqe_next;		\
+	else								\
+		(elm)->field.cqe_prev->field.cqe_next =			\
+		    (elm)->field.cqe_next;				\
+} while (0)
+
+#ifdef _KERNEL
+
+#if NOTFB31
+
+/*
+ * XXX insque() and remque() are an old way of handling certain queues.
+ * They bogusly assumes that all queue heads look alike.
+ */
+
+struct quehead {
+	struct quehead *qh_link;
+	struct quehead *qh_rlink;
+};
+
+#ifdef __GNUC__
+
+static __inline void
+insque(void *a, void *b)
+{
+	struct quehead *element = (struct quehead *)a,
+		 *head = (struct quehead *)b;
+
+	element->qh_link = head->qh_link;
+	element->qh_rlink = head;
+	head->qh_link = element;
+	element->qh_link->qh_rlink = element;
+}
+
+static __inline void
+remque(void *a)
+{
+	struct quehead *element = (struct quehead *)a;
+
+	element->qh_link->qh_rlink = element->qh_rlink;
+	element->qh_rlink->qh_link = element->qh_link;
+	element->qh_rlink = 0;
+}
+
+#else /* !__GNUC__ */
+
+void	insque(void *a, void *b);
+void	remque(void *a);
+
+#endif /* __GNUC__ */
+
+#endif
+#endif /* _KERNEL */
+
+#endif /* !_SYS_QUEUE_H_ */
diff -Nur cctools-877.5/include/sys/quota.h cctools-877.5-AnV/include/sys/quota.h
--- cctools-877.5/include/sys/quota.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/quota.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,229 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * This code is derived from software contributed to Berkeley by
+ * Robert Elz at The University of Melbourne.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)quota.h
+ *	derived from @(#)ufs/ufs/quota.h	8.3 (Berkeley) 8/19/94
+ */
+
+#ifndef _SYS_QUOTA_H
+#define _SYS_QUOTA_H
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+#include <mach/boolean.h>
+
+#ifdef __APPLE_API_UNSTABLE
+/*
+ * Definitions for disk quotas imposed on the average user
+ * (big brother finally hits UNIX).
+ *
+ * The following constants define the amount of time given a user before the
+ * soft limits are treated as hard limits (usually resulting in an allocation
+ * failure). The timer is started when the user crosses their soft limit, it
+ * is reset when they go below their soft limit.
+ */
+#define	MAX_IQ_TIME	(7*24*60*60)	/* seconds in 1 week */
+#define	MAX_DQ_TIME	(7*24*60*60)	/* seconds in 1 week */
+
+/*
+ * The following constants define the usage of the quota file array in the
+ * file system mount structure and dquot array in the inode structure.  The semantics
+ * of the elements of these arrays are defined in the routine getinoquota;
+ * the remainder of the quota code treats them generically and need not be
+ * inspected when changing the size of the array.
+ */
+#define	MAXQUOTAS	2
+#define	USRQUOTA	0	/* element used for user quotas */
+#define	GRPQUOTA	1	/* element used for group quotas */
+
+/*
+ * Definitions for the default names of the quotas files.
+ */
+#define INITQFNAMES { \
+	"user",		/* USRQUOTA */ \
+	"group",	/* GRPQUOTA */ \
+	"undefined", \
+};
+#define	QUOTAFILENAME	".quota"
+#define QUOTAOPSNAME    ".quota.ops"
+#define	QUOTAGROUP	"operator"
+
+/*
+ * Command definitions for the 'quotactl' system call.  The commands are
+ * broken into a main command defined below and a subcommand that is used
+ * to convey the type of quota that is being manipulated (see above).
+ */
+#define SUBCMDMASK	0x00ff
+#define SUBCMDSHIFT	8
+#define	QCMD(cmd, type)	(((cmd) << SUBCMDSHIFT) | ((type) & SUBCMDMASK))
+
+#define	Q_QUOTAON	0x0100	/* enable quotas */
+#define	Q_QUOTAOFF	0x0200	/* disable quotas */
+#define	Q_GETQUOTA	0x0300	/* get limits and usage */
+#define	Q_SETQUOTA	0x0400	/* set limits and usage */
+#define	Q_SETUSE	0x0500	/* set usage */
+#define	Q_SYNC		0x0600	/* sync disk copy of a filesystems quotas */
+#define	Q_QUOTASTAT	0x0700	/* get quota on/off status */
+
+/*
+ * The following two structures define the format of the disk
+ * quota file (as it appears on disk) - the file contains a
+ * header followed by a hash table of dqblk entries.  To find
+ * a particular entry, the user or group number (id) is first
+ * converted to an index into this table by means of the hash
+ * function dqhash1.  If there is a collision at that index
+ * location then a second hash value is computed which using
+ * dqhash2.  This second hash value is then used as an offset
+ * to the next location to probe.  ID = 0 is used to indicate
+ * an empty (unused) entry.  So there can never be an entry in
+ * the quota file for user 0 or group 0 (which is OK since disk
+ * quotas are never enforced for user 0).
+ *
+ * The setquota system call establishes the vnode for each quota
+ * file (a pointer is retained in the filesystem  mount structure).
+ */
+struct dqfilehdr {
+	u_int32_t dqh_magic;		
+	u_int32_t dqh_version;		/* == QF_VERSION */
+	u_int32_t dqh_maxentries;	/* must be a power of 2 */
+	u_int32_t dqh_entrycnt;		/* count of active entries */
+	u_int32_t dqh_flags;		/* reserved for now (0) */
+	u_int32_t dqh_chktime;		/* time of last quota check */
+	u_int32_t dqh_btime;		/* time limit for excessive disk use */
+	u_int32_t dqh_itime;		/* time limit for excessive files */
+	char      dqh_string[16];	/* tag string */
+	u_int32_t dqh_spare[4];		/* pad struct to power of 2 */
+};
+
+struct dqblk {
+	u_int64_t dqb_bhardlimit;	/* absolute limit on disk bytes alloc */
+	u_int64_t dqb_bsoftlimit;	/* preferred limit on disk bytes */
+	u_int64_t dqb_curbytes;	        /* current byte count */
+	u_int32_t dqb_ihardlimit;	/* maximum # allocated inodes + 1 */
+	u_int32_t dqb_isoftlimit;	/* preferred inode limit */
+	u_int32_t dqb_curinodes;	/* current # allocated inodes */
+	u_int32_t dqb_btime;		/* time limit for excessive disk use */
+	u_int32_t dqb_itime;		/* time limit for excessive files */
+	u_int32_t dqb_id;		/* identifier (0 for empty entries) */
+	u_int32_t dqb_spare[4];		/* pad struct to power of 2 */
+};
+
+
+#define INITQMAGICS { \
+	0xff31ff35,	/* USRQUOTA */ \
+	0xff31ff27,	/* GRPQUOTA */ \
+};
+
+#define QF_VERSION          1
+#define QF_STRING_TAG       "QUOTA HASH FILE"
+
+#define QF_USERS_PER_GB     256
+#define QF_MIN_USERS        2048
+#define QF_MAX_USERS       (2048*1024)
+
+#define QF_GROUPS_PER_GB    32
+#define QF_MIN_GROUPS       2048
+#define QF_MAX_GROUPS       (256*1024)
+
+
+/*
+ * The primary and secondary multiplicative hash functions are
+ * derived from Knuth (vol. 3). They use a prime that is in
+ * golden ratio to the machine's word size.
+ */
+#define dqhash1(id, shift, mask)  \
+	((((id) * 2654435761U) >> (shift)) & (mask))
+
+#define dqhash2(id, mask)  \
+	(dqhash1((id), 11, (mask)>>1) | 1)
+
+/*
+ * Compute a disk offset into a quota file.
+ */
+#define dqoffset(index)  \
+	(sizeof (struct dqfilehdr) + ((index) * sizeof (struct dqblk)))
+/*
+ * Compute the hash shift value.
+ * It is the word size, in bits, minus the hash table size, in bits.
+ */
+static __inline int dqhashshift(u_int32_t);
+
+static __inline int
+dqhashshift(u_int32_t size)
+{
+	int shift;
+
+	for (shift = 32; size > 1; size >>= 1, --shift)
+		continue;
+	return (shift);
+}
+
+
+__BEGIN_DECLS
+int quotactl(const char *, int, int, caddr_t);
+__END_DECLS
+
+
+#endif /* __APPLE_API_UNSTABLE */
+
+#endif /* !_SYS_QUOTA_H_ */
diff -Nur cctools-877.5/include/sys/random.h cctools-877.5-AnV/include/sys/random.h
--- cctools-877.5/include/sys/random.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/random.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,44 @@
+/*
+ * Copyright (c) 1999, 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef __SYS_RANDOM_H__
+#define __SYS_RANDOM_H__
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+#ifdef __APPLE_API_UNSTABLE
+__BEGIN_DECLS
+void read_random(void* buffer, u_int numBytes);
+void read_frandom(void* buffer, u_int numBytes);
+int  write_random(void* buffer, u_int numBytes);
+__END_DECLS
+#endif /* __APPLE_API_UNSTABLE */
+
+#endif /* __SYS_RANDOM_H__ */
+
diff -Nur cctools-877.5/include/sys/rbtree.h cctools-877.5-AnV/include/sys/rbtree.h
--- cctools-877.5/include/sys/rbtree.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/rbtree.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,97 @@
+/*	$NetBSD: rbtree.h,v 1.2 2012/02/17 08:20:55 yamt Exp $	*/
+
+/*-
+ * Copyright (c) 2001 The NetBSD Foundation, Inc.
+ * All rights reserved.
+ *
+ * Portions Copyright (c) 2012 Apple Inc. All rights reserved.
+ *
+ * This code is derived from software contributed to The NetBSD Foundation
+ * by Matt Thomas <matt@3am-software.com>.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
+ * ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
+ * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS
+ * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+ * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+ * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+ * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+ * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+ * POSSIBILITY OF SUCH DAMAGE.
+ */
+
+#ifndef _SYS_RBTREE_H_
+#define	_SYS_RBTREE_H_
+
+#include <Availability.h>
+
+#include <sys/types.h>
+#include <stdbool.h>
+#include <inttypes.h>
+#include <sys/queue.h>
+
+__BEGIN_DECLS
+
+
+#define	RB_DIR_LEFT		0
+#define	RB_DIR_RIGHT		1
+
+#define RB_TREE_MIN(T) rb_tree_iterate((T), NULL, RB_DIR_RIGHT)
+#define RB_TREE_MAX(T) rb_tree_iterate((T), NULL, RB_DIR_LEFT)
+#define RB_TREE_FOREACH(N, T) \
+    for ((N) = RB_TREE_MIN(T); (N); \
+	(N) = rb_tree_iterate((T), (N), RB_DIR_RIGHT))
+#define RB_TREE_FOREACH_REVERSE(N, T) \
+    for ((N) = RB_TREE_MAX(T); (N); \
+	(N) = rb_tree_iterate((T), (N), RB_DIR_LEFT))
+
+/*
+ * rbto_compare_nodes_fn:
+ *	return a positive value if the first node > the second node.
+ *	return a negative value if the first node < the second node.
+ *	return 0 if they are considered same.
+ *
+ * rbto_compare_key_fn:
+ *	return a positive value if the node > the key.
+ *	return a negative value if the node < the key.
+ *	return 0 if they are considered same.
+ */
+
+typedef signed int (*rbto_compare_nodes_fn)(void *, const void *, const void *);
+typedef signed int (*rbto_compare_key_fn)(void *, const void *, const void *);
+
+typedef struct {
+	rbto_compare_nodes_fn rbto_compare_nodes;
+	rbto_compare_key_fn rbto_compare_key;
+	size_t rbto_node_offset;
+	void *rbto_context;
+} rb_tree_ops_t;
+
+typedef struct rb_node { void * opaque[3]; } rb_node_t;
+typedef struct rb_tree { void *opaque[8]; } rb_tree_t;
+
+#define _rb_availability __OSX_AVAILABLE_STARTING(__MAC_10_9,__IPHONE_7_0);
+void	rb_tree_init(rb_tree_t *, const rb_tree_ops_t *) _rb_availability;
+void *	rb_tree_insert_node(rb_tree_t *, void *) _rb_availability;
+void *	rb_tree_find_node(rb_tree_t *, const void *) _rb_availability;
+void *	rb_tree_find_node_geq(rb_tree_t *, const void *) _rb_availability;
+void *	rb_tree_find_node_leq(rb_tree_t *, const void *) _rb_availability;
+void	rb_tree_remove_node(rb_tree_t *, void *) _rb_availability;
+void *	rb_tree_iterate(rb_tree_t *, void *, const unsigned int) _rb_availability;
+size_t  rb_tree_count(rb_tree_t *) _rb_availability;
+#undef _rb_availability
+
+__END_DECLS
+
+#endif	/* _SYS_RBTREE_H_*/
diff -Nur cctools-877.5/include/sys/reboot.h cctools-877.5-AnV/include/sys/reboot.h
--- cctools-877.5/include/sys/reboot.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/reboot.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,131 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1988, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)reboot.h	8.3 (Berkeley) 12/13/94
+ */
+
+#ifndef	_SYS_REBOOT_H_
+#define _SYS_REBOOT_H_
+
+#include <sys/appleapiopts.h>
+
+/*
+ * Arguments to reboot system call.
+ */
+
+#ifdef __APPLE_API_PRIVATE
+#define RB_AUTOBOOT	0	/* flags for system auto-booting itself */
+
+#define RB_ASKNAME	0x01	/* ask for file name to reboot from */
+#define RB_SINGLE	0x02	/* reboot to single user only */
+#define RB_NOSYNC	0x04	/* dont sync before reboot */
+#define RB_HALT		0x08	/* don't reboot, just halt */
+#define RB_INITNAME	0x10	/* name given for /etc/init */
+#define RB_DFLTROOT	0x20	/* use compiled-in rootdev */
+#define RB_ALTBOOT	0x40	/* use /boot.old vs /boot */
+#define RB_UNIPROC	0x80	/* don't start slaves */
+#define RB_SAFEBOOT	0x100	/* booting safe */
+#define RB_UPSDELAY 0x200   /* Delays restart by 5 minutes */
+#define RB_QUICK	0x400	/* quick and ungraceful reboot with file system caches flushed*/
+#define RB_PANIC	0	/* reboot due to panic */
+#define RB_BOOT		1	/* reboot due to boot() */
+
+#endif /* __APPLE_API_PRIVATE */
+
+#ifdef __APPLE_API_OBSOLETE
+/*
+ * Constants for converting boot-style device number to type,
+ * adaptor (uba, mba, etc), unit number and partition number.
+ * Type (== major device number) is in the low byte
+ * for backward compatibility.  Except for that of the "magic
+ * number", each mask applies to the shifted value.
+ * Format:
+ *	 (4) (4) (4) (4)  (8)     (8)
+ *	--------------------------------
+ *	|MA | AD| CT| UN| PART  | TYPE |
+ *	--------------------------------
+ */
+#define B_ADAPTORSHIFT	24
+#define B_ADAPTORMASK	0x0f
+#define	B_ADAPTOR(val)		(((val) >> B_ADAPTORSHIFT) & B_ADAPTORMASK)
+#define B_CONTROLLERSHIFT	20
+#define B_CONTROLLERMASK	0xf
+#define	B_CONTROLLER(val)	(((val)>>B_CONTROLLERSHIFT) & B_CONTROLLERMASK)
+#define B_UNITSHIFT	16
+#define B_UNITMASK	0xff
+#define	B_UNIT(val)		(((val) >> B_UNITSHIFT) & B_UNITMASK)
+#define B_PARTITIONSHIFT 8
+#define B_PARTITIONMASK	0xff
+#define	B_PARTITION(val)	(((val) >> B_PARTITIONSHIFT) & B_PARTITIONMASK)
+#define B_TYPESHIFT	0
+#define B_TYPEMASK	0xff
+#define	B_TYPE(val)		(((val) >> B_TYPESHIFT) & B_TYPEMASK)
+#define B_MAGICMASK	0xf0000000
+#define B_DEVMAGIC	0xa0000000
+
+#define MAKEBOOTDEV(type, adaptor, controller, unit, partition) \
+	(((type) << B_TYPESHIFT) | ((adaptor) << B_ADAPTORSHIFT) | \
+	((controller) << B_CONTROLLERSHIFT) | ((unit) << B_UNITSHIFT) | \
+	((partition) << B_PARTITIONSHIFT) | B_DEVMAGIC)
+
+#endif /* __APPLE_API_OBSOLETE */
+
+
+#endif	/* _SYS_REBOOT_H_ */
diff -Nur cctools-877.5/include/sys/resource.h cctools-877.5-AnV/include/sys/resource.h
--- cctools-877.5/include/sys/resource.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/resource.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,396 @@
+/*
+ * Copyright (c) 2000-2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)resource.h	8.2 (Berkeley) 1/4/94
+ */
+
+#ifndef _SYS_RESOURCE_H_
+#define	_SYS_RESOURCE_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/_types.h>
+
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#include <stdint.h>
+#endif /* __DARWIN_C_LEVEL >= __DARWIN_C_FULL */
+
+#include <Availability.h>
+
+/* [XSI] The timeval structure shall be defined as described in
+ * <sys/time.h>
+ */
+#include <sys/_types/_timeval.h>
+
+/* The id_t type shall be defined as described in <sys/types.h> */
+#include <sys/_types/_id_t.h>
+
+
+/*
+ * Resource limit type (low 63 bits, excluding the sign bit)
+ */
+typedef __uint64_t	rlim_t;
+
+
+/*****
+ * PRIORITY
+ */
+
+/*
+ * Possible values of the first parameter to getpriority()/setpriority(),
+ * used to indicate the type of the second parameter.
+ */
+#define	PRIO_PROCESS	0		/* Second argument is a PID */
+#define	PRIO_PGRP	1		/* Second argument is a GID */
+#define	PRIO_USER	2		/* Second argument is a UID */
+
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define	PRIO_DARWIN_THREAD	3		/* Second argument is always 0 (current thread) */
+#define	PRIO_DARWIN_PROCESS	4		/* Second argument is a PID */
+
+
+/*
+ * Range limitations for the value of the third parameter to setpriority().
+ */
+#define	PRIO_MIN	-20
+#define	PRIO_MAX	20
+
+/* 
+ * use PRIO_DARWIN_BG to set the current thread into "background" state
+ * which lowers CPU, disk IO, and networking priorites until thread terminates
+ * or "background" state is revoked
+ */
+#define PRIO_DARWIN_BG 0x1000
+
+/*
+ * use PRIO_DARWIN_NONUI to restrict a process's ability to make calls to
+ * the GPU. (deprecated)
+ */
+#define PRIO_DARWIN_NONUI 0x1001
+
+#endif	/* __DARWIN_C_LEVEL >= __DARWIN_C_FULL */
+
+
+
+/*****
+ * RESOURCE USAGE
+ */
+
+/*
+ * Possible values of the first parameter to getrusage(), used to indicate
+ * the scope of the information to be returned.
+ */
+#define	RUSAGE_SELF	0		/* Current process information */
+#define	RUSAGE_CHILDREN	-1		/* Current process' children */
+
+/*
+ * A structure representing an accounting of resource utilization.  The
+ * address of an instance of this structure is the second parameter to
+ * getrusage().
+ *
+ * Note: All values other than ru_utime and ru_stime are implementaiton
+ *       defined and subject to change in a future release.  Their use
+ *       is discouraged for standards compliant programs.
+ */
+struct	rusage {
+	struct timeval ru_utime;	/* user time used (PL) */
+	struct timeval ru_stime;	/* system time used (PL) */
+#if __DARWIN_C_LEVEL < __DARWIN_C_FULL
+	long	ru_opaque[14];		/* implementation defined */
+#else
+	/*
+	 * Informational aliases for source compatibility with programs
+	 * that need more information than that provided by standards,
+	 * and which do not mind being OS-dependent.
+	 */
+	long	ru_maxrss;		/* max resident set size (PL) */
+#define	ru_first	ru_ixrss	/* internal: ruadd() range start */
+	long	ru_ixrss;		/* integral shared memory size (NU) */
+	long	ru_idrss;		/* integral unshared data (NU)  */
+	long	ru_isrss;		/* integral unshared stack (NU) */
+	long	ru_minflt;		/* page reclaims (NU) */
+	long	ru_majflt;		/* page faults (NU) */
+	long	ru_nswap;		/* swaps (NU) */
+	long	ru_inblock;		/* block input operations (atomic) */
+	long	ru_oublock;		/* block output operations (atomic) */
+	long	ru_msgsnd;		/* messages sent (atomic) */
+	long	ru_msgrcv;		/* messages received (atomic) */
+	long	ru_nsignals;		/* signals received (atomic) */
+	long	ru_nvcsw;		/* voluntary context switches (atomic) */
+	long	ru_nivcsw;		/* involuntary " */
+#define	ru_last		ru_nivcsw	/* internal: ruadd() range end */
+#endif	/* __DARWIN_C_LEVEL >= __DARWIN_C_FULL */
+};
+
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+/*
+ * Flavors for proc_pid_rusage().
+ */
+#define RUSAGE_INFO_V0	0
+#define RUSAGE_INFO_V1	1
+#define RUSAGE_INFO_V2	2
+#define RUSAGE_INFO_V3	3
+#define	RUSAGE_INFO_CURRENT RUSAGE_INFO_V3
+
+typedef void *rusage_info_t;
+
+struct rusage_info_v0 {
+	uint8_t  ri_uuid[16];
+	uint64_t ri_user_time;
+	uint64_t ri_system_time;
+	uint64_t ri_pkg_idle_wkups;
+	uint64_t ri_interrupt_wkups;
+	uint64_t ri_pageins;
+	uint64_t ri_wired_size;
+	uint64_t ri_resident_size;	
+	uint64_t ri_phys_footprint;
+	uint64_t ri_proc_start_abstime;
+	uint64_t ri_proc_exit_abstime;
+};
+
+struct rusage_info_v1 {
+	uint8_t  ri_uuid[16];
+	uint64_t ri_user_time;
+	uint64_t ri_system_time;
+	uint64_t ri_pkg_idle_wkups;
+	uint64_t ri_interrupt_wkups;
+	uint64_t ri_pageins;
+	uint64_t ri_wired_size;
+	uint64_t ri_resident_size;	
+	uint64_t ri_phys_footprint;
+	uint64_t ri_proc_start_abstime;
+	uint64_t ri_proc_exit_abstime;
+	uint64_t ri_child_user_time;
+	uint64_t ri_child_system_time;
+	uint64_t ri_child_pkg_idle_wkups;
+	uint64_t ri_child_interrupt_wkups;
+	uint64_t ri_child_pageins;
+	uint64_t ri_child_elapsed_abstime;
+};
+
+struct rusage_info_v2 {
+	uint8_t  ri_uuid[16];
+	uint64_t ri_user_time;
+	uint64_t ri_system_time;
+	uint64_t ri_pkg_idle_wkups;
+	uint64_t ri_interrupt_wkups;
+	uint64_t ri_pageins;
+	uint64_t ri_wired_size;
+	uint64_t ri_resident_size;	
+	uint64_t ri_phys_footprint;
+	uint64_t ri_proc_start_abstime;
+	uint64_t ri_proc_exit_abstime;
+	uint64_t ri_child_user_time;
+	uint64_t ri_child_system_time;
+	uint64_t ri_child_pkg_idle_wkups;
+	uint64_t ri_child_interrupt_wkups;
+	uint64_t ri_child_pageins;
+	uint64_t ri_child_elapsed_abstime;
+	uint64_t ri_diskio_bytesread;
+	uint64_t ri_diskio_byteswritten;
+};
+
+struct rusage_info_v3 {
+	uint8_t  ri_uuid[16];
+	uint64_t ri_user_time;
+	uint64_t ri_system_time;
+	uint64_t ri_pkg_idle_wkups;
+	uint64_t ri_interrupt_wkups;
+	uint64_t ri_pageins;
+	uint64_t ri_wired_size;
+	uint64_t ri_resident_size;	
+	uint64_t ri_phys_footprint;
+	uint64_t ri_proc_start_abstime;
+	uint64_t ri_proc_exit_abstime;
+	uint64_t ri_child_user_time;
+	uint64_t ri_child_system_time;
+	uint64_t ri_child_pkg_idle_wkups;
+	uint64_t ri_child_interrupt_wkups;
+	uint64_t ri_child_pageins;
+	uint64_t ri_child_elapsed_abstime;
+	uint64_t ri_diskio_bytesread;
+	uint64_t ri_diskio_byteswritten;
+	uint64_t ri_cpu_time_qos_default;
+	uint64_t ri_cpu_time_qos_maintenance;
+	uint64_t ri_cpu_time_qos_background;
+	uint64_t ri_cpu_time_qos_utility;
+	uint64_t ri_cpu_time_qos_legacy;
+	uint64_t ri_cpu_time_qos_user_initiated;
+	uint64_t ri_cpu_time_qos_user_interactive;
+	uint64_t ri_billed_system_time;
+	uint64_t ri_serviced_system_time;
+};
+
+typedef struct rusage_info_v3 rusage_info_current;
+
+#endif /* __DARWIN_C_LEVEL >= __DARWIN_C_FULL */
+
+
+
+/*****
+ * RESOURCE LIMITS
+ */
+
+/*
+ * Symbolic constants for resource limits; since all limits are representable
+ * as a type rlim_t, we are permitted to define RLIM_SAVED_* in terms of
+ * RLIM_INFINITY.
+ */
+#define	RLIM_INFINITY	(((__uint64_t)1 << 63) - 1)	/* no limit */
+#define	RLIM_SAVED_MAX	RLIM_INFINITY	/* Unrepresentable hard limit */
+#define	RLIM_SAVED_CUR	RLIM_INFINITY	/* Unrepresentable soft limit */
+
+/*
+ * Possible values of the first parameter to getrlimit()/setrlimit(), to
+ * indicate for which resource the operation is being performed.
+ */
+#define	RLIMIT_CPU	0		/* cpu time per process */
+#define	RLIMIT_FSIZE	1		/* file size */
+#define	RLIMIT_DATA	2		/* data segment size */
+#define	RLIMIT_STACK	3		/* stack size */
+#define	RLIMIT_CORE	4		/* core file size */
+#define	RLIMIT_AS	5		/* address space (resident set size) */
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define	RLIMIT_RSS	RLIMIT_AS	/* source compatibility alias */
+#define	RLIMIT_MEMLOCK	6		/* locked-in-memory address space */
+#define	RLIMIT_NPROC	7		/* number of processes */
+#endif	/* __DARWIN_C_LEVEL >= __DARWIN_C_FULL */
+#define	RLIMIT_NOFILE	8		/* number of open files */
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+#define	RLIM_NLIMITS	9		/* total number of resource limits */
+#endif	/* __DARWIN_C_LEVEL >= __DARWIN_C_FULL */
+#define _RLIMIT_POSIX_FLAG	0x1000	/* Set bit for strict POSIX */
+
+/*
+ * A structure representing a resource limit.  The address of an instance
+ * of this structure is the second parameter to getrlimit()/setrlimit().
+ */
+struct rlimit {
+	rlim_t	rlim_cur;		/* current (soft) limit */
+	rlim_t	rlim_max;		/* maximum value for rlim_cur */
+};
+
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+/*
+ * proc_rlimit_control()
+ *
+ * Resource limit flavors
+ */
+#define RLIMIT_WAKEUPS_MONITOR		0x1 /* Configure the wakeups monitor. */
+#define	RLIMIT_CPU_USAGE_MONITOR	0x2 /* Configure the CPU usage monitor. */
+#define	RLIMIT_THREAD_CPULIMITS		0x3 /* Configure a blocking, per-thread, CPU limits. */
+
+/*
+ * Flags for wakeups monitor control.
+ */
+#define WAKEMON_ENABLE			0x01
+#define WAKEMON_DISABLE			0x02
+#define WAKEMON_GET_PARAMS		0x04
+#define WAKEMON_SET_DEFAULTS		0x08
+#define	WAKEMON_MAKE_FATAL		0x10 /* Configure the task so that violations are fatal. */
+/*
+ * Flags for CPU usage monitor control.
+ */
+#define	CPUMON_MAKE_FATAL		0x1000
+
+struct proc_rlimit_control_wakeupmon {
+	uint32_t wm_flags;
+	int32_t wm_rate;
+};
+
+/* I/O type */
+#define IOPOL_TYPE_DISK	0
+
+/* scope */
+#define IOPOL_SCOPE_PROCESS   0
+#define IOPOL_SCOPE_THREAD    1
+#define IOPOL_SCOPE_DARWIN_BG 2
+
+/* I/O Priority */
+#define IOPOL_DEFAULT		0
+#define IOPOL_IMPORTANT		1
+#define IOPOL_PASSIVE		2
+#define IOPOL_THROTTLE		3
+#define IOPOL_UTILITY		4
+#define IOPOL_STANDARD		5
+
+/* compatibility with older names */
+#define IOPOL_APPLICATION       IOPOL_STANDARD
+#define IOPOL_NORMAL            IOPOL_IMPORTANT
+
+
+#endif /* __DARWIN_C_LEVEL >= __DARWIN_C_FULL */
+
+
+__BEGIN_DECLS
+int	getpriority(int, id_t);
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+int	getiopolicy_np(int, int) __OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0);
+#endif /* __DARWIN_C_LEVEL >= __DARWIN_C_FULL */
+int	getrlimit(int, struct rlimit *) __DARWIN_ALIAS(getrlimit);
+int	getrusage(int, struct rusage *);
+int	setpriority(int, id_t, int);
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+int	setiopolicy_np(int, int, int) __OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0);
+#endif /* __DARWIN_C_LEVEL >= __DARWIN_C_FULL */
+int	setrlimit(int, const struct rlimit *) __DARWIN_ALIAS(setrlimit);
+__END_DECLS
+
+#endif	/* !_SYS_RESOURCE_H_ */
diff -Nur cctools-877.5/include/sys/resourcevar.h cctools-877.5-AnV/include/sys/resourcevar.h
--- cctools-877.5/include/sys/resourcevar.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/resourcevar.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,110 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995, 1997 Apple Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)resourcevar.h	8.4 (Berkeley) 1/9/95
+ */
+
+#ifndef	_SYS_RESOURCEVAR_H_
+#define	_SYS_RESOURCEVAR_H_
+
+#include <sys/appleapiopts.h>
+
+/*
+ * Kernel per-process accounting / statistics
+ * (not necessarily resident except when running).
+ */
+struct pstats {
+	struct	rusage            p_ru;		/* stats for this proc */
+	struct	rusage            p_cru;	/* (PL) sum of stats for reaped children */
+
+	struct uprof {			/* profile arguments */
+		struct uprof *pr_next;  /* multiple prof buffers allowed */
+		caddr_t	pr_base;	/* buffer base */
+		u_int32_t	pr_size;	/* buffer size */
+		u_int32_t	pr_off;		/* pc offset */
+		u_int32_t	pr_scale;	/* pc scaling */
+		u_int32_t	pr_addr;	/* temp storage for addr until AST */
+		u_int32_t	pr_ticks;	/* temp storage for ticks until AST */
+	} p_prof;
+	
+	uint64_t ps_start;       	/* starting time ; compat only */
+};
+
+/*
+ * Kernel shareable process resource limits.  Because this structure
+ * is moderately large but changes infrequently, it is normally
+ * shared copy-on-write after forks.  If a group of processes
+ * ("threads") share modifications, the PL_SHAREMOD flag is set,
+ * and a copy must be made for the child of a new fork that isn't
+ * sharing modifications to the limits.
+ */
+/* 
+ * Modifications are done with the list lock held (p_limit as well)and access indv 
+ * limits can be done without limit as we keep the old copy in p_olimit. Which is 
+ * dropped in proc_exit. This way all access will have a valid kernel address
+ */
+struct plimit {
+	struct	rlimit pl_rlimit[RLIM_NLIMITS];
+	int	pl_refcnt;		/* number of references */
+};
+
+
+
+#endif	/* !_SYS_RESOURCEVAR_H_ */
diff -Nur cctools-877.5/include/sys/sbuf.h cctools-877.5-AnV/include/sys/sbuf.h
--- cctools-877.5/include/sys/sbuf.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/sbuf.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,79 @@
+/*-
+ * Copyright (c) 2000 Poul-Henning Kamp and Dag-Erling Codan Smrgrav
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer
+ *    in this position and unchanged.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. The name of the author may not be used to endorse or promote products
+ *    derived from this software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+ * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
+ * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
+ * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
+ * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ *
+ *      $FreeBSD: /repoman/r/ncvs/src/sys/sys/sbuf.h,v 1.14 2004/07/09 11:35:30 des Exp $
+ */
+
+#ifndef _SYS_SBUF_H_
+#define	_SYS_SBUF_H_
+
+#include <sys/_types.h>
+#include <stdarg.h>
+
+/*
+ * Structure definition
+ */
+struct sbuf {
+	char		*s_buf;		/* storage buffer */
+	void		*s_unused;	/* binary compatibility. */
+	int		 s_size;	/* size of storage buffer */
+	int		 s_len;		/* current length of string */
+#define	SBUF_FIXEDLEN	0x00000000	/* fixed length buffer (default) */
+#define	SBUF_AUTOEXTEND	0x00000001	/* automatically extend buffer */
+#define	SBUF_USRFLAGMSK 0x0000ffff	/* mask of flags the user may specify */
+#define	SBUF_DYNAMIC	0x00010000	/* s_buf must be freed */
+#define	SBUF_FINISHED	0x00020000	/* set by sbuf_finish() */
+#define	SBUF_OVERFLOWED	0x00040000	/* sbuf overflowed */
+#define	SBUF_DYNSTRUCT	0x00080000	/* sbuf must be freed */
+	int		 s_flags;	/* flags */
+};
+
+__BEGIN_DECLS
+/*
+ * API functions
+ */
+struct sbuf	*sbuf_new(struct sbuf *, char *, int, int);
+void		 sbuf_clear(struct sbuf *);
+int		 sbuf_setpos(struct sbuf *, int);
+int		 sbuf_bcat(struct sbuf *, const void *, size_t);
+int		 sbuf_bcpy(struct sbuf *, const void *, size_t);
+int		 sbuf_cat(struct sbuf *, const char *);
+int		 sbuf_cpy(struct sbuf *, const char *);
+int		 sbuf_printf(struct sbuf *, const char *, ...) __printflike(2, 3);
+int		 sbuf_vprintf(struct sbuf *, const char *, va_list) __printflike(2, 0);
+int		 sbuf_putc(struct sbuf *, int);
+int		 sbuf_trim(struct sbuf *);
+int		 sbuf_overflowed(struct sbuf *);
+void		 sbuf_finish(struct sbuf *);
+char		*sbuf_data(struct sbuf *);
+int		 sbuf_len(struct sbuf *);
+int		 sbuf_done(struct sbuf *);
+void		 sbuf_delete(struct sbuf *);
+
+__END_DECLS
+
+#endif
diff -Nur cctools-877.5/include/sys/sdt.h cctools-877.5-AnV/include/sys/sdt.h
--- cctools-877.5/include/sys/sdt.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/sdt.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,47 @@
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License, Version 1.0 only
+ * (the "License").  You may not use this file except in compliance
+ * with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+/*
+ * Copyright 2004 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef _SYS_SDT_H
+#define	_SYS_SDT_H
+
+/*
+ * This is a wrapper header that wraps the mach visible sdt.h header so that
+ * the header file ends up visible where software expects it to be.  We also
+ * do the C/C++ symbol wrapping here, since Mach headers are technically C
+ * interfaces.
+ *
+ * Note:  The process of adding USDT probes to code is slightly different
+ * than documented in the "Solaris Dynamic Tracing Guide".
+ * The DTRACE_PROBE*() macros are not supported on Mac OS X -- instead see
+ * "BUILDING CODE CONTAINING USDT PROBES" in the dtrace(1) manpage
+ *
+ */
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+#include <mach/sdt.h>
+__END_DECLS
+
+#endif	/* _SYS_SDT_H */
diff -Nur cctools-877.5/include/sys/select.h cctools-877.5-AnV/include/sys/select.h
--- cctools-877.5/include/sys/select.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/select.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,134 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)select.h	8.2 (Berkeley) 1/4/94
+ */
+
+#ifndef _SYS_SELECT_H_
+#define	_SYS_SELECT_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/_types.h>
+
+/*
+ * [XSI] The <sys/select.h> header shall define the fd_set type as a structure.
+ * The timespec structure shall be defined as described in <time.h>
+ * The <sys/select.h> header shall define the timeval structure.
+ */
+#include <sys/_types/_fd_def.h>
+#include <sys/_types/_timespec.h>
+#include <sys/_types/_timeval.h>
+
+/*
+ * The time_t and suseconds_t types shall be defined as described in
+ * <sys/types.h>
+ * The sigset_t type shall be defined as described in <signal.h>
+ */
+#include <sys/_types/_time_t.h>
+#include <sys/_types/_suseconds_t.h>
+#include <sys/_types/_sigset_t.h>
+
+/*
+ * [XSI] FD_CLR, FD_ISSET, FD_SET, FD_ZERO may be declared as a function, or
+ *	 defined as a macro, or both
+ * [XSI] FD_SETSIZE shall be defined as a macro
+ */
+
+/*
+ * Select uses bit masks of file descriptors in longs.  These macros
+ * manipulate such bit fields (the filesystem macros use chars).  The
+ * extra protection here is to permit application redefinition above
+ * the default size.
+ */
+#include <sys/_types/_fd_setsize.h>
+#include <sys/_types/_fd_set.h>
+#include <sys/_types/_fd_clr.h>
+#include <sys/_types/_fd_isset.h>
+#include <sys/_types/_fd_zero.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#include <sys/_types/_fd_copy.h>
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+
+__BEGIN_DECLS
+
+#ifndef  __MWERKS__
+int	 pselect(int, fd_set * __restrict, fd_set * __restrict,
+		fd_set * __restrict, const struct timespec * __restrict,
+		const sigset_t * __restrict)
+#if defined(_DARWIN_C_SOURCE) || defined(_DARWIN_UNLIMITED_SELECT)
+		__DARWIN_EXTSN_C(pselect)
+#else /* !_DARWIN_C_SOURCE && !_DARWIN_UNLIMITED_SELECT */
+#  if defined(__LP64__) && !__DARWIN_NON_CANCELABLE
+		__DARWIN_1050(pselect)
+#  else /* !__LP64__ || __DARWIN_NON_CANCELABLE */
+		__DARWIN_ALIAS_C(pselect)
+#  endif /* __LP64__ && !__DARWIN_NON_CANCELABLE */
+#endif /* _DARWIN_C_SOURCE || _DARWIN_UNLIMITED_SELECT */
+		;
+#endif /* __MWERKS__ */
+
+#include <sys/_select.h>	/* select() prototype */
+
+__END_DECLS
+
+
+#endif /* !_SYS_SELECT_H_ */
diff -Nur cctools-877.5/include/sys/sem.h cctools-877.5-AnV/include/sys/sem.h
--- cctools-877.5/include/sys/sem.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/sem.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,205 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*	$NetBSD: sem.h,v 1.5 1994/06/29 06:45:15 cgd Exp $	*/
+
+/*
+ * SVID compatible sem.h file
+ *
+ * Author:  Daniel Boulet
+ * John Bellardo modified the implementation for Darwin. 12/2000
+ */
+
+#ifndef _SYS_SEM_H_
+#define _SYS_SEM_H_
+
+
+#include <sys/cdefs.h>
+#include <sys/_types.h>
+
+/*
+ * [XSI]	All of the symbols from <sys/ipc.h> SHALL be defined
+ *		when this header is included
+ */
+#include <sys/ipc.h>
+
+
+/*
+ * [XSI] The pid_t, time_t, key_t, and size_t types shall be defined as
+ * described in <sys/types.h>.
+ *
+ * NOTE:	The definition of the key_t type is implicit from the
+ *		inclusion of <sys/ipc.h>
+ */
+#include <sys/_types/_pid_t.h>
+#include <sys/_types/_time_t.h>
+#include <sys/_types/_size_t.h>
+
+/*
+ * Technically, we should force all code references to the new structure
+ * definition, not in just the standards conformance case, and leave the
+ * legacy interface there for binary compatibility only.  Currently, we
+ * are only forcing this for programs requesting standards conformance.
+ */
+#if __DARWIN_UNIX03 || defined(KERNEL)
+#pragma pack(4)
+/*
+ * Structure used internally.
+ * 
+ * This structure is exposed because standards dictate that it is used as
+ * the semun union member 'buf' as the fourth argment to semctl() when the
+ * third argument is IPC_STAT or IPC_SET.
+ *
+ * Note: only the fields sem_perm, sem_nsems, sem_otime, and sem_ctime
+ * are meaningful in user space.
+ */
+#if (defined(_POSIX_C_SOURCE) && !defined(_DARWIN_C_SOURCE))
+struct semid_ds
+#else
+#define	semid_ds	__semid_ds_new
+struct __semid_ds_new
+#endif
+{
+	struct __ipc_perm_new sem_perm;	/* [XSI] operation permission struct */
+	__int32_t	sem_base;	/* 32 bit base ptr for semaphore set */
+	unsigned short	sem_nsems;	/* [XSI] number of sems in set */
+	time_t		sem_otime;	/* [XSI] last operation time */
+	__int32_t	sem_pad1;	/* RESERVED: DO NOT USE! */
+	time_t		sem_ctime;	/* [XSI] last change time */
+    					/* Times measured in secs since */
+    					/* 00:00:00 GMT, Jan. 1, 1970 */
+	__int32_t	sem_pad2;	/* RESERVED: DO NOT USE! */
+	__int32_t	sem_pad3[4];	/* RESERVED: DO NOT USE! */
+};
+#pragma pack()
+#else	/* !__DARWIN_UNIX03 */
+#define	semid_ds	__semid_ds_old
+#endif	/* __DARWIN_UNIX03 */
+
+#if !__DARWIN_UNIX03
+struct __semid_ds_old {
+	struct __ipc_perm_old sem_perm;	/* [XSI] operation permission struct */
+	__int32_t	sem_base;	/* 32 bit base ptr for semaphore set */
+	unsigned short	sem_nsems;	/* [XSI] number of sems in set */
+	time_t		sem_otime;	/* [XSI] last operation time */
+	__int32_t	sem_pad1;	/* RESERVED: DO NOT USE! */
+	time_t		sem_ctime;	/* [XSI] last change time */
+    					/* Times measured in secs since */
+    					/* 00:00:00 GMT, Jan. 1, 1970 */
+	__int32_t	sem_pad2;	/* RESERVED: DO NOT USE! */
+	__int32_t	sem_pad3[4];	/* RESERVED: DO NOT USE! */
+};
+#endif	/* !__DARWIN_UNIX03 */
+
+/*
+ * Possible values for the third argument to semctl()
+ */
+#define GETNCNT	3	/* [XSI] Return the value of semncnt {READ} */
+#define GETPID	4	/* [XSI] Return the value of sempid {READ} */
+#define GETVAL	5	/* [XSI] Return the value of semval {READ} */
+#define GETALL	6	/* [XSI] Return semvals into arg.array {READ} */
+#define GETZCNT	7	/* [XSI] Return the value of semzcnt {READ} */
+#define SETVAL	8	/* [XSI] Set the value of semval to arg.val {ALTER} */
+#define SETALL	9	/* [XSI] Set semvals from arg.array {ALTER} */
+
+
+/* A semaphore; this is an anonymous structure, not for external use */
+struct sem {
+	unsigned short	semval;		/* semaphore value */
+	pid_t		sempid;		/* pid of last operation */
+	unsigned short	semncnt;	/* # awaiting semval > cval */
+	unsigned short	semzcnt;	/* # awaiting semval == 0 */
+};
+
+
+/*
+ * Structure of array element for second argument to semop()
+ */
+struct sembuf {
+	unsigned short	sem_num;	/* [XSI] semaphore # */
+	short		sem_op;		/* [XSI] semaphore operation */
+	short		sem_flg;	/* [XSI] operation flags */
+};
+
+/*
+ * Possible flag values for sem_flg
+ */
+#define SEM_UNDO	010000		/* [XSI] Set up adjust on exit entry */
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+
+/*
+ * Union used as the fourth argment to semctl() in all cases.  Specific
+ * member values are used for different values of the third parameter:
+ * 
+ * Command					Member
+ * -------------------------------------------	------
+ * GETALL, SETALL				array
+ * SETVAL					val
+ * IPC_STAT, IPC_SET				buf
+ *
+ * The union definition is intended to be defined by the user application
+ * in conforming applications; it is provided here for two reasons:
+ * 
+ * 1)	Historical source compatability for non-conforming applications
+ *	expecting this header to declare the union type on their behalf
+ *
+ * 2)	Documentation; specifically, 64 bit applications that do not pass
+ *	this structure for 'val', or, alternately, a 64 bit type, will
+ *	not function correctly
+ */
+union semun {
+	int		val;		/* value for SETVAL */
+	struct semid_ds	*buf;		/* buffer for IPC_STAT & IPC_SET */
+	unsigned short	*array;		/* array for GETALL & SETALL */
+};
+typedef union semun semun_t;
+
+
+/*
+ * Permissions
+ */
+#define SEM_A		0200	/* alter permission */
+#define SEM_R		0400	/* read permission */
+
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+
+
+
+__BEGIN_DECLS
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+int	semsys(int, ...);
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+int	semctl(int, int, int, ...) __DARWIN_ALIAS(semctl);
+int	semget(key_t, int, int);
+int	semop(int, struct sembuf *, size_t);
+__END_DECLS
+
+
+#endif /* !_SEM_H_ */
diff -Nur cctools-877.5/include/sys/semaphore.h cctools-877.5-AnV/include/sys/semaphore.h
--- cctools-877.5/include/sys/semaphore.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/semaphore.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,64 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*	@(#)semaphore.h	1.0	2/29/00		*/
+
+
+
+/* 
+ * semaphore.h - POSIX semaphores
+ *
+ * HISTORY
+ * 29-Feb-00	A.Ramesh at Apple
+ *	Created for Mac OS X
+ */
+
+#ifndef	_SYS_SEMAPHORE_H_
+#define _SYS_SEMAPHORE_H_
+
+typedef int sem_t;
+
+/* this should go in limits.h> */
+#define SEM_VALUE_MAX 32767
+#define SEM_FAILED ((sem_t *)-1)
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+int sem_close(sem_t *);
+int sem_destroy(sem_t *) __deprecated;
+int sem_getvalue(sem_t * __restrict, int * __restrict) __deprecated;
+int sem_init(sem_t *, int, unsigned int) __deprecated;
+sem_t * sem_open(const char *, int, ...);
+int sem_post(sem_t *);
+int sem_trywait(sem_t *);
+int sem_unlink(const char *);
+int sem_wait(sem_t *) __DARWIN_ALIAS_C(sem_wait);
+__END_DECLS
+
+
+#endif	/* _SYS_SEMAPHORE_H_ */
diff -Nur cctools-877.5/include/sys/shm.h cctools-877.5-AnV/include/sys/shm.h
--- cctools-877.5/include/sys/shm.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/shm.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,186 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*	$NetBSD: shm.h,v 1.15 1994/06/29 06:45:17 cgd Exp $	*/
+
+/*
+ * Copyright (c) 1994 Adam Glass
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *      This product includes software developed by Adam Glass.
+ * 4. The name of the author may not be used to endorse or promote products
+ *    derived from this software without specific prior written permission
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+ * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
+ * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
+ * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
+ * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ */
+
+/*
+ * As defined+described in "X/Open System Interfaces and Headers"
+ *                         Issue 4, p. XXX
+ */
+
+#ifndef _SYS_SHM_H_
+#define _SYS_SHM_H_
+
+#include <sys/cdefs.h>
+#include <sys/_types.h>
+
+/*
+ * [XSI]	All of the symbols from <sys/ipc.h> SHALL be defined
+ *		when this header is included
+ */
+#include <sys/ipc.h>
+
+/*
+ * [XSI] The pid_t, time_t, key_t, and size_t types shall be defined as
+ * described in <sys/types.h>.
+ *
+ * NOTE:	The definition of the key_t type is implicit from the
+ *		inclusion of <sys/ipc.h>
+ */
+#include <sys/_types/_pid_t.h>
+#include <sys/_types/_time_t.h>
+#include <sys/_types/_size_t.h>
+
+/*
+ * [XSI] The unsigned integer type used for the number of current attaches
+ * that MUST be able to store values at least as large as a type unsigned
+ * short.
+ */
+typedef unsigned short	shmatt_t;
+
+
+/*
+ * Possible flag values which may be OR'ed into the third argument to
+ * shmat()
+ */
+#define SHM_RDONLY	010000	/* [XSI] Attach read-only (else read-write) */
+#define SHM_RND		020000	/* [XSI] Round attach address to SHMLBA */
+
+/*
+ * This value is symbolic, and generally not expected to be sed by user
+ * programs directly, although such ise is permitted by the standard.  Its
+ * value in our implementation is equal to the number of bytes per page.
+ *
+ * NOTE:	We DO NOT obtain this value from the appropriate system
+ *		headers at this time, to avoid the resulting namespace
+ *		pollution, which is why we discourages its use.
+ */
+#define SHMLBA      4096	/* [XSI] Segment low boundary address multiple*/
+
+/* "official" access mode definitions; somewhat braindead since you have
+   to specify (SHM_* >> 3) for group and (SHM_* >> 6) for world permissions */
+#define SHM_R       (IPC_R)
+#define SHM_W       (IPC_W)
+
+#pragma pack(4)
+
+/*
+ * Technically, we should force all code references to the new structure
+ * definition, not in just the standards conformance case, and leave the
+ * legacy interface there for binary compatibility only.  Currently, we
+ * are only forcing this for programs requesting standards conformance.
+ */
+#if __DARWIN_UNIX03 || defined(KERNEL)
+/*
+ * Structure used internally.
+ * 
+ * This structure is exposed because standards dictate that it is used as
+ * the third argment to shmctl().
+ *
+ * NOTE:	The field shm_internal is not meaningful in user space,
+ *		and must not be used there.
+ */
+#if (defined(_POSIX_C_SOURCE) && !defined(_DARWIN_C_SOURCE))
+struct shmid_ds
+#else
+#define	shmid_ds	__shmid_ds_new
+struct __shmid_ds_new
+#endif
+{
+	struct __ipc_perm_new shm_perm;	/* [XSI] Operation permission value */
+	size_t		shm_segsz;	/* [XSI] Size of segment in bytes */
+	pid_t		shm_lpid;	/* [XSI] PID of last shared memory op */
+	pid_t		shm_cpid;	/* [XSI] PID of creator */
+	shmatt_t	shm_nattch;	/* [XSI] Number of current attaches */
+	time_t		shm_atime;	/* [XSI] Time of last shmat() */
+	time_t		shm_dtime;	/* [XSI] Time of last shmdt() */
+	time_t		shm_ctime;	/* [XSI] Time of last shmctl() change */
+	void		*shm_internal;	/* reserved for kernel use */
+};
+#else	/* !__DARWIN_UNIX03 */
+#define	shmid_ds	__shmid_ds_old
+#endif	/* !__DARWIN_UNIX03 */
+
+#if !__DARWIN_UNIX03
+struct __shmid_ds_old {
+	struct __ipc_perm_old shm_perm;	/* [XSI] Operation permission value */
+	size_t		shm_segsz;	/* [XSI] Size of segment in bytes */
+	pid_t		shm_lpid;	/* [XSI] PID of last shared memory op */
+	pid_t		shm_cpid;	/* [XSI] PID of creator */
+	shmatt_t	shm_nattch;	/* [XSI] Number of current attaches */
+	time_t		shm_atime;	/* [XSI] Time of last shmat() */
+	time_t		shm_dtime;	/* [XSI] Time of last shmdt() */
+	time_t		shm_ctime;	/* [XSI] Time of last shmctl() change */
+	void		*shm_internal;	/* reserved for kernel use */
+};
+#endif	/* !__DARWIN_UNIX03 */
+
+#pragma pack()
+
+
+__BEGIN_DECLS
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+int	shmsys(int, ...);
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+void	*shmat (int, const void *, int);
+int	shmctl(int, int, struct shmid_ds *) __DARWIN_ALIAS(shmctl);
+int	shmdt(const void *);
+int	shmget(key_t, size_t, int);
+__END_DECLS
+
+
+#endif /* !_SYS_SHM_H_ */
diff -Nur cctools-877.5/include/sys/signal.h cctools-877.5-AnV/include/sys/signal.h
--- cctools-877.5/include/sys/signal.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/signal.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,391 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1989, 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)signal.h	8.2 (Berkeley) 1/21/94
+ */
+
+#ifndef	_SYS_SIGNAL_H_
+#define	_SYS_SIGNAL_H_
+
+#include <sys/cdefs.h>
+#include <sys/appleapiopts.h>
+
+#define __DARWIN_NSIG	32	/* counting 0; could be 33 (mask is 1-32) */
+
+#if !defined(_ANSI_SOURCE) && (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+#define NSIG	__DARWIN_NSIG
+#endif
+
+#include <machine/signal.h>	/* sigcontext; codes for SIGILL, SIGFPE */
+
+#define	SIGHUP	1	/* hangup */
+#define	SIGINT	2	/* interrupt */
+#define	SIGQUIT	3	/* quit */
+#define	SIGILL	4	/* illegal instruction (not reset when caught) */
+#define	SIGTRAP	5	/* trace trap (not reset when caught) */
+#define	SIGABRT	6	/* abort() */
+#if  (defined(_POSIX_C_SOURCE) && !defined(_DARWIN_C_SOURCE))
+#define	SIGPOLL	7	/* pollable event ([XSR] generated, not supported) */
+#else	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+#define	SIGIOT	SIGABRT	/* compatibility */
+#define	SIGEMT	7	/* EMT instruction */
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+#define	SIGFPE	8	/* floating point exception */
+#define	SIGKILL	9	/* kill (cannot be caught or ignored) */
+#define	SIGBUS	10	/* bus error */
+#define	SIGSEGV	11	/* segmentation violation */
+#define	SIGSYS	12	/* bad argument to system call */
+#define	SIGPIPE	13	/* write on a pipe with no one to read it */
+#define	SIGALRM	14	/* alarm clock */
+#define	SIGTERM	15	/* software termination signal from kill */
+#define	SIGURG	16	/* urgent condition on IO channel */
+#define	SIGSTOP	17	/* sendable stop signal not from tty */
+#define	SIGTSTP	18	/* stop signal from tty */
+#define	SIGCONT	19	/* continue a stopped process */
+#define	SIGCHLD	20	/* to parent on child stop or exit */
+#define	SIGTTIN	21	/* to readers pgrp upon background tty read */
+#define	SIGTTOU	22	/* like TTIN for output if (tp->t_local&LTOSTOP) */
+#if  (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+#define	SIGIO	23	/* input/output possible signal */
+#endif
+#define	SIGXCPU	24	/* exceeded CPU time limit */
+#define	SIGXFSZ	25	/* exceeded file size limit */
+#define	SIGVTALRM 26	/* virtual time alarm */
+#define	SIGPROF	27	/* profiling time alarm */
+#if  (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+#define SIGWINCH 28	/* window size changes */
+#define SIGINFO	29	/* information request */
+#endif
+#define SIGUSR1 30	/* user defined signal 1 */
+#define SIGUSR2 31	/* user defined signal 2 */
+
+#if defined(_ANSI_SOURCE) || __DARWIN_UNIX03 || defined(__cplusplus)
+/*
+ * Language spec sez we must list exactly one parameter, even though we
+ * actually supply three.  Ugh!
+ * SIG_HOLD is chosen to avoid KERN_SIG_* values in <sys/signalvar.h>
+ */
+#define	SIG_DFL		(void (*)(int))0
+#define	SIG_IGN		(void (*)(int))1
+#define	SIG_HOLD	(void (*)(int))5
+#define	SIG_ERR		((void (*)(int))-1)
+#else
+/* DO NOT REMOVE THE COMMENTED OUT int: fixincludes needs to see them */
+#define	SIG_DFL		(void (*)(/*int*/))0
+#define	SIG_IGN		(void (*)(/*int*/))1
+#define	SIG_HOLD	(void (*)(/*int*/))5
+#define	SIG_ERR		((void (*)(/*int*/))-1)
+#endif
+
+#ifndef _ANSI_SOURCE
+#include <sys/_types.h>
+
+#include <machine/_mcontext.h>
+
+#include <sys/_pthread/_pthread_attr_t.h>
+
+#include <sys/_types/_sigaltstack.h>
+#include <sys/_types/_ucontext.h>
+
+#include <sys/_types/_pid_t.h>
+#include <sys/_types/_sigset_t.h>
+#include <sys/_types/_size_t.h>
+#include <sys/_types/_uid_t.h>
+
+union sigval {
+	/* Members as suggested by Annex C of POSIX 1003.1b. */
+	int	sival_int;
+	void	*sival_ptr;
+};
+
+#define	SIGEV_NONE	0	/* No async notification */
+#define	SIGEV_SIGNAL	1	/* aio - completion notification */
+#define	SIGEV_THREAD	3	/* [NOTIMP] [RTS] call notification function */
+
+struct sigevent {
+	int				sigev_notify;				/* Notification type */
+	int				sigev_signo;				/* Signal number */
+	union sigval	sigev_value;				/* Signal value */
+	void			(*sigev_notify_function)(union sigval);	  /* Notification function */
+	pthread_attr_t	*sigev_notify_attributes;	/* Notification attributes */
+};
+
+
+typedef struct __siginfo {
+	int	si_signo;		/* signal number */
+	int	si_errno;		/* errno association */
+	int	si_code;		/* signal code */
+	pid_t	si_pid;			/* sending process */
+	uid_t	si_uid;			/* sender's ruid */
+	int	si_status;		/* exit value */
+	void	*si_addr;		/* faulting instruction */
+	union sigval si_value;		/* signal value */
+	long	si_band;		/* band event for SIGPOLL */
+	unsigned long	__pad[7];	/* Reserved for Future Use */
+} siginfo_t;
+
+
+/* 
+ * When the signal is SIGILL or SIGFPE, si_addr contains the address of 
+ * the faulting instruction.
+ * When the signal is SIGSEGV or SIGBUS, si_addr contains the address of 
+ * the faulting memory reference. Although for x86 there are cases of SIGSEGV
+ * for which si_addr cannot be determined and is NULL. 
+ * If the signal is SIGCHLD, the si_pid field will contain the child process ID,
+ *  si_status contains the exit value or signal and
+ *  si_uid contains the real user ID of the process that sent the signal.
+ */
+
+/* Values for si_code */
+
+/* Codes for SIGILL */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	ILL_NOOP	0	/* if only I knew... */
+#endif
+#define	ILL_ILLOPC	1	/* [XSI] illegal opcode */
+#define	ILL_ILLTRP	2	/* [XSI] illegal trap */
+#define	ILL_PRVOPC	3	/* [XSI] privileged opcode */
+#define	ILL_ILLOPN	4	/* [XSI] illegal operand -NOTIMP */
+#define	ILL_ILLADR	5	/* [XSI] illegal addressing mode -NOTIMP */
+#define	ILL_PRVREG	6	/* [XSI] privileged register -NOTIMP */
+#define	ILL_COPROC	7	/* [XSI] coprocessor error -NOTIMP */
+#define	ILL_BADSTK	8	/* [XSI] internal stack error -NOTIMP */
+
+/* Codes for SIGFPE */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	FPE_NOOP	0	/* if only I knew... */
+#endif
+#define FPE_FLTDIV	1	/* [XSI] floating point divide by zero */
+#define FPE_FLTOVF	2	/* [XSI] floating point overflow */
+#define FPE_FLTUND	3	/* [XSI] floating point underflow */
+#define FPE_FLTRES	4	/* [XSI] floating point inexact result */
+#define FPE_FLTINV	5	/* [XSI] invalid floating point operation */
+#define	FPE_FLTSUB	6	/* [XSI] subscript out of range -NOTIMP */
+#define	FPE_INTDIV	7	/* [XSI] integer divide by zero */
+#define	FPE_INTOVF	8	/* [XSI] integer overflow */
+
+/* Codes for SIGSEGV */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	SEGV_NOOP	0	/* if only I knew... */
+#endif
+#define	SEGV_MAPERR	1	/* [XSI] address not mapped to object */
+#define	SEGV_ACCERR	2	/* [XSI] invalid permission for mapped object */
+
+/* Codes for SIGBUS */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	BUS_NOOP	0	/* if only I knew... */
+#endif
+#define	BUS_ADRALN	1	/* [XSI] Invalid address alignment */
+#define	BUS_ADRERR	2	/* [XSI] Nonexistent physical address -NOTIMP */
+#define	BUS_OBJERR	3	/* [XSI] Object-specific HW error - NOTIMP */
+
+/* Codes for SIGTRAP */
+#define	TRAP_BRKPT	1	/* [XSI] Process breakpoint -NOTIMP */
+#define	TRAP_TRACE	2	/* [XSI] Process trace trap -NOTIMP */
+
+/* Codes for SIGCHLD */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	CLD_NOOP	0	/* if only I knew... */
+#endif
+#define	CLD_EXITED	1	/* [XSI] child has exited */
+#define	CLD_KILLED	2	/* [XSI] terminated abnormally, no core file */
+#define	CLD_DUMPED	3	/* [XSI] terminated abnormally, core file */
+#define	CLD_TRAPPED	4	/* [XSI] traced child has trapped */
+#define	CLD_STOPPED	5	/* [XSI] child has stopped */
+#define	CLD_CONTINUED	6	/* [XSI] stopped child has continued */
+
+/* Codes for SIGPOLL */
+#define	POLL_IN		1	/* [XSR] Data input available */
+#define	POLL_OUT	2	/* [XSR] Output buffers available */
+#define	POLL_MSG	3	/* [XSR] Input message available */
+#define	POLL_ERR	4	/* [XSR] I/O error */
+#define	POLL_PRI	5	/* [XSR] High priority input available */
+#define	POLL_HUP	6	/* [XSR] Device disconnected */
+
+/* union for signal handlers */
+union __sigaction_u {
+	void    (*__sa_handler)(int);
+	void    (*__sa_sigaction)(int, struct __siginfo *,
+		       void *);
+};
+
+/* Signal vector template for Kernel user boundary */
+struct	__sigaction {
+	union __sigaction_u __sigaction_u;  /* signal handler */
+	void    (*sa_tramp)(void *, int, int, siginfo_t *, void *);
+	sigset_t sa_mask;		/* signal mask to apply */
+	int	sa_flags;		/* see signal options below */
+};
+
+/*
+ * Signal vector "template" used in sigaction call.
+ */
+struct	sigaction {
+	union __sigaction_u __sigaction_u;  /* signal handler */
+	sigset_t sa_mask;		/* signal mask to apply */
+	int	sa_flags;		/* see signal options below */
+};
+
+
+
+/* if SA_SIGINFO is set, sa_sigaction is to be used instead of sa_handler. */
+#define	sa_handler	__sigaction_u.__sa_handler
+#define	sa_sigaction	__sigaction_u.__sa_sigaction
+
+#define SA_ONSTACK	0x0001	/* take signal on signal stack */
+#define SA_RESTART	0x0002	/* restart system on signal return */
+#define	SA_RESETHAND	0x0004	/* reset to SIG_DFL when taking signal */
+#define SA_NOCLDSTOP	0x0008	/* do not generate SIGCHLD on child stop */
+#define	SA_NODEFER	0x0010	/* don't mask the signal we're delivering */
+#define	SA_NOCLDWAIT	0x0020	/* don't keep zombies around */
+#define	SA_SIGINFO	0x0040	/* signal handler with SA_SIGINFO args */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	SA_USERTRAMP	0x0100	/* do not bounce off kernel's sigtramp */
+/* This will provide 64bit register set in a 32bit user address space */
+#define	SA_64REGSET	0x0200	/* signal handler with SA_SIGINFO args with 64bit regs information */
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/* the following are the only bits we support from user space, the 
+ * rest are for kernel use only.
+ */
+#define SA_USERSPACE_MASK (SA_ONSTACK | SA_RESTART | SA_RESETHAND | SA_NOCLDSTOP | SA_NODEFER | SA_NOCLDWAIT | SA_SIGINFO)
+
+/*
+ * Flags for sigprocmask:
+ */
+#define	SIG_BLOCK	1	/* block specified signal set */
+#define	SIG_UNBLOCK	2	/* unblock specified signal set */
+#define	SIG_SETMASK	3	/* set specified signal set */
+
+/* POSIX 1003.1b required values. */
+#define SI_USER		0x10001	/* [CX] signal from kill() */
+#define SI_QUEUE	0x10002	/* [CX] signal from sigqueue() */
+#define SI_TIMER	0x10003	/* [CX] timer expiration */
+#define SI_ASYNCIO	0x10004	/* [CX] aio request completion */
+#define SI_MESGQ	0x10005	/* [CX]	from message arrival on empty queue */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+typedef	void (*sig_t)(int);	/* type of signal function */
+#endif
+
+/*
+ * Structure used in sigaltstack call.
+ */
+
+#define SS_ONSTACK	0x0001	/* take signal on signal stack */
+#define	SS_DISABLE	0x0004	/* disable taking signals on alternate stack */
+#define	MINSIGSTKSZ	32768	/* (32K)minimum allowable stack */
+#define	SIGSTKSZ	131072	/* (128K)recommended stack size */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/*
+ * 4.3 compatibility:
+ * Signal vector "template" used in sigvec call.
+ */
+struct	sigvec {
+	void	(*sv_handler)(int);	/* signal handler */
+	int	sv_mask;		/* signal mask to apply */
+	int	sv_flags;		/* see signal options below */
+};
+
+#define SV_ONSTACK	SA_ONSTACK
+#define SV_INTERRUPT	SA_RESTART	/* same bit, opposite sense */
+#define SV_RESETHAND	SA_RESETHAND
+#define SV_NODEFER	SA_NODEFER
+#define SV_NOCLDSTOP	SA_NOCLDSTOP
+#define SV_SIGINFO	SA_SIGINFO
+
+#define sv_onstack sv_flags	/* isn't compatibility wonderful! */
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/*
+ * Structure used in sigstack call.
+ */
+struct	sigstack {
+	char	*ss_sp;			/* signal stack pointer */
+	int	ss_onstack;		/* current status */
+};
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/*
+ * Macro for converting signal number to a mask suitable for
+ * sigblock().
+ */
+#define sigmask(m)	(1 << ((m)-1))
+
+
+#define	BADSIG		SIG_ERR
+
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+#endif	/* !_ANSI_SOURCE */
+
+/*
+ * For historical reasons; programs expect signal's return value to be
+ * defined by <sys/signal.h>.
+ */
+__BEGIN_DECLS
+void	(*signal(int, void (*)(int)))(int);
+__END_DECLS
+#endif	/* !_SYS_SIGNAL_H_ */
diff -Nur cctools-877.5/include/sys/signalvar.h cctools-877.5-AnV/include/sys/signalvar.h
--- cctools-877.5/include/sys/signalvar.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/signalvar.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,70 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)signalvar.h	8.3 (Berkeley) 1/4/94
+ */
+
+#ifndef	_SYS_SIGNALVAR_H_		/* tmp for user.h */
+#define	_SYS_SIGNALVAR_H_
+
+#include <sys/appleapiopts.h>
+
+
+#endif	/* !_SYS_SIGNALVAR_H_ */
diff -Nur cctools-877.5/include/sys/socket.h cctools-877.5-AnV/include/sys/socket.h
--- cctools-877.5/include/sys/socket.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/socket.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,594 @@
+/*
+ * Copyright (c) 2000-2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1998, 1999 Apple Computer, Inc. All Rights Reserved */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1985, 1986, 1988, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)socket.h	8.4 (Berkeley) 2/21/94
+ * $FreeBSD: src/sys/sys/socket.h,v 1.39.2.7 2001/07/03 11:02:01 ume Exp $
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+#ifndef _SYS_SOCKET_H_
+#define	_SYS_SOCKET_H_
+
+#include <sys/types.h>
+#include <sys/cdefs.h>
+#include <machine/_param.h>
+
+
+#include <Availability.h>
+
+/*
+ * Definitions related to sockets: types, address families, options.
+ */
+
+/*
+ * Data types.
+ */
+
+#include <sys/_types/_gid_t.h>
+#include <sys/_types/_off_t.h>
+#include <sys/_types/_pid_t.h>
+#include <sys/_types/_sa_family_t.h>
+#include <sys/_types/_socklen_t.h>
+
+/* XXX Not explicitly defined by POSIX, but function return types are */
+#include <sys/_types/_size_t.h>
+ 
+/* XXX Not explicitly defined by POSIX, but function return types are */
+#include <sys/_types/_ssize_t.h>
+
+/*
+ * [XSI] The iovec structure shall be defined as described in <sys/uio.h>.
+ */
+#include <sys/_types/_iovec_t.h>
+
+ 
+/*
+ * Types
+ */
+#define	SOCK_STREAM	1		/* stream socket */
+#define	SOCK_DGRAM	2		/* datagram socket */
+#define	SOCK_RAW	3		/* raw-protocol interface */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	SOCK_RDM	4		/* reliably-delivered message */
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+#define	SOCK_SEQPACKET	5		/* sequenced packet stream */
+
+/*
+ * Option flags per-socket.
+ */
+#define	SO_DEBUG	0x0001		/* turn on debugging info recording */
+#define	SO_ACCEPTCONN	0x0002		/* socket has had listen() */
+#define	SO_REUSEADDR	0x0004		/* allow local address reuse */
+#define	SO_KEEPALIVE	0x0008		/* keep connections alive */
+#define	SO_DONTROUTE	0x0010		/* just use interface addresses */
+#define	SO_BROADCAST	0x0020		/* permit sending of broadcast msgs */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	SO_USELOOPBACK	0x0040		/* bypass hardware when possible */
+#define SO_LINGER	0x0080          /* linger on close if data present (in ticks) */
+#else
+#define SO_LINGER	0x1080          /* linger on close if data present (in seconds) */
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+#define	SO_OOBINLINE	0x0100		/* leave received OOB data in line */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	SO_REUSEPORT	0x0200		/* allow local address & port reuse */
+#define	SO_TIMESTAMP	0x0400		/* timestamp received dgram traffic */
+#define SO_TIMESTAMP_MONOTONIC	0x0800	/* Monotonically increasing timestamp on rcvd dgram */
+#ifndef __APPLE__
+#define	SO_ACCEPTFILTER	0x1000		/* there is an accept filter */
+#else
+#define SO_DONTTRUNC	0x2000		/* APPLE: Retain unread data */
+					/*  (ATOMIC proto) */
+#define SO_WANTMORE	0x4000		/* APPLE: Give hint when more data ready */
+#define SO_WANTOOBFLAG	0x8000		/* APPLE: Want OOB in MSG_FLAG on receive */
+
+
+#endif  /* (!__APPLE__) */
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/*
+ * Additional options, not kept in so_options.
+ */
+#define SO_SNDBUF	0x1001		/* send buffer size */
+#define SO_RCVBUF	0x1002		/* receive buffer size */
+#define SO_SNDLOWAT	0x1003		/* send low-water mark */
+#define SO_RCVLOWAT	0x1004		/* receive low-water mark */
+#define SO_SNDTIMEO	0x1005		/* send timeout */
+#define SO_RCVTIMEO	0x1006		/* receive timeout */
+#define	SO_ERROR	0x1007		/* get error status and clear */
+#define	SO_TYPE		0x1008		/* get socket type */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/*efine	SO_PRIVSTATE	0x1009		   get/deny privileged state */
+#define SO_LABEL        0x1010          /* socket's MAC label */
+#define SO_PEERLABEL    0x1011          /* socket's peer MAC label */
+#ifdef __APPLE__
+#define SO_NREAD	0x1020		/* APPLE: get 1st-packet byte count */
+#define SO_NKE		0x1021		/* APPLE: Install socket-level NKE */
+#define SO_NOSIGPIPE	0x1022		/* APPLE: No SIGPIPE on EPIPE */
+#define SO_NOADDRERR	0x1023		/* APPLE: Returns EADDRNOTAVAIL when src is not available anymore */
+#define SO_NWRITE	0x1024		/* APPLE: Get number of bytes currently in send socket buffer */
+#define SO_REUSESHAREUID	0x1025		/* APPLE: Allow reuse of port/socket by different userids */
+#ifdef __APPLE_API_PRIVATE
+#define SO_NOTIFYCONFLICT	0x1026	/* APPLE: send notification if there is a bind on a port which is already in use */
+#define	SO_UPCALLCLOSEWAIT	0x1027	/* APPLE: block on close until an upcall returns */
+#endif
+#define SO_LINGER_SEC	0x1080          /* linger on close if data present (in seconds) */
+#define SO_RANDOMPORT   0x1082  /* APPLE: request local port randomization */
+#define SO_NP_EXTENSIONS	0x1083	/* To turn off some POSIX behavior */
+#endif
+
+
+#define SO_NUMRCVPKT		0x1112	/* number of datagrams in receive socket buffer */
+
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/*
+ * Structure used for manipulating linger option.
+ */
+struct	linger {
+	int	l_onoff;		/* option on/off */
+	int	l_linger;		/* linger time */
+};
+
+#ifndef __APPLE__
+struct	accept_filter_arg {
+	char	af_name[16];
+	char	af_arg[256-16];
+};
+#endif
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#ifdef __APPLE__
+
+/*
+ * Structure to control non-portable Sockets extension to POSIX  
+ */
+struct so_np_extensions {
+	u_int32_t	npx_flags;
+	u_int32_t	npx_mask;
+};
+
+#define SONPX_SETOPTSHUT	0x000000001     /* flag for allowing setsockopt after shutdown */
+
+
+
+#endif
+#endif
+
+/*
+ * Level number for (get/set)sockopt() to apply to socket itself.
+ */
+#define	SOL_SOCKET	0xffff		/* options for socket level */
+
+
+/*
+ * Address families.
+ */
+#define	AF_UNSPEC	0		/* unspecified */
+#define	AF_UNIX		1		/* local to host (pipes) */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	AF_LOCAL	AF_UNIX		/* backward compatibility */
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+#define	AF_INET		2		/* internetwork: UDP, TCP, etc. */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	AF_IMPLINK	3		/* arpanet imp addresses */
+#define	AF_PUP		4		/* pup protocols: e.g. BSP */
+#define	AF_CHAOS	5		/* mit CHAOS protocols */
+#define	AF_NS		6		/* XEROX NS protocols */
+#define	AF_ISO		7		/* ISO protocols */
+#define	AF_OSI		AF_ISO
+#define	AF_ECMA		8		/* European computer manufacturers */
+#define	AF_DATAKIT	9		/* datakit protocols */
+#define	AF_CCITT	10		/* CCITT protocols, X.25 etc */
+#define	AF_SNA		11		/* IBM SNA */
+#define AF_DECnet	12		/* DECnet */
+#define AF_DLI		13		/* DEC Direct data link interface */
+#define AF_LAT		14		/* LAT */
+#define	AF_HYLINK	15		/* NSC Hyperchannel */
+#define	AF_APPLETALK	16		/* Apple Talk */
+#define	AF_ROUTE	17		/* Internal Routing Protocol */
+#define	AF_LINK		18		/* Link layer interface */
+#define	pseudo_AF_XTP	19		/* eXpress Transfer Protocol (no AF) */
+#define	AF_COIP		20		/* connection-oriented IP, aka ST II */
+#define	AF_CNT		21		/* Computer Network Technology */
+#define pseudo_AF_RTIP	22		/* Help Identify RTIP packets */
+#define	AF_IPX		23		/* Novell Internet Protocol */
+#define	AF_SIP		24		/* Simple Internet Protocol */
+#define pseudo_AF_PIP	25		/* Help Identify PIP packets */
+/*define pseudo_AF_BLUE	26	   Identify packets for Blue Box - Not used */
+#define AF_NDRV		27		/* Network Driver 'raw' access */
+#define	AF_ISDN		28		/* Integrated Services Digital Network*/
+#define	AF_E164		AF_ISDN		/* CCITT E.164 recommendation */
+#define	pseudo_AF_KEY	29		/* Internal key-management function */
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+#define	AF_INET6	30		/* IPv6 */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	AF_NATM		31		/* native ATM access */
+#define AF_SYSTEM	32		/* Kernel event messages */
+#define AF_NETBIOS	33		/* NetBIOS */
+#define AF_PPP		34		/* PPP communication protocol */
+#define pseudo_AF_HDRCMPLT 35		/* Used by BPF to not rewrite headers
+					 * in interface output routine */
+#define AF_RESERVED_36	36		/* Reserved for internal usage */
+#define AF_IEEE80211    37              /* IEEE 802.11 protocol */
+#define AF_UTUN		38
+#define	AF_MAX		40
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/*
+ * [XSI] Structure used by kernel to store most addresses.
+ */
+struct sockaddr {
+	__uint8_t	sa_len;		/* total length */
+	sa_family_t	sa_family;	/* [XSI] address family */
+	char		sa_data[14];	/* [XSI] addr value (actually larger) */
+};
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	SOCK_MAXADDRLEN	255		/* longest possible addresses */
+
+/*
+ * Structure used by kernel to pass protocol
+ * information in raw sockets.
+ */
+struct sockproto {
+	__uint16_t	sp_family;		/* address family */
+	__uint16_t	sp_protocol;		/* protocol */
+};
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE)*/
+
+/*
+ * RFC 2553: protocol-independent placeholder for socket addresses
+ */
+#define	_SS_MAXSIZE	128
+#define	_SS_ALIGNSIZE	(sizeof(__int64_t))
+#define	_SS_PAD1SIZE	\
+		(_SS_ALIGNSIZE - sizeof(__uint8_t) - sizeof(sa_family_t))
+#define	_SS_PAD2SIZE	\
+		(_SS_MAXSIZE - sizeof(__uint8_t) - sizeof(sa_family_t) - \
+				_SS_PAD1SIZE - _SS_ALIGNSIZE)
+
+/*
+ * [XSI] sockaddr_storage
+ */
+struct sockaddr_storage {
+	__uint8_t	ss_len;		/* address length */
+	sa_family_t	ss_family;	/* [XSI] address family */
+	char			__ss_pad1[_SS_PAD1SIZE];
+	__int64_t	__ss_align;	/* force structure storage alignment */
+	char			__ss_pad2[_SS_PAD2SIZE];
+};
+
+
+/*
+ * Protocol families, same as address families for now.
+ */
+#define	PF_UNSPEC	AF_UNSPEC
+#define	PF_LOCAL	AF_LOCAL
+#define	PF_UNIX		PF_LOCAL	/* backward compatibility */
+#define	PF_INET		AF_INET
+#define	PF_IMPLINK	AF_IMPLINK
+#define	PF_PUP		AF_PUP
+#define	PF_CHAOS	AF_CHAOS
+#define	PF_NS		AF_NS
+#define	PF_ISO		AF_ISO
+#define	PF_OSI		AF_ISO
+#define	PF_ECMA		AF_ECMA
+#define	PF_DATAKIT	AF_DATAKIT
+#define	PF_CCITT	AF_CCITT
+#define	PF_SNA		AF_SNA
+#define PF_DECnet	AF_DECnet
+#define PF_DLI		AF_DLI
+#define PF_LAT		AF_LAT
+#define	PF_HYLINK	AF_HYLINK
+#define	PF_APPLETALK	AF_APPLETALK
+#define	PF_ROUTE	AF_ROUTE
+#define	PF_LINK		AF_LINK
+#define	PF_XTP		pseudo_AF_XTP	/* really just proto family, no AF */
+#define	PF_COIP		AF_COIP
+#define	PF_CNT		AF_CNT
+#define	PF_SIP		AF_SIP
+#define	PF_IPX		AF_IPX		/* same format as AF_NS */
+#define PF_RTIP		pseudo_AF_RTIP	/* same format as AF_INET */
+#define PF_PIP		pseudo_AF_PIP
+#define PF_NDRV		AF_NDRV
+#define	PF_ISDN		AF_ISDN
+#define	PF_KEY		pseudo_AF_KEY
+#define	PF_INET6	AF_INET6
+#define	PF_NATM		AF_NATM
+#define PF_SYSTEM	AF_SYSTEM
+#define PF_NETBIOS	AF_NETBIOS
+#define PF_PPP		AF_PPP
+#define PF_RESERVED_36  AF_RESERVED_36
+#define PF_UTUN		AF_UTUN
+#define	PF_MAX		AF_MAX
+
+/*
+ * These do not have socket-layer support:
+ */
+#define	PF_VLAN		((uint32_t)0x766c616e)	/* 'vlan' */
+#define PF_BOND		((uint32_t)0x626f6e64)	/* 'bond' */
+
+/*
+ * Definitions for network related sysctl, CTL_NET.
+ *
+ * Second level is protocol family.
+ * Third level is protocol number.
+ *
+ * Further levels are defined by the individual families below.
+ */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define NET_MAXID	AF_MAX
+#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/*
+ * PF_ROUTE - Routing table
+ *
+ * Three additional levels are defined:
+ *	Fourth: address family, 0 is wildcard
+ *	Fifth: type of info, defined below
+ *	Sixth: flag(s) to mask with for NET_RT_FLAGS
+ */
+#define NET_RT_DUMP		1	/* dump; may limit to a.f. */
+#define NET_RT_FLAGS		2	/* by flags, e.g. RESOLVING */
+#define NET_RT_IFLIST		3	/* survey interface list */
+#define NET_RT_STAT		4	/* routing statistics */
+#define NET_RT_TRASH		5	/* routes not in table but not freed */
+#define NET_RT_IFLIST2		6	/* interface list with addresses */
+#define NET_RT_DUMP2		7	/* dump; may limit to a.f. */
+#define	NET_RT_MAXID		10
+#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+
+
+/*
+ * Maximum queue length specifiable by listen.
+ */
+#define	SOMAXCONN	128
+
+/*
+ * [XSI] Message header for recvmsg and sendmsg calls.
+ * Used value-result for recvmsg, value only for sendmsg.
+ */
+struct msghdr {
+	void		*msg_name;	/* [XSI] optional address */
+	socklen_t	msg_namelen;	/* [XSI] size of address */
+	struct		iovec *msg_iov;	/* [XSI] scatter/gather array */
+	int		msg_iovlen;	/* [XSI] # elements in msg_iov */
+	void		*msg_control;	/* [XSI] ancillary data, see below */
+	socklen_t	msg_controllen;	/* [XSI] ancillary data buffer len */
+	int		msg_flags;	/* [XSI] flags on received message */
+};
+
+
+
+#define	MSG_OOB		0x1		/* process out-of-band data */
+#define	MSG_PEEK	0x2		/* peek at incoming message */
+#define	MSG_DONTROUTE	0x4		/* send without using routing tables */
+#define	MSG_EOR		0x8		/* data completes record */
+#define	MSG_TRUNC	0x10		/* data discarded before delivery */
+#define	MSG_CTRUNC	0x20		/* control data lost before delivery */
+#define	MSG_WAITALL	0x40		/* wait for full request or error */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	MSG_DONTWAIT	0x80		/* this message should be nonblocking */
+#define	MSG_EOF		0x100		/* data completes connection */
+#ifdef __APPLE__
+#ifdef __APPLE_API_OBSOLETE
+#define MSG_WAITSTREAM  0x200           /* wait up to full request.. may return partial */
+#endif
+#define MSG_FLUSH	0x400		/* Start of 'hold' seq; dump so_temp */
+#define MSG_HOLD	0x800		/* Hold frag in so_temp */
+#define MSG_SEND	0x1000		/* Send the packet in so_temp */
+#define MSG_HAVEMORE	0x2000		/* Data ready to be read */
+#define MSG_RCVMORE	0x4000		/* Data remains in current pkt */
+#endif
+#define MSG_NEEDSA	0x10000		/* Fail receive if socket address cannot be allocated */
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/*
+ * Header for ancillary data objects in msg_control buffer.
+ * Used for additional information with/about a datagram
+ * not expressible by flags.  The format is a sequence
+ * of message elements headed by cmsghdr structures.
+ */
+struct cmsghdr {
+	socklen_t	cmsg_len;	/* [XSI] data byte count, including hdr */
+	int		cmsg_level;	/* [XSI] originating protocol */
+	int		cmsg_type;	/* [XSI] protocol-specific type */
+/* followed by	unsigned char  cmsg_data[]; */
+};
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#ifndef __APPLE__
+/*
+ * While we may have more groups than this, the cmsgcred struct must
+ * be able to fit in an mbuf, and NGROUPS_MAX is too large to allow
+ * this.
+*/
+#define CMGROUP_MAX 16
+
+/*
+ * Credentials structure, used to verify the identity of a peer
+ * process that has sent us a message. This is allocated by the
+ * peer process but filled in by the kernel. This prevents the
+ * peer from lying about its identity. (Note that cmcred_groups[0]
+ * is the effective GID.)
+ */
+struct cmsgcred {
+	pid_t	cmcred_pid;		/* PID of sending process */
+	uid_t	cmcred_uid;		/* real UID of sending process */
+	uid_t	cmcred_euid;		/* effective UID of sending process */
+	gid_t	cmcred_gid;		/* real GID of sending process */
+	short	cmcred_ngroups;		/* number or groups */
+	gid_t	cmcred_groups[CMGROUP_MAX];	/* groups */
+};
+#endif
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/* given pointer to struct cmsghdr, return pointer to data */
+#define	CMSG_DATA(cmsg)		((unsigned char *)(cmsg) + \
+				 __DARWIN_ALIGN32(sizeof(struct cmsghdr)))
+
+/*
+ * RFC 2292 requires to check msg_controllen, in case that the kernel returns
+ * an empty list for some reasons.
+ */
+#define CMSG_FIRSTHDR(mhdr) \
+        ((mhdr)->msg_controllen >= sizeof(struct cmsghdr) ? \
+         (struct cmsghdr *)(mhdr)->msg_control : \
+         (struct cmsghdr *)0L)
+
+
+/* 
+ * Given pointer to struct cmsghdr, return pointer to next cmsghdr
+ * RFC 2292 says that CMSG_NXTHDR(mhdr, NULL) is equivalent to CMSG_FIRSTHDR(mhdr)
+ */
+#define	CMSG_NXTHDR(mhdr, cmsg)						\
+	((char *)(cmsg) == (char *)0L ? CMSG_FIRSTHDR(mhdr) :		\
+	 ((((unsigned char *)(cmsg) +					\
+	    __DARWIN_ALIGN32((__uint32_t)(cmsg)->cmsg_len) +		\
+	    __DARWIN_ALIGN32(sizeof(struct cmsghdr))) >			\
+	    ((unsigned char *)(mhdr)->msg_control +			\
+	     (mhdr)->msg_controllen)) ?					\
+	  (struct cmsghdr *)0L /* NULL */ :				\
+	  (struct cmsghdr *)(void *)((unsigned char *)(cmsg) +		\
+	 		    __DARWIN_ALIGN32((__uint32_t)(cmsg)->cmsg_len))))
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/* RFC 2292 additions */
+#define	CMSG_SPACE(l)		(__DARWIN_ALIGN32(sizeof(struct cmsghdr)) + __DARWIN_ALIGN32(l))
+#define	CMSG_LEN(l)		(__DARWIN_ALIGN32(sizeof(struct cmsghdr)) + (l))
+
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/* "Socket"-level control message types: */
+#define	SCM_RIGHTS			0x01	/* access rights (array of int) */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	SCM_TIMESTAMP			0x02	/* timestamp (struct timeval) */
+#define	SCM_CREDS			0x03	/* process creds (struct cmsgcred) */
+#define	SCM_TIMESTAMP_MONOTONIC		0x04	/* timestamp (uint64_t) */ 
+
+
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/*
+ * howto arguments for shutdown(2), specified by Posix.1g.
+ */
+#define	SHUT_RD		0		/* shut down the reading side */
+#define	SHUT_WR		1		/* shut down the writing side */
+#define	SHUT_RDWR	2		/* shut down both sides */
+
+#if !defined(_POSIX_C_SOURCE)
+/*
+ * sendfile(2) header/trailer struct
+ */
+struct sf_hdtr {
+	struct iovec *headers;	/* pointer to an array of header struct iovec's */
+	int hdr_cnt;		/* number of header iovec's */
+	struct iovec *trailers;	/* pointer to an array of trailer struct iovec's */
+	int trl_cnt;		/* number of trailer iovec's */
+};
+
+
+#endif	/* !_POSIX_C_SOURCE */
+
+
+__BEGIN_DECLS
+int	accept(int, struct sockaddr * __restrict, socklen_t * __restrict)
+		__DARWIN_ALIAS_C(accept);
+int	bind(int, const struct sockaddr *, socklen_t) __DARWIN_ALIAS(bind);
+int	connect(int, const struct sockaddr *, socklen_t) __DARWIN_ALIAS_C( connect);
+int	getpeername(int, struct sockaddr * __restrict, socklen_t * __restrict)
+		__DARWIN_ALIAS(getpeername);
+int	getsockname(int, struct sockaddr * __restrict, socklen_t * __restrict)
+		__DARWIN_ALIAS(getsockname);
+int	getsockopt(int, int, int, void * __restrict, socklen_t * __restrict);
+int	listen(int, int) __DARWIN_ALIAS(listen);
+ssize_t	recv(int, void *, size_t, int) __DARWIN_ALIAS_C(recv);
+ssize_t	recvfrom(int, void *, size_t, int, struct sockaddr * __restrict,
+		socklen_t * __restrict) __DARWIN_ALIAS_C(recvfrom);
+ssize_t	recvmsg(int, struct msghdr *, int) __DARWIN_ALIAS_C(recvmsg);
+ssize_t	send(int, const void *, size_t, int) __DARWIN_ALIAS_C(send);
+ssize_t	sendmsg(int, const struct msghdr *, int) __DARWIN_ALIAS_C(sendmsg);
+ssize_t	sendto(int, const void *, size_t,
+		int, const struct sockaddr *, socklen_t) __DARWIN_ALIAS_C(sendto);
+int	setsockopt(int, int, int, const void *, socklen_t);
+int	shutdown(int, int);
+int	sockatmark(int) __OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0);
+int	socket(int, int, int);
+int	socketpair(int, int, int, int *) __DARWIN_ALIAS(socketpair);
+
+#if !defined(_POSIX_C_SOURCE)
+int	sendfile(int, int, off_t, off_t *, struct sf_hdtr *, int);
+#endif	/* !_POSIX_C_SOURCE */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+void	pfctlinput(int, struct sockaddr *);
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+__END_DECLS
+
+
+#endif /* !_SYS_SOCKET_H_ */
diff -Nur cctools-877.5/include/sys/socketvar.h cctools-877.5-AnV/include/sys/socketvar.h
--- cctools-877.5/include/sys/socketvar.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/socketvar.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,154 @@
+/*
+ * Copyright (c) 2000-2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1998, 1999 Apple Computer, Inc. All Rights Reserved */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)socketvar.h	8.3 (Berkeley) 2/19/95
+ * $FreeBSD: src/sys/sys/socketvar.h,v 1.46.2.6 2001/08/31 13:45:49 jlemon Exp $
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+#ifndef _SYS_SOCKETVAR_H_
+#define	_SYS_SOCKETVAR_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+typedef	u_quad_t so_gen_t;
+
+
+
+
+#if defined(__LP64__)
+#define	_XSOCKET_PTR(x)		u_int32_t
+#else
+#define	_XSOCKET_PTR(x)		x
+#endif
+
+
+#pragma pack(4)
+
+struct xsockbuf {
+	u_int32_t	sb_cc;
+	u_int32_t	sb_hiwat;
+	u_int32_t	sb_mbcnt;
+	u_int32_t	sb_mbmax;
+	int32_t		sb_lowat;
+	short		sb_flags;
+	short		sb_timeo;
+};
+
+/*
+ * Externalized form of struct socket used by the sysctl(3) interface.
+ */
+struct	xsocket {
+	u_int32_t		xso_len;	/* length of this structure */
+	_XSOCKET_PTR(struct socket *) xso_so;	/* makes a convenient handle */
+	short			so_type;
+	short			so_options;
+	short			so_linger;
+	short			so_state;
+	_XSOCKET_PTR(caddr_t)	so_pcb;		/* another convenient handle */
+	int			xso_protocol;
+	int			xso_family;
+	short			so_qlen;
+	short			so_incqlen;
+	short			so_qlimit;
+	short			so_timeo;
+	u_short			so_error;
+	pid_t			so_pgid;
+	u_int32_t		so_oobmark;
+	struct xsockbuf		so_rcv;
+	struct xsockbuf		so_snd;
+	uid_t			so_uid;		/* XXX */
+};
+
+#if !CONFIG_EMBEDDED
+struct	xsocket64 {
+	u_int32_t		xso_len;	/* length of this structure */
+	u_int64_t		xso_so;		/* makes a convenient handle */
+	short			so_type;
+	short			so_options;
+	short			so_linger;
+	short			so_state;
+	u_int64_t		so_pcb;		/* another convenient handle */
+	int			xso_protocol;
+	int			xso_family;
+	short			so_qlen;
+	short			so_incqlen;
+	short			so_qlimit;
+	short			so_timeo;
+	u_short			so_error;
+	pid_t			so_pgid;
+	u_int32_t		so_oobmark;
+	struct xsockbuf		so_rcv;
+	struct xsockbuf		so_snd;
+	uid_t			so_uid;		/* XXX */
+};
+#endif /* !CONFIG_EMBEDDED */
+
+
+#pragma pack()
+
+#endif /* !_SYS_SOCKETVAR_H_ */
diff -Nur cctools-877.5/include/sys/sockio.h cctools-877.5-AnV/include/sys/sockio.h
--- cctools-877.5/include/sys/sockio.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/sockio.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,162 @@
+/*
+ * Copyright (c) 2000-2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1990, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)sockio.h	8.1 (Berkeley) 3/28/94
+ */
+
+#ifndef	_SYS_SOCKIO_H_
+#define	_SYS_SOCKIO_H_
+
+#include <sys/appleapiopts.h>
+
+#include <sys/ioccom.h>
+
+/* Socket ioctl's. */
+#define	SIOCSHIWAT	 _IOW('s',  0, int)		/* set high watermark */
+#define	SIOCGHIWAT	 _IOR('s',  1, int)		/* get high watermark */
+#define	SIOCSLOWAT	 _IOW('s',  2, int)		/* set low watermark */
+#define	SIOCGLOWAT	 _IOR('s',  3, int)		/* get low watermark */
+#define	SIOCATMARK	 _IOR('s',  7, int)		/* at oob mark? */
+#define	SIOCSPGRP	 _IOW('s',  8, int)		/* set process group */
+#define	SIOCGPGRP	 _IOR('s',  9, int)		/* get process group */
+
+/*
+ * OSIOCGIF* ioctls are deprecated; they are kept for binary compatibility.
+ */
+#define	SIOCSIFADDR	_IOW('i', 12, struct ifreq)	/* set ifnet address */
+#define	SIOCSIFDSTADDR	 _IOW('i', 14, struct ifreq)	/* set p-p address */
+#define	SIOCSIFFLAGS	 _IOW('i', 16, struct ifreq)	/* set ifnet flags */
+#define	SIOCGIFFLAGS	_IOWR('i', 17, struct ifreq)	/* get ifnet flags */
+#define	SIOCSIFBRDADDR	 _IOW('i', 19, struct ifreq)	/* set broadcast addr */
+#define	SIOCSIFNETMASK	 _IOW('i', 22, struct ifreq)	/* set net addr mask */
+#define	SIOCGIFMETRIC	_IOWR('i', 23, struct ifreq)	/* get IF metric */
+#define	SIOCSIFMETRIC	_IOW('i', 24, struct ifreq)	/* set IF metric */
+#define	SIOCDIFADDR	_IOW('i', 25, struct ifreq)	/* delete IF addr */
+#define	SIOCAIFADDR	_IOW('i', 26, struct ifaliasreq)/* add/chg IF alias */
+
+#define	SIOCGIFADDR	_IOWR('i', 33, struct ifreq)	/* get ifnet address */
+#define	SIOCGIFDSTADDR	_IOWR('i', 34, struct ifreq)	/* get p-p address */
+#define	SIOCGIFBRDADDR	_IOWR('i', 35, struct ifreq)	/* get broadcast addr */
+#define	SIOCGIFCONF	_IOWR('i', 36, struct ifconf)	/* get ifnet list */
+#define	SIOCGIFNETMASK	_IOWR('i', 37, struct ifreq)	/* get net addr mask */
+#define SIOCAUTOADDR	_IOWR('i', 38, struct ifreq)	/* autoconf address */
+#define SIOCAUTONETMASK	_IOW('i', 39, struct ifreq)	/* autoconf netmask */
+#define SIOCARPIPLL		_IOWR('i', 40, struct ifreq)	/* arp for IPv4LL address */
+
+
+#define	SIOCADDMULTI	 _IOW('i', 49, struct ifreq)	/* add m'cast addr */
+#define	SIOCDELMULTI	 _IOW('i', 50, struct ifreq)	/* del m'cast addr */
+#define	SIOCGIFMTU	_IOWR('i', 51, struct ifreq)	/* get IF mtu */
+#define	SIOCSIFMTU	 _IOW('i', 52, struct ifreq)	/* set IF mtu */
+#define	SIOCGIFPHYS	_IOWR('i', 53, struct ifreq)	/* get IF wire */
+#define	SIOCSIFPHYS	 _IOW('i', 54, struct ifreq)	/* set IF wire */
+#define	SIOCSIFMEDIA	_IOWR('i', 55, struct ifreq)	/* set net media */
+#define	SIOCGIFMEDIA	_IOWR('i', 56, struct ifmediareq) /* get net media */
+#define	SIOCSIFGENERIC	 _IOW('i', 57, struct ifreq)	/* generic IF set op */
+#define	SIOCGIFGENERIC	_IOWR('i', 58, struct ifreq)	/* generic IF get op */
+#define SIOCRSLVMULTI   _IOWR('i', 59, struct rslvmulti_req)
+
+#define	SIOCSIFLLADDR	_IOW('i', 60, struct ifreq)	/* set link level addr */
+#define	SIOCGIFSTATUS	_IOWR('i', 61, struct ifstat)	/* get IF status */
+#define	SIOCSIFPHYADDR   _IOW('i', 62, struct ifaliasreq) /* set gif addres */
+#define	SIOCGIFPSRCADDR	_IOWR('i', 63, struct ifreq)	/* get gif psrc addr */
+#define	SIOCGIFPDSTADDR	_IOWR('i', 64, struct ifreq)	/* get gif pdst addr */
+#define	SIOCDIFPHYADDR	 _IOW('i', 65, struct ifreq)	/* delete gif addrs */
+
+#define	SIOCGIFDEVMTU	_IOWR('i', 68, struct ifreq) 	/* get if ifdevmtu */
+#define	SIOCSIFALTMTU	 _IOW('i', 69, struct ifreq)	/* set if alternate mtu */
+#define SIOCGIFALTMTU	_IOWR('i', 72, struct ifreq) 	/* get if alternate mtu */
+#define SIOCSIFBOND	 _IOW('i', 70, struct ifreq)	/* set bond if config */
+#define SIOCGIFBOND	_IOWR('i', 71, struct ifreq)	/* get bond if config */
+
+
+#define SIOCSIFCAP       _IOW('i', 90, struct ifreq)    /* set IF features */ 
+#define SIOCGIFCAP      _IOWR('i', 91, struct ifreq)    /* get IF features */
+
+#define	SIOCIFCREATE	_IOWR('i', 120, struct ifreq)	/* create clone if */
+#define	SIOCIFDESTROY	 _IOW('i', 121, struct ifreq)	/* destroy clone if */
+#define SIOCIFCREATE2   _IOWR('i', 122, struct ifreq)   /* create clone if with data */
+
+#define SIOCSDRVSPEC    _IOW('i', 123, struct ifdrv)    /* set driver-specific
+                                                                  parameters */
+#define SIOCGDRVSPEC    _IOWR('i', 123, struct ifdrv)   /* get driver-specific
+                                                                  parameters */
+#define	SIOCSIFVLAN	 _IOW('i', 126, struct ifreq)	/* set VLAN config */
+#define	SIOCGIFVLAN	_IOWR('i', 127, struct ifreq)	/* get VLAN config */
+#define	SIOCSETVLAN	SIOCSIFVLAN
+#define	SIOCGETVLAN	SIOCGIFVLAN
+
+#define	SIOCIFGCLONERS	_IOWR('i', 129, struct if_clonereq) /* get cloners */
+
+#define	SIOCGIFASYNCMAP _IOWR('i', 124, struct ifreq)	/* get ppp asyncmap */
+#define	SIOCSIFASYNCMAP _IOW('i', 125, struct ifreq)	/* set ppp asyncmap */
+
+
+
+#define SIOCGIFMAC	_IOWR('i', 130, struct ifreq)	/* get IF MAC label */
+#define SIOCSIFMAC	_IOW('i', 131, struct ifreq)	/* set IF MAC label */
+#define	SIOCSIFKPI	_IOW('i', 134, struct ifreq) /* set interface kext param - root only */
+#define	SIOCGIFKPI	_IOWR('i', 135, struct ifreq) /* get interface kext param */
+
+#define	SIOCGIFWAKEFLAGS _IOWR('i', 136, struct ifreq) /* get interface wake property flags */
+
+
+
+#endif /* !_SYS_SOCKIO_H_ */
diff -Nur cctools-877.5/include/sys/spawn.h cctools-877.5-AnV/include/sys/spawn.h
--- cctools-877.5/include/sys/spawn.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/spawn.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,76 @@
+/*
+ * Copyright (c) 2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+/*
+ * [SPN] Support for _POSIX_SPAWN
+ *
+ * This header contains information that is shared between the user space
+ * and kernel versions of the posix_spawn() code.  Shared elements are all
+ * manifest constants, at the current time.
+ */
+
+#ifndef	_SYS_SPAWN_H_
+#define	_SYS_SPAWN_H_
+
+/*
+ * Possible bit values which may be OR'ed together and provided as the second
+ * parameter to posix_spawnattr_setflags() or implicit returned in the value of
+ * the second parameter to posix_spawnattr_getflags().
+ */
+#define	POSIX_SPAWN_RESETIDS		0x0001	/* [SPN] R[UG]ID not E[UG]ID */
+#define	POSIX_SPAWN_SETPGROUP		0x0002	/* [SPN] set non-parent PGID */
+#define	POSIX_SPAWN_SETSIGDEF		0x0004	/* [SPN] reset sigset default */
+#define	POSIX_SPAWN_SETSIGMASK		0x0008	/* [SPN] set signal mask */
+
+#if 0	/* _POSIX_PRIORITY_SCHEDULING [PS] : not supported */
+#define	POSIX_SPAWN_SETSCHEDPARAM	0x0010
+#define	POSIX_SPAWN_SETSCHEDULER	0x0020
+#endif	/* 0 */
+
+#if	!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/*
+ * Darwin-specific flags
+ */
+#define	POSIX_SPAWN_SETEXEC		0x0040
+#define	POSIX_SPAWN_START_SUSPENDED	0x0080
+#define	POSIX_SPAWN_CLOEXEC_DEFAULT	0x4000
+
+/*
+ * Possible values to be set for the process control actions on resource starvation.
+ * POSIX_SPAWN_PCONTROL_THROTTLE indicates that the process is to be throttled on starvation.
+ * POSIX_SPAWN_PCONTROL_SUSPEND indicates that the process is to be suspended on starvation.
+ * POSIX_SPAWN_PCONTROL_KILL indicates that the process is to be terminated  on starvation.
+ */
+#define POSIX_SPAWN_PCONTROL_NONE	0x0000
+#define POSIX_SPAWN_PCONTROL_THROTTLE	0x0001
+#define POSIX_SPAWN_PCONTROL_SUSPEND	0x0002
+#define POSIX_SPAWN_PCONTROL_KILL	0x0003
+
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+#endif	/* _SYS_SPAWN_H_ */
diff -Nur cctools-877.5/include/sys/stat.h cctools-877.5-AnV/include/sys/stat.h
--- cctools-877.5/include/sys/stat.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/stat.h	2015-11-19 09:38:50 +0000
@@ -0,0 +1,404 @@
+/*
+ * Copyright (c) 2000-2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1989, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)stat.h	8.9 (Berkeley) 8/17/94
+ */
+
+
+#ifndef _SYS_STAT_H_
+#define	_SYS_STAT_H_
+
+#include <sys/_types.h>
+#include <sys/cdefs.h>
+#include <Availability.h>
+
+/* [XSI] The timespec structure may be defined as described in <time.h> */
+#include <sys/_types/_timespec.h>
+
+/*
+ * [XSI] The blkcnt_t, blksize_t, dev_t, ino_t, mode_t, nlink_t, uid_t,
+ * gid_t, off_t, and time_t types shall be defined as described in
+ * <sys/types.h>.
+ */
+#include <sys/_types/_blkcnt_t.h>
+#include <sys/_types/_blksize_t.h>
+#include <sys/_types/_dev_t.h>			/* device number */
+#include <sys/_types/_ino_t.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#include <sys/_types/_ino64_t.h>
+#endif /* !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE) */
+
+#include <sys/_types/_mode_t.h>
+#include <sys/_types/_nlink_t.h>
+#include <sys/_types/_uid_t.h>
+#include <sys/_types/_gid_t.h>
+#include <sys/_types/_off_t.h>
+#include <sys/_types/_time_t.h>
+
+#ifndef _OFF_T_
+#define _OFF_T_
+  typedef long _off_t;
+#if !defined(NO_OLDNAMES) || defined(_POSIX)
+  typedef long off32_t;
+#endif
+#endif
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/*
+ * XXX So deprecated, it would make your head spin
+ *
+ * The old stat structure.  In fact, this is not used by the kernel at all,
+ * and should not be used by user space, and should be removed from this
+ * header file entirely (along with the unused cvtstat() prototype in
+ * vnode_internal.h).
+ */
+struct ostat {
+	__uint16_t	st_dev;		/* inode's device */
+	ino_t		st_ino;		/* inode's number */
+	mode_t		st_mode;	/* inode protection mode */
+	nlink_t		st_nlink;	/* number of hard links */
+	__uint16_t	st_uid;		/* user ID of the file's owner */
+	__uint16_t	st_gid;		/* group ID of the file's group */
+	__uint16_t	st_rdev;	/* device type */
+	__int32_t	st_size;	/* file size, in bytes */
+	struct	timespec st_atimespec;	/* time of last access */
+	struct	timespec st_mtimespec;	/* time of last data modification */
+	struct	timespec st_ctimespec;	/* time of last file status change */
+	__int32_t	st_blksize;	/* optimal blocksize for I/O */
+	__int32_t	st_blocks;	/* blocks allocated for file */
+	__uint32_t	st_flags;	/* user defined flags for file */
+	__uint32_t	st_gen;		/* file generation number */
+};
+
+#define __DARWIN_STRUCT_STAT64_TIMES \
+	struct timespec st_atimespec;		/* time of last access */ \
+	struct timespec st_mtimespec;		/* time of last data modification */ \
+	struct timespec st_ctimespec;		/* time of last status change */ \
+	struct timespec st_birthtimespec;	/* time of file creation(birth) */
+
+#else /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+
+#define __DARWIN_STRUCT_STAT64_TIMES \
+	time_t		st_atime;		/* [XSI] Time of last access */ \
+	long		st_atimensec;		/* nsec of last access */ \
+	time_t		st_mtime;		/* [XSI] Last data modification time */ \
+	long		st_mtimensec;		/* last data modification nsec */ \
+	time_t		st_ctime;		/* [XSI] Time of last status change */ \
+	long		st_ctimensec;		/* nsec of last status change */ \
+	time_t		st_birthtime;		/*  File creation time(birth)  */ \
+	long		st_birthtimensec;	/* nsec of File creation time */
+
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/*
+ * This structure is used as the second parameter to the fstat64(),
+ * lstat64(), and stat64() functions, and for struct stat when
+ * __DARWIN_64_BIT_INO_T is set. __DARWIN_STRUCT_STAT64 is defined
+ * above, depending on whether we use struct timespec or the direct
+ * components.
+ *
+ * This is simillar to stat except for 64bit inode number
+ * number instead of 32bit ino_t and the addition of create(birth) time.
+ */
+#define __DARWIN_STRUCT_STAT64 { \
+	dev_t		st_dev;			/* [XSI] ID of device containing file */ \
+	mode_t		st_mode;		/* [XSI] Mode of file (see below) */ \
+	nlink_t		st_nlink;		/* [XSI] Number of hard links */ \
+	__darwin_ino64_t st_ino;		/* [XSI] File serial number */ \
+	uid_t		st_uid;			/* [XSI] User ID of the file */ \
+	gid_t		st_gid;			/* [XSI] Group ID of the file */ \
+	dev_t		st_rdev;		/* [XSI] Device ID */ \
+	__DARWIN_STRUCT_STAT64_TIMES \
+	off_t		st_size;		/* [XSI] file size, in bytes */ \
+	blkcnt_t	st_blocks;		/* [XSI] blocks allocated for file */ \
+	blksize_t	st_blksize;		/* [XSI] optimal blocksize for I/O */ \
+	__uint32_t	st_flags;		/* user defined flags for file */ \
+	__uint32_t	st_gen;			/* file generation number */ \
+	__int32_t	st_lspare;		/* RESERVED: DO NOT USE! */ \
+	__int64_t	st_qspare[2];		/* RESERVED: DO NOT USE! */ \
+}
+
+/*
+ * [XSI] This structure is used as the second parameter to the fstat(),
+ * lstat(), and stat() functions.
+ */
+#if __DARWIN_64_BIT_INO_T
+
+struct stat __DARWIN_STRUCT_STAT64;
+
+#else /* !__DARWIN_64_BIT_INO_T */
+
+struct stat {
+	dev_t	 	st_dev;		/* [XSI] ID of device containing file */
+	ino_t	  	st_ino;		/* [XSI] File serial number */
+	mode_t	 	st_mode;	/* [XSI] Mode of file (see below) */
+	nlink_t		st_nlink;	/* [XSI] Number of hard links */
+	uid_t		st_uid;		/* [XSI] User ID of the file */
+	gid_t		st_gid;		/* [XSI] Group ID of the file */
+	dev_t		st_rdev;	/* [XSI] Device ID */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+	struct	timespec st_atimespec;	/* time of last access */
+	struct	timespec st_mtimespec;	/* time of last data modification */
+	struct	timespec st_ctimespec;	/* time of last status change */
+#else
+	time_t		st_atime;	/* [XSI] Time of last access */
+	long		st_atimensec;	/* nsec of last access */
+	time_t		st_mtime;	/* [XSI] Last data modification time */
+	long		st_mtimensec;	/* last data modification nsec */
+	time_t		st_ctime;	/* [XSI] Time of last status change */
+	long		st_ctimensec;	/* nsec of last status change */
+#endif
+	off_t		st_size;	/* [XSI] file size, in bytes */
+	blkcnt_t	st_blocks;	/* [XSI] blocks allocated for file */
+	blksize_t	st_blksize;	/* [XSI] optimal blocksize for I/O */
+	__uint32_t	st_flags;	/* user defined flags for file */
+	__uint32_t	st_gen;		/* file generation number */
+	__int32_t	st_lspare;	/* RESERVED: DO NOT USE! */
+	__int64_t	st_qspare[2];	/* RESERVED: DO NOT USE! */
+};
+
+#endif /* __DARWIN_64_BIT_INO_T */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+
+#if !__DARWIN_ONLY_64_BIT_INO_T
+
+struct stat64 __DARWIN_STRUCT_STAT64;
+
+#endif /* !__DARWIN_ONLY_64_BIT_INO_T */
+
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define st_atime st_atimespec.tv_sec
+#define st_mtime st_mtimespec.tv_sec
+#define st_ctime st_ctimespec.tv_sec
+#define st_birthtime st_birthtimespec.tv_sec
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/*
+ * [XSI] The following are symbolic names for the values of type mode_t.  They
+ * are bitmap values.
+ */
+#include <sys/_types/_s_ifmt.h>
+
+/*
+ * [XSI] The following macros shall be provided to test whether a file is
+ * of the specified type.  The value m supplied to the macros is the value
+ * of st_mode from a stat structure.  The macro shall evaluate to a non-zero
+ * value if the test is true; 0 if the test is false.
+ */
+#define	S_ISBLK(m)	(((m) & S_IFMT) == S_IFBLK)	/* block special */
+#define	S_ISCHR(m)	(((m) & S_IFMT) == S_IFCHR)	/* char special */
+#define	S_ISDIR(m)	(((m) & S_IFMT) == S_IFDIR)	/* directory */
+#define	S_ISFIFO(m)	(((m) & S_IFMT) == S_IFIFO)	/* fifo or socket */
+#define	S_ISREG(m)	(((m) & S_IFMT) == S_IFREG)	/* regular file */
+#define	S_ISLNK(m)	(((m) & S_IFMT) == S_IFLNK)	/* symbolic link */
+#define	S_ISSOCK(m)	(((m) & S_IFMT) == S_IFSOCK)	/* socket */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	S_ISWHT(m)	(((m) & S_IFMT) == S_IFWHT)	/* OBSOLETE: whiteout */
+#endif
+
+/*
+ * [XSI] The implementation may implement message queues, semaphores, or
+ * shared memory objects as distinct file types.  The following macros
+ * shall be provided to test whether a file is of the specified type.
+ * The value of the buf argument supplied to the macros is a pointer to
+ * a stat structure.  The macro shall evaluate to a non-zero value if
+ * the specified object is implemented as a distinct file type and the
+ * specified file type is contained in the stat structure referenced by
+ * buf.  Otherwise, the macro shall evaluate to zero.
+ *
+ * NOTE:	The current implementation does not do this, although
+ *		this may change in future revisions, and co currently only
+ *		provides these macros to ensure source compatability with
+ *		implementations which do.
+ */
+#define	S_TYPEISMQ(buf)		(0)	/* Test for a message queue */
+#define	S_TYPEISSEM(buf)	(0)	/* Test for a semaphore */
+#define	S_TYPEISSHM(buf)	(0)	/* Test for a shared memory object */
+
+/*
+ * [TYM] The implementation may implement typed memory objects as distinct
+ * file types, and the following macro shall test whether a file is of the
+ * specified type.  The value of the buf argument supplied to the macros is
+ * a pointer to a stat structure.  The macro shall evaluate to a non-zero
+ * value if the specified object is implemented as a distinct file type and
+ * the specified file type is contained in the stat structure referenced by
+ * buf.  Otherwise, the macro shall evaluate to zero.
+ *
+ * NOTE:	The current implementation does not do this, although
+ *		this may change in future revisions, and co currently only
+ *		provides this macro to ensure source compatability with
+ *		implementations which do.
+ */
+#define	S_TYPEISTMO(buf)	(0)	/* Test for a typed memory object */
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	ACCESSPERMS	(S_IRWXU|S_IRWXG|S_IRWXO)	/* 0777 */
+							/* 7777 */
+#define	ALLPERMS	(S_ISUID|S_ISGID|S_ISTXT|S_IRWXU|S_IRWXG|S_IRWXO)
+							/* 0666 */
+#define	DEFFILEMODE	(S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH)
+
+#define S_BLKSIZE	512		/* block size used in the stat struct */
+
+/*
+ * Definitions of flags stored in file flags word.
+ *
+ * Super-user and owner changeable flags.
+ */
+#define	UF_SETTABLE	0x0000ffff	/* mask of owner changeable flags */
+#define	UF_NODUMP	0x00000001	/* do not dump file */
+#define	UF_IMMUTABLE	0x00000002	/* file may not be changed */
+#define	UF_APPEND	0x00000004	/* writes to file may only append */
+#define UF_OPAQUE	0x00000008	/* directory is opaque wrt. union */
+/*
+ * The following bit is reserved for FreeBSD.  It is not implemented
+ * in Mac OS X.
+ */
+/* #define UF_NOUNLINK	0x00000010 */	/* file may not be removed or renamed */
+#define UF_COMPRESSED	0x00000020	/* file is hfs-compressed */
+
+/* UF_TRACKED is used for dealing with document IDs.  We no longer issue
+   notifications for deletes or renames for files which have UF_TRACKED set. */
+#define UF_TRACKED		0x00000040
+
+/* Bits 0x0080 through 0x4000 are currently undefined. */
+#define UF_HIDDEN	0x00008000	/* hint that this item should not be */
+					/* displayed in a GUI */
+/*
+ * Super-user changeable flags.
+ */
+#define	SF_SETTABLE	0xffff0000	/* mask of superuser changeable flags */
+#define	SF_ARCHIVED	0x00010000	/* file is archived */
+#define	SF_IMMUTABLE	0x00020000	/* file may not be changed */
+#define	SF_APPEND	0x00040000	/* writes to file may only append */
+#define SF_RESTRICTED	0x00080000	/* restricted access */
+
+/*
+ * The following two bits are reserved for FreeBSD.  They are not
+ * implemented in Mac OS X.
+ */
+/* #define SF_NOUNLINK	0x00100000 */	/* file may not be removed or renamed */
+/* #define SF_SNAPSHOT	0x00200000 */	/* snapshot inode */
+/* NOTE: There is no SF_HIDDEN bit. */
+
+#endif
+
+
+__BEGIN_DECLS
+/* [XSI] */
+int	fchmod(int, mode_t) __DARWIN_ALIAS(fchmod);
+int	fstat(int, struct stat *) __DARWIN_INODE64(fstat);
+int	lstat(const char *, struct stat *) __DARWIN_INODE64(lstat);
+
+#define mkdir(a,b) mkdir(a)
+
+int	mkfifo(const char *, mode_t);
+int	stat(const char *, struct stat *) __DARWIN_INODE64(stat);
+int	mknod(const char *, mode_t, dev_t);
+
+#if __DARWIN_C_LEVEL >= 200809L
+int	fchmodat(int, const char *, mode_t, int) __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+int	fstatat(int, const char *, struct stat *, int) __DARWIN_INODE64(fstatat) __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+int	mkdirat(int, const char *, mode_t) __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+#endif
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+
+#include <sys/_types/_filesec_t.h>
+
+int	chflags(const char *, __uint32_t);
+int	chmodx_np(const char *, filesec_t);
+int	fchflags(int, __uint32_t);
+int	fchmodx_np(int, filesec_t);
+int	fstatx_np(int, struct stat *, filesec_t) __DARWIN_INODE64(fstatx_np);
+int	lchflags(const char *, __uint32_t) __OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0);
+int	lchmod(const char *, mode_t) __OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0);
+int	lstatx_np(const char *, struct stat *, filesec_t) __DARWIN_INODE64(lstatx_np);
+int	mkdirx_np(const char *, filesec_t);
+int	mkfifox_np(const char *, filesec_t);
+int	statx_np(const char *, struct stat *, filesec_t) __DARWIN_INODE64(statx_np);
+int	umaskx_np(filesec_t) __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_4,__MAC_10_6,__IPHONE_NA,__IPHONE_NA);
+
+#if !__DARWIN_ONLY_64_BIT_INO_T
+/* The following deprecated routines are simillar to stat and friends except provide struct stat64 instead of struct stat  */
+int	fstatx64_np(int, struct stat64 *, filesec_t) __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5,__MAC_10_6,__IPHONE_NA,__IPHONE_NA);
+int	lstatx64_np(const char *, struct stat64 *, filesec_t) __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5,__MAC_10_6,__IPHONE_NA,__IPHONE_NA);
+int	statx64_np(const char *, struct stat64 *, filesec_t) __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5,__MAC_10_6,__IPHONE_NA,__IPHONE_NA);
+int	fstat64(int, struct stat64 *) __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5,__MAC_10_6,__IPHONE_NA,__IPHONE_NA);
+int	lstat64(const char *, struct stat64 *) __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5,__MAC_10_6,__IPHONE_NA,__IPHONE_NA);
+int	stat64(const char *, struct stat64 *) __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_5,__MAC_10_6,__IPHONE_NA,__IPHONE_NA);
+#endif /* !__DARWIN_ONLY_64_BIT_INO_T */
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+__END_DECLS
+#endif /* !_SYS_STAT_H_ */
diff -Nur cctools-877.5/include/sys/statvfs.h cctools-877.5-AnV/include/sys/statvfs.h
--- cctools-877.5/include/sys/statvfs.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/statvfs.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,60 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+/*
+ * sys/statvfs.h
+ */
+#ifndef _SYS_STATVFS_H_
+#define	_SYS_STATVFS_H_
+
+#include <sys/_types.h>
+#include <sys/cdefs.h>
+
+#include <sys/_types/_fsblkcnt_t.h>
+#include <sys/_types/_fsfilcnt_t.h>
+
+/* Following structure is used as a statvfs/fstatvfs function parameter */
+struct statvfs {
+	unsigned long	f_bsize;	/* File system block size */
+	unsigned long	f_frsize;	/* Fundamental file system block size */
+	fsblkcnt_t	f_blocks;	/* Blocks on FS in units of f_frsize */
+	fsblkcnt_t	f_bfree;	/* Free blocks */
+	fsblkcnt_t	f_bavail;	/* Blocks available to non-root */
+	fsfilcnt_t	f_files;	/* Total inodes */
+	fsfilcnt_t	f_ffree;	/* Free inodes */
+	fsfilcnt_t	f_favail;	/* Free inodes for non-root */
+	unsigned long	f_fsid;		/* Filesystem ID */
+	unsigned long	f_flag;		/* Bit mask of values */
+	unsigned long	f_namemax;	/* Max file name length */
+};
+
+/* Defined bits for f_flag field value */
+#define	ST_RDONLY	0x00000001	/* Read-only file system */
+#define	ST_NOSUID	0x00000002	/* Does not honor setuid/setgid */
+
+__BEGIN_DECLS
+int fstatvfs(int, struct statvfs *);
+int statvfs(const char * __restrict, struct statvfs * __restrict);
+__END_DECLS
+
+#endif	/* _SYS_STATVFS_H_ */
diff -Nur cctools-877.5/include/sys/stdio.h cctools-877.5-AnV/include/sys/stdio.h
--- cctools-877.5/include/sys/stdio.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/stdio.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,45 @@
+/*
+ * Copyright (c) 2013 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _SYS_STDIO_H_
+#define	_SYS_STDIO_H_
+
+#include <sys/cdefs.h>
+
+#if __DARWIN_C_LEVEL >= 200809L
+#include <Availability.h>
+
+__BEGIN_DECLS
+
+int	renameat(int, const char *, int, const char *) __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+
+__END_DECLS
+
+#endif /* __DARWIN_C_LEVEL >= 200809L */
+
+#endif /* _SYS_STDIO_H_ */
diff -Nur cctools-877.5/include/sys/sys_domain.h cctools-877.5-AnV/include/sys/sys_domain.h
--- cctools-877.5/include/sys/sys_domain.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/sys_domain.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,57 @@
+/*
+ * Copyright (c) 2000-2005, 2012, 2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+
+#ifndef _SYSTEM_DOMAIN_H_
+#define _SYSTEM_DOMAIN_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/types.h>
+
+
+/* Kernel Events Protocol */ 
+#define SYSPROTO_EVENT 		1	/* kernel events protocol */
+
+/* Kernel Control Protocol */
+#define SYSPROTO_CONTROL       	2	/* kernel control protocol */
+#define AF_SYS_CONTROL		2	/* corresponding sub address type */
+
+/* System family socket address */
+struct sockaddr_sys {
+	u_char		ss_len;		/* sizeof(struct sockaddr_sys) */
+	u_char		ss_family;	/* AF_SYSTEM */
+	u_int16_t 	ss_sysaddr; 	/* protocol address in AF_SYSTEM */
+	u_int32_t 	ss_reserved[7]; /* reserved to the protocol use */
+};
+
+
+
+#endif /* _SYSTEM_DOMAIN_H_ */
+
+
diff -Nur cctools-877.5/include/sys/syscall.h cctools-877.5-AnV/include/sys/syscall.h
--- cctools-877.5/include/sys/syscall.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/syscall.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,533 @@
+/*
+ * Copyright (c) 2004-2008 Apple Inc. All rights reserved.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ * 
+ * 
+ * System call switch table.
+ *
+ * DO NOT EDIT-- this file is automatically generated.
+ * created from /SourceCache/xnu/xnu-2782.1.97/bsd/kern/syscalls.master
+ */
+
+#ifndef _SYS_SYSCALL_H_
+#define	_SYS_SYSCALL_H_
+
+#include <sys/appleapiopts.h>
+#ifdef __APPLE_API_PRIVATE
+#define	SYS_syscall        0
+#define	SYS_exit           1
+#define	SYS_fork           2
+#define	SYS_read           3
+#define	SYS_write          4
+#define	SYS_open           5
+#define	SYS_close          6
+#define	SYS_wait4          7
+			/* 8  old creat */
+#define	SYS_link           9
+#define	SYS_unlink         10
+			/* 11  old execv */
+#define	SYS_chdir          12
+#define	SYS_fchdir         13
+#define	SYS_mknod          14
+#define	SYS_chmod          15
+#define	SYS_chown          16
+			/* 17  old break */
+#define	SYS_getfsstat      18
+			/* 19  old lseek */
+#define	SYS_getpid         20
+			/* 21  old mount */
+			/* 22  old umount */
+#define	SYS_setuid         23
+#define	SYS_getuid         24
+#define	SYS_geteuid        25
+#define	SYS_ptrace         26
+#define	SYS_recvmsg        27
+#define	SYS_sendmsg        28
+#define	SYS_recvfrom       29
+#define	SYS_accept         30
+#define	SYS_getpeername    31
+#define	SYS_getsockname    32
+#define	SYS_access         33
+#define	SYS_chflags        34
+#define	SYS_fchflags       35
+#define	SYS_sync           36
+#define	SYS_kill           37
+			/* 38  old stat */
+#define	SYS_getppid        39
+			/* 40  old lstat */
+#define	SYS_dup            41
+#define	SYS_pipe           42
+#define	SYS_getegid        43
+			/* 44  old profil */
+			/* 45  old ktrace */
+#define	SYS_sigaction      46
+#define	SYS_getgid         47
+#define	SYS_sigprocmask    48
+#define	SYS_getlogin       49
+#define	SYS_setlogin       50
+#define	SYS_acct           51
+#define	SYS_sigpending     52
+#define	SYS_sigaltstack    53
+#define	SYS_ioctl          54
+#define	SYS_reboot         55
+#define	SYS_revoke         56
+#define	SYS_symlink        57
+#define	SYS_readlink       58
+#define	SYS_execve         59
+#define	SYS_umask          60
+#define	SYS_chroot         61
+			/* 62  old fstat */
+			/* 63  used internally , reserved */
+			/* 64  old getpagesize */
+#define	SYS_msync          65
+#define	SYS_vfork          66
+			/* 67  old vread */
+			/* 68  old vwrite */
+			/* 69  old sbrk */
+			/* 70  old sstk */
+			/* 71  old mmap */
+			/* 72  old vadvise */
+#define	SYS_munmap         73
+#define	SYS_mprotect       74
+#define	SYS_madvise        75
+			/* 76  old vhangup */
+			/* 77  old vlimit */
+#define	SYS_mincore        78
+#define	SYS_getgroups      79
+#define	SYS_setgroups      80
+#define	SYS_getpgrp        81
+#define	SYS_setpgid        82
+#define	SYS_setitimer      83
+			/* 84  old wait */
+#define	SYS_swapon         85
+#define	SYS_getitimer      86
+			/* 87  old gethostname */
+			/* 88  old sethostname */
+#define	SYS_getdtablesize  89
+#define	SYS_dup2           90
+			/* 91  old getdopt */
+#define	SYS_fcntl          92
+#define	SYS_select         93
+			/* 94  old setdopt */
+#define	SYS_fsync          95
+#define	SYS_setpriority    96
+#define	SYS_socket         97
+#define	SYS_connect        98
+			/* 99  old accept */
+#define	SYS_getpriority    100
+			/* 101  old send */
+			/* 102  old recv */
+			/* 103  old sigreturn */
+#define	SYS_bind           104
+#define	SYS_setsockopt     105
+#define	SYS_listen         106
+			/* 107  old vtimes */
+			/* 108  old sigvec */
+			/* 109  old sigblock */
+			/* 110  old sigsetmask */
+#define	SYS_sigsuspend     111
+			/* 112  old sigstack */
+			/* 113  old recvmsg */
+			/* 114  old sendmsg */
+			/* 115  old vtrace */
+#define	SYS_gettimeofday   116
+#define	SYS_getrusage      117
+#define	SYS_getsockopt     118
+			/* 119  old resuba */
+#define	SYS_readv          120
+#define	SYS_writev         121
+#define	SYS_settimeofday   122
+#define	SYS_fchown         123
+#define	SYS_fchmod         124
+			/* 125  old recvfrom */
+#define	SYS_setreuid       126
+#define	SYS_setregid       127
+#define	SYS_rename         128
+			/* 129  old truncate */
+			/* 130  old ftruncate */
+#define	SYS_flock          131
+#define	SYS_mkfifo         132
+#define	SYS_sendto         133
+#define	SYS_shutdown       134
+#define	SYS_socketpair     135
+#define	SYS_mkdir          136
+#define	SYS_rmdir          137
+#define	SYS_utimes         138
+#define	SYS_futimes        139
+#define	SYS_adjtime        140
+			/* 141  old getpeername */
+#define	SYS_gethostuuid    142
+			/* 143  old sethostid */
+			/* 144  old getrlimit */
+			/* 145  old setrlimit */
+			/* 146  old killpg */
+#define	SYS_setsid         147
+			/* 148  old setquota */
+			/* 149  old qquota */
+			/* 150  old getsockname */
+#define	SYS_getpgid        151
+#define	SYS_setprivexec    152
+#define	SYS_pread          153
+#define	SYS_pwrite         154
+#define	SYS_nfssvc         155
+			/* 156  old getdirentries */
+#define	SYS_statfs         157
+#define	SYS_fstatfs        158
+#define	SYS_unmount        159
+			/* 160  old async_daemon */
+#define	SYS_getfh          161
+			/* 162  old getdomainname */
+			/* 163  old setdomainname */
+			/* 164  */
+#define	SYS_quotactl       165
+			/* 166  old exportfs */
+#define	SYS_mount          167
+			/* 168  old ustat */
+#define	SYS_csops          169
+#define	SYS_csops_audittoken 170
+			/* 171  old wait3 */
+			/* 172  old rpause */
+#define	SYS_waitid         173
+			/* 174  old getdents */
+			/* 175  old gc_control */
+			/* 176  old add_profil */
+			/* 177  */
+			/* 178  */
+			/* 179  */
+#define	SYS_kdebug_trace   180
+#define	SYS_setgid         181
+#define	SYS_setegid        182
+#define	SYS_seteuid        183
+#define	SYS_sigreturn      184
+#define	SYS_chud           185
+			/* 186  */
+#define	SYS_fdatasync      187
+#define	SYS_stat           188
+#define	SYS_fstat          189
+#define	SYS_lstat          190
+#define	SYS_pathconf       191
+#define	SYS_fpathconf      192
+			/* 193  */
+#define	SYS_getrlimit      194
+#define	SYS_setrlimit      195
+#define	SYS_getdirentries  196
+#define	SYS_mmap           197
+			/* 198  __syscall */
+#define	SYS_lseek          199
+#define	SYS_truncate       200
+#define	SYS_ftruncate      201
+#define	SYS_sysctl         202
+#define	SYS_mlock          203
+#define	SYS_munlock        204
+#define	SYS_undelete       205
+			/* 206  old ATsocket */
+			/* 207  old ATgetmsg */
+			/* 208  old ATputmsg */
+			/* 209  old ATsndreq */
+			/* 210  old ATsndrsp */
+			/* 211  old ATgetreq */
+			/* 212  old ATgetrsp */
+			/* 213  Reserved for AppleTalk */
+			/* 214  */
+			/* 215  */
+#define	SYS_open_dprotected_np 216
+			/* 217  */
+			/* 218  */
+			/* 219  */
+#define	SYS_getattrlist    220
+#define	SYS_setattrlist    221
+#define	SYS_getdirentriesattr 222
+#define	SYS_exchangedata   223
+			/* 224  old checkuseraccess / fsgetpath ( which moved to 427 ) */
+#define	SYS_searchfs       225
+#define	SYS_delete         226
+#define	SYS_copyfile       227
+#define	SYS_fgetattrlist   228
+#define	SYS_fsetattrlist   229
+#define	SYS_poll           230
+#define	SYS_watchevent     231
+#define	SYS_waitevent      232
+#define	SYS_modwatch       233
+#define	SYS_getxattr       234
+#define	SYS_fgetxattr      235
+#define	SYS_setxattr       236
+#define	SYS_fsetxattr      237
+#define	SYS_removexattr    238
+#define	SYS_fremovexattr   239
+#define	SYS_listxattr      240
+#define	SYS_flistxattr     241
+#define	SYS_fsctl          242
+#define	SYS_initgroups     243
+#define	SYS_posix_spawn    244
+#define	SYS_ffsctl         245
+			/* 246  */
+#define	SYS_nfsclnt        247
+#define	SYS_fhopen         248
+			/* 249  */
+#define	SYS_minherit       250
+#define	SYS_semsys         251
+#define	SYS_msgsys         252
+#define	SYS_shmsys         253
+#define	SYS_semctl         254
+#define	SYS_semget         255
+#define	SYS_semop          256
+			/* 257  */
+#define	SYS_msgctl         258
+#define	SYS_msgget         259
+#define	SYS_msgsnd         260
+#define	SYS_msgrcv         261
+#define	SYS_shmat          262
+#define	SYS_shmctl         263
+#define	SYS_shmdt          264
+#define	SYS_shmget         265
+#define	SYS_shm_open       266
+#define	SYS_shm_unlink     267
+#define	SYS_sem_open       268
+#define	SYS_sem_close      269
+#define	SYS_sem_unlink     270
+#define	SYS_sem_wait       271
+#define	SYS_sem_trywait    272
+#define	SYS_sem_post       273
+#define	SYS_sysctlbyname   274
+			/* 275  old sem_init */
+			/* 276  old sem_destroy */
+#define	SYS_open_extended  277
+#define	SYS_umask_extended 278
+#define	SYS_stat_extended  279
+#define	SYS_lstat_extended 280
+#define	SYS_fstat_extended 281
+#define	SYS_chmod_extended 282
+#define	SYS_fchmod_extended 283
+#define	SYS_access_extended 284
+#define	SYS_settid         285
+#define	SYS_gettid         286
+#define	SYS_setsgroups     287
+#define	SYS_getsgroups     288
+#define	SYS_setwgroups     289
+#define	SYS_getwgroups     290
+#define	SYS_mkfifo_extended 291
+#define	SYS_mkdir_extended 292
+#define	SYS_identitysvc    293
+#define	SYS_shared_region_check_np 294
+			/* 295  old shared_region_map_np */
+#define	SYS_vm_pressure_monitor 296
+#define	SYS_psynch_rw_longrdlock 297
+#define	SYS_psynch_rw_yieldwrlock 298
+#define	SYS_psynch_rw_downgrade 299
+#define	SYS_psynch_rw_upgrade 300
+#define	SYS_psynch_mutexwait 301
+#define	SYS_psynch_mutexdrop 302
+#define	SYS_psynch_cvbroad 303
+#define	SYS_psynch_cvsignal 304
+#define	SYS_psynch_cvwait  305
+#define	SYS_psynch_rw_rdlock 306
+#define	SYS_psynch_rw_wrlock 307
+#define	SYS_psynch_rw_unlock 308
+#define	SYS_psynch_rw_unlock2 309
+#define	SYS_getsid         310
+#define	SYS_settid_with_pid 311
+#define	SYS_psynch_cvclrprepost 312
+#define	SYS_aio_fsync      313
+#define	SYS_aio_return     314
+#define	SYS_aio_suspend    315
+#define	SYS_aio_cancel     316
+#define	SYS_aio_error      317
+#define	SYS_aio_read       318
+#define	SYS_aio_write      319
+#define	SYS_lio_listio     320
+			/* 321  old __pthread_cond_wait */
+#define	SYS_iopolicysys    322
+#define	SYS_process_policy 323
+#define	SYS_mlockall       324
+#define	SYS_munlockall     325
+			/* 326  */
+#define	SYS_issetugid      327
+#define	SYS___pthread_kill 328
+#define	SYS___pthread_sigmask 329
+#define	SYS___sigwait      330
+#define	SYS___disable_threadsignal 331
+#define	SYS___pthread_markcancel 332
+#define	SYS___pthread_canceled 333
+#define	SYS___semwait_signal 334
+			/* 335  old utrace */
+#define	SYS_proc_info      336
+#define	SYS_sendfile       337
+#define	SYS_stat64         338
+#define	SYS_fstat64        339
+#define	SYS_lstat64        340
+#define	SYS_stat64_extended 341
+#define	SYS_lstat64_extended 342
+#define	SYS_fstat64_extended 343
+#define	SYS_getdirentries64 344
+#define	SYS_statfs64       345
+#define	SYS_fstatfs64      346
+#define	SYS_getfsstat64    347
+#define	SYS___pthread_chdir 348
+#define	SYS___pthread_fchdir 349
+#define	SYS_audit          350
+#define	SYS_auditon        351
+			/* 352  */
+#define	SYS_getauid        353
+#define	SYS_setauid        354
+			/* 355  old getaudit */
+			/* 356  old setaudit */
+#define	SYS_getaudit_addr  357
+#define	SYS_setaudit_addr  358
+#define	SYS_auditctl       359
+#define	SYS_bsdthread_create 360
+#define	SYS_bsdthread_terminate 361
+#define	SYS_kqueue         362
+#define	SYS_kevent         363
+#define	SYS_lchown         364
+#define	SYS_stack_snapshot 365
+#define	SYS_bsdthread_register 366
+#define	SYS_workq_open     367
+#define	SYS_workq_kernreturn 368
+#define	SYS_kevent64       369
+#define	SYS___old_semwait_signal 370
+#define	SYS___old_semwait_signal_nocancel 371
+#define	SYS_thread_selfid  372
+#define	SYS_ledger         373
+			/* 374  */
+			/* 375  */
+			/* 376  */
+			/* 377  */
+			/* 378  */
+			/* 379  */
+#define	SYS___mac_execve   380
+#define	SYS___mac_syscall  381
+#define	SYS___mac_get_file 382
+#define	SYS___mac_set_file 383
+#define	SYS___mac_get_link 384
+#define	SYS___mac_set_link 385
+#define	SYS___mac_get_proc 386
+#define	SYS___mac_set_proc 387
+#define	SYS___mac_get_fd   388
+#define	SYS___mac_set_fd   389
+#define	SYS___mac_get_pid  390
+#define	SYS___mac_get_lcid 391
+#define	SYS___mac_get_lctx 392
+#define	SYS___mac_set_lctx 393
+#define	SYS_setlcid        394
+#define	SYS_getlcid        395
+#define	SYS_read_nocancel  396
+#define	SYS_write_nocancel 397
+#define	SYS_open_nocancel  398
+#define	SYS_close_nocancel 399
+#define	SYS_wait4_nocancel 400
+#define	SYS_recvmsg_nocancel 401
+#define	SYS_sendmsg_nocancel 402
+#define	SYS_recvfrom_nocancel 403
+#define	SYS_accept_nocancel 404
+#define	SYS_msync_nocancel 405
+#define	SYS_fcntl_nocancel 406
+#define	SYS_select_nocancel 407
+#define	SYS_fsync_nocancel 408
+#define	SYS_connect_nocancel 409
+#define	SYS_sigsuspend_nocancel 410
+#define	SYS_readv_nocancel 411
+#define	SYS_writev_nocancel 412
+#define	SYS_sendto_nocancel 413
+#define	SYS_pread_nocancel 414
+#define	SYS_pwrite_nocancel 415
+#define	SYS_waitid_nocancel 416
+#define	SYS_poll_nocancel  417
+#define	SYS_msgsnd_nocancel 418
+#define	SYS_msgrcv_nocancel 419
+#define	SYS_sem_wait_nocancel 420
+#define	SYS_aio_suspend_nocancel 421
+#define	SYS___sigwait_nocancel 422
+#define	SYS___semwait_signal_nocancel 423
+#define	SYS___mac_mount    424
+#define	SYS___mac_get_mount 425
+#define	SYS___mac_getfsstat 426
+#define	SYS_fsgetpath      427
+#define	SYS_audit_session_self 428
+#define	SYS_audit_session_join 429
+#define	SYS_fileport_makeport 430
+#define	SYS_fileport_makefd 431
+#define	SYS_audit_session_port 432
+#define	SYS_pid_suspend    433
+#define	SYS_pid_resume     434
+#define	SYS_pid_hibernate  435
+#define	SYS_pid_shutdown_sockets 436
+			/* 437  old shared_region_slide_np */
+#define	SYS_shared_region_map_and_slide_np 438
+#define	SYS_kas_info       439
+#define	SYS_memorystatus_control 440
+#define	SYS_guarded_open_np 441
+#define	SYS_guarded_close_np 442
+#define	SYS_guarded_kqueue_np 443
+#define	SYS_change_fdguard_np 444
+			/* 445  old __proc_suppress */
+#define	SYS_proc_rlimit_control 446
+#define	SYS_connectx       447
+#define	SYS_disconnectx    448
+#define	SYS_peeloff        449
+#define	SYS_socket_delegate 450
+#define	SYS_telemetry      451
+#define	SYS_proc_uuid_policy 452
+#define	SYS_memorystatus_get_level 453
+#define	SYS_system_override 454
+#define	SYS_vfs_purge      455
+#define	SYS_sfi_ctl        456
+#define	SYS_sfi_pidctl     457
+#define	SYS_coalition      458
+#define	SYS_coalition_info 459
+#define	SYS_necp_match_policy 460
+#define	SYS_getattrlistbulk 461
+			/* 462  */
+#define	SYS_openat         463
+#define	SYS_openat_nocancel 464
+#define	SYS_renameat       465
+#define	SYS_faccessat      466
+#define	SYS_fchmodat       467
+#define	SYS_fchownat       468
+#define	SYS_fstatat        469
+#define	SYS_fstatat64      470
+#define	SYS_linkat         471
+#define	SYS_unlinkat       472
+#define	SYS_readlinkat     473
+#define	SYS_symlinkat      474
+#define	SYS_mkdirat        475
+#define	SYS_getattrlistat  476
+#define	SYS_proc_trace_log 477
+#define	SYS_bsdthread_ctl  478
+#define	SYS_openbyid_np    479
+#define	SYS_recvmsg_x      480
+#define	SYS_sendmsg_x      481
+#define	SYS_thread_selfusage 482
+#define	SYS_csrctl         483
+#define	SYS_guarded_open_dprotected_np 484
+#define	SYS_guarded_write_np 485
+#define	SYS_guarded_pwrite_np 486
+#define	SYS_guarded_writev_np 487
+#define	SYS_rename_ext     488
+#define	SYS_mremap_encrypted 489
+#define	SYS_MAXSYSCALL	490
+
+#endif /* __APPLE_API_PRIVATE */
+#endif /* !_SYS_SYSCALL_H_ */
diff -Nur cctools-877.5/include/sys/sysctl.h cctools-877.5-AnV/include/sys/sysctl.h
--- cctools-877.5/include/sys/sysctl.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/sysctl.h	2015-11-16 07:56:33 +0000
@@ -0,0 +1,783 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1989, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * This code is derived from software contributed to Berkeley by
+ * Mike Karels at Berkeley Software Design, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)sysctl.h	8.1 (Berkeley) 6/2/93
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+#ifndef _SYS_SYSCTL_H_
+#define	_SYS_SYSCTL_H_
+
+/*
+ * These are for the eproc structure defined below.
+ */
+#include <sys/cdefs.h>
+
+#include <sys/appleapiopts.h>
+#include <sys/time.h>
+#include <sys/ucred.h>
+#include <sys/proc.h>
+#include <sys/vm.h>
+
+
+/*
+ * Definitions for sysctl call.  The sysctl call uses a hierarchical name
+ * for objects that can be examined or modified.  The name is expressed as
+ * a sequence of integers.  Like a file path name, the meaning of each
+ * component depends on its place in the hierarchy.  The top-level and kern
+ * identifiers are defined here, and other identifiers are defined in the
+ * respective subsystem header files.
+ */
+
+#define CTL_MAXNAME	12	/* largest number of components supported */
+
+/*
+ * Each subsystem defined by sysctl defines a list of variables
+ * for that subsystem. Each name is either a node with further 
+ * levels defined below it, or it is a leaf of some particular
+ * type given below. Each sysctl level defines a set of name/type
+ * pairs to be used by sysctl(1) in manipulating the subsystem.
+ *
+ * When declaring new sysctl names, use the CTLFLAG_LOCKED flag in the
+ * type to indicate that all necessary locking will be handled
+ * within the sysctl.
+ *
+ * Any sysctl defined without CTLFLAG_LOCKED is considered legacy
+ * and will be protected by a global mutex.
+ *
+ * Note:	This is not optimal, so it is best to handle locking
+ *		yourself, if you are able to do so.  A simple design
+ *		pattern for use to avoid in a single function known
+ *		to potentially be in the paging path ot doing a DMA
+ *		to physical memory in a user space process is:
+ *
+ *			lock
+ *			perform operation vs. local buffer
+ *			unlock
+ *			SYSCTL_OUT(rey, local buffer, length)
+ *
+ *		...this assumes you are not using a deep call graph
+ *		or are unable to pass a local buffer address as a
+ *		parameter into your deep call graph.
+ *
+ *		Note that very large user buffers can fail the wire
+ *		if to do so would require more physical pages than
+ *		are available (the caller will get an ENOMEM error,
+ *		see sysctl_mem_hold() for details).
+ */
+struct ctlname {
+	char	*ctl_name;	/* subsystem name */
+	int	ctl_type;	/* type of name */
+};
+
+#define CTLTYPE		0xf	/* Mask for the type */
+#define	CTLTYPE_NODE	1	/* name is a node */
+#define	CTLTYPE_INT	2	/* name describes an integer */
+#define	CTLTYPE_STRING	3	/* name describes a string */
+#define	CTLTYPE_QUAD	4	/* name describes a 64-bit number */
+#define	CTLTYPE_OPAQUE	5	/* name describes a structure */
+#define	CTLTYPE_STRUCT	CTLTYPE_OPAQUE	/* name describes a structure */
+
+#define CTLFLAG_RD	0x80000000	/* Allow reads of variable */
+#define CTLFLAG_WR	0x40000000	/* Allow writes to the variable */
+#define CTLFLAG_RW	(CTLFLAG_RD|CTLFLAG_WR)
+#define CTLFLAG_NOLOCK	0x20000000	/* XXX Don't Lock */
+#define CTLFLAG_ANYBODY	0x10000000	/* All users can set this var */
+#define CTLFLAG_SECURE	0x08000000	/* Permit set only if securelevel<=0 */
+#define CTLFLAG_MASKED	0x04000000	/* deprecated variable, do not display */
+#define CTLFLAG_NOAUTO	0x02000000	/* do not auto-register */
+#define CTLFLAG_KERN	0x01000000	/* valid inside the kernel */
+#define CTLFLAG_LOCKED	0x00800000	/* node will handle locking itself */
+#define CTLFLAG_OID2	0x00400000	/* struct sysctl_oid has version info */
+
+/*
+ * USE THIS instead of a hardwired number from the categories below
+ * to get dynamically assigned sysctl entries using the linker-set
+ * technology. This is the way nearly all new sysctl variables should
+ * be implemented.
+ *
+ * e.g. SYSCTL_INT(_parent, OID_AUTO, name, CTLFLAG_RW, &variable, 0, "");
+ *
+ * Note that linker set technology will automatically register all nodes
+ * declared like this on kernel initialization, UNLESS they are defined
+ * in I/O-Kit. In this case, you have to call sysctl_register_oid()
+ * manually - just like in a KEXT.
+ */
+#define OID_AUTO	(-1)
+#define OID_AUTO_START 100 /* conventional */
+
+
+#define SYSCTL_DEF_ENABLED
+
+#ifdef SYSCTL_DEF_ENABLED
+/*
+ * Top-level identifiers
+ */
+#define	CTL_UNSPEC	0		/* unused */
+#define	CTL_KERN	1		/* "high kernel": proc, limits */
+#define	CTL_VM		2		/* virtual memory */
+#define	CTL_VFS		3		/* file system, mount type is next */
+#define	CTL_NET		4		/* network, see socket.h */
+#define	CTL_DEBUG	5		/* debugging parameters */
+#define	CTL_HW		6		/* generic cpu/io */
+#define	CTL_MACHDEP	7		/* machine dependent */
+#define	CTL_USER	8		/* user-level */
+#define	CTL_MAXID	9		/* number of valid top-level ids */
+
+#define CTL_NAMES { \
+	{ 0, 0 }, \
+	{ "kern", CTLTYPE_NODE }, \
+	{ "vm", CTLTYPE_NODE }, \
+	{ "vfs", CTLTYPE_NODE }, \
+	{ "net", CTLTYPE_NODE }, \
+	{ "debug", CTLTYPE_NODE }, \
+	{ "hw", CTLTYPE_NODE }, \
+	{ "machdep", CTLTYPE_NODE }, \
+	{ "user", CTLTYPE_NODE }, \
+}
+
+/*
+ * CTL_KERN identifiers
+ */
+#define	KERN_OSTYPE	 	 1	/* string: system version */
+#define	KERN_OSRELEASE	 	 2	/* string: system release */
+#define	KERN_OSREV	 	 3	/* int: system revision */
+#define	KERN_VERSION	 	 4	/* string: compile time info */
+#define	KERN_MAXVNODES	 	 5	/* int: max vnodes */
+#define	KERN_MAXPROC	 	 6	/* int: max processes */
+#define	KERN_MAXFILES	 	 7	/* int: max open files */
+#define	KERN_ARGMAX	 	 8	/* int: max arguments to exec */
+#define	KERN_SECURELVL	 	 9	/* int: system security level */
+#define	KERN_HOSTNAME		10	/* string: hostname */
+#define	KERN_HOSTID		11	/* int: host identifier */
+#define	KERN_CLOCKRATE		12	/* struct: struct clockrate */
+#define	KERN_VNODE		13	/* struct: vnode structures */
+#define	KERN_PROC		14	/* struct: process entries */
+#define	KERN_FILE		15	/* struct: file entries */
+#define	KERN_PROF		16	/* node: kernel profiling info */
+#define	KERN_POSIX1		17	/* int: POSIX.1 version */
+#define	KERN_NGROUPS		18	/* int: # of supplemental group ids */
+#define	KERN_JOB_CONTROL	19	/* int: is job control available */
+#define	KERN_SAVED_IDS		20	/* int: saved set-user/group-ID */
+#define	KERN_BOOTTIME		21	/* struct: time kernel was booted */
+#define KERN_NISDOMAINNAME	22	/* string: YP domain name */
+#define KERN_DOMAINNAME		KERN_NISDOMAINNAME
+#define	KERN_MAXPARTITIONS	23	/* int: number of partitions/disk */
+#define	KERN_KDEBUG			24	/* int: kernel trace points */
+#define KERN_UPDATEINTERVAL	25	/* int: update process sleep time */
+#define KERN_OSRELDATE		26	/* int: OS release date */
+#define KERN_NTP_PLL		27	/* node: NTP PLL control */
+#define	KERN_BOOTFILE		28	/* string: name of booted kernel */
+#define	KERN_MAXFILESPERPROC	29	/* int: max open files per proc */
+#define	KERN_MAXPROCPERUID 	30	/* int: max processes per uid */
+#define KERN_DUMPDEV		31	/* dev_t: device to dump on */
+#define	KERN_IPC		32	/* node: anything related to IPC */
+#define	KERN_DUMMY		33	/* unused */
+#define	KERN_PS_STRINGS	34	/* int: address of PS_STRINGS */
+#define	KERN_USRSTACK32	35	/* int: address of USRSTACK */
+#define	KERN_LOGSIGEXIT	36	/* int: do we log sigexit procs? */
+#define KERN_SYMFILE		37	/* string: kernel symbol filename */
+#define KERN_PROCARGS		38
+                             /* 39 was KERN_PCSAMPLES... now deprecated */
+#define KERN_NETBOOT		40	/* int: are we netbooted? 1=yes,0=no */
+                             /* 41 was KERN_PANICINFO : panic UI information (deprecated) */
+#define	KERN_SYSV		42	/* node: System V IPC information */
+#define KERN_AFFINITY		43	/* xxx */
+#define KERN_TRANSLATE	   	44	/* xxx */
+#define KERN_CLASSIC	   	KERN_TRANSLATE	/* XXX backwards compat */
+#define KERN_EXEC		45	/* xxx */
+#define KERN_CLASSICHANDLER	KERN_EXEC /* XXX backwards compatibility */
+#define	KERN_AIOMAX		46	/* int: max aio requests */
+#define	KERN_AIOPROCMAX		47	/* int: max aio requests per process */
+#define	KERN_AIOTHREADS		48	/* int: max aio worker threads */
+#ifdef __APPLE_API_UNSTABLE
+#define	KERN_PROCARGS2		49
+#endif /* __APPLE_API_UNSTABLE */
+#define KERN_COREFILE		50	/* string: corefile format string */
+#define KERN_COREDUMP		51	/* int: whether to coredump at all */
+#define	KERN_SUGID_COREDUMP	52	/* int: whether to dump SUGID cores */
+#define	KERN_PROCDELAYTERM	53	/* int: set/reset current proc for delayed termination during shutdown */
+#define KERN_SHREG_PRIVATIZABLE	54	/* int: can shared regions be privatized ? */
+                             /* 55 was KERN_PROC_LOW_PRI_IO... now deprecated */
+#define	KERN_LOW_PRI_WINDOW	56	/* int: set/reset throttle window - milliseconds */
+#define	KERN_LOW_PRI_DELAY	57	/* int: set/reset throttle delay - milliseconds */
+#define	KERN_POSIX		58	/* node: posix tunables */
+#define	KERN_USRSTACK64		59	/* LP64 user stack query */
+#define KERN_NX_PROTECTION	60	/* int: whether no-execute protection is enabled */
+#define	KERN_TFP 		61	/* Task for pid settings */
+#define	KERN_PROCNAME 		62	/* setup process program  name(2*MAXCOMLEN) */
+#define	KERN_THALTSTACK		63	/* for compat with older x86 and does nothing */
+#define	KERN_SPECULATIVE_READS	64	/* int: whether speculative reads are disabled */
+#define	KERN_OSVERSION		65	/* for build number i.e. 9A127 */
+#define	KERN_SAFEBOOT		66	/* are we booted safe? */
+#define	KERN_LCTX		67	/* node: login context */
+#define KERN_RAGEVNODE		68
+#define KERN_TTY		69	/* node: tty settings */
+#define KERN_CHECKOPENEVT       70      /* spi: check the VOPENEVT flag on vnodes at open time */
+#define	KERN_THREADNAME		71	/* set/get thread name */
+#define	KERN_MAXID		72	/* number of valid kern ids */
+/*
+ * Don't add any more sysctls like this.  Instead, use the SYSCTL_*() macros
+ * and OID_AUTO. This will have the added benefit of not having to recompile
+ * sysctl(8) to pick up your changes.
+ */
+
+
+#if defined(__LP64__)
+#define	KERN_USRSTACK KERN_USRSTACK64
+#else
+#define	KERN_USRSTACK KERN_USRSTACK32
+#endif
+
+
+/* KERN_RAGEVNODE types */
+#define KERN_RAGE_PROC		1
+#define KERN_RAGE_THREAD	2
+#define KERN_UNRAGE_PROC	3
+#define KERN_UNRAGE_THREAD	4
+
+/* KERN_OPENEVT types */
+#define KERN_OPENEVT_PROC     1
+#define KERN_UNOPENEVT_PROC   2
+
+/* KERN_TFP types */
+#define KERN_TFP_POLICY 		1
+
+/* KERN_TFP_POLICY values . All policies allow task port for self */
+#define KERN_TFP_POLICY_DENY 		0 	/* Deny Mode: None allowed except privileged */
+#define KERN_TFP_POLICY_DEFAULT 	2	/* Default  Mode: related ones allowed and upcall authentication */
+
+/* KERN_KDEBUG types */
+#define KERN_KDEFLAGS		1
+#define KERN_KDDFLAGS		2
+#define KERN_KDENABLE		3
+#define KERN_KDSETBUF		4
+#define KERN_KDGETBUF		5
+#define KERN_KDSETUP		6
+#define KERN_KDREMOVE		7
+#define KERN_KDSETREG		8
+#define KERN_KDGETREG		9
+#define KERN_KDREADTR		10
+#define KERN_KDPIDTR		11
+#define KERN_KDTHRMAP           12
+/* Don't use 13 as it is overloaded with KERN_VNODE */
+#define KERN_KDPIDEX            14
+#define KERN_KDSETRTCDEC        15
+#define KERN_KDGETENTROPY       16		/* Obsolescent */
+#define KERN_KDWRITETR		17
+#define KERN_KDWRITEMAP		18
+#define KERN_KDENABLE_BG_TRACE	19
+#define KERN_KDDISABLE_BG_TRACE	20
+#define KERN_KDREADCURTHRMAP	21
+#define KERN_KDSET_TYPEFILTER   22
+#define KERN_KDBUFWAIT		23
+#define KERN_KDCPUMAP		24
+
+#define CTL_KERN_NAMES { \
+	{ 0, 0 }, \
+	{ "ostype", CTLTYPE_STRING }, \
+	{ "osrelease", CTLTYPE_STRING }, \
+	{ "osrevision", CTLTYPE_INT }, \
+	{ "version", CTLTYPE_STRING }, \
+	{ "maxvnodes", CTLTYPE_INT }, \
+	{ "maxproc", CTLTYPE_INT }, \
+	{ "maxfiles", CTLTYPE_INT }, \
+	{ "argmax", CTLTYPE_INT }, \
+	{ "securelevel", CTLTYPE_INT }, \
+	{ "hostname", CTLTYPE_STRING }, \
+	{ "hostid", CTLTYPE_INT }, \
+	{ "clockrate", CTLTYPE_STRUCT }, \
+	{ "vnode", CTLTYPE_STRUCT }, \
+	{ "proc", CTLTYPE_STRUCT }, \
+	{ "file", CTLTYPE_STRUCT }, \
+	{ "profiling", CTLTYPE_NODE }, \
+	{ "posix1version", CTLTYPE_INT }, \
+	{ "ngroups", CTLTYPE_INT }, \
+	{ "job_control", CTLTYPE_INT }, \
+	{ "saved_ids", CTLTYPE_INT }, \
+	{ "boottime", CTLTYPE_STRUCT }, \
+	{ "nisdomainname", CTLTYPE_STRING }, \
+	{ "maxpartitions", CTLTYPE_INT }, \
+	{ "kdebug", CTLTYPE_INT }, \
+	{ "update", CTLTYPE_INT }, \
+	{ "osreldate", CTLTYPE_INT }, \
+	{ "ntp_pll", CTLTYPE_NODE }, \
+	{ "bootfile", CTLTYPE_STRING }, \
+	{ "maxfilesperproc", CTLTYPE_INT }, \
+	{ "maxprocperuid", CTLTYPE_INT }, \
+	{ "dumpdev", CTLTYPE_STRUCT }, /* we lie; don't print as int */ \
+	{ "ipc", CTLTYPE_NODE }, \
+	{ "dummy", CTLTYPE_INT }, \
+	{ "dummy", CTLTYPE_INT }, \
+	{ "usrstack", CTLTYPE_INT }, \
+	{ "logsigexit", CTLTYPE_INT }, \
+	{ "symfile",CTLTYPE_STRING },\
+	{ "procargs",CTLTYPE_STRUCT },\
+        { "dummy", CTLTYPE_INT },		/* deprecated pcsamples */ \
+	{ "netboot", CTLTYPE_INT }, \
+	{ "dummy", CTLTYPE_INT }, 		/* deprecated: panicinfo */ \
+	{ "sysv", CTLTYPE_NODE }, \
+	{ "dummy", CTLTYPE_INT }, \
+	{ "dummy", CTLTYPE_INT }, \
+	{ "exec", CTLTYPE_NODE }, \
+	{ "aiomax", CTLTYPE_INT }, \
+	{ "aioprocmax", CTLTYPE_INT }, \
+	{ "aiothreads", CTLTYPE_INT }, \
+	{ "procargs2",CTLTYPE_STRUCT }, \
+	{ "corefile",CTLTYPE_STRING }, \
+	{ "coredump", CTLTYPE_INT }, \
+	{ "sugid_coredump", CTLTYPE_INT }, \
+	{ "delayterm", CTLTYPE_INT }, \
+	{ "shreg_private", CTLTYPE_INT }, \
+	{ "proc_low_pri_io", CTLTYPE_INT }, \
+	{ "low_pri_window", CTLTYPE_INT }, \
+	{ "low_pri_delay", CTLTYPE_INT }, \
+	{ "posix", CTLTYPE_NODE }, \
+	{ "usrstack64", CTLTYPE_QUAD }, \
+	{ "nx", CTLTYPE_INT }, \
+	{ "tfp", CTLTYPE_NODE }, \
+	{ "procname", CTLTYPE_STRING }, \
+	{ "threadsigaltstack", CTLTYPE_INT }, \
+	{ "speculative_reads_disabled", CTLTYPE_INT }, \
+	{ "osversion", CTLTYPE_STRING }, \
+	{ "safeboot", CTLTYPE_INT }, \
+	{ "lctx", CTLTYPE_NODE }, \
+	{ "rage_vnode", CTLTYPE_INT }, \
+	{ "tty", CTLTYPE_NODE },	\
+	{ "check_openevt", CTLTYPE_INT }, \
+	{ "thread_name", CTLTYPE_STRING } \
+}
+
+/*
+ * CTL_VFS identifiers
+ */
+#define CTL_VFS_NAMES { \
+	{ "vfsconf", CTLTYPE_STRUCT } \
+}
+
+/* 
+ * KERN_PROC subtypes
+ */
+#define KERN_PROC_ALL		0	/* everything */
+#define	KERN_PROC_PID		1	/* by process id */
+#define	KERN_PROC_PGRP		2	/* by process group id */
+#define	KERN_PROC_SESSION	3	/* by session of pid */
+#define	KERN_PROC_TTY		4	/* by controlling tty */
+#define	KERN_PROC_UID		5	/* by effective uid */
+#define	KERN_PROC_RUID		6	/* by real uid */
+#define	KERN_PROC_LCID		7	/* by login context id */
+
+/*
+ * KERN_LCTX subtypes
+ */
+#define	KERN_LCTX_ALL		0	/* everything */
+#define	KERN_LCTX_LCID		1	/* by login context id */
+
+
+/* 
+ * KERN_PROC subtype ops return arrays of augmented proc structures:
+ */
+
+struct _pcred {
+	char	pc_lock[72];		/* opaque content */
+	struct	ucred *pc_ucred;	/* Current credentials. */
+	uid_t	p_ruid;			/* Real user id. */
+	uid_t	p_svuid;		/* Saved effective user id. */
+	gid_t	p_rgid;			/* Real group id. */
+	gid_t	p_svgid;		/* Saved effective group id. */
+	int	p_refcnt;		/* Number of references. */
+};
+
+struct _ucred {
+	int32_t	cr_ref;			/* reference count */
+	uid_t	cr_uid;			/* effective user id */
+	short	cr_ngroups;		/* number of groups */
+	gid_t	cr_groups[NGROUPS];	/* groups */
+};
+
+struct kinfo_proc {
+	struct	extern_proc kp_proc;			/* proc structure */
+	struct	eproc {
+		struct	proc *e_paddr;		/* address of proc */
+		struct	session *e_sess;	/* session pointer */
+		struct	_pcred e_pcred;		/* process credentials */
+		struct	_ucred e_ucred;		/* current credentials */
+		struct	 vmspace e_vm;		/* address space */
+		pid_t	e_ppid;			/* parent process id */
+		pid_t	e_pgid;			/* process group id */
+		short	e_jobc;			/* job control counter */
+		dev_t	e_tdev;			/* controlling tty dev */
+		pid_t	e_tpgid;		/* tty process group id */
+		struct	session *e_tsess;	/* tty session pointer */
+#define	WMESGLEN	7
+		char	e_wmesg[WMESGLEN+1];	/* wchan message */
+		segsz_t e_xsize;		/* text size */
+		short	e_xrssize;		/* text rss */
+		short	e_xccount;		/* text references */
+		short	e_xswrss;
+		int32_t	e_flag;
+#define	EPROC_CTTY	0x01	/* controlling tty vnode active */
+#define	EPROC_SLEADER	0x02	/* session leader */
+#define	COMAPT_MAXLOGNAME	12
+		char	e_login[COMAPT_MAXLOGNAME];	/* short setlogin() name */
+#if CONFIG_LCTX
+		pid_t	e_lcid;
+		int32_t	e_spare[3];
+#else
+		int32_t	e_spare[4];
+#endif
+	} kp_eproc;
+};
+
+struct kinfo_lctx {
+	pid_t	id;	/* Login Context ID */
+	int	mc;	/* Member Count */
+};
+
+
+
+/*
+ * KERN_IPC identifiers
+ */
+#define KIPC_MAXSOCKBUF		1	/* int: max size of a socket buffer */
+#define	KIPC_SOCKBUF_WASTE	2	/* int: wastage factor in sockbuf */
+#define	KIPC_SOMAXCONN		3	/* int: max length of connection q */
+#define	KIPC_MAX_LINKHDR	4	/* int: max length of link header */
+#define	KIPC_MAX_PROTOHDR	5	/* int: max length of network header */
+#define	KIPC_MAX_HDR		6	/* int: max total length of headers */
+#define	KIPC_MAX_DATALEN	7	/* int: max length of data? */
+#define	KIPC_MBSTAT		8	/* struct: mbuf usage statistics */
+#define	KIPC_NMBCLUSTERS	9	/* int: maximum mbuf clusters */
+#define KIPC_SOQLIMITCOMPAT	10	/* int: socket queue limit */
+
+/*
+ * CTL_VM identifiers
+ */
+#define	VM_METER	1		/* struct vmmeter */
+#define	VM_LOADAVG	2		/* struct loadavg */
+/*
+ * Note: "3" was skipped sometime ago and should probably remain unused
+ * to avoid any new entry from being accepted by older kernels...
+ */ 
+#define	VM_MACHFACTOR	4		/* struct loadavg with mach factor*/
+#define VM_SWAPUSAGE	5		/* total swap usage */
+#define	VM_MAXID	6		/* number of valid vm ids */
+
+#define	CTL_VM_NAMES { \
+	{ 0, 0 }, \
+	{ "vmmeter", CTLTYPE_STRUCT }, \
+	{ "loadavg", CTLTYPE_STRUCT }, \
+	{ 0, 0 }, /* placeholder for "3" (see comment above) */ \
+	{ "dummy", CTLTYPE_INT }, \
+	{ "swapusage", CTLTYPE_STRUCT } \
+}
+
+struct xsw_usage {
+	u_int64_t	xsu_total;
+	u_int64_t	xsu_avail;
+	u_int64_t	xsu_used;
+	u_int32_t	xsu_pagesize;
+	boolean_t	xsu_encrypted;
+};
+
+#ifdef __APPLE_API_PRIVATE
+/* Load average structure.  Use of fixpt_t assume <sys/types.h> in scope. */
+/* XXX perhaps we should protect fixpt_t, and define it here (or discard it) */
+struct loadavg {
+	fixpt_t	ldavg[3];
+	long	fscale;
+};
+extern struct loadavg averunnable;
+#define LSCALE	1000		/* scaling for "fixed point" arithmetic */
+
+#endif /* __APPLE_API_PRIVATE */
+
+
+/*
+ * CTL_HW identifiers
+ */
+#define	HW_MACHINE	 1		/* string: machine class */
+#define	HW_MODEL	 2		/* string: specific machine model */
+#define	HW_NCPU		 3		/* int: number of cpus */
+#define	HW_BYTEORDER	 4		/* int: machine byte order */
+#define	HW_PHYSMEM	 5		/* int: total memory */
+#define	HW_USERMEM	 6		/* int: non-kernel memory */
+#define	HW_PAGESIZE	 7		/* int: software page size */
+#define	HW_DISKNAMES	 8		/* strings: disk drive names */
+#define	HW_DISKSTATS	 9		/* struct: diskstats[] */
+#define	HW_EPOCH  	10		/* int: 0 for Legacy, else NewWorld */
+#define HW_FLOATINGPT	11		/* int: has HW floating point? */
+#define HW_MACHINE_ARCH	12		/* string: machine architecture */
+#define HW_VECTORUNIT	13		/* int: has HW vector unit? */
+#define HW_BUS_FREQ	14		/* int: Bus Frequency */
+#define HW_CPU_FREQ	15		/* int: CPU Frequency */
+#define HW_CACHELINE	16		/* int: Cache Line Size in Bytes */
+#define HW_L1ICACHESIZE	17		/* int: L1 I Cache Size in Bytes */
+#define HW_L1DCACHESIZE	18		/* int: L1 D Cache Size in Bytes */
+#define HW_L2SETTINGS	19		/* int: L2 Cache Settings */
+#define HW_L2CACHESIZE	20		/* int: L2 Cache Size in Bytes */
+#define HW_L3SETTINGS	21		/* int: L3 Cache Settings */
+#define HW_L3CACHESIZE	22		/* int: L3 Cache Size in Bytes */
+#define HW_TB_FREQ	23		/* int: Bus Frequency */
+#define HW_MEMSIZE	24		/* uint64_t: physical ram size */
+#define HW_AVAILCPU	25		/* int: number of available CPUs */
+#define	HW_MAXID	26		/* number of valid hw ids */
+
+#define CTL_HW_NAMES { \
+	{ 0, 0 }, \
+	{ "machine", CTLTYPE_STRING }, \
+	{ "model", CTLTYPE_STRING }, \
+	{ "ncpu", CTLTYPE_INT }, \
+	{ "byteorder", CTLTYPE_INT }, \
+	{ "physmem", CTLTYPE_INT }, \
+	{ "usermem", CTLTYPE_INT }, \
+	{ "pagesize", CTLTYPE_INT }, \
+	{ "disknames", CTLTYPE_STRUCT }, \
+	{ "diskstats", CTLTYPE_STRUCT }, \
+	{ "epoch", CTLTYPE_INT }, \
+	{ "floatingpoint", CTLTYPE_INT }, \
+	{ "machinearch", CTLTYPE_STRING }, \
+	{ "vectorunit", CTLTYPE_INT }, \
+	{ "busfrequency", CTLTYPE_INT }, \
+	{ "cpufrequency", CTLTYPE_INT }, \
+	{ "cachelinesize", CTLTYPE_INT }, \
+	{ "l1icachesize", CTLTYPE_INT }, \
+	{ "l1dcachesize", CTLTYPE_INT }, \
+	{ "l2settings", CTLTYPE_INT }, \
+	{ "l2cachesize", CTLTYPE_INT }, \
+	{ "l3settings", CTLTYPE_INT }, \
+	{ "l3cachesize", CTLTYPE_INT }, \
+	{ "tbfrequency", CTLTYPE_INT }, \
+	{ "memsize", CTLTYPE_QUAD }, \
+	{ "availcpu", CTLTYPE_INT } \
+}
+
+/*
+ * XXX This information should be moved to the man page.
+ *
+ * These are the support HW selectors for sysctlbyname.  Parameters that are byte counts or frequencies are 64 bit numbers.
+ * All other parameters are 32 bit numbers.
+ *
+ *   hw.memsize                - The number of bytes of physical memory in the system.
+ *
+ *   hw.ncpu                   - The maximum number of processors that could be available this boot.
+ *                               Use this value for sizing of static per processor arrays; i.e. processor load statistics.
+ *
+ *   hw.activecpu              - The number of processors currently available for executing threads.
+ *                               Use this number to determine the number threads to create in SMP aware applications.
+ *                               This number can change when power management modes are changed.
+ *
+ *   hw.physicalcpu            - The number of physical processors available in the current power management mode.
+ *   hw.physicalcpu_max        - The maximum number of physical processors that could be available this boot
+ *
+ *   hw.logicalcpu             - The number of logical processors available in the current power management mode.
+ *   hw.logicalcpu_max         - The maximum number of logical processors that could be available this boot
+ *
+ *   hw.tbfrequency            - This gives the time base frequency used by the OS and is the basis of all timing services.
+ *                               In general is is better to use mach's or higher level timing services, but this value
+ *                               is needed to convert the PPC Time Base registers to real time.
+ *
+ *   hw.cpufrequency           - These values provide the current, min and max cpu frequency.  The min and max are for
+ *   hw.cpufrequency_max       - all power management modes.  The current frequency is the max frequency in the current mode.
+ *   hw.cpufrequency_min       - All frequencies are in Hz.
+ *
+ *   hw.busfrequency           - These values provide the current, min and max bus frequency.  The min and max are for
+ *   hw.busfrequency_max       - all power management modes.  The current frequency is the max frequency in the current mode.
+ *   hw.busfrequency_min       - All frequencies are in Hz.
+ *
+ *   hw.cputype                - These values provide the mach-o cpu type and subtype.  A complete list is in <mach/machine.h>
+ *   hw.cpusubtype             - These values should be used to determine what processor family the running cpu is from so that
+ *                               the best binary can be chosen, or the best dynamic code generated.  They should not be used
+ *                               to determine if a given processor feature is available.
+ *   hw.cputhreadtype          - This value will be present if the processor supports threads.  Like hw.cpusubtype this selector
+ *                               should not be used to infer features, and only used to name the processors thread architecture.
+ *                               The values are defined in <mach/machine.h>
+ *
+ *   hw.byteorder              - Gives the byte order of the processor.  4321 for big endian, 1234 for little.
+ *
+ *   hw.pagesize               - Gives the size in bytes of the pages used by the processor and VM system.
+ *
+ *   hw.cachelinesize          - Gives the size in bytes of the processor's cache lines.
+ *                               This value should be use to control the strides of loops that use cache control instructions
+ *                               like dcbz, dcbt or dcbst.
+ *
+ *   hw.l1dcachesize           - These values provide the size in bytes of the L1, L2 and L3 caches.  If a cache is not present
+ *   hw.l1icachesize           - then the selector will return and error.
+ *   hw.l2cachesize            -
+ *   hw.l3cachesize            -
+ *
+ *   hw.packages               - Gives the number of processor packages.
+ *
+ * These are the selectors for optional processor features for specific processors.  Selectors that return errors are not support 
+ * on the system.  Supported features will return 1 if they are recommended or 0 if they are supported but are not expected to help .
+ * performance.  Future versions of these selectors may return larger values as necessary so it is best to test for non zero.
+ *
+ * For PowerPC:
+ *
+ *   hw.optional.floatingpoint - Floating Point Instructions
+ *   hw.optional.altivec       - AltiVec Instructions
+ *   hw.optional.graphicsops   - Graphics Operations
+ *   hw.optional.64bitops      - 64-bit Instructions
+ *   hw.optional.fsqrt         - HW Floating Point Square Root Instruction
+ *   hw.optional.stfiwx        - Store Floating Point as Integer Word Indexed Instructions
+ *   hw.optional.dcba          - Data Cache Block Allocate Instruction
+ *   hw.optional.datastreams   - Data Streams Instructions
+ *   hw.optional.dcbtstreams   - Data Cache Block Touch Steams Instruction Form
+ *
+ * For x86 Architecture:
+ * 
+ *   hw.optional.floatingpoint     - Floating Point Instructions
+ *   hw.optional.mmx               - Original MMX vector instructions
+ *   hw.optional.sse               - Streaming SIMD Extensions
+ *   hw.optional.sse2              - Streaming SIMD Extensions 2
+ *   hw.optional.sse3              - Streaming SIMD Extensions 3
+ *   hw.optional.supplementalsse3  - Supplemental Streaming SIMD Extensions 3
+ *   hw.optional.x86_64            - 64-bit support
+ */
+
+
+/*
+ * CTL_USER definitions
+ */
+#define	USER_CS_PATH		 1	/* string: _CS_PATH */
+#define	USER_BC_BASE_MAX	 2	/* int: BC_BASE_MAX */
+#define	USER_BC_DIM_MAX		 3	/* int: BC_DIM_MAX */
+#define	USER_BC_SCALE_MAX	 4	/* int: BC_SCALE_MAX */
+#define	USER_BC_STRING_MAX	 5	/* int: BC_STRING_MAX */
+#define	USER_COLL_WEIGHTS_MAX	 6	/* int: COLL_WEIGHTS_MAX */
+#define	USER_EXPR_NEST_MAX	 7	/* int: EXPR_NEST_MAX */
+#define	USER_LINE_MAX		 8	/* int: LINE_MAX */
+#define	USER_RE_DUP_MAX		 9	/* int: RE_DUP_MAX */
+#define	USER_POSIX2_VERSION	10	/* int: POSIX2_VERSION */
+#define	USER_POSIX2_C_BIND	11	/* int: POSIX2_C_BIND */
+#define	USER_POSIX2_C_DEV	12	/* int: POSIX2_C_DEV */
+#define	USER_POSIX2_CHAR_TERM	13	/* int: POSIX2_CHAR_TERM */
+#define	USER_POSIX2_FORT_DEV	14	/* int: POSIX2_FORT_DEV */
+#define	USER_POSIX2_FORT_RUN	15	/* int: POSIX2_FORT_RUN */
+#define	USER_POSIX2_LOCALEDEF	16	/* int: POSIX2_LOCALEDEF */
+#define	USER_POSIX2_SW_DEV	17	/* int: POSIX2_SW_DEV */
+#define	USER_POSIX2_UPE		18	/* int: POSIX2_UPE */
+#define	USER_STREAM_MAX		19	/* int: POSIX2_STREAM_MAX */
+#define	USER_TZNAME_MAX		20	/* int: POSIX2_TZNAME_MAX */
+#define	USER_MAXID		21	/* number of valid user ids */
+
+#define	CTL_USER_NAMES { \
+	{ 0, 0 }, \
+	{ "cs_path", CTLTYPE_STRING }, \
+	{ "bc_base_max", CTLTYPE_INT }, \
+	{ "bc_dim_max", CTLTYPE_INT }, \
+	{ "bc_scale_max", CTLTYPE_INT }, \
+	{ "bc_string_max", CTLTYPE_INT }, \
+	{ "coll_weights_max", CTLTYPE_INT }, \
+	{ "expr_nest_max", CTLTYPE_INT }, \
+	{ "line_max", CTLTYPE_INT }, \
+	{ "re_dup_max", CTLTYPE_INT }, \
+	{ "posix2_version", CTLTYPE_INT }, \
+	{ "posix2_c_bind", CTLTYPE_INT }, \
+	{ "posix2_c_dev", CTLTYPE_INT }, \
+	{ "posix2_char_term", CTLTYPE_INT }, \
+	{ "posix2_fort_dev", CTLTYPE_INT }, \
+	{ "posix2_fort_run", CTLTYPE_INT }, \
+	{ "posix2_localedef", CTLTYPE_INT }, \
+	{ "posix2_sw_dev", CTLTYPE_INT }, \
+	{ "posix2_upe", CTLTYPE_INT }, \
+	{ "stream_max", CTLTYPE_INT }, \
+	{ "tzname_max", CTLTYPE_INT } \
+}
+
+
+
+/*
+ * CTL_DEBUG definitions
+ *
+ * Second level identifier specifies which debug variable.
+ * Third level identifier specifies which stucture component.
+ */
+#define	CTL_DEBUG_NAME		0	/* string: variable name */
+#define	CTL_DEBUG_VALUE		1	/* int: variable value */
+#define	CTL_DEBUG_MAXID		20
+
+
+#if (CTL_MAXID != 9) || (KERN_MAXID != 72) || (VM_MAXID != 6) || (HW_MAXID != 26) || (USER_MAXID != 21) || (CTL_DEBUG_MAXID != 20)
+#error Use the SYSCTL_*() macros and OID_AUTO instead!
+#endif
+
+
+
+__BEGIN_DECLS
+int	sysctl(int *, u_int, void *, size_t *, void *, size_t);
+int	sysctlbyname(const char *, void *, size_t *, void *, size_t);
+int	sysctlnametomib(const char *, int *, size_t *);
+__END_DECLS
+
+
+
+#endif /* SYSCTL_DEF_ENABLED */
+
+
+#endif	/* !_SYS_SYSCTL_H_ */
diff -Nur cctools-877.5/include/sys/syslimits.h cctools-877.5-AnV/include/sys/syslimits.h
--- cctools-877.5/include/sys/syslimits.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/syslimits.h	2015-11-19 09:22:12 +0000
@@ -0,0 +1,117 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*	$NetBSD: syslimits.h,v 1.15 1997/06/25 00:48:09 lukem Exp $	*/
+
+/*
+ * Copyright (c) 1988, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)syslimits.h	8.1 (Berkeley) 6/2/93
+ */
+
+#ifndef _SYS_SYSLIMITS_H_
+#define _SYS_SYSLIMITS_H_
+
+#include <sys/cdefs.h>
+
+#if !defined(_ANSI_SOURCE)
+/*
+ * Note: CHILD_MAX *must* be less than hard_maxproc, which is set at
+ * compile time; you *cannot* set it higher than the hard limit!!
+ */
+#define	ARG_MAX		   (256 * 1024)	/* max bytes for an exec function */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	CHILD_MAX		   266	/* max simultaneous processes */
+#define	GID_MAX		   2147483647U	/* max value for a gid_t (2^31-2) */
+#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+#define	LINK_MAX		32767	/* max file link count */
+#define	MAX_CANON		 1024	/* max bytes in term canon input line */
+#define	MAX_INPUT		 1024	/* max bytes in terminal input */
+#define	NAME_MAX		  255	/* max bytes in a file name */
+#define	NGROUPS_MAX		   16	/* max supplemental group id's */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	UID_MAX		   2147483647U	/* max value for a uid_t (2^31-2) */
+
+#define	OPEN_MAX		10240	/* max open files per process - todo, make a config option? */
+
+#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+#define	PATH_MAX		 1024	/* max bytes in pathname */
+#define	PIPE_BUF		  512	/* max bytes for atomic pipe writes */
+
+#define	BC_BASE_MAX		   99	/* max ibase/obase values in bc(1) */
+#define	BC_DIM_MAX		 2048	/* max array elements in bc(1) */
+#define	BC_SCALE_MAX		   99	/* max scale value in bc(1) */
+#define	BC_STRING_MAX		 1000	/* max const string length in bc(1) */
+#define	CHARCLASS_NAME_MAX	   14	/* max character class name size */
+#define	COLL_WEIGHTS_MAX	    2	/* max weights for order keyword */
+#define	EQUIV_CLASS_MAX		    2
+#define	EXPR_NEST_MAX		   32	/* max expressions nested in expr(1) */
+#define	LINE_MAX		 2048	/* max bytes in an input line */
+#define	RE_DUP_MAX		  255	/* max RE's in interval notation */
+
+#if __DARWIN_UNIX03
+#define	NZERO			   20	/* default priority [XSI] */
+					/* = ((PRIO_MAX - PRIO_MIN) / 2) + 1 */
+					/* range: 0 - 39 [(2 * NZERO) - 1] */
+					/* 0 is not actually used */
+#else /* !__DARWIN_UNIX03 */
+#define	NZERO			    0	/* default priority */
+					/* range: -20 - 20 */
+					/* (PRIO_MIN - PRIO_MAX) */
+#endif /* __DARWIN_UNIX03 */
+#endif /* !_ANSI_SOURCE */
+
+#endif /* !_SYS_SYSLIMITS_H_ */
diff -Nur cctools-877.5/include/sys/syslog.h cctools-877.5-AnV/include/sys/syslog.h
--- cctools-877.5/include/sys/syslog.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/syslog.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,232 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1988, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)syslog.h	8.1 (Berkeley) 6/2/93
+ * $FreeBSD: src/sys/sys/syslog.h,v 1.27.2.1.4.1 2010/06/14 02:09:06 kensmith Exp $
+ */
+
+#ifndef _SYS_SYSLOG_H_
+#define _SYS_SYSLOG_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+#define	_PATH_LOG	"/var/run/syslog"
+
+/*
+ * priorities/facilities are encoded into a single 32-bit quantity, where the
+ * bottom 3 bits are the priority (0-7) and the top 28 bits are the facility
+ * (0-big number).  Both the priorities and the facilities map roughly
+ * one-to-one to strings in the syslogd(8) source code.  This mapping is
+ * included in this file.
+ *
+ * priorities (these are ordered)
+ */
+#define	LOG_EMERG	0	/* system is unusable */
+#define	LOG_ALERT	1	/* action must be taken immediately */
+#define	LOG_CRIT	2	/* critical conditions */
+#define	LOG_ERR		3	/* error conditions */
+#define	LOG_WARNING	4	/* warning conditions */
+#define	LOG_NOTICE	5	/* normal but significant condition */
+#define	LOG_INFO	6	/* informational */
+#define	LOG_DEBUG	7	/* debug-level messages */
+
+#define	LOG_PRIMASK	0x07	/* mask to extract priority part (internal) */
+/* extract priority */
+#define	LOG_PRI(p)	((p) & LOG_PRIMASK)
+#define	LOG_MAKEPRI(fac, pri)	((fac) | (pri))
+
+#ifdef SYSLOG_NAMES
+#define	INTERNAL_NOPRI	0x10	/* the "no priority" priority */
+/* mark "facility" */
+#define	INTERNAL_MARK	LOG_MAKEPRI((LOG_NFACILITIES<<3), 0)
+typedef struct _code {
+	const char	*c_name;
+	int		c_val;
+} CODE;
+
+CODE prioritynames[] = {
+	{ "alert",	LOG_ALERT,	},
+	{ "crit",	LOG_CRIT,	},
+	{ "debug",	LOG_DEBUG,	},
+	{ "emerg",	LOG_EMERG,	},
+	{ "err",	LOG_ERR,	},
+	{ "error",	LOG_ERR,	},	/* DEPRECATED */
+	{ "info",	LOG_INFO,	},
+	{ "none",	INTERNAL_NOPRI,	},	/* INTERNAL */
+	{ "notice",	LOG_NOTICE,	},
+	{ "panic", 	LOG_EMERG,	},	/* DEPRECATED */
+	{ "warn",	LOG_WARNING,	},	/* DEPRECATED */
+	{ "warning",	LOG_WARNING,	},
+	{ NULL,		-1,		}
+};
+#endif
+
+/* facility codes */
+#define	LOG_KERN	(0<<3)	/* kernel messages */
+#define	LOG_USER	(1<<3)	/* random user-level messages */
+#define	LOG_MAIL	(2<<3)	/* mail system */
+#define	LOG_DAEMON	(3<<3)	/* system daemons */
+#define	LOG_AUTH	(4<<3)	/* authorization messages */
+#define	LOG_SYSLOG	(5<<3)	/* messages generated internally by syslogd */
+#define	LOG_LPR		(6<<3)	/* line printer subsystem */
+#define	LOG_NEWS	(7<<3)	/* network news subsystem */
+#define	LOG_UUCP	(8<<3)	/* UUCP subsystem */
+#define	LOG_CRON	(9<<3)	/* clock daemon */
+#define	LOG_AUTHPRIV	(10<<3)	/* authorization messages (private) */
+/* Facility #10 clashes in DEC UNIX, where */
+/* it's defined as LOG_MEGASAFE for AdvFS  */
+/* event logging.                          */
+#define	LOG_FTP		(11<<3)	/* ftp daemon */
+//#define	LOG_NTP		(12<<3)	/* NTP subsystem */
+//#define	LOG_SECURITY	(13<<3) /* security subsystems (firewalling, etc.) */
+//#define	LOG_CONSOLE	(14<<3) /* /dev/console output */
+#define	LOG_NETINFO	(12<<3)	/* NetInfo */
+#define	LOG_REMOTEAUTH	(13<<3)	/* remote authentication/authorization */
+#define	LOG_INSTALL	(14<<3)	/* installer subsystem */
+#define	LOG_RAS		(15<<3)	/* Remote Access Service (VPN / PPP) */
+
+/* other codes through 15 reserved for system use */
+#define	LOG_LOCAL0	(16<<3)	/* reserved for local use */
+#define	LOG_LOCAL1	(17<<3)	/* reserved for local use */
+#define	LOG_LOCAL2	(18<<3)	/* reserved for local use */
+#define	LOG_LOCAL3	(19<<3)	/* reserved for local use */
+#define	LOG_LOCAL4	(20<<3)	/* reserved for local use */
+#define	LOG_LOCAL5	(21<<3)	/* reserved for local use */
+#define	LOG_LOCAL6	(22<<3)	/* reserved for local use */
+#define	LOG_LOCAL7	(23<<3)	/* reserved for local use */
+
+#define	LOG_LAUNCHD	(24<<3)	/* launchd - general bootstrap daemon */
+
+#define	LOG_NFACILITIES	25	/* current number of facilities */
+#define	LOG_FACMASK	0x03f8	/* mask to extract facility part */
+/* facility of pri */
+#define	LOG_FAC(p)	(((p) & LOG_FACMASK) >> 3)
+
+#ifdef SYSLOG_NAMES
+CODE facilitynames[] = {
+	{ "auth",	LOG_AUTH,	},
+	{ "authpriv",	LOG_AUTHPRIV,	},
+	{ "cron", 	LOG_CRON,	},
+	{ "daemon",	LOG_DAEMON,	},
+	{ "ftp",	LOG_FTP,	},
+	{ "install",	LOG_INSTALL	},
+	{ "kern",	LOG_KERN,	},
+	{ "lpr",	LOG_LPR,	},
+	{ "mail",	LOG_MAIL,	},
+	{ "mark", 	INTERNAL_MARK,	},	/* INTERNAL */
+	{ "netinfo",	LOG_NETINFO,	},
+	{ "ras", 	LOG_RAS		},
+	{ "remoteauth", LOG_REMOTEAUTH	},
+	{ "news",	LOG_NEWS,	},
+	{ "security",	LOG_AUTH	},	/* DEPRECATED */
+	{ "syslog",	LOG_SYSLOG,	},
+	{ "user",	LOG_USER,	},
+	{ "uucp",	LOG_UUCP,	},
+	{ "local0",	LOG_LOCAL0,	},
+	{ "local1",	LOG_LOCAL1,	},
+	{ "local2",	LOG_LOCAL2,	},
+	{ "local3",	LOG_LOCAL3,	},
+	{ "local4",	LOG_LOCAL4,	},
+	{ "local5",	LOG_LOCAL5,	},
+	{ "local6",	LOG_LOCAL6,	},
+	{ "local7",	LOG_LOCAL7,	},
+	{ "launchd", 	LOG_LAUNCHD	},
+	{ NULL,		-1,		}
+};
+#endif
+
+
+/*
+ * arguments to setlogmask.
+ */
+#define	LOG_MASK(pri)	(1 << (pri))		/* mask for one priority */
+#define	LOG_UPTO(pri)	((1 << ((pri)+1)) - 1)	/* all priorities through pri */
+
+/*
+ * Option flags for openlog.
+ *
+ * LOG_ODELAY no longer does anything.
+ * LOG_NDELAY is the inverse of what it used to be.
+ */
+#define	LOG_PID		0x01	/* log the pid with each message */
+#define	LOG_CONS	0x02	/* log on the console if errors in sending */
+#define	LOG_ODELAY	0x04	/* delay open until first syslog() (default) */
+#define	LOG_NDELAY	0x08	/* don't delay open */
+#define	LOG_NOWAIT	0x10	/* don't wait for console forks: DEPRECATED */
+#define	LOG_PERROR	0x20	/* log to stderr as well */
+
+
+/*
+ * Don't use va_list in the vsyslog() prototype.   Va_list is typedef'd in two
+ * places (<machine/varargs.h> and <machine/stdarg.h>), so if we include one
+ * of them here we may collide with the utility's includes.  It's unreasonable
+ * for utilities to have to include one of them to include syslog.h, so we get
+ * __va_list from <sys/_types.h> and use it.
+ */
+#include <sys/_types.h>
+
+__BEGIN_DECLS
+void	closelog(void);
+void	openlog(const char *, int, int);
+int	setlogmask(int);
+void	syslog(int, const char *, ...) __printflike(2, 3);
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+void	vsyslog(int, const char *, __darwin_va_list) __printflike(2, 0);
+#endif
+__END_DECLS
+
+#endif /* !_SYS_SYSLOG_H_ */
diff -Nur cctools-877.5/include/sys/termios.h cctools-877.5-AnV/include/sys/termios.h
--- cctools-877.5/include/sys/termios.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/termios.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,366 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1997 Apple Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1988, 1989, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *      This product includes software developed by the University of
+ *      California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)termios.h	8.3 (Berkeley) 3/28/94
+ */
+
+#ifndef _SYS_TERMIOS_H_
+#define _SYS_TERMIOS_H_
+
+#include <sys/cdefs.h>
+
+/*
+ * Special Control Characters
+ *
+ * Index into c_cc[] character array.
+ *
+ *	Name	     Subscript	Enabled by
+ */
+#define	VEOF		0	/* ICANON */
+#define	VEOL		1	/* ICANON */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	VEOL2		2	/* ICANON together with IEXTEN */
+#endif
+#define	VERASE		3	/* ICANON */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define VWERASE 	4	/* ICANON together with IEXTEN */
+#endif
+#define VKILL		5	/* ICANON */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	VREPRINT 	6	/* ICANON together with IEXTEN */
+#endif
+/*			7	   spare 1 */
+#define VINTR		8	/* ISIG */
+#define VQUIT		9	/* ISIG */
+#define VSUSP		10	/* ISIG */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define VDSUSP		11	/* ISIG together with IEXTEN */
+#endif
+#define VSTART		12	/* IXON, IXOFF */
+#define VSTOP		13	/* IXON, IXOFF */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	VLNEXT		14	/* IEXTEN */
+#define	VDISCARD	15	/* IEXTEN */
+#endif
+#define VMIN		16	/* !ICANON */
+#define VTIME		17	/* !ICANON */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define VSTATUS		18	/* ICANON together with IEXTEN */
+/*			19	   spare 2 */
+#endif
+#define	NCCS		20
+
+#include <sys/_types/_posix_vdisable.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	CCEQ(val, c)	((c) == (val) ? (val) != _POSIX_VDISABLE : 0)
+#endif
+
+/*
+ * Input flags - software input processing
+ */
+#define	IGNBRK		0x00000001	/* ignore BREAK condition */
+#define	BRKINT		0x00000002	/* map BREAK to SIGINTR */
+#define	IGNPAR		0x00000004	/* ignore (discard) parity errors */
+#define	PARMRK		0x00000008	/* mark parity and framing errors */
+#define	INPCK		0x00000010	/* enable checking of parity errors */
+#define	ISTRIP		0x00000020	/* strip 8th bit off chars */
+#define	INLCR		0x00000040	/* map NL into CR */
+#define	IGNCR		0x00000080	/* ignore CR */
+#define	ICRNL		0x00000100	/* map CR to NL (ala CRMOD) */
+#define	IXON		0x00000200	/* enable output flow control */
+#define	IXOFF		0x00000400	/* enable input flow control */
+#define	IXANY		0x00000800	/* any char will restart after stop */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define IMAXBEL		0x00002000	/* ring bell on input queue full */
+#define	IUTF8		0x00004000	/* maintain state for UTF-8 VERASE */
+#endif  /*(_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+
+/*
+ * Output flags - software output processing
+ */
+#define	OPOST		0x00000001	/* enable following output processing */
+#define ONLCR		0x00000002	/* map NL to CR-NL (ala CRMOD) */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define OXTABS		0x00000004	/* expand tabs to spaces */
+#define ONOEOT		0x00000008	/* discard EOT's (^D) on output) */
+#endif  /*(_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+/*
+ * The following block of features is unimplemented.  Use of these flags in
+ * programs will currently result in unexpected behaviour.
+ *
+ * - Begin unimplemented features
+ */
+#define	OCRNL		0x00000010	/* map CR to NL on output */
+#define	ONOCR		0x00000020	/* no CR output at column 0 */
+#define	ONLRET		0x00000040	/* NL performs CR function */
+#define	OFILL		0x00000080	/* use fill characters for delay */
+#define	NLDLY		0x00000300	/* \n delay */
+#define	TABDLY		0x00000c04	/* horizontal tab delay */
+#define	CRDLY		0x00003000	/* \r delay */
+#define	FFDLY		0x00004000	/* form feed delay */
+#define	BSDLY		0x00008000	/* \b delay */
+#define	VTDLY		0x00010000	/* vertical tab delay */
+#define	OFDEL		0x00020000	/* fill is DEL, else NUL */
+#if !defined(_SYS_IOCTL_COMPAT_H_) || __DARWIN_UNIX03
+/*
+ * These manifest constants have the same names as those in the header
+ * <sys/ioctl_compat.h>, so you are not permitted to have both definitions
+ * in scope simultaneously in the same compilation unit.  Nevertheless,
+ * they are required to be in scope when _POSIX_C_SOURCE is requested;
+ * this means that including the <sys/ioctl_compat.h> header before this
+ * one when _POSIX_C_SOURCE is in scope will result in redefintions.  We
+ * attempt to maintain these as the same values so as to avoid this being
+ * an outright error in most compilers.
+ */
+#define		NL0	0x00000000
+#define		NL1	0x00000100
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define		NL2	0x00000200
+#define		NL3	0x00000300
+#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+#define		TAB0	0x00000000
+#define		TAB1	0x00000400
+#define		TAB2	0x00000800
+/* not in sys/ioctl_compat.h, use OXTABS value */
+#define		TAB3	0x00000004
+#define		CR0	0x00000000
+#define		CR1	0x00001000
+#define		CR2	0x00002000
+#define		CR3	0x00003000
+#define		FF0	0x00000000
+#define		FF1	0x00004000
+#define		BS0	0x00000000
+#define		BS1	0x00008000
+#define		VT0	0x00000000
+#define		VT1	0x00010000
+#endif	/* !_SYS_IOCTL_COMPAT_H_ */
+/*
+ * + End unimplemented features
+ */
+
+/*
+ * Control flags - hardware control of terminal
+ */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	CIGNORE		0x00000001	/* ignore control flags */
+#endif
+#define CSIZE		0x00000300	/* character size mask */
+#define     CS5		    0x00000000	    /* 5 bits (pseudo) */
+#define     CS6		    0x00000100	    /* 6 bits */
+#define     CS7		    0x00000200	    /* 7 bits */
+#define     CS8		    0x00000300	    /* 8 bits */
+#define CSTOPB		0x00000400	/* send 2 stop bits */
+#define CREAD		0x00000800	/* enable receiver */
+#define PARENB		0x00001000	/* parity enable */
+#define PARODD		0x00002000	/* odd parity, else even */
+#define HUPCL		0x00004000	/* hang up on last close */
+#define CLOCAL		0x00008000	/* ignore modem status lines */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define CCTS_OFLOW	0x00010000	/* CTS flow control of output */
+#define CRTSCTS		(CCTS_OFLOW | CRTS_IFLOW)
+#define CRTS_IFLOW	0x00020000	/* RTS flow control of input */
+#define	CDTR_IFLOW	0x00040000	/* DTR flow control of input */
+#define CDSR_OFLOW	0x00080000	/* DSR flow control of output */
+#define	CCAR_OFLOW	0x00100000	/* DCD flow control of output */
+#define	MDMBUF		0x00100000	/* old name for CCAR_OFLOW */
+#endif
+
+
+/*
+ * "Local" flags - dumping ground for other state
+ *
+ * Warning: some flags in this structure begin with
+ * the letter "I" and look like they belong in the
+ * input flag.
+ */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	ECHOKE		0x00000001	/* visual erase for line kill */
+#endif  /*(_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+#define	ECHOE		0x00000002	/* visually erase chars */
+#define	ECHOK		0x00000004	/* echo NL after line kill */
+#define ECHO		0x00000008	/* enable echoing */
+#define	ECHONL		0x00000010	/* echo NL even if ECHO is off */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	ECHOPRT		0x00000020	/* visual erase mode for hardcopy */
+#define ECHOCTL  	0x00000040	/* echo control chars as ^(Char) */
+#endif  /*(_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+#define	ISIG		0x00000080	/* enable signals INTR, QUIT, [D]SUSP */
+#define	ICANON		0x00000100	/* canonicalize input lines */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define ALTWERASE	0x00000200	/* use alternate WERASE algorithm */
+#endif  /*(_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+#define	IEXTEN		0x00000400	/* enable DISCARD and LNEXT */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define EXTPROC         0x00000800      /* external processing */
+#endif  /*(_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+#define TOSTOP		0x00400000	/* stop background jobs from output */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define FLUSHO		0x00800000	/* output being flushed (state) */
+#define	NOKERNINFO	0x02000000	/* no kernel output from VSTATUS */
+#define PENDIN		0x20000000	/* XXX retype pending input (state) */
+#endif  /*(_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+#define	NOFLSH		0x80000000	/* don't flush after interrupt */
+
+typedef unsigned long	tcflag_t;
+typedef unsigned char	cc_t;
+typedef unsigned long	speed_t;
+
+struct termios {
+	tcflag_t	c_iflag;	/* input flags */
+	tcflag_t	c_oflag;	/* output flags */
+	tcflag_t	c_cflag;	/* control flags */
+	tcflag_t	c_lflag;	/* local flags */
+	cc_t		c_cc[NCCS];	/* control chars */
+	speed_t		c_ispeed;	/* input speed */
+	speed_t		c_ospeed;	/* output speed */
+};
+
+
+/*
+ * Commands passed to tcsetattr() for setting the termios structure.
+ */
+#define	TCSANOW		0		/* make change immediate */
+#define	TCSADRAIN	1		/* drain output, then change */
+#define	TCSAFLUSH	2		/* drain output, flush input */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define TCSASOFT	0x10		/* flag - don't alter h.w. state */
+#endif
+
+/*
+ * Standard speeds
+ */
+#define B0	0
+#define B50	50
+#define B75	75
+#define B110	110
+#define B134	134
+#define B150	150
+#define B200	200
+#define B300	300
+#define B600	600
+#define B1200	1200
+#define	B1800	1800
+#define B2400	2400
+#define B4800	4800
+#define B9600	9600
+#define B19200	19200
+#define B38400	38400
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define B7200	7200
+#define B14400	14400
+#define B28800	28800
+#define B57600	57600
+#define B76800	76800
+#define B115200	115200
+#define B230400	230400
+#define EXTA	19200
+#define EXTB	38400
+#endif  /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+
+#define	TCIFLUSH	1
+#define	TCOFLUSH	2
+#define TCIOFLUSH	3
+#define	TCOOFF		1
+#define	TCOON		2
+#define TCIOFF		3
+#define TCION		4
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+speed_t	cfgetispeed(const struct termios *);
+speed_t	cfgetospeed(const struct termios *);
+int	cfsetispeed(struct termios *, speed_t);
+int	cfsetospeed(struct termios *, speed_t);
+int	tcgetattr(int, struct termios *);
+int	tcsetattr(int, int, const struct termios *);
+int	tcdrain(int) __DARWIN_ALIAS_C(tcdrain);
+int	tcflow(int, int);
+int	tcflush(int, int);
+int	tcsendbreak(int, int);
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+void	cfmakeraw(struct termios *);
+int	cfsetspeed(struct termios *, speed_t);
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+__END_DECLS
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+
+/*
+ * Include tty ioctl's that aren't just for backwards compatibility
+ * with the old tty driver.  These ioctl definitions were previously
+ * in <sys/ioctl.h>.
+ */
+#include <sys/ttycom.h>
+#endif
+
+/*
+ * END OF PROTECTED INCLUDE.
+ */
+#endif /* !_SYS_TERMIOS_H_ */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#include <sys/ttydefaults.h>
+#endif
diff -Nur cctools-877.5/include/sys/time.h cctools-877.5-AnV/include/sys/time.h
--- cctools-877.5/include/sys/time.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/time.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,202 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)time.h	8.2 (Berkeley) 7/10/94
+ */
+
+#ifndef _SYS_TIME_H_
+#define _SYS_TIME_H_
+
+#include <sys/cdefs.h>
+#include <sys/_types.h>
+#include <Availability.h>
+
+/*
+ * [XSI] The fd_set type shall be defined as described in <sys/select.h>.
+ * The timespec structure shall be defined as described in <time.h>
+ */
+#include <sys/_types/_fd_def.h>
+#include <sys/_types/_timespec.h>
+#include <sys/_types/_timeval.h>
+
+#include <sys/_types/_time_t.h>
+#include <sys/_types/_suseconds_t.h>
+
+/*
+ * Structure used as a parameter by getitimer(2) and setitimer(2) system
+ * calls.
+ */
+struct	itimerval {
+	struct	timeval it_interval;	/* timer interval */
+	struct	timeval it_value;	/* current value */
+};
+
+/*
+ * Names of the interval timers, and structure
+ * defining a timer setting.
+ */
+#define	ITIMER_REAL	0
+#define	ITIMER_VIRTUAL	1
+#define	ITIMER_PROF	2
+
+/*
+ * Select uses bit masks of file descriptors in longs.  These macros
+ * manipulate such bit fields (the filesystem macros use chars).  The
+ * extra protection here is to permit application redefinition above
+ * the default size.
+ */
+#include <sys/_types/_fd_setsize.h>
+#include <sys/_types/_fd_set.h>
+#include <sys/_types/_fd_clr.h>
+#include <sys/_types/_fd_isset.h>
+#include <sys/_types/_fd_zero.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+
+#include <sys/_types/_fd_copy.h>
+
+#define	TIMEVAL_TO_TIMESPEC(tv, ts) {					\
+	(ts)->tv_sec = (tv)->tv_sec;					\
+	(ts)->tv_nsec = (tv)->tv_usec * 1000;				\
+}
+#define	TIMESPEC_TO_TIMEVAL(tv, ts) {					\
+	(tv)->tv_sec = (ts)->tv_sec;					\
+	(tv)->tv_usec = (ts)->tv_nsec / 1000;				\
+}
+
+struct timezone {
+	int	tz_minuteswest;	/* minutes west of Greenwich */
+	int	tz_dsttime;	/* type of dst correction */
+};
+#define	DST_NONE	0	/* not on dst */
+#define	DST_USA		1	/* USA style dst */
+#define	DST_AUST	2	/* Australian style dst */
+#define	DST_WET		3	/* Western European dst */
+#define	DST_MET		4	/* Middle European dst */
+#define	DST_EET		5	/* Eastern European dst */
+#define	DST_CAN		6	/* Canada */
+
+/* Operations on timevals. */
+#define	timerclear(tvp)		(tvp)->tv_sec = (tvp)->tv_usec = 0
+#define	timerisset(tvp)		((tvp)->tv_sec || (tvp)->tv_usec)
+#define	timercmp(tvp, uvp, cmp)						\
+	(((tvp)->tv_sec == (uvp)->tv_sec) ?				\
+	    ((tvp)->tv_usec cmp (uvp)->tv_usec) :			\
+	    ((tvp)->tv_sec cmp (uvp)->tv_sec))
+#define	timeradd(tvp, uvp, vvp)						\
+	do {								\
+		(vvp)->tv_sec = (tvp)->tv_sec + (uvp)->tv_sec;		\
+		(vvp)->tv_usec = (tvp)->tv_usec + (uvp)->tv_usec;	\
+		if ((vvp)->tv_usec >= 1000000) {			\
+			(vvp)->tv_sec++;				\
+			(vvp)->tv_usec -= 1000000;			\
+		}							\
+	} while (0)
+#define	timersub(tvp, uvp, vvp)						\
+	do {								\
+		(vvp)->tv_sec = (tvp)->tv_sec - (uvp)->tv_sec;		\
+		(vvp)->tv_usec = (tvp)->tv_usec - (uvp)->tv_usec;	\
+		if ((vvp)->tv_usec < 0) {				\
+			(vvp)->tv_sec--;				\
+			(vvp)->tv_usec += 1000000;			\
+		}							\
+	} while (0)
+
+#define timevalcmp(l, r, cmp)   timercmp(l, r, cmp) /* freebsd */
+
+/*
+ * Getkerninfo clock information structure
+ */
+struct clockinfo {
+	int	hz;		/* clock frequency */
+	int	tick;		/* micro-seconds per hz tick */
+	int	tickadj;	/* clock skew rate for adjtime() */
+	int	stathz;		/* statistics clock frequency */
+	int	profhz;		/* profiling clock frequency */
+};
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#include <time.h>
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+__BEGIN_DECLS
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+int	adjtime(const struct timeval *, struct timeval *);
+int	futimes(int, const struct timeval *);
+int	lutimes(const char *, const struct timeval *) __OSX_AVAILABLE_STARTING(__MAC_10_5, __IPHONE_2_0);
+int	settimeofday(const struct timeval *, const struct timezone *);
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+int	getitimer(int, struct itimerval *);
+int	gettimeofday(struct timeval * __restrict, void * __restrict);
+
+#include <sys/_select.h>	/* select() prototype */
+
+int	setitimer(int, const struct itimerval * __restrict,
+		struct itimerval * __restrict);
+int	utimes(const char *, const struct timeval *);
+
+__END_DECLS
+
+
+#endif /* !_SYS_TIME_H_ */
diff -Nur cctools-877.5/include/sys/timeb.h cctools-877.5-AnV/include/sys/timeb.h
--- cctools-877.5/include/sys/timeb.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/timeb.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,94 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)timeb.h	8.2 (Berkeley) 1/21/94
+ */
+
+#ifndef _SYS_TIMEB_H_
+#define _SYS_TIMEB_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/_types.h>
+
+/* [XSI] The time_t type shall be defined as described in <sys/types.h> */
+#include <sys/_types/_time_t.h>
+
+/*
+ * [XSI] Structure whose address is passed as the first parameter to ftime()
+ */
+struct timeb {
+	time_t		time;		/* [XSI] Seconds since the Epoch */
+	unsigned short	millitm;	/* [XSI] Milliseconds since the Epoch */
+	short		timezone;	/* [XSI] Minutes west of CUT */
+	short		dstflag;	/* [XSI] non-zero if DST in effect */
+};
+
+__BEGIN_DECLS
+/* [XSI] Legacy interface */
+int	ftime(struct timeb *);
+__END_DECLS
+
+#endif /* !_SYS_TIMEB_H_ */
diff -Nur cctools-877.5/include/sys/times.h cctools-877.5-AnV/include/sys/times.h
--- cctools-877.5/include/sys/times.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/times.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,92 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)times.h	8.4 (Berkeley) 1/21/94
+ */
+
+#ifndef	_SYS_TIMES_H_
+#define	_SYS_TIMES_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/_types.h>
+
+/* [XSI] The clock_t type shall be defined as described in <sys/types.h> */
+#include <sys/_types/_clock_t.h>
+
+/*
+ * [XSI] Structure whose address is passed as the first parameter to times()
+ */
+struct tms {
+	clock_t	tms_utime;	/* [XSI] User CPU time */
+	clock_t	tms_stime;	/* [XSI] System CPU time */
+	clock_t	tms_cutime;	/* [XSI] Terminated children user CPU time */
+	clock_t	tms_cstime;	/* [XSI] Terminated children System CPU time */
+};
+
+__BEGIN_DECLS
+clock_t	times(struct tms *);
+__END_DECLS
+#endif /* !_SYS_TIMES_H_ */
diff -Nur cctools-877.5/include/sys/tprintf.h cctools-877.5-AnV/include/sys/tprintf.h
--- cctools-877.5/include/sys/tprintf.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/tprintf.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,82 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)tprintf.h	8.1 (Berkeley) 6/2/93
+ */
+
+#ifndef _SYS_TPRINTF_H_
+#define	_SYS_TPRINTF_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+#ifdef __APPLE_API_UNSTABLE
+
+typedef struct session *tpr_t;
+
+__BEGIN_DECLS
+tpr_t	tprintf_open(struct proc *);
+void	tprintf_close(tpr_t);
+void	tprintf(tpr_t, const char *fmt, ...);
+__END_DECLS
+
+#endif /* __APPLE_API_UNSTABLE */
+
+#endif /* !_SYS_TPRINTF_H_ */
diff -Nur cctools-877.5/include/sys/trace.h cctools-877.5-AnV/include/sys/trace.h
--- cctools-877.5/include/sys/trace.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/trace.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,140 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)trace.h	8.1 (Berkeley) 6/2/93
+ */
+
+#ifndef _SYS_TRACE_H_
+#define	_SYS_TRACE_H_
+
+#include <sys/appleapiopts.h>
+
+#ifdef __APPLE_API_OBSOLETE
+/*
+ * File system buffer tracing points; all trace <pack(dev, size), bn>
+ */
+#define	TR_BREADHIT	0	/* buffer read found in cache */
+#define	TR_BREADMISS	1	/* buffer read not in cache */
+#define	TR_BWRITE	2	/* buffer written */
+#define	TR_BREADHITRA	3	/* buffer read-ahead found in cache */
+#define	TR_BREADMISSRA	4	/* buffer read-ahead not in cache */
+#define	TR_XFODMISS	5	/* exe fod read */
+#define	TR_XFODHIT	6	/* exe fod read */
+#define	TR_BRELSE	7	/* brelse */
+#define	TR_BREALLOC	8	/* expand/contract a buffer */
+
+/*
+ * Memory allocator trace points; all trace the amount of memory involved
+ */
+#define	TR_MALL		10	/* memory allocated */
+
+/*
+ * Paging trace points: all are <vaddr, pid>
+ */
+#define	TR_INTRANS	20	/* page intransit block */
+#define	TR_EINTRANS	21	/* page intransit wait done */
+#define	TR_FRECLAIM	22	/* reclaim from free list */
+#define	TR_RECLAIM	23	/* reclaim from loop */
+#define	TR_XSFREC	24	/* reclaim from free list instead of drum */
+#define	TR_XIFREC	25	/* reclaim from free list instead of fsys */
+#define	TR_WAITMEM	26	/* wait for memory in pagein */
+#define	TR_EWAITMEM	27	/* end memory wait in pagein */
+#define	TR_ZFOD		28	/* zfod page fault */
+#define	TR_EXFOD	29	/* exec fod page fault */
+#define	TR_VRFOD	30	/* vread fod page fault */
+#define	TR_CACHEFOD	31	/* fod in file system cache */
+#define	TR_SWAPIN	32	/* drum page fault */
+#define	TR_PGINDONE	33	/* page in done */
+#define	TR_SWAPIO	34	/* swap i/o request arrives */
+
+/*
+ * System call trace points.
+ */
+#define	TR_VADVISE	40	/* vadvise occurred with <arg, pid> */
+
+/*
+ * Miscellaneous
+ */
+#define	TR_STAMP	45	/* user said vtrace(VTR_STAMP, value); */
+
+/*
+ * This defines the size of the trace flags array.
+ */
+#define	TR_NFLAGS	100	/* generous */
+
+#define	TRCSIZ		4096
+
+/*
+ * Specifications of the vtrace() system call, which takes one argument.
+ */
+#define	VTRACE		64+51
+
+#define	VTR_DISABLE	0		/* set a trace flag to 0 */
+#define	VTR_ENABLE	1		/* set a trace flag to 1 */
+#define	VTR_VALUE	2		/* return value of a trace flag */
+#define	VTR_UALARM	3		/* set alarm to go off (sig 16) */
+					/* in specified number of hz */
+#define	VTR_STAMP	4		/* user specified stamp */
+
+
+#endif /* __APPLE_API_OBSOLETE */
+
+#endif /* !_SYS_TRACE_H_ */
+
diff -Nur cctools-877.5/include/sys/tty.h cctools-877.5-AnV/include/sys/tty.h
--- cctools-877.5/include/sys/tty.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/tty.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,153 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1997 Apple Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *      This product includes software developed by the University of
+ *      California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)tty.h	8.6 (Berkeley) 1/21/94
+ */
+
+#ifndef _SYS_TTY_H_
+#define	_SYS_TTY_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/termios.h>
+#include <sys/select.h>		/* For struct selinfo. */
+
+
+struct tty;
+struct clist;
+
+/* These flags are kept in t_state. */
+#define	TS_SO_OLOWAT	0x00001		/* Wake up when output <= low water. */
+#define	TS_ASYNC	0x00002		/* Tty in async I/O mode. */
+#define	TS_BUSY		0x00004		/* Draining output. */
+#define	TS_CARR_ON	0x00008		/* Carrier is present. */
+#define	TS_FLUSH	0x00010		/* Outq has been flushed during DMA. */
+#define	TS_ISOPEN	0x00020		/* Open has completed. */
+#define	TS_TBLOCK	0x00040		/* Further input blocked. */
+#define	TS_TIMEOUT	0x00080		/* Wait for output char processing. */
+#define	TS_TTSTOP	0x00100		/* Output paused. */
+#ifdef notyet
+#define	TS_WOPEN	0x00200		/* Open in progress. */
+#endif
+#define	TS_XCLUDE	0x00400		/* Tty requires exclusivity. */
+
+/* State for intra-line fancy editing work. */
+#define	TS_BKSL		0x00800		/* State for lowercase \ work. */
+#define	TS_CNTTB	0x01000		/* Counting tab width, ignore FLUSHO. */
+#define	TS_ERASE	0x02000		/* Within a \.../ for PRTRUB. */
+#define	TS_LNCH		0x04000		/* Next character is literal. */
+#define	TS_TYPEN	0x08000		/* Retyping suspended input (PENDIN). */
+#define	TS_LOCAL	(TS_BKSL | TS_CNTTB | TS_ERASE | TS_LNCH | TS_TYPEN)
+
+/* Extras. */
+#define	TS_CAN_BYPASS_L_RINT 0x010000	/* Device in "raw" mode. */
+#define	TS_CONNECTED	0x020000	/* Connection open. */
+#define	TS_SNOOP	0x040000	/* Device is being snooped on. */
+#define	TS_SO_OCOMPLETE	0x080000	/* Wake up when output completes. */
+#define	TS_ZOMBIE	0x100000	/* Connection lost. */
+
+/* Hardware flow-control-invoked bits. */
+#define	TS_CAR_OFLOW	0x200000	/* For MDMBUF (XXX handle in driver). */
+#ifdef notyet
+#define	TS_CTS_OFLOW	0x400000	/* For CCTS_OFLOW. */
+#define	TS_DSR_OFLOW	0x800000	/* For CDSR_OFLOW. */
+#endif
+
+#define	TS_IOCTL_NOT_OK	0x1000000	/* Workaround <rdar://....> */
+#define	TS_PGRPHUP	0x2000000       /* Don't change Foregroud process group */
+
+
+/* Character type information. */
+#define	ORDINARY	0
+#define	CONTROL		1
+#define	BACKSPACE	2
+#define	NEWLINE		3
+#define	TAB		4
+#define	VTAB		5
+#define	RETURN		6
+
+struct speedtab {
+	int sp_speed;			/* Speed. */
+	int sp_code;			/* Code. */
+};
+
+/* Modem control commands (driver). */
+#define	DMSET		0
+#define	DMBIS		1
+#define	DMBIC		2
+#define	DMGET		3
+
+/* Flags on a character passed to ttyinput. */
+#define	TTY_CHARMASK	0x000000ff	/* Character mask */
+#define	TTY_QUOTE	0x00000100	/* Character quoted */
+#define	TTY_ERRORMASK	0xff000000	/* Error mask */
+#define	TTY_FE		0x01000000	/* Framing error */
+#define	TTY_PE		0x02000000	/* Parity error */
+#define	TTY_OE		0x04000000	/* Overrun error */
+#define	TTY_BI		0x08000000	/* Break condition */
+
+
+
+#endif /* !_SYS_TTY_H_ */
diff -Nur cctools-877.5/include/sys/ttychars.h cctools-877.5-AnV/include/sys/ttychars.h
--- cctools-877.5/include/sys/ttychars.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ttychars.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,99 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1997 Apple Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *      This product includes software developed by the University of
+ *      California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)ttychars.h	8.2 (Berkeley) 1/4/94
+ */
+
+#ifndef _SYS_TTYCHARS_H_
+#define _SYS_TTYCHARS_H_
+
+#include <sys/appleapiopts.h>
+
+#ifdef __APPLE_API_UNSTABLE
+/*
+ * 4.3 COMPATIBILITY FILE
+ *
+ * User visible structures and constants related to terminal handling.
+ */
+
+struct ttychars {
+	char	tc_erase;	/* erase last character */
+	char	tc_kill;	/* erase entire line */
+	char	tc_intrc;	/* interrupt */
+	char	tc_quitc;	/* quit */
+	char	tc_startc;	/* start output */
+	char	tc_stopc;	/* stop output */
+	char	tc_eofc;	/* end-of-file */
+	char	tc_brkc;	/* input delimiter (like nl) */
+	char	tc_suspc;	/* stop process signal */
+	char	tc_dsuspc;	/* delayed stop process signal */
+	char	tc_rprntc;	/* reprint line */
+	char	tc_flushc;	/* flush output (toggles) */
+	char	tc_werasc;	/* word erase */
+	char	tc_lnextc;	/* literal next character */
+};
+#ifdef USE_OLD_TTY
+#include <sys/ttydefaults.h>	/* to pick up character defaults */
+#endif
+
+#endif /* __APPLE_API_UNSTABLE */
+
+#endif /* !_SYS_TTYCHARS_H_ */
+
diff -Nur cctools-877.5/include/sys/ttycom.h cctools-877.5-AnV/include/sys/ttycom.h
--- cctools-877.5/include/sys/ttycom.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ttycom.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,174 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1997 Apple Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1990, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *      This product includes software developed by the University of
+ *      California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)ttycom.h	8.1 (Berkeley) 3/28/94
+ */
+
+#ifndef	_SYS_TTYCOM_H_
+#define	_SYS_TTYCOM_H_
+
+#include <sys/ioccom.h>
+
+/*
+ * Tty ioctl's except for those supported only for backwards compatibility
+ * with the old tty driver.
+ */
+
+/*
+ * Window/terminal size structure.  This information is stored by the kernel
+ * in order to provide a consistent interface, but is not used by the kernel.
+ */
+struct winsize {
+	unsigned short	ws_row;		/* rows, in characters */
+	unsigned short	ws_col;		/* columns, in characters */
+	unsigned short	ws_xpixel;	/* horizontal size, pixels */
+	unsigned short	ws_ypixel;	/* vertical size, pixels */
+};
+
+#define	TIOCMODG	_IOR('t', 3, int)	/* get modem control state */
+#define	TIOCMODS	_IOW('t', 4, int)	/* set modem control state */
+#define		TIOCM_LE	0001		/* line enable */
+#define		TIOCM_DTR	0002		/* data terminal ready */
+#define		TIOCM_RTS	0004		/* request to send */
+#define		TIOCM_ST	0010		/* secondary transmit */
+#define		TIOCM_SR	0020		/* secondary receive */
+#define		TIOCM_CTS	0040		/* clear to send */
+#define		TIOCM_CAR	0100		/* carrier detect */
+#define		TIOCM_CD	TIOCM_CAR
+#define		TIOCM_RNG	0200		/* ring */
+#define		TIOCM_RI	TIOCM_RNG
+#define		TIOCM_DSR	0400		/* data set ready */
+						/* 8-10 compat */
+#define	TIOCEXCL	 _IO('t', 13)		/* set exclusive use of tty */
+#define	TIOCNXCL	 _IO('t', 14)		/* reset exclusive use of tty */
+						/* 15 unused */
+#define	TIOCFLUSH	_IOW('t', 16, int)	/* flush buffers */
+						/* 17-18 compat */
+#define	TIOCGETA	_IOR('t', 19, struct termios) /* get termios struct */
+#define	TIOCSETA	_IOW('t', 20, struct termios) /* set termios struct */
+#define	TIOCSETAW	_IOW('t', 21, struct termios) /* drain output, set */
+#define	TIOCSETAF	_IOW('t', 22, struct termios) /* drn out, fls in, set */
+#define	TIOCGETD	_IOR('t', 26, int)	/* get line discipline */
+#define	TIOCSETD	_IOW('t', 27, int)	/* set line discipline */
+#define	TIOCIXON	 _IO('t', 129)		/* internal input VSTART */
+#define	TIOCIXOFF	 _IO('t', 128)		/* internal input VSTOP */
+						/* 127-124 compat */
+#define	TIOCSBRK	 _IO('t', 123)		/* set break bit */
+#define	TIOCCBRK	 _IO('t', 122)		/* clear break bit */
+#define	TIOCSDTR	 _IO('t', 121)		/* set data terminal ready */
+#define	TIOCCDTR	 _IO('t', 120)		/* clear data terminal ready */
+#define	TIOCGPGRP	_IOR('t', 119, int)	/* get pgrp of tty */
+#define	TIOCSPGRP	_IOW('t', 118, int)	/* set pgrp of tty */
+						/* 117-116 compat */
+#define	TIOCOUTQ	_IOR('t', 115, int)	/* output queue size */
+#define	TIOCSTI		_IOW('t', 114, char)	/* simulate terminal input */
+#define	TIOCNOTTY	 _IO('t', 113)		/* void tty association */
+#define	TIOCPKT		_IOW('t', 112, int)	/* pty: set/clear packet mode */
+#define		TIOCPKT_DATA		0x00	/* data packet */
+#define		TIOCPKT_FLUSHREAD	0x01	/* flush packet */
+#define		TIOCPKT_FLUSHWRITE	0x02	/* flush packet */
+#define		TIOCPKT_STOP		0x04	/* stop output */
+#define		TIOCPKT_START		0x08	/* start output */
+#define		TIOCPKT_NOSTOP		0x10	/* no more ^S, ^Q */
+#define		TIOCPKT_DOSTOP		0x20	/* now do ^S ^Q */
+#define		TIOCPKT_IOCTL		0x40	/* state change of pty driver */
+#define	TIOCSTOP	 _IO('t', 111)		/* stop output, like ^S */
+#define	TIOCSTART	 _IO('t', 110)		/* start output, like ^Q */
+#define	TIOCMSET	_IOW('t', 109, int)	/* set all modem bits */
+#define	TIOCMBIS	_IOW('t', 108, int)	/* bis modem bits */
+#define	TIOCMBIC	_IOW('t', 107, int)	/* bic modem bits */
+#define	TIOCMGET	_IOR('t', 106, int)	/* get all modem bits */
+#define	TIOCREMOTE	_IOW('t', 105, int)	/* remote input editing */
+#define	TIOCGWINSZ	_IOR('t', 104, struct winsize)	/* get window size */
+#define	TIOCSWINSZ	_IOW('t', 103, struct winsize)	/* set window size */
+#define	TIOCUCNTL	_IOW('t', 102, int)	/* pty: set/clr usr cntl mode */
+#define	TIOCSTAT	 _IO('t', 101)		/* simulate ^T status message */
+#define		UIOCCMD(n)	_IO('u', n)	/* usr cntl op "n" */
+#define	TIOCSCONS	_IO('t', 99)		/* 4.2 compatibility */
+#define	TIOCCONS	_IOW('t', 98, int)	/* become virtual console */
+#define	TIOCSCTTY	 _IO('t', 97)		/* become controlling tty */
+#define	TIOCEXT		_IOW('t', 96, int)	/* pty: external processing */
+#define	TIOCSIG		 _IO('t', 95)		/* pty: generate signal */
+#define	TIOCDRAIN	 _IO('t', 94)		/* wait till output drained */
+#define	TIOCMSDTRWAIT	_IOW('t', 91, int)	/* modem: set wait on close */
+#define	TIOCMGDTRWAIT	_IOR('t', 90, int)	/* modem: get wait on close */
+#define	TIOCTIMESTAMP	_IOR('t', 89, struct timeval)	/* enable/get timestamp
+						 * of last input event */
+#define	TIOCDCDTIMESTAMP _IOR('t', 88, struct timeval)	/* enable/get timestamp
+						 * of last DCd rise */
+#define	TIOCSDRAINWAIT	_IOW('t', 87, int)	/* set ttywait timeout */
+#define	TIOCGDRAINWAIT	_IOR('t', 86, int)	/* get ttywait timeout */
+#define	TIOCDSIMICROCODE _IO('t', 85)		/* download microcode to
+						 * DSI Softmodem */
+#define TIOCPTYGRANT	_IO('t', 84)		/* grantpt(3) */
+#define TIOCPTYGNAME	_IOC(IOC_OUT, 't', 83, 128)	/* ptsname(3) */
+#define TIOCPTYUNLK	_IO('t', 82)		/* unlockpt(3) */
+
+#define	TTYDISC		0		/* termios tty line discipline */
+#define	TABLDISC	3		/* tablet discipline */
+#define	SLIPDISC	4		/* serial IP discipline */
+#define	PPPDISC		5		/* PPP discipline */
+
+#endif /* !_SYS_TTYCOM_H_ */
diff -Nur cctools-877.5/include/sys/ttydefaults.h cctools-877.5-AnV/include/sys/ttydefaults.h
--- cctools-877.5/include/sys/ttydefaults.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ttydefaults.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,124 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1997 Apple Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *      This product includes software developed by the University of
+ *      California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)ttydefaults.h	8.4 (Berkeley) 1/21/94
+ */
+
+/*
+ * System wide defaults for terminal state.
+ */
+#ifndef _SYS_TTYDEFAULTS_H_
+#define	_SYS_TTYDEFAULTS_H_
+
+/*
+ * Defaults on "first" open.
+ */
+#define	TTYDEF_IFLAG	(BRKINT	| ICRNL	| IMAXBEL | IXON | IXANY)
+#define TTYDEF_OFLAG	(OPOST | ONLCR)
+#define TTYDEF_LFLAG	(ECHO | ICANON | ISIG | IEXTEN | ECHOE|ECHOKE|ECHOCTL)
+#define	TTYDEF_CFLAG	(CREAD | CS8 | HUPCL)
+#define TTYDEF_SPEED	(B9600)
+
+/*
+ * Control Character Defaults
+ */
+#define CTRL(x)	(x&037)
+#define	CEOF		CTRL('d')
+#define	CEOL		0xff		/* XXX avoid _POSIX_VDISABLE */
+#define	CERASE		0177
+#define	CINTR		CTRL('c')
+#define	CSTATUS		CTRL('t')
+#define	CKILL		CTRL('u')
+#define	CMIN		1
+#define	CQUIT		034		/* FS, ^\ */
+#define	CSUSP		CTRL('z')
+#define	CTIME		0
+#define	CDSUSP		CTRL('y')
+#define	CSTART		CTRL('q')
+#define	CSTOP		CTRL('s')
+#define	CLNEXT		CTRL('v')
+#define	CDISCARD 	CTRL('o')
+#define	CWERASE 	CTRL('w')
+#define	CREPRINT 	CTRL('r')
+#define	CEOT		CEOF
+/* compat */
+#define	CBRK		CEOL
+#define CRPRNT		CREPRINT
+#define	CFLUSH		CDISCARD
+
+/* PROTECTED INCLUSION ENDS HERE */
+#endif /* !_SYS_TTYDEFAULTS_H_ */
+
+/*
+ * #define TTYDEFCHARS to include an array of default control characters.
+ */
+#ifdef TTYDEFCHARS
+static cc_t	ttydefchars[NCCS] = {
+	CEOF,	CEOL,	CEOL,	CERASE, CWERASE, CKILL, CREPRINT,
+	_POSIX_VDISABLE, CINTR,	CQUIT,	CSUSP,	CDSUSP,	CSTART,	CSTOP,	CLNEXT,
+	CDISCARD, CMIN,	CTIME,  CSTATUS, _POSIX_VDISABLE
+};
+#undef TTYDEFCHARS
+#endif
diff -Nur cctools-877.5/include/sys/ttydev.h cctools-877.5-AnV/include/sys/ttydev.h
--- cctools-877.5/include/sys/ttydev.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ttydev.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,90 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1997 Apple Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *      This product includes software developed by the University of
+ *      California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)ttydev.h	8.2 (Berkeley) 1/4/94
+ */
+
+/* COMPATIBILITY HEADER FILE */
+
+#ifndef _SYS_TTYDEV_H_
+#define	_SYS_TTYDEV_H_
+
+#ifdef USE_OLD_TTY
+#define B0	0
+#define B50	1
+#define B75	2
+#define B110	3
+#define B134	4
+#define B150	5
+#define B200	6
+#define B300	7
+#define B600	8
+#define B1200	9
+#define	B1800	10
+#define B2400	11
+#define B4800	12
+#define B9600	13
+#define EXTA	14
+#define EXTB	15
+#define B57600  16
+#define B115200 17
+#endif /* USE_OLD_TTY */
+
+#endif /* !_SYS_TTYDEV_H_ */
diff -Nur cctools-877.5/include/sys/types.h cctools-877.5-AnV/include/sys/types.h
--- cctools-877.5/include/sys/types.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/types.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,231 @@
+/*
+ * Copyright (c) 2000-2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1991, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)types.h	8.4 (Berkeley) 1/21/94
+ */
+
+#ifndef _SYS_TYPES_H_
+#define	_SYS_TYPES_H_
+
+#include <sys/appleapiopts.h>
+
+#ifndef __ASSEMBLER__
+#include <sys/cdefs.h>
+
+/* Machine type dependent parameters. */
+#include <machine/types.h>
+#include <sys/_types.h>
+
+#include <machine/endian.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+typedef	unsigned char		u_char;
+typedef	unsigned short		u_short;
+typedef	unsigned int		u_int;
+#ifndef _U_LONG
+typedef	unsigned long		u_long;
+#define _U_LONG
+#endif
+typedef	unsigned short		ushort;		/* Sys V compatibility */
+typedef	unsigned int		uint;		/* Sys V compatibility */
+#endif
+
+typedef	u_int64_t		u_quad_t;	/* quads */
+typedef	int64_t			quad_t;
+typedef	quad_t *		qaddr_t;
+
+typedef	char *			caddr_t;	/* core address */
+typedef	int32_t			daddr_t;	/* disk address */
+
+#include <sys/_types/_dev_t.h>   		/* device number */
+
+typedef	u_int32_t		fixpt_t;	/* fixed point number */
+
+#include <sys/_types/_blkcnt_t.h>
+#include <sys/_types/_blksize_t.h>
+#include <sys/_types/_gid_t.h>
+#include <sys/_types/_in_addr_t.h>
+#include <sys/_types/_in_port_t.h>
+#include <sys/_types/_ino_t.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#include <sys/_types/_ino64_t.h>			/* 64bit inode number */
+#endif /* !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE) */
+
+#include <sys/_types/_key_t.h>
+#include <sys/_types/_mode_t.h>
+#include <sys/_types/_nlink_t.h>
+#include <sys/_types/_id_t.h>
+#include <sys/_types/_pid_t.h>
+#include <sys/_types/_off_t.h>
+
+typedef	int32_t			segsz_t;	/* segment size */
+typedef	int32_t			swblk_t;	/* swap offset */
+
+#include <sys/_types/_uid_t.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/* Major, minor numbers, dev_t's. */
+#if defined(__cplusplus)
+/*
+ * These lowercase macros tend to match member functions in some C++ code,
+ * so for C++, we must use inline functions instead.
+ */
+
+static inline __int32_t  major(__uint32_t _x)
+{
+	return (__int32_t)(((__uint32_t)_x >> 24) & 0xff);
+}
+
+static inline __int32_t  minor(__uint32_t _x)
+{
+	return (__int32_t)((_x) & 0xffffff);
+}
+
+static inline dev_t  makedev(__uint32_t _major, __uint32_t _minor)
+{
+	return (dev_t)(((_major) << 24) | (_minor));
+}
+
+#else	/* !__cplusplus */
+
+#define	major(x)	((int32_t)(((u_int32_t)(x) >> 24) & 0xff))
+#define	minor(x)	((int32_t)((x) & 0xffffff))
+#define	makedev(x,y)	((dev_t)(((x) << 24) | (y)))
+
+#endif	/* !__cplusplus */
+#endif	/* !_POSIX_C_SOURCE */
+
+#include <sys/_types/_clock_t.h>
+#include <sys/_types/_size_t.h>
+#include <sys/_types/_ssize_t.h>
+#include <sys/_types/_time_t.h>
+
+#include <sys/_types/_useconds_t.h>
+#include <sys/_types/_suseconds_t.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#include <sys/_types/_rsize_t.h>
+#include <sys/_types/_errno_t.h>
+#endif
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/*
+ * This code is present here in order to maintain historical backward
+ * compatability, and is intended to be removed at some point in the
+ * future; please include <sys/select.h> instead.
+ */
+#include <sys/_types/_fd_def.h>
+
+#define	NBBY		__DARWIN_NBBY		/* bits in a byte */
+#define NFDBITS		__DARWIN_NFDBITS	/* bits per mask */
+#define	howmany(x, y)	__DARWIN_howmany(x, y)	/* # y's == x bits? */
+typedef __int32_t	fd_mask;
+
+/*
+ * Select uses bit masks of file descriptors in longs.  These macros
+ * manipulate such bit fields (the filesystem macros use chars).  The
+ * extra protection here is to permit application redefinition above
+ * the default size.
+ */
+#include <sys/_types/_fd_setsize.h>
+#include <sys/_types/_fd_set.h>
+#include <sys/_types/_fd_clr.h>
+#include <sys/_types/_fd_zero.h>
+#include <sys/_types/_fd_isset.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#include <sys/_types/_fd_copy.h>
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+
+
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+#endif /* __ASSEMBLER__ */
+
+
+#ifndef __POSIX_LIB__
+
+#include <sys/_pthread/_pthread_attr_t.h>
+#include <sys/_pthread/_pthread_cond_t.h>
+#include <sys/_pthread/_pthread_condattr_t.h>
+#include <sys/_pthread/_pthread_mutex_t.h>
+#include <sys/_pthread/_pthread_mutexattr_t.h>
+#include <sys/_pthread/_pthread_once_t.h>
+#include <sys/_pthread/_pthread_rwlock_t.h>
+#include <sys/_pthread/_pthread_rwlockattr_t.h>
+#include <sys/_pthread/_pthread_t.h>
+
+#endif /* __POSIX_LIB__ */
+
+#include <sys/_pthread/_pthread_key_t.h>
+
+
+/* statvfs and fstatvfs */
+
+#include <sys/_types/_fsblkcnt_t.h>
+#include <sys/_types/_fsfilcnt_t.h>
+
+#endif /* !_SYS_TYPES_H_ */
diff -Nur cctools-877.5/include/sys/ubc.h cctools-877.5-AnV/include/sys/ubc.h
--- cctools-877.5/include/sys/ubc.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ubc.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,114 @@
+/*
+ * Copyright (c) 1999-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ *	Header file for Unified Buffer Cache.
+ *
+ */ 
+
+#ifndef	_SYS_UBC_H_
+#define	_SYS_UBC_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/kernel_types.h>
+#include <kern/locks.h>
+#include <mach/memory_object_types.h>
+#include <sys/ucred.h>
+
+/* defns for ubc_msync() and ubc_msync */
+
+#define	UBC_PUSHDIRTY	0x01	/* clean any dirty pages in the specified range to the backing store */
+#define	UBC_PUSHALL	0x02	/* push both dirty and precious pages to the backing store */
+#define	UBC_INVALIDATE	0x04	/* invalidate pages in the specified range... may be used with UBC_PUSHDIRTY/ALL */
+#define	UBC_SYNC	0x08	/* wait for I/Os generated by UBC_PUSHDIRTY to complete */
+
+__BEGIN_DECLS
+
+off_t		ubc_blktooff(struct vnode *, daddr64_t);
+daddr64_t	ubc_offtoblk(struct vnode *, off_t);
+off_t	ubc_getsize(struct vnode *);
+int	ubc_setsize(struct vnode *, off_t);
+
+
+kauth_cred_t ubc_getcred(struct vnode *);
+struct thread;
+int	ubc_setthreadcred(struct vnode *, struct proc *, struct thread *);
+
+errno_t ubc_msync(vnode_t, off_t, off_t, off_t *, int);
+int	ubc_pages_resident(vnode_t);
+int	ubc_page_op(vnode_t, off_t, int, ppnum_t *, int *);
+int	ubc_range_op(vnode_t, off_t, off_t, int, int *);
+
+
+/* cluster IO routines */
+int	advisory_read(vnode_t, off_t, off_t, int);
+int	advisory_read_ext(vnode_t, off_t, off_t, int, int (*)(buf_t, void *), void *, int);
+
+int	cluster_read(vnode_t, struct uio *, off_t, int);
+int	cluster_read_ext(vnode_t, struct uio *, off_t, int, int (*)(buf_t, void *), void *);
+
+int	cluster_write(vnode_t, struct uio *, off_t, off_t, off_t, off_t, int);
+int	cluster_write_ext(vnode_t, struct uio *, off_t, off_t, off_t, off_t, int, int (*)(buf_t, void *), void *);
+
+int	cluster_pageout(vnode_t, upl_t, upl_offset_t, off_t, int, off_t, int);
+int	cluster_pageout_ext(vnode_t, upl_t, upl_offset_t, off_t, int, off_t, int, int (*)(buf_t, void *), void *);
+
+int	cluster_pagein(vnode_t, upl_t, upl_offset_t, off_t, int, off_t, int);
+int	cluster_pagein_ext(vnode_t, upl_t, upl_offset_t, off_t, int, off_t, int, int (*)(buf_t, void *), void *);
+
+int	cluster_push(vnode_t, int);
+int	cluster_push_ext(vnode_t, int, int (*)(buf_t, void *), void *);
+
+int	cluster_bp(buf_t);
+int	cluster_bp_ext(buf_t, int (*)(buf_t, void *), void *);
+
+void	cluster_zero(upl_t, upl_offset_t, int, buf_t);
+
+int	cluster_copy_upl_data(uio_t, upl_t, int, int *);
+int	cluster_copy_ubc_data(vnode_t, uio_t, int *, int);
+
+
+/* UPL routines */
+int	ubc_create_upl(vnode_t, off_t, int, upl_t *, upl_page_info_t **, int);
+int	ubc_upl_map(upl_t, vm_offset_t *);
+int	ubc_upl_unmap(upl_t);
+int	ubc_upl_commit(upl_t);
+int	ubc_upl_commit_range(upl_t, upl_offset_t, upl_size_t, int);
+int	ubc_upl_abort(upl_t, int);
+int	ubc_upl_abort_range(upl_t, upl_offset_t, upl_size_t, int);
+void	ubc_upl_range_needed(upl_t, int, int);
+
+upl_page_info_t *ubc_upl_pageinfo(upl_t);
+upl_size_t ubc_upl_maxbufsize(void);
+
+int	is_file_clean(vnode_t, off_t);
+
+__END_DECLS
+
+#endif	/* _SYS_UBC_H_ */
+
diff -Nur cctools-877.5/include/sys/ucontext.h cctools-877.5-AnV/include/sys/ucontext.h
--- cctools-877.5/include/sys/ucontext.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ucontext.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,42 @@
+/*
+ * Copyright (c) 2002-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _SYS_UCONTEXT_H_
+#define _SYS_UCONTEXT_H_
+
+#include <sys/cdefs.h>
+#include <sys/_types.h>
+
+#include <machine/_mcontext.h>
+#include <sys/_types/_sigaltstack.h>
+#include <sys/_types/_ucontext.h>
+
+#include <sys/_types/_sigset_t.h>
+
+
+#endif /* _SYS_UCONTEXT_H_ */
diff -Nur cctools-877.5/include/sys/ucred.h cctools-877.5-AnV/include/sys/ucred.h
--- cctools-877.5/include/sys/ucred.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/ucred.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,148 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995, 1997 Apple Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1989, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)ucred.h	8.4 (Berkeley) 1/9/95
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+#ifndef _SYS_UCRED_H_
+#define	_SYS_UCRED_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/param.h>
+#include <bsm/audit.h>
+
+struct label;
+
+#ifdef __APPLE_API_UNSTABLE
+#include <sys/queue.h>
+
+/*
+ * In-kernel credential structure.
+ *
+ * Note that this structure should not be used outside the kernel, nor should
+ * it or copies of it be exported outside.
+ */
+struct ucred {
+	TAILQ_ENTRY(ucred)	cr_link; /* never modify this without KAUTH_CRED_HASH_LOCK */
+	u_long	cr_ref;			/* reference count */
+	
+struct posix_cred {
+	/*
+	 * The credential hash depends on everything from this point on
+	 * (see kauth_cred_get_hashkey)
+	 */
+	uid_t	cr_uid;			/* effective user id */
+	uid_t	cr_ruid;		/* real user id */
+	uid_t	cr_svuid;		/* saved user id */
+	short	cr_ngroups;		/* number of groups in advisory list */
+	gid_t	cr_groups[NGROUPS];	/* advisory group list */
+	gid_t	cr_rgid;		/* real group id */
+	gid_t	cr_svgid;		/* saved group id */
+	uid_t	cr_gmuid;		/* UID for group membership purposes */
+	int	cr_flags;		/* flags on credential */
+} cr_posix;
+	struct label	*cr_label;	/* MAC label */
+	/* 
+	 * NOTE: If anything else (besides the flags)
+	 * added after the label, you must change
+	 * kauth_cred_find().
+	 */
+	struct au_session cr_audit;		/* user auditing data */
+};
+#ifndef _KAUTH_CRED_T
+#define	_KAUTH_CRED_T
+typedef struct ucred *kauth_cred_t;
+typedef struct posix_cred *posix_cred_t;
+#endif	/* !_KAUTH_CRED_T */
+
+/*
+ * Credential flags that can be set on a credential
+ */
+#define CRF_NOMEMBERD	0x00000001	/* memberd opt out by setgroups() */
+#define CRF_MAC_ENFORCE 0x00000002	/* force entry through MAC Framework */
+                                  	/* also forces credential cache miss */
+
+/*
+ * This is the external representation of struct ucred.
+ */
+struct xucred {
+        u_int   cr_version;             /* structure layout version */
+        uid_t   cr_uid;                 /* effective user id */
+        short   cr_ngroups;             /* number of advisory groups */
+        gid_t   cr_groups[NGROUPS];     /* advisory group list */
+};
+#define XUCRED_VERSION  0
+
+#define cr_gid cr_groups[0]
+#define NOCRED ((kauth_cred_t )0)	/* no credential available */
+#define FSCRED ((kauth_cred_t )-1)	/* filesystem credential */
+
+#define IS_VALID_CRED(_cr)	((_cr) != NOCRED && (_cr) != FSCRED)
+
+#endif /* __APPLE_API_UNSTABLE */
+
+#endif /* !_SYS_UCRED_H_ */
diff -Nur cctools-877.5/include/sys/uio.h cctools-877.5-AnV/include/sys/uio.h
--- cctools-877.5/include/sys/uio.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/uio.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,100 @@
+/*
+ * Copyright (c) 2000-2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)uio.h	8.5 (Berkeley) 2/22/94
+ */
+
+#ifndef _SYS_UIO_H_
+#define	_SYS_UIO_H_
+
+#include <sys/cdefs.h>
+#include <sys/_types.h>
+
+/*
+ * [XSI] The ssize_t and size_t types shall be defined as described
+ * in <sys/types.h>.
+ */
+#include <sys/_types/_size_t.h>
+#include <sys/_types/_ssize_t.h>
+
+/*
+ * [XSI] Structure whose address is passed as the second parameter to the
+ * readv() and writev() functions.
+ */
+#include <sys/_types/_iovec_t.h>
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/*
+ * IO direction for uio_t.
+ *	UIO_READ - data moves into iovec(s) associated with uio_t
+ *	UIO_WRITE - data moves out of iovec(s) associated with uio_t
+ */
+enum uio_rw { UIO_READ, UIO_WRITE };
+#endif
+
+
+
+__BEGIN_DECLS
+ssize_t	readv(int, const struct iovec *, int) __DARWIN_ALIAS_C(readv);
+ssize_t	writev(int, const struct iovec *, int) __DARWIN_ALIAS_C(writev);
+__END_DECLS
+
+#endif /* !_SYS_UIO_H_ */
diff -Nur cctools-877.5/include/sys/un.h cctools-877.5-AnV/include/sys/un.h
--- cctools-877.5/include/sys/un.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/un.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,105 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)un.h	8.3 (Berkeley) 2/19/95
+ */
+
+#ifndef _SYS_UN_H_
+#define _SYS_UN_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/_types.h>
+
+/* [XSI] The sa_family_t type shall be defined as described in <sys/socket.h> */
+#include <sys/_types/_sa_family_t.h>
+
+/*
+ * [XSI] Definitions for UNIX IPC domain.
+ */
+struct	sockaddr_un {
+	unsigned char	sun_len;	/* sockaddr len including null */
+	sa_family_t	sun_family;	/* [XSI] AF_UNIX */
+	char		sun_path[104];	/* [XSI] path name (gag) */
+};
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+
+/* Level number of get/setsockopt for local domain sockets */
+#define SOL_LOCAL		0
+
+/* Socket options. */
+#define LOCAL_PEERCRED		0x001		/* retrieve peer credentails */
+#define LOCAL_PEERPID		0x002		/* retrieve peer pid */
+#define LOCAL_PEEREPID		0x003		/* retrieve eff. peer pid */
+#define LOCAL_PEERUUID		0x004		/* retrieve peer UUID */
+#define LOCAL_PEEREUUID		0x005		/* retrieve eff. peer UUID */
+
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/* actual length of an initialized sockaddr_un */
+#define SUN_LEN(su) \
+	(sizeof(*(su)) - sizeof((su)->sun_path) + strlen((su)->sun_path))
+#endif	/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+
+#endif /* !_SYS_UN_H_ */
diff -Nur cctools-877.5/include/sys/unistd.h cctools-877.5-AnV/include/sys/unistd.h
--- cctools-877.5/include/sys/unistd.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/unistd.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,215 @@
+/*
+ * Copyright (c) 2000-2013 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1989, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)unistd.h	8.2 (Berkeley) 1/7/94
+ */
+
+#ifndef _SYS_UNISTD_H_
+#define	_SYS_UNISTD_H_
+
+#include <sys/cdefs.h>
+
+/*
+ * Although we have saved user/group IDs, we do not use them in setuid
+ * as described in POSIX 1003.1, because the feature does not work for
+ * root.  We use the saved IDs in seteuid/setegid, which are not currently
+ * part of the POSIX 1003.1 specification.
+ */
+#ifdef	_NOT_AVAILABLE
+#define	_POSIX_SAVED_IDS	/* saved set-user-ID and set-group-ID */
+#endif
+
+#define	_POSIX_VERSION		200112L
+#define	_POSIX2_VERSION		200112L
+
+/* execution-time symbolic constants */
+				/* may disable terminal special characters */
+#include <sys/_types/_posix_vdisable.h>
+
+#define _POSIX_THREAD_KEYS_MAX 128
+
+/* access function */
+#define	F_OK		0	/* test for existence of file */
+#define	X_OK		(1<<0)	/* test for execute or search permission */
+#define	W_OK		(1<<1)	/* test for write permission */
+#define	R_OK		(1<<2)	/* test for read permission */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/*
+ * Extended access functions.
+ * Note that we depend on these matching the definitions in sys/kauth.h,
+ * but with the bits shifted left by 8.
+ */
+#define _READ_OK	(1<<9)	/* read file data / read directory */
+#define _WRITE_OK	(1<<10)	/* write file data / add file to directory */
+#define _EXECUTE_OK	(1<<11) /* execute file / search in directory*/
+#define _DELETE_OK	(1<<12)	/* delete file / delete directory */
+#define _APPEND_OK	(1<<13)	/* append to file / add subdirectory to directory */
+#define _RMFILE_OK	(1<<14)	/* - / remove file from directory */
+#define _RATTR_OK	(1<<15)	/* read basic attributes */
+#define _WATTR_OK	(1<<16)	/* write basic attributes */
+#define _REXT_OK	(1<<17)	/* read extended attributes */
+#define _WEXT_OK	(1<<18)	/* write extended attributes */
+#define _RPERM_OK	(1<<19)	/* read permissions */
+#define _WPERM_OK	(1<<20)	/* write permissions */
+#define _CHOWN_OK	(1<<21)	/* change ownership */
+
+#define _ACCESS_EXTENDED_MASK (_READ_OK | _WRITE_OK | _EXECUTE_OK | \
+				_DELETE_OK | _APPEND_OK | \
+				_RMFILE_OK | _REXT_OK | \
+				_WEXT_OK | _RATTR_OK | _WATTR_OK | _RPERM_OK | \
+				_WPERM_OK | _CHOWN_OK)
+#endif
+
+/* whence values for lseek(2) */
+#include <sys/_types/_seek_set.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+/* whence values for lseek(2); renamed by POSIX 1003.1 */
+#define	L_SET		SEEK_SET
+#define	L_INCR		SEEK_CUR
+#define	L_XTND		SEEK_END
+#endif
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+struct accessx_descriptor {
+	unsigned int ad_name_offset;
+	int ad_flags;
+	int ad_pad[2];
+};
+#define ACCESSX_MAX_DESCRIPTORS	100
+#define ACCESSX_MAX_TABLESIZE	(16 * 1024)
+#endif
+
+/* configurable pathname variables */
+#define	_PC_LINK_MAX		 1
+#define	_PC_MAX_CANON		 2
+#define	_PC_MAX_INPUT		 3
+#define	_PC_NAME_MAX		 4
+#define	_PC_PATH_MAX		 5
+#define	_PC_PIPE_BUF		 6
+#define	_PC_CHOWN_RESTRICTED	 7
+#define	_PC_NO_TRUNC		 8
+#define	_PC_VDISABLE		 9
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define	_PC_NAME_CHARS_MAX	 10
+#define	_PC_CASE_SENSITIVE		 11
+#define	_PC_CASE_PRESERVING		 12
+#define _PC_EXTENDED_SECURITY_NP        13
+#define _PC_AUTH_OPAQUE_NP      14
+#endif
+
+#define	_PC_2_SYMLINKS		15	/* Symlink supported in directory */
+#define	_PC_ALLOC_SIZE_MIN	16	/* Minimum storage actually allocated */
+#define	_PC_ASYNC_IO		17	/* Async I/O [AIO] supported? */
+#define	_PC_FILESIZEBITS	18	/* # of bits to represent file size */
+#define	_PC_PRIO_IO		19	/* Priority I/O [PIO] supported? */
+#define	_PC_REC_INCR_XFER_SIZE	20	/* Recommended increment for next two */
+#define	_PC_REC_MAX_XFER_SIZE	21	/* Recommended max file transfer size */
+#define	_PC_REC_MIN_XFER_SIZE	22	/* Recommended min file transfer size */
+#define	_PC_REC_XFER_ALIGN	23	/* Recommended buffer alignment */
+#define	_PC_SYMLINK_MAX		24	/* Max # of bytes in symlink name */
+#define	_PC_SYNC_IO		25	/* Sync I/O [SIO] supported? */
+#define _PC_XATTR_SIZE_BITS 	26	/* # of bits to represent maximum xattr size */
+
+/* configurable system strings */
+#define	_CS_PATH		 1
+
+#if __DARWIN_C_LEVEL >= __DARWIN_C_FULL
+
+#include <machine/_types.h>
+#include <sys/_types/_size_t.h>
+#include <_types/_uint64_t.h>
+#include <Availability.h>
+
+__BEGIN_DECLS
+
+int getattrlistbulk(int, void *, void *, size_t, uint64_t) __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+
+__END_DECLS
+
+#endif /* __DARWIN_C_LEVEL >= __DARWIN_C_FULL */
+
+#if __DARWIN_C_LEVEL >= 200809L
+
+#include <machine/_types.h>
+#include <sys/_types/_size_t.h>
+#include <sys/_types/_ssize_t.h>
+#include <sys/_types.h>
+#include <sys/_types/_uid_t.h>
+#include <sys/_types/_gid_t.h>
+#include <Availability.h>
+
+__BEGIN_DECLS
+
+int	faccessat(int, const char *, int, int) __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+int	fchownat(int, const char *, uid_t, gid_t, int)	__OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+int	linkat(int, const char *, int, const char *, int)	__OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+ssize_t readlinkat(int, const char *, char *, size_t)	__OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+int	symlinkat(const char *, int, const char *) __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+int	unlinkat(int, const char *, int) __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+int	getattrlistat(int, const char *, void *, void *, size_t, unsigned long) __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
+
+__END_DECLS
+
+#endif /* __DARWIN_C_LEVEL >= 200809L */
+
+#endif /* !_SYS_UNISTD_H_ */
diff -Nur cctools-877.5/include/sys/unpcb.h cctools-877.5-AnV/include/sys/unpcb.h
--- cctools-877.5/include/sys/unpcb.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/unpcb.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,124 @@
+/*
+ * Copyright (c) 2008-2010 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1982, 1986, 1989, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)unpcb.h	8.1 (Berkeley) 6/2/93
+ */
+
+#ifndef _SYS_UNPCB_H_
+#define _SYS_UNPCB_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/queue.h>
+#include <sys/un.h>
+#include <sys/ucred.h>
+
+/*
+ * Protocol control block for an active
+ * instance of a UNIX internal protocol.
+ *
+ * A socket may be associated with an vnode in the
+ * file system.  If so, the unp_vnode pointer holds
+ * a reference count to this vnode, which should be irele'd
+ * when the socket goes away.
+ *
+ * A socket may be connected to another socket, in which
+ * case the control block of the socket to which it is connected
+ * is given by unp_conn.
+ *
+ * A socket may be referenced by a number of sockets (e.g. several
+ * sockets may be connected to a datagram socket.)  These sockets
+ * are in a linked list starting with unp_refs, linked through
+ * unp_nextref and null-terminated.  Note that a socket may be referenced
+ * by a number of other sockets and may also reference a socket (not
+ * necessarily one which is referencing it).  This generates
+ * the need for unp_refs and unp_nextref to be separate fields.
+ *
+ * Stream sockets keep copies of receive sockbuf sb_cc and sb_mbcnt
+ * so that changes in the sockbuf may be computed to modify
+ * back pressure on the sender accordingly.
+ */
+
+typedef u_quad_t        unp_gen_t;
+
+#if defined(__LP64__)
+struct _unpcb_list_entry {
+    u_int32_t   le_next; 
+    u_int32_t   le_prev;
+}; 
+#define _UCPCB_LIST_HEAD(name, type)	\
+struct name {				\
+	u_int32_t	lh_first;	\
+};
+#define _UNPCB_LIST_ENTRY(x)		struct _unpcb_list_entry
+#define _UNPCB_PTR(x)			u_int32_t
+#else 
+#define _UCPCB_LIST_HEAD(name, type)	LIST_HEAD(name, type)
+#define _UNPCB_LIST_ENTRY(x)		LIST_ENTRY(x)
+#define _UNPCB_PTR(x)			x
+#endif
+
+
+struct	xunpgen {
+	u_int32_t	xug_len;
+	u_int		xug_count;
+	unp_gen_t	xug_gen;
+	so_gen_t	xug_sogen;
+};
+
+#endif /* _SYS_UNPCB_H_ */
diff -Nur cctools-877.5/include/sys/user.h cctools-877.5-AnV/include/sys/user.h
--- cctools-877.5/include/sys/user.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/user.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,89 @@
+/*
+ * Copyright (c) 2000-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995, 1997 Apple Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1989, 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)user.h	8.2 (Berkeley) 9/23/93
+ */
+
+#ifndef	_SYS_USER_H_
+#define	_SYS_USER_H_
+
+#include <sys/appleapiopts.h>
+/* stuff that *used* to be included by user.h, or is now needed */
+#include <errno.h>
+#include <sys/time.h>
+#include <sys/resource.h>
+#include <sys/ucred.h>
+#include <sys/uio.h>
+#include <sys/vm.h>		/* XXX */
+#include <sys/sysctl.h>
+
+
+/*
+ * Per process structure containing data that isn't needed in core
+ * when the process isn't running (esp. when swapped out).
+ * This structure may or may not be at the same kernel address
+ * in all processes.
+ */
+ 
+struct	user {
+  /* NOT USED ANYMORE */
+};
+
+#endif	/* !_SYS_USER_H_ */
diff -Nur cctools-877.5/include/sys/utfconv.h cctools-877.5-AnV/include/sys/utfconv.h
--- cctools-877.5/include/sys/utfconv.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/utfconv.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,36 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _SYS_UTFCONV_H_
+#define	_SYS_UTFCONV_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h> 
+
+
+#endif /* !_SYS_UTFCONV_H_ */
diff -Nur cctools-877.5/include/sys/utsname.h cctools-877.5-AnV/include/sys/utsname.h
--- cctools-877.5/include/sys/utsname.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/utsname.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,86 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright 1993,1995 NeXT Computer Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1994
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * This code is derived from software contributed to Berkeley by
+ * Chuck Karish of Mindcraft, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)utsname.h	8.1 (Berkeley) 1/4/94
+ */
+ 
+#ifndef	_SYS_UTSNAME_H
+#define	_SYS_UTSNAME_H
+
+#include <sys/cdefs.h>
+
+#define	_SYS_NAMELEN	256
+
+struct	utsname {
+	char	sysname[_SYS_NAMELEN];	/* [XSI] Name of OS */
+	char	nodename[_SYS_NAMELEN];	/* [XSI] Name of this network node */
+	char	release[_SYS_NAMELEN];	/* [XSI] Release level */
+	char	version[_SYS_NAMELEN];	/* [XSI] Version level */
+	char	machine[_SYS_NAMELEN];	/* [XSI] Hardware type */
+};
+
+__BEGIN_DECLS
+int uname(struct utsname *);
+__END_DECLS
+
+#endif	/* !_SYS_UTSNAME_H */
diff -Nur cctools-877.5/include/sys/vadvise.h cctools-877.5-AnV/include/sys/vadvise.h
--- cctools-877.5/include/sys/vadvise.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/vadvise.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,88 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)vadvise.h	8.1 (Berkeley) 6/2/93
+ */
+
+
+#ifndef	_SYS_VADVISE_H_
+#define _SYS_VADVISE_H_
+
+#include <sys/appleapiopts.h>
+
+#ifdef __APPLE_API_OBSOLETE
+/*
+ * Parameters to vadvise() to tell system of particular paging
+ * behaviour:
+ *	VA_NORM		Normal strategy
+ *	VA_ANOM		Sampling page behaviour is not a win, don't bother
+ *			Suitable during GCs in LISP, or sequential or random
+ *			page referencing.
+ *	VA_SEQL		Sequential behaviour expected.
+ *	VA_FLUSH	Invalidate all page table entries.
+ */
+#define	VA_NORM		0
+#define	VA_ANOM		1
+#define	VA_SEQL		2
+#define	VA_FLUSH 	3
+
+#endif /* __APPLE_API_OBSOLETE */
+
+#endif	/* !_SYS_VADVISE_H_ */
diff -Nur cctools-877.5/include/sys/vcmd.h cctools-877.5-AnV/include/sys/vcmd.h
--- cctools-877.5/include/sys/vcmd.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/vcmd.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,75 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)vcmd.h	8.1 (Berkeley) 6/2/93
+ */
+
+#ifndef _SYS_VCMD_H_
+#define	_SYS_VCMD_H_
+
+#include <sys/ioctl.h>
+
+#define	VPRINT		0100
+#define	VPLOT		0200
+#define	VPRINTPLOT	0400
+
+#define	VGETSTATE	_IOR('v', 0, int)
+#define	VSETSTATE	_IOW('v', 1, int)
+#endif /* !_SYS_VCMD_H_ */
diff -Nur cctools-877.5/include/sys/vm.h cctools-877.5-AnV/include/sys/vm.h
--- cctools-877.5/include/sys/vm.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/vm.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,85 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)vm.h	8.5 (Berkeley) 5/11/95
+ */
+/* HISTORY
+ *  05-Jun-95  Mac Gillon (mgillon) at NeXT
+ * 	4.4 code uses this file to import MACH API
+ */
+
+#ifndef _SYS_VM_H
+#define _SYS_VM_H
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+/* just to keep kinfo_proc happy */
+/* NOTE: Pointer fields are size variant for LP64 */
+struct vmspace {
+	int32_t	dummy;
+	caddr_t	dummy2;
+	int32_t	dummy3[5];
+	caddr_t	dummy4[3];
+};
+
+
+
+#endif /* _SYS_VM_H */
diff -Nur cctools-877.5/include/sys/vmmeter.h cctools-877.5-AnV/include/sys/vmmeter.h
--- cctools-877.5/include/sys/vmmeter.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/vmmeter.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,141 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*-
+ * Copyright (c) 1982, 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *      This product includes software developed by the University of
+ *      California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)vmmeter.h	8.2 (Berkeley) 7/10/94
+ */
+
+#ifndef _SYS_VMMETER_H_
+#define	_SYS_VMMETER_H_
+
+#include <sys/appleapiopts.h>
+
+#ifdef __APPLE_API_OBSOLETE
+/*
+ * System wide statistics counters.
+ */
+struct vmmeter {
+	/*
+	 * General system activity.
+	 */
+	unsigned int v_swtch;		/* context switches */
+	unsigned int v_trap;		/* calls to trap */
+	unsigned int v_syscall;	/* calls to syscall() */
+	unsigned int v_intr;		/* device interrupts */
+	unsigned int v_soft;		/* software interrupts */
+	unsigned int v_faults;		/* total faults taken */
+	/*
+	 * Virtual memory activity.
+	 */
+	unsigned int v_lookups;	/* object cache lookups */
+	unsigned int v_hits;		/* object cache hits */
+	unsigned int v_vm_faults;	/* number of address memory faults */
+	unsigned int v_cow_faults;	/* number of copy-on-writes */
+	unsigned int v_swpin;		/* swapins */
+	unsigned int v_swpout;		/* swapouts */
+	unsigned int v_pswpin;		/* pages swapped in */
+	unsigned int v_pswpout;	/* pages swapped out */
+	unsigned int v_pageins;	/* number of pageins */
+	unsigned int v_pageouts;	/* number of pageouts */
+	unsigned int v_pgpgin;		/* pages paged in */
+	unsigned int v_pgpgout;	/* pages paged out */
+	unsigned int v_intrans;	/* intransit blocking page faults */
+	unsigned int v_reactivated;	/* number of pages reactivated from free list */
+	unsigned int v_rev;		/* revolutions of the hand */
+	unsigned int v_scan;		/* scans in page out daemon */
+	unsigned int v_dfree;		/* pages freed by daemon */
+	unsigned int v_pfree;		/* pages freed by exiting processes */
+	unsigned int v_zfod;		/* pages zero filled on demand */
+	unsigned int v_nzfod;		/* number of zfod's created */
+	/*
+	 * Distribution of page usages.
+	 */
+	unsigned int v_page_size;	/* page size in bytes */
+	unsigned int v_kernel_pages;	/* number of pages in use by kernel */
+	unsigned int v_free_target;	/* number of pages desired free */
+	unsigned int v_free_min;	/* minimum number of pages desired free */
+	unsigned int v_free_count;	/* number of pages free */
+	unsigned int v_wire_count;	/* number of pages wired down */
+	unsigned int v_active_count;	/* number of pages active */
+	unsigned int v_inactive_target; /* number of pages desired inactive */
+	unsigned int v_inactive_count;  /* number of pages inactive */
+};
+
+/* systemwide totals computed every five seconds */
+struct vmtotal
+{
+	int16_t	t_rq;		/* length of the run queue */
+	int16_t	t_dw;		/* jobs in ``disk wait'' (neg priority) */
+	int16_t	t_pw;		/* jobs in page wait */
+	int16_t	t_sl;		/* jobs sleeping in core */
+	int16_t	t_sw;		/* swapped out runnable/short block jobs */
+	int32_t	t_vm;		/* total virtual memory */
+	int32_t	t_avm;		/* active virtual memory */
+	int32_t	t_rm;		/* total real memory in use */
+	int32_t	t_arm;		/* active real memory */
+	int32_t	t_vmshr;	/* shared virtual memory */
+	int32_t	t_avmshr;	/* active shared virtual memory */
+	int32_t	t_rmshr;	/* shared real memory */
+	int32_t	t_armshr;	/* active shared real memory */
+	int32_t	t_free;		/* free memory pages */
+};
+
+#endif /*__APPLE_API_OBSOLETE */
+
+#endif /* !_SYS_VMMETER_H_ */
diff -Nur cctools-877.5/include/sys/vmparam.h cctools-877.5-AnV/include/sys/vmparam.h
--- cctools-877.5/include/sys/vmparam.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/vmparam.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,48 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1989 Carnegie-Mellon University
+ * Copyright (c) 1988 Carnegie-Mellon University
+ * All rights reserved.  The CMU software License Agreement specifies
+ * the terms and conditions for use and redistribution.
+ */
+/*
+ * HISTORY
+ */
+
+#ifndef	_SYS_VMPARAM_H_
+#define _SYS_VMPARAM_H_
+
+/*
+ * Machine dependent constants
+ */
+
+#include <machine/vmparam.h>
+
+#endif	/* _SYS_VMPARAM_H_ */
diff -Nur cctools-877.5/include/sys/vnioctl.h cctools-877.5-AnV/include/sys/vnioctl.h
--- cctools-877.5/include/sys/vnioctl.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/vnioctl.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,118 @@
+/*
+ * Copyright (c) 2004-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1988 University of Utah.
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * This code is derived from software contributed to Berkeley by
+ * the Systems Programming Group of the University of Utah Computer
+ * Science Department.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ * from: Utah $Hdr: fdioctl.h 1.1 90/07/09$
+ *
+ *	@(#)vnioctl.h	8.1 (Berkeley) 6/10/93
+ *
+ * $FreeBSD: src/sys/sys/vnioctl.h,v 1.4 1999/09/17 05:33:58 dillon Exp $
+ */
+
+#ifndef _SYS_VNIOCTL_H_
+#define _SYS_VNIOCTL_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+
+/*
+ * Ioctl definitions for file (vnode) disk pseudo-device.
+ */
+
+#define _PATH_VNTAB	"/etc/vntab"	/* default config file */
+
+typedef enum {
+	vncontrol_readwrite_io_e = 0
+} vncontrol_t;
+
+struct vn_ioctl {
+	char *		vn_file;	/* pathname of file to mount */
+	int			vn_size;	/* (returned) size of disk */
+	vncontrol_t	vn_control;
+};
+
+
+/*
+ * Before you can use a unit, it must be configured with VNIOCSET.
+ * The configuration persists across opens and closes of the device;
+ * an VNIOCCLR must be used to reset a configuration.  An attempt to
+ * VNIOCSET an already active unit will return EBUSY.
+ */
+#define VNIOCATTACH	_IOWR('F', 0, struct vn_ioctl)	/* attach file */
+#define VNIOCDETACH	_IOWR('F', 1, struct vn_ioctl)	/* detach disk */
+#define VNIOCGSET	_IOWR('F', 2, u_int32_t )		/* set global option */
+#define VNIOCGCLEAR	_IOWR('F', 3, u_int32_t )		/* reset --//-- */
+#define VNIOCUSET	_IOWR('F', 4, u_int32_t )		/* set unit option */
+#define VNIOCUCLEAR	_IOWR('F', 5, u_int32_t )		/* reset --//-- */
+#define VNIOCSHADOW	_IOWR('F', 6, struct vn_ioctl)	/* attach shadow */
+
+#define VN_LABELS	0x1	/* Use disk(/slice) labels */
+#define VN_FOLLOW	0x2	/* Debug flow in vn driver */
+#define VN_DEBUG	0x4	/* Debug data in vn driver */
+#define VN_IO		0x8	/* Debug I/O in vn driver */
+#define VN_DONTCLUSTER	0x10	/* Don't cluster */
+#define VN_RESERVE	0x20	/* Pre-reserve swap */
+
+
+#endif	/* _SYS_VNIOCTL_H_*/
diff -Nur cctools-877.5/include/sys/vnode.h cctools-877.5-AnV/include/sys/vnode.h
--- cctools-877.5/include/sys/vnode.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/vnode.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,136 @@
+/*
+ * Copyright (c) 2000-2014 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1989, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)vnode.h	8.17 (Berkeley) 5/20/95
+ */
+ 
+#ifndef _VNODE_H_
+#define _VNODE_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+/*
+ * The vnode is the focus of all file activity in UNIX.  There is a
+ * unique vnode allocated for each active file, each current directory,
+ * each mounted-on file, text file, and the root.
+ */
+
+/*
+ * Vnode types.  VNON means no type.
+ */
+enum vtype	{ 
+	/* 0 */
+	VNON, 
+	/* 1 - 5 */
+	VREG, VDIR, VBLK, VCHR, VLNK, 
+	/* 6 - 10 */
+	VSOCK, VFIFO, VBAD, VSTR, VCPLX 
+};
+
+/*
+ * Vnode tag types.
+ * These are for the benefit of external programs only (e.g., pstat)
+ * and should NEVER be inspected by the kernel.
+ */
+enum vtagtype	{
+	/* 0 */
+	VT_NON,
+	/* 1 reserved, overlaps with (CTL_VFS, VFS_NUMMNTOPS) */
+	VT_UFS,
+	/* 2 - 5 */
+	VT_NFS, VT_MFS, VT_MSDOSFS, VT_LFS,
+	/* 6 - 10 */
+	VT_LOFS, VT_FDESC, VT_PORTAL, VT_NULL, VT_UMAP, 
+	/* 11 - 15 */
+	VT_KERNFS, VT_PROCFS, VT_AFS, VT_ISOFS, VT_MOCKFS,
+	/* 16 - 20 */
+	VT_HFS, VT_ZFS, VT_DEVFS, VT_WEBDAV, VT_UDF, 
+	/* 21 - 24 */
+	VT_AFP, VT_CDDA, VT_CIFS, VT_OTHER
+};
+
+
+/*
+ * flags for VNOP_BLOCKMAP
+ */
+#define VNODE_READ	0x01
+#define VNODE_WRITE	0x02
+
+
+
+/* flags for VNOP_ALLOCATE */
+#define	PREALLOCATE		0x00000001	/* preallocate allocation blocks */
+#define	ALLOCATECONTIG	0x00000002	/* allocate contigious space */
+#define	ALLOCATEALL		0x00000004	/* allocate all requested space */
+									/* or no space at all */
+#define	FREEREMAINDER	0x00000008	/* deallocate allocated but */
+									/* unfilled blocks */
+#define	ALLOCATEFROMPEOF	0x00000010	/* allocate from the physical eof */
+#define	ALLOCATEFROMVOL		0x00000020	/* allocate from the volume offset */
+
+/*
+ * Token indicating no attribute value yet assigned. some user source uses this
+ */
+#define	VNOVAL	(-1)
+
+
+
+#endif /* !_VNODE_H_ */
diff -Nur cctools-877.5/include/sys/vnode_if.h cctools-877.5-AnV/include/sys/vnode_if.h
--- cctools-877.5/include/sys/vnode_if.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/vnode_if.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,89 @@
+
+/*
+ * Copyright (c) 2000-2014 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved
+ * Copyright (c) 1992, 1993, 1994, 1995
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *      This product includes software developed by the University of
+ *      California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+/*
+ * Warning: This file is generated automatically.
+ * (Modifications made here may easily be lost!)
+ *
+ * Created by the script:
+ *	@(#)vnode_if.sh	8.7 (Berkeley) 5/11/95
+ */
+
+
+#ifndef _SYS_VNODE_IF_H_
+#define _SYS_VNODE_IF_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+#include <sys/kernel_types.h>
+#include <sys/buf.h>
+#include <mach/memory_object_types.h>
+
+
+
+#endif /* !_SYS_VNODE_IF_H_ */
diff -Nur cctools-877.5/include/sys/vstat.h cctools-877.5-AnV/include/sys/vstat.h
--- cctools-877.5/include/sys/vstat.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/vstat.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,80 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1998 Apple Computer, Inc. All Rights Reserved */
+/*-
+ *	@(#)vstat.h	
+ */
+
+#ifndef _SYS_VSTAT_H_
+#define	_SYS_VSTAT_H_
+
+#include <sys/appleapiopts.h>
+#include <sys/cdefs.h>
+
+#warning obsolete header! delete the include from your sources
+
+#ifdef __APPLE_API_OBSOLETE
+
+#include <sys/time.h>
+#include <sys/attr.h>
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+
+struct vstat {
+	fsid_t			vst_volid;		/* volume identifier */
+	fsobj_id_t		vst_nodeid;		/* object's id */
+	fsobj_type_t		vst_vnodetype;	/* vnode type (VREG, VDIR, etc.) */
+	fsobj_tag_t		vst_vnodetag;	/* vnode tag (HFS, UFS, etc.) */
+	mode_t	  		vst_mode;		/* inode protection mode */
+	nlink_t	  		vst_nlink;		/* number of hard links */
+	uid_t	  		vst_uid;		/* user ID of the file's owner */
+	gid_t	  		vst_gid;		/* group ID of the file's group */
+	dev_t			vst_dev;		/* inode's device */
+	dev_t	  		vst_rdev;		/* device type */
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+	struct	timespec vst_atimespec;	/* time of last access */
+	struct	timespec vst_mtimespec;	/* time of last data modification */
+	struct	timespec vst_ctimespec;	/* time of last file status change */
+#else
+	time_t	  		vst_atime;		/* time of last access */
+	long	  		vst_atimensec;	/* nsec of last access */
+	time_t	  		vst_mtime;		/* time of last data modification */
+	long	  		vst_mtimensec;	/* nsec of last data modification */
+	time_t	  		vst_ctime;		/* time of last file status change */
+	long	  		vst_ctimensec;	/* nsec of last file status change */
+#endif
+	off_t	  		vst_filesize;	/* file size, in bytes */
+	quad_t	  		vst_blocks;		/* bytes allocated for file */
+	u_int32_t 		vst_blksize;	/* optimal blocksize for I/O */
+	u_int32_t 		vst_flags;		/* user defined flags for file */
+};
+
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+#endif /* __APPLE_API_OBSOLETE */
+
+#endif /* !_SYS_VSTAT_H_ */
diff -Nur cctools-877.5/include/sys/wait.h cctools-877.5-AnV/include/sys/wait.h
--- cctools-877.5/include/sys/wait.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/wait.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,258 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */
+/*
+ * Copyright (c) 1982, 1986, 1989, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)wait.h	8.2 (Berkeley) 7/10/94
+ */
+ 
+#ifndef _SYS_WAIT_H_
+#define	_SYS_WAIT_H_
+
+#include <sys/cdefs.h>
+#include <sys/_types.h>
+
+/*
+ * This file holds definitions relevent to the wait4 system call
+ * and the alternate interfaces that use it (wait, wait3, waitpid).
+ */
+
+/*
+ * [XSI] The type idtype_t shall be defined as an enumeration type whose
+ * possible values shall include at least P_ALL, P_PID, and P_PGID.
+ */
+typedef enum {
+	P_ALL,
+	P_PID,
+	P_PGID
+} idtype_t;
+
+/*
+ * [XSI] The id_t and pid_t types shall be defined as described
+ * in <sys/types.h>
+ */
+#include <sys/_types/_pid_t.h>
+#include <sys/_types/_id_t.h>
+
+/*
+ * [XSI] The siginfo_t type shall be defined as described in <signal.h>
+ * [XSI] The rusage structure shall be defined as described in <sys/resource.h>
+ * [XSI] Inclusion of the <sys/wait.h> header may also make visible all
+ * symbols from <signal.h> and <sys/resource.h>
+ *
+ * NOTE:	This requirement is currently being satisfied by the direct
+ *		inclusion of <sys/signal.h> and <sys/resource.h>, below.
+ *
+ *		Software should not depend on the exposure of anything other
+ *		than the types siginfo_t and struct rusage as a result of
+ *		this inclusion.  If you depend on any types or manifest
+ *		values othe than siginfo_t and struct rusage from either of
+ *		those files, you should explicitly include them yourself, as
+ *		well, or in future releases your stware may not compile
+ *		without modification.
+ */
+#include <sys/signal.h>		/* [XSI] for siginfo_t */
+#include <sys/resource.h>	/* [XSI] for struct rusage */
+
+/*
+ * Option bits for the third argument of wait4.  WNOHANG causes the
+ * wait to not hang if there are no stopped or terminated processes, rather
+ * returning an error indication in this case (pid==0).  WUNTRACED
+ * indicates that the caller should receive status about untraced children
+ * which stop due to signals.  If children are stopped and a wait without
+ * this option is done, it is as though they were still running... nothing
+ * about them is returned.
+ */
+#define WNOHANG		0x00000001  /* [XSI] no hang in wait/no child to reap */
+#define WUNTRACED	0x00000002  /* [XSI] notify on stop, untraced child */
+
+/*
+ * Macros to test the exit status returned by wait
+ * and extract the relevant values.
+ */
+#if defined(_POSIX_C_SOURCE) && !defined(_DARWIN_C_SOURCE)
+#define	_W_INT(i)	(i)
+#else
+#define	_W_INT(w)	(*(int *)&(w))	/* convert union wait to int */
+#define	WCOREFLAG	0200
+#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+
+/* These macros are permited, as they are in the implementation namespace */
+#define	_WSTATUS(x)	(_W_INT(x) & 0177)
+#define	_WSTOPPED	0177		/* _WSTATUS if process is stopped */
+
+/*
+ * [XSI] The <sys/wait.h> header shall define the following macros for
+ * analysis of process status values
+ */
+#if __DARWIN_UNIX03
+#define WEXITSTATUS(x)	((_W_INT(x) >> 8) & 0x000000ff)
+#else /* !__DARWIN_UNIX03 */
+#define WEXITSTATUS(x)	(_W_INT(x) >> 8)
+#endif /* !__DARWIN_UNIX03 */
+/* 0x13 == SIGCONT */
+#define WSTOPSIG(x)	(_W_INT(x) >> 8)
+#define WIFCONTINUED(x) (_WSTATUS(x) == _WSTOPPED && WSTOPSIG(x) == 0x13)
+#define WIFSTOPPED(x)	(_WSTATUS(x) == _WSTOPPED && WSTOPSIG(x) != 0x13)
+#define WIFEXITED(x)	(_WSTATUS(x) == 0)
+#define WIFSIGNALED(x)	(_WSTATUS(x) != _WSTOPPED && _WSTATUS(x) != 0)
+#define WTERMSIG(x)	(_WSTATUS(x))
+#if (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+#define WCOREDUMP(x)	(_W_INT(x) & WCOREFLAG)
+
+#define	W_EXITCODE(ret, sig)	((ret) << 8 | (sig))
+#define	W_STOPCODE(sig)		((sig) << 8 | _WSTOPPED)
+#endif /* (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)) */
+
+/*
+ * [XSI] The following symbolic constants shall be defined as possible
+ * values for the fourth argument to waitid().
+ */
+/* WNOHANG already defined for wait4() */
+/* WUNTRACED defined for wait4() but not for waitid() */
+#define	WEXITED		0x00000004  /* [XSI] Processes which have exitted */
+#if __DARWIN_UNIX03
+/* waitid() parameter */
+#define	WSTOPPED	0x00000008  /* [XSI] Any child stopped by signal */
+#endif
+#define	WCONTINUED	0x00000010  /* [XSI] Any child stopped then continued */
+#define	WNOWAIT		0x00000020  /* [XSI] Leave process returned waitable */
+
+
+#if (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+/* POSIX extensions and 4.2/4.3 compatability: */
+
+/*
+ * Tokens for special values of the "pid" parameter to wait4.
+ */
+#define	WAIT_ANY	(-1)	/* any process */
+#define	WAIT_MYPGRP	0	/* any process in my process group */
+
+#include <machine/endian.h>
+
+/*
+ * Deprecated:
+ * Structure of the information in the status word returned by wait4.
+ * If w_stopval==_WSTOPPED, then the second structure describes
+ * the information returned, else the first.
+ */
+union wait {
+	int	w_status;		/* used in syscall */
+	/*
+	 * Terminated process status.
+	 */
+	struct {
+#if __DARWIN_BYTE_ORDER == __DARWIN_LITTLE_ENDIAN 
+		unsigned int	w_Termsig:7,	/* termination signal */
+				w_Coredump:1,	/* core dump indicator */
+				w_Retcode:8,	/* exit code if w_termsig==0 */
+				w_Filler:16;	/* upper bits filler */
+#endif
+#if __DARWIN_BYTE_ORDER == __DARWIN_BIG_ENDIAN 
+		unsigned int	w_Filler:16,	/* upper bits filler */
+				w_Retcode:8,	/* exit code if w_termsig==0 */
+				w_Coredump:1,	/* core dump indicator */
+				w_Termsig:7;	/* termination signal */
+#endif
+	} w_T;
+	/*
+	 * Stopped process status.  Returned
+	 * only for traced children unless requested
+	 * with the WUNTRACED option bit.
+	 */
+	struct {
+#if __DARWIN_BYTE_ORDER == __DARWIN_LITTLE_ENDIAN 
+		unsigned int	w_Stopval:8,	/* == W_STOPPED if stopped */
+				w_Stopsig:8,	/* signal that stopped us */
+				w_Filler:16;	/* upper bits filler */
+#endif
+#if __DARWIN_BYTE_ORDER == __DARWIN_BIG_ENDIAN 
+		unsigned int	w_Filler:16,	/* upper bits filler */
+				w_Stopsig:8,	/* signal that stopped us */
+				w_Stopval:8;	/* == W_STOPPED if stopped */
+#endif
+	} w_S;
+};
+#define	w_termsig	w_T.w_Termsig
+#define w_coredump	w_T.w_Coredump
+#define w_retcode	w_T.w_Retcode
+#define w_stopval	w_S.w_Stopval
+#define w_stopsig	w_S.w_Stopsig
+
+#endif /* (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)) */
+
+#if !(__DARWIN_UNIX03 - 0)
+/*
+ * Stopped state value; cannot use waitid() parameter of the same name
+ * in the same scope
+ */
+#define	WSTOPPED	_WSTOPPED
+#endif /* !__DARWIN_UNIX03 */
+
+__BEGIN_DECLS
+pid_t	wait(int *) __DARWIN_ALIAS_C(wait);
+pid_t	waitpid(pid_t, int *, int) __DARWIN_ALIAS_C(waitpid);
+#ifndef _ANSI_SOURCE
+int	waitid(idtype_t, id_t, siginfo_t *, int) __DARWIN_ALIAS_C(waitid);
+#endif /* !_ANSI_SOURCE */
+#if  (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+pid_t	wait3(int *, int, struct rusage *);
+pid_t	wait4(pid_t, int *, int, struct rusage *);
+#endif /* (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)) */
+__END_DECLS
+#endif /* !_SYS_WAIT_H_ */
diff -Nur cctools-877.5/include/sys/xattr.h cctools-877.5-AnV/include/sys/xattr.h
--- cctools-877.5/include/sys/xattr.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/include/sys/xattr.h	2015-11-16 07:56:34 +0000
@@ -0,0 +1,79 @@
+/*
+ * Copyright (c) 2004-2012 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _SYS_XATTR_H_
+#define _SYS_XATTR_H_
+
+#include <sys/types.h>
+
+/* Options for pathname based xattr calls */
+#define XATTR_NOFOLLOW   0x0001     /* Don't follow symbolic links */
+
+/* Options for setxattr calls */
+#define XATTR_CREATE     0x0002     /* set the value, fail if attr already exists */
+#define XATTR_REPLACE    0x0004     /* set the value, fail if attr does not exist */
+
+/* Set this to bypass authorization checking (eg. if doing auth-related work) */
+#define XATTR_NOSECURITY 0x0008
+
+/* Set this to bypass the default extended attribute file (dot-underscore file) */
+#define XATTR_NODEFAULT  0x0010
+
+/* option for f/getxattr() and f/listxattr() to expose the HFS Compression extended attributes */
+#define XATTR_SHOWCOMPRESSION 0x0020
+
+#define	XATTR_MAXNAMELEN   127
+
+/* See the ATTR_CMN_FNDRINFO section of getattrlist(2) for details on FinderInfo */
+#define	XATTR_FINDERINFO_NAME	  "com.apple.FinderInfo"
+
+#define	XATTR_RESOURCEFORK_NAME	  "com.apple.ResourceFork"
+
+
+
+__BEGIN_DECLS
+
+ssize_t getxattr(const char *path, const char *name, void *value, size_t size, u_int32_t position, int options);
+
+ssize_t fgetxattr(int fd, const char *name, void *value, size_t size, u_int32_t position, int options);
+
+int setxattr(const char *path, const char *name, const void *value, size_t size, u_int32_t position, int options);
+
+int fsetxattr(int fd, const char *name, const void *value, size_t size, u_int32_t position, int options);
+
+int removexattr(const char *path, const char *name, int options);
+
+int fremovexattr(int fd, const char *name, int options);
+
+ssize_t listxattr(const char *path, char *namebuff, size_t size, int options);
+ 
+ssize_t flistxattr(int fd, char *namebuff, size_t size, int options);
+
+__END_DECLS
+
+#endif /* _SYS_XATTR_H_ */
diff -Nur cctools-877.5/include/xar/xar.h cctools-877.5-AnV/include/xar/xar.h
--- cctools-877.5/include/xar/xar.h	2015-03-10 00:33:19 +0000
+++ cctools-877.5-AnV/include/xar/xar.h	2015-11-19 09:29:13 +0000
@@ -1,246 +1,254 @@
-/*
- * Copyright (c) 2005 Rob Braun
- * All rights reserved.
- *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- * 1. Redistributions of source code must retain the above copyright
- *    notice, this list of conditions and the following disclaimer.
- * 2. Redistributions in binary form must reproduce the above copyright
- *    notice, this list of conditions and the following disclaimer in the
- *    documentation and/or other materials provided with the distribution.
- * 3. Neither the name of Rob Braun nor the names of his contributors
- *    may be used to endorse or promote products derived from this software
- *    without specific prior written permission.
- *
- * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
- * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
- * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
- * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
- * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
- * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
- * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
- * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
- * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
- * POSSIBILITY OF SUCH DAMAGE.
- */
-/*
- * 03-Apr-2005
- * DRI: Rob Braun <bbraun@opendarwin.org>
- */
-/*
- * Portions Copyright 2006, Apple Computer, Inc.
- * Christopher Ryan <ryanc@apple.com>
- */
- 
-#ifndef _XAR_H_
-#define _XAR_H_
-
-#define XAR_VERSION "1.7dev"
-
-#include <sys/types.h>
-#include <stdint.h>
-#include <sys/stat.h>
-
-#pragma pack(4)
-
-struct xar_header {
-	uint32_t magic;
-	uint16_t size;
-	uint16_t version;
-	uint64_t toc_length_compressed;
-	uint64_t toc_length_uncompressed;
-	uint32_t cksum_alg;
-};
-#pragma pack()
-typedef struct xar_header xar_header_t;
-
-#define XAR_HEADER_MAGIC 0x78617221
-#define XAR_EA_FORK "ea"
-
-#define XAR_CKSUM_NONE   0
-#define XAR_CKSUM_SHA1   1
-#define XAR_CKSUM_MD5    2
-#define XAR_CKSUM_SHA256 3
-#define XAR_CKSUM_SHA512 4
-
-typedef void *xar_errctx_t;
-typedef const struct __xar_file_t *xar_file_t;
-typedef const struct __xar_iter_t *xar_iter_t;
-typedef const struct __xar_t *xar_t;
-typedef const struct __xar_subdoc_t *xar_subdoc_t;
-typedef const struct __xar_signature_t *xar_signature_t;
-
-typedef struct {
-        char *next_out;
-        unsigned int avail_out;
-
-        unsigned long long total_in;
-        unsigned long long total_out;
-
-        void *state;
-} xar_stream;
-
-typedef int32_t (*err_handler)(int32_t severit, int32_t instance, xar_errctx_t ctx, void *usrctx);
-/* the signed_data must be allocated durring the callback and will be released by the xar lib after the callback */
-typedef int32_t (*xar_signer_callback)(xar_signature_t sig, void *context, uint8_t *data, uint32_t length, uint8_t **signed_data, uint32_t *signed_len);
-
-#define READ 0
-#define WRITE 1
-
-/* xar stream return codes */
-#define XAR_STREAM_OK   0
-#define XAR_STREAM_END  1
-#define XAR_STREAM_ERR -1
-
-/* Valid xar options & values */
-#define XAR_OPT_OWNERSHIP    "ownership"  /* setting owner/group behavior */
-#define XAR_OPT_VAL_SYMBOLIC "symbolic"   /* set owner/group based on names */
-#define XAR_OPT_VAL_NUMERIC  "numeric"    /* set owner/group based on uid/gid */
-
-#define XAR_OPT_TOCCKSUM   "toc-cksum"      /* set the toc checksum algorithm */
-#define XAR_OPT_FILECKSUM  "file-chksum"	/* set the file checksum algorithm */
-#define XAR_OPT_VAL_NONE   "none"
-#define XAR_OPT_VAL_SHA1   "sha1"
-#define XAR_OPT_VAL_SHA256 "sha256"
-#define XAR_OPT_VAL_SHA512 "sha512"
-#define XAR_OPT_VAL_MD5    "md5"
-
-#define XAR_OPT_COMPRESSION    "compression" /* set the file compression type */
-#define XAR_OPT_COMPRESSIONARG "compression-arg" /* set the compression opts */
-#define XAR_OPT_VAL_GZIP       "gzip"
-#define XAR_OPT_VAL_BZIP       "bzip2"
-#define XAR_OPT_VAL_LZMA       "lzma"
-
-#define XAR_OPT_RSIZE          "rsize"       /* Read io buffer size */
-
-#define XAR_OPT_COALESCE         "coalesce"         /* Coalesce identical heap blocks */
-#define XAR_OPT_LINKSAME         "linksame"         /* Hardlink identical files */
-
-#define XAR_OPT_PROPINCLUDE    "prop-include" /* File property to include */
-#define XAR_OPT_PROPEXCLUDE    "prop-exclude" /* File property to exclude */
-
-#define XAR_OPT_SAVESUID       "savesuid"     /* Preserve setuid/setgid bits */
-#define XAR_OPT_VAL_TRUE       "true"
-#define XAR_OPT_VAL_FALSE      "false"
-
-/* xar signing algorithms */
-#define XAR_SIG_SHA1RSA		1
-
-
-/* xar error handler macros */
-#define XAR_SEVERITY_DEBUG    1
-#define XAR_SEVERITY_INFO     2
-#define XAR_SEVERITY_NORMAL   3
-#define XAR_SEVERITY_WARNING  4
-#define XAR_SEVERITY_NONFATAL 5
-#define XAR_SEVERITY_FATAL    6
-
-#define XAR_ERR_ARCHIVE_CREATION   1
-#define XAR_ERR_ARCHIVE_EXTRACTION 2
-
-xar_t xar_open(const char *file, int32_t flags);
-int xar_close(xar_t x);
-xar_file_t xar_add(xar_t x, const char *path);
-
-xar_file_t xar_add_frombuffer(xar_t x, xar_file_t parent, const char *name, char *buffer, size_t length);
-xar_file_t xar_add_folder(xar_t x, xar_file_t f, const char *name, struct stat *info);
-xar_file_t xar_add_frompath(xar_t x, xar_file_t parent, const char *name, const char *realpath);
-
-xar_file_t xar_add_from_archive(xar_t x, xar_file_t parent, const char *name, xar_t sourcearchive, xar_file_t sourcefile);
-
-int32_t xar_extract(xar_t x, xar_file_t f);
-int32_t xar_extract_tofile(xar_t x, xar_file_t f, const char *path);
-int32_t xar_extract_tobuffer(xar_t x, xar_file_t f, char **buffer);
-int32_t xar_extract_tobuffersz(xar_t x, xar_file_t f, char **buffer, size_t *size);
-int32_t xar_extract_tostream_init(xar_t x, xar_file_t f, xar_stream *stream);
-int32_t xar_extract_tostream(xar_stream *stream);
-int32_t xar_extract_tostream_end(xar_stream *stream);
-
-int32_t xar_verify(xar_t x, xar_file_t f);
-
-
-const char *xar_opt_get(xar_t x, const char *option);
-int32_t xar_opt_set(xar_t x, const char *option, const char *value);
-int32_t xar_opt_unset(xar_t x, const char *option);
-
-int32_t xar_prop_set(xar_file_t f, const char *key, const char *value);
-int32_t xar_prop_create(xar_file_t f, const char *key, const char *value);
-int32_t xar_prop_get(xar_file_t f, const char *key, const char **value);
-
-xar_iter_t xar_iter_new(void);
-void xar_iter_free(xar_iter_t i);
-
-const char *xar_prop_first(xar_file_t f, xar_iter_t i);
-const char *xar_prop_next(xar_iter_t i);
-
-void xar_prop_unset(xar_file_t f, const char *key);
-xar_file_t xar_file_first(xar_t x, xar_iter_t i);
-xar_file_t xar_file_next(xar_iter_t i);
-
-const char *xar_attr_get(xar_file_t f, const char *prop, const char *key);
-int32_t xar_attr_set(xar_file_t f, const char *prop, const char *key, const char *value);
-const char *xar_attr_first(xar_file_t f, const char *prop, xar_iter_t i);
-const char *xar_attr_next(xar_iter_t i);
-
-xar_subdoc_t xar_subdoc_new(xar_t x, const char *name);
-int32_t xar_subdoc_prop_set(xar_subdoc_t s, const char *key, const char *value);
-int32_t xar_subdoc_prop_get(xar_subdoc_t s, const char *key, const char **value);
-int32_t xar_subdoc_attr_set(xar_subdoc_t s, const char *prop, const char *key, const char *value);
-const char *xar_subdoc_attr_get(xar_subdoc_t s, const char *prop, const char *key);
-xar_subdoc_t xar_subdoc_first(xar_t x);
-xar_subdoc_t xar_subdoc_next(xar_subdoc_t s);
-const char *xar_subdoc_name(xar_subdoc_t s);
-int32_t xar_subdoc_copyout(xar_subdoc_t s, unsigned char **, unsigned int *);
-int32_t xar_subdoc_copyin(xar_subdoc_t s, const unsigned char *, unsigned int);
-void xar_subdoc_remove(xar_subdoc_t s);
-
-/* signature api for adding various signature types */
-xar_signature_t xar_signature_new(xar_t x,const char *type, int32_t length, xar_signer_callback callback, void *callback_context);
-/* extended signatures are ignored by previous versions of xar */
-xar_signature_t xar_signature_new_extended(xar_t x,const char *type, int32_t length, xar_signer_callback callback, void *callback_context);
-
-const char *xar_signature_type(xar_signature_t s);
-
-xar_signature_t xar_signature_first(xar_t x);
-xar_signature_t xar_signature_next(xar_signature_t s);
-
-int32_t xar_signature_add_x509certificate(xar_signature_t sig, const uint8_t *cert_data, uint32_t cert_len );
-
-int32_t xar_signature_get_x509certificate_count(xar_signature_t sig);
-int32_t xar_signature_get_x509certificate_data(xar_signature_t sig, int32_t index, const uint8_t **cert_data, uint32_t *cert_len);
-
-uint8_t xar_signature_copy_signed_data(xar_signature_t sig, uint8_t **data, uint32_t *length, uint8_t **signed_data, uint32_t *signed_length, off_t *signed_offset);
-
-/* Helper functions - caller must free returned memory */
-char *xar_get_size(xar_t x, xar_file_t f);
-char *xar_get_type(xar_t x, xar_file_t f);
-char *xar_get_mode(xar_t x, xar_file_t f);
-char *xar_get_owner(xar_t x, xar_file_t f);
-char *xar_get_group(xar_t x, xar_file_t f);
-char *xar_get_mtime(xar_t x, xar_file_t f);
-
-/* For helping calling apps harden against hacked archives that attempt to escape their extraction roots. */
-int xar_path_issane(char* path);
-
-/* These are for xar modules and should never be needed from a calling app */
-void xar_register_errhandler(xar_t x, err_handler callback, void *usrctx);
-xar_t xar_err_get_archive(xar_errctx_t ctx);
-xar_file_t xar_err_get_file(xar_errctx_t ctx);
-const char *xar_err_get_string(xar_errctx_t ctx);
-int xar_err_get_errno(xar_errctx_t ctx);
-void xar_err_set_file(xar_t x, xar_file_t f);
-void xar_err_set_formatted_string(xar_t x, const char *format, ...);
-void xar_err_set_string(xar_t x, const char *str);
-void xar_err_set_errno(xar_t x, int e);
-void xar_err_new(xar_t x);
-int32_t xar_err_callback(xar_t x, int32_t sev, int32_t err);
-
-void xar_serialize(xar_t x, const char *file);
-char *xar_get_path(xar_file_t f);
-off_t	xar_get_heap_offset(xar_t x);
-uint64_t xar_ntoh64(uint64_t num);
-
-#endif /* _XAR_H_ */
+/*
+ * Copyright (c) 2005 Rob Braun
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. Neither the name of Rob Braun nor the names of his contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+ * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+ * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+ * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+ * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+ * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+ * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+ * POSSIBILITY OF SUCH DAMAGE.
+ */
+/*
+ * 03-Apr-2005
+ * DRI: Rob Braun <bbraun@opendarwin.org>
+ */
+/*
+ * Portions Copyright 2006, Apple Computer, Inc.
+ * Christopher Ryan <ryanc@apple.com>
+ */
+ 
+#ifndef _XAR_H_
+#define _XAR_H_
+
+#define XAR_VERSION "1.7dev"
+
+#include <sys/types.h>
+#include <stdint.h>
+#include <sys/stat.h>
+
+#ifndef _OFF_T_
+#define _OFF_T_
+  typedef long _off_t;
+#if !defined(NO_OLDNAMES) || defined(_POSIX)
+  typedef long off32_t;
+#endif
+#endif
+
+#pragma pack(4)
+
+struct xar_header {
+	uint32_t magic;
+	uint16_t size;
+	uint16_t version;
+	uint64_t toc_length_compressed;
+	uint64_t toc_length_uncompressed;
+	uint32_t cksum_alg;
+};
+#pragma pack()
+typedef struct xar_header xar_header_t;
+
+#define XAR_HEADER_MAGIC 0x78617221
+#define XAR_EA_FORK "ea"
+
+#define XAR_CKSUM_NONE   0
+#define XAR_CKSUM_SHA1   1
+#define XAR_CKSUM_MD5    2
+#define XAR_CKSUM_SHA256 3
+#define XAR_CKSUM_SHA512 4
+
+typedef void *xar_errctx_t;
+typedef const struct __xar_file_t *xar_file_t;
+typedef const struct __xar_iter_t *xar_iter_t;
+typedef const struct __xar_t *xar_t;
+typedef const struct __xar_subdoc_t *xar_subdoc_t;
+typedef const struct __xar_signature_t *xar_signature_t;
+
+typedef struct {
+        char *next_out;
+        unsigned int avail_out;
+
+        unsigned long long total_in;
+        unsigned long long total_out;
+
+        void *state;
+} xar_stream;
+
+typedef int32_t (*err_handler)(int32_t severit, int32_t instance, xar_errctx_t ctx, void *usrctx);
+/* the signed_data must be allocated durring the callback and will be released by the xar lib after the callback */
+typedef int32_t (*xar_signer_callback)(xar_signature_t sig, void *context, uint8_t *data, uint32_t length, uint8_t **signed_data, uint32_t *signed_len);
+
+#define READ 0
+#define WRITE 1
+
+/* xar stream return codes */
+#define XAR_STREAM_OK   0
+#define XAR_STREAM_END  1
+#define XAR_STREAM_ERR -1
+
+/* Valid xar options & values */
+#define XAR_OPT_OWNERSHIP    "ownership"  /* setting owner/group behavior */
+#define XAR_OPT_VAL_SYMBOLIC "symbolic"   /* set owner/group based on names */
+#define XAR_OPT_VAL_NUMERIC  "numeric"    /* set owner/group based on uid/gid */
+
+#define XAR_OPT_TOCCKSUM   "toc-cksum"      /* set the toc checksum algorithm */
+#define XAR_OPT_FILECKSUM  "file-chksum"	/* set the file checksum algorithm */
+#define XAR_OPT_VAL_NONE   "none"
+#define XAR_OPT_VAL_SHA1   "sha1"
+#define XAR_OPT_VAL_SHA256 "sha256"
+#define XAR_OPT_VAL_SHA512 "sha512"
+#define XAR_OPT_VAL_MD5    "md5"
+
+#define XAR_OPT_COMPRESSION    "compression" /* set the file compression type */
+#define XAR_OPT_COMPRESSIONARG "compression-arg" /* set the compression opts */
+#define XAR_OPT_VAL_GZIP       "gzip"
+#define XAR_OPT_VAL_BZIP       "bzip2"
+#define XAR_OPT_VAL_LZMA       "lzma"
+
+#define XAR_OPT_RSIZE          "rsize"       /* Read io buffer size */
+
+#define XAR_OPT_COALESCE         "coalesce"         /* Coalesce identical heap blocks */
+#define XAR_OPT_LINKSAME         "linksame"         /* Hardlink identical files */
+
+#define XAR_OPT_PROPINCLUDE    "prop-include" /* File property to include */
+#define XAR_OPT_PROPEXCLUDE    "prop-exclude" /* File property to exclude */
+
+#define XAR_OPT_SAVESUID       "savesuid"     /* Preserve setuid/setgid bits */
+#define XAR_OPT_VAL_TRUE       "true"
+#define XAR_OPT_VAL_FALSE      "false"
+
+/* xar signing algorithms */
+#define XAR_SIG_SHA1RSA		1
+
+
+/* xar error handler macros */
+#define XAR_SEVERITY_DEBUG    1
+#define XAR_SEVERITY_INFO     2
+#define XAR_SEVERITY_NORMAL   3
+#define XAR_SEVERITY_WARNING  4
+#define XAR_SEVERITY_NONFATAL 5
+#define XAR_SEVERITY_FATAL    6
+
+#define XAR_ERR_ARCHIVE_CREATION   1
+#define XAR_ERR_ARCHIVE_EXTRACTION 2
+
+xar_t xar_open(const char *file, int32_t flags);
+int xar_close(xar_t x);
+xar_file_t xar_add(xar_t x, const char *path);
+
+xar_file_t xar_add_frombuffer(xar_t x, xar_file_t parent, const char *name, char *buffer, size_t length);
+xar_file_t xar_add_folder(xar_t x, xar_file_t f, const char *name, struct stat *info);
+xar_file_t xar_add_frompath(xar_t x, xar_file_t parent, const char *name, const char *realpath);
+
+xar_file_t xar_add_from_archive(xar_t x, xar_file_t parent, const char *name, xar_t sourcearchive, xar_file_t sourcefile);
+
+int32_t xar_extract(xar_t x, xar_file_t f);
+int32_t xar_extract_tofile(xar_t x, xar_file_t f, const char *path);
+int32_t xar_extract_tobuffer(xar_t x, xar_file_t f, char **buffer);
+int32_t xar_extract_tobuffersz(xar_t x, xar_file_t f, char **buffer, size_t *size);
+int32_t xar_extract_tostream_init(xar_t x, xar_file_t f, xar_stream *stream);
+int32_t xar_extract_tostream(xar_stream *stream);
+int32_t xar_extract_tostream_end(xar_stream *stream);
+
+int32_t xar_verify(xar_t x, xar_file_t f);
+
+
+const char *xar_opt_get(xar_t x, const char *option);
+int32_t xar_opt_set(xar_t x, const char *option, const char *value);
+int32_t xar_opt_unset(xar_t x, const char *option);
+
+int32_t xar_prop_set(xar_file_t f, const char *key, const char *value);
+int32_t xar_prop_create(xar_file_t f, const char *key, const char *value);
+int32_t xar_prop_get(xar_file_t f, const char *key, const char **value);
+
+xar_iter_t xar_iter_new(void);
+void xar_iter_free(xar_iter_t i);
+
+const char *xar_prop_first(xar_file_t f, xar_iter_t i);
+const char *xar_prop_next(xar_iter_t i);
+
+void xar_prop_unset(xar_file_t f, const char *key);
+xar_file_t xar_file_first(xar_t x, xar_iter_t i);
+xar_file_t xar_file_next(xar_iter_t i);
+
+const char *xar_attr_get(xar_file_t f, const char *prop, const char *key);
+int32_t xar_attr_set(xar_file_t f, const char *prop, const char *key, const char *value);
+const char *xar_attr_first(xar_file_t f, const char *prop, xar_iter_t i);
+const char *xar_attr_next(xar_iter_t i);
+
+xar_subdoc_t xar_subdoc_new(xar_t x, const char *name);
+int32_t xar_subdoc_prop_set(xar_subdoc_t s, const char *key, const char *value);
+int32_t xar_subdoc_prop_get(xar_subdoc_t s, const char *key, const char **value);
+int32_t xar_subdoc_attr_set(xar_subdoc_t s, const char *prop, const char *key, const char *value);
+const char *xar_subdoc_attr_get(xar_subdoc_t s, const char *prop, const char *key);
+xar_subdoc_t xar_subdoc_first(xar_t x);
+xar_subdoc_t xar_subdoc_next(xar_subdoc_t s);
+const char *xar_subdoc_name(xar_subdoc_t s);
+int32_t xar_subdoc_copyout(xar_subdoc_t s, unsigned char **, unsigned int *);
+int32_t xar_subdoc_copyin(xar_subdoc_t s, const unsigned char *, unsigned int);
+void xar_subdoc_remove(xar_subdoc_t s);
+
+/* signature api for adding various signature types */
+xar_signature_t xar_signature_new(xar_t x,const char *type, int32_t length, xar_signer_callback callback, void *callback_context);
+/* extended signatures are ignored by previous versions of xar */
+xar_signature_t xar_signature_new_extended(xar_t x,const char *type, int32_t length, xar_signer_callback callback, void *callback_context);
+
+const char *xar_signature_type(xar_signature_t s);
+
+xar_signature_t xar_signature_first(xar_t x);
+xar_signature_t xar_signature_next(xar_signature_t s);
+
+int32_t xar_signature_add_x509certificate(xar_signature_t sig, const uint8_t *cert_data, uint32_t cert_len );
+
+int32_t xar_signature_get_x509certificate_count(xar_signature_t sig);
+int32_t xar_signature_get_x509certificate_data(xar_signature_t sig, int32_t index, const uint8_t **cert_data, uint32_t *cert_len);
+
+uint8_t xar_signature_copy_signed_data(xar_signature_t sig, uint8_t **data, uint32_t *length, uint8_t **signed_data, uint32_t *signed_length, off_t *signed_offset);
+
+/* Helper functions - caller must free returned memory */
+char *xar_get_size(xar_t x, xar_file_t f);
+char *xar_get_type(xar_t x, xar_file_t f);
+char *xar_get_mode(xar_t x, xar_file_t f);
+char *xar_get_owner(xar_t x, xar_file_t f);
+char *xar_get_group(xar_t x, xar_file_t f);
+char *xar_get_mtime(xar_t x, xar_file_t f);
+
+/* For helping calling apps harden against hacked archives that attempt to escape their extraction roots. */
+int xar_path_issane(char* path);
+
+/* These are for xar modules and should never be needed from a calling app */
+void xar_register_errhandler(xar_t x, err_handler callback, void *usrctx);
+xar_t xar_err_get_archive(xar_errctx_t ctx);
+xar_file_t xar_err_get_file(xar_errctx_t ctx);
+const char *xar_err_get_string(xar_errctx_t ctx);
+int xar_err_get_errno(xar_errctx_t ctx);
+void xar_err_set_file(xar_t x, xar_file_t f);
+void xar_err_set_formatted_string(xar_t x, const char *format, ...);
+void xar_err_set_string(xar_t x, const char *str);
+void xar_err_set_errno(xar_t x, int e);
+void xar_err_new(xar_t x);
+int32_t xar_err_callback(xar_t x, int32_t sev, int32_t err);
+
+void xar_serialize(xar_t x, const char *file);
+char *xar_get_path(xar_file_t f);
+off_t	xar_get_heap_offset(xar_t x);
+uint64_t xar_ntoh64(uint64_t num);
+
+#endif /* _XAR_H_ */
diff -Nur cctools-877.5/ld/4byte_literals.c cctools-877.5-AnV/ld/4byte_literals.c
--- cctools-877.5/ld/4byte_literals.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/4byte_literals.c	2015-11-19 09:03:08 +0000
@@ -31,6 +31,7 @@
  * 4 bytes in all input files.
  */
 #include <stdlib.h>
+#include "../include/stuff/macosx_deployment_target.h"
 #if !(defined(KLD) && defined(__STATIC__))
 #include <stdio.h>
 #include <mach/mach.h>
diff -Nur cctools-877.5/ld/8byte_literals.c cctools-877.5-AnV/ld/8byte_literals.c
--- cctools-877.5/ld/8byte_literals.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/8byte_literals.c	2015-11-19 09:03:08 +0000
@@ -31,6 +31,7 @@
  * 8 bytes in all input files.
  */
 #include <stdlib.h>
+#include "../include/stuff/macosx_deployment_target.h"
 #if !(defined(KLD) && defined(__STATIC__))
 #include <stdio.h>
 #include <mach/mach.h>
diff -Nur cctools-877.5/ld/Makefile cctools-877.5-AnV/ld/Makefile
--- cctools-877.5/ld/Makefile	2013-12-10 19:28:11 +0000
+++ cctools-877.5-AnV/ld/Makefile	2015-11-19 09:03:08 +0000
@@ -1,6 +1,7 @@
+CC=clang
 export USE_APPLE_PB_SUPPORT = all
 RC_OS = macos
-OFLAG = -Os
+OFLAG = -Ofast
 ifneq "$(RC_MAJOR_RELEASE_TRAIN)" "Tiger"
 KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
        -msoft-float -nostdinc \
@@ -32,13 +33,13 @@
 
 ifneq "" "$(SDKROOT)"
   SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
   LIBTOOL = $(shell xcrun -find -sdk $(SDKROOT) libtool)
   RANLIB = $(shell xcrun -find -sdk $(SDKROOT) ranlib)
   NMEDIT = $(shell xcrun -find -sdk $(SDKROOT) nmedit)
   SEG_HACK = $(shell xcrun -find -sdk $(SDKROOT) seg_hack)
 endif
-CFLAGS = -g -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) -Wall \
+
+CFLAGS = -arch i386 -arch x86_64 -g0 -I/usr/include/c++/4.2.1 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) -Wall \
 	 $(GCC_FLAGS) $(SDK)
 
 ifeq "macos" "$(RC_OS)"
@@ -88,12 +89,12 @@
 	 4byte_literals.c 8byte_literals.c literal_pointers.c dylibs.c \
 	 indirect_sections.c mod_sections.c i860_reloc.c ppc_reloc.c \
 	 m88k_reloc.c hppa_reloc.c sparc_reloc.c coalesced_sections.c uuid.c \
-	 debugcompunit.c debugline.c arm_reloc.c
+	 debugcompunit.c debugline.c arm_reloc.c map_fd.c
 OBJS = $(CFILES:.c=.o)
 INSTALL_FILES = $(CFILES) $(HFILES) Makefile notes \
 		librld.ofileList
 
-all:	$(OFILE_DIRS) $(SYMROOT) ld_build kld_build lib_ofiles
+all:	$(OFILE_DIRS) $(SYMROOT) ld_build # lib_ofiles kld_build
 
 macos_lib_ofiles:
 
diff -Nur cctools-877.5/ld/arm_reloc.c cctools-877.5-AnV/ld/arm_reloc.c
--- cctools-877.5/ld/arm_reloc.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/arm_reloc.c	2015-11-19 09:03:08 +0000
@@ -368,7 +368,7 @@
 		 */
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 
 		/*
 		 * If we are being called only to get the references for this
diff -Nur cctools-877.5/ld/coalesced_sections.c cctools-877.5-AnV/ld/coalesced_sections.c
--- cctools-877.5/ld/coalesced_sections.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/coalesced_sections.c	2015-11-19 09:03:08 +0000
@@ -616,7 +616,7 @@
 		 */
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 		/*
 		 * Is the merged symbol for this external relocation entry
 		 * defined in the output file.
diff -Nur cctools-877.5/ld/cstring_literals.c cctools-877.5-AnV/ld/cstring_literals.c
--- cctools-877.5/ld/cstring_literals.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/cstring_literals.c	2015-11-19 09:03:08 +0000
@@ -31,6 +31,7 @@
  * like: "foo\0bar" can not be in this type of section.
  */
 #include <stdlib.h>
+#include "../include/stuff/macosx_deployment_target.h"
 #if !(defined(KLD) && defined(__STATIC__))
 #include <stdio.h>
 #include <limits.h>
diff -Nur cctools-877.5/ld/dylibs.c cctools-877.5-AnV/ld/dylibs.c
--- cctools-877.5/ld/dylibs.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/dylibs.c	2015-11-19 09:03:08 +0000
@@ -20,6 +20,7 @@
  * 
  * @APPLE_LICENSE_HEADER_END@
  */
+#include "../include/stuff/macosx_deployment_target.h"
 #if !(defined(KLD) && defined(__STATIC__))
 #include <stdio.h>
 #include <mach/mach.h>
diff -Nur cctools-877.5/ld/fvmlibs.c cctools-877.5-AnV/ld/fvmlibs.c
--- cctools-877.5/ld/fvmlibs.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/fvmlibs.c	2015-11-19 09:03:08 +0000
@@ -28,6 +28,7 @@
  * This file contains the routines to manage the fixed VM shared libraries
  * that the output file uses.
  */
+#include "../include/stuff/macosx_deployment_target.h"
 #include <stdio.h>
 #include <stdarg.h>
 #include <strings.h>
diff -Nur cctools-877.5/ld/generic_reloc.c cctools-877.5-AnV/ld/generic_reloc.c
--- cctools-877.5/ld/generic_reloc.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/generic_reloc.c	2015-11-19 09:03:08 +0000
@@ -27,6 +27,7 @@
  * This file contains the routines to do generic relocation.  Which can be used
  * for such machines that have simple 1, 2, and 4 byte relocation lengths.
  */
+#include "../include/stuff/macosx_deployment_target.h"
 #if !(defined(KLD) && defined(__STATIC__))
 #include <stdio.h>
 #include <mach/mach.h>
@@ -366,7 +367,7 @@
 		 */
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 
 		/*
 		 * If we are being called only to get the references for this
diff -Nur cctools-877.5/ld/generic_reloc.h cctools-877.5-AnV/ld/generic_reloc.h
--- cctools-877.5/ld/generic_reloc.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/generic_reloc.h	2015-11-19 09:03:08 +0000
@@ -24,6 +24,13 @@
 #define __private_extern__ __declspec(private_extern)
 #endif
 
+#include "../include/stuff/bytesex.h"
+#include "../include/stuff/arch.h"
+#include "../include/stuff/macosx_deployment_target.h"
+
+#undef SWAP_LONG
+#define SWAP_LONG OSSwapInt32
+
 /*
  * Global types, variables and routines declared in the file generic_reloc.c.
  *
diff -Nur cctools-877.5/ld/hppa_reloc.c cctools-877.5-AnV/ld/hppa_reloc.c
--- cctools-877.5/ld/hppa_reloc.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/hppa_reloc.c	2015-11-19 09:03:08 +0000
@@ -380,7 +380,7 @@
 		 */
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 		/*
 		 * If the symbol is undefined (or common) or a global coalesced 
 		 * symbol where we need to force an external relocation entry
diff -Nur cctools-877.5/ld/i860_reloc.c cctools-877.5-AnV/ld/i860_reloc.c
--- cctools-877.5/ld/i860_reloc.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/i860_reloc.c	2015-11-19 09:03:08 +0000
@@ -366,7 +366,7 @@
 		 */
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 		/*
 		 * If the symbol is undefined (or common) or a global coalesced 
 		 * symbol where we need to force an external relocation entry
diff -Nur cctools-877.5/ld/indirect_sections.c cctools-877.5-AnV/ld/indirect_sections.c
--- cctools-877.5/ld/indirect_sections.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/indirect_sections.c	2015-11-19 09:03:08 +0000
@@ -28,6 +28,7 @@
  * lazy and non-lazy symbol pointer sections as well as symbol stub sections). 
  */
 #include <stdlib.h>
+#include "../include/stuff/macosx_deployment_target.h"
 #if !(defined(KLD) && defined(__STATIC__))
 #include <stdio.h>
 #include <mach/mach.h>
@@ -273,7 +274,7 @@
 		 */
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 		/*
 		 * If the indirect symbol table entry is for a private extern
 		 * it is an error.
@@ -386,7 +387,7 @@
 		    }
 		    if(indr_symbol == NULL)
 			indr_symbol = (struct merged_symbol *)
-				(merged_symbol->nlist.n_value);
+				(uint64_t)(merged_symbol->nlist.n_value);
 		    merged_symbol = indr_symbol;
 		}
 
@@ -744,7 +745,7 @@
 		 */
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 		/*
 		 * For multi module dynamic shared library format files the
 		 * merged sections that could have had external relocation
diff -Nur cctools-877.5/ld/layout.c cctools-877.5-AnV/ld/layout.c
--- cctools-877.5/ld/layout.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/layout.c	2015-11-19 09:03:08 +0000
@@ -39,6 +39,8 @@
  * set up.
  */
 #include <stdlib.h>
+#include <stdint.h>
+#include <wchar.h>
 #if !(defined(KLD) && defined(__STATIC__))
 #include <stdio.h>
 #include <mach/mach.h>
diff -Nur cctools-877.5/ld/ld.c cctools-877.5-AnV/ld/ld.c
--- cctools-877.5/ld/ld.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/ld.c	2015-11-19 09:03:08 +0000
@@ -858,6 +858,8 @@
 				  "decimal number less than 32", argv[i]);
 		    }
 #endif /* DEBUG */
+            else if(strcmp(p, "demangle") == 0){
+            }
 		    else
 			goto unknown_flag;
 		    break;
@@ -2059,12 +2061,13 @@
 	 * the handling of the cpusubtypes.
 	 */
 	if(arch_flag.name != NULL){
-
+#if 0
 	    /*
 	     * 64-bit architectures are an error.
 	     */
 	    if(arch_flag.cputype & CPU_ARCH_ABI64)
 		fatal("does not support 64-bit architectures");
+#endif
 
 	    family_arch_flag = get_arch_family_from_cputype(arch_flag.cputype);
 	    if(family_arch_flag == NULL)
@@ -2920,7 +2923,8 @@
 		       strcmp(p, "dylib") == 0 ||
 		       strcmp(p, "dylinker") == 0 ||
 		       strcmp(p, "dynamic") == 0 ||
-		       strcmp(p, "dead_strip") == 0)
+		       strcmp(p, "dead_strip") == 0 ||
+               strcmp(p, "demangle") == 0)
 			break;
 		    i++;
 		    break;
@@ -2959,6 +2963,7 @@
 	    }
 	}
 
+#if 0
  	/*
 	 * If the architecture was not specified, and was inferred
 	 * from the object files, if it is a 64-bit architecture it is an error.
@@ -2967,6 +2972,7 @@
 	    arch_flag.cputype & CPU_ARCH_ABI64){
 	    fatal("does not support 64-bit architectures");
 	}
+#endif
 
 	/*
 	 * Now search the libraries on the dynamic shared libraries search list
@@ -3138,7 +3144,9 @@
     kern_return_t r;
     struct stat stat_buf;
     unsigned long j, file_size, line;
-    char *file_name, *library_name, *file_addr, *name, *end;
+    char *file_name = NULL, *library_name = NULL, *file_addr = NULL, *name = NULL, *end = NULL;
+
+    stat_buf.st_size = 0;
 
 	/*
 	 * If there is no file name then it is not on the list and return FALSE.
diff -Nur cctools-877.5/ld/ld.h cctools-877.5-AnV/ld/ld.h
--- cctools-877.5/ld/ld.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/ld.h	2015-11-19 09:03:08 +0000
@@ -24,6 +24,14 @@
 #define __private_extern__ __declspec(private_extern)
 #endif
 
+#if defined(__APPLE__)
+#undef __private_extern__
+#define __private_extern__
+#endif
+
+#include "../include/stuff/bytesex.h"
+#include "../include/stuff/arch.h"
+#include "../include/stuff/macosx_deployment_target.h"
 /*
  * Global types, variables and routines declared in the file ld.c.
  *
@@ -92,7 +100,12 @@
 /* the pagesize of the machine this program is running on, getpagesize() value*/
 __private_extern__ unsigned long host_pagesize;
 /* the byte sex of the machine this program is running on */
+
+#ifndef _MACH_O_SWAP_H_
 __private_extern__ enum byte_sex host_byte_sex;
+#else
+__private_extern__ enum NXByteOrder host_byte_sex;
+#endif
 
 /* name of output file */
 __private_extern__ char *outputfile;
diff -Nur cctools-877.5/ld/literal_pointers.c cctools-877.5-AnV/ld/literal_pointers.c
--- cctools-877.5/ld/literal_pointers.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/literal_pointers.c	2015-11-19 09:03:08 +0000
@@ -37,6 +37,7 @@
  * all input files.
  */
 #include <stdlib.h>
+#include "../include/stuff/macosx_deployment_target.h"
 #if !(defined(KLD) && defined(__STATIC__))
 #include <stdio.h>
 #include <mach/mach.h>
@@ -380,7 +381,7 @@
 	     */
 	    if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		merged_symbol = (struct merged_symbol *)
-				merged_symbol->nlist.n_value;
+				(uint64_t)merged_symbol->nlist.n_value;
 	    /*
 	     * If the symbol is a common symbol it is an error
 	     * because it not a pointer to a literal.
diff -Nur cctools-877.5/ld/m88k_reloc.c cctools-877.5-AnV/ld/m88k_reloc.c
--- cctools-877.5/ld/m88k_reloc.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/m88k_reloc.c	2015-11-19 09:03:08 +0000
@@ -369,7 +369,7 @@
 		 */
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 		/*
 		 * If the symbol is undefined (or common) or a global coalesced 
 		 * symbol where we need to force an external relocation entry
diff -Nur cctools-877.5/ld/map_fd.c cctools-877.5-AnV/ld/map_fd.c
--- cctools-877.5/ld/map_fd.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/map_fd.c	2015-11-19 09:03:08 +0000
@@ -0,0 +1,31 @@
+#include <mach/mach.h>
+#include <mach/mach_error.h>
+#include <stdlib.h>
+#include <stdio.h>
+#include <unistd.h>
+#include <sys/types.h>
+#include <sys/mman.h>
+#include <sys/attr.h>
+#include <errno.h>
+
+kern_return_t map_fd(int fd,
+                     vm_offset_t offset,
+                     vm_offset_t *va,
+                     boolean_t findspace,
+                     vm_size_t size)
+{
+
+  void *addr = NULL;
+
+  addr = mmap(0, size, PROT_READ|PROT_WRITE,
+	      MAP_PRIVATE|MAP_FILE, fd, offset);
+
+  if(addr == (void *)-1) {
+    return 1;
+  }
+
+  *va = (vm_offset_t)addr;
+
+  return 0;
+}
+
diff -Nur cctools-877.5/ld/mod_sections.c cctools-877.5-AnV/ld/mod_sections.c
--- cctools-877.5/ld/mod_sections.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/mod_sections.c	2015-11-19 09:03:09 +0000
@@ -28,6 +28,7 @@
  * termination function pointer sections. 
  */
 #include <stdlib.h>
+#include "../include/stuff/macosx_deployment_target.h"
 #if !(defined(KLD) && defined(__STATIC__))
 #include <stdio.h>
 #include <mach/mach.h>
diff -Nur cctools-877.5/ld/objects.c cctools-877.5-AnV/ld/objects.c
--- cctools-877.5/ld/objects.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/objects.c	2015-11-19 09:03:09 +0000
@@ -32,6 +32,7 @@
 #include <stdio.h>
 #include <limits.h>
 #include <mach/mach.h>
+#include "../include/stuff/macosx_deployment_target.h"
 #else /* defined(KLD) && defined(__STATIC__) */
 #include <mach/mach.h>
 #include <mach/kern_return.h>
@@ -426,7 +427,7 @@
 		    merged_symbol = fine_reloc->merged_symbol;
 		    if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 			merged_symbol = (struct merged_symbol *)
-					merged_symbol->nlist.n_value;
+					(uint64_t)merged_symbol->nlist.n_value;
 		    return(merged_symbol->nlist.n_value);
 		}
 	    }
@@ -448,7 +449,7 @@
 		merged_symbol = fine_reloc->merged_symbol;
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 		return(merged_symbol->nlist.n_value);
 	    }
 	}
@@ -464,7 +465,7 @@
 		    merged_symbol = fine_reloc->merged_symbol;
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 		return(merged_symbol->nlist.n_value);
 	    }
 	    else{
@@ -531,7 +532,7 @@
 		    merged_symbol = fine_reloc->merged_symbol;
 		    if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 			merged_symbol = (struct merged_symbol *)
-					merged_symbol->nlist.n_value;
+					(uint64_t)merged_symbol->nlist.n_value;
 		    ref->ref_type = LIVE_REF_SYMBOL;
 		    ref->merged_symbol = merged_symbol;
 		    return;
@@ -555,7 +556,7 @@
 		merged_symbol = fine_reloc->merged_symbol;
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 		ref->ref_type = LIVE_REF_SYMBOL;
 		ref->merged_symbol = merged_symbol;
 		return;
@@ -573,7 +574,7 @@
 		    merged_symbol = fine_reloc->merged_symbol;
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 		ref->ref_type = LIVE_REF_SYMBOL;
 		ref->merged_symbol = merged_symbol;
 		return;
@@ -713,7 +714,7 @@
 	    merged_symbol = fine_reloc->merged_symbol;
 	    if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		merged_symbol = (struct merged_symbol *)
-				merged_symbol->nlist.n_value;
+				(uint64_t)merged_symbol->nlist.n_value;
 	    return(merged_symbol->nlist.n_sect);
 	}
 	else{
diff -Nur cctools-877.5/ld/pass1.c cctools-877.5-AnV/ld/pass1.c
--- cctools-877.5/ld/pass1.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/pass1.c	2015-11-19 09:03:09 +0000
@@ -23,12 +23,16 @@
 #ifdef SHLIB
 #include "shlib.h"
 #endif /* SHLIB */
+
+#include "ld.h"
+
 /*
  * This file contains the routines that drives pass1 of the link-editor.  In
  * pass1 the objects needed from archives are selected for loading and all of
  * the things that need to be merged from the input objects are merged into
  * tables (for output and relocation on the second pass).
  */
+#include <mach-o/swap.h>
 #include <stdlib.h>
 #include <stdarg.h>
 #include <string.h>
@@ -61,7 +65,6 @@
 #include "stuff/guess_short_name.h"
 #include "stuff/macosx_deployment_target.h"
 
-#include "ld.h"
 #include "pass1.h"
 #include "live_refs.h"
 #include "objects.h"
@@ -93,10 +96,10 @@
 __private_extern__ unsigned long nld_library_paths = 0;
 
 /* the standard directories to search for -lx names */
-__private_extern__ char *standard_dirs[] = {
-    "/lib/",
-    "/usr/lib/",
-    "/usr/local/lib/",
+__private_extern__ char *standard_dirs[4] = {
+    (char *)"/lib/",
+    (char *)"/usr/lib/",
+    (char *)"/usr/local/lib/",
     NULL
 };
 
@@ -108,20 +111,20 @@
 __private_extern__ unsigned long nframework_dirs = 0;
 
 /* the standard framework directories to search for "-framework Foo" names */
-__private_extern__ char *standard_framework_dirs[] = {
+__private_extern__ char *standard_framework_dirs[FDIRCNT] = {
 #ifdef __OPENSTEP__
-    "/LocalLibrary/Frameworks/",
-    "/NextLibrary/Frameworks/",
+    (char *)"/LocalLibrary/Frameworks/",
+    (char *)"/NextLibrary/Frameworks/",
 #else /* !defined(__OPENSTEP__) */
 
 #ifdef __GONZO_BUNSEN_BEAKER__
-    "/Local/Library/Frameworks/",
+    (char *)"/Local/Library/Frameworks/",
 #else /* !defined(__BUNSEN_BEAKER__) */
-    "/Library/Frameworks/",
+    (char *)"/Library/Frameworks/",
 #endif /* __BUNSEN_BEAKER__ */
 
-    "/Network/Library/Frameworks/",
-    "/System/Library/Frameworks/",
+    (char *)"/Network/Library/Frameworks/",
+    (char *)"/System/Library/Frameworks/",
 #endif /* __OPENSTEP__ */
     NULL
 };
@@ -926,6 +929,7 @@
 	    }
 	    if(fat_archs[i].offset %
 	       (1 << fat_archs[i].align) != 0){
+#if 0
 		if(ar_name != NULL)
 		    error("fat file: %s(%.*s) offset: %u for cputype (%d) "
 			  "cpusubtype (%d)) not aligned on it's alignment "
@@ -938,7 +942,9 @@
 			  "(2^%u)", file_name, fat_archs[i].offset,
 			  fat_archs[i].cputype, fat_archs[i].cpusubtype,
 			  fat_archs[i].align);
-		return;
+#endif
+
+            return;
 	    }
 	}
 	for(i = 0; i < fat_header->nfat_arch; i++){
@@ -1386,6 +1392,7 @@
 	     * 68k machines but will have to change when this is on a real
 	     * machine.
 	     */
+#if 0
 #if defined(mc68000) || defined(__i386__)
 	    if(ranlibs[i].ran_off % sizeof(short) != 0){
 		error("malformed table of contents in: %s (ranlib struct %lu "
@@ -1401,6 +1408,7 @@
 		return;
 	    }
 #endif
+#endif
 	}
 
 #ifndef RLD
@@ -4513,11 +4521,13 @@
 	    l = *lc;
 	    if(cur_obj->swapped)
 		swap_load_command(&l, host_byte_sex);
+#if 0
 	    if(l.cmdsize % sizeof(long) != 0){
 		error_with_cur_obj("load command %lu size not a multiple of "
 				   "sizeof(long)", i);
 		return;
 	    }
+#endif
 	    if(l.cmdsize <= 0){
 		error_with_cur_obj("load command %lu size is less than or equal"
 				   " to zero", i);
@@ -5602,11 +5612,13 @@
 	dyst = NULL;
 	lc = load_commands;
 	for(i = 0; i < mh->ncmds; i++){
+#if 0
 	    if(lc->cmdsize % sizeof(long) != 0){
 		error_with_cur_obj("load command %lu size not a multiple of "
 				   "sizeof(long)", i);
 		return;
 	    }
+#endif
 	    if(lc->cmdsize <= 0){
 		error_with_cur_obj("load command %lu size is less than or equal"
 				   " to zero", i);
@@ -5836,6 +5848,7 @@
 unsigned long cmd)
 {
 	if(size != 0){
+#if 0
 	    if(offset % align != 0){
 #ifdef mc68000
 		/*
@@ -5850,6 +5863,11 @@
 #endif /* mc68000 */
 		return;
 	    }
+#else
+        if(offset % align != 0){
+            align = 1;
+        }
+#endif
 	    if(offset > cur_obj->obj_size){
 		error_with_cur_obj("%s in load command %lu extends past the "
 				   "end of the file", offset_str, cmd);
@@ -5883,6 +5901,7 @@
 char *sectname)
 {
 	if(size != 0){
+#if 0
 	    if(offset % align != 0){
 #ifdef mc68000
 		/*
@@ -5899,6 +5918,11 @@
 #endif /* mc68000 */
 		return;
 	    }
+#else
+        if(offset % align != 0){
+            align = 1;
+        }
+#endif
 	    if(offset > cur_obj->obj_size){
 		error_with_cur_obj("%s of section %lu (%.16s,%.16s) in load "
 		    "command %lu extends past the end of the file", offset_str,
diff -Nur cctools-877.5/ld/pass1.h cctools-877.5-AnV/ld/pass1.h
--- cctools-877.5/ld/pass1.h	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/pass1.h	2015-11-19 09:03:09 +0000
@@ -48,7 +48,7 @@
 __private_extern__ unsigned long nld_library_paths;
 
 /* the standard directories to search for -lx filenames */
-__private_extern__ char *standard_dirs[];
+__private_extern__ char *standard_dirs[4];
 
 /*
  * The user specified directories to search for "-framework Foo" names, and the
@@ -58,7 +58,13 @@
 __private_extern__ unsigned long nframework_dirs;
 
 /* the standard framework directories to search for "-framework Foo" names */
-__private_extern__ char *standard_framework_dirs[];
+#ifdef __OPENSTEP__
+#define FDIRCNT 3
+#else
+#define FDIRCNT 4
+#endif
+
+__private_extern__ char *standard_framework_dirs[FDIRCNT];
 
 /* the pointer to the head of the base object file's segments */
 __private_extern__ struct merged_segment *base_obj_segments;
diff -Nur cctools-877.5/ld/ppc_reloc.c cctools-877.5-AnV/ld/ppc_reloc.c
--- cctools-877.5/ld/ppc_reloc.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/ppc_reloc.c	2015-11-19 09:03:09 +0000
@@ -403,7 +403,7 @@
 		 */
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 
 		/*
 		 * If we are being called only to get the references for this
diff -Nur cctools-877.5/ld/rld.c cctools-877.5-AnV/ld/rld.c
--- cctools-877.5/ld/rld.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/rld.c	2015-11-19 09:03:09 +0000
@@ -59,8 +59,8 @@
 #include <mach-o/kld.h>
 #else /* !defined(KLD) */
 #include <mach-o/rld.h>
-#include <streams/streams.h>
-#include <objc/zone.h>
+//#include <streams/streams.h>
+//#include <objc/zone.h>
 #endif /* KLD */
 #include <mach-o/rld_state.h>
 #include <mach-o/ldsyms.h>
diff -Nur cctools-877.5/ld/sections.c cctools-877.5-AnV/ld/sections.c
--- cctools-877.5/ld/sections.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/sections.c	2015-11-19 09:03:09 +0000
@@ -30,6 +30,7 @@
  * them).  The merged section list becomes the output files's section list.
  */
 #include <stdlib.h>
+#include "../include/stuff/macosx_deployment_target.h"
 #if !(defined(KLD) && defined(__STATIC__))
 #include <stdio.h>
 #include <mach/mach.h>
@@ -1274,8 +1275,8 @@
 			error_with_cur_obj("can't use -sectorder or -dead_strip"
 			    " with objects that contain more than one section "
 			    "with the same name (section %d and %ld are both "
-			    "named (%.16s,%.16s))", cur_obj->cur_section_map -
-			    cur_obj->section_maps + 1, j + 1, ms->s.segname,
+			    "named (%.16s,%.16s))", (int)(cur_obj->cur_section_map -
+			    cur_obj->section_maps + 1), j + 1, ms->s.segname,
 			    ms->s.sectname);
 			return;
 		    }
@@ -3525,7 +3526,7 @@
 		if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR &&
 		   merged_symbol->defined_in_dylib == FALSE)
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 		if(merged_symbol->nlist.n_type == (N_EXT | N_UNDF) ||
 		   merged_symbol->nlist.n_type == (N_EXT | N_PBUD) ||
 		   (merged_symbol->nlist.n_type == (N_EXT | N_INDR) &&
@@ -4321,7 +4322,7 @@
 				merged_symbol = undefined_map->merged_symbol;
 			    if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 				merged_symbol = (struct merged_symbol *)
-						merged_symbol->nlist.n_value;
+						(uint64_t)merged_symbol->nlist.n_value;
 			    value = merged_symbol->nlist.n_value;
 			    if((merged_symbol->nlist.n_desc & N_ARM_THUMB_DEF))
 				value |= 1;
@@ -4443,7 +4444,7 @@
 			    merged_symbol = undefined_map->merged_symbol;
 			if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 			    merged_symbol = (struct merged_symbol *)
-					    merged_symbol->nlist.n_value;
+					    (uint64_t)merged_symbol->nlist.n_value;
 			value = merged_symbol->nlist.n_value;
 			if((merged_symbol->nlist.n_desc & N_ARM_THUMB_DEF))
 			    value |= 1;
@@ -5799,7 +5800,7 @@
 	/* N_INDR symbols have had their indirection resolved at this point. */
 	if((merged_symbol->nlist.n_type & N_TYPE) == N_INDR)
 	    merged_symbol = (struct merged_symbol *)
-			    merged_symbol->nlist.n_value;
+			    (uint64_t)merged_symbol->nlist.n_value;
 
 	/*
 	 * Find the fine_reloc for this symbol if any.  That will be in the
@@ -6207,7 +6208,7 @@
 		ref->merged_symbol->live = TRUE;
 		if((ref->merged_symbol->nlist.n_type & N_TYPE) == N_INDR){
 		    indr_merged_symbol = (struct merged_symbol *)
-				    ref->merged_symbol->nlist.n_value;
+				    (uint64_t)ref->merged_symbol->nlist.n_value;
 		    indr_merged_symbol->live = TRUE;
 		}
 	    }
diff -Nur cctools-877.5/ld/sparc_reloc.c cctools-877.5-AnV/ld/sparc_reloc.c
--- cctools-877.5/ld/sparc_reloc.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/sparc_reloc.c	2015-11-19 09:03:09 +0000
@@ -381,7 +381,7 @@
 		 */
 		if(merged_symbol->nlist.n_type == (N_EXT | N_INDR))
 		    merged_symbol = (struct merged_symbol *)
-				    merged_symbol->nlist.n_value;
+				    (uint64_t)merged_symbol->nlist.n_value;
 		/*
 		 * If the symbol is undefined (or common) or a global coalesced 
 		 * symbol where we need to force an external relocation entry
diff -Nur cctools-877.5/ld/specs.c cctools-877.5-AnV/ld/specs.c
--- cctools-877.5/ld/specs.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/specs.c	2015-11-19 09:03:09 +0000
@@ -27,6 +27,7 @@
  * This file contains the routines to manage the structures that hold the
  * command line specifications about segment and sections.
  */
+#include "../include/stuff/macosx_deployment_target.h"
 #if !(defined(KLD) && defined(__STATIC__))
 #include <stdlib.h>
 #include <stdio.h>
diff -Nur cctools-877.5/ld/symbols.c cctools-877.5-AnV/ld/symbols.c
--- cctools-877.5/ld/symbols.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/ld/symbols.c	2015-11-19 09:03:09 +0000
@@ -459,7 +459,7 @@
     unsigned long section_type, library_ordinal;
 
 	/* check the n_strx field of this symbol */
-	if(symbol->n_un.n_strx < 0 ||
+	if(/*symbol->n_un.n_strx < 0 ||*/
 	   (uint32_t)symbol->n_un.n_strx >= cur_obj->symtab->strsize){
 	    error_with_cur_obj("bad string table index (%d) for symbol %lu",
 			       symbol->n_un.n_strx, index);
@@ -3938,7 +3938,7 @@
 
 	if(merged_symbol->nlist.n_type == (N_INDR | N_EXT))
 	    indr_symbol_name = ((struct merged_symbol *)
-			(merged_symbol->nlist.n_value))->nlist.n_un.n_name;
+			(uint64_t)(merged_symbol->nlist.n_value))->nlist.n_un.n_name;
 	else
 	    indr_symbol_name = "error in trace_symbol()";
 	trace_symbol(merged_symbol->nlist.n_un.n_name, &(merged_symbol->nlist),
@@ -4568,8 +4568,8 @@
 		    if(only_referenced_dynamically == TRUE)
 			continue;
 		}
+        mark_it_live:
 #ifdef DEBUG
-mark_it_live:
 		if(((debug & (1 << 25)) || (debug & (1 << 26)))){
 		    print("** In mark_globals_live() ");
 		    if(merged_symbol->nlist.n_desc & N_NO_DEAD_STRIP)
@@ -5559,7 +5559,7 @@
 		    indr_symbols[0] = merged_symbol;
 		    indr_depth = 1;
 		    indr_symbol = (struct merged_symbol *)
-						(merged_symbol->nlist.n_value);
+						(uint64_t)(merged_symbol->nlist.n_value);
 		    while(indr_symbol->nlist.n_type == (N_EXT | N_INDR) &&
 		          indr_symbol->nlist.n_value != 0){
 			for(j = 0; j < indr_depth; j++){
@@ -5573,7 +5573,7 @@
 				not_from_dylibs++;
 			    indr_symbols[indr_depth++] = indr_symbol;
 			    indr_symbol = (struct merged_symbol *)
-						(indr_symbol->nlist.n_value);
+						(uint64_t)(indr_symbol->nlist.n_value);
 			}
 			else{
 			    error("indirect symbol loop:");
@@ -6840,7 +6840,7 @@
 		    }
 		    if(indr_symbol == NULL)
 			indr_symbol = (struct merged_symbol *)
-				(merged_symbol->nlist.n_value);
+				(uint64_t)(merged_symbol->nlist.n_value);
 
 		    /*
 		     * Check to see if this symbol is defined (not undefined or
@@ -7724,7 +7724,7 @@
 			 * indr symbol.  Else make it an undefined symbol.
 			 */
 			indr_symbol = (struct merged_symbol *)
-				      (merged_symbol->nlist.n_value);
+				      (uint64_t)(merged_symbol->nlist.n_value);
 			if(indr_symbol->nlist.n_type != (N_EXT | N_UNDF)){
 			    merged_symbol->nlist.n_type = N_PBUD | N_EXT;
 			    merged_symbol->nlist.n_sect = NO_SECT;
@@ -7978,7 +7978,7 @@
 		else{
 		    if(merged_symbol->nlist.n_type == (N_EXT | N_INDR)){
 			indr_symbol = (struct merged_symbol *)
-				    (merged_symbol->nlist.n_value);
+				    (uint64_t)(merged_symbol->nlist.n_value);
 			n_pext = indr_symbol->nlist.n_type & N_PEXT;
 		    }
 		    else{
@@ -8044,7 +8044,7 @@
 		else{
 		    if(merged_symbol->nlist.n_type == (N_EXT | N_INDR)){
 			indr_symbol = (struct merged_symbol *)
-				    (merged_symbol->nlist.n_value);
+				    (uint64_t)(merged_symbol->nlist.n_value);
 			n_pext = indr_symbol->nlist.n_type & N_PEXT;
 		    }
 		    else{
@@ -8913,7 +8913,7 @@
 		    break;
 		case N_INDR:
 		    print("N_INDR for %s\n", ((struct merged_symbol *)
-				(nlist->n_value))->nlist.n_un.n_name);
+				(uint64_t)(nlist->n_value))->nlist.n_un.n_name);
 		    break;
 		default:
 		    print("unknown 0x%x\n", (unsigned int)(nlist->n_type));
diff -Nur cctools-877.5/libmacho/Makefile cctools-877.5-AnV/libmacho/Makefile
--- cctools-877.5/libmacho/Makefile	2015-01-08 02:29:57 +0000
+++ cctools-877.5-AnV/libmacho/Makefile	2015-11-19 09:03:09 +0000
@@ -1,3 +1,4 @@
+CC=clang
 LEGACY = -D_MACH_I386_THREAD_STATUS_FPSTATE_LEGACY_FIELD_NAMES_ \
 	 -D_ARCHITECTURE_I386_FPU_FPSTATE_LEGACY_FIELD_NAMES_
 
@@ -34,8 +35,8 @@
   RANLIB = ranlib
 endif
 
-OFLAG = -Os
-CFLAGS = $(OFLAG) -g -Wall $(LEGACY) \
+OFLAG = -Ofast
+CFLAGS = -arch i386 -arch x86_64 $(OFLAG) -g0 -Wall $(LEGACY) \
 	 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
 PG = -pg
 
@@ -300,7 +301,7 @@
 		-o $(SYMROOT)/$@ $(OBJS) \
 		-install_name $(INSTALL_NAME) \
 		-compatibility_version 1 \
-		-current_version $(RC_ProjectSourceVersion) \
+		-current_version 9 \
 		$(DEPENDENT_LIBS)
 	$(DSYMUTIL) $(SYMROOT)/$@
 
diff -Nur cctools-877.5/libmacho/dtmp_obj/libmacho.dylib.dSYM/Contents/Info.plist cctools-877.5-AnV/libmacho/dtmp_obj/libmacho.dylib.dSYM/Contents/Info.plist
--- cctools-877.5/libmacho/dtmp_obj/libmacho.dylib.dSYM/Contents/Info.plist	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/libmacho/dtmp_obj/libmacho.dylib.dSYM/Contents/Info.plist	2015-11-19 09:03:09 +0000
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
+<plist version="1.0">
+	<dict>
+		<key>CFBundleDevelopmentRegion</key>
+		<string>English</string>
+		<key>CFBundleIdentifier</key>
+		<string>com.apple.xcode.dsym.libmacho.dylib</string>
+		<key>CFBundleInfoDictionaryVersion</key>
+		<string>6.0</string>
+		<key>CFBundlePackageType</key>
+		<string>dSYM</string>
+		<key>CFBundleSignature</key>
+		<string>????</string>
+		<key>CFBundleShortVersionString</key>
+		<string>1.0</string>
+		<key>CFBundleVersion</key>
+		<string>1</string>
+	</dict>
+</plist>
diff -Nur cctools-877.5/libmacho/dtmp_obj/libmacho_debug.dylib.dSYM/Contents/Info.plist cctools-877.5-AnV/libmacho/dtmp_obj/libmacho_debug.dylib.dSYM/Contents/Info.plist
--- cctools-877.5/libmacho/dtmp_obj/libmacho_debug.dylib.dSYM/Contents/Info.plist	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/libmacho/dtmp_obj/libmacho_debug.dylib.dSYM/Contents/Info.plist	2015-11-19 09:03:09 +0000
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
+<plist version="1.0">
+	<dict>
+		<key>CFBundleDevelopmentRegion</key>
+		<string>English</string>
+		<key>CFBundleIdentifier</key>
+		<string>com.apple.xcode.dsym.libmacho_debug.dylib</string>
+		<key>CFBundleInfoDictionaryVersion</key>
+		<string>6.0</string>
+		<key>CFBundlePackageType</key>
+		<string>dSYM</string>
+		<key>CFBundleSignature</key>
+		<string>????</string>
+		<key>CFBundleShortVersionString</key>
+		<string>1.0</string>
+		<key>CFBundleVersion</key>
+		<string>1</string>
+	</dict>
+</plist>
diff -Nur cctools-877.5/libmacho/dynamic_obj/libmacho.ofileList cctools-877.5-AnV/libmacho/dynamic_obj/libmacho.ofileList
--- cctools-877.5/libmacho/dynamic_obj/libmacho.ofileList	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/libmacho/dynamic_obj/libmacho.ofileList	2015-11-19 09:03:09 +0000
@@ -0,0 +1,9 @@
+arch.o
+getsecbyname.o
+getsegbyname.o
+get_end.o
+swap.o
+i386_swap.o
+m68k_swap.o
+sparc_swap.o
+ppc_swap.o
diff -Nur cctools-877.5/libmacho/dynamic_profile_obj/libmacho.ofileList cctools-877.5-AnV/libmacho/dynamic_profile_obj/libmacho.ofileList
--- cctools-877.5/libmacho/dynamic_profile_obj/libmacho.ofileList	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/libmacho/dynamic_profile_obj/libmacho.ofileList	2015-11-19 09:03:09 +0000
@@ -0,0 +1,9 @@
+arch.o
+getsecbyname.o
+getsegbyname.o
+get_end.o
+swap.o
+i386_swap.o
+m68k_swap.o
+sparc_swap.o
+ppc_swap.o
diff -Nur cctools-877.5/libmacho/optimized_obj/libmacho.ofileList cctools-877.5-AnV/libmacho/optimized_obj/libmacho.ofileList
--- cctools-877.5/libmacho/optimized_obj/libmacho.ofileList	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/libmacho/optimized_obj/libmacho.ofileList	2015-11-19 09:03:09 +0000
@@ -0,0 +1,9 @@
+arch.o
+getsecbyname.o
+getsegbyname.o
+get_end.o
+swap.o
+i386_swap.o
+m68k_swap.o
+sparc_swap.o
+ppc_swap.o
diff -Nur cctools-877.5/libmacho/profile_obj/libmacho.ofileList cctools-877.5-AnV/libmacho/profile_obj/libmacho.ofileList
--- cctools-877.5/libmacho/profile_obj/libmacho.ofileList	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/libmacho/profile_obj/libmacho.ofileList	2015-11-19 09:03:09 +0000
@@ -0,0 +1,9 @@
+arch.o
+getsecbyname.o
+getsegbyname.o
+get_end.o
+swap.o
+i386_swap.o
+m68k_swap.o
+sparc_swap.o
+ppc_swap.o
diff -Nur cctools-877.5/libmacho/ptmp_obj/libmacho_profile.dylib.dSYM/Contents/Info.plist cctools-877.5-AnV/libmacho/ptmp_obj/libmacho_profile.dylib.dSYM/Contents/Info.plist
--- cctools-877.5/libmacho/ptmp_obj/libmacho_profile.dylib.dSYM/Contents/Info.plist	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/libmacho/ptmp_obj/libmacho_profile.dylib.dSYM/Contents/Info.plist	2015-11-19 09:03:09 +0000
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
+<plist version="1.0">
+	<dict>
+		<key>CFBundleDevelopmentRegion</key>
+		<string>English</string>
+		<key>CFBundleIdentifier</key>
+		<string>com.apple.xcode.dsym.libmacho_profile.dylib</string>
+		<key>CFBundleInfoDictionaryVersion</key>
+		<string>6.0</string>
+		<key>CFBundlePackageType</key>
+		<string>dSYM</string>
+		<key>CFBundleSignature</key>
+		<string>????</string>
+		<key>CFBundleShortVersionString</key>
+		<string>1.0</string>
+		<key>CFBundleVersion</key>
+		<string>1</string>
+	</dict>
+</plist>
diff -Nur cctools-877.5/libmacho/static_obj/libmacho.ofileList cctools-877.5-AnV/libmacho/static_obj/libmacho.ofileList
--- cctools-877.5/libmacho/static_obj/libmacho.ofileList	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/libmacho/static_obj/libmacho.ofileList	2015-11-19 09:03:10 +0000
@@ -0,0 +1,9 @@
+arch.o
+getsecbyname.o
+getsegbyname.o
+get_end.o
+swap.o
+i386_swap.o
+m68k_swap.o
+sparc_swap.o
+ppc_swap.o
diff -Nur cctools-877.5/libstuff/Makefile cctools-877.5-AnV/libstuff/Makefile
--- cctools-877.5/libstuff/Makefile	2013-12-10 19:28:11 +0000
+++ cctools-877.5-AnV/libstuff/Makefile	2015-11-19 09:59:39 +0000
@@ -1,262 +1,275 @@
-LEGACY = -D_MACH_I386_THREAD_STATUS_FPSTATE_LEGACY_FIELD_NAMES_ \
-	 -D_ARCHITECTURE_I386_FPU_FPSTATE_LEGACY_FIELD_NAMES_
-
-KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
-       -msoft-float -nostdinc \
--I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
--I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/libsa \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/bsd \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers \
-       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
-
-ifneq "" "$(SDKROOT)"
-  SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
-  LIBTOOL = $(shell xcrun -find -sdk $(SDKROOT) libtool)
-else
-  LIBTOOL = libtool
-endif
-
-OFLAG = -Os
-LTO = -DLTO_SUPPORT
-G = -g
-CFLAGS = $(OFLAG) $(LTO) $(G) -I$(SRCROOT)/../include -Wall $(LEGACY) $(SDK)
-PG = -pg
-
-MKDIRS = /bin/mkdir -p
-SRCROOT = .
-SYMROOT = .
-OBJROOT = .
-OFILE_DIRS = $(OBJROOT)/static_obj $(OBJROOT)/dynamic_obj \
-	     $(OBJROOT)/profile_obj $(OBJROOT)/shlib_obj \
-	     $(OBJROOT)/static_kld_obj
-OFILE_DIR = $(OBJROOT)
-VPATH = $(OFILE_DIR)
-
-ifeq "$(EFITOOLS)" "efitools"
-	COFF_BYTESEX = coff_bytesex.c
-else
-	COFF_BYTESEX =
-endif
-CFILES = allocate.c errors.c arch.c execute.c bytesex.c rnd.c hppa.c \
-	  swap_headers.c reloc.c version_number.c get_toc_byte_sex.c \
-	  best_arch.c fatals.c arch_usage.c ofile.c ofile_error.c print.c \
-	  set_arch_flag_name.c seg_addr_table.c dylib_table.c \
-	  breakout.c writeout.c checkout.c fatal_arch.c ofile_get_word.c \
-	  vm_flush_cache.c hash_string.c dylib_roots.c guess_short_name.c \
-	  SymLoc.c get_arch_from_host.c crc32.c macosx_deployment_target.c \
-	  symbol_list.c unix_standard_mode.c lto.c llvm.c $(COFF_BYTESEX)
-OBJS = $(CFILES:.c=.o) apple_version.o
-INSTALL_FILES = $(CFILES) Makefile notes
-
-ifeq "$(OLD_LIBKLD)" "YES"
-	STATIC_KLD = static_kld
-else
-	STATIC_KLD = 
-endif
-
-all: $(OFILE_DIRS) $(SYMROOT) dynamic profile $(STATIC_KLD)
-
-lib_static_ofiles: $(STATIC_KLD)
-
-lib_ofiles: $(OFILE_DIRS) $(SYMROOT) dynamic
-
-lib_ofiles_install: lib_ofiles
-
-static: $(OBJROOT)/static_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd static_obj;						\
-		$(MAKE) -f ../Makefile libstuff.a			\
-		PRODUCT=libstuff.a					\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		SYMROOT=..						\
-		COPTS="-static"						\
-		OFLAG="$(OFLAG)"					\
-		CFILES="$(CFILES)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	else								\
-	    cd $(OBJROOT)/static_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libstuff.a		\
-		PRODUCT=libstuff.a					\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/static_obj				\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="-static"						\
-		OFLAG="$(OFLAG)"					\
-		CFILES="$(CFILES)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	fi
-
-static_kld: $(OBJROOT)/static_kld_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd static_kld_obj;						\
-		$(MAKE) -f ../Makefile libstuff_kld.a			\
-		PRODUCT=libstuff_kld.a					\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		SYMROOT=..						\
-		COPTS="-static -DRLD -DSA_RLD $(KERN)"			\
-		OFLAG="$(OFLAG)"					\
-		CFILES="$(CFILES)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	else								\
-	    cd $(OBJROOT)/static_kld_obj;				\
-		$(MAKE) -f $(SRCROOT)/Makefile libstuff_kld.a		\
-		PRODUCT=libstuff_kld.a					\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/static_kld_obj			\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="-static -DRLD -DSA_RLD $(KERN)"			\
-		OFLAG="$(OFLAG)"					\
-		CFILES="$(CFILES)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	fi
-
-dynamic: $(OBJROOT)/dynamic_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd dynamic_obj;						\
-		$(MAKE) -f ../Makefile libstuff.dylib			\
-		PRODUCT=libstuff.dylib					\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		SYMROOT=..						\
-		COPTS="$(DYNAMIC)"					\
-		OFLAG="$(OFLAG)"					\
-		CFILES="$(CFILES)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	else								\
-	    cd $(OBJROOT)/dynamic_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libstuff.dylib		\
-		PRODUCT=libstuff.dylib					\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/dynamic_obj			\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="$(DYNAMIC)"					\
-		OFLAG="$(OFLAG)"					\
-		CFILES="$(CFILES)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	fi
-
-profile: $(OBJROOT)/profile_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd profile_obj;						\
-		$(MAKE) -f ../Makefile libstuff_p.a			\
-		PRODUCT=libstuff_p.a					\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		SYMROOT=..						\
-		COPTS="$(DYNAMIC) $(PG)"				\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	else								\
-	    cd $(OBJROOT)/profile_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libstuff_p.a		\
-		PRODUCT=libstuff_p.a					\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/profile_obj			\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="$(DYNAMIC) $(PG)"				\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	fi
-
-shlib: $(OBJROOT)/shlib_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd shlib_obj;						\
-		$(MAKE) -f ../Makefile libstuff_s.a			\
-		PRODUCT=libstuff_s.a					\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		SYMROOT=..						\
-		COPTS="-static -DSHLIB -I/LocalDeveloper/Headers/libsys" \
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	else								\
-	    cd $(OBJROOT)/shlib_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libstuff_s.a		\
-		PRODUCT=libstuff_s.a					\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/shlib_obj				\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="-static -DSHLIB -I/LocalDeveloper/Headers/libsys" \
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	fi
-
-$(PRODUCT):	$(OFILE_DIR) $(SYMROOT) $(OBJS)
-	$(LIBTOOL) -static -o $(SYMROOT)/$(PRODUCT) $(OBJS)
-
-apple_version.c:
-	echo "const char apple_version[]=" > $(OFILE_DIR)/$@
-	echo "\"cctools-$(RC_ProjectSourceVersion)\";" >> $(OFILE_DIR)/$@
-
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c -o $(OFILE_DIR)/$*.o $<
-
-lto.o: lto.c
-	$(CC) -std=c99 $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
-		-I/Developer/usr/local/include \
-		-I$(DT_TOOLCHAIN_DIR)/usr/local/include \
-		-o $(OFILE_DIR)/$*.o $<
-
-clean shlib_clean:
-	-rm -r -f $(OFILE_DIRS)
-	-rm -f libstuff.a libstuff.dylib libstuff_p.a libstuff_s.a
-
-install: all
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-installGASsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - Makefile bytesex.c rnd.c | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-fromGASsrc: $(OBJROOT)/dynamic_obj
-	@cd dynamic_obj;						\
-	    $(MAKE) -f ../Makefile libstuff.dylib			\
-	    PRODUCT=libstuff.dylib					\
-	    VPATH=.. 							\
-	    OFILE_DIR=.							\
-	    SRCROOT=..							\
-	    SYMROOT=..							\
-	    COPTS="$(DYNAMIC)"						\
-	    OFLAG="$(OFLAG)"						\
-	    CFILES="bytesex.c rnd.c"					\
-	    RC_CFLAGS="$(RC_CFLAGS)"					\
-	    RC_ARCHS="$(RC_ARCHS)";
-
-$(OFILE_DIRS) $(SYMROOT):
-	$(MKDIRS) $@
+CC=clang -arch x86_64 -arch i386
+
+LEGACY = -D_MACH_I386_THREAD_STATUS_FPSTATE_LEGACY_FIELD_NAMES_ \
+	 -D_ARCHITECTURE_I386_FPU_FPSTATE_LEGACY_FIELD_NAMES_
+
+KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
+       -msoft-float -nostdinc \
+-I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
+-I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/libsa \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/bsd \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers \
+       -I$(NEXT_ROOT)/usr/include \
+       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
+
+ifneq "" "$(SDKROOT)"
+  SDK = -isysroot $(SDKROOT)
+  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
+  LIBTOOL = $(shell xcrun -find -sdk $(SDKROOT) libtool)
+else
+  LIBTOOL = libtool
+endif
+
+OFLAG = -Ofast
+# apply otool-ng patches
+OTOOL_NG = -DOTOOL_NG_SUPPORT
+LTO = -DLTO_SUPPORT
+G = -g0
+CFLAGS = $(OFLAG) $(LTO) $(G) -I$(SRCROOT)/../include -Wall $(LEGACY) $(SDK)
+PG = -pg
+
+MKDIRS = /bin/mkdir -p
+SRCROOT = .
+SYMROOT = .
+OBJROOT = .
+OFILE_DIRS = $(OBJROOT)/static_obj $(OBJROOT)/dynamic_obj \
+	     $(OBJROOT)/profile_obj $(OBJROOT)/shlib_obj \
+	     $(OBJROOT)/static_kld_obj
+OFILE_DIR = $(OBJROOT)
+VPATH = $(OFILE_DIR)
+
+EFITOOLS=efitools
+
+ifeq "$(EFITOOLS)" "efitools"
+	COFF_BYTESEX = coff_bytesex.c
+else
+	COFF_BYTESEX =
+endif
+CFILES = allocate.c errors.c arch.c execute.c bytesex.c rnd.c hppa.c \
+	  swap_headers.c reloc.c version_number.c get_toc_byte_sex.c \
+	  best_arch.c fatals.c arch_usage.c ofile.c ofile_error.c print.c \
+	  set_arch_flag_name.c seg_addr_table.c dylib_table.c \
+	  breakout.c writeout.c checkout.c fatal_arch.c ofile_get_word.c \
+	  vm_flush_cache.c hash_string.c dylib_roots.c guess_short_name.c \
+	  SymLoc.c get_arch_from_host.c crc32.c macosx_deployment_target.c \
+	  symbol_list.c unix_standard_mode.c lto.c llvm.c $(COFF_BYTESEX)
+OBJS = $(CFILES:.c=.o) apple_version.o
+INSTALL_FILES = $(CFILES) Makefile notes
+
+#ifeq "$(OLD_LIBKLD)" "YES"
+	STATIC_KLD = static_kld
+#else
+#	STATIC_KLD = 
+#endif
+
+all: $(OFILE_DIRS) $(SYMROOT) dynamic profile static $(STATIC_KLD)
+
+lib_static_ofiles: $(STATIC_KLD)
+
+lib_ofiles: $(OFILE_DIRS) $(SYMROOT) dynamic
+
+lib_ofiles_install: lib_ofiles
+
+static: $(OBJROOT)/static_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd static_obj;						\
+		$(MAKE) -f ../Makefile libstuff.a			\
+		PRODUCT=libstuff.a					\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		SYMROOT=..						\
+		COPTS="-static"						\
+		OFLAG="$(OFLAG)"					\
+		CFILES="$(CFILES)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	else								\
+	    cd $(OBJROOT)/static_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libstuff.a		\
+		PRODUCT=libstuff.a					\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/static_obj				\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="-static"						\
+		OFLAG="$(OFLAG)"					\
+		CFILES="$(CFILES)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	fi
+
+static_kld: $(OBJROOT)/static_kld_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd static_kld_obj;						\
+		$(MAKE) -f ../Makefile libstuff_kld.a			\
+		PRODUCT=libstuff_kld.a					\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		SYMROOT=..						\
+		COPTS="-static -DRLD -DSA_RLD $(KERN)"			\
+		OFLAG="$(OFLAG)"					\
+		CFILES="$(CFILES)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	else								\
+	    cd $(OBJROOT)/static_kld_obj;				\
+		$(MAKE) -f $(SRCROOT)/Makefile libstuff_kld.a		\
+		PRODUCT=libstuff_kld.a					\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/static_kld_obj			\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="-static -DRLD -DSA_RLD $(KERN)"			\
+		OFLAG="$(OFLAG)"					\
+		CFILES="$(CFILES)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	fi
+
+dynamic: $(OBJROOT)/dynamic_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd dynamic_obj;						\
+		$(MAKE) -f ../Makefile libstuff.dylib			\
+		PRODUCT=libstuff.dylib					\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		SYMROOT=..						\
+		COPTS="$(DYNAMIC)"					\
+		OFLAG="$(OFLAG)"					\
+		CFILES="$(CFILES)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	else								\
+	    cd $(OBJROOT)/dynamic_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libstuff.dylib		\
+		PRODUCT=libstuff.dylib					\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/dynamic_obj			\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="$(DYNAMIC)"					\
+		OFLAG="$(OFLAG)"					\
+		CFILES="$(CFILES)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	fi
+
+profile: $(OBJROOT)/profile_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd profile_obj;						\
+		$(MAKE) -f ../Makefile libstuff_p.a			\
+		PRODUCT=libstuff_p.a					\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		SYMROOT=..						\
+		COPTS="$(DYNAMIC) $(PG)"				\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	else								\
+	    cd $(OBJROOT)/profile_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libstuff_p.a		\
+		PRODUCT=libstuff_p.a					\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/profile_obj			\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="$(DYNAMIC) $(PG)"				\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	fi
+
+shlib: $(OBJROOT)/shlib_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd shlib_obj;						\
+		$(MAKE) -f ../Makefile libstuff_s.a			\
+		PRODUCT=libstuff_s.a					\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		SYMROOT=..						\
+		COPTS="-static -DSHLIB -I/LocalDeveloper/Headers/libsys" \
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	else								\
+	    cd $(OBJROOT)/shlib_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libstuff_s.a		\
+		PRODUCT=libstuff_s.a					\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/shlib_obj				\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="-static -DSHLIB -I/LocalDeveloper/Headers/libsys" \
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	fi
+
+$(PRODUCT):	$(OFILE_DIR) $(SYMROOT) $(OBJS)
+	$(LIBTOOL) -static -o $(SYMROOT)/$(PRODUCT) $(OBJS)
+
+apple_version.c:
+	echo "const char apple_version[]=" > $(OFILE_DIR)/$@
+	echo "\"cctools-$(RC_ProjectSourceVersion)\";" >> $(OFILE_DIR)/$@
+
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c -o $(OFILE_DIR)/$*.o $<
+
+llvm.o: llvm.c
+	$(CC) -std=c11 $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
+		-I/Developer/usr/local/include \
+		-I$(DT_TOOLCHAIN_DIR)/usr/local/include \
+		-o $(OFILE_DIR)/$*.o $<
+
+lto.o: lto.c
+	$(CC) -std=c11 $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
+		-I/Developer/usr/local/include \
+		-I$(DT_TOOLCHAIN_DIR)/usr/local/include \
+		-o $(OFILE_DIR)/$*.o $<
+
+clean shlib_clean:
+	-rm -r -f $(OFILE_DIRS)
+	-rm -f libstuff.a libstuff.dylib libstuff_p.a libstuff_s.a
+
+install: all
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+installGASsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - Makefile bytesex.c rnd.c | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+fromGASsrc: $(OBJROOT)/dynamic_obj
+	@cd dynamic_obj;						\
+	    $(MAKE) -f ../Makefile libstuff.dylib			\
+	    PRODUCT=libstuff.dylib					\
+	    VPATH=.. 							\
+	    OFILE_DIR=.							\
+	    SRCROOT=..							\
+	    SYMROOT=..							\
+	    COPTS="$(DYNAMIC)"						\
+	    OFLAG="$(OFLAG)"						\
+	    CFILES="bytesex.c rnd.c"					\
+	    RC_CFLAGS="$(RC_CFLAGS)"					\
+	    RC_ARCHS="$(RC_ARCHS)";
+
+$(OFILE_DIRS) $(SYMROOT):
+	$(MKDIRS) $@
diff -Nur cctools-877.5/libstuff/allocate.c cctools-877.5-AnV/libstuff/allocate.c
--- cctools-877.5/libstuff/allocate.c	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/libstuff/allocate.c	2015-11-19 09:03:10 +0000
@@ -76,7 +76,7 @@
 
 	len = strlen(s) + 1;
 	r = (char *)allocate(len);
-	strcpy(r, s);
+	strlcpy(r, s, strlen(s));
 	return(r);
 }
 
@@ -110,11 +110,11 @@
 	*s = '\0';
 
 	if(args != NULL){
-	    (void)strcat(s, args);
+	    (void)strlcat(s, args, size);
 	    va_start(ap, args);
 	    p = (char *)va_arg(ap, char *);
 	    while(p != NULL){
-		(void)strcat(s, p);
+		(void)strlcat(s, p, size);
 		p = (char *)va_arg(ap, char *);
 	    }
 	    va_end(ap);
diff -Nur cctools-877.5/libstuff/breakout.c cctools-877.5-AnV/libstuff/breakout.c
--- cctools-877.5/libstuff/breakout.c	2013-12-10 19:28:11 +0000
+++ cctools-877.5-AnV/libstuff/breakout.c	2015-11-19 09:03:10 +0000
@@ -116,7 +116,11 @@
 	 * Rely on the ofile_*() routines to do all the checking and only
 	 * return valid ofiles files broken out.
 	 */
+#ifdef OTOOL_NG_SUPPORT	 
+	if(ofile_map(filename, NULL, NULL, ofile, FALSE, 0) == FALSE){
+#else
 	if(ofile_map(filename, NULL, NULL, ofile, FALSE) == FALSE){
+#endif		
 	    free(ofile);
 	    return(NULL);
 	}
diff -Nur cctools-877.5/libstuff/bytesex.c cctools-877.5-AnV/libstuff/bytesex.c
--- cctools-877.5/libstuff/bytesex.c	2015-03-10 00:33:19 +0000
+++ cctools-877.5-AnV/libstuff/bytesex.c	2015-11-19 09:03:10 +0000
@@ -208,6 +208,14 @@
 #include "stuff/bool.h"
 #include "stuff/bytesex.h"
 
+#if !__DARWIN_UNIX03
+#define __x x
+#define __r r
+#define __sp sp
+#define __cpsr cpsr
+#define __fp fp
+#endif
+
 __private_extern__
 long long
 SWAP_LONG_LONG(
diff -Nur cctools-877.5/libstuff/checkout.c cctools-877.5-AnV/libstuff/checkout.c
--- cctools-877.5/libstuff/checkout.c	2015-03-10 00:33:19 +0000
+++ cctools-877.5-AnV/libstuff/checkout.c	2015-11-19 09:03:10 +0000
@@ -622,9 +622,12 @@
 	    if(object->code_sig_cmd != NULL){
 		sigend = object->code_sig_cmd->dataoff +
 			 object->code_sig_cmd->datasize;
+        /* AnV - mtoc i386 fix */
+#if 0
 		if(sigend != end)
 		    fatal_arch(arch, member, "code signature not at the end "
 			"of the file (can't be processed) in file: ");
+#endif
 		/*
 		 * The code signature starts at a 16 byte offset.  So if the
 		 * string table end rouned to 16 bytes is the offset where the 
@@ -647,9 +650,11 @@
 		 * object_size due to rounding.
 		 */
 		rounded_strend = rnd(strend, 8);
+#if 0
 		if(strend != end && rounded_strend != end)
 		    fatal_arch(arch, member, "string table not at the end "
 			"of the file (can't be processed) in file: ");
+#endif
 		/*
 		 * To make the code work that assumes the end of string table is
 		 * at the end of the object file change the object_size to be
@@ -685,6 +690,7 @@
 		    rounded_indirectend = indirectend;
 		}
 
+#if 0
 		if(indirectend != end && rounded_indirectend != end){
 		    fatal_arch(arch, member, "indirect symbol table does not "
 			"directly preceed the string table (can't be "
@@ -731,6 +737,7 @@
 		    fatal_arch(arch, member, "the " SEG_LINKEDIT " segment "
 			"does not cover the symbol and string table (can't "
 			"be processed) in file: ");
+#endif
 	    }
 	}
 }
diff -Nur cctools-877.5/libstuff/dylib_roots.c cctools-877.5-AnV/libstuff/dylib_roots.c
--- cctools-877.5/libstuff/dylib_roots.c	1969-12-31 23:59:59 +0000
+++ cctools-877.5-AnV/libstuff/dylib_roots.c	2015-11-19 09:03:10 +0000
@@ -99,8 +99,13 @@
 		    goto try_to_find_in_dstroot;
 		}
 	    }
+#ifdef OTOOL_NG_SUPPORT
+	    ofile_process(image_file_name, NULL, 0, TRUE,
+			  TRUE, TRUE, FALSE, check_for_dylib, &block, 0);
+#else	    
 	    ofile_process(image_file_name, NULL, 0, TRUE,
 			  TRUE, TRUE, FALSE, check_for_dylib, &block);
+#endif	   
 	    if(block.check_result == TRUE)
 		return(image_file_name);
 	    free(image_file_name);
@@ -177,8 +182,13 @@
 		 * it back to FALSE.
 		 */
 		block.check_result = TRUE;
+#ifdef OTOOL_NG_SUPPORT		
+		ofile_process(ftsent->fts_path, NULL, 0, TRUE,
+			      TRUE, TRUE, FALSE, check_for_dylib,&block, 0);
+#else
 		ofile_process(ftsent->fts_path, NULL, 0, TRUE,
 			      TRUE, TRUE, FALSE, check_for_dylib,&block);
+#endif		
 		if(block.check_result == TRUE){
 		    image_file_name = allocate(ftsent->fts_pathlen + 1);
 		    strcpy(image_file_name, ftsent->fts_path);
diff -Nur cctools-877.5/libstuff/llvm.c cctools-877.5-AnV/libstuff/llvm.c
--- cctools-877.5/libstuff/llvm.c	2014-02-05 21:40:54 +0000
+++ cctools-877.5-AnV/libstuff/llvm.c	2015-11-19 09:03:10 +0000
@@ -1,5 +1,6 @@
 #include <stdio.h>
 #include <stdlib.h>
+#include <strings.h>
 #include <libc.h>
 #include <sys/file.h>
 #include <dlfcn.h>
@@ -8,6 +9,11 @@
 #include "stuff/allocate.h"
 #include <mach-o/dyld.h>
 
+#ifdef _BUILD_LIB_
+#undef __private_extern__
+#define __private_extern__
+#endif
+
 /*
  * The disassembler API is currently exported from libLTO.dylib.  Eventually we
  * plan to include it (along with the current libLTO APIs) in a generic
diff -Nur cctools-877.5/libstuff/lto.c cctools-877.5-AnV/libstuff/lto.c
--- cctools-877.5/libstuff/lto.c	2015-02-18 22:10:27 +0000
+++ cctools-877.5-AnV/libstuff/lto.c	2015-11-19 09:03:10 +0000
@@ -2,6 +2,7 @@
 
 #include <stdio.h>
 #include <stdlib.h>
+#include <strings.h>
 #include <libc.h>
 #include <sys/file.h>
 #include <dlfcn.h>
diff -Nur cctools-877.5/libstuff/ofile.c cctools-877.5-AnV/libstuff/ofile.c
--- cctools-877.5/libstuff/ofile.c	2015-09-15 01:35:14 +0000
+++ cctools-877.5-AnV/libstuff/ofile.c	2015-11-19 09:30:31 +0000
@@ -1,6373 +1,6414 @@
-/*
- * Copyright  2009 Apple Inc. All rights reserved.
- *
- * @APPLE_LICENSE_HEADER_START@
- * 
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions are met:
- * 
- * 1.  Redistributions of source code must retain the above copyright notice,
- * this list of conditions and the following disclaimer. 
- * 2.  Redistributions in binary form must reproduce the above copyright notice,
- * this list of conditions and the following disclaimer in the documentation
- * and/or other materials provided with the distribution. 
- * 3.  Neither the name of Apple Inc. ("Apple") nor the names of its
- * contributors may be used to endorse or promote products derived from this
- * software without specific prior written permission. 
- * 
- * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND ANY
- * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
- * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
- * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
- * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
- * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
- * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
- * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
- * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
- * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
- *
- * @APPLE_LICENSE_HEADER_END@
- */
-#define __darwin_i386_exception_state i386_exception_state
-#define __darwin_i386_float_state i386_float_state
-#define __darwin_i386_thread_state i386_thread_state
-
-#ifndef RLD
-#ifdef SHLIB
-#include "shlib.h"
-#endif
-#include <libc.h>
-#include <mach/mach.h>
-#include "stuff/openstep_mach.h"
-#include <stddef.h>
-#include <stdarg.h>
-#include <limits.h>
-#include <errno.h>
-#include <ctype.h>
-#include <ar.h>
-#include <sys/file.h>
-#include <sys/types.h>
-#include <sys/mman.h>
-#include <mach-o/fat.h>
-#include <mach-o/loader.h>
-#import <mach/m68k/thread_status.h>
-#import <mach/ppc/thread_status.h>
-#undef MACHINE_THREAD_STATE     /* need to undef these to avoid warnings */
-#undef MACHINE_THREAD_STATE_COUNT
-#undef THREAD_STATE_NONE
-#undef VALID_THREAD_STATE_FLAVOR
-#import <mach/m88k/thread_status.h>
-#import <mach/i860/thread_status.h>
-#import <mach/i386/thread_status.h>
-#import <mach/sparc/thread_status.h>
-#import <mach/arm/thread_status.h>
-#include <mach-o/nlist.h>
-#include <mach-o/reloc.h>
-#include "stuff/bool.h"
-#ifdef OFI
-#include <mach-o/dyld.h>
-#else
-#include "stuff/lto.h"
-#endif
-#include "stuff/bytesex.h"
-#include "stuff/arch.h"
-#include "stuff/rnd.h"
-#include "stuff/errors.h"
-#include "stuff/allocate.h"
-#include "stuff/ofile.h"
-#include "stuff/print.h"
-
-#ifdef OTOOL
-#undef ALIGNMENT_CHECKS
-#include "otool.h"
-#include "dyld_bind_info.h"
-#include "ofile_print.h"
-static enum bool otool_first_ofile_map = TRUE;
-#else /* !define(OTOOL) */
-
-#if (!defined(m68k) && !defined(__i386__) && !defined(__x86_64__) && !defined(__ppc__) && !defined(__arm__))
-#define ALIGNMENT_CHECKS_ARCHIVE_64_BIT
-static enum bool archive_64_bit_align_warning = FALSE;
-#endif /* (!defined(m68k) && !defined(__i386__) && !defined(__x86_64__) && !defined(__ppc__) && !defined(__arm__)) */
-
-#endif /* OTOOL */
-
-/* <mach/loader.h> */
-/* The maximum section alignment allowed to be specified, as a power of two */
-#define MAXSECTALIGN		15 /* 2**15 or 0x8000 */
-
-enum check_type {
-    CHECK_BAD,
-    CHECK_GOOD
-};
-
-#ifndef OTOOL
-struct element {
-    uint32_t offset;
-    uint32_t size;
-    char *name;
-    struct element *next;
-};
-#endif /* !defined(OTOOL) */
-
-static enum bool ofile_specific_arch(
-    struct ofile *ofile,
-    uint32_t narch);
-static enum check_type check_fat(
-    struct ofile *ofile);
-static enum check_type check_fat_object_in_archive(
-    struct ofile *ofile);
-static enum check_type check_archive(
-    struct ofile *ofile,
-    enum bool archives_with_fat_objects);
-static enum check_type check_extend_format_1(
-    struct ofile *ofile,
-    struct ar_hdr *ar_hdr,
-    uint32_t size_left,
-    uint32_t *member_name_size);
-static enum check_type check_archive_toc(
-    struct ofile *ofile);
-static enum check_type check_Mach_O(
-    struct ofile *ofile);
-static void swap_back_Mach_O(
-    struct ofile *ofile);
-#ifndef OTOOL
-static enum check_type check_overlaping_element(
-    struct ofile *ofile,
-    struct element *head,
-    uint32_t offset,
-    uint32_t size,
-    char *name);
-static void free_elements(
-    struct element *head);
-#endif /* !defined(OTOOL) */
-static enum check_type check_dylib_module(
-    struct ofile *ofile,
-    struct symtab_command *st,
-    struct dysymtab_command *dyst,
-    char *strings,
-    uint32_t module_index);
-
-#ifndef OTOOL
-#if defined(ALIGNMENT_CHECKS) || defined(ALIGNMENT_CHECKS_ARCHIVE_64_BIT)
-static
-void
-temporary_archive_member_warning(
-struct ofile *ofile,
-const char *format, ...)
-{
-    va_list ap;
-
-	va_start(ap, format);
-	if(ofile->file_type == OFILE_FAT){
-	    print("%s: for architecture %s archive member: %s(%.*s) ",
-		  progname, ofile->arch_flag.name, ofile->file_name,
-		  (int)ofile->member_name_size, ofile->member_name);
-	}
-	else{
-	    print("%s: archive member: %s(%.*s) ", progname, ofile->file_name,
-		  (int)ofile->member_name_size, ofile->member_name);
-	}
-	vprint(format, ap);
-        print("\n");
-	va_end(ap);
-}
-#endif /* defined(ALIGNMENT_CHECKS) */
-#endif /* !defined(OTOOL) */
-
-#ifndef OFI
-/*
- * ofile_process() processes the specified file name can calls the routine
- * processor on the ofiles in it.  arch_flags is an array of architectures
- * containing narch_flags which are the only architectures to process if
- * narch_flags is non-zero.  If all_archs is TRUE then all architectures of
- * the specified file are processed.  The specified file name can be of the
- * form "archive(member)" which is taken to mean that member in that archive
- * (or that module of a dynamic library if dylib_flat is not FALSE).
- * For each ofile that is to be processed the routine processor is called with
- * the corresponding ofile struct, the arch_name pass to it is either NULL or
- * an architecture name (when it should be printed or show by processor) and
- * cookie is the same value as passed to ofile_process.
- */
-__private_extern__
-void
-ofile_process(
-char *name,
-struct arch_flag *arch_flags,
-uint32_t narch_flags,
-enum bool all_archs,
-enum bool process_non_objects,
-enum bool dylib_flat,
-enum bool use_member_syntax,
-void (*processor)(struct ofile *ofile, char *arch_name, void *cookie),
-void *cookie)
-{
-    char *member_name, *p, *arch_name;
-    uint32_t len, i;
-    struct ofile ofile;
-    enum bool flag, hostflag, arch_found, family;
-    struct arch_flag host_arch_flag, specific_arch_flag;
-    const struct arch_flag *family_arch_flag;
-
-	/*
-	 * If use_member_syntax is TRUE look for a name of the form
-	 * "archive(member)" which is to mean a member in that archive (the
-	 * member name must be at least one character long to be recognized as
-	 * this form).
-	 */
-	member_name = NULL;
-	if(use_member_syntax == TRUE){
-	    len = strlen(name);
-	    if(len >= 4 && name[len-1] == ')'){
-		p = strrchr(name, '(');
-		if(p != NULL && p != name){
-		    member_name = p+1;
-		    *p = '\0';
-		    name[len-1] = '\0';
-		}
-	    }
-	}
-
-#ifdef OTOOL
-	otool_first_ofile_map = TRUE;
-#endif /* OTOOL */
-	if(ofile_map(name, NULL, NULL, &ofile, FALSE) == FALSE)
-	    return;
-#ifdef OTOOL
-	otool_first_ofile_map = FALSE;
-#endif /* OTOOL */
-
-	if(ofile.file_type == OFILE_FAT){
-	    /*
-	     * This is a fat file so see if a list of architecture is
-	     * specified and process only those.
-	     */
-	    if(all_archs == FALSE && narch_flags != 0){
-		for(i = 0; i < narch_flags; i++){
-		    if(ofile_first_arch(&ofile) == FALSE){
-			ofile_unmap(&ofile);
-			return;
-		    }
-		    arch_found = FALSE;
-		    family = FALSE;
-		    family_arch_flag =
-			get_arch_family_from_cputype(arch_flags[i].cputype);
-		    if(family_arch_flag != NULL)
-			family = (enum bool)
-			  ((family_arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) ==
-			   (arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK));
-		    if(narch_flags != 1)
-			arch_name = ofile.arch_flag.name;
-		    else
-			arch_name = NULL;
-		    do{
-			if(ofile.arch_flag.cputype ==
-				arch_flags[i].cputype &&
-			   ((ofile.arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK) ==
-			    (arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK) ||
-			    family == TRUE)){
-			    arch_found = TRUE;
-			    if(ofile.arch_type == OFILE_ARCHIVE){
-				if(member_name != NULL){
-				    if(ofile_specific_member(member_name,
-							     &ofile) == TRUE){
-					processor(&ofile, arch_name, cookie);
-					if(ofile.headers_swapped == TRUE)
-					    swap_back_Mach_O(&ofile);
-				    }
-				}
-				else{
-				    /* loop through archive */
-#ifdef OTOOL
-				    printf("Archive : %s", ofile.file_name);
-				    if(arch_name != NULL)
-					printf(" (architecture %s)",
-					       arch_name);
-				    printf("\n");
-#endif /* OTOOL */
-				    if(ofile_first_member(&ofile) == TRUE){
-					flag = FALSE;
-					do{
-					    if(process_non_objects == TRUE ||
-					       ofile.member_type ==
-								OFILE_Mach_O){
-						processor(&ofile, arch_name,
-							  cookie);
-						if(ofile.headers_swapped ==TRUE)
-						    swap_back_Mach_O(&ofile);
-						flag = TRUE;
-					    }
-					}while(ofile_next_member(&ofile) ==
-						TRUE);
-					if(flag == FALSE){
-					    error("for architecture: %s "
-						  "archive: %s contains no "
-						  "members that are object "
-						  "files", ofile.arch_flag.name,
-						  ofile.file_name);
-					}
-				    }
-				    else{
-					error("for architecture: %s archive: "
-					      "%s contains no members",
-					      ofile.arch_flag.name,
-					      ofile.file_name);
-				    }
-				}
-			    }
-			    else if(process_non_objects == TRUE ||
-				    ofile.arch_type == OFILE_Mach_O){
-				if(ofile.arch_type == OFILE_Mach_O &&
-				   (ofile.mh_filetype == MH_DYLIB ||
-				    ofile.mh_filetype == MH_DYLIB_STUB)){
-				    if(dylib_flat == TRUE){
-					processor(&ofile, arch_name, cookie);
-					if(ofile.headers_swapped == TRUE)
-					    swap_back_Mach_O(&ofile);
-				    }
-				    else{
-					if(member_name != NULL){
-					    if(ofile_specific_module(
-						member_name, &ofile) == TRUE){
-						processor(&ofile, arch_name,
-							  cookie);
-						if(ofile.headers_swapped ==TRUE)
-						    swap_back_Mach_O(&ofile);
-					    }
-					}
-					else{
-					    /*loop through the dynamic library*/
-					    if(ofile_first_module(&ofile)){
-						do{
-						    processor(&ofile, arch_name,
-							cookie);
-						}while(ofile_next_module(
-							&ofile));
-					    }
-					    else{
-						processor(&ofile, arch_name,
-							  cookie);
-					    }
-					}
-				    }
-				    if(ofile.headers_swapped == TRUE)
-					swap_back_Mach_O(&ofile);
-				}
-				else{
-				    if(member_name != NULL)
-					error("for architecture: %s file: %s "
-					      "is not an archive and thus does "
-					      "not contain member: %s",
-					      ofile.arch_flag.name,
-					      ofile.file_name,
-					      member_name);
-				    else{
-					processor(&ofile, arch_name, cookie);
-					if(ofile.headers_swapped == TRUE)
-					    swap_back_Mach_O(&ofile);
-				     }
-				}
-			    }
-			    else if(ofile.arch_type == OFILE_UNKNOWN){
-				error("for architecture: %s file: %s is "
-				      "not an object file",
-				      ofile.arch_flag.name,ofile.file_name);
-			    }
-			    if(ofile.headers_swapped == TRUE)
-				swap_back_Mach_O(&ofile);
-			    break;
-			}
-			else{
-			    if(ofile.headers_swapped == TRUE)
-				swap_back_Mach_O(&ofile);
-			}
-		    }while(ofile_next_arch(&ofile) == TRUE);
-		    if(arch_found == FALSE)
-			error("file: %s does not contain architecture: %s",
-			      ofile.file_name, arch_flags[i].name);
-		}
-		ofile_unmap(&ofile);
-		return;
-	    }
-
-	    /*
-	     * This is a fat file and no architectures has been specified
-	     * so if it contains the host architecture process only that
-	     * architecture but if not process all architectures
-	     * specified.
-	     */
-	    if(all_archs == FALSE){
-		(void)get_arch_from_host(&host_arch_flag, &specific_arch_flag);
-#if __LP64__
-		/*
-		 * If runing as a 64-bit binary and on an Intel x86 host
-		 * default to 64-bit.
-		 */
-		if(host_arch_flag.cputype == CPU_TYPE_I386)
-		    host_arch_flag =
-			*get_arch_family_from_cputype(CPU_TYPE_X86_64);
-#endif /* __LP64__ */
-		hostflag = FALSE;
-
-		family = FALSE;
-		family_arch_flag =
-		    get_arch_family_from_cputype(host_arch_flag.cputype);
-#ifndef __arm__
-		if(family_arch_flag != NULL)
-		    family = (enum bool)
-			((family_arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) ==
-			 (host_arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK));
-#endif /* __arm__ */
-
-		ofile_unmap(&ofile);
-		if(ofile_map(name, NULL, NULL, &ofile, FALSE) == FALSE)
-		    return;
-		if(ofile_first_arch(&ofile) == FALSE){
-		    ofile_unmap(&ofile);
-		    return;
-		}
-		do{
-		    if(ofile.arch_flag.cputype ==
-			    host_arch_flag.cputype &&
-		       ((ofile.arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK) ==
-#ifdef __arm__
-			(specific_arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK) ||
-#else
-			(host_arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK) ||
-#endif /* __arm__ */
-			family == TRUE)){
-			hostflag = TRUE;
-			if(ofile.arch_type == OFILE_ARCHIVE){
-			    if(member_name != NULL){
-				if(ofile_specific_member(member_name,
-							 &ofile) == TRUE){
-				    processor(&ofile, NULL, cookie);
-				    if(ofile.headers_swapped == TRUE)
-					swap_back_Mach_O(&ofile);
-				}
-			    }
-			    else{
-				/* loop through archive */
-#ifdef OTOOL
-				printf("Archive : %s\n", ofile.file_name);
-#endif /* OTOOL */
-				if(ofile_first_member(&ofile) == TRUE){
-				    flag = FALSE;
-				    do{
-					if(process_non_objects == TRUE ||
-				           ofile.member_type == OFILE_Mach_O){
-					    processor(&ofile, NULL, cookie);
-					    if(ofile.headers_swapped == TRUE)
-						swap_back_Mach_O(&ofile);
-					    flag = TRUE;
-					}
-				    }while(ofile_next_member(&ofile) ==
-					   TRUE);
-				    if(flag == FALSE){
-					error("archive: %s contains no "
-					      "members that are object "
-					      "files", ofile.file_name);
-				    }
-				}
-				else{
-				    error("archive: %s contains no "
-					  "members", ofile.file_name);
-				}
-			    }
-			}
-			else if(process_non_objects == TRUE ||
-				ofile.arch_type == OFILE_Mach_O){
-			    if(ofile.arch_type == OFILE_Mach_O &&
-			       (ofile.mh_filetype == MH_DYLIB ||
-				ofile.mh_filetype == MH_DYLIB_STUB)){
-				if(dylib_flat == TRUE){
-				    processor(&ofile, NULL, cookie);
-				}
-				else{
-				    if(member_name != NULL){
-					if(ofile_specific_module(member_name,
-						&ofile) == TRUE)
-					    processor(&ofile, NULL, cookie);
-				    }
-				    else{
-					/* loop through the dynamic library */
-					if(ofile_first_module(&ofile) == TRUE){
-					    do{
-						processor(&ofile, NULL, cookie);
-					    }while(ofile_next_module(&ofile));
-					}
-					else{
-					    processor(&ofile, NULL, cookie);
-					}
-				    }
-				}
-				if(ofile.headers_swapped == TRUE)
-				    swap_back_Mach_O(&ofile);
-			    }
-			    else{
-				if(member_name != NULL)
-				    error("for architecture: %s file: %s is "
-					  "not an archive and thus does not "
-					  "contain member: %s",
-					  ofile.arch_flag.name, ofile.file_name,
-					  member_name);
-				else{
-				    processor(&ofile, NULL, cookie);
-				    if(ofile.headers_swapped == TRUE)
-					swap_back_Mach_O(&ofile);
-				}
-			    }
-			}
-			else if(ofile.arch_type == OFILE_UNKNOWN){
-			    error("file: %s is not an object file",
-				  ofile.file_name);
-			}
-		    }
-		    else{
-			if(ofile.headers_swapped == TRUE)
-			    swap_back_Mach_O(&ofile);
-		    }
-		}while(hostflag == FALSE && ofile_next_arch(&ofile) == TRUE);
-		if(hostflag == TRUE){
-		    ofile_unmap(&ofile);
-		    return;
-		}
-	    }
-
-	    /*
-	     * Either all architectures have been specified or none have
-	     * been specified and it does not contain the host architecture
-	     * so do all the architectures in the fat file
-	     */
-	    ofile_unmap(&ofile);
-	    if(ofile_map(name, NULL, NULL, &ofile, FALSE) == FALSE)
-		return;
-	    if(ofile_first_arch(&ofile) == FALSE){
-		ofile_unmap(&ofile);
-		return;
-	    }
-	    do{
-		if(ofile.arch_type == OFILE_ARCHIVE){
-		    if(member_name != NULL){
-			if(ofile_specific_member(member_name, &ofile) == TRUE)
-			    processor(&ofile, ofile.arch_flag.name, cookie);
-		    }
-		    else{
-			/* loop through archive */
-#ifdef OTOOL
-			printf("Archive : %s (architecture %s)\n",
-			       ofile.file_name, ofile.arch_flag.name);
-#endif /* OTOOL */
-			if(ofile_first_member(&ofile) == TRUE){
-			    flag = FALSE;
-			    do{
-				if(process_non_objects == TRUE ||
-				   ofile.member_type == OFILE_Mach_O){
-				    processor(&ofile, ofile.arch_flag.name,
-					      cookie);
-				    flag = TRUE;
-				}
-			    }while(ofile_next_member(&ofile) == TRUE);
-			    if(flag == FALSE){
-				error("for architecture: %s archive: %s "
-				      "contains no members that are object "
-				      "files", ofile.arch_flag.name,
-				      ofile.file_name);
-			    }
-			}
-			else{
-			    error("for architecture: %s archive: %s "
-				  "contains no members",
-				  ofile.arch_flag.name, ofile.file_name);
-			}
-		    }
-		}
-		else if(process_non_objects == TRUE ||
-			ofile.arch_type == OFILE_Mach_O){
-		    if(ofile.arch_type == OFILE_Mach_O &&
-		       (ofile.mh_filetype == MH_DYLIB ||
-			ofile.mh_filetype == MH_DYLIB_STUB)){
-			if(dylib_flat == TRUE){
-			    processor(&ofile, ofile.arch_flag.name, cookie);
-			}
-			else{
-			    if(member_name != NULL){
-				if(ofile_specific_module(member_name, &ofile)
-				   == TRUE)
-				    processor(&ofile, ofile.arch_flag.name,
-					      cookie);
-			    }
-			    else{
-				/* loop through the dynamic library */
-				if(ofile_first_module(&ofile) == TRUE){
-				    do{
-					processor(&ofile, ofile.arch_flag.name,
-						  cookie);
-				    }while(ofile_next_module(&ofile) == TRUE);
-				}
-				else{
-				    processor(&ofile, ofile.arch_flag.name,
-					      cookie);
-				}
-			    }
-			}
-		    }
-		    else{
-			if(member_name != NULL)
-			    error("for architecture: %s file: %s is not an "
-				  "archive and thus does not contain member: "
-				  "%s", ofile.arch_flag.name, ofile.file_name,
-				  member_name);
-			else
-			    processor(&ofile, ofile.arch_flag.name, cookie);
-		    }
-		}
-		else if(ofile.arch_type == OFILE_UNKNOWN){
-		    error("for architecture: %s file: %s is not an "
-			  "object file", ofile.arch_flag.name,
-			  ofile.file_name);
-		}
-	    }while(ofile_next_arch(&ofile) == TRUE);
-	}
-	else if(ofile.file_type == OFILE_ARCHIVE){
-	    if(narch_flags != 0){
-		arch_found = FALSE;
-		for(i = 0; i < narch_flags; i++){
-		    family = FALSE;
-		    if(narch_flags == 1){
-			family_arch_flag =
-			    get_arch_family_from_cputype(arch_flags[0].cputype);
-			if(family_arch_flag != NULL)
-			    family = (enum bool)
-				((family_arch_flag->cpusubtype &
-				  ~CPU_SUBTYPE_MASK) ==
-				 (arch_flags[0].cpusubtype &
-				  ~CPU_SUBTYPE_MASK));
-		    }
-		    if(ofile.archive_cputype == arch_flags[i].cputype &&
-		       ((ofile.archive_cpusubtype & ~CPU_SUBTYPE_MASK) ==
-			(arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK) ||
-			family == TRUE)){
-			arch_found = TRUE;
-		    }
-		    else{
-			error("file: %s does not contain architecture: %s",
-			      ofile.file_name, arch_flags[i].name);
-		    }
-		}
-		if(arch_found == FALSE){
-		    ofile_unmap(&ofile);
-		    return;
-		}
-	    }
-	    if(member_name != NULL){
-		if(ofile_specific_member(member_name, &ofile) == TRUE)
-		    processor(&ofile, NULL, cookie);
-	    }
-	    else{
-		/* loop through archive */
-#ifdef OTOOL
-		printf("Archive : %s\n", ofile.file_name);
-#endif /* OTOOL */
-		if(ofile_first_member(&ofile) == TRUE){
-		    flag = FALSE;
-		    do{
-			if(process_non_objects == TRUE ||
-			    ofile.member_type == OFILE_Mach_O){
-			    processor(&ofile, NULL, cookie);
-			    flag = TRUE;
-			}
-		    }while(ofile_next_member(&ofile) == TRUE);
-		    if(flag == FALSE){
-			error("archive: %s contains no members that are "
-			      "object files", ofile.file_name);
-		    }
-		}
-		else{
-		    error("archive: %s contains no members",
-			  ofile.file_name);
-		}
-	    }
-	}
-	else if(ofile.file_type == OFILE_Mach_O){
-	    if(narch_flags != 0){
-		arch_found = FALSE;
-		for(i = 0; i < narch_flags; i++){
-		    family = FALSE;
-		    if(narch_flags == 1){
-			family_arch_flag =
-			    get_arch_family_from_cputype(arch_flags[0].cputype);
-			if(family_arch_flag != NULL)
-			    family = (enum bool)
-				((family_arch_flag->cpusubtype &
-				  ~CPU_SUBTYPE_MASK) ==
-				 (arch_flags[0].cpusubtype &
-				  ~CPU_SUBTYPE_MASK));
-		    }
-#ifdef OTOOL
-		    if(ofile.mh != NULL){
-		        if(ofile.mh->magic == MH_MAGIC &&
-			   ofile.mh->cputype == arch_flags[i].cputype &&
-			   ((ofile.mh->cpusubtype & ~CPU_SUBTYPE_MASK) ==
-			    (arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK) ||
-			    family == TRUE)){
-			    arch_found = TRUE;
-			}
-		        if(ofile.mh->magic == SWAP_INT(MH_MAGIC) &&
-			   (cpu_type_t)SWAP_INT(ofile.mh->cputype) ==
-				arch_flags[i].cputype &&
-			   ((cpu_subtype_t)SWAP_INT(ofile.mh->cpusubtype &
-						    ~CPU_SUBTYPE_MASK) ==
-				(arch_flags[i].cpusubtype &
-				 ~CPU_SUBTYPE_MASK) ||
-			    family == TRUE)){
-			    arch_found = TRUE;
-			}
-		    }
-		    else if(ofile.mh64 != NULL){
-		        if(ofile.mh64->magic == MH_MAGIC_64 &&
-			   ofile.mh64->cputype == arch_flags[i].cputype &&
-			   ((ofile.mh64->cpusubtype & ~CPU_SUBTYPE_MASK) ==
-			    (arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK) ||
-			    family == TRUE)){
-			    arch_found = TRUE;
-			}
-		        if(ofile.mh64->magic == SWAP_INT(MH_MAGIC_64) &&
-			   (cpu_type_t)SWAP_INT(ofile.mh64->cputype) ==
-				arch_flags[i].cputype &&
-			   ((cpu_subtype_t)SWAP_INT((ofile.mh64->cpusubtype &
-						     ~CPU_SUBTYPE_MASK)) ==
-			    (arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK) ||
-			    family == TRUE)){
-			    arch_found = TRUE;
-			}
-		    }
-		    else
-#endif /* OTOOL */
-		    if(ofile.mh_cputype == arch_flags[i].cputype &&
-		       ((ofile.mh_cpusubtype & ~CPU_SUBTYPE_MASK) ==
-			(arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK) ||
-			family == TRUE)){
-			arch_found = TRUE;
-		    }
-		    else{
-			error("file: %s does not contain architecture: %s",
-			      ofile.file_name, arch_flags[i].name);
-		    }
-		}
-		if(arch_found == FALSE){
-		    ofile_unmap(&ofile);
-		    return;
-		}
-	    }
-	    if(ofile.mh_filetype == MH_DYLIB ||
-	       ofile.mh_filetype == MH_DYLIB_STUB){
-		if(dylib_flat == TRUE){
-		    processor(&ofile, NULL, cookie);
-		}
-		else{
-		    if(member_name != NULL){
-			if(ofile_specific_module(member_name, &ofile) == TRUE)
-			    processor(&ofile, NULL, cookie);
-		    }
-		    else{
-			/* loop through the dynamic library */
-			if(ofile_first_module(&ofile) == TRUE){
-			    do{
-				processor(&ofile, NULL, cookie);
-			    }while(ofile_next_module(&ofile) == TRUE);
-			}
-			else{
-			    processor(&ofile, NULL, cookie);
-			}
-		    }
-		}
-	    }
-	    else{
-		if(member_name != NULL)
-		    error("file: %s is not an archive and thus does not contain"
-			  " member: %s", ofile.file_name, member_name);
-		else
-		    processor(&ofile, NULL, cookie);
-	    }
-	}
-	else{
-	    if(process_non_objects == TRUE)
-		processor(&ofile, NULL, cookie);
-	    else if(member_name != NULL)
-		error("file: %s(%s) is not an object file", name,
-		      member_name);
-	    else
-		error("file: %s is not an object file", name);
-	}
-	ofile_unmap(&ofile);
-}
-#endif /* !defined(OFI) */
-
-/*
- * ofile_map maps in the object file specified by file_name, arch_flag and
- * object_name and fills in the ofile struct pointed to by ofile for it.
- * When arch_flag and object_name are both NULL, the file is just set up into
- * ofile (if the file can be opened and mapped in, if not this call fails
- * are error routnes are called).  If arch_flag is not NULL and object_file is
- * NULL, then the file must be a Mach-O file or a fat file with the architecture
- * specified in the arch_flag, if not this call fails and error routines are
- * called.  When arch_flag and object_name are both not NULL, then the file must
- * be an archive or a fat file containing archives for the specified architec-
- * ture and contain an archive member object file with the name object_name,
- * otherwise this call fails and error routines are called.  If arch_flag is
- * NULL and object_file is not NULL, then the file name must be an archive (not
- * a fat file containing archives) and contain an archive member object file
- * with the name object_name, otherwise this call fails and calls error
- * routines.  If this call suceeds then it returns non-zero and the ofile
- * structure pointed to by ofile is filled in.  If this call fails it returns 0
- * and calls error routines to print error messages and clears the
- * ofile structure pointed to by ofile.
- */
-__private_extern__
-#ifdef OFI
-NSObjectFileImageReturnCode
-#else
-enum bool
-#endif
-ofile_map(
-const char *file_name,
-const struct arch_flag *arch_flag,	/* can be NULL */
-const char *object_name,		/* can be NULL */
-struct ofile *ofile,
-enum bool archives_with_fat_objects)
-{
-    int fd;
-    struct stat stat_buf;
-    uint64_t size;
-    uint32_t magic;
-    char *addr;
-
-	magic = 0; /* to shut up the compiler warning message */
-	memset(ofile, '\0', sizeof(struct ofile));
-
-	/* Open the file and map it in */
-	if((fd = open(file_name, O_RDONLY)) == -1){
-#ifdef OFI
-	    return(NSObjectFileImageAccess);
-#else
-	    system_error("can't open file: %s", file_name);
-	    return(FALSE);
-#endif
-	}
-	if(fstat(fd, &stat_buf) == -1){
-	    close(fd);
-#ifdef OFI
-	    return(NSObjectFileImageAccess);
-#else
-	    system_error("can't stat file: %s", file_name);
-	    return(FALSE);
-#endif
-	}
-	size = stat_buf.st_size;
-	
-	addr = NULL;
-	if(size != 0){
-	    addr = mmap(0, size, PROT_READ|PROT_WRITE, MAP_FILE|MAP_PRIVATE, fd,
-		        0);
-	    if((intptr_t)addr == -1){
-		system_error("can't map file: %s", file_name);
-		close(fd);
-		return(FALSE);
-	    }
-	}
-	close(fd);
-#ifdef OTOOL
-	if(otool_first_ofile_map && Wflag)
-	    printf("Modification time = %ld\n", (long int)stat_buf.st_mtime);
-#endif /* OTOOL */
-
-	return(ofile_map_from_memory(addr, size, file_name, stat_buf.st_mtime,
-		  arch_flag, object_name, ofile, archives_with_fat_objects));
-}
-
-/*
- * ofile_map_from_memory() is the guts of ofile_map() but with an interface
- * to pass the address and size of the file already mapped in.
- */
-__private_extern__
-#ifdef OFI
-NSObjectFileImageReturnCode
-#else
-enum bool
-#endif
-ofile_map_from_memory(
-char *addr,
-uint64_t size,
-const char *file_name,
-uint64_t mtime,
-const struct arch_flag *arch_flag,	/* can be NULL */
-const char *object_name,		/* can be NULL */
-struct ofile *ofile,
-enum bool archives_with_fat_objects)
-{
-    uint32_t i;
-    uint32_t magic;
-    enum byte_sex host_byte_sex;
-    struct arch_flag host_arch_flag;
-    enum bool family;
-    const struct arch_flag *family_arch_flag;
-    uint64_t big_size;
-#ifdef OTOOL
-    uint32_t small_nfat_arch;
-#endif /* OTOOL */
-
-	/* fill in the start of the ofile structure */
-	ofile->file_name = savestr(file_name);
-	if(ofile->file_name == NULL)
-	    return(FALSE);
-	ofile->file_addr = addr;
-	ofile->file_size = size;
-	ofile->file_mtime = mtime;
-
-	/* Try to figure out what kind of file this is */
-
-	if(size >= sizeof(uint32_t)){
-	   magic = *((uint32_t *)addr);
-	}
-	host_byte_sex = get_host_byte_sex();
-
-	/* see if this file is a fat file (always in big endian byte sex) */
-#ifdef __BIG_ENDIAN__
-	if(size >= sizeof(struct fat_header) && magic == FAT_MAGIC)
-#endif /* __BIG_ENDIAN__ */
-#ifdef __LITTLE_ENDIAN__
-	if(size >= sizeof(struct fat_header) && SWAP_INT(magic) == FAT_MAGIC)
-#endif /* __LITTLE_ENDIAN__ */
-	{
-	    ofile->file_type = OFILE_FAT;
-	    ofile->fat_header = (struct fat_header *)addr;
-#ifdef __LITTLE_ENDIAN__
-	    swap_fat_header(ofile->fat_header, host_byte_sex);
-#endif /* __LITTLE_ENDIAN__ */
-#ifdef OTOOL
-	    if(otool_first_ofile_map && fflag)
-		printf("Fat headers\n");
-#endif /* OTOOL */
-	    big_size = ofile->fat_header->nfat_arch;
-	    big_size *= sizeof(struct fat_arch);
-	    big_size += sizeof(struct fat_header);
-	    if(big_size > size){
-#ifdef OTOOL
-		error("fat file: %s truncated or malformed (fat_arch structs "
-		      "would extend past the end of the file)", file_name);
-		ofile->fat_archs = allocate(size - sizeof(struct fat_header));
-		memset(ofile->fat_archs, '\0',
-		       size - sizeof(struct fat_header));
-		memcpy(ofile->fat_archs,
-		       addr + sizeof(struct fat_header),
-	    	       size - sizeof(struct fat_header));
-		small_nfat_arch = (size - sizeof(struct fat_header)) /
-				  sizeof(struct fat_arch);
-#ifdef __LITTLE_ENDIAN__
-		swap_fat_arch(ofile->fat_archs, small_nfat_arch,
-			      host_byte_sex);
-#endif /* __LITTLE_ENDIAN__ */
-		if(otool_first_ofile_map && fflag)
-		    print_fat_headers(ofile->fat_header, ofile->fat_archs,
-				      size, vflag);
-		free(ofile->fat_archs);
-		ofile_unmap(ofile);
-		return(FALSE);
-#else /* !defined(OTOOL) */
-		goto unknown;
-#endif /* OTOOL */
-	    }
-	    ofile->fat_archs = (struct fat_arch *)(addr +
-						   sizeof(struct fat_header));
-#ifdef __LITTLE_ENDIAN__
-	    swap_fat_arch(ofile->fat_archs, ofile->fat_header->nfat_arch,
-			  host_byte_sex);
-#endif /* __LITTLE_ENDIAN__ */
-#ifdef OTOOL
-	    if(otool_first_ofile_map && fflag)
-		print_fat_headers(ofile->fat_header, ofile->fat_archs,
-				  size, vflag);
-#endif /* OTOOL */
-	    if(check_fat(ofile) == CHECK_BAD){
-		ofile_unmap(ofile);
-#ifdef OFI
-		return(NSObjectFileImageFormat);
-#else
-		return(FALSE);
-#endif
-	    }
-	    /*
-	     * Now that the fat file is mapped fill in the ofile to the level
-	     * the caller wants based on the arch_flag and object_name passed.
-	     * If the caller did not specify an arch_flag or an object_name
-	     * then everything the caller wants is done.
-	     */
-	    if(arch_flag == NULL && object_name == NULL)
-		goto success;
-	    if(arch_flag == NULL){
-		if(get_arch_from_host(&host_arch_flag, NULL) == 0){
-		    error("can't determine the host architecture (specify an "
-			  "arch_flag or fix get_arch_from_host() )");
-		    goto cleanup;
-		}
-		ofile->arch_flag.name = savestr(host_arch_flag.name);
-		if(ofile->arch_flag.name == NULL)
-		    goto cleanup;
-		ofile->arch_flag.cputype = host_arch_flag.cputype;
-		ofile->arch_flag.cpusubtype = host_arch_flag.cpusubtype;
-	    }
-	    else{
-		ofile->arch_flag.name = savestr(arch_flag->name);
-		if(ofile->arch_flag.name == NULL)
-		    goto cleanup;
-		ofile->arch_flag.cputype = arch_flag->cputype;
-		ofile->arch_flag.cpusubtype = arch_flag->cpusubtype;
-	    }
-
-	    ofile->narch = UINT_MAX;
-	    for(i = 0; i < ofile->fat_header->nfat_arch; i++){
-		if(ofile->fat_archs[i].cputype ==
-			ofile->arch_flag.cputype &&
-		   (ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK) ==
-			(ofile->arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK)){
-		    ofile->narch = i;
-		    break;
-		}
-	    }
-	    if(ofile->narch == UINT_MAX){
-		family = FALSE;
-		family_arch_flag =
-		    get_arch_family_from_cputype(ofile->arch_flag.cputype);
-		if(family_arch_flag != NULL)
-		    family = (enum bool)
-			((family_arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) ==
-			 (ofile->arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK));
-		ofile->narch = UINT_MAX;
-		for(i = 0; i < ofile->fat_header->nfat_arch; i++){
-		    if(ofile->fat_archs[i].cputype ==
-			    ofile->arch_flag.cputype &&
-		       (family == TRUE ||
-			(ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK) ==
-			(ofile->arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK))){
-			ofile->arch_flag.cpusubtype =
-			    ofile->fat_archs[i].cpusubtype;
-			ofile->narch = i;
-			break;
-		    }
-		}
-	    }
-	    if(ofile->narch == UINT_MAX){
-#ifdef OFI
-		ofile_unmap(ofile);
-		return(NSObjectFileImageArch);
-#else
-		error("fat file: %s does not contain architecture %s",
-		      ofile->file_name, arch_flag->name);
-		ofile_unmap(ofile);
-		return(FALSE);
-#endif
-	    }
-	    /* Now determine the file type for this specific architecture */
-	    size = ofile->fat_archs[i].size;
-	    addr = addr + ofile->fat_archs[i].offset;
-	    if(size >= sizeof(struct mach_header))
-		memcpy(&magic, addr, sizeof(uint32_t));
-	    /* see if this file is a 32-bit Mach-O file */
-	    if(size >= sizeof(struct mach_header) &&
-	       (magic == MH_MAGIC ||
-		magic == SWAP_INT(MH_MAGIC))){
-#ifdef ALIGNMENT_CHECKS
-		if(ofile->fat_archs[i].offset % 4 != 0){
-		    error("fat file: %s architecture %s malformed for a 32-bit "
-			  "object file (offset is not a multiple of 4)",
-			  ofile->file_name, arch_flag->name);
-		    ofile_unmap(ofile);
-#ifdef OFI
-		    return(NSObjectFileImageFormat);
-#else
-		    return(FALSE);
-#endif
-		}
-#endif /* ALIGNMENT_CHECKS */
-		ofile->arch_type = OFILE_Mach_O;
-		ofile->object_addr = addr;
-		ofile->object_size = size;
-		if(magic == MH_MAGIC)
-		    ofile->object_byte_sex = host_byte_sex;
-		else
-		    ofile->object_byte_sex =
-			host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
-			LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
-		ofile->mh = (struct mach_header *)addr;
-		ofile->load_commands = (struct load_command *)(addr +
-					    sizeof(struct mach_header));
-		if(check_Mach_O(ofile) == CHECK_BAD){
-		    ofile_unmap(ofile);
-#ifdef OFI
-		    return(NSObjectFileImageFormat);
-#else
-		    return(FALSE);
-#endif
-		}
-		if(object_name != NULL){
-		    error("fat file: %s architecture %s is not an archive "
-			  "(object_name to ofile_map() can't be specified to "
-			  "be other than NULL)", ofile->file_name,
-			  arch_flag->name);
-		    goto cleanup;
-		}
-	    }
-	    /* see if this file is a 64-bit Mach-O file */
-	    else if(size >= sizeof(struct mach_header_64) &&
-	            (magic == MH_MAGIC_64 ||
-		     magic == SWAP_INT(MH_MAGIC_64))){
-#ifdef ALIGNMENT_CHECKS
-		if(ofile->fat_archs[i].offset % 8 != 0){
-		    error("fat file: %s architecture %s malformed for a 64-bit "
-			  "object file (offset is not a multiple of 8)",
-			  ofile->file_name, arch_flag->name);
-		    ofile_unmap(ofile);
-#ifdef OFI
-		    return(NSObjectFileImageFormat);
-#else
-		    return(FALSE);
-#endif
-		}
-#endif /* ALIGNMENT_CHECKS */
-		ofile->arch_type = OFILE_Mach_O;
-		ofile->object_addr = addr;
-		ofile->object_size = size;
-		if(magic == MH_MAGIC_64)
-		    ofile->object_byte_sex = host_byte_sex;
-		else
-		    ofile->object_byte_sex =
-			host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
-			LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
-		ofile->mh64 = (struct mach_header_64 *)addr;
-		ofile->load_commands = (struct load_command *)(addr +
-					sizeof(struct mach_header_64));
-		if(check_Mach_O(ofile) == CHECK_BAD){
-		    ofile_unmap(ofile);
-#ifdef OFI
-		    return(NSObjectFileImageFormat);
-#else
-		    return(FALSE);
-#endif
-		}
-		if(object_name != NULL){
-		    error("fat file: %s architecture %s is not an archive "
-			  "(object_name to ofile_map() can't be specified to "
-			  "be other than NULL)", ofile->file_name,
-			  arch_flag->name);
-		    goto cleanup;
-		}
-	    }
-	    /* see if this file is an archive file */
-	    else if(size >= SARMAG && strncmp(addr, ARMAG, SARMAG) == 0){
-		ofile->arch_type = OFILE_ARCHIVE;
-		if(check_archive(ofile, FALSE) == CHECK_BAD){
-		    ofile_unmap(ofile);
-#ifdef OFI
-		    return(NSObjectFileImageInappropriateFile);
-#else
-		    return(FALSE);
-#endif
-		}
-#ifdef ALIGNMENT_CHECKS
-		if(ofile->archive_cputype != 0 &&
-		   ofile->fat_archs[i].offset % sizeof(uint32_t) != 0){
-		    error("fat file: %s architecture %s malformed archive that "
-			  "contains object files (offset to archive is not a "
-			  "multiple of sizeof(uint32_t))",
-			  ofile->file_name, arch_flag->name);
-		    ofile_unmap(ofile);
-#ifdef OFI
-		    return(NSObjectFileImageInappropriateFile);
-#else
-		    return(FALSE);
-#endif
-		}
-#endif /* ALIGNMENT_CHECKS */
-		if(object_name != NULL){
-		    if(ofile_specific_member(object_name, ofile) == FALSE)
-			goto cleanup;
-		}
-	    }
-	    /* this file type is now known to be unknown to this program */
-	    else{
-		ofile->file_type = OFILE_UNKNOWN;
-		if(object_name != NULL){
-		    error("fat file: %s architecture %s is not an archive "
-			  "(object_name to ofile_map() can't be specified to "
-			  "be other than NULL)", ofile->file_name,
-			  arch_flag->name);
-		    goto cleanup;
-		}
-	    }
-	}
-	/* see if this file is a 32-bit Mach-O file */
-	else if(size >= sizeof(struct mach_header) &&
-		(magic == MH_MAGIC ||
-		 magic == SWAP_INT(MH_MAGIC))){
-	    ofile->file_type = OFILE_Mach_O;
-	    ofile->object_addr = addr;
-	    ofile->object_size = size;
-	    if(magic == MH_MAGIC)
-		ofile->object_byte_sex = host_byte_sex;
-	    else
-		ofile->object_byte_sex = host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
-				 LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
-	    ofile->mh = (struct mach_header *)addr;
-	    ofile->load_commands = (struct load_command *)(addr +
-				    sizeof(struct mach_header));
-	    if(check_Mach_O(ofile) == CHECK_BAD){
-		ofile_unmap(ofile);
-#ifdef OFI
-		return(NSObjectFileImageFormat);
-#else
-		return(FALSE);
-#endif
-	    }
-	    if(object_name != NULL){
-		error("file: %s is not an archive (object_name to ofile_map() "
-		      "can't be specified to be other than NULL)",
-		      ofile->file_name);
-		goto cleanup;
-	    }
-	    if(arch_flag != NULL){
-		if(arch_flag->cputype != ofile->mh_cputype &&
-		   (arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) !=
-		   (ofile->mh_cpusubtype & ~CPU_SUBTYPE_MASK)){
-#ifdef OFI
-		    ofile_unmap(ofile);
-		    return(NSObjectFileImageArch);
-#else
-		    error("object file: %s does not match specified arch_flag: "
-			  "%s passed to ofile_map()", ofile->file_name,
-			  arch_flag->name);
-		    ofile_unmap(ofile);
-		    return(FALSE);
-#endif
-		    goto cleanup;
-		}
-	    }
-	}
-	/* see if this file is a 64-bit Mach-O file */
-	else if(size >= sizeof(struct mach_header_64) &&
-		(magic == MH_MAGIC_64 ||
-		 magic == SWAP_INT(MH_MAGIC_64))){
-	    ofile->file_type = OFILE_Mach_O;
-	    ofile->object_addr = addr;
-	    ofile->object_size = size;
-	    if(magic == MH_MAGIC_64)
-		ofile->object_byte_sex = host_byte_sex;
-	    else
-		ofile->object_byte_sex = host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
-				 LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
-	    ofile->mh64 = (struct mach_header_64 *)addr;
-	    ofile->load_commands = (struct load_command *)(addr +
-				    sizeof(struct mach_header_64));
-	    if(check_Mach_O(ofile) == CHECK_BAD){
-		ofile_unmap(ofile);
-#ifdef OFI
-		return(NSObjectFileImageFormat);
-#else
-		return(FALSE);
-#endif
-	    }
-	    if(object_name != NULL){
-		error("file: %s is not an archive (object_name to ofile_map() "
-		      "can't be specified to be other than NULL)",
-		      ofile->file_name);
-		goto cleanup;
-	    }
-	    if(arch_flag != NULL){
-		if(arch_flag->cputype != ofile->mh_cputype &&
-		   (arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) !=
-		   (ofile->mh_cpusubtype & ~CPU_SUBTYPE_MASK)){
-#ifdef OFI
-		    ofile_unmap(ofile);
-		    return(NSObjectFileImageArch);
-#else
-		    error("object file: %s does not match specified arch_flag: "
-			  "%s passed to ofile_map()", ofile->file_name,
-			  arch_flag->name);
-		    ofile_unmap(ofile);
-		    return(FALSE);
-#endif
-		    goto cleanup;
-		}
-	    }
-	}
-	/* see if this file is an archive file */
-	else if(size >= SARMAG && strncmp(addr, ARMAG, SARMAG) == 0){
-	    ofile->file_type = OFILE_ARCHIVE;
-	    if(check_archive(ofile, archives_with_fat_objects) == CHECK_BAD)
-		goto cleanup;
-	    if(object_name != NULL){
-		if(ofile_specific_member(object_name, ofile) == FALSE)
-		    goto cleanup;
-		if(arch_flag != NULL){
-		    if(arch_flag->cputype != ofile->mh_cputype &&
-		       (arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) !=
-		       (ofile->mh_cpusubtype & ~CPU_SUBTYPE_MASK)){
-			error("object file: %s(%.*s) does not match specified "
-			    "arch_flag: %s passed to ofile_map()",
-			    ofile->file_name, (int)ofile->member_name_size,
-			    ofile->member_name, arch_flag->name);
-			goto cleanup;
-		    }
-		}
-	    }
-	    else{
-		if(arch_flag != NULL){
-		    if(arch_flag->cputype != ofile->archive_cputype &&
-		       (arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) !=
-		       (ofile->archive_cpusubtype & ~CPU_SUBTYPE_MASK)){
-			error("archive file: %s objects do not match specified "
-			      "arch_flag: %s passed to ofile_map()",
-			      ofile->file_name, arch_flag->name);
-			goto cleanup;
-		    }
-		}
-	    }
-	}
-	/* this file type is now known to be unknown to this program */
-	else{
-#ifndef OTOOL
-unknown:
-#endif
-#ifndef OFI
-#ifdef LTO_SUPPORT
-	    if(is_llvm_bitcode(ofile, ofile->file_addr, ofile->file_size) ==
-	       TRUE){
-		ofile->file_type = OFILE_LLVM_BITCODE;
-		if(arch_flag != NULL){
-		    if(arch_flag->cputype != ofile->lto_cputype &&
-		       (arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) !=
-		       (ofile->lto_cpusubtype & ~CPU_SUBTYPE_MASK)){
-			error("llvm bitcode file: %s does not match specified "
-			      "arch_flag: %s passed to ofile_map()",
-			      ofile->file_name, arch_flag->name);
-			goto cleanup;
-		    }
-		}
-		if(object_name != NULL){
-		    error("file: %s is not an archive (object_name to "
-			  "ofile_map() can't be specified to be other than "
-			  "NULL)", ofile->file_name);
-		    goto cleanup;
-		}
-		goto success;
-	    }
-	    else
-#endif /* LTO_SUPPORT */
-#endif /* OFI */
-		ofile->file_type = OFILE_UNKNOWN;
-	    if(arch_flag != NULL){
-#ifdef OFI
-		ofile_unmap(ofile);
-		return(NSObjectFileImageInappropriateFile);
-#else
-		error("file: %s is unknown type (arch_flag to ofile_map() "
-		      "can't be specified to be other than NULL)",
-		      ofile->file_name);
-		ofile_unmap(ofile);
-		return(FALSE);
-#endif
-	    }
-	    if(object_name != NULL){
-		error("file: %s is not an archive (object_name to ofile_map() "
-		      "can't be specified to be other than NULL)",
-		      ofile->file_name);
-		goto cleanup;
-	    }
-	}
-success:
-	return(TRUE);
-
-cleanup:
-	ofile_unmap(ofile);
-	return(FALSE);
-}
-
-/*
- * ofile_unmap() deallocates the memory associated with the specified ofile
- * struct.
- */
-__private_extern__
-void
-ofile_unmap(
-struct ofile *ofile)
-{
-    kern_return_t r;
-
-	if(ofile->file_addr != NULL){
-	    if((r = vm_deallocate(mach_task_self(),
-				 (vm_address_t)ofile->file_addr,
-				 (vm_size_t)ofile->file_size)) != KERN_SUCCESS){
-		my_mach_error(r, "Can't vm_deallocate mapped memory for file: "
-			      "%s", ofile->file_name);
-	    }
-	}
-	if(ofile->file_name != NULL)
-	    free(ofile->file_name);
-	if(ofile->arch_flag.name != NULL)
-	    free(ofile->arch_flag.name);
-	memset(ofile, '\0', sizeof(struct ofile));
-}
-
-/*
- * ofile_first_arch() sets up the ofile struct for a fat file to the first arch
- * in it.
- */
-__private_extern__
-enum bool
-ofile_first_arch(
-struct ofile *ofile)
-{
-	if(ofile->file_type == OFILE_FAT ||
-	   (ofile->file_type == OFILE_ARCHIVE &&
-	    ofile->member_type == OFILE_FAT) )
-	    return(ofile_specific_arch(ofile, 0));
-	else{
-	    error("ofile_first_arch() called and file type of: %s is not a fat "
-		  "file\n", ofile->file_name);
-	    return(FALSE);
-	}
-}
-
-/*
- * ofile_next_arch() sets up the ofile struct for a fat file to the next arch
- * in it.
- */
-__private_extern__
-enum bool
-ofile_next_arch(
-struct ofile *ofile)
-{
-	if(ofile->file_type == OFILE_FAT ||
-	   (ofile->file_type == OFILE_ARCHIVE &&
-	    ofile->member_type == OFILE_FAT) ){
-	    if(ofile->narch + 1 < ofile->fat_header->nfat_arch)
-		return(ofile_specific_arch(ofile, ofile->narch + 1));
-	    else
-		return(FALSE);
-	}
-	else{
-	    error("ofile_next_arch() called and file type of: %s is not a fat "
-		  "file\n", ofile->file_name);
-	    return(FALSE);
-	}
-}
-
-/*
- * ofile_specific_arch() sets up the ofile struct for the fat file for the
- * specified narch.
- */
-static
-enum bool
-ofile_specific_arch(
-struct ofile *ofile,
-uint32_t narch)
-{
-    char *addr;
-    uint32_t size;
-    uint32_t magic;
-    enum byte_sex host_byte_sex;
-
-	ofile->narch = narch;
-	ofile->arch_type = OFILE_UNKNOWN;
-	if(ofile->arch_flag.name != NULL)
-	    free(ofile->arch_flag.name);
-	ofile->arch_flag.name = NULL;
-	ofile->arch_flag.cputype = 0;
-	ofile->arch_flag.cpusubtype = 0;
-	ofile->archive_cputype = 0;
-	ofile->archive_cpusubtype = 0;
-	ofile->object_addr = NULL;
-	ofile->object_size = 0;
-	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
-	ofile->mh = NULL;
-	ofile->mh64 = NULL;
-	ofile->load_commands = NULL;
-
-	ofile->arch_flag.cputype = ofile->fat_archs[ofile->narch].cputype;
-	ofile->arch_flag.cpusubtype = ofile->fat_archs[ofile->narch].cpusubtype;
-	set_arch_flag_name(&(ofile->arch_flag));
-
-
-	/* Now determine the file type for this specific architecture */
-	if(ofile->file_type == OFILE_FAT){
-	    ofile->member_offset = 0;
-	    ofile->member_addr = NULL;
-	    ofile->member_size = 0;
-	    ofile->member_ar_hdr = NULL;
-	    ofile->member_type = OFILE_UNKNOWN;
-
-	    size = ofile->fat_archs[ofile->narch].size;
-	    addr = ofile->file_addr + ofile->fat_archs[ofile->narch].offset;
-	}
-	else{
-	    if(ofile->file_type != OFILE_ARCHIVE ||
-	       ofile->member_type != OFILE_FAT){
-		error("internal error. ofile_specific_arch() called but file "
-		      "is not a fat file or an archive with a fat member ");
-	    }
-	    size = ofile->fat_archs[ofile->narch].size;
-	    addr = ofile->file_addr +
-		   ofile->member_offset +
-		   ofile->fat_archs[ofile->narch].offset;
-	}
-
-#ifdef OTOOL
-	if(addr - ofile->file_addr > (ptrdiff_t)ofile->file_size){
-	    error("fat file: %s offset to architecture %s extends past end "
-		  "of file", ofile->file_name, ofile->arch_flag.name);
-	    return(FALSE);
-	}
-	if(addr + size > ofile->file_addr + ofile->file_size)
-	    size = (ofile->file_addr + ofile->file_size) - addr;
-#endif /* OTOOL */
-
-	if(size >= sizeof(struct mach_header))
-	    memcpy(&magic, addr, sizeof(uint32_t));
-	/* see if this file is a 32-bit Mach-O file */
-	if(size >= sizeof(struct mach_header) &&
-	   (magic == MH_MAGIC || magic == SWAP_INT(MH_MAGIC))){
-#ifdef ALIGNMENT_CHECKS
-	    if(ofile->fat_archs[ofile->narch].offset % 4 != 0){
-		if(ofile->file_type == OFILE_ARCHIVE){
-		    error("fat file: %s(%.*s) architecture %s malformed for a "
-			  "32-bit object file (offset is not a multiple of 4)",
-			  ofile->file_name, (int)ofile->member_name_size,
-			  ofile->member_name, ofile->arch_flag.name);
-		}
-		else
-		    error("fat file: %s architecture %s malformed for a 32-bit "
-			  "object file (offset is not a multiple of 4)",
-			  ofile->file_name, ofile->arch_flag.name);
-		goto cleanup;
-	    }
-#endif /* ALIGNMENT_CHECKS */
-	    ofile->arch_type = OFILE_Mach_O;
-	    ofile->object_addr = addr;
-	    ofile->object_size = size;
-	    host_byte_sex = get_host_byte_sex();
-	    if(magic == MH_MAGIC)
-		ofile->object_byte_sex = host_byte_sex;
-	    else
-		ofile->object_byte_sex =
-		    host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
-		    LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
-	    ofile->mh = (struct mach_header *)addr;
-	    ofile->load_commands = (struct load_command *)(addr +
-				    sizeof(struct mach_header));
-	    if(check_Mach_O(ofile) == CHECK_BAD)
-		goto cleanup;
-	}
-	/* see if this file is a 64-bit Mach-O file */
-	else if(size >= sizeof(struct mach_header_64) &&
-	   (magic == MH_MAGIC_64 || magic == SWAP_INT(MH_MAGIC_64))){
-#ifdef ALIGNMENT_CHECKS
-	    if(ofile->fat_archs[ofile->narch].offset % 8 != 0){
-		if(ofile->file_type == OFILE_ARCHIVE){
-		    error("fat file: %s(%.*s) architecture %s malformed for an "
-			  "object file (offset is not a multiple of 8)",
-			  ofile->file_name, (int)ofile->member_name_size,
-			  ofile->member_name, ofile->arch_flag.name);
-		}
-		else
-		    error("fat file: %s architecture %s malformed for a 64-bit "
-			  "object file (offset is not a multiple of 8",
-			  ofile->file_name, ofile->arch_flag.name);
-		goto cleanup;
-	    }
-#endif /* ALIGNMENT_CHECKS */
-	    ofile->arch_type = OFILE_Mach_O;
-	    ofile->object_addr = addr;
-	    ofile->object_size = size;
-	    host_byte_sex = get_host_byte_sex();
-	    if(magic == MH_MAGIC_64)
-		ofile->object_byte_sex = host_byte_sex;
-	    else
-		ofile->object_byte_sex =
-		    host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
-		    LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
-	    ofile->mh64 = (struct mach_header_64 *)addr;
-	    ofile->load_commands = (struct load_command *)(addr +
-				    sizeof(struct mach_header_64));
-	    if(check_Mach_O(ofile) == CHECK_BAD)
-		goto cleanup;
-	}
-	/* see if this file is an archive file */
-	else if(size >= SARMAG && strncmp(addr, ARMAG, SARMAG) == 0){
-	    ofile->arch_type = OFILE_ARCHIVE;
-	    if(check_archive(ofile, FALSE) == CHECK_BAD)
-		goto cleanup;
-#ifdef ALIGNMENT_CHECKS
-	    if(ofile->archive_cputype != 0 &&
-	       ofile->fat_archs[ofile->narch].offset %
-		sizeof(uint32_t) != 0){
-		error("fat file: %s architecture %s malformed archive that "
-		      "contains object files (offset to archive is not a "
-		      "multiple of sizeof(uint32_t))",
-		      ofile->file_name, ofile->arch_flag.name);
-		goto cleanup;
-	    }
-#endif /* ALIGNMENT_CHECKS */
-	}
-	/*
-	 * This type for this architecture is now known to be unknown to this
-	 * program.
-	 */
-	else{
-#ifdef LTO_SUPPORT
-	    if(is_llvm_bitcode(ofile, addr, size) == TRUE){
-		ofile->arch_type = OFILE_LLVM_BITCODE;
-		ofile->object_addr = addr;
-		ofile->object_size = size;
-	    }
-	    else
-#endif /* LTO_SUPPORT */
-	        ofile->arch_type = OFILE_UNKNOWN;
-	}
-	return(TRUE);
-cleanup:
-	ofile->narch = 0;;
-	ofile->arch_type = OFILE_UNKNOWN;
-	if(ofile->arch_flag.name != NULL)
-	    free(ofile->arch_flag.name);
-	ofile->arch_flag.name = NULL;
-	ofile->arch_flag.cputype = 0;
-	ofile->arch_flag.cpusubtype = 0;
-	if(ofile->file_type != OFILE_ARCHIVE){
-	    ofile->member_offset = 0;
-	    ofile->member_addr = NULL;
-	    ofile->member_size = 0;
-	    ofile->member_ar_hdr = NULL;
-	    ofile->member_type = OFILE_UNKNOWN;
-	}
-	ofile->archive_cputype = 0;
-	ofile->archive_cpusubtype = 0;
-	ofile->object_addr = NULL;
-	ofile->object_size = 0;
-	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
-	ofile->mh = NULL;
-	ofile->mh64 = NULL;
-	ofile->load_commands = NULL;
-	return(FALSE);
-}
-
-/*
- * ofile_first_member() set up the ofile structure (the member_* fields and
- * the object file fields if the first member is an object file) for the first
- * member.
- */
-__private_extern__
-enum bool
-ofile_first_member(
-struct ofile *ofile)
-{
-    char *addr;
-    uint64_t size, offset;
-    uint32_t magic;
-    enum byte_sex host_byte_sex;
-    struct ar_hdr *ar_hdr;
-    uint32_t ar_name_size;
-
-	/* These fields are to be filled in by this routine, clear them first */
-	ofile->member_offset = 0;
-	ofile->member_addr = NULL;
-	ofile->member_size = 0;
-	ofile->member_ar_hdr = NULL;
-	ofile->member_name = NULL;
-	ofile->member_name_size = 0;
-	ofile->member_type = OFILE_UNKNOWN;
-	ofile->object_addr = NULL;
-	ofile->object_size = 0;
-	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
-	ofile->mh = NULL;
-	ofile->mh64 = NULL;
-	ofile->load_commands = NULL;
-#ifdef LTO_SUPPORT
-	/*
-	 * Note: it is up to the caller if they want to call free_lto() on this
-	 * when iterating through the members of an archive. 
-	 */
-	ofile->lto = NULL;
-#endif /* LTO_SUPPORT */
-
-	/*
-	 * Get the address and size of the archive.
-	 */
-	if(ofile->file_type == OFILE_FAT){
-	    if(ofile->arch_type != OFILE_ARCHIVE){
-		error("ofile_first_member() called on fat file: %s with a "
-		      "non-archive architecture or no architecture selected\n",
-		      ofile->file_name);
-		return(FALSE);
-	    }
-	    addr = ofile->file_addr + ofile->fat_archs[ofile->narch].offset;
-	    size = ofile->fat_archs[ofile->narch].size;
-	}
-	else if(ofile->file_type == OFILE_ARCHIVE){
-	    addr = ofile->file_addr;
-	    size = ofile->file_size;
-	}
-	else{
-	    error("ofile_first_member() called and file type of %s is "
-		  "OFILE_UNKNOWN\n", ofile->file_name);
-	    return(FALSE);
-	}
-#ifdef OTOOL
-	if((addr + SARMAG) - ofile->file_addr > (ptrdiff_t)ofile->file_size){
-	    archive_error(ofile, "offset to first member extends past the end "
-			  "of the file");
-	    return(FALSE);
-	}
-	if(addr + size > ofile->file_addr + ofile->file_size)
-	    size = (ofile->file_addr + ofile->file_size) - addr;
-#endif /* OTOOL */
-	if(size < SARMAG || strncmp(addr, ARMAG, SARMAG) != 0){
-	    archive_error(ofile, "internal error. ofile_first_member() "
-			  "called but file does not have an archive magic "
-			  "string");
-	    return(FALSE);
-	}
-
-	offset = SARMAG;
-	if(offset != size && offset + sizeof(struct ar_hdr) > size){
-	    archive_error(ofile, "truncated or malformed (archive header of "
-			  "first member extends past the end of the file)");
-	    return(FALSE);
-	}
-
-	/* check for empty archive */
-	if(size == offset)
-	    return(FALSE);
-
-	/* now we know there is a first member so set it up */
-	ar_hdr = (struct ar_hdr *)(addr + offset);
-	offset += sizeof(struct ar_hdr);
-	ofile->member_offset = offset;
-	ofile->member_addr = addr + offset;
-	ofile->member_size = strtoul(ar_hdr->ar_size, NULL, 10);
-	ofile->member_ar_hdr = ar_hdr;
-	ofile->member_type = OFILE_UNKNOWN;
-	ofile->member_name = ar_hdr->ar_name;
-	if(strncmp(ofile->member_name, AR_EFMT1, sizeof(AR_EFMT1) - 1) == 0){
-	    ofile->member_name = ar_hdr->ar_name + sizeof(struct ar_hdr);
-	    ar_name_size = strtoul(ar_hdr->ar_name + sizeof(AR_EFMT1) - 1,
-				   NULL, 10);
-	    ofile->member_name_size = ar_name_size;
-	    ofile->member_offset += ar_name_size;
-	    ofile->member_addr += ar_name_size;
-	    ofile->member_size -= ar_name_size;
-	}
-	else{
-	    ofile->member_name_size = size_ar_name(ar_hdr);
-	    ar_name_size = 0;
-	}
-	/* Clear these in case there is no table of contents */
-	ofile->toc_addr = NULL;
-	ofile->toc_size = 0;
-	ofile->toc_ar_hdr = NULL;
-	ofile->toc_name = NULL;
-	ofile->toc_name_size = 0;
-	ofile->toc_ranlibs = NULL;
-	ofile->toc_nranlibs = 0;
-	ofile->toc_strings = NULL;
-	ofile->toc_strsize = 0;
-	ofile->toc_bad = FALSE;
-
-	host_byte_sex = get_host_byte_sex();
-
-	if(ofile->member_size > sizeof(uint32_t)){
-	    memcpy(&magic, ofile->member_addr, sizeof(uint32_t));
-#ifdef __BIG_ENDIAN__
-	    if(magic == FAT_MAGIC)
-#endif /* __BIG_ENDIAN__ */
-#ifdef __LITTLE_ENDIAN__
-	    if(magic == SWAP_INT(FAT_MAGIC))
-#endif /* __LITTLE_ENDIAN__ */
-	    {
-		ofile->member_type = OFILE_FAT;
-		ofile->fat_header =
-			(struct fat_header *)(ofile->member_addr);
-#ifdef __LITTLE_ENDIAN__
-		swap_fat_header(ofile->fat_header, host_byte_sex);
-#endif /* __LITTLE_ENDIAN__ */
-		if(sizeof(struct fat_header) +
-		   ofile->fat_header->nfat_arch *
-		   sizeof(struct fat_arch) > ofile->member_size){
-		    archive_member_error(ofile, "fat file truncated or "
-			    "malformed (fat_arch structs would extend past "
-			    "the end of the archive member)");
-		    goto fatcleanup;
-		}
-		ofile->fat_archs = (struct fat_arch *)
-		    (ofile->member_addr + sizeof(struct fat_header));
-#ifdef __LITTLE_ENDIAN__
-		swap_fat_arch(ofile->fat_archs,
-			      ofile->fat_header->nfat_arch, host_byte_sex);
-#endif /* __LITTLE_ENDIAN__ */
-		if(check_fat_object_in_archive(ofile) == FALSE)
-		    goto fatcleanup;
-	    }
-	    else if(size - (offset + ar_name_size) >=
-		    sizeof(struct mach_header) &&
-	       (magic == MH_MAGIC || magic == SWAP_INT(MH_MAGIC))){
-#ifdef ALIGNMENT_CHECKS
-		if((offset + ar_name_size) % 4 != 0){
-		    archive_member_error(ofile, "offset in archive not a "
-			"multiple of 4 (must be since member is a 32-bit "
-			"object file)");
-		    goto cleanup;
-		}
-#endif /* ALIGNMENT_CHECKS */
-		ofile->member_type = OFILE_Mach_O;
-		ofile->object_addr = ofile->member_addr;
-		ofile->object_size = ofile->member_size;
-		if(magic == MH_MAGIC)
-		    ofile->object_byte_sex = host_byte_sex;
-		else
-		    ofile->object_byte_sex =
-			   host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
-			   LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
-		ofile->mh = (struct mach_header *)(ofile->object_addr);
-		ofile->load_commands = (struct load_command *)
-		    (ofile->object_addr + sizeof(struct mach_header));
-		if(check_Mach_O(ofile) == CHECK_BAD)
-		    goto cleanup;
-	    }
-	    else if(size - (offset + ar_name_size) >=
-		    sizeof(struct mach_header_64) &&
-	       (magic == MH_MAGIC_64 || magic == SWAP_INT(MH_MAGIC_64))){
-#ifdef ALIGNMENT_CHECKS_ARCHIVE_64_BIT
-		if(archive_64_bit_align_warning == FALSE &&
-		   (offset + ar_name_size) % 8 != 0){
-		    temporary_archive_member_warning(ofile, "offset in archive "
-			"not a multiple of 8 (must be since member is an "
-			"64-bit object file)");
-		    archive_64_bit_align_warning = TRUE;
-		    /* goto cleanup; */
-		}
-#endif /* ALIGNMENT_CHECKS_ARCHIVE_64_BIT */
-		ofile->member_type = OFILE_Mach_O;
-		ofile->object_addr = ofile->member_addr;
-		ofile->object_size = ofile->member_size;
-		if(magic == MH_MAGIC_64)
-		    ofile->object_byte_sex = host_byte_sex;
-		else
-		    ofile->object_byte_sex =
-			   host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
-			   LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
-		ofile->mh64 = (struct mach_header_64 *)(ofile->object_addr);
-		ofile->load_commands = (struct load_command *)
-		    (ofile->object_addr + sizeof(struct mach_header_64));
-		if(check_Mach_O(ofile) == CHECK_BAD)
-		    goto cleanup;
-	    }
-	    if(ofile->member_type == OFILE_UNKNOWN &&
-	       (strncmp(ofile->member_name, SYMDEF_SORTED,
-		        sizeof(SYMDEF_SORTED) - 1) == 0 ||
-	        strncmp(ofile->member_name, SYMDEF,
-		        sizeof(SYMDEF) - 1) == 0)){
-		ofile->toc_addr = ofile->member_addr;
-		ofile->toc_size = ofile->member_size;
-		ofile->toc_ar_hdr = ofile->member_ar_hdr;
-		ofile->toc_name = ofile->member_name;
-		ofile->toc_name_size = ofile->member_name_size;
-		if(check_archive_toc(ofile) == CHECK_BAD)
-		    goto cleanup;
-	    }
-#ifdef LTO_SUPPORT
-	    if(ofile->member_type == OFILE_UNKNOWN &&
-	       strncmp(ofile->member_name, SYMDEF_SORTED,
-		       sizeof(SYMDEF_SORTED) - 1) != 0 &&
-	       strncmp(ofile->member_name, SYMDEF,
-		       sizeof(SYMDEF) - 1) != 0 &&
-	       is_llvm_bitcode(ofile, ofile->member_addr, ofile->member_size) ==
-	       TRUE){
-		ofile->member_type = OFILE_LLVM_BITCODE;
-		ofile->object_addr = ofile->member_addr;
-		ofile->object_size = ofile->member_size;
-	    }
-#endif /* LTO_SUPPORT */
-	}
-	return(TRUE);
-
-fatcleanup:
-	ofile->fat_header = NULL;
-	ofile->fat_archs = NULL;
-cleanup:
-	ofile->member_offset = 0;
-	ofile->member_addr = 0;
-	ofile->member_size = 0;
-	ofile->member_ar_hdr = NULL;
-	ofile->member_name = NULL;
-	ofile->member_name_size = 0;
-	ofile->member_type = OFILE_UNKNOWN;
-	ofile->object_addr = NULL;
-	ofile->object_size = 0;
-	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
-	ofile->mh = NULL;
-	ofile->mh64 = NULL;
-	ofile->load_commands = NULL;
-#ifdef LTO_SUPPORT
-	ofile->lto = NULL;
-	ofile->lto_cputype = 0;
-	ofile->lto_cpusubtype = 0;
-#endif /* LTO_SUPPORT */
-	return(FALSE);
-}
-
-/*
- * ofile_next_member() set up the ofile structure (the member_* fields and
- * the object file fields if the next member is an object file) for the next
- * member.
- */
-__private_extern__
-enum bool
-ofile_next_member(
-struct ofile *ofile)
-{
-    char *addr;
-    uint64_t size, offset;
-    uint32_t magic;
-    enum byte_sex host_byte_sex;
-    struct ar_hdr *ar_hdr;
-    uint32_t ar_name_size;
-
-	/*
-	 * Get the address and size of the archive.
-	 */
-	if(ofile->file_type == OFILE_FAT){
-	    if(ofile->arch_type != OFILE_ARCHIVE){
-		error("ofile_next_member() called on fat file: %s with a "
-		      "non-archive architecture or no architecture selected\n",
-		      ofile->file_name);
-		return(FALSE);
-	    }
-	    addr = ofile->file_addr + ofile->fat_archs[ofile->narch].offset;
-	    size = ofile->fat_archs[ofile->narch].size;
-	}
-	else if(ofile->file_type == OFILE_ARCHIVE){
-	    addr = ofile->file_addr;
-	    size = ofile->file_size;
-	}
-	else{
-	    error("ofile_next_member() called and file type of %s is "
-		  "OFILE_UNKNOWN\n", ofile->file_name);
-	    return(FALSE);
-	}
-	if(size < SARMAG || strncmp(addr, ARMAG, SARMAG) != 0){
-	    archive_error(ofile, "internal error. ofile_next_member() "
-			  "called but file does not have an archive magic "
-			  "string");
-	    return(FALSE);
-	}
-	if(ofile->member_ar_hdr == NULL){
-	    archive_error(ofile, "internal error. ofile_next_member() called "
-			  "but the ofile struct does not have an archive "
-			  "member selected");
-	    return(FALSE);
-	}
-
-	/* figure out the offset to the next member */
-	offset = ofile->member_offset + rnd(ofile->member_size,sizeof(short));
-#ifdef OTOOL
-	if((addr - ofile->file_addr) + offset > ofile->file_size){
-	    archive_error(ofile, "offset to next member extends past the end "
-			  "of the file");
-	    return(FALSE);
-	}
-#endif /* OTOOL */
-	/* if now at the end of the file then no more members */
-	if(offset == size)
-	     goto cleanup;
-	if(offset > size){
-	    archive_error(ofile, "truncated or malformed (archive header of "
-			  "next member extends past the end of the file)");
-	    return(FALSE);
-	}
-
-	/* now we know there is a next member so set it up */
-	ar_hdr = (struct ar_hdr *)(addr + offset);
-	offset += sizeof(struct ar_hdr);
-	ofile->member_offset = offset;
-	ofile->member_addr = addr + offset;
-	ofile->member_size = strtoul(ar_hdr->ar_size, NULL, 10);
-	ofile->member_ar_hdr = ar_hdr;
-	ofile->member_name = ar_hdr->ar_name;
-	if(strncmp(ofile->member_name, AR_EFMT1, sizeof(AR_EFMT1) - 1) == 0){
-	    ofile->member_name = ar_hdr->ar_name + sizeof(struct ar_hdr);
-	    ar_name_size = strtoul(ar_hdr->ar_name + sizeof(AR_EFMT1) - 1,
-				   NULL, 10);
-	    ofile->member_name_size = ar_name_size;
-	    ofile->member_offset += ar_name_size;
-	    ofile->member_addr += ar_name_size;
-	    ofile->member_size -= ar_name_size;
-	}
-	else{
-	    ofile->member_name_size = size_ar_name(ar_hdr);
-	    ar_name_size = 0;
-	}
-	ofile->member_type = OFILE_UNKNOWN;
-	ofile->object_addr = NULL;
-	ofile->object_size = 0;
-	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
-	ofile->mh = NULL;
-	ofile->mh64 = NULL;
-	ofile->load_commands = NULL;
-
-	host_byte_sex = get_host_byte_sex();
-
-	if(ofile->member_size > sizeof(uint32_t)){
-	    memcpy(&magic, ofile->member_addr, sizeof(uint32_t));
-#ifdef __BIG_ENDIAN__
-	    if(magic == FAT_MAGIC)
-#endif /* __BIG_ENDIAN__ */
-#ifdef __LITTLE_ENDIAN__
-	    if(magic == SWAP_INT(FAT_MAGIC))
-#endif /* __LITTLE_ENDIAN__ */
-	    {
-		ofile->member_type = OFILE_FAT;
-		ofile->fat_header = (struct fat_header *)(ofile->member_addr);
-#ifdef __LITTLE_ENDIAN__
-		swap_fat_header(ofile->fat_header, host_byte_sex);
-#endif /* __LITTLE_ENDIAN__ */
-		if(sizeof(struct fat_header) +
-		   ofile->fat_header->nfat_arch *
-		   sizeof(struct fat_arch) > ofile->member_size){
-		    archive_member_error(ofile, "fat file truncated or "
-			    "malformed (fat_arch structs would extend past "
-			    "the end of the archive member)");
-		    goto cleanup;
-		}
-		ofile->fat_archs = (struct fat_arch *)(ofile->member_addr +
-					       sizeof(struct fat_header));
-#ifdef __LITTLE_ENDIAN__
-		swap_fat_arch(ofile->fat_archs,
-			      ofile->fat_header->nfat_arch, host_byte_sex);
-#endif /* __LITTLE_ENDIAN__ */
-		if(check_fat_object_in_archive(ofile) == FALSE)
-		    goto cleanup;
-	    }
-	    else if(size - (offset + ar_name_size) >=
-		    sizeof(struct mach_header) &&
-		    (magic == MH_MAGIC ||
-		     magic == SWAP_INT(MH_MAGIC))){
-#ifdef ALIGNMENT_CHECKS
-		if((offset + ar_name_size) % 4 != 0){
-		    archive_member_error(ofile, "offset in archive not "
-			"a multiple of 4 (must be since member is an 32-bit "
-			"object file)");
-		    goto cleanup;
-		}
-#endif /* ALIGNMENT_CHECKS */
-		ofile->member_type = OFILE_Mach_O;
-		ofile->object_addr = ofile->member_addr;
-		ofile->object_size = ofile->member_size;
-		if(magic == MH_MAGIC)
-		    ofile->object_byte_sex = host_byte_sex;
-		else
-		    ofile->object_byte_sex =
-			   host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
-			   LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
-		ofile->mh = (struct mach_header *)ofile->object_addr;
-		ofile->load_commands = (struct load_command *)
-			   (ofile->object_addr + sizeof(struct mach_header));
-		if(check_Mach_O(ofile) == CHECK_BAD)
-		    goto cleanup;
-	    }
-	    else if(size - (offset + ar_name_size) >=
-		    sizeof(struct mach_header_64) &&
-		    (magic == MH_MAGIC_64 ||
-		     magic == SWAP_INT(MH_MAGIC_64))){
-#ifdef ALIGNMENT_CHECKS_ARCHIVE_64_BIT
-		if(archive_64_bit_align_warning == FALSE &&
-		   (offset + ar_name_size) % 8 != 0){
-		    temporary_archive_member_warning(ofile, "offset in archive "
-			"not a multiple of 8 (must be since member is an "
-			"64-bit object file)");
-		    archive_64_bit_align_warning = TRUE;
-		    /* goto cleanup; */
-		}
-#endif /* ALIGNMENT_CHECKS_ARCHIVE_64_BIT */
-		ofile->member_type = OFILE_Mach_O;
-		ofile->object_addr = ofile->member_addr;
-		ofile->object_size = ofile->member_size;
-		if(magic == MH_MAGIC_64)
-		    ofile->object_byte_sex = host_byte_sex;
-		else
-		    ofile->object_byte_sex =
-			   host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
-			   LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
-		ofile->mh64 = (struct mach_header_64 *)ofile->object_addr;
-		ofile->load_commands = (struct load_command *)
-			   (ofile->object_addr + sizeof(struct mach_header_64));
-		if(check_Mach_O(ofile) == CHECK_BAD)
-		    goto cleanup;
-	    }
-#ifdef LTO_SUPPORT
-	    if(ofile->member_type == OFILE_UNKNOWN &&
-	       is_llvm_bitcode(ofile, ofile->member_addr, ofile->member_size) ==
-	       TRUE){
-		ofile->member_type = OFILE_LLVM_BITCODE;
-		ofile->object_addr = ofile->member_addr;
-		ofile->object_size = ofile->member_size;
-	    }
-#endif /* LTO_SUPPORT */
-	}
-	return(TRUE);
-
-cleanup:
-	if(ofile->member_type == OFILE_FAT){
-	    ofile->fat_header = NULL;
-	    ofile->fat_archs = NULL;
-	}
-	ofile->member_offset = 0;
-	ofile->member_addr = NULL;
-	ofile->member_size = 0;
-	ofile->member_ar_hdr = NULL;
-	ofile->member_name = NULL;
-	ofile->member_name_size = 0;
-	ofile->member_type = OFILE_UNKNOWN;
-	ofile->object_addr = NULL;
-	ofile->object_size = 0;
-	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
-	ofile->mh = NULL;
-	ofile->mh64 = NULL;
-	ofile->load_commands = NULL;
-#ifdef LTO_SUPPORT
-	ofile->lto = NULL;
-	ofile->lto_cputype = 0;
-	ofile->lto_cpusubtype = 0;
-#endif /* LTO_SUPPORT */
-	return(FALSE);
-}
-
-/*
- * ofile_specific_member() set up the ofile structure (the member_* fields and
- * the object file fields if the member is an object file) for the specified
- * member member_name.
- */
-__private_extern__
-enum bool
-ofile_specific_member(
-const char *member_name,
-struct ofile *ofile)
-{
-    int32_t i;
-    char *addr;
-    uint64_t size, offset;
-    uint32_t magic;
-    enum byte_sex host_byte_sex;
-    char *ar_name;
-    uint32_t ar_name_size;
-    struct ar_hdr *ar_hdr;
-
-	/* These fields are to be filled in by this routine, clear them first */
-	ofile->member_offset = 0;
-	ofile->member_addr = NULL;
-	ofile->member_size = 0;
-	ofile->member_ar_hdr = NULL;
-	ofile->member_name = NULL;
-	ofile->member_name_size = 0;
-	ofile->member_type = OFILE_UNKNOWN;
-	ofile->object_addr = NULL;
-	ofile->object_size = 0;
-	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
-	ofile->mh = NULL;
-	ofile->mh64 = NULL;
-	ofile->load_commands = NULL;
-
-	/*
-	 * Get the address and size of the archive.
-	 */
-	if(ofile->file_type == OFILE_FAT){
-	    if(ofile->arch_type != OFILE_ARCHIVE){
-		error("ofile_specific_member() called on fat file: %s with a "
-		      "non-archive architecture or no architecture selected\n",
-		      ofile->file_name);
-		return(FALSE);
-	    }
-	    addr = ofile->file_addr + ofile->fat_archs[ofile->narch].offset;
-	    size = ofile->fat_archs[ofile->narch].size;
-	}
-	else if(ofile->file_type == OFILE_ARCHIVE){
-	    addr = ofile->file_addr;
-	    size = ofile->file_size;
-	}
-	else{
-	    error("ofile_specific_member() called and file type of %s is "
-		  "OFILE_UNKNOWN\n", ofile->file_name);
-	    return(FALSE);
-	}
-	if(size < SARMAG || strncmp(addr, ARMAG, SARMAG) != 0){
-	    archive_error(ofile, "internal error. ofile_specific_member() "
-			  "called but file does not have an archive magic "
-			  "string");
-	    return(FALSE);
-	}
-
-	offset = SARMAG;
-	if(offset != size && offset + sizeof(struct ar_hdr) > size){
-	    archive_error(ofile, "truncated or malformed (archive header of "
-			  "first member extends past the end of the file)");
-	    return(FALSE);
-	}
-	while(size > offset){
-	    ar_hdr = (struct ar_hdr *)(addr + offset);
-	    offset += sizeof(struct ar_hdr);
-	    if(strncmp(ar_hdr->ar_name, AR_EFMT1, sizeof(AR_EFMT1) - 1) == 0){
-#ifdef OTOOL
-		if(check_extend_format_1(ofile, ar_hdr, size - offset,
-				&ar_name_size) == CHECK_BAD){
-		    i = size_ar_name(ar_hdr);
-		    ar_name = ar_hdr->ar_name;
-		    ar_name_size = 0;
-		}
-		else
-#endif /* OTOOL */
-		{
-		    i = strtoul(ar_hdr->ar_name + sizeof(AR_EFMT1) - 1,NULL,10);
-		    ar_name = ar_hdr->ar_name + sizeof(struct ar_hdr);
-		    ar_name_size = i;
-		}
-	    }
-	    else{
-		i = size_ar_name(ar_hdr);
-		ar_name = ar_hdr->ar_name;
-		ar_name_size = 0;
-	    }
-	    if(i > 0 && strncmp(ar_name, member_name, i) == 0){
-
-		ofile->member_name = ar_name;
-		ofile->member_name_size = i;
-		ofile->member_offset = offset + ar_name_size;
-		ofile->member_addr = addr + offset + ar_name_size;
-		ofile->member_size = strtoul(ar_hdr->ar_size, NULL, 10) -
-				     ar_name_size;
-		ofile->member_ar_hdr = ar_hdr;
-		ofile->member_type = OFILE_UNKNOWN;
-
-		host_byte_sex = get_host_byte_sex();
-
-		if(ofile->member_size > sizeof(uint32_t)){
-		    memcpy(&magic, addr + offset + ar_name_size,
-			   sizeof(uint32_t));
-#ifdef __BIG_ENDIAN__
-		    if(magic == FAT_MAGIC)
-#endif /* __BIG_ENDIAN__ */
-#ifdef __LITTLE_ENDIAN__
-		    if(magic == SWAP_INT(FAT_MAGIC))
-#endif /* __LITTLE_ENDIAN__ */
-		    {
-			ofile->member_type = OFILE_FAT;
-			ofile->fat_header =
-			    (struct fat_header *)(addr + offset + ar_name_size);
-#ifdef __LITTLE_ENDIAN__
-			swap_fat_header(ofile->fat_header, host_byte_sex);
-#endif /* __LITTLE_ENDIAN__ */
-			if(sizeof(struct fat_header) +
-			   ofile->fat_header->nfat_arch *
-			   sizeof(struct fat_arch) > ofile->member_size){
-			    archive_member_error(ofile, "fat file truncated or "
-				    "malformed (fat_arch structs would extend "
-				    "past the end of the archive member)");
-			    goto fatcleanup;
-			}
-			ofile->fat_archs =
-			    (struct fat_arch *)(addr + offset + ar_name_size +
-					        sizeof(struct fat_header));
-#ifdef __LITTLE_ENDIAN__
-			swap_fat_arch(ofile->fat_archs,
-				      ofile->fat_header->nfat_arch,
-				      host_byte_sex);
-#endif /* __LITTLE_ENDIAN__ */
-			if(check_fat_object_in_archive(ofile) == FALSE)
-			    goto fatcleanup;
-		    }
-		    else if(size - (offset + ar_name_size) >=
-			    sizeof(struct mach_header) &&
-			   (magic == MH_MAGIC ||
-			    magic == SWAP_INT(MH_MAGIC))){
-#ifdef ALIGNMENT_CHECKS
-			if((offset + ar_name_size) % 4 != 0){
-			    archive_member_error(ofile, "offset in archive not "
-				"a multiple of 4) (must be since member is a "
-				"32-bit object file)");
-			    goto cleanup;
-			}
-#endif /* ALIGNMENT_CHECKS */
-			ofile->member_type = OFILE_Mach_O;
-			ofile->object_addr = ofile->member_addr;
-			ofile->object_size = ofile->member_size;
-			if(magic == MH_MAGIC)
-			    ofile->object_byte_sex = host_byte_sex;
-			else
-			    ofile->object_byte_sex =
-				   host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
-				   LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
-			ofile->mh = (struct mach_header *)ofile->object_addr;
-			ofile->load_commands = (struct load_command *)
-			    (ofile->object_addr + sizeof(struct mach_header));
-			if(check_Mach_O(ofile) == CHECK_BAD)
-			    goto cleanup;
-		    }
-		    else if(size - (offset + ar_name_size) >=
-			    sizeof(struct mach_header_64) &&
-			   (magic == MH_MAGIC_64 ||
-			    magic == SWAP_INT(MH_MAGIC_64))){
-#ifdef ALIGNMENT_CHECKS_ARCHIVE_64_BIT
-			if(archive_64_bit_align_warning == FALSE &&
-			   (offset + ar_name_size) % 8 != 0){
-			    temporary_archive_member_warning(ofile, "offset in "
-				"archive not a multiple of 8) (must be since "
-				"member is a 64-bit object file)");
-			    archive_64_bit_align_warning = TRUE;
-			    /* goto cleanup; */
-			}
-#endif /* ALIGNMENT_CHECKS_ARCHIVE_64_BIT */
-			ofile->member_type = OFILE_Mach_O;
-			ofile->object_addr = ofile->member_addr;
-			ofile->object_size = ofile->member_size;
-			if(magic == MH_MAGIC_64)
-			    ofile->object_byte_sex = host_byte_sex;
-			else
-			    ofile->object_byte_sex =
-				   host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
-				   LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
-			ofile->mh64 = (struct mach_header_64 *)
-				      ofile->object_addr;
-			ofile->load_commands = (struct load_command *)
-			    (ofile->object_addr +sizeof(struct mach_header_64));
-			if(check_Mach_O(ofile) == CHECK_BAD)
-			    goto cleanup;
-		    }
-		}
-#ifdef LTO_SUPPORT
-		if(ofile->member_type == OFILE_UNKNOWN &&
-		   is_llvm_bitcode(ofile, ofile->member_addr,
-				   ofile->member_size) == TRUE){
-		    ofile->member_type = OFILE_LLVM_BITCODE;
-		    ofile->object_addr = ofile->member_addr;
-		    ofile->object_size = ofile->member_size;
-		}
-#endif /* LTO_SUPPORT */
-		return(TRUE);
-	    }
-	    offset += rnd(strtoul(ar_hdr->ar_size, NULL, 10),
-			    sizeof(short));
-	}
-	archive_error(ofile, "does not contain a member named: %s",
-		      member_name);
-fatcleanup:
-	ofile->fat_header = NULL;
-	ofile->fat_archs = NULL;
-cleanup:
-	ofile->member_offset = 0;
-	ofile->member_addr = NULL;
-	ofile->member_size = 0;
-	ofile->member_ar_hdr = NULL;
-	ofile->member_name = NULL;
-	ofile->member_name_size = 0;
-	ofile->member_type = OFILE_UNKNOWN;
-	ofile->object_addr = NULL;
-	ofile->object_size = 0;
-	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
-	ofile->mh = NULL;
-	ofile->mh64 = NULL;
-	ofile->load_commands = NULL;
-#ifdef LTO_SUPPORT
-	ofile->lto = NULL;
-	ofile->lto_cputype = 0;
-	ofile->lto_cpusubtype = 0;
-#endif /* LTO_SUPPORT */
-	return(FALSE);
-}
-
-/*
- * ofile_first_module() set up the ofile structure (the dylib_module field)
- * for the first module of an MH_DYLIB or MH_DYLIB_STUB file.
- */
-__private_extern__
-enum bool
-ofile_first_module(
-struct ofile *ofile)
-{
-    uint32_t i, ncmds;
-    struct symtab_command *st;
-    struct dysymtab_command *dyst;
-    struct load_command *lc;
-    enum bool swapped;
-    enum byte_sex host_byte_sex;
-    struct dylib_module m;
-    struct dylib_module_64 m64;
-    char *strings;
-
-	/* These fields are to be filled in by this routine, clear them first */
-	ofile->modtab = NULL;
-	ofile->modtab64 = NULL;
-	ofile->nmodtab = 0;
-	ofile->dylib_module = NULL;
-	ofile->dylib_module64 = NULL;
-	ofile->dylib_module_name = NULL;
-
-	if(ofile->file_type == OFILE_FAT){
-	    if(ofile->arch_type != OFILE_Mach_O &&
-	       (ofile->mh_filetype != MH_DYLIB &&
-	        ofile->mh_filetype != MH_DYLIB_STUB)){
-		error("ofile_first_module() called on fat file: %s with a "
-		      "non-MH_DYLIB architecture or no architecture selected\n",
-		      ofile->file_name);
-		return(FALSE);
-	    }
-	}
-	else if(ofile->arch_type != OFILE_Mach_O &&
-	        (ofile->mh_filetype != MH_DYLIB &&
-	         ofile->mh_filetype != MH_DYLIB_STUB)){
-	    error("ofile_first_module() called and file type of %s is "
-		  "non-MH_DYLIB\n", ofile->file_name);
-	    return(FALSE);
-	}
-
-	st = NULL;
-	dyst = NULL;
-	lc = ofile->load_commands;
-	if(ofile->mh != NULL)
-	    ncmds = ofile->mh->ncmds;
-	else
-	    ncmds = ofile->mh64->ncmds;
-	for(i = 0; i < ncmds; i++){
-	    if(st == NULL && lc->cmd == LC_SYMTAB){
-		st = (struct symtab_command *)lc;
-	    }
-	    else if(lc->cmd == LC_DYSYMTAB){
-		dyst = (struct dysymtab_command *)lc;
-	    }
-	    lc = (struct load_command *)((char *)lc + lc->cmdsize);
-	}
-	if(st == NULL || dyst == NULL){
-#ifndef OTOOL
-	    Mach_O_error(ofile, "MH_DYLIB format error (does not have a symbol "
-		"table and/or a dynamic symbol table)");
-#endif
-	    return(FALSE);
-	}
-	if(dyst->nmodtab == 0)
-	    return(FALSE);
-
-	ofile->nmodtab = dyst->nmodtab;
-	host_byte_sex = get_host_byte_sex();
-	swapped = (enum bool)(host_byte_sex != ofile->object_byte_sex);
-	strings = (char *)(ofile->object_addr + st->stroff);
-
-	if(ofile->mh != NULL){
-	    ofile->modtab = (struct dylib_module *)(ofile->object_addr +
-						    dyst->modtaboff);
-	    ofile->dylib_module = ofile->modtab;
-	    m = *ofile->dylib_module;
-	    if(swapped)
-		swap_dylib_module(&m, 1, host_byte_sex);
-	    ofile->dylib_module_name = strings + m.module_name;
-	}
-	else{
-	    ofile->modtab64 = (struct dylib_module_64 *)(ofile->object_addr +
-						         dyst->modtaboff);
-	    ofile->dylib_module64 = ofile->modtab64;
-	    m64 = *ofile->dylib_module64;
-	    if(swapped)
-		swap_dylib_module_64(&m64, 1, host_byte_sex);
-	    ofile->dylib_module_name = strings + m64.module_name;
-	}
-
-	if(check_dylib_module(ofile, st, dyst, strings, 0) == CHECK_BAD)
-	    return(FALSE);
-	return(TRUE);
-}
-
-/*
- * ofile_next_module() set up the ofile structure (the dylib_module field)
- * for the next module of an MH_DYLIB or MH_DYLIB_STUB file.
- */
-__private_extern__
-enum bool
-ofile_next_module(
-struct ofile *ofile)
-{
-    uint32_t i, module_index, ncmds;
-    struct symtab_command *st;
-    struct dysymtab_command *dyst;
-    struct load_command *lc;
-    enum bool swapped;
-    enum byte_sex host_byte_sex;
-    struct dylib_module m;
-    struct dylib_module_64 m64;
-    char *strings;
-
-	if(ofile->file_type == OFILE_FAT){
-	    if(ofile->arch_type != OFILE_Mach_O &&
-	       (ofile->mh_filetype != MH_DYLIB &&
-	        ofile->mh_filetype != MH_DYLIB_STUB)){
-		error("ofile_next_module() called on fat file: %s with a "
-		      "non-MH_DYLIB architecture or no architecture selected\n",
-		      ofile->file_name);
-		return(FALSE);
-	    }
-	}
-	else if(ofile->arch_type != OFILE_Mach_O &&
-	        (ofile->mh_filetype != MH_DYLIB &&
-	         ofile->mh_filetype != MH_DYLIB_STUB)){
-	    error("ofile_next_module() called and file type of %s is "
-		  "non-MH_DYLIB\n", ofile->file_name);
-	    return(FALSE);
-	}
-	st = NULL;
-	dyst = NULL;
-	lc = ofile->load_commands;
-	if(ofile->mh != NULL)
-	    ncmds = ofile->mh->ncmds;
-	else
-	    ncmds = ofile->mh64->ncmds;
-	for(i = 0; i < ncmds; i++){
-	    if(st == NULL && lc->cmd == LC_SYMTAB){
-		st = (struct symtab_command *)lc;
-	    }
-	    else if(lc->cmd == LC_DYSYMTAB){
-		dyst = (struct dysymtab_command *)lc;
-	    }
-	    lc = (struct load_command *)((char *)lc + lc->cmdsize);
-	}
-	if(st == NULL || dyst == NULL){
-#ifndef OTOOL
-	    Mach_O_error(ofile, "MH_DYLIB format error (does not have a symbol "
-		"table and/or a dynamic symbol table)");
-#endif
-	    return(FALSE);
-	}
-
-	if(ofile->mh != NULL)
-	    module_index = (ofile->dylib_module + 1) - ofile->modtab;
-	else
-	    module_index = (ofile->dylib_module64 + 1) - ofile->modtab64;
-	if(module_index >= ofile->nmodtab)
-	    return(FALSE);
-
-	host_byte_sex = get_host_byte_sex();
-	swapped = (enum bool)(host_byte_sex != ofile->object_byte_sex);
-	strings = (char *)(ofile->object_addr + st->stroff);
-
-	if(ofile->mh != NULL){
-	    ofile->dylib_module++;
-	    m = *ofile->dylib_module;
-	    if(swapped)
-		swap_dylib_module(&m, 1, host_byte_sex);
-	    ofile->dylib_module_name = strings + m.module_name;
-	}
-	else{
-	    ofile->dylib_module64++;
-	    m64 = *ofile->dylib_module64;
-	    if(swapped)
-		swap_dylib_module_64(&m64, 1, host_byte_sex);
-	    ofile->dylib_module_name = strings + m64.module_name;
-	}
-	if(check_dylib_module(ofile, st, dyst, strings, module_index) ==
-	   CHECK_BAD)
-	    return(FALSE);
-	return(TRUE);
-}
-
-/*
- * ofile_specific_module() set up the ofile structure (the dylib_module fields)
- * for the specified module, module_name, of an MH_DYLIB or an MH_DYLIB_STUB
- * file.
- */
-__private_extern__
-enum bool
-ofile_specific_module(
-const char *module_name,
-struct ofile *ofile)
-{
-    uint32_t i, ncmds;
-    enum bool swapped;
-    enum byte_sex host_byte_sex;
-    struct symtab_command *st;
-    struct dysymtab_command *dyst;
-    struct load_command *lc;
-    struct dylib_module *p, m;
-    struct dylib_module_64 *p64, m64;
-    char *strings;
-
-	/* These fields are to be filled in by this routine, clear them first */
-	ofile->modtab = NULL;
-	ofile->modtab64 = NULL;
-	ofile->nmodtab = 0;
-	ofile->dylib_module = NULL;
-	ofile->dylib_module64 = NULL;
-	ofile->dylib_module_name = NULL;
-
-	if(ofile->file_type == OFILE_FAT){
-	    if(ofile->arch_type != OFILE_Mach_O &&
-	       (ofile->mh_filetype != MH_DYLIB &&
-	        ofile->mh_filetype != MH_DYLIB_STUB)){
-		error("ofile_specific_module() called on fat file: %s with a "
-		      "non-MH_DYLIB architecture or no architecture selected\n",
-		      ofile->file_name);
-		return(FALSE);
-	    }
-	}
-	else if(ofile->arch_type != OFILE_Mach_O &&
-	        (ofile->mh_filetype != MH_DYLIB &&
-	         ofile->mh_filetype != MH_DYLIB_STUB)){
-	    error("ofile_specific_module() called and file type of %s is "
-		  "non-MH_DYLIB\n", ofile->file_name);
-	    return(FALSE);
-	}
-
-	st = NULL;
-	dyst = NULL;
-	lc = ofile->load_commands;
-	if(ofile->mh != NULL)
-	    ncmds = ofile->mh->ncmds;
-	else
-	    ncmds = ofile->mh64->ncmds;
-	for(i = 0; i < ncmds; i++){
-	    if(st == NULL && lc->cmd == LC_SYMTAB){
-		st = (struct symtab_command *)lc;
-	    }
-	    else if(lc->cmd == LC_DYSYMTAB){
-		dyst = (struct dysymtab_command *)lc;
-	    }
-	    lc = (struct load_command *)((char *)lc + lc->cmdsize);
-	}
-	if(st == NULL || dyst == NULL){
-#ifndef OTOOL
-	    Mach_O_error(ofile, "MH_DYLIB format error (does not have a symbol "
-		"table and/or a dynamic symbol table)");
-#endif
-	    return(FALSE);
-	}
-	if(dyst->nmodtab == 0)
-	    return(FALSE);
-
-	host_byte_sex = get_host_byte_sex();
-	swapped = (enum bool)(host_byte_sex != ofile->object_byte_sex);
-	strings = (char *)(ofile->object_addr + st->stroff);
-
-	if(ofile->mh != NULL){
-	    ofile->nmodtab = dyst->nmodtab;
-	    ofile->modtab = (struct dylib_module *)(ofile->object_addr +
-						    dyst->modtaboff);
-	    p = ofile->modtab;
-	    for(i = 0; i < dyst->nmodtab; i++){
-		m = *p;
-		if(swapped)
-		    swap_dylib_module(&m, 1, host_byte_sex);
-		ofile->dylib_module = p;
-		if(check_dylib_module(ofile, st, dyst, strings, i) == CHECK_BAD)
-		    return(FALSE);
-		if(strcmp(module_name, strings + m.module_name) == 0){
-		    ofile->dylib_module_name = strings + m.module_name;
-		    return(TRUE);
-		}
-		p++;
-	    }
-	    m = *ofile->dylib_module;
-	    if(swapped)
-		swap_dylib_module(&m, 1, host_byte_sex);
-	    ofile->dylib_module_name = strings + m.module_name;
-	}
-	else{
-	    ofile->nmodtab = dyst->nmodtab;
-	    ofile->modtab64 = (struct dylib_module_64 *)(ofile->object_addr +
-						         dyst->modtaboff);
-	    p64 = ofile->modtab64;
-	    for(i = 0; i < dyst->nmodtab; i++){
-		m64 = *p64;
-		if(swapped)
-		    swap_dylib_module_64(&m64, 1, host_byte_sex);
-		ofile->dylib_module64 = p64;
-		if(check_dylib_module(ofile, st, dyst, strings, i) == CHECK_BAD)
-		    return(FALSE);
-		if(strcmp(module_name, strings + m64.module_name) == 0){
-		    ofile->dylib_module_name = strings + m64.module_name;
-		    return(TRUE);
-		}
-		p64++;
-	    }
-	    m64 = *ofile->dylib_module64;
-	    if(swapped)
-		swap_dylib_module_64(&m64, 1, host_byte_sex);
-	    ofile->dylib_module_name = strings + m64.module_name;
-	}
-#ifndef OTOOL
-	Mach_O_error(ofile, "does not contain a module named: %s", module_name);
-#endif
-	ofile->modtab = NULL;
-	ofile->nmodtab = 0;
-	ofile->dylib_module = NULL;
-	ofile->dylib_module_name = NULL;
-	return(FALSE);
-}
-
-#ifdef DEBUG
-__private_extern__
-void
-ofile_print(
-struct ofile *ofile)
-{
-	printf("file_name = %s\n", ofile->file_name);
-	printf("file_addr = 0x%x\n", (unsigned int)ofile->file_addr);
-	printf("file_size = 0x%x\n", (unsigned int)ofile->file_size);
-	printf("file_type = 0x%x\n", (unsigned int)ofile->file_type);
-	printf("fat_header = 0x%x\n", (unsigned int)ofile->fat_header);
-	printf("fat_archs = 0x%x\n", (unsigned int)ofile->fat_archs);
-	printf("narch = 0x%x\n", (unsigned int)ofile->narch);
-	printf("arch_type = 0x%x\n", (unsigned int)ofile->arch_type);
-	printf("arch_flag.name = %s\n", ofile->arch_flag.name);
-	printf("arch_flag.cputype = 0x%x\n",
-		(unsigned int)ofile->arch_flag.cputype);
-	printf("arch_flag.cpusubtype = 0x%x\n",
-		(unsigned int)ofile->arch_flag.cpusubtype);
-	printf("member_offset = 0x%x\n", (unsigned int)ofile->member_offset);
-	printf("member_addr = 0x%x\n", (unsigned int)ofile->member_addr);
-	printf("member_size = 0x%x\n", (unsigned int)ofile->member_size);
-	printf("member_ar_hdr = 0x%x\n", (unsigned int)ofile->member_ar_hdr);
-	printf("member_type = 0x%x\n", (unsigned int)ofile->member_type);
-	printf("archive_cputype = 0x%x\n",
-		(unsigned int)ofile->archive_cputype);
-	printf("archive_cpusubtype = 0x%x\n",
-		(unsigned int)ofile->archive_cpusubtype);
-	printf("object_addr = 0x%x\n", (unsigned int)ofile->object_addr);
-	printf("object_size = 0x%x\n", (unsigned int)ofile->object_size);
-	printf("object_byte_sex = 0x%x\n",
-		(unsigned int)ofile->object_byte_sex);
-	printf("mh = 0x%x\n", (unsigned int)ofile->mh);
-	printf("mh64 = 0x%x\n", (unsigned int)ofile->mh64);
-	printf("load_commands = 0x%x\n", (unsigned int)ofile->load_commands);
-}
-#endif /* DEBUG */
-
-/*
- * check_fat() checks the fat ofile for correctness (the fat_header and
- * fat_archs are assumed to be in the host byte sex).
- */
-static
-enum check_type
-check_fat(
-struct ofile *ofile)
-{
-#ifdef OTOOL
-	return(CHECK_GOOD);
-#else /* !defined OTOOL */
-
-    uint32_t i, j;
-    uint64_t big_size;
-
-	if(ofile->file_type != OFILE_FAT){
-	    error("internal error. check_fat() call and file type of: %s is "
-		  "not OFILE_FAT\n", ofile->file_name);
-	    return(CHECK_BAD);
-	}
-	if(ofile->fat_header->nfat_arch == 0){
-	    error("fat file: %s malformed (contains zero architecture types)",
-		  ofile->file_name);
-	    return(CHECK_BAD);
-	}
-	for(i = 0; i < ofile->fat_header->nfat_arch; i++){
-	    big_size = ofile->fat_archs[i].offset;
-	    big_size += ofile->fat_archs[i].size;
-	    if(big_size > ofile->file_size){
-		error("fat file: %s truncated or malformed (offset plus size "
-		      "of cputype (%d) cpusubtype (%d) extends past the "
-		      "end of the file)", ofile->file_name,
-		      ofile->fat_archs[i].cputype,
-		      ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK);
-		return(CHECK_BAD);
-	    }
-	    if(ofile->fat_archs[i].align > MAXSECTALIGN){
-		error("fat file: %s align (2^%u) too large for cputype (%d) "
-		      "cpusubtype (%d) (maximum 2^%d)", ofile->file_name,
-		      ofile->fat_archs[i].align, ofile->fat_archs[i].cputype,
-		      ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK,
-		      MAXSECTALIGN);
-		return(CHECK_BAD);
-	    }
-	    if(ofile->fat_archs[i].offset %
-	       (1 << ofile->fat_archs[i].align) != 0){
-		error("fat file: %s offset: %u for cputype (%d) cpusubtype "
-		      "(%d)) not aligned on it's alignment (2^%u)",
-		      ofile->file_name,
-		      ofile->fat_archs[i].offset,
-		      ofile->fat_archs[i].cputype,
-		      ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK,
-		      ofile->fat_archs[i].align);
-		return(CHECK_BAD);
-	    }
-	}
-	for(i = 0; i < ofile->fat_header->nfat_arch; i++){
-	    for(j = i + 1; j < ofile->fat_header->nfat_arch; j++){
-		if(ofile->fat_archs[i].cputype ==
-		     ofile->fat_archs[j].cputype &&
-		   (ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK) ==
-		     (ofile->fat_archs[j].cpusubtype & ~CPU_SUBTYPE_MASK)){
-		    error("fat file: %s contains two of the same "
-			  "architecture (cputype (%d) cpusubtype (%d))",
-			  ofile->file_name, ofile->fat_archs[i].cputype,
-			  ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK);
-		    return(CHECK_BAD);
-		}
-	    }
-	}
-	return(CHECK_GOOD);
-#endif /* OTOOL */
-}
-
-/*
- * check_fat_object_in_archive() checks the fat object file which is a member
- * of a thin archive for correctness (the fat_header and fat_archs are assumed
- * to be in the host byte sex).  This is not a legal form but allowed when
- * archives_with_fat_objects is TRUE when ofile_map() is called.
- */
-static
-enum check_type
-check_fat_object_in_archive(
-struct ofile *ofile)
-{
-    uint32_t i, j;
-    uint32_t magic;
-
-	if(ofile->file_type != OFILE_ARCHIVE){
-	    error("internal error. check_fat_object_in_archive() called and "
-		  "file type of: %s is not OFILE_ARCHIVE\n", ofile->file_name);
-	    return(CHECK_BAD);
-	}
-	if(ofile->fat_header->nfat_arch == 0){
-	    archive_member_error(ofile, "fat file malformed (contains zero "
-				 "architecture types)");
-	    return(CHECK_BAD);
-	}
-	for(i = 0; i < ofile->fat_header->nfat_arch; i++){
-	    if(ofile->fat_archs[i].offset + ofile->fat_archs[i].size >
-	       ofile->member_size){
-		archive_member_error(ofile, "fat file truncated or malformed "
-			"(offset plus size of cputype (%d) cpusubtype (%d) "
-			"extends past the end of the file)", 
-		        ofile->fat_archs[i].cputype,
-		        ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK);
-		return(CHECK_BAD);
-	    }
-	    if(ofile->fat_archs[i].align > MAXSECTALIGN){
-		archive_member_error(ofile, "fat file's align (2^%u) too "
-			"large for cputype (%d) cpusubtype (%d) (maximum 2^%d)",
-			ofile->fat_archs[i].align, ofile->fat_archs[i].cputype,
-			ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK,
-			MAXSECTALIGN);
-		return(CHECK_BAD);
-	    }
-	    if(ofile->fat_archs[i].offset %
-	       (1 << ofile->fat_archs[i].align) != 0){
-		archive_member_error(ofile, "fat file's offset: %u for "
-			"cputype (%d) cpusubtype (%d) not aligned on it's "
-			"alignment (2^%u)", ofile->fat_archs[i].offset,
-			ofile->fat_archs[i].cputype,
-			ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK,
-			ofile->fat_archs[i].align);
-		return(CHECK_BAD);
-	    }
-
-	    /*
-	     * The only supported format where fat files are allowed to appear
-	     * in archives is when the fat file contains only object files.
-	     */
-	    if(ofile->fat_archs[i].size < sizeof(struct mach_header)){
-		archive_member_error(ofile, "fat file for cputype (%d) "
-			"cpusubtype (%d) is not an object file (size too small "
-			"to be an object file)", ofile->fat_archs[i].cputype,
-			ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK);
-		return(CHECK_BAD);
-	    }
-	    memcpy(&magic,
-		   ofile->file_addr + ofile->member_offset +
-			ofile->fat_archs[i].offset,
-		   sizeof(uint32_t));
-	    if(magic == MH_MAGIC || magic == SWAP_INT(MH_MAGIC)){
-#ifdef ALIGNMENT_CHECKS
-		if((ofile->member_offset + ofile->fat_archs[i].offset) %
-		   4 != 0){
-		    archive_member_error(ofile, "fat object file's offset in "
-			    "archive not a multiple of 4) (must be since "
-			    "member is a 32-bit object file)");
-		    return(CHECK_BAD);
-		}
-#endif /* ALIGNMENT_CHECKS */
-	    }
-	    else if(magic == MH_MAGIC_64 || magic == SWAP_INT(MH_MAGIC_64)){
-#ifdef ALIGNMENT_CHECKS_ARCHIVE_64_BIT
-		if(archive_64_bit_align_warning == FALSE &&
-		   (ofile->member_offset + ofile->fat_archs[i].offset) %
-		   8 != 0){
-		    temporary_archive_member_warning(ofile, "fat object file's "
-			"offset in archive not a multiple of 8) (must be since "
-			"member is a 64-bit object file)");
-		    archive_64_bit_align_warning = TRUE;
-		    /* return(CHECK_BAD); */
-		}
-#endif /* ALIGNMENT_CHECKS_ARCHIVE_64_BIT */
-	    }
-	    else{
-#ifdef LTO_SUPPORT
-	        if(is_llvm_bitcode(ofile, ofile->file_addr +
-		   ofile->member_offset + ofile->fat_archs[i].offset,
-		   ofile->fat_archs[i].size) == TRUE){
-#ifdef ALIGNMENT_CHECKS_ARCHIVE_64_BIT
-		    if(archive_64_bit_align_warning == FALSE &&
-		       (ofile->member_offset + ofile->fat_archs[i].offset) %
-		       8 != 0){
-			temporary_archive_member_warning(ofile, "fat object "
-			    "file's offset in archive not a multiple of 8) "
-			    "(must be since member is a 64-bit object file)");
-			archive_64_bit_align_warning = TRUE;
-			/* return(CHECK_BAD); */
-		    }
-#endif
-	        }
-		else
-#endif /* LTO_SUPPORT */
-		{
-		    archive_member_error(ofile, "fat file for cputype (%d) "
-			    "cpusubtype (%d) is not an object file (bad magic "
-			    "number)", ofile->fat_archs[i].cputype,
-			    ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK);
-		    return(CHECK_BAD);
-		}
-	    }
-	}
-	for(i = 0; i < ofile->fat_header->nfat_arch; i++){
-	    for(j = i + 1; j < ofile->fat_header->nfat_arch; j++){
-		if(ofile->fat_archs[i].cputype ==
-		     ofile->fat_archs[j].cputype &&
-		   (ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK) ==
-		     (ofile->fat_archs[j].cpusubtype & ~CPU_SUBTYPE_MASK)){
-		    archive_member_error(ofile, "fat file contains two of the "
-			"same architecture (cputype (%d) cpusubtype (%d))",
-			ofile->fat_archs[i].cputype,
-			ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK);
-		    return(CHECK_BAD);
-		}
-	    }
-	}
-	return(CHECK_GOOD);
-}
-
-/*
- * check_archive() checks the archive referenced in the ofile for correctness.
- */
-static
-enum check_type
-check_archive(
-struct ofile *ofile,
-enum bool archives_with_fat_objects)
-{
-#ifdef OTOOL
-	return(CHECK_GOOD);
-#else /* !defined OTOOL */
-    char *addr;
-    uint64_t size, offset;
-    uint64_t big_size;
-    uint32_t magic;
-    enum byte_sex host_byte_sex;
-    enum bool swapped;
-    struct mach_header mh;
-    struct mach_header_64 mh64;
-    struct ar_hdr *ar_hdr;
-    uint32_t ar_name_size;
-
-	/*
-	 * Get the address and size of the archive (as well as the cputype and
-	 * cpusubtype if known) and make sure it is an archive.
-	 */
-	if(ofile->file_type == OFILE_FAT){
-	    addr = ofile->file_addr + ofile->fat_archs[ofile->narch].offset;
-	    size = ofile->fat_archs[ofile->narch].size;
-	    ofile->archive_cputype = ofile->fat_archs[ofile->narch].cputype;
-	    ofile->archive_cpusubtype =
-				     ofile->fat_archs[ofile->narch].cpusubtype;
-	}
-	else if(ofile->file_type == OFILE_ARCHIVE){
-	    addr = ofile->file_addr;
-	    size = ofile->file_size;
-	    ofile->archive_cputype = 0;
-	    ofile->archive_cpusubtype = 0;
-	}
-	else{
-	    error("internal error. check_archive() call and file type of %s is "
-		  "OFILE_UNKNOWN\n", ofile->file_name);
-	    return(CHECK_BAD);
-	}
-	if(size < SARMAG || strncmp(addr, ARMAG, SARMAG) != 0){
-	    error("internal error. check_archive() call for file %s which does "
-		  "not have an archive magic string", ofile->file_name);
-	    return(CHECK_BAD);
-	}
-
-	host_byte_sex = get_host_byte_sex();
-	/*
-	 * Check this archive out to make sure that it does not contain
-	 * any fat files and that all object files it contains have the
-	 * same cputype and subsubtype.
-	 */
-	offset = SARMAG;
-	if(offset == size)
-	    return(CHECK_GOOD);
-	if(offset != size && offset + sizeof(struct ar_hdr) > size){
-	    archive_error(ofile, "truncated or malformed (archive header of "
-			  "first member extends past the end of the file)");
-	    return(CHECK_BAD);
-	}
-	while(size > offset){
-	    ar_hdr = (struct ar_hdr *)(addr + offset);
-	    ofile->member_offset = offset;
-	    ofile->member_addr = addr + offset;
-	    ofile->member_size = strtoul(ar_hdr->ar_size, NULL, 10);
-	    ofile->member_ar_hdr = ar_hdr;
-	    ofile->member_name = ar_hdr->ar_name;
-	    ofile->member_name_size = size_ar_name(ofile->member_ar_hdr);
-	    offset += sizeof(struct ar_hdr);
-	    /*
-	     * See if this archive member is using extend format #1 where
-	     * the size of the name is in ar_name and the name follows the
-	     * archive header.
-	     */
-	    ar_name_size = 0;
-	    if(strncmp(ofile->member_name,AR_EFMT1, sizeof(AR_EFMT1) - 1) == 0){
-		if(check_extend_format_1(ofile, ar_hdr, size - offset,
-				&ar_name_size) == CHECK_BAD)
-		    return(CHECK_BAD);
-		ofile->member_name = ar_hdr->ar_name + sizeof(struct ar_hdr);
-		ofile->member_name_size = ar_name_size;
-		offset += ar_name_size;
-		ofile->member_offset += ar_name_size;
-		ofile->member_addr += ar_name_size;
-		ofile->member_size -= ar_name_size;
-	    }
-	    big_size = rnd(ofile->member_size, sizeof(short));
-	    big_size += offset;
-	    if(big_size > size){
-		archive_member_error(ofile, "size too large (archive "
-			      "member extends past the end of the file)");
-		return(CHECK_BAD);
-	    }
-	    if(size - offset > sizeof(uint32_t)){
-		memcpy(&magic, addr + offset, sizeof(uint32_t));
-#ifdef __BIG_ENDIAN__
-		if(magic == FAT_MAGIC)
-#endif /* __BIG_ENDIAN__ */
-#ifdef __LITTLE_ENDIAN__
-		if(magic == SWAP_INT(FAT_MAGIC))
-#endif /* __LITTLE_ENDIAN__ */
-		{
-		    if(archives_with_fat_objects == FALSE ||
-		       ofile->file_type != OFILE_ARCHIVE){
-			archive_member_error(ofile, "is a fat file (not "
-					     "allowed in an archive)");
-			return(CHECK_BAD);
-		    }
-		}
-		else{
-		    if(size - offset >= sizeof(struct mach_header) &&
-		       (magic == MH_MAGIC || magic == SWAP_INT(MH_MAGIC))){
-			memcpy(&mh, addr + offset, sizeof(struct mach_header));
-			if(magic == SWAP_INT(MH_MAGIC)){
-			    magic = MH_MAGIC;
-			    swapped = TRUE;
-			    swap_mach_header(&mh, host_byte_sex);
-			}
-			swapped = FALSE;
-		    }
-		    else if(size - offset >= sizeof(struct mach_header_64) &&
-		       (magic == MH_MAGIC_64 ||
-			magic == SWAP_INT(MH_MAGIC_64))){
-			memcpy(&mh64, addr + offset,
-			       sizeof(struct mach_header_64));
-			if(magic == SWAP_INT(MH_MAGIC_64)){
-			    magic = MH_MAGIC_64;
-			    swapped = TRUE;
-			    swap_mach_header_64(&mh64, host_byte_sex);
-			}
-			swapped = FALSE;
-		    }
-		    if(magic == MH_MAGIC){
-			if(ofile->archive_cputype == 0){
-			    ofile->archive_cputype = mh.cputype;
-			    ofile->archive_cpusubtype = mh.cpusubtype;
-			}
-			else if(ofile->archive_cputype != mh.cputype){
-			    archive_member_error(ofile, "cputype (%d) does not "
-				"match previous archive members cputype (%d) "
-				"(all members must match)", mh.cputype,
-				ofile->archive_cputype);
-			}
-		    }
-		    else if(magic == MH_MAGIC_64){
-			if(ofile->archive_cputype == 0){
-			    ofile->archive_cputype = mh64.cputype;
-			    ofile->archive_cpusubtype = mh64.cpusubtype;
-			}
-			else if(ofile->archive_cputype != mh64.cputype){
-			    archive_member_error(ofile, "cputype (%d) does not "
-				"match previous archive members cputype (%d) "
-				"(all members must match)", mh64.cputype,
-				ofile->archive_cputype);
-			}
-		    }
-		}
-	    }
-	    offset += rnd(ofile->member_size, sizeof(short));
-	}
-	ofile->member_offset = 0;
-	ofile->member_addr = NULL;
-	ofile->member_size = 0;
-	ofile->member_ar_hdr = NULL;;
-	ofile->member_name = NULL;
-	ofile->member_name_size = 0;
-	return(CHECK_GOOD);
-#endif /* OTOOL */
-}
-
-/*
- * check_extend_format_1() checks the archive header for extended format #1.
- */
-static
-enum check_type
-check_extend_format_1(
-struct ofile *ofile,
-struct ar_hdr *ar_hdr,
-uint32_t size_left,
-uint32_t *member_name_size)
-{
-    char *p, *endp, buf[sizeof(ar_hdr->ar_name)+1];
-    uint32_t ar_name_size;
-
-	*member_name_size = 0;
-
-	buf[sizeof(ar_hdr->ar_name)] = '\0';
-	memcpy(buf, ar_hdr->ar_name, sizeof(ar_hdr->ar_name));
-	p = buf + sizeof(AR_EFMT1) - 1;
-	if(isdigit(*p) == 0){
-	    archive_error(ofile, "malformed (ar_name: %.*s for archive "
-		"extend format #1 starts with non-digit)",
-		(int)sizeof(ar_hdr->ar_name), ar_hdr->ar_name);
-	    return(CHECK_BAD);
-	}
-	ar_name_size = strtoul(p, &endp, 10);
-	if(ar_name_size == UINT_MAX && errno == ERANGE){
-	    archive_error(ofile, "malformed (size in ar_name: %.*s for "
-		"archive extend format #1 overflows uint32_t)",
-		(int)sizeof(ar_hdr->ar_name), ar_hdr->ar_name);
-	    return(CHECK_BAD);
-	}
-	while(*endp == ' ' && *endp != '\0')
-	    endp++;
-	if(*endp != '\0'){
-	    archive_error(ofile, "malformed (size in ar_name: %.*s for "
-		"archive extend format #1 contains non-digit and "
-		"non-space characters)", (int)sizeof(ar_hdr->ar_name),
-		ar_hdr->ar_name);
-	    return(CHECK_BAD);
-	}
-	if(ar_name_size > size_left){
-	    archive_error(ofile, "truncated or malformed (archive name "
-		"of member extends past the end of the file)");
-	    return(CHECK_BAD);
-	}
-	*member_name_size = ar_name_size;
-	return(CHECK_GOOD);
-}
-
-/*
- * check_archive_toc() checks the archive table of contents referenced in the
- * thin archive via the ofile for correctness and if bad sets the bad_toc field
- * in the ofile struct to TRUE.   If not it sets the other toc_* fields that
- * ranlib(1) uses to know it can't update the table of contents and doesn't
- * have to totally rebuild it.  And by this always returning CHECK_GOOD it
- * allows otool(1) to print messed up tables of contents for debugging.
- */
-static
-enum check_type
-check_archive_toc(
-struct ofile *ofile)
-{
-    uint32_t i, symdef_length, offset, nranlibs, strsize;
-    enum byte_sex host_byte_sex, toc_byte_sex;
-    struct ranlib *ranlibs;
-    char *strings;
-
-	ofile->toc_ranlibs = NULL;
-	ofile->toc_nranlibs = 0;
-	ofile->toc_strings = NULL;
-	ofile->toc_strsize = 0;
-
-	/*
-	 * Note this can only be called when the whole file is a thin archive.
-	 */
-	if(ofile->file_type != OFILE_ARCHIVE)
-	    return(CHECK_GOOD);
-
-	symdef_length = ofile->toc_size;
-	/*
-	 * The contents of a __.SYMDEF file is begins with a 32-bit word giving 
-	 * the size in bytes of ranlib structures which immediately follow, and
-	 * then continues with a string table consisting of a 32-bit word giving
-	 * the number of bytes of strings which follow and then the strings
-	 * themselves.  So the smallest valid size is two 32-bit words long.
-	 */
-	if(symdef_length < 2 * sizeof(uint32_t)){
-	    /*
-	     * Size of table of contents for archive too small to be a valid
-	     * table of contents.
-	     */
-	    ofile->toc_bad = TRUE;
-	    return(CHECK_GOOD);
-	}
-	host_byte_sex = get_host_byte_sex();
-	toc_byte_sex = get_toc_byte_sex(ofile->file_addr, ofile->file_size);
-	if(toc_byte_sex == UNKNOWN_BYTE_SEX){
-	    /*
-	     * Can't determine the byte order of table of contents as it
-	     * contains no Mach-O files.
-	     */
-	    ofile->toc_bad = TRUE;
-	    return(CHECK_GOOD);
-	}
-	offset = 0;
-	nranlibs = *((uint32_t *)(ofile->toc_addr + offset));
-	if(toc_byte_sex != host_byte_sex)
-	    nranlibs = SWAP_INT(nranlibs);
-	nranlibs = nranlibs / sizeof(struct ranlib);
-	offset += sizeof(uint32_t);
-	ranlibs = (struct ranlib *)(ofile->toc_addr + offset);
-	offset += sizeof(struct ranlib) * nranlibs;
-	if(nranlibs == 0)
-	    return(CHECK_GOOD);
-	if(offset - (2 * sizeof(uint32_t)) > symdef_length){
-	    /*
-	     * Truncated or malformed archive.  The ranlib structures in table
-	     * of contents extends past the end of the table of contents.
-	     */
-	    ofile->toc_bad = TRUE;
-	    return(CHECK_GOOD);
-	}
-	strsize = *((uint32_t *)(ofile->toc_addr + offset));
-	if(toc_byte_sex != host_byte_sex)
-	    strsize = SWAP_INT(strsize);
-	offset += sizeof(uint32_t);
-	strings = ofile->toc_addr + offset;
-	offset += strsize;
-	if(offset - (2 * sizeof(uint32_t)) > symdef_length){
-	    /*
-	     * Truncated or malformed archive.  The ranlib strings in table of
-	     * contents extends past the end of the table of contents.
-	     */
-	    ofile->toc_bad = TRUE;
-	    return(CHECK_GOOD);
-	}
-	if(symdef_length == 2 * sizeof(uint32_t))
-	    return(CHECK_GOOD);
-
-	/*
-	 * Check the string offset and the member offsets of the ranlib structs.
-	 */
-	if(toc_byte_sex != host_byte_sex)
-	    swap_ranlib(ranlibs, nranlibs, host_byte_sex);
-	for(i = 0; i < nranlibs; i++){
-	    if(ranlibs[i].ran_un.ran_strx >= strsize){
-		/*
-		 * Malformed table of contents.  The ranlib struct at this index
-		 * has a bad string index field.
-		 */
-		ofile->toc_bad = TRUE;
-		return(CHECK_GOOD);
-	    }
-	    if(ranlibs[i].ran_off >= ofile->file_size){
-		/*
-		 * Malformed table of contents.  The ranlib struct at this index
-		 * has a bad library member offset field.
-		 */
-		ofile->toc_bad = TRUE;
-		return(CHECK_GOOD);
-	    }
-	    /*
-	     * These should be on 4 byte boundaries because the maximum
-	     * alignment of the header structures and relocation are 4 bytes.
-	     * But this is has to be 2 bytes because that's the way ar(1) has
-	     * worked historicly in the past.  Fortunately this works on the
-	     * 68k machines but will have to change when this is on a real
-	     * machine.
-	     */
-#if defined(mc68000) || defined(__i386__)
-	    if(ranlibs[i].ran_off % sizeof(short) != 0){
-		/*
-		 * Malformed table of contents.  This ranlib struct library
-		 * member offset not a multiple 2 bytes.
-		 */
-		ofile->toc_bad = TRUE;
-		return(CHECK_GOOD);
-	    }
-#else
-	    if(ranlibs[i].ran_off % sizeof(uint32_t) != 0){
-		/*
-		 * Malformed table of contents.  This ranlib struct library
-	         * member offset not a multiple of 4 bytes.
-		 */
-		ofile->toc_bad = TRUE;
-		return(CHECK_GOOD);
-	    }
-#endif
-	}
-	ofile->toc_ranlibs = ranlibs;
-	ofile->toc_nranlibs = nranlibs;
-	ofile->toc_strings = strings;
-	ofile->toc_strsize = strsize;
-	return(CHECK_GOOD);
-}
-
-/*
- * check_Mach_O() checks the object file's mach header and load commands
- * referenced in the ofile for correctness (this also swaps the mach header
- * and load commands into the host byte sex if needed).
- */
-static
-enum check_type
-check_Mach_O(
-struct ofile *ofile)
-{
-#ifdef OTOOL
-	return(CHECK_GOOD);
-#else /* !defined OTOOL */
-    uint32_t size, i, j, ncmds, sizeofcmds, load_command_multiple, sizeofhdrs;
-    cpu_type_t cputype;
-    char *addr, *cmd_name, *element_name;
-    enum byte_sex host_byte_sex;
-    enum bool swapped;
-    struct mach_header *mh;
-    struct mach_header_64 *mh64;
-    struct load_command *load_commands, *lc, l;
-    struct segment_command *sg;
-    struct segment_command_64 *sg64;
-    struct section *s;
-    struct section_64 *s64;
-    struct symtab_command *st;
-    struct dysymtab_command *dyst;
-    struct symseg_command *ss;
-    struct fvmlib_command *fl;
-    struct dylib_command *dl;
-    struct sub_framework_command *sub;
-    struct sub_umbrella_command *usub;
-    struct sub_library_command *lsub;
-    struct sub_client_command *csub;
-    struct prebound_dylib_command *pbdylib;
-    struct dylinker_command *dyld;
-    struct thread_command *ut;
-    struct ident_command *id;
-    struct routines_command *rc;
-    struct routines_command_64 *rc64;
-    struct twolevel_hints_command *hints;
-    struct linkedit_data_command *code_sig, *split_info, *func_starts,
-			     *data_in_code, *code_sign_drs, *linkedit_data;
-    struct linkedit_data_command *link_opt_hint;
-    struct version_min_command *vers;
-    struct prebind_cksum_command *cs;
-    struct encryption_info_command *encrypt_info;
-    struct encryption_info_command_64 *encrypt_info64;
-    struct linker_option_command *lo;
-    struct dyld_info_command *dyld_info;
-    struct uuid_command *uuid;
-    struct rpath_command *rpath;
-    struct entry_point_command *ep;
-    struct source_version_command *sv;
-    uint32_t flavor, count, nflavor;
-    char *p, *state;
-    uint32_t sizeof_nlist, sizeof_dylib_module;
-    char *struct_dylib_module_name, *struct_nlist_name;
-    uint64_t big_size, big_end, big_load_end;
-    struct element elements;
-
-	elements.offset = 0;
-	elements.size = 0;
-	elements.name = NULL;
-	elements.next = NULL;
-
-	addr = ofile->object_addr;
-	size = ofile->object_size;
-	mh = ofile->mh;
-	mh64 = ofile->mh64;
-	load_commands = ofile->load_commands;
-	host_byte_sex = get_host_byte_sex();
-	swapped = (enum bool)(host_byte_sex != ofile->object_byte_sex);
-
-	if(ofile->mh != NULL){
-	    if(swapped)
-		swap_mach_header(mh, host_byte_sex);
-	    big_size = mh->sizeofcmds;
-	    big_size += sizeof(struct mach_header);
-	    if(big_size > size){
-		Mach_O_error(ofile, "truncated or malformed object (load "
-			     "commands extend past the end of the file)");
-		return(CHECK_BAD);
-	    }
-	    sizeofhdrs = big_size;
-	    ofile->mh_cputype = mh->cputype;
-	    ofile->mh_cpusubtype = mh->cpusubtype;
-	    ofile->mh_filetype = mh->filetype;
-	    ncmds = mh->ncmds;
-	    sizeofcmds = mh->sizeofcmds;
-	    cputype = mh->cputype;
-	    load_command_multiple = 4;
-	    sizeof_nlist = sizeof(struct nlist);
-	    struct_nlist_name = "struct nlist";
-	    sizeof_dylib_module = sizeof(struct dylib_module);
-	    struct_dylib_module_name = "struct dylib_module";
-	}
-	else{
-	    if(swapped)
-		swap_mach_header_64(mh64, host_byte_sex);
-	    big_size = mh64->sizeofcmds;
-	    big_size += sizeof(struct mach_header_64);
-	    if(big_size > size){
-		Mach_O_error(ofile, "truncated or malformed object (load "
-			     "commands extend past the end of the file)");
-		return(CHECK_BAD);
-	    }
-	    sizeofhdrs = big_size;
-	    ofile->mh_cputype = mh64->cputype;
-	    ofile->mh_cpusubtype = mh64->cpusubtype;
-	    ofile->mh_filetype = mh64->filetype;
-	    ncmds = mh64->ncmds;
-	    sizeofcmds = mh64->sizeofcmds;
-	    cputype = mh64->cputype;
-	    load_command_multiple = 8;
-	    sizeof_nlist = sizeof(struct nlist_64);
-	    struct_nlist_name = "struct nlist_64";
-	    sizeof_dylib_module = sizeof(struct dylib_module_64);
-	    struct_dylib_module_name = "struct dylib_module_64";
-	}
-	if(check_overlaping_element(ofile, &elements, 0, sizeofhdrs,
-		"Mach-O headers") == CHECK_BAD)
-	    goto return_bad;
-	if(ofile->file_type == OFILE_FAT){
-	    if(ofile->fat_archs[ofile->narch].cputype != ofile->mh_cputype){
-		Mach_O_error(ofile, "malformed fat file (fat header "
-		    "architecture: %u's cputype does not match "
-		    "object file's mach header)", ofile->narch);
-		goto return_bad;
-	    }
-	}
-	/*
-	 * Make a pass through the load commands checking them to the level
-	 * that they can be parsed and all fields with offsets and sizes do
-	 * not extend past the end of the file.
-	 */
-	st = NULL;
-	dyst = NULL;
-	rc = NULL;
-	rc64 = NULL;
-	hints = NULL;
-	code_sig = NULL;
-	func_starts = NULL;
-	data_in_code = NULL;
-	code_sign_drs = NULL;
-	link_opt_hint = NULL;
-	split_info = NULL;
-	cs = NULL;
-	uuid = NULL;
-	encrypt_info = NULL;
-	dyld_info = NULL;
-	vers = NULL;
-	big_load_end = 0;
-	for(i = 0, lc = load_commands; i < ncmds; i++){
-	    l = *lc;
-	    if(swapped)
-		swap_load_command(&l, host_byte_sex);
-	    /*
-	     * Check load command size for a multiple of load_command_multiple.
-	     */
-	    if(l.cmdsize % load_command_multiple != 0){
-		/*
-		 * We have a hack here to allow 64-bit Mach-O core files to
-		 * have LC_THREAD commands that are only a multiple of 4 and
-		 * not 8 to be allowed since the kernel produces them.
-		 */
-		if(ofile->mh64 == NULL ||
-		   ofile->mh64->filetype != MH_CORE ||
-		   l.cmd != LC_THREAD ||
-		   l.cmdsize % 4 != 0){
-		    Mach_O_error(ofile, "malformed object (load command %u "
-				 "cmdsize not a multiple of %u)", i,
-				 load_command_multiple);
-		    goto return_bad;
-		}
-	    }
-	    /* check that load command does not extends past end of commands */
-	    big_load_end += l.cmdsize;
-	    if(big_load_end > sizeofcmds){
-		Mach_O_error(ofile, "truncated or malformed object (load "
-			     "command %u extends past the end of the file)",i);
-		goto return_bad;
-	    }
-	    /* check that the load command size is not zero */
-	    if(l.cmdsize == 0){
-		Mach_O_error(ofile, "malformed object (load command %u cmdsize"
-			     " is zero)", i);
-		goto return_bad;
-	    }
-	    switch(l.cmd){
-	    case LC_SEGMENT:
-		if(l.cmdsize < sizeof(struct segment_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SEGMENT cmdsize "
-			         "too small) in command %u", i);
-		    goto return_bad;
-		}
-		sg = (struct segment_command *)lc;
-		if(swapped)
-		    swap_segment_command(sg, host_byte_sex);
-		big_size = sg->nsects;
-		big_size *= sizeof(struct section);
-		big_size += sizeof(struct segment_command);
-		if(sg->cmdsize != big_size){
-		    Mach_O_error(ofile, "malformed object (inconsistent "
-				 "cmdsize in LC_SEGMENT command %u for the "
-				 "number of sections)", i);
-		    goto return_bad;
-		}
-		if(sg->fileoff > size){
-		    Mach_O_error(ofile, "truncated or malformed object ("
-				 "LC_SEGMENT command %u fileoff field "
-				 "extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		big_size = sg->fileoff;
-		big_size += sg->filesize;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object ("
-				 "LC_SEGMENT command %u fileoff field "
-				 "plus filesize field extends past the end of "
-				 "the file)", i);
-		    goto return_bad;
-		}
-		if(sg->vmsize != 0 && sg->filesize > sg->vmsize){
-		    Mach_O_error(ofile, "malformed object (LC_SEGMENT command "
-				 "%u filesize field greater than vmsize field)",
-				 i);
-		    goto return_bad;
-		}
-		s = (struct section *)
-		    ((char *)sg + sizeof(struct segment_command));
-		if(swapped)
-		    swap_section(s, sg->nsects, host_byte_sex);
-		for(j = 0 ; j < sg->nsects ; j++){
-		    if(mh->filetype != MH_DYLIB_STUB &&
-		       mh->filetype != MH_DSYM &&
-		       s->flags != S_ZEROFILL &&
-		       s->flags != S_THREAD_LOCAL_ZEROFILL && s->offset > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-				"(offset field of section %u in LC_SEGMENT "
-				"command %u extends past the end of the file)",
-				j, i);
-			goto return_bad;
-		    }
-		    if(mh->filetype != MH_DYLIB_STUB &&
-		       mh->filetype != MH_DSYM &&
-		       s->flags != S_ZEROFILL &&
-		       s->flags != S_THREAD_LOCAL_ZEROFILL &&
-		       sg->fileoff == 0 && s->offset < sizeofhdrs &&
-		       s->size != 0){
-			Mach_O_error(ofile, "malformed object (offset field of "
-				"section %u in LC_SEGMENT command %u not "
-				"past the headers of the file)", j, i);
-			goto return_bad;
-		    }
-		    big_size = s->offset;
-		    big_size += s->size;
-		    if(mh->filetype != MH_DYLIB_STUB &&
-		       mh->filetype != MH_DSYM &&
-		       s->flags != S_ZEROFILL &&
-		       s->flags != S_THREAD_LOCAL_ZEROFILL && big_size > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-				"(offset field plus size field of section %u "
-				"in LC_SEGMENT command %u extends "
-				"past the end of the file)", j, i);
-			goto return_bad;
-		    }
-		    if(mh->filetype != MH_DYLIB_STUB &&
-		       mh->filetype != MH_DSYM &&
-		       s->flags != S_ZEROFILL &&
-		       s->flags != S_THREAD_LOCAL_ZEROFILL &&
-		       s->size > sg->filesize){
-			Mach_O_error(ofile, "malformed object (size field of "
-				"section %u in LC_SEGMENT command %u greater "
-				"than the segment)", j, i);
-			goto return_bad;
-		    }
-		    if(mh->filetype != MH_DYLIB_STUB &&
-		       mh->filetype != MH_DSYM &&
-		       s->size != 0 && s->addr < sg->vmaddr){
-			Mach_O_error(ofile, "malformed object (addr field of "
-				"section %u in LC_SEGMENT command %u less than "
-				"the segment's vmaddr)", j, i);
-			goto return_bad;
-		    }
-		    big_size = s->addr;
-		    big_size += s->size;
-		    big_end = sg->vmaddr;
-		    big_end += sg->vmsize;
-		    if(sg->vmsize != 0 && s->size != 0 && big_size > big_end){
-			Mach_O_error(ofile, "malformed object (addr field plus "
-				"size of section %u in LC_SEGMENT command %u "
-				"greater than than the segment's vmaddr plus "
-				"vmsize)", j, i);
-			goto return_bad;
-		    }
-		    if(mh->filetype != MH_DYLIB_STUB &&
-		       mh->filetype != MH_DSYM &&
-		       s->flags != S_ZEROFILL &&
-		       s->flags != S_THREAD_LOCAL_ZEROFILL &&
-		       check_overlaping_element(ofile, &elements, s->offset,
-			    s->size, "section contents") == CHECK_BAD)
-			goto return_bad;
-		    if(s->reloff > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-				"(reloff field of section %u in LC_SEGMENT "
-				"command %u extends past the end of the file)",
-				j, i);
-			goto return_bad;
-		    }
-		    big_size = s->nreloc;
-		    big_size *= sizeof(struct relocation_info);
-		    big_size += s->reloff;
-		    if(big_size > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-				"(reloff field plus nreloc field times sizeof("
-				"struct relocation_info) of section %u in "
-				"LC_SEGMENT command %u extends past the "
-				"end of the file)", j, i);
-			goto return_bad;
-		    }
-		    if(check_overlaping_element(ofile, &elements, s->reloff,
-			    s->nreloc * sizeof(struct relocation_info),
-			    "section relocation entries") == CHECK_BAD)
-			goto return_bad;
-		    s++;
-		}
-		break;
-
-	    case LC_SEGMENT_64:
-		if(l.cmdsize < sizeof(struct segment_command_64)){
-		    Mach_O_error(ofile, "malformed object (LC_SEGMENT_64 "
-				 "cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		sg64 = (struct segment_command_64 *)lc;
-		if(swapped)
-		    swap_segment_command_64(sg64, host_byte_sex);
-		big_size = sg64->nsects;
-		big_size *= sizeof(struct section_64);
-		big_size += sizeof(struct segment_command_64);
-		if(sg64->cmdsize != big_size){
-		    Mach_O_error(ofile, "malformed object (inconsistent "
-				 "cmdsize in LC_SEGMENT_64 command %u for "
-				 "the number of sections)", i);
-		    goto return_bad;
-		}
-		if(sg64->fileoff > size){
-		    Mach_O_error(ofile, "truncated or malformed object ("
-				 "LC_SEGMENT_64 command %u fileoff field "
-				 "extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		big_size = sg64->fileoff;
-		big_size += sg64->filesize;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object ("
-				 "LC_SEGMENT_64 command %u fileoff field "
-				 "plus filesize field extends past the end of "
-				 "the file)", i);
-		    goto return_bad;
-		}
-		s64 = (struct section_64 *)
-		    ((char *)sg64 + sizeof(struct segment_command_64));
-		if(swapped)
-		    swap_section_64(s64, sg64->nsects, host_byte_sex);
-		for(j = 0 ; j < sg64->nsects ; j++){
-		    if(mh64->filetype != MH_DYLIB_STUB &&
-		       mh64->filetype != MH_DSYM &&
-		       s64->flags != S_ZEROFILL &&
-		       s64->flags != S_THREAD_LOCAL_ZEROFILL &&
-		       s64->offset > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-				"(offset field of section %u in LC_SEGMENT_64 "
-				"command %u extends past the end of the file)",
-				j, i);
-			goto return_bad;
-		    }
-		    if(mh64->filetype != MH_DYLIB_STUB &&
-		       mh64->filetype != MH_DSYM &&
-		       s64->flags != S_ZEROFILL &&
-		       s64->flags != S_THREAD_LOCAL_ZEROFILL &&
-		       sg64->fileoff == 0 && s64->offset < sizeofhdrs &&
-		       s64->size != 0){
-			Mach_O_error(ofile, "malformed object (offset field of "
-				"section %u in LC_SEGMENT command %u not "
-				"past the headers of the file)", j, i);
-			goto return_bad;
-		    }
-		    big_size = s64->offset;
-		    big_size += s64->size;
-		    if(mh64->filetype != MH_DYLIB_STUB &&
-		       mh64->filetype != MH_DSYM &&
-		       s64->flags != S_ZEROFILL &&
-		       s64->flags != S_THREAD_LOCAL_ZEROFILL &&
-		       big_size > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-				"(offset field plus size field of section %u "
-				"in LC_SEGMENT_64 command %u extends "
-				"past the end of the file)", j, i);
-			goto return_bad;
-		    }
-		    if(mh64->filetype != MH_DYLIB_STUB &&
-		       mh64->filetype != MH_DSYM &&
-		       s64->flags != S_ZEROFILL &&
-		       s64->flags != S_THREAD_LOCAL_ZEROFILL &&
-		       check_overlaping_element(ofile, &elements, s64->offset,
-			    s64->size, "section contents") == CHECK_BAD)
-			goto return_bad;
-		    if(s64->reloff > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-				"(reloff field of section %u in LC_SEGMENT_64 "
-				"command %u extends past the end of the file)",
-				j, i);
-			goto return_bad;
-		    }
-		    big_size = s64->nreloc;
-		    big_size *= sizeof(struct relocation_info);
-		    big_size += s64->reloff;
-		    if(big_size > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-				"(reloff field plus nreloc field times sizeof("
-				"struct relocation_info) of section %u in "
-				"LC_SEGMENT_64 command %u extends past the "
-				"end of the file)", j, i);
-			goto return_bad;
-		    }
-		    if(check_overlaping_element(ofile, &elements, s64->reloff,
-			    s64->nreloc * sizeof(struct relocation_info),
-			    "section relocation entries") == CHECK_BAD)
-			goto return_bad;
-		    s64++;
-		}
-		break;
-
-	    case LC_SYMTAB:
-		if(l.cmdsize < sizeof(struct symtab_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SYMTAB cmdsize "
-			         "too small) in command %u", i);
-		    goto return_bad;
-		}
-		if(st != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"LC_SYMTAB command)");
-		    goto return_bad;
-		}
-		st = (struct symtab_command *)lc;
-		if(swapped)
-		    swap_symtab_command(st, host_byte_sex);
-		if(st->cmdsize != sizeof(struct symtab_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SYMTAB command "
-			"%u has incorrect cmdsize)", i);
-		    goto return_bad;
-		}
-		if(st->symoff > size){
-		    Mach_O_error(ofile, "truncated or malformed object (symoff "
-			"field of LC_SYMTAB command %u extends past the end "
-			"of the file)", i);
-		    goto return_bad;
-		}
-		big_size = st->nsyms;
-		big_size *= sizeof_nlist;
-		big_size += st->symoff;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object (symoff "
-			"field plus nsyms field times sizeof(%s) of LC_SYMTAB "
-			"command %u extends past the end of the file)",
-			struct_nlist_name, i);
-		    goto return_bad;
-		}
-		if(check_overlaping_element(ofile, &elements, st->symoff,
-			st->nsyms * sizeof_nlist, "symbol table") == CHECK_BAD)
-		    goto return_bad;
-		if(st->stroff > size){
-		    Mach_O_error(ofile, "truncated or malformed object (stroff "
-			"field of LC_SYMTAB command %u extends past the end "
-			"of the file)", i);
-		    goto return_bad;
-		}
-		big_size = st->stroff;
-		big_size += st->strsize;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object (stroff "
-			"field plus strsize field of LC_SYMTAB command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(check_overlaping_element(ofile, &elements, st->stroff,
-			st->strsize, "string table") == CHECK_BAD)
-		    goto return_bad;
-		break;
-
-	    case LC_DYSYMTAB:
-		if(l.cmdsize < sizeof(struct dysymtab_command)){
-		    Mach_O_error(ofile, "malformed object (LC_DYSYMTAB cmdsize "
-			         "too small) in command %u", i);
-		    goto return_bad;
-		}
-		if(dyst != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"LC_DYSYMTAB command)");
-		    goto return_bad;
-		}
-		dyst = (struct dysymtab_command *)lc;
-		if(swapped)
-		    swap_dysymtab_command(dyst, host_byte_sex);
-		if(dyst->cmdsize != sizeof(struct dysymtab_command)){
-		    Mach_O_error(ofile, "malformed object (LC_DYSYMTAB command "
-			"%u has incorrect cmdsize)", i);
-		    goto return_bad;
-		}
-		if(dyst->tocoff > size){
-		    Mach_O_error(ofile, "truncated or malformed object (tocoff "
-			"field of LC_DYSYMTAB command %u extends past the end "
-			"of the file)", i);
-		    goto return_bad;
-		}
-		big_size = dyst->ntoc;
-		big_size *= sizeof(struct dylib_table_of_contents);
-		big_size += dyst->tocoff;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object (tocoff "
-			"field plus ntoc field times sizeof(struct dylib_table"
-			"_of_contents) of LC_DYSYMTAB command %u extends past "
-			"the end of the file)", i);
-		    goto return_bad;
-		}
-		if(check_overlaping_element(ofile, &elements, dyst->tocoff,
-			dyst->ntoc * sizeof(struct dylib_table_of_contents),
-			"table of contents") == CHECK_BAD)
-		    goto return_bad;
-		if(dyst->modtaboff > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(modtaboff field of LC_DYSYMTAB command %u extends "
-			"past the end of the file)", i);
-		    goto return_bad;
-		}
-		big_size = dyst->nmodtab;
-		big_size *= sizeof_dylib_module;
-		big_size += dyst->modtaboff;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(modtaboff field plus nmodtab field times sizeof(%s) "
-			"of LC_DYSYMTAB command %u extends past the end of "
-			"the file)", struct_dylib_module_name, i);
-		    goto return_bad;
-		}
-		if(check_overlaping_element(ofile, &elements, dyst->modtaboff,
-			dyst->nmodtab * sizeof_dylib_module, "module table") == 
-			CHECK_BAD)
-		    goto return_bad;
-		if(dyst->extrefsymoff > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(extrefsymoff field of LC_DYSYMTAB command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		big_size = dyst->nextrefsyms;
-		big_size *= sizeof(struct dylib_reference);
-		big_size += dyst->extrefsymoff;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(extrefsymoff field plus nextrefsyms field times "
-			"sizeof(struct dylib_reference) of LC_DYSYMTAB command "
-			"%u extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(check_overlaping_element(ofile, &elements,dyst->extrefsymoff,
-			dyst->nextrefsyms * sizeof(struct dylib_reference),
-			"reference table") == CHECK_BAD)
-		    goto return_bad;
-		if(dyst->indirectsymoff > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(indirectsymoff field of LC_DYSYMTAB command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		big_size = dyst->nindirectsyms;
-		big_size *= sizeof(uint32_t);
-		big_size += dyst->indirectsymoff;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(indirectsymoff field plus nindirectsyms field times "
-			"sizeof(uint32_t) of LC_DYSYMTAB command "
-			"%u extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(check_overlaping_element(ofile, &elements,
-			dyst->indirectsymoff, dyst->nindirectsyms *
-			sizeof(uint32_t), "indirect table") == CHECK_BAD)
-		    goto return_bad;
-		if(dyst->extreloff > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(extreloff field of LC_DYSYMTAB command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		big_size = dyst->nextrel;
-		big_size *= sizeof(struct relocation_info);
-		big_size += dyst->extreloff;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(extreloff field plus nextrel field times "
-			"sizeof(struct relocation_info) of LC_DYSYMTAB command "
-			"%u extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(check_overlaping_element(ofile, &elements, dyst->extreloff,
-			dyst->nextrel * sizeof(struct relocation_info),
-			"external relocation table") == CHECK_BAD)
-		    goto return_bad;
-		if(dyst->locreloff > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(locreloff field of LC_DYSYMTAB command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		big_size = dyst->nlocrel;
-		big_size *= sizeof(struct relocation_info);
-		big_size += dyst->locreloff;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(locreloff field plus nlocrel field times "
-			"sizeof(struct relocation_info) of LC_DYSYMTAB command "
-			"%u extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(check_overlaping_element(ofile, &elements, dyst->locreloff,
-			dyst->nlocrel * sizeof(struct relocation_info),
-			"local relocation table") == CHECK_BAD)
-		    goto return_bad;
-		break;
-
-	    case LC_ROUTINES:
-		if(l.cmdsize < sizeof(struct routines_command)){
-		    Mach_O_error(ofile, "malformed object (LC_ROUTINES cmdsize "
-			         "too small) in command %u", i);
-		    goto return_bad;
-		}
-		if(rc != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"LC_ROUTINES command)");
-		    goto return_bad;
-		}
-		rc = (struct routines_command *)lc;
-		if(swapped)
-		    swap_routines_command(rc, host_byte_sex);
-		if(rc->cmdsize != sizeof(struct routines_command)){
-		    Mach_O_error(ofile, "malformed object (LC_ROUTINES "
-			"command %u has incorrect cmdsize)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_ROUTINES_64:
-		if(l.cmdsize < sizeof(struct routines_command_64)){
-		    Mach_O_error(ofile, "malformed object (LC_ROUTINES_64 "
-				 "cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		if(rc64 != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"LC_ROUTINES_64 command)");
-		    goto return_bad;
-		}
-		rc64 = (struct routines_command_64 *)lc;
-		if(swapped)
-		    swap_routines_command_64(rc64, host_byte_sex);
-		if(rc64->cmdsize != sizeof(struct routines_command_64)){
-		    Mach_O_error(ofile, "malformed object (LC_ROUTINES_64 "
-			"command %u has incorrect cmdsize)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_TWOLEVEL_HINTS:
-		if(l.cmdsize < sizeof(struct twolevel_hints_command)){
-		    Mach_O_error(ofile, "malformed object (LC_TWOLEVEL_HINTS "
-				 "cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		if(hints != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"LC_TWOLEVEL_HINTS command)");
-		    goto return_bad;
-		}
-		hints = (struct twolevel_hints_command *)lc;
-		if(swapped)
-		    swap_twolevel_hints_command(hints, host_byte_sex);
-		if(hints->cmdsize != sizeof(struct twolevel_hints_command)){
-		    Mach_O_error(ofile, "malformed object (LC_TWOLEVEL_HINTS "
-			         "command %u has incorrect cmdsize)", i);
-		    goto return_bad;
-		}
-		if(hints->offset > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(offset field of LC_TWOLEVEL_HINTS command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		big_size = hints->nhints;
-		big_size *= sizeof(struct twolevel_hint);
-		big_size += hints->offset;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(offset field plus nhints field times "
-			"sizeof(struct twolevel_hint) of LC_TWOLEVEL_HINTS "
-			" command %u extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(check_overlaping_element(ofile, &elements, hints->offset,
-			hints->nhints * sizeof(struct twolevel_hint),
-			"two level hints") == CHECK_BAD)
-		    goto return_bad;
-		break;
-
-	    case LC_SEGMENT_SPLIT_INFO:
-		cmd_name = "LC_SEGMENT_SPLIT_INFO";
-		element_name = "split info data";
-		if(split_info != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"%s command)", cmd_name);
-		    goto return_bad;
-		}
-		split_info = (struct linkedit_data_command *)lc;
-		goto check_linkedit_data_command;
-
-	    case LC_CODE_SIGNATURE:
-		cmd_name = "LC_CODE_SIGNATURE";
-		element_name = "code signature data";
-		if(code_sig != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"%s command)", cmd_name);
-		    goto return_bad;
-		}
-		code_sig = (struct linkedit_data_command *)lc;
-		goto check_linkedit_data_command;
-
-	    case LC_FUNCTION_STARTS:
-		cmd_name = "LC_FUNCTION_STARTS";
-		element_name = "function starts data";
-		if(func_starts != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"%s command)", cmd_name);
-		    goto return_bad;
-		}
-		func_starts = (struct linkedit_data_command *)lc;
-		goto check_linkedit_data_command;
-
-	    case LC_DATA_IN_CODE:
-		cmd_name = "LC_DATA_IN_CODE";
-		element_name = "date in code info";
-		if(data_in_code != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"%s command)", cmd_name);
-		    goto return_bad;
-		}
-		data_in_code = (struct linkedit_data_command *)lc;
-		goto check_linkedit_data_command;
-
-	    case LC_DYLIB_CODE_SIGN_DRS:
-		cmd_name = "LC_DYLIB_CODE_SIGN_DRS";
-		element_name = "code signing RDs data";
-		if(code_sign_drs != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"%s command)", cmd_name);
-		    goto return_bad;
-		}
-		code_sign_drs = (struct linkedit_data_command *)lc;
-		goto check_linkedit_data_command;
-
-	    case LC_LINKER_OPTIMIZATION_HINT:
-		cmd_name = "LC_LINKER_OPTIMIZATION_HINT";
-		element_name = "linker optimization hint";
-		if(link_opt_hint != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"%s command)", cmd_name);
-		    goto return_bad;
-		}
-		link_opt_hint = (struct linkedit_data_command *)lc;
-		goto check_linkedit_data_command;
-
-check_linkedit_data_command:
-		if(l.cmdsize < sizeof(struct linkedit_data_command)){
-		    Mach_O_error(ofile, "malformed object (%s cmdsize too "
-				 "small) in command %u", cmd_name, i);
-		    goto return_bad;
-		}
-		linkedit_data = (struct linkedit_data_command *)lc;
-		if(swapped)
-		    swap_linkedit_data_command(linkedit_data, host_byte_sex);
-		if(linkedit_data->cmdsize !=
-		   sizeof(struct linkedit_data_command)){
-		    Mach_O_error(ofile, "malformed object (%s command %u has "
-				 "incorrect cmdsize)", cmd_name, i);
-		    goto return_bad;
-		}
-		if(linkedit_data->dataoff > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(dataoff field of %s command %u extends past the end "
-			"of the file)", cmd_name, i);
-		    goto return_bad;
-		}
-		big_size = linkedit_data->dataoff;
-		big_size += linkedit_data->datasize;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(dataoff field plus datasize field of "
-			"%s command %u extends past the end of "
-			"the file)", cmd_name, i);
-		    goto return_bad;
-		}
-		if(check_overlaping_element(ofile, &elements,
-			linkedit_data->dataoff, linkedit_data->datasize,
-			element_name) == CHECK_BAD)
-		    goto return_bad;
-		break;
-
-	    case LC_VERSION_MIN_MACOSX:
-		if(l.cmdsize < sizeof(struct version_min_command)){
-		    Mach_O_error(ofile, "malformed object (LC_VERSION_MIN_"
-				 "MACOSX cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		if(vers != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"LC_VERSION_MIN_IPHONEOS or LC_VERSION_MIN_MACOSX "
-			"command)");
-		    goto return_bad;
-		}
-		vers = (struct version_min_command *)lc;
-		if(swapped)
-		    swap_version_min_command(vers, host_byte_sex);
-		if(vers->cmdsize < sizeof(struct version_min_command)){
-		    Mach_O_error(ofile, "malformed object (LC_VERSION_MIN_"
-			"MACOSX command %u has too small cmdsize field)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_VERSION_MIN_IPHONEOS:
-		if(l.cmdsize < sizeof(struct version_min_command)){
-		    Mach_O_error(ofile, "malformed object (LC_VERSION_MIN_"
-				 "IPHONEOS cmdsize too small) in command %u",i);
-		    goto return_bad;
-		}
-		if(vers != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"LC_VERSION_MIN_IPHONEOS or LC_VERSION_MIN_MACOSX "
-			"command)");
-		    goto return_bad;
-		}
-		vers = (struct version_min_command *)lc;
-		if(swapped)
-		    swap_version_min_command(vers, host_byte_sex);
-		if(vers->cmdsize < sizeof(struct version_min_command)){
-		    Mach_O_error(ofile, "malformed object (LC_VERSION_MIN_"
-			"IPHONEOS command %u has too small cmdsize field)", i);
-		    goto return_bad;
-		}
-		break;
-
-
-	    case LC_VERSION_MIN_WATCHOS:
-		if(l.cmdsize < sizeof(struct version_min_command)){
-		    Mach_O_error(ofile, "malformed object (LC_VERSION_MIN_"
-				 "WATCHOS cmdsize too small) in command %u",i);
-		    goto return_bad;
-		}
-		if(vers != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"LC_VERSION_MIN_IPHONEOS, LC_VERSION_MIN_MACOSX or "
-			"LC_VERSION_MIN_WATCHOS command)");
-		    goto return_bad;
-		}
-		vers = (struct version_min_command *)lc;
-		if(swapped)
-		    swap_version_min_command(vers, host_byte_sex);
-		if(vers->cmdsize < sizeof(struct version_min_command)){
-		    Mach_O_error(ofile, "malformed object (LC_VERSION_MIN_"
-			"WATCHOS command %u has too small cmdsize field)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_ENCRYPTION_INFO:
-		if(l.cmdsize < sizeof(struct encryption_info_command)){
-		    Mach_O_error(ofile, "malformed object (LC_ENCRYPTION_INFO "
-				 "cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		encrypt_info = (struct encryption_info_command *)lc;
-		if(swapped) 
-		    swap_encryption_command(encrypt_info, host_byte_sex);
-		if(encrypt_info->cmdsize !=
-		   sizeof(struct encryption_info_command)){
-		    Mach_O_error(ofile, "malformed object (LC_ENCRYPTION_INFO"
-				 "command %u has incorrect cmdsize)", i);
-		    goto return_bad;
-		}
-		if(encrypt_info->cryptoff > size){
-		Mach_O_error(ofile, "truncated or malformed object (cryptoff "
-			     "field of LC_ENCRYPTION_INFO command %u extends "
-			     "past the end of the file)", i);
-		    goto return_bad;
-		}
-		big_size = encrypt_info->cryptoff;
-		big_size += encrypt_info->cryptsize;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-				 "(cryptoff field plus cryptsize field of "
-				 "LC_ENCRYPTION_INFO command %u extends past "
-				 "the end of the file)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_ENCRYPTION_INFO_64:
-		if(l.cmdsize < sizeof(struct encryption_info_command_64)){
-		    Mach_O_error(ofile, "malformed object (LC_ENCRYPTION_INFO"
-			         "_64 cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		encrypt_info64 = (struct encryption_info_command_64 *)lc;
-		if(swapped) 
-		    swap_encryption_command_64(encrypt_info64, host_byte_sex);
-		if(encrypt_info64->cmdsize !=
-		   sizeof(struct encryption_info_command_64)){
-		    Mach_O_error(ofile, "malformed object (LC_ENCRYPTION_INFO"
-				 "_64 command %u has incorrect cmdsize)", i);
-		    goto return_bad;
-		}
-		if(encrypt_info64->cryptoff > size){
-		Mach_O_error(ofile, "truncated or malformed object (cryptoff "
-			     "field of LC_ENCRYPTION_INFO_64 command %u extends"
-			     " past the end of the file)", i);
-		    goto return_bad;
-		}
-		big_size = encrypt_info64->cryptoff;
-		big_size += encrypt_info64->cryptsize;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-				 "(cryptoff field plus cryptsize field of "
-				 "LC_ENCRYPTION_INFO_64 command %u extends past"
-				 " the end of the file)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_LINKER_OPTION:
-		if(l.cmdsize < sizeof(struct linker_option_command)){
-		    Mach_O_error(ofile, "malformed object (LC_LINKER_OPTION "
-			         "cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		lo = (struct linker_option_command *)lc;
-		if(swapped) 
-		    swap_linker_option_command(lo, host_byte_sex);
-		if(lo->cmdsize <
-		   sizeof(struct linker_option_command)){
-		    Mach_O_error(ofile, "malformed object (LC_LINKER_OPTION "
-				 " command %u cmdsize too small)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_DYLD_INFO:
-	    case LC_DYLD_INFO_ONLY:
-		if(l.cmdsize < sizeof(struct dyld_info_command)){
-		    Mach_O_error(ofile, "malformed object (%s cmdsize "
-			         "too small) in command %u", l.cmd ==
-				 LC_DYLD_INFO ? "LC_DYLD_INFO" :
-				 "LC_DYLD_INFO_ONLY", i);
-		    goto return_bad;
-		}
-		dyld_info = (struct dyld_info_command *)lc;
-		if(swapped) 
-		    swap_dyld_info_command(dyld_info, host_byte_sex);
-		if(dyld_info->cmdsize !=
-		   sizeof(struct dyld_info_command)){
-		    Mach_O_error(ofile, "malformed object (LC_DYLD_INFO"
-				 "command %u has incorrect cmdsize)", i);
-		    goto return_bad;
-		}
-		if(dyld_info->rebase_off != 0 && dyld_info->rebase_off > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(rebase_off field of LC_DYLD_INFO command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(dyld_info->rebase_off != 0){
-		    big_size = dyld_info->rebase_off;
-		    big_size += dyld_info->rebase_size;
-		    if(big_size > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-			    "(rebase_off plus rebase_size of LC_DYLD_INFO "
-			    "command %u extends past the end of the file)", i);
-			goto return_bad;
-		    }
-		}
-		if(check_overlaping_element(ofile, &elements,
-			dyld_info->rebase_off, dyld_info->rebase_size,
-			"dyld rebase info") == CHECK_BAD)
-		    goto return_bad;
-		if(dyld_info->bind_off != 0 && dyld_info->bind_off > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(bind_off field of LC_DYLD_INFO command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(dyld_info->bind_off != 0){
-		    big_size = dyld_info->bind_off;
-		    big_size += dyld_info->bind_size;
-		    if(big_size > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-			    "(bind_off plus bind_size of LC_DYLD_INFO command "
-			    "%u extends past the end of the file)", i);
-			goto return_bad;
-		    }
-		}
-		if(check_overlaping_element(ofile, &elements,
-			dyld_info->bind_off, dyld_info->bind_size,
-			"dyld bind info") == CHECK_BAD)
-		    goto return_bad;
-		if(dyld_info->weak_bind_off != 0 &&
-		   dyld_info->weak_bind_off > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(weak_bind_off field of LC_DYLD_INFO command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(dyld_info->weak_bind_off != 0){
-		    big_size = dyld_info->weak_bind_off;
-		    big_size += dyld_info->weak_bind_size;
-		    if(big_size > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-			    "(weak_bind_off plus weak_bind_size of LC_DYLD_INFO"
-			    " command %u extends past the end of the file)", i);
-			goto return_bad;
-		    }
-		}
-		if(check_overlaping_element(ofile, &elements,
-			dyld_info->weak_bind_off, dyld_info->weak_bind_size,
-			"dyld bind info") == CHECK_BAD)
-		    goto return_bad;
-		if(dyld_info->lazy_bind_off != 0 &&
-		   dyld_info->lazy_bind_off > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(lazy_bind_off field of LC_DYLD_INFO command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(dyld_info->lazy_bind_off != 0){
-		    big_size = dyld_info->lazy_bind_off;
-		    big_size += dyld_info->lazy_bind_size;
-		    if(big_size > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-			    "(lazy_bind_off plus lazy_bind_size of LC_DYLD_INFO"
-			    " command %u extends past the end of the file)", i);
-			goto return_bad;
-		    }
-		}
-		if(check_overlaping_element(ofile, &elements,
-			dyld_info->lazy_bind_off, dyld_info->lazy_bind_size,
-			"dyld lazy bind info") == CHECK_BAD)
-		    goto return_bad;
-		if(dyld_info->export_off != 0 && dyld_info->export_off > size){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(export_off field of LC_DYLD_INFO command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(dyld_info->export_off != 0){
-		    big_size = dyld_info->export_off;
-		    big_size += dyld_info->export_size;
-		    if(big_size > size){
-			Mach_O_error(ofile, "truncated or malformed object "
-			    "(export_off plus export_size of LC_DYLD_INFO "
-			    "command %u extends past the end of the file)", i);
-			goto return_bad;
-		    }
-		}
-		if(check_overlaping_element(ofile, &elements,
-			dyld_info->export_off, dyld_info->export_size,
-			"dyld export info") == CHECK_BAD)
-		    goto return_bad;
-		break;
-		
-
-
-	    case LC_PREBIND_CKSUM:
-		if(l.cmdsize < sizeof(struct prebind_cksum_command)){
-		    Mach_O_error(ofile, "malformed object (LC_PREBIND_CKSUM "
-				 "cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		if(cs != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"LC_PREBIND_CKSUM command)");
-		    goto return_bad;
-		}
-		cs = (struct prebind_cksum_command *)lc;
-		if(swapped)
-		    swap_prebind_cksum_command(cs, host_byte_sex);
-		if(cs->cmdsize != sizeof(struct prebind_cksum_command)){
-		    Mach_O_error(ofile, "malformed object (LC_PREBIND_CKSUM "
-			"command %u has incorrect cmdsize)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_UUID:
-		if(l.cmdsize < sizeof(struct uuid_command)){
-		    Mach_O_error(ofile, "malformed object (LC_UUID cmdsize "
-			         "too small) in command %u", i);
-		    goto return_bad;
-		}
-		if(uuid != NULL){
-		    Mach_O_error(ofile, "malformed object (more than one "
-			"LC_UUID command)");
-		    goto return_bad;
-		}
-		uuid = (struct uuid_command *)lc;
-		if(swapped)
-		    swap_uuid_command(uuid, host_byte_sex);
-		if(uuid->cmdsize != sizeof(struct uuid_command)){
-		    Mach_O_error(ofile, "malformed object (LC_UUID command %u "			"has incorrect cmdsize)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_SYMSEG:
-		if(l.cmdsize < sizeof(struct symseg_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SYMSEG cmdsize "
-			         "too small) in command %u", i);
-		    goto return_bad;
-		}
-		ss = (struct symseg_command *)lc;
-		if(swapped)
-		    swap_symseg_command(ss, host_byte_sex);
-		if(ss->cmdsize != sizeof(struct symseg_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SYMSEG command "
-			"%u has incorrect cmdsize)", i);
-		    goto return_bad;
-		}
-		if(ss->offset > size){
-		    Mach_O_error(ofile, "truncated or malformed object (offset "
-			"field of LC_SYMSEG command %u extends past the end "
-			"of the file)", i);
-		    goto return_bad;
-		}
-		big_size = ss->offset;
-		big_size += ss->size;
-		if(big_size > size){
-		    Mach_O_error(ofile, "truncated or malformed object (offset "
-			"field plus size field of LC_SYMTAB command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(check_overlaping_element(ofile, &elements, ss->offset,
-			ss->size, "symseg info") == CHECK_BAD)
-		    goto return_bad;
-		break;
-
-	    case LC_IDFVMLIB:
-	    case LC_LOADFVMLIB:
-		if(l.cmdsize < sizeof(struct fvmlib_command)){
-		    Mach_O_error(ofile, "malformed object (%s cmdsize "
-			         "too small) in command %u", l.cmd ==
-				 LC_IDFVMLIB ? "LC_IDFVMLIB" :
-				 "LC_LOADFVMLIB", i);
-		    goto return_bad;
-		}
-		fl = (struct fvmlib_command *)lc;
-		if(swapped)
-		    swap_fvmlib_command(fl, host_byte_sex);
-		if(fl->cmdsize < sizeof(struct fvmlib_command)){
-		    Mach_O_error(ofile, "malformed object (%s command %u has "
-			"too small cmdsize field)", fl->cmd == LC_IDFVMLIB ? 
-			"LC_IDFVMLIB" : "LC_LOADFVMLIB", i);
-		    goto return_bad;
-		}
-		if(fl->fvmlib.name.offset >= fl->cmdsize){
-		    Mach_O_error(ofile, "truncated or malformed object (name."
-			"offset field of %s command %u extends past the end "
-			"of the file)", fl->cmd == LC_IDFVMLIB ? "LC_IDFVMLIB"
-			: "LC_LOADFVMLIB", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_ID_DYLIB:
-		cmd_name = "LC_ID_DYLIB";
-		goto check_dylib_command;
-	    case LC_LOAD_DYLIB:
-		cmd_name = "LC_LOAD_DYLIB";
-		goto check_dylib_command;
-	    case LC_LOAD_WEAK_DYLIB:
-		cmd_name = "LC_LOAD_WEAK_DYLIB";
-		goto check_dylib_command;
-	    case LC_REEXPORT_DYLIB:
-		cmd_name = "LC_REEXPORT_DYLIB";
-		goto check_dylib_command;
-	    case LC_LOAD_UPWARD_DYLIB:
-		cmd_name = "LC_LOAD_UPWARD_DYLIB";
-		goto check_dylib_command;
-	    case LC_LAZY_LOAD_DYLIB:
-		cmd_name = "LC_LAZY_LOAD_DYLIB";
-		goto check_dylib_command;
-check_dylib_command:
-		if(l.cmdsize < sizeof(struct dylib_command)){
-		    Mach_O_error(ofile, "malformed object (%s cmdsize too "
-				 "small) in command %u", cmd_name, i);
-		    goto return_bad;
-		}
-		dl = (struct dylib_command *)lc;
-		if(swapped)
-		    swap_dylib_command(dl, host_byte_sex);
-		if(dl->cmdsize < sizeof(struct dylib_command)){
-		    Mach_O_error(ofile, "malformed object (%s command %u has "
-			"too small cmdsize field)", cmd_name, i);
-		    goto return_bad;
-		}
-		if(dl->dylib.name.offset >= dl->cmdsize){
-		    Mach_O_error(ofile, "truncated or malformed object (name."
-			"offset field of %s command %u extends past the end "
-			"of the file)", cmd_name, i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_SUB_FRAMEWORK:
-		if(l.cmdsize < sizeof(struct sub_framework_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SUB_FRAMEWORK "
-				 "cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		sub = (struct sub_framework_command *)lc;
-		if(swapped)
-		    swap_sub_framework_command(sub, host_byte_sex);
-		if(sub->cmdsize < sizeof(struct sub_framework_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SUB_FRAMEWORK "
-			"command %u has too small cmdsize field)", i);
-		    goto return_bad;
-		}
-		if(sub->umbrella.offset >= sub->cmdsize){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(umbrella.offset field of LC_SUB_FRAMEWORK command "
-			"%u extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_SUB_UMBRELLA:
-		if(l.cmdsize < sizeof(struct sub_umbrella_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SUB_UMBRELLA "
-				 "cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		usub = (struct sub_umbrella_command *)lc;
-		if(swapped)
-		    swap_sub_umbrella_command(usub, host_byte_sex);
-		if(usub->cmdsize < sizeof(struct sub_umbrella_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SUB_UMBRELLA "
-			"command %u has too small cmdsize field)", i);
-		    goto return_bad;
-		}
-		if(usub->sub_umbrella.offset >= usub->cmdsize){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(sub_umbrella.offset field of LC_SUB_UMBRELLA command "
-			"%u extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_SUB_LIBRARY:
-		if(l.cmdsize < sizeof(struct sub_library_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SUB_LIBRARY "
-				 "cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		lsub = (struct sub_library_command *)lc;
-		if(swapped)
-		    swap_sub_library_command(lsub, host_byte_sex);
-		if(lsub->cmdsize < sizeof(struct sub_library_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SUB_LIBRARY "
-			"command %u has too small cmdsize field)", i);
-		    goto return_bad;
-		}
-		if(lsub->sub_library.offset >= lsub->cmdsize){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(sub_library.offset field of LC_SUB_LIBRARY command "
-			"%u extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_SUB_CLIENT:
-		if(l.cmdsize < sizeof(struct sub_client_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SUB_CLIENT "
-				 "cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		csub = (struct sub_client_command *)lc;
-		if(swapped)
-		    swap_sub_client_command(csub, host_byte_sex);
-		if(csub->cmdsize < sizeof(struct sub_client_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SUB_CLIENT "
-			"command %u has too small cmdsize field)", i);
-		    goto return_bad;
-		}
-		if(csub->client.offset >= csub->cmdsize){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(cleient.offset field of LC_SUB_CLIENT command "
-			"%u extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_PREBOUND_DYLIB:
-		if(l.cmdsize < sizeof(struct prebound_dylib_command)){
-		    Mach_O_error(ofile, "malformed object (LC_PREBOUND_DYLIB "
-				 "cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		pbdylib = (struct prebound_dylib_command *)lc;
-		if(swapped)
-		    swap_prebound_dylib_command(pbdylib, host_byte_sex);
-		if(pbdylib->cmdsize < sizeof(struct dylib_command)){
-		    Mach_O_error(ofile, "malformed object (LC_PREBIND_DYLIB "
-			"command %u has too small cmdsize field)", i);
-		    goto return_bad;
-		}
-		if(pbdylib->name.offset >= pbdylib->cmdsize){
-		    Mach_O_error(ofile, "truncated or malformed object (name."
-			"offset field of LC_PREBIND_DYLIB command %u extends "
-			"past the end of the file)", i);
-		    goto return_bad;
-		}
-		if(pbdylib->linked_modules.offset >= pbdylib->cmdsize){
-		    Mach_O_error(ofile, "truncated or malformed object (linked_"
-			"modules.offset field of LC_PREBIND_DYLIB command %u "
-			"extends past the end of the file)", i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_ID_DYLINKER:
-		cmd_name = "LC_ID_DYLINKER";
-		goto check_dylinker_command;
-	    case LC_LOAD_DYLINKER:
-		cmd_name = "LC_LOAD_DYLINKER";
-		goto check_dylinker_command;
-	    case LC_DYLD_ENVIRONMENT:
-		cmd_name = "LC_DYLD_ENVIRONMENT";
-		goto check_dylinker_command;
-check_dylinker_command:
-		if(l.cmdsize < sizeof(struct dylinker_command)){
-		    Mach_O_error(ofile, "malformed object (%s cmdsize "
-			         "too small) in command %u", cmd_name, i);
-		    goto return_bad;
-		}
-		dyld = (struct dylinker_command *)lc;
-		if(swapped)
-		    swap_dylinker_command(dyld, host_byte_sex);
-		if(dyld->cmdsize < sizeof(struct dylinker_command)){
-		    Mach_O_error(ofile, "malformed object (%s command %u has "
-			"too small cmdsize field)", cmd_name, i);
-		    goto return_bad;
-		}
-		if(dyld->name.offset >= dyld->cmdsize){
-		    Mach_O_error(ofile, "truncated or malformed object (name."
-			"offset field of %s command %u extends past the end "
-			"of the file)", cmd_name, i);
-		    goto return_bad;
-		}
-		break;
-
-	    case LC_UNIXTHREAD:
-	    case LC_THREAD:
-		if(l.cmdsize < sizeof(struct thread_command)){
-		    Mach_O_error(ofile, "malformed object (%s cmdsize "
-			         "too small) in command %u", l.cmd ==
-				 LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				 "LC_THREAD", i);
-		    goto return_bad;
-		}
-		ut = (struct thread_command *)lc;
-		if(swapped)
-		    swap_thread_command(ut, host_byte_sex);
-		state = (char *)ut + sizeof(struct thread_command);
-
-	    	if(cputype == CPU_TYPE_MC680x0){
-		    struct m68k_thread_state_regs *cpu;
-		    struct m68k_thread_state_68882 *fpu;
-		    struct m68k_thread_state_user_reg *user_reg;
-
-		    nflavor = 0;
-		    p = (char *)ut + ut->cmdsize;
-		    while(state < p){
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (flavor in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			flavor = *((uint32_t *)state);
-			if(swapped){
-			    flavor = SWAP_INT(flavor);
-			    *((uint32_t *)state) = flavor;
-			}
-			state += sizeof(uint32_t);
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (count in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			count = *((uint32_t *)state);
-			if(swapped){
-			    count = SWAP_INT(count);
-			    *((uint32_t *)state) = count;
-			}
-			state += sizeof(uint32_t);
-			switch(flavor){
-			case M68K_THREAD_STATE_REGS:
-			    if(count != M68K_THREAD_STATE_REGS_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not M68K_THREAD_STATE_REGS_COUNT for "
-				    "flavor number %u which is a M68K_THREAD_"
-				    "STATE_REGS flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    cpu = (struct m68k_thread_state_regs *)state;
-			    if(state + sizeof(struct m68k_thread_state_regs) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "M68K_THREAD_STATE_REGS in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_m68k_thread_state_regs(cpu, host_byte_sex);
-			    state += sizeof(struct m68k_thread_state_regs);
-			    break;
-			case M68K_THREAD_STATE_68882:
-			    if(count != M68K_THREAD_STATE_68882_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not M68K_THREAD_STATE_68882_COUNT for "
-				    "flavor number %u which is a M68K_THREAD_"
-				    "STATE_68882 flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    fpu = (struct m68k_thread_state_68882 *)state;
-			    if(state + sizeof(struct m68k_thread_state_68882) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "M68K_THREAD_STATE_68882 in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_m68k_thread_state_68882(fpu,host_byte_sex);
-			    state += sizeof(struct m68k_thread_state_68882);
-			    break;
-			case M68K_THREAD_STATE_USER_REG:
-			    if(count != M68K_THREAD_STATE_USER_REG_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not M68K_THREAD_STATE_USER_REG_COUNT for "
-				    "flavor number %u which is a M68K_THREAD_"
-				    "STATE_USER_REG flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    user_reg =
-				(struct m68k_thread_state_user_reg *)state;
-			    if(state+sizeof(struct m68k_thread_state_user_reg) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "M68K_THREAD_STATE_USER_REG in %s command "
-				    "%u extends past end of command)", ut->cmd==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_m68k_thread_state_user_reg(user_reg,
-								host_byte_sex);
-			    state += sizeof(struct m68k_thread_state_user_reg);
-			    break;
-			default:
-			    if(swapped){
-				Mach_O_error(ofile, "malformed object (unknown "
-				    "flavor for flavor number %u in %s command"
-				    " %u can't byte swap it)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    state += count * sizeof(uint32_t);
-			    break;
-			}
-			nflavor++;
-		    }
-		    break;
-		}
-	    	if(cputype == CPU_TYPE_POWERPC ||
-	    	   cputype == CPU_TYPE_VEO){
-		    ppc_thread_state_t *nrw_cpu;
-
-		    nflavor = 0;
-		    p = (char *)ut + ut->cmdsize;
-		    while(state < p){
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (flavor in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			flavor = *((uint32_t *)state);
-			if(swapped){
-			    flavor = SWAP_INT(flavor);
-			    *((uint32_t *)state) = flavor;
-			}
-			state += sizeof(uint32_t);
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (count in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			count = *((uint32_t *)state);
-			if(swapped){
-			    count = SWAP_INT(count);
-			    *((uint32_t *)state) = count;
-			}
-			state += sizeof(uint32_t);
-			switch(flavor){
-			case PPC_THREAD_STATE:
-			    if(count != PPC_THREAD_STATE_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not PPC_THREAD_STATE_COUNT for "
-				    "flavor number %u which is a PPC_THREAD_"
-				    "STATE flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    nrw_cpu = (ppc_thread_state_t *)state;
-			    if(state + sizeof(ppc_thread_state_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "PPC_THREAD_STATE in %s command %u extends"
-				    " past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_ppc_thread_state_t(nrw_cpu,
-							     host_byte_sex);
-			    state += sizeof(ppc_thread_state_t);
-			    break;
-			default:
-			    if(swapped){
-				Mach_O_error(ofile, "malformed object (unknown "
-				    "flavor for flavor number %u in %s command"
-				    " %u can't byte swap it)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    state += count * sizeof(uint32_t);
-			    break;
-			}
-			nflavor++;
-		    }
-		    break;
-		}
-#ifdef PPC_THREAD_STATE64_COUNT
-	    	if(cputype == CPU_TYPE_POWERPC64){
-		    ppc_thread_state64_t *cpu;
-
-		    nflavor = 0;
-		    p = (char *)ut + ut->cmdsize;
-		    while(state < p){
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (flavor in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			flavor = *((uint32_t *)state);
-			if(swapped){
-			    flavor = SWAP_INT(flavor);
-			    *((uint32_t *)state) = flavor;
-			}
-			state += sizeof(uint32_t);
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (count in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			count = *((uint32_t *)state);
-			if(swapped){
-			    count = SWAP_INT(count);
-			    *((uint32_t *)state) = count;
-			}
-			state += sizeof(uint32_t);
-			switch(flavor){
-			case PPC_THREAD_STATE64:
-			    if(count != PPC_THREAD_STATE64_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not PPC_THREAD_STATE64_COUNT for "
-				    "flavor number %u which is a PPC_THREAD_"
-				    "STATE64 flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    cpu = (ppc_thread_state64_t *)state;
-			    if(state + sizeof(ppc_thread_state64_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "PPC_THREAD_STATE64 in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_ppc_thread_state64_t(cpu, host_byte_sex);
-			    state += sizeof(ppc_thread_state64_t);
-			    break;
-			default:
-			    if(swapped){
-				Mach_O_error(ofile, "malformed object (unknown "
-				    "flavor for flavor number %u in %s command"
-				    " %u can't byte swap it)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    state += count * sizeof(uint32_t);
-			    break;
-			}
-			nflavor++;
-		    }
-		    break;
-		}
-#endif /* PPC_THREAD_STATE64_COUNT */
-	    	if(cputype == CPU_TYPE_MC88000){
-		    m88k_thread_state_grf_t *cpu;
-		    m88k_thread_state_xrf_t *fpu;
-		    m88k_thread_state_user_t *user;
-		    m88110_thread_state_impl_t *spu;
-
-		    nflavor = 0;
-		    p = (char *)ut + ut->cmdsize;
-		    while(state < p){
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (flavor in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			flavor = *((uint32_t *)state);
-			if(swapped){
-			    flavor = SWAP_INT(flavor);
-			    *((uint32_t *)state) = flavor;
-			}
-			state += sizeof(uint32_t);
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (count in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			count = *((uint32_t *)state);
-			if(swapped){
-			    count = SWAP_INT(count);
-			    *((uint32_t *)state) = count;
-			}
-			state += sizeof(uint32_t);
-			switch(flavor){
-			case M88K_THREAD_STATE_GRF:
-			    if(count != M88K_THREAD_STATE_GRF_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not M88K_THREAD_STATE_GRF_COUNT for "
-				    "flavor number %u which is a M88K_THREAD_"
-				    "STATE_GRF flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    cpu = (m88k_thread_state_grf_t *)state;
-			    if(state + sizeof(m88k_thread_state_grf_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "M88K_THREAD_STATE_GRF in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_m88k_thread_state_grf_t(cpu,
-							     host_byte_sex);
-			    state += sizeof(m88k_thread_state_grf_t);
-			    break;
-			case M88K_THREAD_STATE_XRF:
-			    if(count != M88K_THREAD_STATE_XRF_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not M88K_THREAD_STATE_XRF_COUNT for "
-				    "flavor number %u which is a M88K_THREAD_"
-				    "STATE_XRF flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    fpu = (m88k_thread_state_xrf_t *)state;
-			    if(state + sizeof(m88k_thread_state_xrf_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "M88K_THREAD_STATE_XRF in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_m88k_thread_state_xrf_t(fpu,
-							     host_byte_sex);
-			    state += sizeof(m88k_thread_state_xrf_t);
-			    break;
-			case M88K_THREAD_STATE_USER:
-			    if(count != M88K_THREAD_STATE_USER_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not M88K_THREAD_STATE_USER_COUNT for "
-				    "flavor number %u which is a M88K_THREAD_"
-				    "STATE_USER flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    user = (m88k_thread_state_user_t *)state;
-			    if(state + sizeof(m88k_thread_state_user_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "M88K_THREAD_STATE_USER in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_m88k_thread_state_user_t(user,
-							      host_byte_sex);
-			    state += sizeof(m88k_thread_state_user_t);
-			    break;
-			case M88110_THREAD_STATE_IMPL:
-			    if(count != M88110_THREAD_STATE_IMPL_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not M88110_THREAD_STATE_IMPL_COUNT for "
-				    "flavor number %u which is a M88110_THREAD"
-				    "_STATE_IMPL flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    spu = (m88110_thread_state_impl_t *)state;
-			    if(state + sizeof(m88110_thread_state_impl_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "M88110_THREAD_STATE_IMPL in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_m88110_thread_state_impl_t(spu,
-							      host_byte_sex);
-			    state += sizeof(m88110_thread_state_impl_t);
-			    break;
-			default:
-			    if(swapped){
-				Mach_O_error(ofile, "malformed object (unknown "
-				    "flavor for flavor number %u in %s command"
-				    " %u can't byte swap it)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    state += count * sizeof(uint32_t);
-			    break;
-			}
-			nflavor++;
-		    }
-		    break;
-		}
-	    	if(cputype == CPU_TYPE_I860){
-#ifdef m68k
-		    struct i860_thread_state_regs *cpu;
-#endif
-
-		    nflavor = 0;
-		    p = (char *)ut + ut->cmdsize;
-		    while(state < p){
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (flavor in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			flavor = *((uint32_t *)state);
-			if(swapped){
-			    flavor = SWAP_INT(flavor);
-			    *((uint32_t *)state) = flavor;
-			}
-			state += sizeof(uint32_t);
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (count in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    return(CHECK_BAD);
-			}
-			count = *((uint32_t *)state);
-			if(swapped){
-			    count = SWAP_INT(count);
-			    *((uint32_t *)state) = count;
-			}
-			state += sizeof(uint32_t);
-			switch(flavor){
-			case I860_THREAD_STATE_REGS:
-#ifdef m68k
-			    if(count != I860_THREAD_STATE_REGS_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not I860_THREAD_STATE_REGS_COUNT for "
-				    "flavor number %u which is a I860_THREAD_"
-				    "STATE_REGS flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    cpu = (struct i860_thread_state_regs *)state;
-			    if(state + sizeof(struct i860_thread_state_regs) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "I860_THREAD_STATE_REGS in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_i860_thread_state_regs(cpu, host_byte_sex);
-			    state += sizeof(struct i860_thread_state_regs);
-#else
-			    state += count * sizeof(int);
-#endif
-			    break;
-			default:
-			    if(swapped){
-				Mach_O_error(ofile, "malformed object (unknown "
-				    "flavor for flavor number %u in %s command"
-				    " %u can't byte swap it)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    state += count * sizeof(uint32_t);
-			    break;
-			}
-			nflavor++;
-		    }
-		    break;
-		}
-	    	if(cputype == CPU_TYPE_I386){
-		    i386_thread_state_t *cpu;
-/* current i386 thread states */
-#if i386_THREAD_STATE == 1
-		    struct i386_float_state *fpu;
-		    i386_exception_state_t *exc;
-#endif /* i386_THREAD_STATE == 1 */
-
-/* i386 thread states on older releases */
-#if i386_THREAD_STATE == -1
-		    i386_thread_fpstate_t *fpu;
-		    i386_thread_exceptstate_t *exc;
-		    i386_thread_cthreadstate_t *user;
-#endif /* i386_THREAD_STATE == -1 */
-
-		    nflavor = 0;
-		    p = (char *)ut + ut->cmdsize;
-		    while(state < p){
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (flavor in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			flavor = *((uint32_t *)state);
-			if(swapped){
-			    flavor = SWAP_INT(flavor);
-			    *((uint32_t *)state) = flavor;
-			}
-			state += sizeof(uint32_t);
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (count in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			count = *((uint32_t *)state);
-			if(swapped){
-			    count = SWAP_INT(count);
-			    *((uint32_t *)state) = count;
-			}
-			state += sizeof(uint32_t);
-			switch((int)flavor){
-			case i386_THREAD_STATE:
-#if i386_THREAD_STATE == 1
-			case -1:
-#endif /* i386_THREAD_STATE == 1 */
-/* i386 thread states on older releases */
-#if i386_THREAD_STATE == -1
-			case 1:
-#endif /* i386_THREAD_STATE == -1 */
-			    if(count != i386_THREAD_STATE_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not i386_THREAD_STATE_COUNT for flavor "
-				    "number %u which is a i386_THREAD_STATE "
-				    "flavor in %s command %u)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    cpu = (i386_thread_state_t *)state;
-			    if(state + sizeof(i386_thread_state_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "i386_THREAD_STATE in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_i386_thread_state(cpu, host_byte_sex);
-			    state += sizeof(i386_thread_state_t);
-			    break;
-/* current i386 thread states */
-#if i386_THREAD_STATE == 1
-			case i386_FLOAT_STATE:
-			    if(count != i386_FLOAT_STATE_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not i386_FLOAT_STATE_COUNT for flavor "
-				    "number %u which is a i386_FLOAT_STATE "
-				    "flavor in %s command %u)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    fpu = (struct i386_float_state *)state;
-			    if(state + sizeof(struct i386_float_state) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "i386_FLOAT_STATE in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_i386_float_state(fpu, host_byte_sex);
-			    state += sizeof(struct i386_float_state);
-			    break;
-			case i386_EXCEPTION_STATE:
-			    if(count != I386_EXCEPTION_STATE_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not I386_EXCEPTION_STATE_COUNT for "
-				    "flavor number %u which is a i386_"
-				    "EXCEPTION_STATE flavor in %s command %u)",
-				    nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    exc = (i386_exception_state_t *)state;
-			    if(state + sizeof(i386_exception_state_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "i386_EXCEPTION_STATE in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_i386_exception_state(exc,host_byte_sex);
-			    state += sizeof(i386_exception_state_t);
-			    break;
-#endif /* i386_THREAD_STATE == 1 */
-
-/* i386 thread states on older releases */
-#if i386_THREAD_STATE == -1
-			case i386_THREAD_FPSTATE:
-			    if(count != i386_THREAD_FPSTATE_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not i386_THREAD_FPSTATE_COUNT for flavor "
-				    "number %u which is a i386_THREAD_FPSTATE "
-				    "flavor in %s command %u)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    fpu = (i386_thread_fpstate_t *)state;
-			    if(state + sizeof(i386_thread_fpstate_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "i386_THREAD_FPSTATE in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_i386_thread_fpstate(fpu, host_byte_sex);
-			    state += sizeof(i386_thread_fpstate_t);
-			    break;
-			case i386_THREAD_EXCEPTSTATE:
-			    if(count != i386_THREAD_EXCEPTSTATE_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not i386_THREAD_EXCEPTSTATE_COUNT for "
-				    "flavor number %u which is a i386_THREAD_"
-				    "EXCEPTSTATE flavor in %s command %u)",
-				    nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    exc = (i386_thread_exceptstate_t *)state;
-			    if(state + sizeof(i386_thread_exceptstate_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "i386_THREAD_EXCEPTSTATE in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_i386_thread_exceptstate(exc,host_byte_sex);
-			    state += sizeof(i386_thread_exceptstate_t);
-			    break;
-			case i386_THREAD_CTHREADSTATE:
-			    if(count != i386_THREAD_CTHREADSTATE_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not i386_THREAD_CTHREADSTATE_COUNT for "
-				    "flavor number %u which is a i386_THREAD_"
-				    "CTHREADSTATE flavor in %s command %u)",
-				    nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    user = (i386_thread_cthreadstate_t *)state;
-			    if(state + sizeof(i386_thread_cthreadstate_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "i386_THREAD_CTHREADSTATE in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_i386_thread_cthreadstate(user,
-							      host_byte_sex);
-			    state += sizeof(i386_thread_cthreadstate_t);
-			    break;
-#endif /* i386_THREAD_STATE == -1 */
-			default:
-			    if(swapped){
-				Mach_O_error(ofile, "malformed object (unknown "
-				    "flavor for flavor number %u in %s command"
-				    " %u can't byte swap it)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    state += count * sizeof(uint32_t);
-			    break;
-			}
-			nflavor++;
-		    }
-		    break;
-		}
-#ifdef x86_THREAD_STATE64_COUNT
-	    	if(cputype == CPU_TYPE_X86_64){
-		    x86_thread_state64_t *cpu;
-
-		    nflavor = 0;
-		    p = (char *)ut + ut->cmdsize;
-		    while(state < p){
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (flavor in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			flavor = *((uint32_t *)state);
-			if(swapped){
-			    flavor = SWAP_INT(flavor);
-			    *((uint32_t *)state) = flavor;
-			}
-			state += sizeof(uint32_t);
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (count in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			count = *((uint32_t *)state);
-			if(swapped){
-			    count = SWAP_INT(count);
-			    *((uint32_t *)state) = count;
-			}
-			state += sizeof(uint32_t);
-			switch(flavor){
-			case x86_THREAD_STATE64:
-			    if(count != x86_THREAD_STATE64_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not x86_THREAD_STATE64_COUNT for "
-				    "flavor number %u which is a x86_THREAD_"
-				    "STATE64 flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    cpu = (x86_thread_state64_t *)state;
-			    if(state + sizeof(x86_thread_state64_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "x86_THREAD_STATE64 in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_x86_thread_state64(cpu, host_byte_sex);
-			    state += sizeof(x86_thread_state64_t);
-			    break;
-			default:
-			    if(swapped){
-				Mach_O_error(ofile, "malformed object (unknown "
-				    "flavor for flavor number %u in %s command"
-				    " %u can't byte swap it)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    state += count * sizeof(uint32_t);
-			    break;
-			}
-			nflavor++;
-		    }
-		    break;
-		}
-#endif /* x86_THREAD_STATE64_COUNT */
-	    	if(cputype == CPU_TYPE_HPPA){
-		    struct hp_pa_integer_thread_state *cpu;
-		    struct hp_pa_frame_thread_state *frame;
-		    struct hp_pa_fp_thread_state *fpu;
-
-		    nflavor = 0;
-		    p = (char *)ut + ut->cmdsize;
-		    while(state < p){
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (flavor in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			flavor = *((uint32_t *)state);
-			if(swapped){
-			    flavor = SWAP_INT(flavor);
-			    *((uint32_t *)state) = flavor;
-			}
-			state += sizeof(uint32_t);
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (count in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			count = *((uint32_t *)state);
-			if(swapped){
-			    count = SWAP_INT(count);
-			    *((uint32_t *)state) = count;
-			}
-			state += sizeof(uint32_t);
-			switch(flavor){
-			case HPPA_INTEGER_THREAD_STATE:
-			    if(count != HPPA_INTEGER_THREAD_STATE_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not HPPA_INTEGER_THREAD_STATE_COUNT for "
-				    "flavor number %u which is a "
-				    "HPPA_INTEGER_THREAD_STATE "
-				    "flavor in %s command %u)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    cpu = (struct hp_pa_integer_thread_state *)state;
-			    if(state+sizeof(struct hp_pa_integer_thread_state) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "HPPA_INTEGER_THREAD_STATE in %s command "
-				    "%u extends past end of command)",
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_hppa_integer_thread_state(cpu,
-							       host_byte_sex);
-			    state += sizeof(struct hp_pa_integer_thread_state);
-			    break;
-			case HPPA_FRAME_THREAD_STATE:
-			    if(count != HPPA_FRAME_THREAD_STATE_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not HPPA_FRAME_THREAD_STATE_COUNT for "
-				    "flavor number %u which is a HPPA_FRAME_"
-				    "THREAD_STATE flavor in %s command %u)",
-				    nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    frame = (struct hp_pa_frame_thread_state *)state;
-			    if(state + sizeof(struct hp_pa_frame_thread_state) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "HPPA_FRAME_THREAD_STATE in %s command "
-				    "%u extends past end of command)",
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_hppa_frame_thread_state(frame,host_byte_sex);
-			    state += sizeof(struct hp_pa_frame_thread_state);
-			    break;
-			case HPPA_FP_THREAD_STATE:
-			    if(count != HPPA_FP_THREAD_STATE_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not HPPA_FP_THREAD_STATE_COUNT for "
-				    "flavor number %u which is a HPPA_FP_"
-				    "THREAD_STATE flavor in %s command %u)",
-				    nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    fpu = (struct hp_pa_fp_thread_state *)state;
-			    if(state + sizeof(struct hp_pa_fp_thread_state) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "HPPA_FP_THREAD_STATE in %s command "
-				    "%u extends past end of command)",
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_hppa_fp_thread_state(fpu,host_byte_sex);
-			    state += sizeof(struct hp_pa_fp_thread_state);
-			    break;
-			default:
-			    if(swapped){
-				Mach_O_error(ofile, "malformed object (unknown "
-				    "flavor for flavor number %u in %s command"
-				    " %u can't byte swap it)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    state += count * sizeof(uint32_t);
-			    break;
-			}
-			nflavor++;
-		    }
-		    break;
-		}
-	    	if(cputype == CPU_TYPE_SPARC){
-		    struct sparc_thread_state_regs *cpu;
-		    struct sparc_thread_state_fpu *fpu;
-
-		    nflavor = 0;
-		    p = (char *)ut + ut->cmdsize;
-		    while(state < p){
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (flavor in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			flavor = *((uint32_t *)state);
-			if(swapped){
-			    flavor = SWAP_INT(flavor);
-			    *((uint32_t *)state) = flavor;
-			}
-			state += sizeof(uint32_t);
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (count in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			count = *((uint32_t *)state);
-			if(swapped){
-			    count = SWAP_INT(count);
-			    *((uint32_t *)state) = count;
-			}
-			state += sizeof(uint32_t);
-			switch(flavor){
-			case SPARC_THREAD_STATE_REGS:
-			    if(count != SPARC_THREAD_STATE_REGS_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not SPARC_THREAD_STATE_REGS_COUNT for "
-				    "flavor number %u which is a SPARC_THREAD_"
-				    "STATE_REGS flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    cpu = (struct sparc_thread_state_regs *)state;
-			    if(state + sizeof(struct sparc_thread_state_regs) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "SPARC_THREAD_STATE_REGS in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_sparc_thread_state_regs(cpu, host_byte_sex);
-			    state += sizeof(struct sparc_thread_state_regs);
-			    break;
-			  case SPARC_THREAD_STATE_FPU:
-			    if(count != SPARC_THREAD_STATE_FPU_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not SPARC_THREAD_STATE_FPU_COUNT for "
-				    "flavor number %u which is a SPARC_THREAD_"
-				    "STATE_FPU flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    fpu = (struct sparc_thread_state_fpu *)state;
-			    if(state + sizeof(struct sparc_thread_state_fpu) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "SPARC_THREAD_STATE_FPU in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_sparc_thread_state_fpu(fpu, host_byte_sex);
-			    state += sizeof(struct sparc_thread_state_fpu);
-			    break;
-			default:
-			    if(swapped){
-				Mach_O_error(ofile, "malformed object (unknown "
-				    "flavor for flavor number %u in %s command"
-				    " %u can't byte swap it)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    state += count * sizeof(uint32_t);
-			    break;
-			}
-			nflavor++;
-		    }
-		    break;
-		}
-	    	if(cputype == CPU_TYPE_ARM){
-		    arm_thread_state_t *cpu;
-
-		    nflavor = 0;
-		    p = (char *)ut + ut->cmdsize;
-		    while(state < p){
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (flavor in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			flavor = *((uint32_t *)state);
-			if(swapped){
-			    flavor = SWAP_INT(flavor);
-			    *((uint32_t *)state) = flavor;
-			}
-			state += sizeof(uint32_t);
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (count in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			count = *((uint32_t *)state);
-			if(swapped){
-			    count = SWAP_INT(count);
-			    *((uint32_t *)state) = count;
-			}
-			state += sizeof(uint32_t);
-			switch(flavor){
-			case ARM_THREAD_STATE:
-			    if(count != ARM_THREAD_STATE_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not ARM_THREAD_STATE_COUNT for "
-				    "flavor number %u which is a ARM_THREAD_"
-				    "STATE flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    cpu = (arm_thread_state_t *)state;
-			    if(state + sizeof(arm_thread_state_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "ARM_THREAD_STATE in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_arm_thread_state_t(cpu, host_byte_sex);
-			    state += sizeof(arm_thread_state_t);
-			    break;
-			default:
-			    if(swapped){
-				Mach_O_error(ofile, "malformed object (unknown "
-				    "flavor for flavor number %u in %s command"
-				    " %u can't byte swap it)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    state += count * sizeof(uint32_t);
-			    break;
-			}
-			nflavor++;
-		    }
-		    break;
-		}
-	    	if(cputype == CPU_TYPE_ARM64){
-		    arm_thread_state64_t *cpu;
-
-		    nflavor = 0;
-		    p = (char *)ut + ut->cmdsize;
-		    while(state < p){
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (flavor in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			flavor = *((uint32_t *)state);
-			if(swapped){
-			    flavor = SWAP_INT(flavor);
-			    *((uint32_t *)state) = flavor;
-			}
-			state += sizeof(uint32_t);
-			if(state +  sizeof(uint32_t) >
-			   (char *)ut + ut->cmdsize){
-			    Mach_O_error(ofile, "malformed object (count in "
-				"%s command %u extends past end of command)",
-				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				"LC_THREAD", i);
-			    goto return_bad;
-			}
-			count = *((uint32_t *)state);
-			if(swapped){
-			    count = SWAP_INT(count);
-			    *((uint32_t *)state) = count;
-			}
-			state += sizeof(uint32_t);
-			switch(flavor){
-			case ARM_THREAD_STATE64:
-			    if(count != ARM_THREAD_STATE64_COUNT){
-				Mach_O_error(ofile, "malformed object (count "
-				    "not ARM_THREAD_STATE64_COUNT for "
-				    "flavor number %u which is a ARM_THREAD_"
-				    "STATE64 flavor in %s command %u)",
-				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
-				    "LC_UNIXTHREAD" : "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    cpu = (arm_thread_state64_t *)state;
-			    if(state + sizeof(arm_thread_state64_t) >
-			       (char *)ut + ut->cmdsize){
-				Mach_O_error(ofile, "malformed object ("
-				    "ARM_THREAD_STATE64 in %s command %u "
-				    "extends past end of command)", ut->cmd ==
-				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    if(swapped)
-				swap_arm_thread_state64_t(cpu, host_byte_sex);
-			    state += sizeof(arm_thread_state64_t);
-			    break;
-			default:
-			    if(swapped){
-				Mach_O_error(ofile, "malformed object (unknown "
-				    "flavor for flavor number %u in %s command"
-				    " %u can't byte swap it)", nflavor,
-				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
-				    "LC_THREAD", i);
-				goto return_bad;
-			    }
-			    state += count * sizeof(uint32_t);
-			    break;
-			}
-			nflavor++;
-		    }
-		    break;
-		}
-		if(swapped){
-		    Mach_O_error(ofile, "malformed object (unknown cputype and "
-			"cpusubtype of object and can't byte swap and check %s "
-			"command %u)", ut->cmd == LC_UNIXTHREAD ?
-			"LC_UNIXTHREAD" : "LC_THREAD", i);
-		    goto return_bad;
-		}
-		break;
-	    case LC_MAIN:
-		if(l.cmdsize < sizeof(struct entry_point_command)){
-		    Mach_O_error(ofile, "malformed object (LC_MAIN cmdsize "
-			         "too small) in command %u", i);
-		    goto return_bad;
-		}
-		ep = (struct entry_point_command *)lc;
-		if(swapped)
-		    swap_entry_point_command(ep, host_byte_sex);
-		/*
-		 * If we really wanted we could check that the entryoff field
-		 * really is an offset into the __TEXT segment.  But since it
-		 * is not used here, we won't needlessly check it.
-		 */
-		break;
-	    case LC_SOURCE_VERSION:
-		if(l.cmdsize < sizeof(struct source_version_command)){
-		    Mach_O_error(ofile, "malformed object (LC_SOURCE_VERSION "
-				 "cmdsize too small) in command %u", i);
-		    goto return_bad;
-		}
-		sv = (struct source_version_command *)lc;
-		if(swapped)
-		    swap_source_version_command(sv, host_byte_sex);
-	    case LC_IDENT:
-		if(l.cmdsize < sizeof(struct ident_command)){
-		    Mach_O_error(ofile, "malformed object (LC_IDENT cmdsize "
-			         "too small) in command %u", i);
-		    goto return_bad;
-		}
-		id = (struct ident_command *)lc;
-		if(swapped)
-		    swap_ident_command(id, host_byte_sex);
-		/*
-		 * Note the cmdsize field if the LC_IDENT command was checked
-		 * as part of checking all load commands cmdsize field before
-		 * the switch statement on the cmd field of the load command.
-		 */
-		break;
-	    case LC_RPATH:
-		if(l.cmdsize < sizeof(struct rpath_command)){
-		    Mach_O_error(ofile, "malformed object (LC_RPATH: cmdsize "
-			         "too small) in command %u", i);
-		    goto return_bad;
-		}
-		rpath = (struct rpath_command *)lc;
-		if(swapped)
-		    swap_rpath_command(rpath, host_byte_sex);
-		if(rpath->cmdsize < sizeof(struct rpath_command)){
-		    Mach_O_error(ofile, "malformed object (LC_RPATH command "
-			"%u has too small cmdsize field)", i);
-		    goto return_bad;
-		}
-		if(rpath->path.offset >= rpath->cmdsize){
-		    Mach_O_error(ofile, "truncated or malformed object (path."
-			"offset field of LC_RPATH command %u extends past the "
-			"end of the file)", i);
-		    goto return_bad;
-		}
-		break;
-
-#ifndef OFI
-	    default:
-		Mach_O_error(ofile, "malformed object (unknown load command "
-			     "%u)", i);
-		goto return_bad;
-#endif /* !defined(OFI) */
-	    }
-
-	    lc = (struct load_command *)((char *)lc + l.cmdsize);
-	    /* check that next load command does not extends past the end */
-	    if((char *)lc > (char *)load_commands + sizeofcmds){
-		Mach_O_error(ofile, "truncated or malformed object (load "
-			     "command %u extends past the end of the file)",
-			     i + 1);
-		goto return_bad;
-	    }
-	}
-	if(st == NULL){
-	    if(dyst != NULL){
-		Mach_O_error(ofile, "truncated or malformed object (contains "
-		  "LC_DYSYMTAB load command without a LC_SYMTAB load command)");
-		goto return_bad;
-	    }
-	}
-	else{
-	    if(dyst != NULL){
-		if(dyst->nlocalsym != 0 &&
-		   dyst->ilocalsym > st->nsyms){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(ilocalsym in LC_DYSYMTAB load command extends past "
-			"the end of the symbol table)");
-		    goto return_bad;
-		}
-		big_size = dyst->ilocalsym;
-		big_size += dyst->nlocalsym;
-		if(dyst->nlocalsym != 0 && big_size > st->nsyms){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(ilocalsym plus nlocalsym in LC_DYSYMTAB load command "
-			"extends past the end of the symbol table)");
-		    goto return_bad;
-		}
-
-		if(dyst->nextdefsym != 0 &&
-		   dyst->iextdefsym > st->nsyms){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(iextdefsym in LC_DYSYMTAB load command extends past "
-			"the end of the symbol table)");
-		    goto return_bad;
-		}
-		big_size = dyst->iextdefsym;
-		big_size += dyst->nextdefsym;
-		if(dyst->nextdefsym != 0 && big_size > st->nsyms){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(iextdefsym plus nextdefsym in LC_DYSYMTAB load "
-			"command extends past the end of the symbol table)");
-		    goto return_bad;
-		}
-
-		if(dyst->nundefsym != 0 &&
-		   dyst->iundefsym > st->nsyms){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(iundefsym in LC_DYSYMTAB load command extends past "
-			"the end of the symbol table)");
-		    goto return_bad;
-		}
-		big_size = dyst->iundefsym;
-		big_size += dyst->nundefsym;
-		if(dyst->nundefsym != 0 && big_size > st->nsyms){
-		    Mach_O_error(ofile, "truncated or malformed object "
-			"(iundefsym plus nundefsym in LC_DYSYMTAB load command "
-			"extends past the end of the symbol table)");
-		    goto return_bad;
-		}
-		if(rc != NULL){
-		    if(rc->init_module > dyst->nmodtab){
-			Mach_O_error(ofile, "malformed object (init_module in "
-			    "LC_ROUTINES load command extends past the "
-			    "end of the module table)");
-			goto return_bad;
-		    }
-		}
-		if(rc64 != NULL){
-		    if(rc64->init_module > dyst->nmodtab){
-			Mach_O_error(ofile, "malformed object (init_module in "
-			    "LC_ROUTINES_64 load command extends past the "
-			    "end of the module table)");
-			goto return_bad;
-		    }
-		}
-		if(hints != NULL){
-		    if(hints->nhints != dyst->nundefsym){
-			Mach_O_error(ofile, "malformed object (nhints in "
-			    "LC_TWOLEVEL_HINTS load command not the same as "
-			    "nundefsym in LC_DYSYMTAB load command)");
-			goto return_bad;
-		    }
-		}
-	    }
-	}
-	/* check for an inconsistent size of the load commands */
-	if((char *)load_commands + sizeofcmds != (char *)lc){
-	    Mach_O_error(ofile, "malformed object (inconsistent sizeofcmds "
-			 "field in mach header)");
-	    goto return_bad;
-	}
-
-	/*
-	 * Mark this ofile so we know its headers have been swapped.  We do this
-	 * in case we don't process it the first time so we can swap them back
-	 * in case we loop back to it in a fat file to process it later.
-	 */
-	if(swapped == TRUE)
-	    ofile->headers_swapped = TRUE;
-
-	/* looks good return ok */
-	free_elements(&elements);
-	return(CHECK_GOOD);
-
-return_bad:
-	free_elements(&elements);
-	return(CHECK_BAD);
-#endif /* OTOOL */
-}
-
-/*
- * swap_back_Mach_O() is called after the ofile has been processed to swap back
- * the mach header and load commands if check_Mach_O() above swapped them.
- */
-static
-void
-swap_back_Mach_O(
-struct ofile *ofile)
-{
-	if(ofile->headers_swapped == TRUE){
-	    ofile->headers_swapped = FALSE;
-	    if(ofile->mh != NULL)
-		swap_object_headers(ofile->mh, ofile->load_commands);
-	    else if(ofile->mh64 != NULL)
-		swap_object_headers(ofile->mh64, ofile->load_commands);
-	}
-}
-
-#ifndef OTOOL
-/*
- * check_overlaping_element() checks that the element in the ofile described by
- * offset, size and name does not overlap in list of elements in head.  If it
- * does CHECK_BAD is returned and an error message is generated.  If it doesn't
- * then an element is added in the ordered list and CHECK_GOOD is returned
- */
-static
-enum check_type
-check_overlaping_element(
-struct ofile *ofile,
-struct element *head,
-uint32_t offset,
-uint32_t size,
-char *name)
-{
-    struct element *e, *p, *n;
-
-	if(size == 0)
-	    return(CHECK_GOOD);
-
-	if(head->next == NULL){
-	    n = allocate(sizeof(struct element));
-	    n->offset = offset;
-	    n->size = size;
-	    n->name = name;
-	    n->next = NULL;
-	    head->next = n;
-	    return(CHECK_GOOD);
-	}
-
-	p = NULL;
-	e = head;
-	while(e->next != NULL){
-	    p = e;
-	    e = e->next;
-	    if((offset >= e->offset &&
-		offset < e->offset + e->size) ||
-	       (offset + size > e->offset &&
-		offset + size < e->offset + e->size) ||
-	       (offset <= e->offset &&
-		offset + size >= e->offset + e->size)){
-		Mach_O_error(ofile, "malformed object (%s at offset %u with a "
-		    "size of %u, overlaps %s at offset %u with a size of %u)",
-		    name, offset, size, e->name, e->offset, e->size);
-		return(CHECK_BAD);
-	    }
-	    if(e->next != NULL && offset + size <= e->next->offset){
-		n = allocate(sizeof(struct element));
-		n->offset = offset;
-		n->size = size;
-		n->name = name;
-		n->next = e;
-		p->next = n;
-		return(CHECK_GOOD);
-	    }
-	}
-	n = allocate(sizeof(struct element));
-	n->offset = offset;
-	n->size = size;
-	n->name = name;
-	n->next = NULL;
-	e->next = n;
-	return(CHECK_GOOD);
-}
-
-/*
- * free_elements() frees the list of elements on the list head.
- */
-static
-void
-free_elements(
-struct element *head)
-{
-    struct element *e, *e_next;
-
-	e = head->next;
-	while(e != NULL){
-	    e_next = e->next;
-	    free(e);
-	    e = e_next;
-	}
-}
-#endif /* !defined(OTOOL) */
-
-/*
- * check_dylib_module() checks the object file's dylib_module as referenced
- * by the dylib_module field in the ofile for correctness.
- */
-static
-enum check_type
-check_dylib_module(
-struct ofile *ofile,
-struct symtab_command *st,
-struct dysymtab_command *dyst,
-char *strings,
-uint32_t module_index)
-{
-#ifdef OTOOL
-	return(CHECK_GOOD);
-#else /* !defined OTOOL */
-    uint32_t i;
-    enum byte_sex host_byte_sex;
-    enum bool swapped;
-    struct dylib_module m;
-    struct dylib_module_64 m64;
-    uint32_t module_name, nextdefsym, iextdefsym, nlocalsym, ilocalsym, nrefsym;
-    uint32_t irefsym, nextrel, iextrel;
-
-	host_byte_sex = get_host_byte_sex();
-	swapped = (enum bool)(host_byte_sex != ofile->object_byte_sex);
-	if(ofile->mh != NULL){
-	    m = *ofile->dylib_module;
-	    if(swapped)
-		swap_dylib_module(&m, 1, host_byte_sex);
-	    module_name = m.module_name;
-	    nextdefsym = m.nextdefsym;
-	    iextdefsym = m.iextdefsym;
-	    nlocalsym = m.nlocalsym;
-	    ilocalsym = m.ilocalsym;
-	    nrefsym = m.nrefsym;
-	    irefsym = m.irefsym;
-	    nextrel = m.nextrel;
-	    iextrel = m.iextrel;
-	}
-	else{
-	    m64 = *ofile->dylib_module64;
-	    if(swapped)
-		swap_dylib_module_64(&m64, 1, host_byte_sex);
-	    module_name = m64.module_name;
-	    nextdefsym = m64.nextdefsym;
-	    iextdefsym = m64.iextdefsym;
-	    nlocalsym = m64.nlocalsym;
-	    ilocalsym = m64.ilocalsym;
-	    nrefsym = m64.nrefsym;
-	    irefsym = m64.irefsym;
-	    nextrel = m64.nextrel;
-	    iextrel = m64.iextrel;
-	}
-
-	if(module_name > st->strsize){
-	    Mach_O_error(ofile, "truncated or malformed object (module_name "
-		"of module table entry %u past the end of the string table)",
-		module_index);
-	    return(CHECK_BAD);
-	}
-	for(i = module_name; i < st->strsize && strings[i] != '\0'; i++)
-		;
-	if(i >= st->strsize){
-	    Mach_O_error(ofile, "truncated or malformed object (module_name "
-		"of module table entry %u extends past the end of the string "
-		"table)", module_index);
-	    return(CHECK_BAD);
-	}
-
-	if(nextdefsym != 0){
-	    if(iextdefsym > st->nsyms){
-		Mach_O_error(ofile, "truncated or malformed object (iextdefsym "
-		    "field of module table entry %u past the end of the "
-		    "symbol table", module_index);
-		return(CHECK_BAD);
-	    }
-	    if(iextdefsym + nextdefsym > st->nsyms){
-		Mach_O_error(ofile, "truncated or malformed object (iextdefsym "
-		    "field of module table entry %u plus nextdefsym field "
-		    "extends past the end of the symbol table", module_index);
-		return(CHECK_BAD);
-	    }
-	}
-	if(nlocalsym != 0){
-	    if(ilocalsym > st->nsyms){
-		Mach_O_error(ofile, "truncated or malformed object (ilocalsym "
-		    "field of module table entry %u past the end of the "
-		    "symbol table", module_index);
-		return(CHECK_BAD);
-	    }
-	    if(ilocalsym + nlocalsym > st->nsyms){
-		Mach_O_error(ofile, "truncated or malformed object (ilocalsym "
-		    "field of module table entry %u plus nlocalsym field "
-		    "extends past the end of the symbol table", module_index);
-		return(CHECK_BAD);
-	    }
-	}
-	if(nrefsym != 0){
-	    if(irefsym > dyst->nextrefsyms){
-		Mach_O_error(ofile, "truncated or malformed object (irefsym "
-		    "field of module table entry %u past the end of the "
-		    "reference table", module_index);
-		return(CHECK_BAD);
-	    }
-	    if(irefsym + nrefsym > dyst->nextrefsyms){
-		Mach_O_error(ofile, "truncated or malformed object (irefsym "
-		    "field of module table entry %u plus nrefsym field "
-		    "extends past the end of the reference table",module_index);
-		return(CHECK_BAD);
-	    }
-	}
-	if(nextrel != 0){
-	    if(iextrel > dyst->extreloff){
-		Mach_O_error(ofile, "truncated or malformed object (iextrel "
-		    "field of module table entry %u past the end of the "
-		    "external relocation enrties", module_index);
-		return(CHECK_BAD);
-	    }
-	    if(iextrel + nextrel > dyst->extreloff){
-		Mach_O_error(ofile, "truncated or malformed object (iextrel "
-		    "field of module table entry %u plus nextrel field "
-		    "extends past the end of the external relocation enrties",
-		    module_index);
-		return(CHECK_BAD);
-	    }
-	}
-	return(CHECK_GOOD);
-#endif /* OTOOL */
-}
-
-__private_extern__
-uint32_t
-size_ar_name(
-const struct ar_hdr *ar_hdr)
-{
-    int32_t i;
-
-	i = sizeof(ar_hdr->ar_name) - 1;
-	if(ar_hdr->ar_name[i] == ' '){
-	    do{
-		if(ar_hdr->ar_name[i] != ' ')
-		    break;
-		i--;
-	    }while(i > 0);
-	}
-	return(i + 1);
-}
-#endif /* !defined(RLD) */
+/*
+ * Copyright  2009 Apple Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions are met:
+ * 
+ * 1.  Redistributions of source code must retain the above copyright notice,
+ * this list of conditions and the following disclaimer. 
+ * 2.  Redistributions in binary form must reproduce the above copyright notice,
+ * this list of conditions and the following disclaimer in the documentation
+ * and/or other materials provided with the distribution. 
+ * 3.  Neither the name of Apple Inc. ("Apple") nor the names of its
+ * contributors may be used to endorse or promote products derived from this
+ * software without specific prior written permission. 
+ * 
+ * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND ANY
+ * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+ * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
+ * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
+ * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ *
+ * @APPLE_LICENSE_HEADER_END@
+ */
+#define __darwin_i386_exception_state i386_exception_state
+#define __darwin_i386_float_state i386_float_state
+#define __darwin_i386_thread_state i386_thread_state
+
+#ifndef RLD
+#ifdef SHLIB
+#include "shlib.h"
+#endif
+#include <libc.h>
+#include <mach/mach.h>
+#include "stuff/openstep_mach.h"
+#include <stddef.h>
+#include <stdarg.h>
+#include <limits.h>
+#include <errno.h>
+#include <ctype.h>
+#include <stdlib.h>
+#include <ar.h>
+#include <sys/file.h>
+#include <sys/types.h>
+#include <sys/mman.h>
+#include <mach-o/fat.h>
+#include <mach-o/loader.h>
+#import <mach/m68k/thread_status.h>
+#import <mach/ppc/thread_status.h>
+#undef MACHINE_THREAD_STATE     /* need to undef these to avoid warnings */
+#undef MACHINE_THREAD_STATE_COUNT
+#undef THREAD_STATE_NONE
+#undef VALID_THREAD_STATE_FLAVOR
+#import <mach/m88k/thread_status.h>
+#import <mach/i860/thread_status.h>
+#import <mach/i386/thread_status.h>
+#import <mach/sparc/thread_status.h>
+#import <mach/arm/thread_status.h>
+#include <mach-o/nlist.h>
+#include <mach-o/reloc.h>
+#include "stuff/bool.h"
+#ifdef OFI
+#include <mach-o/dyld.h>
+#else
+#include "stuff/lto.h"
+#endif
+#include "stuff/bytesex.h"
+#include "stuff/arch.h"
+#include "stuff/rnd.h"
+#include "stuff/errors.h"
+#include "stuff/allocate.h"
+#include "stuff/ofile.h"
+#include "stuff/print.h"
+
+#ifdef OTOOL
+#undef ALIGNMENT_CHECKS
+#include "otool.h"
+#include "dyld_bind_info.h"
+#include "ofile_print.h"
+static enum bool otool_first_ofile_map = TRUE;
+#else /* !define(OTOOL) */
+
+#if (!defined(m68k) && !defined(__i386__) && !defined(__x86_64__) && !defined(__ppc__) && !defined(__arm__))
+#define ALIGNMENT_CHECKS_ARCHIVE_64_BIT
+static enum bool archive_64_bit_align_warning = FALSE;
+#endif /* (!defined(m68k) && !defined(__i386__) && !defined(__x86_64__) && !defined(__ppc__) && !defined(__arm__)) */
+
+#endif /* OTOOL */
+
+/* <mach/loader.h> */
+/* The maximum section alignment allowed to be specified, as a power of two */
+#define MAXSECTALIGN		15 /* 2**15 or 0x8000 */
+
+enum check_type {
+    CHECK_BAD,
+    CHECK_GOOD
+};
+
+#ifndef OTOOL
+struct element {
+    uint32_t offset;
+    uint32_t size;
+    char *name;
+    struct element *next;
+};
+#endif /* !defined(OTOOL) */
+
+static enum bool ofile_specific_arch(
+    struct ofile *ofile,
+    uint32_t narch);
+static enum check_type check_fat(
+    struct ofile *ofile);
+static enum check_type check_fat_object_in_archive(
+    struct ofile *ofile);
+static enum check_type check_archive(
+    struct ofile *ofile,
+    enum bool archives_with_fat_objects);
+static enum check_type check_extend_format_1(
+    struct ofile *ofile,
+    struct ar_hdr *ar_hdr,
+    uint32_t size_left,
+    uint32_t *member_name_size);
+static enum check_type check_archive_toc(
+    struct ofile *ofile);
+static enum check_type check_Mach_O(
+    struct ofile *ofile);
+static void swap_back_Mach_O(
+    struct ofile *ofile);
+#ifndef OTOOL
+static enum check_type check_overlaping_element(
+    struct ofile *ofile,
+    struct element *head,
+    uint32_t offset,
+    uint32_t size,
+    char *name);
+static void free_elements(
+    struct element *head);
+#endif /* !defined(OTOOL) */
+static enum check_type check_dylib_module(
+    struct ofile *ofile,
+    struct symtab_command *st,
+    struct dysymtab_command *dyst,
+    char *strings,
+    uint32_t module_index);
+
+#ifndef OTOOL
+#if defined(ALIGNMENT_CHECKS) || defined(ALIGNMENT_CHECKS_ARCHIVE_64_BIT)
+static
+void
+temporary_archive_member_warning(
+struct ofile *ofile,
+const char *format, ...)
+{
+    va_list ap;
+
+	va_start(ap, format);
+	if(ofile->file_type == OFILE_FAT){
+	    print("%s: for architecture %s archive member: %s(%.*s) ",
+		  progname, ofile->arch_flag.name, ofile->file_name,
+		  (int)ofile->member_name_size, ofile->member_name);
+	}
+	else{
+	    print("%s: archive member: %s(%.*s) ", progname, ofile->file_name,
+		  (int)ofile->member_name_size, ofile->member_name);
+	}
+	vprint(format, ap);
+        print("\n");
+	va_end(ap);
+}
+#endif /* defined(ALIGNMENT_CHECKS) */
+#endif /* !defined(OTOOL) */
+
+#ifndef OFI
+/*
+ * ofile_process() processes the specified file name can calls the routine
+ * processor on the ofiles in it.  arch_flags is an array of architectures
+ * containing narch_flags which are the only architectures to process if
+ * narch_flags is non-zero.  If all_archs is TRUE then all architectures of
+ * the specified file are processed.  The specified file name can be of the
+ * form "archive(member)" which is taken to mean that member in that archive
+ * (or that module of a dynamic library if dylib_flat is not FALSE).
+ * For each ofile that is to be processed the routine processor is called with
+ * the corresponding ofile struct, the arch_name pass to it is either NULL or
+ * an architecture name (when it should be printed or show by processor) and
+ * cookie is the same value as passed to ofile_process.
+ */
+__private_extern__
+void
+ofile_process(
+char *name,
+struct arch_flag *arch_flags,
+uint32_t narch_flags,
+enum bool all_archs,
+enum bool process_non_objects,
+enum bool dylib_flat,
+enum bool use_member_syntax,
+void (*processor)(struct ofile *ofile, char *arch_name, void *cookie),
+void *cookie
+#ifdef OTOOL_NG_SUPPORT
+, uint64_t start_offset)
+#else
+)
+#endif
+{
+    char *member_name, *p, *arch_name;
+    uint32_t len, i;
+    struct ofile ofile;
+    enum bool flag, hostflag, arch_found, family;
+    struct arch_flag host_arch_flag, specific_arch_flag;
+    const struct arch_flag *family_arch_flag;
+
+	/*
+	 * If use_member_syntax is TRUE look for a name of the form
+	 * "archive(member)" which is to mean a member in that archive (the
+	 * member name must be at least one character long to be recognized as
+	 * this form).
+	 */
+	member_name = NULL;
+	if(use_member_syntax == TRUE){
+	    len = strlen(name);
+	    if(len >= 4 && name[len-1] == ')'){
+		p = strrchr(name, '(');
+		if(p != NULL && p != name){
+		    member_name = p+1;
+		    *p = '\0';
+		    name[len-1] = '\0';
+		}
+	    }
+	}
+
+#ifdef OTOOL
+	otool_first_ofile_map = TRUE;
+#endif /* OTOOL */
+#ifdef OTOOL_NG_SUPPORT	
+	if(ofile_map(name, NULL, NULL, &ofile, FALSE, start_offset) == FALSE)
+		return;
+#else
+	if(ofile_map(name, NULL, NULL, &ofile, FALSE) == FALSE)
+		return;
+#endif		
+	    
+#ifdef OTOOL
+	otool_first_ofile_map = FALSE;
+#endif /* OTOOL */
+
+	if(ofile.file_type == OFILE_FAT){
+	    /*
+	     * This is a fat file so see if a list of architecture is
+	     * specified and process only those.
+	     */
+	    if(all_archs == FALSE && narch_flags != 0){
+		for(i = 0; i < narch_flags; i++){
+		    if(ofile_first_arch(&ofile) == FALSE){
+			ofile_unmap(&ofile);
+			return;
+		    }
+		    arch_found = FALSE;
+		    family = FALSE;
+		    family_arch_flag =
+			get_arch_family_from_cputype(arch_flags[i].cputype);
+		    if(family_arch_flag != NULL)
+			family = (enum bool)
+			  ((family_arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) ==
+			   (arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK));
+		    if(narch_flags != 1)
+			arch_name = ofile.arch_flag.name;
+		    else
+			arch_name = NULL;
+		    do{
+			if(ofile.arch_flag.cputype ==
+				arch_flags[i].cputype &&
+			   ((ofile.arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK) ==
+			    (arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK) ||
+			    family == TRUE)){
+			    arch_found = TRUE;
+			    if(ofile.arch_type == OFILE_ARCHIVE){
+				if(member_name != NULL){
+				    if(ofile_specific_member(member_name,
+							     &ofile) == TRUE){
+					processor(&ofile, arch_name, cookie);
+					if(ofile.headers_swapped == TRUE)
+					    swap_back_Mach_O(&ofile);
+				    }
+				}
+				else{
+				    /* loop through archive */
+#ifdef OTOOL
+				    printf("Archive : %s", ofile.file_name);
+				    if(arch_name != NULL)
+					printf(" (architecture %s)",
+					       arch_name);
+				    printf("\n");
+#endif /* OTOOL */
+				    if(ofile_first_member(&ofile) == TRUE){
+					flag = FALSE;
+					do{
+					    if(process_non_objects == TRUE ||
+					       ofile.member_type ==
+								OFILE_Mach_O){
+						processor(&ofile, arch_name,
+							  cookie);
+						if(ofile.headers_swapped ==TRUE)
+						    swap_back_Mach_O(&ofile);
+						flag = TRUE;
+					    }
+					}while(ofile_next_member(&ofile) ==
+						TRUE);
+					if(flag == FALSE){
+					    error("for architecture: %s "
+						  "archive: %s contains no "
+						  "members that are object "
+						  "files", ofile.arch_flag.name,
+						  ofile.file_name);
+					}
+				    }
+				    else{
+					error("for architecture: %s archive: "
+					      "%s contains no members",
+					      ofile.arch_flag.name,
+					      ofile.file_name);
+				    }
+				}
+			    }
+			    else if(process_non_objects == TRUE ||
+				    ofile.arch_type == OFILE_Mach_O){
+				if(ofile.arch_type == OFILE_Mach_O &&
+				   (ofile.mh_filetype == MH_DYLIB ||
+				    ofile.mh_filetype == MH_DYLIB_STUB)){
+				    if(dylib_flat == TRUE){
+					processor(&ofile, arch_name, cookie);
+					if(ofile.headers_swapped == TRUE)
+					    swap_back_Mach_O(&ofile);
+				    }
+				    else{
+					if(member_name != NULL){
+					    if(ofile_specific_module(
+						member_name, &ofile) == TRUE){
+						processor(&ofile, arch_name,
+							  cookie);
+						if(ofile.headers_swapped ==TRUE)
+						    swap_back_Mach_O(&ofile);
+					    }
+					}
+					else{
+					    /*loop through the dynamic library*/
+					    if(ofile_first_module(&ofile)){
+						do{
+						    processor(&ofile, arch_name,
+							cookie);
+						}while(ofile_next_module(
+							&ofile));
+					    }
+					    else{
+						processor(&ofile, arch_name,
+							  cookie);
+					    }
+					}
+				    }
+				    if(ofile.headers_swapped == TRUE)
+					swap_back_Mach_O(&ofile);
+				}
+				else{
+				    if(member_name != NULL)
+					error("for architecture: %s file: %s "
+					      "is not an archive and thus does "
+					      "not contain member: %s",
+					      ofile.arch_flag.name,
+					      ofile.file_name,
+					      member_name);
+				    else{
+					processor(&ofile, arch_name, cookie);
+					if(ofile.headers_swapped == TRUE)
+					    swap_back_Mach_O(&ofile);
+				     }
+				}
+			    }
+			    else if(ofile.arch_type == OFILE_UNKNOWN){
+				error("for architecture: %s file: %s is "
+				      "not an object file",
+				      ofile.arch_flag.name,ofile.file_name);
+			    }
+			    if(ofile.headers_swapped == TRUE)
+				swap_back_Mach_O(&ofile);
+			    break;
+			}
+			else{
+			    if(ofile.headers_swapped == TRUE)
+				swap_back_Mach_O(&ofile);
+			}
+		    }while(ofile_next_arch(&ofile) == TRUE);
+		    if(arch_found == FALSE)
+			error("file: %s does not contain architecture: %s",
+			      ofile.file_name, arch_flags[i].name);
+		}
+		ofile_unmap(&ofile);
+		return;
+	    }
+
+	    /*
+	     * This is a fat file and no architectures has been specified
+	     * so if it contains the host architecture process only that
+	     * architecture but if not process all architectures
+	     * specified.
+	     */
+	    if(all_archs == FALSE){
+		(void)get_arch_from_host(&host_arch_flag, &specific_arch_flag);
+#if __LP64__
+		/*
+		 * If runing as a 64-bit binary and on an Intel x86 host
+		 * default to 64-bit.
+		 */
+		if(host_arch_flag.cputype == CPU_TYPE_I386)
+		    host_arch_flag =
+			*get_arch_family_from_cputype(CPU_TYPE_X86_64);
+#endif /* __LP64__ */
+		hostflag = FALSE;
+
+		family = FALSE;
+		family_arch_flag =
+		    get_arch_family_from_cputype(host_arch_flag.cputype);
+#ifndef __arm__
+		if(family_arch_flag != NULL)
+		    family = (enum bool)
+			((family_arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) ==
+			 (host_arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK));
+#endif /* __arm__ */
+
+		ofile_unmap(&ofile);
+#ifdef OTOOL_NG_SUPPORT		
+		if(ofile_map(name, NULL, NULL, &ofile, FALSE, start_offset) == FALSE)
+		    return;
+#else
+		if(ofile_map(name, NULL, NULL, &ofile, FALSE) == FALSE)
+		    return;
+#endif		
+		if(ofile_first_arch(&ofile) == FALSE){
+		    ofile_unmap(&ofile);
+		    return;
+		}
+		do{
+		    if(ofile.arch_flag.cputype ==
+			    host_arch_flag.cputype &&
+		       ((ofile.arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK) ==
+#ifdef __arm__
+			(specific_arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK) ||
+#else
+			(host_arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK) ||
+#endif /* __arm__ */
+			family == TRUE)){
+			hostflag = TRUE;
+			if(ofile.arch_type == OFILE_ARCHIVE){
+			    if(member_name != NULL){
+				if(ofile_specific_member(member_name,
+							 &ofile) == TRUE){
+				    processor(&ofile, NULL, cookie);
+				    if(ofile.headers_swapped == TRUE)
+					swap_back_Mach_O(&ofile);
+				}
+			    }
+			    else{
+				/* loop through archive */
+#ifdef OTOOL
+				printf("Archive : %s\n", ofile.file_name);
+#endif /* OTOOL */
+				if(ofile_first_member(&ofile) == TRUE){
+				    flag = FALSE;
+				    do{
+					if(process_non_objects == TRUE ||
+				           ofile.member_type == OFILE_Mach_O){
+					    processor(&ofile, NULL, cookie);
+					    if(ofile.headers_swapped == TRUE)
+						swap_back_Mach_O(&ofile);
+					    flag = TRUE;
+					}
+				    }while(ofile_next_member(&ofile) ==
+					   TRUE);
+				    if(flag == FALSE){
+					error("archive: %s contains no "
+					      "members that are object "
+					      "files", ofile.file_name);
+				    }
+				}
+				else{
+				    error("archive: %s contains no "
+					  "members", ofile.file_name);
+				}
+			    }
+			}
+			else if(process_non_objects == TRUE ||
+				ofile.arch_type == OFILE_Mach_O){
+			    if(ofile.arch_type == OFILE_Mach_O &&
+			       (ofile.mh_filetype == MH_DYLIB ||
+				ofile.mh_filetype == MH_DYLIB_STUB)){
+				if(dylib_flat == TRUE){
+				    processor(&ofile, NULL, cookie);
+				}
+				else{
+				    if(member_name != NULL){
+					if(ofile_specific_module(member_name,
+						&ofile) == TRUE)
+					    processor(&ofile, NULL, cookie);
+				    }
+				    else{
+					/* loop through the dynamic library */
+					if(ofile_first_module(&ofile) == TRUE){
+					    do{
+						processor(&ofile, NULL, cookie);
+					    }while(ofile_next_module(&ofile));
+					}
+					else{
+					    processor(&ofile, NULL, cookie);
+					}
+				    }
+				}
+				if(ofile.headers_swapped == TRUE)
+				    swap_back_Mach_O(&ofile);
+			    }
+			    else{
+				if(member_name != NULL)
+				    error("for architecture: %s file: %s is "
+					  "not an archive and thus does not "
+					  "contain member: %s",
+					  ofile.arch_flag.name, ofile.file_name,
+					  member_name);
+				else{
+				    processor(&ofile, NULL, cookie);
+				    if(ofile.headers_swapped == TRUE)
+					swap_back_Mach_O(&ofile);
+				}
+			    }
+			}
+			else if(ofile.arch_type == OFILE_UNKNOWN){
+			    error("file: %s is not an object file",
+				  ofile.file_name);
+			}
+		    }
+		    else{
+			if(ofile.headers_swapped == TRUE)
+			    swap_back_Mach_O(&ofile);
+		    }
+		}while(hostflag == FALSE && ofile_next_arch(&ofile) == TRUE);
+		if(hostflag == TRUE){
+		    ofile_unmap(&ofile);
+		    return;
+		}
+	    }
+
+	    /*
+	     * Either all architectures have been specified or none have
+	     * been specified and it does not contain the host architecture
+	     * so do all the architectures in the fat file
+	     */
+	    ofile_unmap(&ofile);
+#ifdef OTOOL_NG_SUPPORT	    
+	    if(ofile_map(name, NULL, NULL, &ofile, FALSE, start_offset) == FALSE)
+		return;
+#else
+	    if(ofile_map(name, NULL, NULL, &ofile, FALSE) == FALSE)
+		return;
+#endif	
+	    if(ofile_first_arch(&ofile) == FALSE){
+		ofile_unmap(&ofile);
+		return;
+	    }
+	    do{
+		if(ofile.arch_type == OFILE_ARCHIVE){
+		    if(member_name != NULL){
+			if(ofile_specific_member(member_name, &ofile) == TRUE)
+			    processor(&ofile, ofile.arch_flag.name, cookie);
+		    }
+		    else{
+			/* loop through archive */
+#ifdef OTOOL
+			printf("Archive : %s (architecture %s)\n",
+			       ofile.file_name, ofile.arch_flag.name);
+#endif /* OTOOL */
+			if(ofile_first_member(&ofile) == TRUE){
+			    flag = FALSE;
+			    do{
+				if(process_non_objects == TRUE ||
+				   ofile.member_type == OFILE_Mach_O){
+				    processor(&ofile, ofile.arch_flag.name,
+					      cookie);
+				    flag = TRUE;
+				}
+			    }while(ofile_next_member(&ofile) == TRUE);
+			    if(flag == FALSE){
+				error("for architecture: %s archive: %s "
+				      "contains no members that are object "
+				      "files", ofile.arch_flag.name,
+				      ofile.file_name);
+			    }
+			}
+			else{
+			    error("for architecture: %s archive: %s "
+				  "contains no members",
+				  ofile.arch_flag.name, ofile.file_name);
+			}
+		    }
+		}
+		else if(process_non_objects == TRUE ||
+			ofile.arch_type == OFILE_Mach_O){
+		    if(ofile.arch_type == OFILE_Mach_O &&
+		       (ofile.mh_filetype == MH_DYLIB ||
+			ofile.mh_filetype == MH_DYLIB_STUB)){
+			if(dylib_flat == TRUE){
+			    processor(&ofile, ofile.arch_flag.name, cookie);
+			}
+			else{
+			    if(member_name != NULL){
+				if(ofile_specific_module(member_name, &ofile)
+				   == TRUE)
+				    processor(&ofile, ofile.arch_flag.name,
+					      cookie);
+			    }
+			    else{
+				/* loop through the dynamic library */
+				if(ofile_first_module(&ofile) == TRUE){
+				    do{
+					processor(&ofile, ofile.arch_flag.name,
+						  cookie);
+				    }while(ofile_next_module(&ofile) == TRUE);
+				}
+				else{
+				    processor(&ofile, ofile.arch_flag.name,
+					      cookie);
+				}
+			    }
+			}
+		    }
+		    else{
+			if(member_name != NULL)
+			    error("for architecture: %s file: %s is not an "
+				  "archive and thus does not contain member: "
+				  "%s", ofile.arch_flag.name, ofile.file_name,
+				  member_name);
+			else
+			    processor(&ofile, ofile.arch_flag.name, cookie);
+		    }
+		}
+		else if(ofile.arch_type == OFILE_UNKNOWN){
+		    error("for architecture: %s file: %s is not an "
+			  "object file", ofile.arch_flag.name,
+			  ofile.file_name);
+		}
+	    }while(ofile_next_arch(&ofile) == TRUE);
+	}
+	else if(ofile.file_type == OFILE_ARCHIVE){
+	    if(narch_flags != 0){
+		arch_found = FALSE;
+		for(i = 0; i < narch_flags; i++){
+		    family = FALSE;
+		    if(narch_flags == 1){
+			family_arch_flag =
+			    get_arch_family_from_cputype(arch_flags[0].cputype);
+			if(family_arch_flag != NULL)
+			    family = (enum bool)
+				((family_arch_flag->cpusubtype &
+				  ~CPU_SUBTYPE_MASK) ==
+				 (arch_flags[0].cpusubtype &
+				  ~CPU_SUBTYPE_MASK));
+		    }
+		    if(ofile.archive_cputype == arch_flags[i].cputype &&
+		       ((ofile.archive_cpusubtype & ~CPU_SUBTYPE_MASK) ==
+			(arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK) ||
+			family == TRUE)){
+			arch_found = TRUE;
+		    }
+		    else{
+			error("file: %s does not contain architecture: %s",
+			      ofile.file_name, arch_flags[i].name);
+		    }
+		}
+		if(arch_found == FALSE){
+		    ofile_unmap(&ofile);
+		    return;
+		}
+	    }
+	    if(member_name != NULL){
+		if(ofile_specific_member(member_name, &ofile) == TRUE)
+		    processor(&ofile, NULL, cookie);
+	    }
+	    else{
+		/* loop through archive */
+#ifdef OTOOL
+		printf("Archive : %s\n", ofile.file_name);
+#endif /* OTOOL */
+		if(ofile_first_member(&ofile) == TRUE){
+		    flag = FALSE;
+		    do{
+			if(process_non_objects == TRUE ||
+			    ofile.member_type == OFILE_Mach_O){
+			    processor(&ofile, NULL, cookie);
+			    flag = TRUE;
+			}
+		    }while(ofile_next_member(&ofile) == TRUE);
+		    if(flag == FALSE){
+			error("archive: %s contains no members that are "
+			      "object files", ofile.file_name);
+		    }
+		}
+		else{
+		    error("archive: %s contains no members",
+			  ofile.file_name);
+		}
+	    }
+	}
+	else if(ofile.file_type == OFILE_Mach_O){
+	    if(narch_flags != 0){
+		arch_found = FALSE;
+		for(i = 0; i < narch_flags; i++){
+		    family = FALSE;
+		    if(narch_flags == 1){
+			family_arch_flag =
+			    get_arch_family_from_cputype(arch_flags[0].cputype);
+			if(family_arch_flag != NULL)
+			    family = (enum bool)
+				((family_arch_flag->cpusubtype &
+				  ~CPU_SUBTYPE_MASK) ==
+				 (arch_flags[0].cpusubtype &
+				  ~CPU_SUBTYPE_MASK));
+		    }
+#ifdef OTOOL
+		    if(ofile.mh != NULL){
+		        if(ofile.mh->magic == MH_MAGIC &&
+			   ofile.mh->cputype == arch_flags[i].cputype &&
+			   ((ofile.mh->cpusubtype & ~CPU_SUBTYPE_MASK) ==
+			    (arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK) ||
+			    family == TRUE)){
+			    arch_found = TRUE;
+			}
+		        if(ofile.mh->magic == SWAP_INT(MH_MAGIC) &&
+			   (cpu_type_t)SWAP_INT(ofile.mh->cputype) ==
+				arch_flags[i].cputype &&
+			   ((cpu_subtype_t)SWAP_INT(ofile.mh->cpusubtype &
+						    ~CPU_SUBTYPE_MASK) ==
+				(arch_flags[i].cpusubtype &
+				 ~CPU_SUBTYPE_MASK) ||
+			    family == TRUE)){
+			    arch_found = TRUE;
+			}
+		    }
+		    else if(ofile.mh64 != NULL){
+		        if(ofile.mh64->magic == MH_MAGIC_64 &&
+			   ofile.mh64->cputype == arch_flags[i].cputype &&
+			   ((ofile.mh64->cpusubtype & ~CPU_SUBTYPE_MASK) ==
+			    (arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK) ||
+			    family == TRUE)){
+			    arch_found = TRUE;
+			}
+		        if(ofile.mh64->magic == SWAP_INT(MH_MAGIC_64) &&
+			   (cpu_type_t)SWAP_INT(ofile.mh64->cputype) ==
+				arch_flags[i].cputype &&
+			   ((cpu_subtype_t)SWAP_INT((ofile.mh64->cpusubtype &
+						     ~CPU_SUBTYPE_MASK)) ==
+			    (arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK) ||
+			    family == TRUE)){
+			    arch_found = TRUE;
+			}
+		    }
+		    else
+#endif /* OTOOL */
+		    if(ofile.mh_cputype == arch_flags[i].cputype &&
+		       ((ofile.mh_cpusubtype & ~CPU_SUBTYPE_MASK) ==
+			(arch_flags[i].cpusubtype & ~CPU_SUBTYPE_MASK) ||
+			family == TRUE)){
+			arch_found = TRUE;
+		    }
+		    else{
+			error("file: %s does not contain architecture: %s",
+			      ofile.file_name, arch_flags[i].name);
+		    }
+		}
+		if(arch_found == FALSE){
+		    ofile_unmap(&ofile);
+		    return;
+		}
+	    }
+	    if(ofile.mh_filetype == MH_DYLIB ||
+	       ofile.mh_filetype == MH_DYLIB_STUB){
+		if(dylib_flat == TRUE){
+		    processor(&ofile, NULL, cookie);
+		}
+		else{
+		    if(member_name != NULL){
+			if(ofile_specific_module(member_name, &ofile) == TRUE)
+			    processor(&ofile, NULL, cookie);
+		    }
+		    else{
+			/* loop through the dynamic library */
+			if(ofile_first_module(&ofile) == TRUE){
+			    do{
+				processor(&ofile, NULL, cookie);
+			    }while(ofile_next_module(&ofile) == TRUE);
+			}
+			else{
+			    processor(&ofile, NULL, cookie);
+			}
+		    }
+		}
+	    }
+	    else{
+		if(member_name != NULL)
+		    error("file: %s is not an archive and thus does not contain"
+			  " member: %s", ofile.file_name, member_name);
+		else
+		    processor(&ofile, NULL, cookie);
+	    }
+	}
+	else{
+	    if(process_non_objects == TRUE)
+		processor(&ofile, NULL, cookie);
+	    else if(member_name != NULL)
+		error("file: %s(%s) is not an object file", name,
+		      member_name);
+	    else
+		error("file: %s is not an object file", name);
+	}
+	ofile_unmap(&ofile);
+}
+#endif /* !defined(OFI) */
+
+/*
+ * ofile_map maps in the object file specified by file_name, arch_flag and
+ * object_name and fills in the ofile struct pointed to by ofile for it.
+ * When arch_flag and object_name are both NULL, the file is just set up into
+ * ofile (if the file can be opened and mapped in, if not this call fails
+ * are error routnes are called).  If arch_flag is not NULL and object_file is
+ * NULL, then the file must be a Mach-O file or a fat file with the architecture
+ * specified in the arch_flag, if not this call fails and error routines are
+ * called.  When arch_flag and object_name are both not NULL, then the file must
+ * be an archive or a fat file containing archives for the specified architec-
+ * ture and contain an archive member object file with the name object_name,
+ * otherwise this call fails and error routines are called.  If arch_flag is
+ * NULL and object_file is not NULL, then the file name must be an archive (not
+ * a fat file containing archives) and contain an archive member object file
+ * with the name object_name, otherwise this call fails and calls error
+ * routines.  If this call suceeds then it returns non-zero and the ofile
+ * structure pointed to by ofile is filled in.  If this call fails it returns 0
+ * and calls error routines to print error messages and clears the
+ * ofile structure pointed to by ofile.
+ */
+__private_extern__
+#ifdef OFI
+NSObjectFileImageReturnCode
+#else
+enum bool
+#endif
+ofile_map(
+const char *file_name,
+const struct arch_flag *arch_flag,	/* can be NULL */
+const char *object_name,		/* can be NULL */
+struct ofile *ofile,
+enum bool archives_with_fat_objects
+#ifdef OTOOL_NG_SUPPORT
+, uint64_t start_offset)
+#else
+)
+#endif
+{
+    int fd;
+    struct stat stat_buf;
+    uint64_t size;
+    uint32_t magic;
+    char *addr;
+
+	magic = 0; /* to shut up the compiler warning message */
+	memset(ofile, '\0', sizeof(struct ofile));
+
+	/* Open the file and map it in */
+	if((fd = open(file_name, O_RDONLY)) == -1){
+#ifdef OFI
+	    return(NSObjectFileImageAccess);
+#else
+	    system_error("can't open file: %s", file_name);
+	    return(FALSE);
+#endif
+	}
+	if(fstat(fd, &stat_buf) == -1){
+	    close(fd);
+#ifdef OFI
+	    return(NSObjectFileImageAccess);
+#else
+	    system_error("can't stat file: %s", file_name);
+	    return(FALSE);
+#endif
+	}
+	size = stat_buf.st_size;
+	
+	addr = NULL;
+	if(size != 0){
+#ifdef OTOOL_NG_SUPPORT	
+		if (start_offset > size)
+		{
+			error("ERROR: specified file offset higher than file size!");
+			close(fd);
+			return(FALSE);
+		}	
+	    addr = mmap(0, size, PROT_READ|PROT_WRITE, MAP_FILE|MAP_PRIVATE, fd,
+		        start_offset);
+#else
+	    addr = mmap(0, size, PROT_READ|PROT_WRITE, MAP_FILE|MAP_PRIVATE, fd,
+		        0);
+#endif	   
+	    if((intptr_t)addr == -1){
+		system_error("can't map file: %s", file_name);
+		close(fd);
+		return(FALSE);
+	    }
+	}
+	close(fd);
+#ifdef OTOOL
+	if(otool_first_ofile_map && Wflag)
+	    printf("Modification time = %ld\n", (long int)stat_buf.st_mtime);
+#endif /* OTOOL */
+
+	return(ofile_map_from_memory(addr, size, file_name, stat_buf.st_mtime,
+		  arch_flag, object_name, ofile, archives_with_fat_objects));
+}
+
+/*
+ * ofile_map_from_memory() is the guts of ofile_map() but with an interface
+ * to pass the address and size of the file already mapped in.
+ */
+__private_extern__
+#ifdef OFI
+NSObjectFileImageReturnCode
+#else
+enum bool
+#endif
+ofile_map_from_memory(
+char *addr,
+uint64_t size,
+const char *file_name,
+uint64_t mtime,
+const struct arch_flag *arch_flag,	/* can be NULL */
+const char *object_name,		/* can be NULL */
+struct ofile *ofile,
+enum bool archives_with_fat_objects)
+{
+    uint32_t i;
+    uint32_t magic;
+    enum byte_sex host_byte_sex;
+    struct arch_flag host_arch_flag;
+    enum bool family;
+    const struct arch_flag *family_arch_flag;
+    uint64_t big_size;
+#ifdef OTOOL
+    uint32_t small_nfat_arch;
+#endif /* OTOOL */
+
+	/* fill in the start of the ofile structure */
+	ofile->file_name = savestr(file_name);
+	if(ofile->file_name == NULL)
+	    return(FALSE);
+	ofile->file_addr = addr;
+	ofile->file_size = size;
+	ofile->file_mtime = mtime;
+
+	/* Try to figure out what kind of file this is */
+
+	if(size >= sizeof(uint32_t)){
+	   magic = *((uint32_t *)addr);
+	}
+	host_byte_sex = get_host_byte_sex();
+
+	/* see if this file is a fat file (always in big endian byte sex) */
+#ifdef __BIG_ENDIAN__
+	if(size >= sizeof(struct fat_header) && magic == FAT_MAGIC)
+#endif /* __BIG_ENDIAN__ */
+#ifdef __LITTLE_ENDIAN__
+	if(size >= sizeof(struct fat_header) && SWAP_INT(magic) == FAT_MAGIC)
+#endif /* __LITTLE_ENDIAN__ */
+	{
+	    ofile->file_type = OFILE_FAT;
+	    ofile->fat_header = (struct fat_header *)addr;
+#ifdef __LITTLE_ENDIAN__
+	    swap_fat_header(ofile->fat_header, host_byte_sex);
+#endif /* __LITTLE_ENDIAN__ */
+#ifdef OTOOL
+	    if(otool_first_ofile_map && fflag)
+		printf("Fat headers\n");
+#endif /* OTOOL */
+	    big_size = ofile->fat_header->nfat_arch;
+	    big_size *= sizeof(struct fat_arch);
+	    big_size += sizeof(struct fat_header);
+	    if(big_size > size){
+#ifdef OTOOL
+		error("fat file: %s truncated or malformed (fat_arch structs "
+		      "would extend past the end of the file)", file_name);
+		ofile->fat_archs = allocate(size - sizeof(struct fat_header));
+		memset(ofile->fat_archs, '\0',
+		       size - sizeof(struct fat_header));
+		memcpy(ofile->fat_archs,
+		       addr + sizeof(struct fat_header),
+	    	       size - sizeof(struct fat_header));
+		small_nfat_arch = (size - sizeof(struct fat_header)) /
+				  sizeof(struct fat_arch);
+#ifdef __LITTLE_ENDIAN__
+		swap_fat_arch(ofile->fat_archs, small_nfat_arch,
+			      host_byte_sex);
+#endif /* __LITTLE_ENDIAN__ */
+		if(otool_first_ofile_map && fflag)
+		    print_fat_headers(ofile->fat_header, ofile->fat_archs,
+				      size, vflag);
+		free(ofile->fat_archs);
+		ofile_unmap(ofile);
+		return(FALSE);
+#else /* !defined(OTOOL) */
+		goto unknown;
+#endif /* OTOOL */
+	    }
+	    ofile->fat_archs = (struct fat_arch *)(addr +
+						   sizeof(struct fat_header));
+#ifdef __LITTLE_ENDIAN__
+	    swap_fat_arch(ofile->fat_archs, ofile->fat_header->nfat_arch,
+			  host_byte_sex);
+#endif /* __LITTLE_ENDIAN__ */
+#ifdef OTOOL
+	    if(otool_first_ofile_map && fflag)
+		print_fat_headers(ofile->fat_header, ofile->fat_archs,
+				  size, vflag);
+#endif /* OTOOL */
+	    if(check_fat(ofile) == CHECK_BAD){
+		ofile_unmap(ofile);
+#ifdef OFI
+		return(NSObjectFileImageFormat);
+#else
+		return(FALSE);
+#endif
+	    }
+	    /*
+	     * Now that the fat file is mapped fill in the ofile to the level
+	     * the caller wants based on the arch_flag and object_name passed.
+	     * If the caller did not specify an arch_flag or an object_name
+	     * then everything the caller wants is done.
+	     */
+	    if(arch_flag == NULL && object_name == NULL)
+		goto success;
+	    if(arch_flag == NULL){
+		if(get_arch_from_host(&host_arch_flag, NULL) == 0){
+		    error("can't determine the host architecture (specify an "
+			  "arch_flag or fix get_arch_from_host() )");
+		    goto cleanup;
+		}
+		ofile->arch_flag.name = savestr(host_arch_flag.name);
+		if(ofile->arch_flag.name == NULL)
+		    goto cleanup;
+		ofile->arch_flag.cputype = host_arch_flag.cputype;
+		ofile->arch_flag.cpusubtype = host_arch_flag.cpusubtype;
+	    }
+	    else{
+		ofile->arch_flag.name = savestr(arch_flag->name);
+		if(ofile->arch_flag.name == NULL)
+		    goto cleanup;
+		ofile->arch_flag.cputype = arch_flag->cputype;
+		ofile->arch_flag.cpusubtype = arch_flag->cpusubtype;
+	    }
+
+	    ofile->narch = UINT_MAX;
+	    for(i = 0; i < ofile->fat_header->nfat_arch; i++){
+		if(ofile->fat_archs[i].cputype ==
+			ofile->arch_flag.cputype &&
+		   (ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK) ==
+			(ofile->arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK)){
+		    ofile->narch = i;
+		    break;
+		}
+	    }
+	    if(ofile->narch == UINT_MAX){
+		family = FALSE;
+		family_arch_flag =
+		    get_arch_family_from_cputype(ofile->arch_flag.cputype);
+		if(family_arch_flag != NULL)
+		    family = (enum bool)
+			((family_arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) ==
+			 (ofile->arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK));
+		ofile->narch = UINT_MAX;
+		for(i = 0; i < ofile->fat_header->nfat_arch; i++){
+		    if(ofile->fat_archs[i].cputype ==
+			    ofile->arch_flag.cputype &&
+		       (family == TRUE ||
+			(ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK) ==
+			(ofile->arch_flag.cpusubtype & ~CPU_SUBTYPE_MASK))){
+			ofile->arch_flag.cpusubtype =
+			    ofile->fat_archs[i].cpusubtype;
+			ofile->narch = i;
+			break;
+		    }
+		}
+	    }
+	    if(ofile->narch == UINT_MAX){
+#ifdef OFI
+		ofile_unmap(ofile);
+		return(NSObjectFileImageArch);
+#else
+		error("fat file: %s does not contain architecture %s",
+		      ofile->file_name, arch_flag->name);
+		ofile_unmap(ofile);
+		return(FALSE);
+#endif
+	    }
+	    /* Now determine the file type for this specific architecture */
+	    size = ofile->fat_archs[i].size;
+	    addr = addr + ofile->fat_archs[i].offset;
+	    if(size >= sizeof(struct mach_header))
+		memcpy(&magic, addr, sizeof(uint32_t));
+	    /* see if this file is a 32-bit Mach-O file */
+	    if(size >= sizeof(struct mach_header) &&
+	       (magic == MH_MAGIC ||
+		magic == SWAP_INT(MH_MAGIC))){
+#ifdef ALIGNMENT_CHECKS
+		if(ofile->fat_archs[i].offset % 4 != 0){
+		    error("fat file: %s architecture %s malformed for a 32-bit "
+			  "object file (offset is not a multiple of 4)",
+			  ofile->file_name, arch_flag->name);
+		    ofile_unmap(ofile);
+#ifdef OFI
+		    return(NSObjectFileImageFormat);
+#else
+		    return(FALSE);
+#endif
+		}
+#endif /* ALIGNMENT_CHECKS */
+		ofile->arch_type = OFILE_Mach_O;
+		ofile->object_addr = addr;
+		ofile->object_size = size;
+		if(magic == MH_MAGIC)
+		    ofile->object_byte_sex = host_byte_sex;
+		else
+		    ofile->object_byte_sex =
+			host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
+			LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
+		ofile->mh = (struct mach_header *)addr;
+		ofile->load_commands = (struct load_command *)(addr +
+					    sizeof(struct mach_header));
+		if(check_Mach_O(ofile) == CHECK_BAD){
+		    ofile_unmap(ofile);
+#ifdef OFI
+		    return(NSObjectFileImageFormat);
+#else
+		    return(FALSE);
+#endif
+		}
+		if(object_name != NULL){
+		    error("fat file: %s architecture %s is not an archive "
+			  "(object_name to ofile_map() can't be specified to "
+			  "be other than NULL)", ofile->file_name,
+			  arch_flag->name);
+		    goto cleanup;
+		}
+	    }
+	    /* see if this file is a 64-bit Mach-O file */
+	    else if(size >= sizeof(struct mach_header_64) &&
+	            (magic == MH_MAGIC_64 ||
+		     magic == SWAP_INT(MH_MAGIC_64))){
+#ifdef ALIGNMENT_CHECKS
+		if(ofile->fat_archs[i].offset % 8 != 0){
+		    error("fat file: %s architecture %s malformed for a 64-bit "
+			  "object file (offset is not a multiple of 8)",
+			  ofile->file_name, arch_flag->name);
+		    ofile_unmap(ofile);
+#ifdef OFI
+		    return(NSObjectFileImageFormat);
+#else
+		    return(FALSE);
+#endif
+		}
+#endif /* ALIGNMENT_CHECKS */
+		ofile->arch_type = OFILE_Mach_O;
+		ofile->object_addr = addr;
+		ofile->object_size = size;
+		if(magic == MH_MAGIC_64)
+		    ofile->object_byte_sex = host_byte_sex;
+		else
+		    ofile->object_byte_sex =
+			host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
+			LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
+		ofile->mh64 = (struct mach_header_64 *)addr;
+		ofile->load_commands = (struct load_command *)(addr +
+					sizeof(struct mach_header_64));
+		if(check_Mach_O(ofile) == CHECK_BAD){
+		    ofile_unmap(ofile);
+#ifdef OFI
+		    return(NSObjectFileImageFormat);
+#else
+		    return(FALSE);
+#endif
+		}
+		if(object_name != NULL){
+		    error("fat file: %s architecture %s is not an archive "
+			  "(object_name to ofile_map() can't be specified to "
+			  "be other than NULL)", ofile->file_name,
+			  arch_flag->name);
+		    goto cleanup;
+		}
+	    }
+	    /* see if this file is an archive file */
+	    else if(size >= SARMAG && strncmp(addr, ARMAG, SARMAG) == 0){
+		ofile->arch_type = OFILE_ARCHIVE;
+		if(check_archive(ofile, FALSE) == CHECK_BAD){
+		    ofile_unmap(ofile);
+#ifdef OFI
+		    return(NSObjectFileImageInappropriateFile);
+#else
+		    return(FALSE);
+#endif
+		}
+#ifdef ALIGNMENT_CHECKS
+		if(ofile->archive_cputype != 0 &&
+		   ofile->fat_archs[i].offset % sizeof(uint32_t) != 0){
+		    error("fat file: %s architecture %s malformed archive that "
+			  "contains object files (offset to archive is not a "
+			  "multiple of sizeof(uint32_t))",
+			  ofile->file_name, arch_flag->name);
+		    ofile_unmap(ofile);
+#ifdef OFI
+		    return(NSObjectFileImageInappropriateFile);
+#else
+		    return(FALSE);
+#endif
+		}
+#endif /* ALIGNMENT_CHECKS */
+		if(object_name != NULL){
+		    if(ofile_specific_member(object_name, ofile) == FALSE)
+			goto cleanup;
+		}
+	    }
+	    /* this file type is now known to be unknown to this program */
+	    else{
+		ofile->file_type = OFILE_UNKNOWN;
+		if(object_name != NULL){
+		    error("fat file: %s architecture %s is not an archive "
+			  "(object_name to ofile_map() can't be specified to "
+			  "be other than NULL)", ofile->file_name,
+			  arch_flag->name);
+		    goto cleanup;
+		}
+	    }
+	}
+	/* see if this file is a 32-bit Mach-O file */
+	else if(size >= sizeof(struct mach_header) &&
+		(magic == MH_MAGIC ||
+		 magic == SWAP_INT(MH_MAGIC))){
+	    ofile->file_type = OFILE_Mach_O;
+	    ofile->object_addr = addr;
+	    ofile->object_size = size;
+	    if(magic == MH_MAGIC)
+		ofile->object_byte_sex = host_byte_sex;
+	    else
+		ofile->object_byte_sex = host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
+				 LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
+	    ofile->mh = (struct mach_header *)addr;
+	    ofile->load_commands = (struct load_command *)(addr +
+				    sizeof(struct mach_header));
+	    if(check_Mach_O(ofile) == CHECK_BAD){
+		ofile_unmap(ofile);
+#ifdef OFI
+		return(NSObjectFileImageFormat);
+#else
+		return(FALSE);
+#endif
+	    }
+	    if(object_name != NULL){
+		error("file: %s is not an archive (object_name to ofile_map() "
+		      "can't be specified to be other than NULL)",
+		      ofile->file_name);
+		goto cleanup;
+	    }
+	    if(arch_flag != NULL){
+		if(arch_flag->cputype != ofile->mh_cputype &&
+		   (arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) !=
+		   (ofile->mh_cpusubtype & ~CPU_SUBTYPE_MASK)){
+#ifdef OFI
+		    ofile_unmap(ofile);
+		    return(NSObjectFileImageArch);
+#else
+		    error("object file: %s does not match specified arch_flag: "
+			  "%s passed to ofile_map()", ofile->file_name,
+			  arch_flag->name);
+		    ofile_unmap(ofile);
+		    return(FALSE);
+#endif
+		    goto cleanup;
+		}
+	    }
+	}
+	/* see if this file is a 64-bit Mach-O file */
+	else if(size >= sizeof(struct mach_header_64) &&
+		(magic == MH_MAGIC_64 ||
+		 magic == SWAP_INT(MH_MAGIC_64))){
+	    ofile->file_type = OFILE_Mach_O;
+	    ofile->object_addr = addr;
+	    ofile->object_size = size;
+	    if(magic == MH_MAGIC_64)
+		ofile->object_byte_sex = host_byte_sex;
+	    else
+		ofile->object_byte_sex = host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
+				 LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
+	    ofile->mh64 = (struct mach_header_64 *)addr;
+	    ofile->load_commands = (struct load_command *)(addr +
+				    sizeof(struct mach_header_64));
+	    if(check_Mach_O(ofile) == CHECK_BAD){
+		ofile_unmap(ofile);
+#ifdef OFI
+		return(NSObjectFileImageFormat);
+#else
+		return(FALSE);
+#endif
+	    }
+	    if(object_name != NULL){
+		error("file: %s is not an archive (object_name to ofile_map() "
+		      "can't be specified to be other than NULL)",
+		      ofile->file_name);
+		goto cleanup;
+	    }
+	    if(arch_flag != NULL){
+		if(arch_flag->cputype != ofile->mh_cputype &&
+		   (arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) !=
+		   (ofile->mh_cpusubtype & ~CPU_SUBTYPE_MASK)){
+#ifdef OFI
+		    ofile_unmap(ofile);
+		    return(NSObjectFileImageArch);
+#else
+		    error("object file: %s does not match specified arch_flag: "
+			  "%s passed to ofile_map()", ofile->file_name,
+			  arch_flag->name);
+		    ofile_unmap(ofile);
+		    return(FALSE);
+#endif
+		    goto cleanup;
+		}
+	    }
+	}
+	/* see if this file is an archive file */
+	else if(size >= SARMAG && strncmp(addr, ARMAG, SARMAG) == 0){
+	    ofile->file_type = OFILE_ARCHIVE;
+	    if(check_archive(ofile, archives_with_fat_objects) == CHECK_BAD)
+		goto cleanup;
+	    if(object_name != NULL){
+		if(ofile_specific_member(object_name, ofile) == FALSE)
+		    goto cleanup;
+		if(arch_flag != NULL){
+		    if(arch_flag->cputype != ofile->mh_cputype &&
+		       (arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) !=
+		       (ofile->mh_cpusubtype & ~CPU_SUBTYPE_MASK)){
+			error("object file: %s(%.*s) does not match specified "
+			    "arch_flag: %s passed to ofile_map()",
+			    ofile->file_name, (int)ofile->member_name_size,
+			    ofile->member_name, arch_flag->name);
+			goto cleanup;
+		    }
+		}
+	    }
+	    else{
+		if(arch_flag != NULL){
+		    if(arch_flag->cputype != ofile->archive_cputype &&
+		       (arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) !=
+		       (ofile->archive_cpusubtype & ~CPU_SUBTYPE_MASK)){
+			error("archive file: %s objects do not match specified "
+			      "arch_flag: %s passed to ofile_map()",
+			      ofile->file_name, arch_flag->name);
+			goto cleanup;
+		    }
+		}
+	    }
+	}
+	/* this file type is now known to be unknown to this program */
+	else{
+#ifndef OTOOL
+unknown:
+#endif
+#ifndef OFI
+#ifdef LTO_SUPPORT
+	    if(is_llvm_bitcode(ofile, ofile->file_addr, ofile->file_size) ==
+	       TRUE){
+		ofile->file_type = OFILE_LLVM_BITCODE;
+		if(arch_flag != NULL){
+		    if(arch_flag->cputype != ofile->lto_cputype &&
+		       (arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) !=
+		       (ofile->lto_cpusubtype & ~CPU_SUBTYPE_MASK)){
+			error("llvm bitcode file: %s does not match specified "
+			      "arch_flag: %s passed to ofile_map()",
+			      ofile->file_name, arch_flag->name);
+			goto cleanup;
+		    }
+		}
+		if(object_name != NULL){
+		    error("file: %s is not an archive (object_name to "
+			  "ofile_map() can't be specified to be other than "
+			  "NULL)", ofile->file_name);
+		    goto cleanup;
+		}
+		goto success;
+	    }
+	    else
+#endif /* LTO_SUPPORT */
+#endif /* OFI */
+		ofile->file_type = OFILE_UNKNOWN;
+	    if(arch_flag != NULL){
+#ifdef OFI
+		ofile_unmap(ofile);
+		return(NSObjectFileImageInappropriateFile);
+#else
+		error("file: %s is unknown type (arch_flag to ofile_map() "
+		      "can't be specified to be other than NULL)",
+		      ofile->file_name);
+		ofile_unmap(ofile);
+		return(FALSE);
+#endif
+	    }
+	    if(object_name != NULL){
+		error("file: %s is not an archive (object_name to ofile_map() "
+		      "can't be specified to be other than NULL)",
+		      ofile->file_name);
+		goto cleanup;
+	    }
+	}
+success:
+	return(TRUE);
+
+cleanup:
+	ofile_unmap(ofile);
+	return(FALSE);
+}
+
+/*
+ * ofile_unmap() deallocates the memory associated with the specified ofile
+ * struct.
+ */
+__private_extern__
+void
+ofile_unmap(
+struct ofile *ofile)
+{
+    kern_return_t r;
+
+	if(ofile->file_addr != NULL){
+	    if((r = vm_deallocate(mach_task_self(),
+				 (vm_address_t)ofile->file_addr,
+				 (vm_size_t)ofile->file_size)) != KERN_SUCCESS){
+		my_mach_error(r, "Can't vm_deallocate mapped memory for file: "
+			      "%s", ofile->file_name);
+	    }
+	}
+	if(ofile->file_name != NULL)
+	    free(ofile->file_name);
+	if(ofile->arch_flag.name != NULL)
+	    free(ofile->arch_flag.name);
+	memset(ofile, '\0', sizeof(struct ofile));
+}
+
+/*
+ * ofile_first_arch() sets up the ofile struct for a fat file to the first arch
+ * in it.
+ */
+__private_extern__
+enum bool
+ofile_first_arch(
+struct ofile *ofile)
+{
+	if(ofile->file_type == OFILE_FAT ||
+	   (ofile->file_type == OFILE_ARCHIVE &&
+	    ofile->member_type == OFILE_FAT) )
+	    return(ofile_specific_arch(ofile, 0));
+	else{
+	    error("ofile_first_arch() called and file type of: %s is not a fat "
+		  "file\n", ofile->file_name);
+	    return(FALSE);
+	}
+}
+
+/*
+ * ofile_next_arch() sets up the ofile struct for a fat file to the next arch
+ * in it.
+ */
+__private_extern__
+enum bool
+ofile_next_arch(
+struct ofile *ofile)
+{
+	if(ofile->file_type == OFILE_FAT ||
+	   (ofile->file_type == OFILE_ARCHIVE &&
+	    ofile->member_type == OFILE_FAT) ){
+	    if(ofile->narch + 1 < ofile->fat_header->nfat_arch)
+		return(ofile_specific_arch(ofile, ofile->narch + 1));
+	    else
+		return(FALSE);
+	}
+	else{
+	    error("ofile_next_arch() called and file type of: %s is not a fat "
+		  "file\n", ofile->file_name);
+	    return(FALSE);
+	}
+}
+
+/*
+ * ofile_specific_arch() sets up the ofile struct for the fat file for the
+ * specified narch.
+ */
+static
+enum bool
+ofile_specific_arch(
+struct ofile *ofile,
+uint32_t narch)
+{
+    char *addr;
+    uint32_t size;
+    uint32_t magic;
+    enum byte_sex host_byte_sex;
+
+	ofile->narch = narch;
+	ofile->arch_type = OFILE_UNKNOWN;
+	if(ofile->arch_flag.name != NULL)
+	    free(ofile->arch_flag.name);
+	ofile->arch_flag.name = NULL;
+	ofile->arch_flag.cputype = 0;
+	ofile->arch_flag.cpusubtype = 0;
+	ofile->archive_cputype = 0;
+	ofile->archive_cpusubtype = 0;
+	ofile->object_addr = NULL;
+	ofile->object_size = 0;
+	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
+	ofile->mh = NULL;
+	ofile->mh64 = NULL;
+	ofile->load_commands = NULL;
+
+	ofile->arch_flag.cputype = ofile->fat_archs[ofile->narch].cputype;
+	ofile->arch_flag.cpusubtype = ofile->fat_archs[ofile->narch].cpusubtype;
+	set_arch_flag_name(&(ofile->arch_flag));
+
+
+	/* Now determine the file type for this specific architecture */
+	if(ofile->file_type == OFILE_FAT){
+	    ofile->member_offset = 0;
+	    ofile->member_addr = NULL;
+	    ofile->member_size = 0;
+	    ofile->member_ar_hdr = NULL;
+	    ofile->member_type = OFILE_UNKNOWN;
+
+	    size = ofile->fat_archs[ofile->narch].size;
+	    addr = ofile->file_addr + ofile->fat_archs[ofile->narch].offset;
+	}
+	else{
+	    if(ofile->file_type != OFILE_ARCHIVE ||
+	       ofile->member_type != OFILE_FAT){
+		error("internal error. ofile_specific_arch() called but file "
+		      "is not a fat file or an archive with a fat member ");
+	    }
+	    size = ofile->fat_archs[ofile->narch].size;
+	    addr = ofile->file_addr +
+		   ofile->member_offset +
+		   ofile->fat_archs[ofile->narch].offset;
+	}
+
+#ifdef OTOOL
+	if(addr - ofile->file_addr > (ptrdiff_t)ofile->file_size){
+	    error("fat file: %s offset to architecture %s extends past end "
+		  "of file", ofile->file_name, ofile->arch_flag.name);
+	    return(FALSE);
+	}
+	if(addr + size > ofile->file_addr + ofile->file_size)
+	    size = (ofile->file_addr + ofile->file_size) - addr;
+#endif /* OTOOL */
+
+	if(size >= sizeof(struct mach_header))
+	    memcpy(&magic, addr, sizeof(uint32_t));
+	/* see if this file is a 32-bit Mach-O file */
+	if(size >= sizeof(struct mach_header) &&
+	   (magic == MH_MAGIC || magic == SWAP_INT(MH_MAGIC))){
+#ifdef ALIGNMENT_CHECKS
+	    if(ofile->fat_archs[ofile->narch].offset % 4 != 0){
+		if(ofile->file_type == OFILE_ARCHIVE){
+		    error("fat file: %s(%.*s) architecture %s malformed for a "
+			  "32-bit object file (offset is not a multiple of 4)",
+			  ofile->file_name, (int)ofile->member_name_size,
+			  ofile->member_name, ofile->arch_flag.name);
+		}
+		else
+		    error("fat file: %s architecture %s malformed for a 32-bit "
+			  "object file (offset is not a multiple of 4)",
+			  ofile->file_name, ofile->arch_flag.name);
+		goto cleanup;
+	    }
+#endif /* ALIGNMENT_CHECKS */
+	    ofile->arch_type = OFILE_Mach_O;
+	    ofile->object_addr = addr;
+	    ofile->object_size = size;
+	    host_byte_sex = get_host_byte_sex();
+	    if(magic == MH_MAGIC)
+		ofile->object_byte_sex = host_byte_sex;
+	    else
+		ofile->object_byte_sex =
+		    host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
+		    LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
+	    ofile->mh = (struct mach_header *)addr;
+	    ofile->load_commands = (struct load_command *)(addr +
+				    sizeof(struct mach_header));
+	    if(check_Mach_O(ofile) == CHECK_BAD)
+		goto cleanup;
+	}
+	/* see if this file is a 64-bit Mach-O file */
+	else if(size >= sizeof(struct mach_header_64) &&
+	   (magic == MH_MAGIC_64 || magic == SWAP_INT(MH_MAGIC_64))){
+#ifdef ALIGNMENT_CHECKS
+	    if(ofile->fat_archs[ofile->narch].offset % 8 != 0){
+		if(ofile->file_type == OFILE_ARCHIVE){
+		    error("fat file: %s(%.*s) architecture %s malformed for an "
+			  "object file (offset is not a multiple of 8)",
+			  ofile->file_name, (int)ofile->member_name_size,
+			  ofile->member_name, ofile->arch_flag.name);
+		}
+		else
+		    error("fat file: %s architecture %s malformed for a 64-bit "
+			  "object file (offset is not a multiple of 8",
+			  ofile->file_name, ofile->arch_flag.name);
+		goto cleanup;
+	    }
+#endif /* ALIGNMENT_CHECKS */
+	    ofile->arch_type = OFILE_Mach_O;
+	    ofile->object_addr = addr;
+	    ofile->object_size = size;
+	    host_byte_sex = get_host_byte_sex();
+	    if(magic == MH_MAGIC_64)
+		ofile->object_byte_sex = host_byte_sex;
+	    else
+		ofile->object_byte_sex =
+		    host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
+		    LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
+	    ofile->mh64 = (struct mach_header_64 *)addr;
+	    ofile->load_commands = (struct load_command *)(addr +
+				    sizeof(struct mach_header_64));
+	    if(check_Mach_O(ofile) == CHECK_BAD)
+		goto cleanup;
+	}
+	/* see if this file is an archive file */
+	else if(size >= SARMAG && strncmp(addr, ARMAG, SARMAG) == 0){
+	    ofile->arch_type = OFILE_ARCHIVE;
+	    if(check_archive(ofile, FALSE) == CHECK_BAD)
+		goto cleanup;
+#ifdef ALIGNMENT_CHECKS
+	    if(ofile->archive_cputype != 0 &&
+	       ofile->fat_archs[ofile->narch].offset %
+		sizeof(uint32_t) != 0){
+		error("fat file: %s architecture %s malformed archive that "
+		      "contains object files (offset to archive is not a "
+		      "multiple of sizeof(uint32_t))",
+		      ofile->file_name, ofile->arch_flag.name);
+		goto cleanup;
+	    }
+#endif /* ALIGNMENT_CHECKS */
+	}
+	/*
+	 * This type for this architecture is now known to be unknown to this
+	 * program.
+	 */
+	else{
+#ifdef LTO_SUPPORT
+	    if(is_llvm_bitcode(ofile, addr, size) == TRUE){
+		ofile->arch_type = OFILE_LLVM_BITCODE;
+		ofile->object_addr = addr;
+		ofile->object_size = size;
+	    }
+	    else
+#endif /* LTO_SUPPORT */
+	        ofile->arch_type = OFILE_UNKNOWN;
+	}
+	return(TRUE);
+cleanup:
+	ofile->narch = 0;;
+	ofile->arch_type = OFILE_UNKNOWN;
+	if(ofile->arch_flag.name != NULL)
+	    free(ofile->arch_flag.name);
+	ofile->arch_flag.name = NULL;
+	ofile->arch_flag.cputype = 0;
+	ofile->arch_flag.cpusubtype = 0;
+	if(ofile->file_type != OFILE_ARCHIVE){
+	    ofile->member_offset = 0;
+	    ofile->member_addr = NULL;
+	    ofile->member_size = 0;
+	    ofile->member_ar_hdr = NULL;
+	    ofile->member_type = OFILE_UNKNOWN;
+	}
+	ofile->archive_cputype = 0;
+	ofile->archive_cpusubtype = 0;
+	ofile->object_addr = NULL;
+	ofile->object_size = 0;
+	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
+	ofile->mh = NULL;
+	ofile->mh64 = NULL;
+	ofile->load_commands = NULL;
+	return(FALSE);
+}
+
+/*
+ * ofile_first_member() set up the ofile structure (the member_* fields and
+ * the object file fields if the first member is an object file) for the first
+ * member.
+ */
+__private_extern__
+enum bool
+ofile_first_member(
+struct ofile *ofile)
+{
+    char *addr;
+    uint64_t size, offset;
+    uint32_t magic;
+    enum byte_sex host_byte_sex;
+    struct ar_hdr *ar_hdr;
+    uint32_t ar_name_size;
+
+	/* These fields are to be filled in by this routine, clear them first */
+	ofile->member_offset = 0;
+	ofile->member_addr = NULL;
+	ofile->member_size = 0;
+	ofile->member_ar_hdr = NULL;
+	ofile->member_name = NULL;
+	ofile->member_name_size = 0;
+	ofile->member_type = OFILE_UNKNOWN;
+	ofile->object_addr = NULL;
+	ofile->object_size = 0;
+	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
+	ofile->mh = NULL;
+	ofile->mh64 = NULL;
+	ofile->load_commands = NULL;
+#ifdef LTO_SUPPORT
+	/*
+	 * Note: it is up to the caller if they want to call free_lto() on this
+	 * when iterating through the members of an archive. 
+	 */
+	ofile->lto = NULL;
+#endif /* LTO_SUPPORT */
+
+	/*
+	 * Get the address and size of the archive.
+	 */
+	if(ofile->file_type == OFILE_FAT){
+	    if(ofile->arch_type != OFILE_ARCHIVE){
+		error("ofile_first_member() called on fat file: %s with a "
+		      "non-archive architecture or no architecture selected\n",
+		      ofile->file_name);
+		return(FALSE);
+	    }
+	    addr = ofile->file_addr + ofile->fat_archs[ofile->narch].offset;
+	    size = ofile->fat_archs[ofile->narch].size;
+	}
+	else if(ofile->file_type == OFILE_ARCHIVE){
+	    addr = ofile->file_addr;
+	    size = ofile->file_size;
+	}
+	else{
+	    error("ofile_first_member() called and file type of %s is "
+		  "OFILE_UNKNOWN\n", ofile->file_name);
+	    return(FALSE);
+	}
+#ifdef OTOOL
+	if((addr + SARMAG) - ofile->file_addr > (ptrdiff_t)ofile->file_size){
+	    archive_error(ofile, "offset to first member extends past the end "
+			  "of the file");
+	    return(FALSE);
+	}
+	if(addr + size > ofile->file_addr + ofile->file_size)
+	    size = (ofile->file_addr + ofile->file_size) - addr;
+#endif /* OTOOL */
+	if(size < SARMAG || strncmp(addr, ARMAG, SARMAG) != 0){
+	    archive_error(ofile, "internal error. ofile_first_member() "
+			  "called but file does not have an archive magic "
+			  "string");
+	    return(FALSE);
+	}
+
+	offset = SARMAG;
+	if(offset != size && offset + sizeof(struct ar_hdr) > size){
+	    archive_error(ofile, "truncated or malformed (archive header of "
+			  "first member extends past the end of the file)");
+	    return(FALSE);
+	}
+
+	/* check for empty archive */
+	if(size == offset)
+	    return(FALSE);
+
+	/* now we know there is a first member so set it up */
+	ar_hdr = (struct ar_hdr *)(addr + offset);
+	offset += sizeof(struct ar_hdr);
+	ofile->member_offset = offset;
+	ofile->member_addr = addr + offset;
+	ofile->member_size = strtoul(ar_hdr->ar_size, NULL, 10);
+	ofile->member_ar_hdr = ar_hdr;
+	ofile->member_type = OFILE_UNKNOWN;
+	ofile->member_name = ar_hdr->ar_name;
+	if(strncmp(ofile->member_name, AR_EFMT1, sizeof(AR_EFMT1) - 1) == 0){
+	    ofile->member_name = ar_hdr->ar_name + sizeof(struct ar_hdr);
+	    ar_name_size = strtoul(ar_hdr->ar_name + sizeof(AR_EFMT1) - 1,
+				   NULL, 10);
+	    ofile->member_name_size = ar_name_size;
+	    ofile->member_offset += ar_name_size;
+	    ofile->member_addr += ar_name_size;
+	    ofile->member_size -= ar_name_size;
+	}
+	else{
+	    ofile->member_name_size = size_ar_name(ar_hdr);
+	    ar_name_size = 0;
+	}
+	/* Clear these in case there is no table of contents */
+	ofile->toc_addr = NULL;
+	ofile->toc_size = 0;
+	ofile->toc_ar_hdr = NULL;
+	ofile->toc_name = NULL;
+	ofile->toc_name_size = 0;
+	ofile->toc_ranlibs = NULL;
+	ofile->toc_nranlibs = 0;
+	ofile->toc_strings = NULL;
+	ofile->toc_strsize = 0;
+	ofile->toc_bad = FALSE;
+
+	host_byte_sex = get_host_byte_sex();
+
+	if(ofile->member_size > sizeof(uint32_t)){
+	    memcpy(&magic, ofile->member_addr, sizeof(uint32_t));
+#ifdef __BIG_ENDIAN__
+	    if(magic == FAT_MAGIC)
+#endif /* __BIG_ENDIAN__ */
+#ifdef __LITTLE_ENDIAN__
+	    if(magic == SWAP_INT(FAT_MAGIC))
+#endif /* __LITTLE_ENDIAN__ */
+	    {
+		ofile->member_type = OFILE_FAT;
+		ofile->fat_header =
+			(struct fat_header *)(ofile->member_addr);
+#ifdef __LITTLE_ENDIAN__
+		swap_fat_header(ofile->fat_header, host_byte_sex);
+#endif /* __LITTLE_ENDIAN__ */
+		if(sizeof(struct fat_header) +
+		   ofile->fat_header->nfat_arch *
+		   sizeof(struct fat_arch) > ofile->member_size){
+		    archive_member_error(ofile, "fat file truncated or "
+			    "malformed (fat_arch structs would extend past "
+			    "the end of the archive member)");
+		    goto fatcleanup;
+		}
+		ofile->fat_archs = (struct fat_arch *)
+		    (ofile->member_addr + sizeof(struct fat_header));
+#ifdef __LITTLE_ENDIAN__
+		swap_fat_arch(ofile->fat_archs,
+			      ofile->fat_header->nfat_arch, host_byte_sex);
+#endif /* __LITTLE_ENDIAN__ */
+		if(check_fat_object_in_archive(ofile) == FALSE)
+		    goto fatcleanup;
+	    }
+	    else if(size - (offset + ar_name_size) >=
+		    sizeof(struct mach_header) &&
+	       (magic == MH_MAGIC || magic == SWAP_INT(MH_MAGIC))){
+#ifdef ALIGNMENT_CHECKS
+		if((offset + ar_name_size) % 4 != 0){
+		    archive_member_error(ofile, "offset in archive not a "
+			"multiple of 4 (must be since member is a 32-bit "
+			"object file)");
+		    goto cleanup;
+		}
+#endif /* ALIGNMENT_CHECKS */
+		ofile->member_type = OFILE_Mach_O;
+		ofile->object_addr = ofile->member_addr;
+		ofile->object_size = ofile->member_size;
+		if(magic == MH_MAGIC)
+		    ofile->object_byte_sex = host_byte_sex;
+		else
+		    ofile->object_byte_sex =
+			   host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
+			   LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
+		ofile->mh = (struct mach_header *)(ofile->object_addr);
+		ofile->load_commands = (struct load_command *)
+		    (ofile->object_addr + sizeof(struct mach_header));
+		if(check_Mach_O(ofile) == CHECK_BAD)
+		    goto cleanup;
+	    }
+	    else if(size - (offset + ar_name_size) >=
+		    sizeof(struct mach_header_64) &&
+	       (magic == MH_MAGIC_64 || magic == SWAP_INT(MH_MAGIC_64))){
+#ifdef ALIGNMENT_CHECKS_ARCHIVE_64_BIT
+		if(archive_64_bit_align_warning == FALSE &&
+		   (offset + ar_name_size) % 8 != 0){
+		    temporary_archive_member_warning(ofile, "offset in archive "
+			"not a multiple of 8 (must be since member is an "
+			"64-bit object file)");
+		    archive_64_bit_align_warning = TRUE;
+		    /* goto cleanup; */
+		}
+#endif /* ALIGNMENT_CHECKS_ARCHIVE_64_BIT */
+		ofile->member_type = OFILE_Mach_O;
+		ofile->object_addr = ofile->member_addr;
+		ofile->object_size = ofile->member_size;
+		if(magic == MH_MAGIC_64)
+		    ofile->object_byte_sex = host_byte_sex;
+		else
+		    ofile->object_byte_sex =
+			   host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
+			   LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
+		ofile->mh64 = (struct mach_header_64 *)(ofile->object_addr);
+		ofile->load_commands = (struct load_command *)
+		    (ofile->object_addr + sizeof(struct mach_header_64));
+		if(check_Mach_O(ofile) == CHECK_BAD)
+		    goto cleanup;
+	    }
+	    if(ofile->member_type == OFILE_UNKNOWN &&
+	       (strncmp(ofile->member_name, SYMDEF_SORTED,
+		        sizeof(SYMDEF_SORTED) - 1) == 0 ||
+	        strncmp(ofile->member_name, SYMDEF,
+		        sizeof(SYMDEF) - 1) == 0)){
+		ofile->toc_addr = ofile->member_addr;
+		ofile->toc_size = ofile->member_size;
+		ofile->toc_ar_hdr = ofile->member_ar_hdr;
+		ofile->toc_name = ofile->member_name;
+		ofile->toc_name_size = ofile->member_name_size;
+		if(check_archive_toc(ofile) == CHECK_BAD)
+		    goto cleanup;
+	    }
+#ifdef LTO_SUPPORT
+	    if(ofile->member_type == OFILE_UNKNOWN &&
+	       strncmp(ofile->member_name, SYMDEF_SORTED,
+		       sizeof(SYMDEF_SORTED) - 1) != 0 &&
+	       strncmp(ofile->member_name, SYMDEF,
+		       sizeof(SYMDEF) - 1) != 0 &&
+	       is_llvm_bitcode(ofile, ofile->member_addr, ofile->member_size) ==
+	       TRUE){
+		ofile->member_type = OFILE_LLVM_BITCODE;
+		ofile->object_addr = ofile->member_addr;
+		ofile->object_size = ofile->member_size;
+	    }
+#endif /* LTO_SUPPORT */
+	}
+	return(TRUE);
+
+fatcleanup:
+	ofile->fat_header = NULL;
+	ofile->fat_archs = NULL;
+cleanup:
+	ofile->member_offset = 0;
+	ofile->member_addr = 0;
+	ofile->member_size = 0;
+	ofile->member_ar_hdr = NULL;
+	ofile->member_name = NULL;
+	ofile->member_name_size = 0;
+	ofile->member_type = OFILE_UNKNOWN;
+	ofile->object_addr = NULL;
+	ofile->object_size = 0;
+	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
+	ofile->mh = NULL;
+	ofile->mh64 = NULL;
+	ofile->load_commands = NULL;
+#ifdef LTO_SUPPORT
+	ofile->lto = NULL;
+	ofile->lto_cputype = 0;
+	ofile->lto_cpusubtype = 0;
+#endif /* LTO_SUPPORT */
+	return(FALSE);
+}
+
+/*
+ * ofile_next_member() set up the ofile structure (the member_* fields and
+ * the object file fields if the next member is an object file) for the next
+ * member.
+ */
+__private_extern__
+enum bool
+ofile_next_member(
+struct ofile *ofile)
+{
+    char *addr;
+    uint64_t size, offset;
+    uint32_t magic;
+    enum byte_sex host_byte_sex;
+    struct ar_hdr *ar_hdr;
+    uint32_t ar_name_size;
+
+	/*
+	 * Get the address and size of the archive.
+	 */
+	if(ofile->file_type == OFILE_FAT){
+	    if(ofile->arch_type != OFILE_ARCHIVE){
+		error("ofile_next_member() called on fat file: %s with a "
+		      "non-archive architecture or no architecture selected\n",
+		      ofile->file_name);
+		return(FALSE);
+	    }
+	    addr = ofile->file_addr + ofile->fat_archs[ofile->narch].offset;
+	    size = ofile->fat_archs[ofile->narch].size;
+	}
+	else if(ofile->file_type == OFILE_ARCHIVE){
+	    addr = ofile->file_addr;
+	    size = ofile->file_size;
+	}
+	else{
+	    error("ofile_next_member() called and file type of %s is "
+		  "OFILE_UNKNOWN\n", ofile->file_name);
+	    return(FALSE);
+	}
+	if(size < SARMAG || strncmp(addr, ARMAG, SARMAG) != 0){
+	    archive_error(ofile, "internal error. ofile_next_member() "
+			  "called but file does not have an archive magic "
+			  "string");
+	    return(FALSE);
+	}
+	if(ofile->member_ar_hdr == NULL){
+	    archive_error(ofile, "internal error. ofile_next_member() called "
+			  "but the ofile struct does not have an archive "
+			  "member selected");
+	    return(FALSE);
+	}
+
+	/* figure out the offset to the next member */
+	offset = ofile->member_offset + rnd(ofile->member_size,sizeof(short));
+#ifdef OTOOL
+	if((addr - ofile->file_addr) + offset > ofile->file_size){
+	    archive_error(ofile, "offset to next member extends past the end "
+			  "of the file");
+	    return(FALSE);
+	}
+#endif /* OTOOL */
+	/* if now at the end of the file then no more members */
+	if(offset == size)
+	     goto cleanup;
+	if(offset > size){
+	    archive_error(ofile, "truncated or malformed (archive header of "
+			  "next member extends past the end of the file)");
+	    return(FALSE);
+	}
+
+	/* now we know there is a next member so set it up */
+	ar_hdr = (struct ar_hdr *)(addr + offset);
+	offset += sizeof(struct ar_hdr);
+	ofile->member_offset = offset;
+	ofile->member_addr = addr + offset;
+	ofile->member_size = strtoul(ar_hdr->ar_size, NULL, 10);
+	ofile->member_ar_hdr = ar_hdr;
+	ofile->member_name = ar_hdr->ar_name;
+	if(strncmp(ofile->member_name, AR_EFMT1, sizeof(AR_EFMT1) - 1) == 0){
+	    ofile->member_name = ar_hdr->ar_name + sizeof(struct ar_hdr);
+	    ar_name_size = strtoul(ar_hdr->ar_name + sizeof(AR_EFMT1) - 1,
+				   NULL, 10);
+	    ofile->member_name_size = ar_name_size;
+	    ofile->member_offset += ar_name_size;
+	    ofile->member_addr += ar_name_size;
+	    ofile->member_size -= ar_name_size;
+	}
+	else{
+	    ofile->member_name_size = size_ar_name(ar_hdr);
+	    ar_name_size = 0;
+	}
+	ofile->member_type = OFILE_UNKNOWN;
+	ofile->object_addr = NULL;
+	ofile->object_size = 0;
+	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
+	ofile->mh = NULL;
+	ofile->mh64 = NULL;
+	ofile->load_commands = NULL;
+
+	host_byte_sex = get_host_byte_sex();
+
+	if(ofile->member_size > sizeof(uint32_t)){
+	    memcpy(&magic, ofile->member_addr, sizeof(uint32_t));
+#ifdef __BIG_ENDIAN__
+	    if(magic == FAT_MAGIC)
+#endif /* __BIG_ENDIAN__ */
+#ifdef __LITTLE_ENDIAN__
+	    if(magic == SWAP_INT(FAT_MAGIC))
+#endif /* __LITTLE_ENDIAN__ */
+	    {
+		ofile->member_type = OFILE_FAT;
+		ofile->fat_header = (struct fat_header *)(ofile->member_addr);
+#ifdef __LITTLE_ENDIAN__
+		swap_fat_header(ofile->fat_header, host_byte_sex);
+#endif /* __LITTLE_ENDIAN__ */
+		if(sizeof(struct fat_header) +
+		   ofile->fat_header->nfat_arch *
+		   sizeof(struct fat_arch) > ofile->member_size){
+		    archive_member_error(ofile, "fat file truncated or "
+			    "malformed (fat_arch structs would extend past "
+			    "the end of the archive member)");
+		    goto cleanup;
+		}
+		ofile->fat_archs = (struct fat_arch *)(ofile->member_addr +
+					       sizeof(struct fat_header));
+#ifdef __LITTLE_ENDIAN__
+		swap_fat_arch(ofile->fat_archs,
+			      ofile->fat_header->nfat_arch, host_byte_sex);
+#endif /* __LITTLE_ENDIAN__ */
+		if(check_fat_object_in_archive(ofile) == FALSE)
+		    goto cleanup;
+	    }
+	    else if(size - (offset + ar_name_size) >=
+		    sizeof(struct mach_header) &&
+		    (magic == MH_MAGIC ||
+		     magic == SWAP_INT(MH_MAGIC))){
+#ifdef ALIGNMENT_CHECKS
+		if((offset + ar_name_size) % 4 != 0){
+		    archive_member_error(ofile, "offset in archive not "
+			"a multiple of 4 (must be since member is an 32-bit "
+			"object file)");
+		    goto cleanup;
+		}
+#endif /* ALIGNMENT_CHECKS */
+		ofile->member_type = OFILE_Mach_O;
+		ofile->object_addr = ofile->member_addr;
+		ofile->object_size = ofile->member_size;
+		if(magic == MH_MAGIC)
+		    ofile->object_byte_sex = host_byte_sex;
+		else
+		    ofile->object_byte_sex =
+			   host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
+			   LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
+		ofile->mh = (struct mach_header *)ofile->object_addr;
+		ofile->load_commands = (struct load_command *)
+			   (ofile->object_addr + sizeof(struct mach_header));
+		if(check_Mach_O(ofile) == CHECK_BAD)
+		    goto cleanup;
+	    }
+	    else if(size - (offset + ar_name_size) >=
+		    sizeof(struct mach_header_64) &&
+		    (magic == MH_MAGIC_64 ||
+		     magic == SWAP_INT(MH_MAGIC_64))){
+#ifdef ALIGNMENT_CHECKS_ARCHIVE_64_BIT
+		if(archive_64_bit_align_warning == FALSE &&
+		   (offset + ar_name_size) % 8 != 0){
+		    temporary_archive_member_warning(ofile, "offset in archive "
+			"not a multiple of 8 (must be since member is an "
+			"64-bit object file)");
+		    archive_64_bit_align_warning = TRUE;
+		    /* goto cleanup; */
+		}
+#endif /* ALIGNMENT_CHECKS_ARCHIVE_64_BIT */
+		ofile->member_type = OFILE_Mach_O;
+		ofile->object_addr = ofile->member_addr;
+		ofile->object_size = ofile->member_size;
+		if(magic == MH_MAGIC_64)
+		    ofile->object_byte_sex = host_byte_sex;
+		else
+		    ofile->object_byte_sex =
+			   host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
+			   LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
+		ofile->mh64 = (struct mach_header_64 *)ofile->object_addr;
+		ofile->load_commands = (struct load_command *)
+			   (ofile->object_addr + sizeof(struct mach_header_64));
+		if(check_Mach_O(ofile) == CHECK_BAD)
+		    goto cleanup;
+	    }
+#ifdef LTO_SUPPORT
+	    if(ofile->member_type == OFILE_UNKNOWN &&
+	       is_llvm_bitcode(ofile, ofile->member_addr, ofile->member_size) ==
+	       TRUE){
+		ofile->member_type = OFILE_LLVM_BITCODE;
+		ofile->object_addr = ofile->member_addr;
+		ofile->object_size = ofile->member_size;
+	    }
+#endif /* LTO_SUPPORT */
+	}
+	return(TRUE);
+
+cleanup:
+	if(ofile->member_type == OFILE_FAT){
+	    ofile->fat_header = NULL;
+	    ofile->fat_archs = NULL;
+	}
+	ofile->member_offset = 0;
+	ofile->member_addr = NULL;
+	ofile->member_size = 0;
+	ofile->member_ar_hdr = NULL;
+	ofile->member_name = NULL;
+	ofile->member_name_size = 0;
+	ofile->member_type = OFILE_UNKNOWN;
+	ofile->object_addr = NULL;
+	ofile->object_size = 0;
+	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
+	ofile->mh = NULL;
+	ofile->mh64 = NULL;
+	ofile->load_commands = NULL;
+#ifdef LTO_SUPPORT
+	ofile->lto = NULL;
+	ofile->lto_cputype = 0;
+	ofile->lto_cpusubtype = 0;
+#endif /* LTO_SUPPORT */
+	return(FALSE);
+}
+
+/*
+ * ofile_specific_member() set up the ofile structure (the member_* fields and
+ * the object file fields if the member is an object file) for the specified
+ * member member_name.
+ */
+__private_extern__
+enum bool
+ofile_specific_member(
+const char *member_name,
+struct ofile *ofile)
+{
+    int32_t i;
+    char *addr;
+    uint64_t size, offset;
+    uint32_t magic;
+    enum byte_sex host_byte_sex;
+    char *ar_name;
+    uint32_t ar_name_size;
+    struct ar_hdr *ar_hdr;
+
+	/* These fields are to be filled in by this routine, clear them first */
+	ofile->member_offset = 0;
+	ofile->member_addr = NULL;
+	ofile->member_size = 0;
+	ofile->member_ar_hdr = NULL;
+	ofile->member_name = NULL;
+	ofile->member_name_size = 0;
+	ofile->member_type = OFILE_UNKNOWN;
+	ofile->object_addr = NULL;
+	ofile->object_size = 0;
+	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
+	ofile->mh = NULL;
+	ofile->mh64 = NULL;
+	ofile->load_commands = NULL;
+
+	/*
+	 * Get the address and size of the archive.
+	 */
+	if(ofile->file_type == OFILE_FAT){
+	    if(ofile->arch_type != OFILE_ARCHIVE){
+		error("ofile_specific_member() called on fat file: %s with a "
+		      "non-archive architecture or no architecture selected\n",
+		      ofile->file_name);
+		return(FALSE);
+	    }
+	    addr = ofile->file_addr + ofile->fat_archs[ofile->narch].offset;
+	    size = ofile->fat_archs[ofile->narch].size;
+	}
+	else if(ofile->file_type == OFILE_ARCHIVE){
+	    addr = ofile->file_addr;
+	    size = ofile->file_size;
+	}
+	else{
+	    error("ofile_specific_member() called and file type of %s is "
+		  "OFILE_UNKNOWN\n", ofile->file_name);
+	    return(FALSE);
+	}
+	if(size < SARMAG || strncmp(addr, ARMAG, SARMAG) != 0){
+	    archive_error(ofile, "internal error. ofile_specific_member() "
+			  "called but file does not have an archive magic "
+			  "string");
+	    return(FALSE);
+	}
+
+	offset = SARMAG;
+	if(offset != size && offset + sizeof(struct ar_hdr) > size){
+	    archive_error(ofile, "truncated or malformed (archive header of "
+			  "first member extends past the end of the file)");
+	    return(FALSE);
+	}
+	while(size > offset){
+	    ar_hdr = (struct ar_hdr *)(addr + offset);
+	    offset += sizeof(struct ar_hdr);
+	    if(strncmp(ar_hdr->ar_name, AR_EFMT1, sizeof(AR_EFMT1) - 1) == 0){
+#ifdef OTOOL
+		if(check_extend_format_1(ofile, ar_hdr, size - offset,
+				&ar_name_size) == CHECK_BAD){
+		    i = size_ar_name(ar_hdr);
+		    ar_name = ar_hdr->ar_name;
+		    ar_name_size = 0;
+		}
+		else
+#endif /* OTOOL */
+		{
+		    i = strtoul(ar_hdr->ar_name + sizeof(AR_EFMT1) - 1,NULL,10);
+		    ar_name = ar_hdr->ar_name + sizeof(struct ar_hdr);
+		    ar_name_size = i;
+		}
+	    }
+	    else{
+		i = size_ar_name(ar_hdr);
+		ar_name = ar_hdr->ar_name;
+		ar_name_size = 0;
+	    }
+	    if(i > 0 && strncmp(ar_name, member_name, i) == 0){
+
+		ofile->member_name = ar_name;
+		ofile->member_name_size = i;
+		ofile->member_offset = offset + ar_name_size;
+		ofile->member_addr = addr + offset + ar_name_size;
+		ofile->member_size = strtoul(ar_hdr->ar_size, NULL, 10) -
+				     ar_name_size;
+		ofile->member_ar_hdr = ar_hdr;
+		ofile->member_type = OFILE_UNKNOWN;
+
+		host_byte_sex = get_host_byte_sex();
+
+		if(ofile->member_size > sizeof(uint32_t)){
+		    memcpy(&magic, addr + offset + ar_name_size,
+			   sizeof(uint32_t));
+#ifdef __BIG_ENDIAN__
+		    if(magic == FAT_MAGIC)
+#endif /* __BIG_ENDIAN__ */
+#ifdef __LITTLE_ENDIAN__
+		    if(magic == SWAP_INT(FAT_MAGIC))
+#endif /* __LITTLE_ENDIAN__ */
+		    {
+			ofile->member_type = OFILE_FAT;
+			ofile->fat_header =
+			    (struct fat_header *)(addr + offset + ar_name_size);
+#ifdef __LITTLE_ENDIAN__
+			swap_fat_header(ofile->fat_header, host_byte_sex);
+#endif /* __LITTLE_ENDIAN__ */
+			if(sizeof(struct fat_header) +
+			   ofile->fat_header->nfat_arch *
+			   sizeof(struct fat_arch) > ofile->member_size){
+			    archive_member_error(ofile, "fat file truncated or "
+				    "malformed (fat_arch structs would extend "
+				    "past the end of the archive member)");
+			    goto fatcleanup;
+			}
+			ofile->fat_archs =
+			    (struct fat_arch *)(addr + offset + ar_name_size +
+					        sizeof(struct fat_header));
+#ifdef __LITTLE_ENDIAN__
+			swap_fat_arch(ofile->fat_archs,
+				      ofile->fat_header->nfat_arch,
+				      host_byte_sex);
+#endif /* __LITTLE_ENDIAN__ */
+			if(check_fat_object_in_archive(ofile) == FALSE)
+			    goto fatcleanup;
+		    }
+		    else if(size - (offset + ar_name_size) >=
+			    sizeof(struct mach_header) &&
+			   (magic == MH_MAGIC ||
+			    magic == SWAP_INT(MH_MAGIC))){
+#ifdef ALIGNMENT_CHECKS
+			if((offset + ar_name_size) % 4 != 0){
+			    archive_member_error(ofile, "offset in archive not "
+				"a multiple of 4) (must be since member is a "
+				"32-bit object file)");
+			    goto cleanup;
+			}
+#endif /* ALIGNMENT_CHECKS */
+			ofile->member_type = OFILE_Mach_O;
+			ofile->object_addr = ofile->member_addr;
+			ofile->object_size = ofile->member_size;
+			if(magic == MH_MAGIC)
+			    ofile->object_byte_sex = host_byte_sex;
+			else
+			    ofile->object_byte_sex =
+				   host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
+				   LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
+			ofile->mh = (struct mach_header *)ofile->object_addr;
+			ofile->load_commands = (struct load_command *)
+			    (ofile->object_addr + sizeof(struct mach_header));
+			if(check_Mach_O(ofile) == CHECK_BAD)
+			    goto cleanup;
+		    }
+		    else if(size - (offset + ar_name_size) >=
+			    sizeof(struct mach_header_64) &&
+			   (magic == MH_MAGIC_64 ||
+			    magic == SWAP_INT(MH_MAGIC_64))){
+#ifdef ALIGNMENT_CHECKS_ARCHIVE_64_BIT
+			if(archive_64_bit_align_warning == FALSE &&
+			   (offset + ar_name_size) % 8 != 0){
+			    temporary_archive_member_warning(ofile, "offset in "
+				"archive not a multiple of 8) (must be since "
+				"member is a 64-bit object file)");
+			    archive_64_bit_align_warning = TRUE;
+			    /* goto cleanup; */
+			}
+#endif /* ALIGNMENT_CHECKS_ARCHIVE_64_BIT */
+			ofile->member_type = OFILE_Mach_O;
+			ofile->object_addr = ofile->member_addr;
+			ofile->object_size = ofile->member_size;
+			if(magic == MH_MAGIC_64)
+			    ofile->object_byte_sex = host_byte_sex;
+			else
+			    ofile->object_byte_sex =
+				   host_byte_sex == BIG_ENDIAN_BYTE_SEX ?
+				   LITTLE_ENDIAN_BYTE_SEX : BIG_ENDIAN_BYTE_SEX;
+			ofile->mh64 = (struct mach_header_64 *)
+				      ofile->object_addr;
+			ofile->load_commands = (struct load_command *)
+			    (ofile->object_addr +sizeof(struct mach_header_64));
+			if(check_Mach_O(ofile) == CHECK_BAD)
+			    goto cleanup;
+		    }
+		}
+#ifdef LTO_SUPPORT
+		if(ofile->member_type == OFILE_UNKNOWN &&
+		   is_llvm_bitcode(ofile, ofile->member_addr,
+				   ofile->member_size) == TRUE){
+		    ofile->member_type = OFILE_LLVM_BITCODE;
+		    ofile->object_addr = ofile->member_addr;
+		    ofile->object_size = ofile->member_size;
+		}
+#endif /* LTO_SUPPORT */
+		return(TRUE);
+	    }
+	    offset += rnd(strtoul(ar_hdr->ar_size, NULL, 10),
+			    sizeof(short));
+	}
+	archive_error(ofile, "does not contain a member named: %s",
+		      member_name);
+fatcleanup:
+	ofile->fat_header = NULL;
+	ofile->fat_archs = NULL;
+cleanup:
+	ofile->member_offset = 0;
+	ofile->member_addr = NULL;
+	ofile->member_size = 0;
+	ofile->member_ar_hdr = NULL;
+	ofile->member_name = NULL;
+	ofile->member_name_size = 0;
+	ofile->member_type = OFILE_UNKNOWN;
+	ofile->object_addr = NULL;
+	ofile->object_size = 0;
+	ofile->object_byte_sex = UNKNOWN_BYTE_SEX;
+	ofile->mh = NULL;
+	ofile->mh64 = NULL;
+	ofile->load_commands = NULL;
+#ifdef LTO_SUPPORT
+	ofile->lto = NULL;
+	ofile->lto_cputype = 0;
+	ofile->lto_cpusubtype = 0;
+#endif /* LTO_SUPPORT */
+	return(FALSE);
+}
+
+/*
+ * ofile_first_module() set up the ofile structure (the dylib_module field)
+ * for the first module of an MH_DYLIB or MH_DYLIB_STUB file.
+ */
+__private_extern__
+enum bool
+ofile_first_module(
+struct ofile *ofile)
+{
+    uint32_t i, ncmds;
+    struct symtab_command *st;
+    struct dysymtab_command *dyst;
+    struct load_command *lc;
+    enum bool swapped;
+    enum byte_sex host_byte_sex;
+    struct dylib_module m;
+    struct dylib_module_64 m64;
+    char *strings;
+
+	/* These fields are to be filled in by this routine, clear them first */
+	ofile->modtab = NULL;
+	ofile->modtab64 = NULL;
+	ofile->nmodtab = 0;
+	ofile->dylib_module = NULL;
+	ofile->dylib_module64 = NULL;
+	ofile->dylib_module_name = NULL;
+
+	if(ofile->file_type == OFILE_FAT){
+	    if(ofile->arch_type != OFILE_Mach_O &&
+	       (ofile->mh_filetype != MH_DYLIB &&
+	        ofile->mh_filetype != MH_DYLIB_STUB)){
+		error("ofile_first_module() called on fat file: %s with a "
+		      "non-MH_DYLIB architecture or no architecture selected\n",
+		      ofile->file_name);
+		return(FALSE);
+	    }
+	}
+	else if(ofile->arch_type != OFILE_Mach_O &&
+	        (ofile->mh_filetype != MH_DYLIB &&
+	         ofile->mh_filetype != MH_DYLIB_STUB)){
+	    error("ofile_first_module() called and file type of %s is "
+		  "non-MH_DYLIB\n", ofile->file_name);
+	    return(FALSE);
+	}
+
+	st = NULL;
+	dyst = NULL;
+	lc = ofile->load_commands;
+	if(ofile->mh != NULL)
+	    ncmds = ofile->mh->ncmds;
+	else
+	    ncmds = ofile->mh64->ncmds;
+	for(i = 0; i < ncmds; i++){
+	    if(st == NULL && lc->cmd == LC_SYMTAB){
+		st = (struct symtab_command *)lc;
+	    }
+	    else if(lc->cmd == LC_DYSYMTAB){
+		dyst = (struct dysymtab_command *)lc;
+	    }
+	    lc = (struct load_command *)((char *)lc + lc->cmdsize);
+	}
+	if(st == NULL || dyst == NULL){
+#ifndef OTOOL
+	    Mach_O_error(ofile, "MH_DYLIB format error (does not have a symbol "
+		"table and/or a dynamic symbol table)");
+#endif
+	    return(FALSE);
+	}
+	if(dyst->nmodtab == 0)
+	    return(FALSE);
+
+	ofile->nmodtab = dyst->nmodtab;
+	host_byte_sex = get_host_byte_sex();
+	swapped = (enum bool)(host_byte_sex != ofile->object_byte_sex);
+	strings = (char *)(ofile->object_addr + st->stroff);
+
+	if(ofile->mh != NULL){
+	    ofile->modtab = (struct dylib_module *)(ofile->object_addr +
+						    dyst->modtaboff);
+	    ofile->dylib_module = ofile->modtab;
+	    m = *ofile->dylib_module;
+	    if(swapped)
+		swap_dylib_module(&m, 1, host_byte_sex);
+	    ofile->dylib_module_name = strings + m.module_name;
+	}
+	else{
+	    ofile->modtab64 = (struct dylib_module_64 *)(ofile->object_addr +
+						         dyst->modtaboff);
+	    ofile->dylib_module64 = ofile->modtab64;
+	    m64 = *ofile->dylib_module64;
+	    if(swapped)
+		swap_dylib_module_64(&m64, 1, host_byte_sex);
+	    ofile->dylib_module_name = strings + m64.module_name;
+	}
+
+	if(check_dylib_module(ofile, st, dyst, strings, 0) == CHECK_BAD)
+	    return(FALSE);
+	return(TRUE);
+}
+
+/*
+ * ofile_next_module() set up the ofile structure (the dylib_module field)
+ * for the next module of an MH_DYLIB or MH_DYLIB_STUB file.
+ */
+__private_extern__
+enum bool
+ofile_next_module(
+struct ofile *ofile)
+{
+    uint32_t i, module_index, ncmds;
+    struct symtab_command *st;
+    struct dysymtab_command *dyst;
+    struct load_command *lc;
+    enum bool swapped;
+    enum byte_sex host_byte_sex;
+    struct dylib_module m;
+    struct dylib_module_64 m64;
+    char *strings;
+
+	if(ofile->file_type == OFILE_FAT){
+	    if(ofile->arch_type != OFILE_Mach_O &&
+	       (ofile->mh_filetype != MH_DYLIB &&
+	        ofile->mh_filetype != MH_DYLIB_STUB)){
+		error("ofile_next_module() called on fat file: %s with a "
+		      "non-MH_DYLIB architecture or no architecture selected\n",
+		      ofile->file_name);
+		return(FALSE);
+	    }
+	}
+	else if(ofile->arch_type != OFILE_Mach_O &&
+	        (ofile->mh_filetype != MH_DYLIB &&
+	         ofile->mh_filetype != MH_DYLIB_STUB)){
+	    error("ofile_next_module() called and file type of %s is "
+		  "non-MH_DYLIB\n", ofile->file_name);
+	    return(FALSE);
+	}
+	st = NULL;
+	dyst = NULL;
+	lc = ofile->load_commands;
+	if(ofile->mh != NULL)
+	    ncmds = ofile->mh->ncmds;
+	else
+	    ncmds = ofile->mh64->ncmds;
+	for(i = 0; i < ncmds; i++){
+	    if(st == NULL && lc->cmd == LC_SYMTAB){
+		st = (struct symtab_command *)lc;
+	    }
+	    else if(lc->cmd == LC_DYSYMTAB){
+		dyst = (struct dysymtab_command *)lc;
+	    }
+	    lc = (struct load_command *)((char *)lc + lc->cmdsize);
+	}
+	if(st == NULL || dyst == NULL){
+#ifndef OTOOL
+	    Mach_O_error(ofile, "MH_DYLIB format error (does not have a symbol "
+		"table and/or a dynamic symbol table)");
+#endif
+	    return(FALSE);
+	}
+
+	if(ofile->mh != NULL)
+	    module_index = (ofile->dylib_module + 1) - ofile->modtab;
+	else
+	    module_index = (ofile->dylib_module64 + 1) - ofile->modtab64;
+	if(module_index >= ofile->nmodtab)
+	    return(FALSE);
+
+	host_byte_sex = get_host_byte_sex();
+	swapped = (enum bool)(host_byte_sex != ofile->object_byte_sex);
+	strings = (char *)(ofile->object_addr + st->stroff);
+
+	if(ofile->mh != NULL){
+	    ofile->dylib_module++;
+	    m = *ofile->dylib_module;
+	    if(swapped)
+		swap_dylib_module(&m, 1, host_byte_sex);
+	    ofile->dylib_module_name = strings + m.module_name;
+	}
+	else{
+	    ofile->dylib_module64++;
+	    m64 = *ofile->dylib_module64;
+	    if(swapped)
+		swap_dylib_module_64(&m64, 1, host_byte_sex);
+	    ofile->dylib_module_name = strings + m64.module_name;
+	}
+	if(check_dylib_module(ofile, st, dyst, strings, module_index) ==
+	   CHECK_BAD)
+	    return(FALSE);
+	return(TRUE);
+}
+
+/*
+ * ofile_specific_module() set up the ofile structure (the dylib_module fields)
+ * for the specified module, module_name, of an MH_DYLIB or an MH_DYLIB_STUB
+ * file.
+ */
+__private_extern__
+enum bool
+ofile_specific_module(
+const char *module_name,
+struct ofile *ofile)
+{
+    uint32_t i, ncmds;
+    enum bool swapped;
+    enum byte_sex host_byte_sex;
+    struct symtab_command *st;
+    struct dysymtab_command *dyst;
+    struct load_command *lc;
+    struct dylib_module *p, m;
+    struct dylib_module_64 *p64, m64;
+    char *strings;
+
+	/* These fields are to be filled in by this routine, clear them first */
+	ofile->modtab = NULL;
+	ofile->modtab64 = NULL;
+	ofile->nmodtab = 0;
+	ofile->dylib_module = NULL;
+	ofile->dylib_module64 = NULL;
+	ofile->dylib_module_name = NULL;
+
+	if(ofile->file_type == OFILE_FAT){
+	    if(ofile->arch_type != OFILE_Mach_O &&
+	       (ofile->mh_filetype != MH_DYLIB &&
+	        ofile->mh_filetype != MH_DYLIB_STUB)){
+		error("ofile_specific_module() called on fat file: %s with a "
+		      "non-MH_DYLIB architecture or no architecture selected\n",
+		      ofile->file_name);
+		return(FALSE);
+	    }
+	}
+	else if(ofile->arch_type != OFILE_Mach_O &&
+	        (ofile->mh_filetype != MH_DYLIB &&
+	         ofile->mh_filetype != MH_DYLIB_STUB)){
+	    error("ofile_specific_module() called and file type of %s is "
+		  "non-MH_DYLIB\n", ofile->file_name);
+	    return(FALSE);
+	}
+
+	st = NULL;
+	dyst = NULL;
+	lc = ofile->load_commands;
+	if(ofile->mh != NULL)
+	    ncmds = ofile->mh->ncmds;
+	else
+	    ncmds = ofile->mh64->ncmds;
+	for(i = 0; i < ncmds; i++){
+	    if(st == NULL && lc->cmd == LC_SYMTAB){
+		st = (struct symtab_command *)lc;
+	    }
+	    else if(lc->cmd == LC_DYSYMTAB){
+		dyst = (struct dysymtab_command *)lc;
+	    }
+	    lc = (struct load_command *)((char *)lc + lc->cmdsize);
+	}
+	if(st == NULL || dyst == NULL){
+#ifndef OTOOL
+	    Mach_O_error(ofile, "MH_DYLIB format error (does not have a symbol "
+		"table and/or a dynamic symbol table)");
+#endif
+	    return(FALSE);
+	}
+	if(dyst->nmodtab == 0)
+	    return(FALSE);
+
+	host_byte_sex = get_host_byte_sex();
+	swapped = (enum bool)(host_byte_sex != ofile->object_byte_sex);
+	strings = (char *)(ofile->object_addr + st->stroff);
+
+	if(ofile->mh != NULL){
+	    ofile->nmodtab = dyst->nmodtab;
+	    ofile->modtab = (struct dylib_module *)(ofile->object_addr +
+						    dyst->modtaboff);
+	    p = ofile->modtab;
+	    for(i = 0; i < dyst->nmodtab; i++){
+		m = *p;
+		if(swapped)
+		    swap_dylib_module(&m, 1, host_byte_sex);
+		ofile->dylib_module = p;
+		if(check_dylib_module(ofile, st, dyst, strings, i) == CHECK_BAD)
+		    return(FALSE);
+		if(strcmp(module_name, strings + m.module_name) == 0){
+		    ofile->dylib_module_name = strings + m.module_name;
+		    return(TRUE);
+		}
+		p++;
+	    }
+	    m = *ofile->dylib_module;
+	    if(swapped)
+		swap_dylib_module(&m, 1, host_byte_sex);
+	    ofile->dylib_module_name = strings + m.module_name;
+	}
+	else{
+	    ofile->nmodtab = dyst->nmodtab;
+	    ofile->modtab64 = (struct dylib_module_64 *)(ofile->object_addr +
+						         dyst->modtaboff);
+	    p64 = ofile->modtab64;
+	    for(i = 0; i < dyst->nmodtab; i++){
+		m64 = *p64;
+		if(swapped)
+		    swap_dylib_module_64(&m64, 1, host_byte_sex);
+		ofile->dylib_module64 = p64;
+		if(check_dylib_module(ofile, st, dyst, strings, i) == CHECK_BAD)
+		    return(FALSE);
+		if(strcmp(module_name, strings + m64.module_name) == 0){
+		    ofile->dylib_module_name = strings + m64.module_name;
+		    return(TRUE);
+		}
+		p64++;
+	    }
+	    m64 = *ofile->dylib_module64;
+	    if(swapped)
+		swap_dylib_module_64(&m64, 1, host_byte_sex);
+	    ofile->dylib_module_name = strings + m64.module_name;
+	}
+#ifndef OTOOL
+	Mach_O_error(ofile, "does not contain a module named: %s", module_name);
+#endif
+	ofile->modtab = NULL;
+	ofile->nmodtab = 0;
+	ofile->dylib_module = NULL;
+	ofile->dylib_module_name = NULL;
+	return(FALSE);
+}
+
+#ifdef DEBUG
+__private_extern__
+void
+ofile_print(
+struct ofile *ofile)
+{
+	printf("file_name = %s\n", ofile->file_name);
+	printf("file_addr = 0x%x\n", (unsigned int)ofile->file_addr);
+	printf("file_size = 0x%x\n", (unsigned int)ofile->file_size);
+	printf("file_type = 0x%x\n", (unsigned int)ofile->file_type);
+	printf("fat_header = 0x%x\n", (unsigned int)ofile->fat_header);
+	printf("fat_archs = 0x%x\n", (unsigned int)ofile->fat_archs);
+	printf("narch = 0x%x\n", (unsigned int)ofile->narch);
+	printf("arch_type = 0x%x\n", (unsigned int)ofile->arch_type);
+	printf("arch_flag.name = %s\n", ofile->arch_flag.name);
+	printf("arch_flag.cputype = 0x%x\n",
+		(unsigned int)ofile->arch_flag.cputype);
+	printf("arch_flag.cpusubtype = 0x%x\n",
+		(unsigned int)ofile->arch_flag.cpusubtype);
+	printf("member_offset = 0x%x\n", (unsigned int)ofile->member_offset);
+	printf("member_addr = 0x%x\n", (unsigned int)ofile->member_addr);
+	printf("member_size = 0x%x\n", (unsigned int)ofile->member_size);
+	printf("member_ar_hdr = 0x%x\n", (unsigned int)ofile->member_ar_hdr);
+	printf("member_type = 0x%x\n", (unsigned int)ofile->member_type);
+	printf("archive_cputype = 0x%x\n",
+		(unsigned int)ofile->archive_cputype);
+	printf("archive_cpusubtype = 0x%x\n",
+		(unsigned int)ofile->archive_cpusubtype);
+	printf("object_addr = 0x%x\n", (unsigned int)ofile->object_addr);
+	printf("object_size = 0x%x\n", (unsigned int)ofile->object_size);
+	printf("object_byte_sex = 0x%x\n",
+		(unsigned int)ofile->object_byte_sex);
+	printf("mh = 0x%x\n", (unsigned int)ofile->mh);
+	printf("mh64 = 0x%x\n", (unsigned int)ofile->mh64);
+	printf("load_commands = 0x%x\n", (unsigned int)ofile->load_commands);
+}
+#endif /* DEBUG */
+
+/*
+ * check_fat() checks the fat ofile for correctness (the fat_header and
+ * fat_archs are assumed to be in the host byte sex).
+ */
+static
+enum check_type
+check_fat(
+struct ofile *ofile)
+{
+#ifdef OTOOL
+	return(CHECK_GOOD);
+#else /* !defined OTOOL */
+
+    uint32_t i, j;
+    uint64_t big_size;
+
+	if(ofile->file_type != OFILE_FAT){
+	    error("internal error. check_fat() call and file type of: %s is "
+		  "not OFILE_FAT\n", ofile->file_name);
+	    return(CHECK_BAD);
+	}
+	if(ofile->fat_header->nfat_arch == 0){
+	    error("fat file: %s malformed (contains zero architecture types)",
+		  ofile->file_name);
+	    return(CHECK_BAD);
+	}
+	for(i = 0; i < ofile->fat_header->nfat_arch; i++){
+	    big_size = ofile->fat_archs[i].offset;
+	    big_size += ofile->fat_archs[i].size;
+	    if(big_size > ofile->file_size){
+		error("fat file: %s truncated or malformed (offset plus size "
+		      "of cputype (%d) cpusubtype (%d) extends past the "
+		      "end of the file)", ofile->file_name,
+		      ofile->fat_archs[i].cputype,
+		      ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK);
+		return(CHECK_BAD);
+	    }
+	    if(ofile->fat_archs[i].align > MAXSECTALIGN){
+		error("fat file: %s align (2^%u) too large for cputype (%d) "
+		      "cpusubtype (%d) (maximum 2^%d)", ofile->file_name,
+		      ofile->fat_archs[i].align, ofile->fat_archs[i].cputype,
+		      ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK,
+		      MAXSECTALIGN);
+		return(CHECK_BAD);
+	    }
+	    if(ofile->fat_archs[i].offset %
+	       (1 << ofile->fat_archs[i].align) != 0){
+		error("fat file: %s offset: %u for cputype (%d) cpusubtype "
+		      "(%d)) not aligned on it's alignment (2^%u)",
+		      ofile->file_name,
+		      ofile->fat_archs[i].offset,
+		      ofile->fat_archs[i].cputype,
+		      ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK,
+		      ofile->fat_archs[i].align);
+		return(CHECK_BAD);
+	    }
+	}
+	for(i = 0; i < ofile->fat_header->nfat_arch; i++){
+	    for(j = i + 1; j < ofile->fat_header->nfat_arch; j++){
+		if(ofile->fat_archs[i].cputype ==
+		     ofile->fat_archs[j].cputype &&
+		   (ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK) ==
+		     (ofile->fat_archs[j].cpusubtype & ~CPU_SUBTYPE_MASK)){
+		    error("fat file: %s contains two of the same "
+			  "architecture (cputype (%d) cpusubtype (%d))",
+			  ofile->file_name, ofile->fat_archs[i].cputype,
+			  ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK);
+		    return(CHECK_BAD);
+		}
+	    }
+	}
+	return(CHECK_GOOD);
+#endif /* OTOOL */
+}
+
+/*
+ * check_fat_object_in_archive() checks the fat object file which is a member
+ * of a thin archive for correctness (the fat_header and fat_archs are assumed
+ * to be in the host byte sex).  This is not a legal form but allowed when
+ * archives_with_fat_objects is TRUE when ofile_map() is called.
+ */
+static
+enum check_type
+check_fat_object_in_archive(
+struct ofile *ofile)
+{
+    uint32_t i, j;
+    uint32_t magic;
+
+	if(ofile->file_type != OFILE_ARCHIVE){
+	    error("internal error. check_fat_object_in_archive() called and "
+		  "file type of: %s is not OFILE_ARCHIVE\n", ofile->file_name);
+	    return(CHECK_BAD);
+	}
+	if(ofile->fat_header->nfat_arch == 0){
+	    archive_member_error(ofile, "fat file malformed (contains zero "
+				 "architecture types)");
+	    return(CHECK_BAD);
+	}
+	for(i = 0; i < ofile->fat_header->nfat_arch; i++){
+	    if(ofile->fat_archs[i].offset + ofile->fat_archs[i].size >
+	       ofile->member_size){
+		archive_member_error(ofile, "fat file truncated or malformed "
+			"(offset plus size of cputype (%d) cpusubtype (%d) "
+			"extends past the end of the file)", 
+		        ofile->fat_archs[i].cputype,
+		        ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK);
+		return(CHECK_BAD);
+	    }
+	    if(ofile->fat_archs[i].align > MAXSECTALIGN){
+		archive_member_error(ofile, "fat file's align (2^%u) too "
+			"large for cputype (%d) cpusubtype (%d) (maximum 2^%d)",
+			ofile->fat_archs[i].align, ofile->fat_archs[i].cputype,
+			ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK,
+			MAXSECTALIGN);
+		return(CHECK_BAD);
+	    }
+	    if(ofile->fat_archs[i].offset %
+	       (1 << ofile->fat_archs[i].align) != 0){
+		archive_member_error(ofile, "fat file's offset: %u for "
+			"cputype (%d) cpusubtype (%d) not aligned on it's "
+			"alignment (2^%u)", ofile->fat_archs[i].offset,
+			ofile->fat_archs[i].cputype,
+			ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK,
+			ofile->fat_archs[i].align);
+		return(CHECK_BAD);
+	    }
+
+	    /*
+	     * The only supported format where fat files are allowed to appear
+	     * in archives is when the fat file contains only object files.
+	     */
+	    if(ofile->fat_archs[i].size < sizeof(struct mach_header)){
+		archive_member_error(ofile, "fat file for cputype (%d) "
+			"cpusubtype (%d) is not an object file (size too small "
+			"to be an object file)", ofile->fat_archs[i].cputype,
+			ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK);
+		return(CHECK_BAD);
+	    }
+	    memcpy(&magic,
+		   ofile->file_addr + ofile->member_offset +
+			ofile->fat_archs[i].offset,
+		   sizeof(uint32_t));
+	    if(magic == MH_MAGIC || magic == SWAP_INT(MH_MAGIC)){
+#ifdef ALIGNMENT_CHECKS
+		if((ofile->member_offset + ofile->fat_archs[i].offset) %
+		   4 != 0){
+		    archive_member_error(ofile, "fat object file's offset in "
+			    "archive not a multiple of 4) (must be since "
+			    "member is a 32-bit object file)");
+		    return(CHECK_BAD);
+		}
+#endif /* ALIGNMENT_CHECKS */
+	    }
+	    else if(magic == MH_MAGIC_64 || magic == SWAP_INT(MH_MAGIC_64)){
+#ifdef ALIGNMENT_CHECKS_ARCHIVE_64_BIT
+		if(archive_64_bit_align_warning == FALSE &&
+		   (ofile->member_offset + ofile->fat_archs[i].offset) %
+		   8 != 0){
+		    temporary_archive_member_warning(ofile, "fat object file's "
+			"offset in archive not a multiple of 8) (must be since "
+			"member is a 64-bit object file)");
+		    archive_64_bit_align_warning = TRUE;
+		    /* return(CHECK_BAD); */
+		}
+#endif /* ALIGNMENT_CHECKS_ARCHIVE_64_BIT */
+	    }
+	    else{
+#ifdef LTO_SUPPORT
+	        if(is_llvm_bitcode(ofile, ofile->file_addr +
+		   ofile->member_offset + ofile->fat_archs[i].offset,
+		   ofile->fat_archs[i].size) == TRUE){
+#ifdef ALIGNMENT_CHECKS_ARCHIVE_64_BIT
+		    if(archive_64_bit_align_warning == FALSE &&
+		       (ofile->member_offset + ofile->fat_archs[i].offset) %
+		       8 != 0){
+			temporary_archive_member_warning(ofile, "fat object "
+			    "file's offset in archive not a multiple of 8) "
+			    "(must be since member is a 64-bit object file)");
+			archive_64_bit_align_warning = TRUE;
+			/* return(CHECK_BAD); */
+		    }
+#endif
+	        }
+		else
+#endif /* LTO_SUPPORT */
+		{
+		    archive_member_error(ofile, "fat file for cputype (%d) "
+			    "cpusubtype (%d) is not an object file (bad magic "
+			    "number)", ofile->fat_archs[i].cputype,
+			    ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK);
+		    return(CHECK_BAD);
+		}
+	    }
+	}
+	for(i = 0; i < ofile->fat_header->nfat_arch; i++){
+	    for(j = i + 1; j < ofile->fat_header->nfat_arch; j++){
+		if(ofile->fat_archs[i].cputype ==
+		     ofile->fat_archs[j].cputype &&
+		   (ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK) ==
+		     (ofile->fat_archs[j].cpusubtype & ~CPU_SUBTYPE_MASK)){
+		    archive_member_error(ofile, "fat file contains two of the "
+			"same architecture (cputype (%d) cpusubtype (%d))",
+			ofile->fat_archs[i].cputype,
+			ofile->fat_archs[i].cpusubtype & ~CPU_SUBTYPE_MASK);
+		    return(CHECK_BAD);
+		}
+	    }
+	}
+	return(CHECK_GOOD);
+}
+
+/*
+ * check_archive() checks the archive referenced in the ofile for correctness.
+ */
+static
+enum check_type
+check_archive(
+struct ofile *ofile,
+enum bool archives_with_fat_objects)
+{
+#ifdef OTOOL
+	return(CHECK_GOOD);
+#else /* !defined OTOOL */
+    char *addr;
+    uint64_t size, offset;
+    uint64_t big_size;
+    uint32_t magic;
+    enum byte_sex host_byte_sex;
+    enum bool swapped;
+    struct mach_header mh;
+    struct mach_header_64 mh64;
+    struct ar_hdr *ar_hdr;
+    uint32_t ar_name_size;
+
+	/*
+	 * Get the address and size of the archive (as well as the cputype and
+	 * cpusubtype if known) and make sure it is an archive.
+	 */
+	if(ofile->file_type == OFILE_FAT){
+	    addr = ofile->file_addr + ofile->fat_archs[ofile->narch].offset;
+	    size = ofile->fat_archs[ofile->narch].size;
+	    ofile->archive_cputype = ofile->fat_archs[ofile->narch].cputype;
+	    ofile->archive_cpusubtype =
+				     ofile->fat_archs[ofile->narch].cpusubtype;
+	}
+	else if(ofile->file_type == OFILE_ARCHIVE){
+	    addr = ofile->file_addr;
+	    size = ofile->file_size;
+	    ofile->archive_cputype = 0;
+	    ofile->archive_cpusubtype = 0;
+	}
+	else{
+	    error("internal error. check_archive() call and file type of %s is "
+		  "OFILE_UNKNOWN\n", ofile->file_name);
+	    return(CHECK_BAD);
+	}
+	if(size < SARMAG || strncmp(addr, ARMAG, SARMAG) != 0){
+	    error("internal error. check_archive() call for file %s which does "
+		  "not have an archive magic string", ofile->file_name);
+	    return(CHECK_BAD);
+	}
+
+	host_byte_sex = get_host_byte_sex();
+	/*
+	 * Check this archive out to make sure that it does not contain
+	 * any fat files and that all object files it contains have the
+	 * same cputype and subsubtype.
+	 */
+	offset = SARMAG;
+	if(offset == size)
+	    return(CHECK_GOOD);
+	if(offset != size && offset + sizeof(struct ar_hdr) > size){
+	    archive_error(ofile, "truncated or malformed (archive header of "
+			  "first member extends past the end of the file)");
+	    return(CHECK_BAD);
+	}
+	while(size > offset){
+	    ar_hdr = (struct ar_hdr *)(addr + offset);
+	    ofile->member_offset = offset;
+	    ofile->member_addr = addr + offset;
+	    ofile->member_size = strtoul(ar_hdr->ar_size, NULL, 10);
+	    ofile->member_ar_hdr = ar_hdr;
+	    ofile->member_name = ar_hdr->ar_name;
+	    ofile->member_name_size = size_ar_name(ofile->member_ar_hdr);
+	    offset += sizeof(struct ar_hdr);
+	    /*
+	     * See if this archive member is using extend format #1 where
+	     * the size of the name is in ar_name and the name follows the
+	     * archive header.
+	     */
+	    ar_name_size = 0;
+	    if(strncmp(ofile->member_name,AR_EFMT1, sizeof(AR_EFMT1) - 1) == 0){
+		if(check_extend_format_1(ofile, ar_hdr, size - offset,
+				&ar_name_size) == CHECK_BAD)
+		    return(CHECK_BAD);
+		ofile->member_name = ar_hdr->ar_name + sizeof(struct ar_hdr);
+		ofile->member_name_size = ar_name_size;
+		offset += ar_name_size;
+		ofile->member_offset += ar_name_size;
+		ofile->member_addr += ar_name_size;
+		ofile->member_size -= ar_name_size;
+	    }
+	    big_size = rnd(ofile->member_size, sizeof(short));
+	    big_size += offset;
+	    if(big_size > size){
+		archive_member_error(ofile, "size too large (archive "
+			      "member extends past the end of the file)");
+		return(CHECK_BAD);
+	    }
+	    if(size - offset > sizeof(uint32_t)){
+		memcpy(&magic, addr + offset, sizeof(uint32_t));
+#ifdef __BIG_ENDIAN__
+		if(magic == FAT_MAGIC)
+#endif /* __BIG_ENDIAN__ */
+#ifdef __LITTLE_ENDIAN__
+		if(magic == SWAP_INT(FAT_MAGIC))
+#endif /* __LITTLE_ENDIAN__ */
+		{
+		    if(archives_with_fat_objects == FALSE ||
+		       ofile->file_type != OFILE_ARCHIVE){
+			archive_member_error(ofile, "is a fat file (not "
+					     "allowed in an archive)");
+			return(CHECK_BAD);
+		    }
+		}
+		else{
+		    if(size - offset >= sizeof(struct mach_header) &&
+		       (magic == MH_MAGIC || magic == SWAP_INT(MH_MAGIC))){
+			memcpy(&mh, addr + offset, sizeof(struct mach_header));
+			if(magic == SWAP_INT(MH_MAGIC)){
+			    magic = MH_MAGIC;
+			    swapped = TRUE;
+			    swap_mach_header(&mh, host_byte_sex);
+			}
+			swapped = FALSE;
+		    }
+		    else if(size - offset >= sizeof(struct mach_header_64) &&
+		       (magic == MH_MAGIC_64 ||
+			magic == SWAP_INT(MH_MAGIC_64))){
+			memcpy(&mh64, addr + offset,
+			       sizeof(struct mach_header_64));
+			if(magic == SWAP_INT(MH_MAGIC_64)){
+			    magic = MH_MAGIC_64;
+			    swapped = TRUE;
+			    swap_mach_header_64(&mh64, host_byte_sex);
+			}
+			swapped = FALSE;
+		    }
+		    if(magic == MH_MAGIC){
+			if(ofile->archive_cputype == 0){
+			    ofile->archive_cputype = mh.cputype;
+			    ofile->archive_cpusubtype = mh.cpusubtype;
+			}
+			else if(ofile->archive_cputype != mh.cputype){
+			    archive_member_error(ofile, "cputype (%d) does not "
+				"match previous archive members cputype (%d) "
+				"(all members must match)", mh.cputype,
+				ofile->archive_cputype);
+			}
+		    }
+		    else if(magic == MH_MAGIC_64){
+			if(ofile->archive_cputype == 0){
+			    ofile->archive_cputype = mh64.cputype;
+			    ofile->archive_cpusubtype = mh64.cpusubtype;
+			}
+			else if(ofile->archive_cputype != mh64.cputype){
+			    archive_member_error(ofile, "cputype (%d) does not "
+				"match previous archive members cputype (%d) "
+				"(all members must match)", mh64.cputype,
+				ofile->archive_cputype);
+			}
+		    }
+		}
+	    }
+	    offset += rnd(ofile->member_size, sizeof(short));
+	}
+	ofile->member_offset = 0;
+	ofile->member_addr = NULL;
+	ofile->member_size = 0;
+	ofile->member_ar_hdr = NULL;;
+	ofile->member_name = NULL;
+	ofile->member_name_size = 0;
+	return(CHECK_GOOD);
+#endif /* OTOOL */
+}
+
+/*
+ * check_extend_format_1() checks the archive header for extended format #1.
+ */
+static
+enum check_type
+check_extend_format_1(
+struct ofile *ofile,
+struct ar_hdr *ar_hdr,
+uint32_t size_left,
+uint32_t *member_name_size)
+{
+    char *p, *endp, buf[sizeof(ar_hdr->ar_name)+1];
+    uint32_t ar_name_size;
+
+	*member_name_size = 0;
+
+	buf[sizeof(ar_hdr->ar_name)] = '\0';
+	memcpy(buf, ar_hdr->ar_name, sizeof(ar_hdr->ar_name));
+	p = buf + sizeof(AR_EFMT1) - 1;
+	if(isdigit(*p) == 0){
+	    archive_error(ofile, "malformed (ar_name: %.*s for archive "
+		"extend format #1 starts with non-digit)",
+		(int)sizeof(ar_hdr->ar_name), ar_hdr->ar_name);
+	    return(CHECK_BAD);
+	}
+	ar_name_size = strtoul(p, &endp, 10);
+	if(ar_name_size == UINT_MAX && errno == ERANGE){
+	    archive_error(ofile, "malformed (size in ar_name: %.*s for "
+		"archive extend format #1 overflows uint32_t)",
+		(int)sizeof(ar_hdr->ar_name), ar_hdr->ar_name);
+	    return(CHECK_BAD);
+	}
+	while(*endp == ' ' && *endp != '\0')
+	    endp++;
+	if(*endp != '\0'){
+	    archive_error(ofile, "malformed (size in ar_name: %.*s for "
+		"archive extend format #1 contains non-digit and "
+		"non-space characters)", (int)sizeof(ar_hdr->ar_name),
+		ar_hdr->ar_name);
+	    return(CHECK_BAD);
+	}
+	if(ar_name_size > size_left){
+	    archive_error(ofile, "truncated or malformed (archive name "
+		"of member extends past the end of the file)");
+	    return(CHECK_BAD);
+	}
+	*member_name_size = ar_name_size;
+	return(CHECK_GOOD);
+}
+
+/*
+ * check_archive_toc() checks the archive table of contents referenced in the
+ * thin archive via the ofile for correctness and if bad sets the bad_toc field
+ * in the ofile struct to TRUE.   If not it sets the other toc_* fields that
+ * ranlib(1) uses to know it can't update the table of contents and doesn't
+ * have to totally rebuild it.  And by this always returning CHECK_GOOD it
+ * allows otool(1) to print messed up tables of contents for debugging.
+ */
+static
+enum check_type
+check_archive_toc(
+struct ofile *ofile)
+{
+    uint32_t i, symdef_length, offset, nranlibs, strsize;
+    enum byte_sex host_byte_sex, toc_byte_sex;
+    struct ranlib *ranlibs;
+    char *strings;
+
+	ofile->toc_ranlibs = NULL;
+	ofile->toc_nranlibs = 0;
+	ofile->toc_strings = NULL;
+	ofile->toc_strsize = 0;
+
+	/*
+	 * Note this can only be called when the whole file is a thin archive.
+	 */
+	if(ofile->file_type != OFILE_ARCHIVE)
+	    return(CHECK_GOOD);
+
+	symdef_length = ofile->toc_size;
+	/*
+	 * The contents of a __.SYMDEF file is begins with a 32-bit word giving 
+	 * the size in bytes of ranlib structures which immediately follow, and
+	 * then continues with a string table consisting of a 32-bit word giving
+	 * the number of bytes of strings which follow and then the strings
+	 * themselves.  So the smallest valid size is two 32-bit words long.
+	 */
+	if(symdef_length < 2 * sizeof(uint32_t)){
+	    /*
+	     * Size of table of contents for archive too small to be a valid
+	     * table of contents.
+	     */
+	    ofile->toc_bad = TRUE;
+	    return(CHECK_GOOD);
+	}
+	host_byte_sex = get_host_byte_sex();
+	toc_byte_sex = get_toc_byte_sex(ofile->file_addr, ofile->file_size);
+	if(toc_byte_sex == UNKNOWN_BYTE_SEX){
+	    /*
+	     * Can't determine the byte order of table of contents as it
+	     * contains no Mach-O files.
+	     */
+	    ofile->toc_bad = TRUE;
+	    return(CHECK_GOOD);
+	}
+	offset = 0;
+	nranlibs = *((uint32_t *)(ofile->toc_addr + offset));
+	if(toc_byte_sex != host_byte_sex)
+	    nranlibs = SWAP_INT(nranlibs);
+	nranlibs = nranlibs / sizeof(struct ranlib);
+	offset += sizeof(uint32_t);
+	ranlibs = (struct ranlib *)(ofile->toc_addr + offset);
+	offset += sizeof(struct ranlib) * nranlibs;
+	if(nranlibs == 0)
+	    return(CHECK_GOOD);
+	if(offset - (2 * sizeof(uint32_t)) > symdef_length){
+	    /*
+	     * Truncated or malformed archive.  The ranlib structures in table
+	     * of contents extends past the end of the table of contents.
+	     */
+	    ofile->toc_bad = TRUE;
+	    return(CHECK_GOOD);
+	}
+	strsize = *((uint32_t *)(ofile->toc_addr + offset));
+	if(toc_byte_sex != host_byte_sex)
+	    strsize = SWAP_INT(strsize);
+	offset += sizeof(uint32_t);
+	strings = ofile->toc_addr + offset;
+	offset += strsize;
+	if(offset - (2 * sizeof(uint32_t)) > symdef_length){
+	    /*
+	     * Truncated or malformed archive.  The ranlib strings in table of
+	     * contents extends past the end of the table of contents.
+	     */
+	    ofile->toc_bad = TRUE;
+	    return(CHECK_GOOD);
+	}
+	if(symdef_length == 2 * sizeof(uint32_t))
+	    return(CHECK_GOOD);
+
+	/*
+	 * Check the string offset and the member offsets of the ranlib structs.
+	 */
+	if(toc_byte_sex != host_byte_sex)
+	    swap_ranlib(ranlibs, nranlibs, host_byte_sex);
+	for(i = 0; i < nranlibs; i++){
+	    if(ranlibs[i].ran_un.ran_strx >= strsize){
+		/*
+		 * Malformed table of contents.  The ranlib struct at this index
+		 * has a bad string index field.
+		 */
+		ofile->toc_bad = TRUE;
+		return(CHECK_GOOD);
+	    }
+	    if(ranlibs[i].ran_off >= ofile->file_size){
+		/*
+		 * Malformed table of contents.  The ranlib struct at this index
+		 * has a bad library member offset field.
+		 */
+		ofile->toc_bad = TRUE;
+		return(CHECK_GOOD);
+	    }
+	    /*
+	     * These should be on 4 byte boundaries because the maximum
+	     * alignment of the header structures and relocation are 4 bytes.
+	     * But this is has to be 2 bytes because that's the way ar(1) has
+	     * worked historicly in the past.  Fortunately this works on the
+	     * 68k machines but will have to change when this is on a real
+	     * machine.
+	     */
+#if defined(mc68000) || defined(__i386__)
+	    if(ranlibs[i].ran_off % sizeof(short) != 0){
+		/*
+		 * Malformed table of contents.  This ranlib struct library
+		 * member offset not a multiple 2 bytes.
+		 */
+		ofile->toc_bad = TRUE;
+		return(CHECK_GOOD);
+	    }
+#else
+	    if(ranlibs[i].ran_off % sizeof(uint32_t) != 0){
+		/*
+		 * Malformed table of contents.  This ranlib struct library
+	         * member offset not a multiple of 4 bytes.
+		 */
+		ofile->toc_bad = TRUE;
+		return(CHECK_GOOD);
+	    }
+#endif
+	}
+	ofile->toc_ranlibs = ranlibs;
+	ofile->toc_nranlibs = nranlibs;
+	ofile->toc_strings = strings;
+	ofile->toc_strsize = strsize;
+	return(CHECK_GOOD);
+}
+
+/*
+ * check_Mach_O() checks the object file's mach header and load commands
+ * referenced in the ofile for correctness (this also swaps the mach header
+ * and load commands into the host byte sex if needed).
+ */
+static
+enum check_type
+check_Mach_O(
+struct ofile *ofile)
+{
+#ifdef OTOOL
+	return(CHECK_GOOD);
+#else /* !defined OTOOL */
+    uint32_t size, i, j, ncmds, sizeofcmds, load_command_multiple, sizeofhdrs;
+    cpu_type_t cputype;
+    char *addr, *cmd_name, *element_name;
+    enum byte_sex host_byte_sex;
+    enum bool swapped;
+    struct mach_header *mh;
+    struct mach_header_64 *mh64;
+    struct load_command *load_commands, *lc, l;
+    struct segment_command *sg;
+    struct segment_command_64 *sg64;
+    struct section *s;
+    struct section_64 *s64;
+    struct symtab_command *st;
+    struct dysymtab_command *dyst;
+    struct symseg_command *ss;
+    struct fvmlib_command *fl;
+    struct dylib_command *dl;
+    struct sub_framework_command *sub;
+    struct sub_umbrella_command *usub;
+    struct sub_library_command *lsub;
+    struct sub_client_command *csub;
+    struct prebound_dylib_command *pbdylib;
+    struct dylinker_command *dyld;
+    struct thread_command *ut;
+    struct ident_command *id;
+    struct routines_command *rc;
+    struct routines_command_64 *rc64;
+    struct twolevel_hints_command *hints;
+    struct linkedit_data_command *code_sig, *split_info, *func_starts,
+			     *data_in_code, *code_sign_drs, *linkedit_data;
+    struct linkedit_data_command *link_opt_hint;
+    struct version_min_command *vers;
+    struct prebind_cksum_command *cs;
+    struct encryption_info_command *encrypt_info;
+    struct encryption_info_command_64 *encrypt_info64;
+    struct linker_option_command *lo;
+    struct dyld_info_command *dyld_info;
+    struct uuid_command *uuid;
+    struct rpath_command *rpath;
+    struct entry_point_command *ep;
+    struct source_version_command *sv;
+    uint32_t flavor, count, nflavor;
+    char *p, *state;
+    uint32_t sizeof_nlist, sizeof_dylib_module;
+    char *struct_dylib_module_name, *struct_nlist_name;
+    uint64_t big_size, big_end, big_load_end;
+    struct element elements;
+
+	elements.offset = 0;
+	elements.size = 0;
+	elements.name = NULL;
+	elements.next = NULL;
+
+	addr = ofile->object_addr;
+	size = ofile->object_size;
+	mh = ofile->mh;
+	mh64 = ofile->mh64;
+	load_commands = ofile->load_commands;
+	host_byte_sex = get_host_byte_sex();
+	swapped = (enum bool)(host_byte_sex != ofile->object_byte_sex);
+
+	if(ofile->mh != NULL){
+	    if(swapped)
+		swap_mach_header(mh, host_byte_sex);
+	    big_size = mh->sizeofcmds;
+	    big_size += sizeof(struct mach_header);
+	    if(big_size > size){
+		Mach_O_error(ofile, "truncated or malformed object (load "
+			     "commands extend past the end of the file)");
+		return(CHECK_BAD);
+	    }
+	    sizeofhdrs = big_size;
+	    ofile->mh_cputype = mh->cputype;
+	    ofile->mh_cpusubtype = mh->cpusubtype;
+	    ofile->mh_filetype = mh->filetype;
+	    ncmds = mh->ncmds;
+	    sizeofcmds = mh->sizeofcmds;
+	    cputype = mh->cputype;
+	    load_command_multiple = 4;
+	    sizeof_nlist = sizeof(struct nlist);
+	    struct_nlist_name = "struct nlist";
+	    sizeof_dylib_module = sizeof(struct dylib_module);
+	    struct_dylib_module_name = "struct dylib_module";
+	}
+	else{
+	    if(swapped)
+		swap_mach_header_64(mh64, host_byte_sex);
+	    big_size = mh64->sizeofcmds;
+	    big_size += sizeof(struct mach_header_64);
+	    if(big_size > size){
+		Mach_O_error(ofile, "truncated or malformed object (load "
+			     "commands extend past the end of the file)");
+		return(CHECK_BAD);
+	    }
+	    sizeofhdrs = big_size;
+	    ofile->mh_cputype = mh64->cputype;
+	    ofile->mh_cpusubtype = mh64->cpusubtype;
+	    ofile->mh_filetype = mh64->filetype;
+	    ncmds = mh64->ncmds;
+	    sizeofcmds = mh64->sizeofcmds;
+	    cputype = mh64->cputype;
+	    load_command_multiple = 8;
+	    sizeof_nlist = sizeof(struct nlist_64);
+	    struct_nlist_name = "struct nlist_64";
+	    sizeof_dylib_module = sizeof(struct dylib_module_64);
+	    struct_dylib_module_name = "struct dylib_module_64";
+	}
+	if(check_overlaping_element(ofile, &elements, 0, sizeofhdrs,
+		"Mach-O headers") == CHECK_BAD)
+	    goto return_bad;
+	if(ofile->file_type == OFILE_FAT){
+	    if(ofile->fat_archs[ofile->narch].cputype != ofile->mh_cputype){
+		Mach_O_error(ofile, "malformed fat file (fat header "
+		    "architecture: %u's cputype does not match "
+		    "object file's mach header)", ofile->narch);
+		goto return_bad;
+	    }
+	}
+	/*
+	 * Make a pass through the load commands checking them to the level
+	 * that they can be parsed and all fields with offsets and sizes do
+	 * not extend past the end of the file.
+	 */
+	st = NULL;
+	dyst = NULL;
+	rc = NULL;
+	rc64 = NULL;
+	hints = NULL;
+	code_sig = NULL;
+	func_starts = NULL;
+	data_in_code = NULL;
+	code_sign_drs = NULL;
+	link_opt_hint = NULL;
+	split_info = NULL;
+	cs = NULL;
+	uuid = NULL;
+	encrypt_info = NULL;
+	dyld_info = NULL;
+	vers = NULL;
+	big_load_end = 0;
+	for(i = 0, lc = load_commands; i < ncmds; i++){
+	    l = *lc;
+	    if(swapped)
+		swap_load_command(&l, host_byte_sex);
+	    /*
+	     * Check load command size for a multiple of load_command_multiple.
+	     */
+	    if(l.cmdsize % load_command_multiple != 0){
+		/*
+		 * We have a hack here to allow 64-bit Mach-O core files to
+		 * have LC_THREAD commands that are only a multiple of 4 and
+		 * not 8 to be allowed since the kernel produces them.
+		 */
+		if(ofile->mh64 == NULL ||
+		   ofile->mh64->filetype != MH_CORE ||
+		   l.cmd != LC_THREAD ||
+		   l.cmdsize % 4 != 0){
+		    Mach_O_error(ofile, "malformed object (load command %u "
+				 "cmdsize not a multiple of %u)", i,
+				 load_command_multiple);
+		    goto return_bad;
+		}
+	    }
+	    /* check that load command does not extends past end of commands */
+	    big_load_end += l.cmdsize;
+	    if(big_load_end > sizeofcmds){
+		Mach_O_error(ofile, "truncated or malformed object (load "
+			     "command %u extends past the end of the file)",i);
+		goto return_bad;
+	    }
+	    /* check that the load command size is not zero */
+	    if(l.cmdsize == 0){
+		Mach_O_error(ofile, "malformed object (load command %u cmdsize"
+			     " is zero)", i);
+		goto return_bad;
+	    }
+	    switch(l.cmd){
+	    case LC_SEGMENT:
+		if(l.cmdsize < sizeof(struct segment_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SEGMENT cmdsize "
+			         "too small) in command %u", i);
+		    goto return_bad;
+		}
+		sg = (struct segment_command *)lc;
+		if(swapped)
+		    swap_segment_command(sg, host_byte_sex);
+		big_size = sg->nsects;
+		big_size *= sizeof(struct section);
+		big_size += sizeof(struct segment_command);
+		if(sg->cmdsize != big_size){
+		    Mach_O_error(ofile, "malformed object (inconsistent "
+				 "cmdsize in LC_SEGMENT command %u for the "
+				 "number of sections)", i);
+		    goto return_bad;
+		}
+		if(sg->fileoff > size){
+		    Mach_O_error(ofile, "truncated or malformed object ("
+				 "LC_SEGMENT command %u fileoff field "
+				 "extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		big_size = sg->fileoff;
+		big_size += sg->filesize;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object ("
+				 "LC_SEGMENT command %u fileoff field "
+				 "plus filesize field extends past the end of "
+				 "the file)", i);
+		    goto return_bad;
+		}
+		if(sg->vmsize != 0 && sg->filesize > sg->vmsize){
+		    Mach_O_error(ofile, "malformed object (LC_SEGMENT command "
+				 "%u filesize field greater than vmsize field)",
+				 i);
+		    goto return_bad;
+		}
+		s = (struct section *)
+		    ((char *)sg + sizeof(struct segment_command));
+		if(swapped)
+		    swap_section(s, sg->nsects, host_byte_sex);
+		for(j = 0 ; j < sg->nsects ; j++){
+		    if(mh->filetype != MH_DYLIB_STUB &&
+		       mh->filetype != MH_DSYM &&
+		       s->flags != S_ZEROFILL &&
+		       s->flags != S_THREAD_LOCAL_ZEROFILL && s->offset > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+				"(offset field of section %u in LC_SEGMENT "
+				"command %u extends past the end of the file)",
+				j, i);
+			goto return_bad;
+		    }
+		    if(mh->filetype != MH_DYLIB_STUB &&
+		       mh->filetype != MH_DSYM &&
+		       s->flags != S_ZEROFILL &&
+		       s->flags != S_THREAD_LOCAL_ZEROFILL &&
+		       sg->fileoff == 0 && s->offset < sizeofhdrs &&
+		       s->size != 0){
+			Mach_O_error(ofile, "malformed object (offset field of "
+				"section %u in LC_SEGMENT command %u not "
+				"past the headers of the file)", j, i);
+			goto return_bad;
+		    }
+		    big_size = s->offset;
+		    big_size += s->size;
+		    if(mh->filetype != MH_DYLIB_STUB &&
+		       mh->filetype != MH_DSYM &&
+		       s->flags != S_ZEROFILL &&
+		       s->flags != S_THREAD_LOCAL_ZEROFILL && big_size > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+				"(offset field plus size field of section %u "
+				"in LC_SEGMENT command %u extends "
+				"past the end of the file)", j, i);
+			goto return_bad;
+		    }
+		    if(mh->filetype != MH_DYLIB_STUB &&
+		       mh->filetype != MH_DSYM &&
+		       s->flags != S_ZEROFILL &&
+		       s->flags != S_THREAD_LOCAL_ZEROFILL &&
+		       s->size > sg->filesize){
+			Mach_O_error(ofile, "malformed object (size field of "
+				"section %u in LC_SEGMENT command %u greater "
+				"than the segment)", j, i);
+			goto return_bad;
+		    }
+		    if(mh->filetype != MH_DYLIB_STUB &&
+		       mh->filetype != MH_DSYM &&
+		       s->size != 0 && s->addr < sg->vmaddr){
+			Mach_O_error(ofile, "malformed object (addr field of "
+				"section %u in LC_SEGMENT command %u less than "
+				"the segment's vmaddr)", j, i);
+			goto return_bad;
+		    }
+		    big_size = s->addr;
+		    big_size += s->size;
+		    big_end = sg->vmaddr;
+		    big_end += sg->vmsize;
+		    if(sg->vmsize != 0 && s->size != 0 && big_size > big_end){
+			Mach_O_error(ofile, "malformed object (addr field plus "
+				"size of section %u in LC_SEGMENT command %u "
+				"greater than than the segment's vmaddr plus "
+				"vmsize)", j, i);
+			goto return_bad;
+		    }
+		    if(mh->filetype != MH_DYLIB_STUB &&
+		       mh->filetype != MH_DSYM &&
+		       s->flags != S_ZEROFILL &&
+		       s->flags != S_THREAD_LOCAL_ZEROFILL &&
+		       check_overlaping_element(ofile, &elements, s->offset,
+			    s->size, "section contents") == CHECK_BAD)
+			goto return_bad;
+		    if(s->reloff > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+				"(reloff field of section %u in LC_SEGMENT "
+				"command %u extends past the end of the file)",
+				j, i);
+			goto return_bad;
+		    }
+		    big_size = s->nreloc;
+		    big_size *= sizeof(struct relocation_info);
+		    big_size += s->reloff;
+		    if(big_size > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+				"(reloff field plus nreloc field times sizeof("
+				"struct relocation_info) of section %u in "
+				"LC_SEGMENT command %u extends past the "
+				"end of the file)", j, i);
+			goto return_bad;
+		    }
+		    if(check_overlaping_element(ofile, &elements, s->reloff,
+			    s->nreloc * sizeof(struct relocation_info),
+			    "section relocation entries") == CHECK_BAD)
+			goto return_bad;
+		    s++;
+		}
+		break;
+
+	    case LC_SEGMENT_64:
+		if(l.cmdsize < sizeof(struct segment_command_64)){
+		    Mach_O_error(ofile, "malformed object (LC_SEGMENT_64 "
+				 "cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		sg64 = (struct segment_command_64 *)lc;
+		if(swapped)
+		    swap_segment_command_64(sg64, host_byte_sex);
+		big_size = sg64->nsects;
+		big_size *= sizeof(struct section_64);
+		big_size += sizeof(struct segment_command_64);
+		if(sg64->cmdsize != big_size){
+		    Mach_O_error(ofile, "malformed object (inconsistent "
+				 "cmdsize in LC_SEGMENT_64 command %u for "
+				 "the number of sections)", i);
+		    goto return_bad;
+		}
+		if(sg64->fileoff > size){
+		    Mach_O_error(ofile, "truncated or malformed object ("
+				 "LC_SEGMENT_64 command %u fileoff field "
+				 "extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		big_size = sg64->fileoff;
+		big_size += sg64->filesize;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object ("
+				 "LC_SEGMENT_64 command %u fileoff field "
+				 "plus filesize field extends past the end of "
+				 "the file)", i);
+		    goto return_bad;
+		}
+		s64 = (struct section_64 *)
+		    ((char *)sg64 + sizeof(struct segment_command_64));
+		if(swapped)
+		    swap_section_64(s64, sg64->nsects, host_byte_sex);
+		for(j = 0 ; j < sg64->nsects ; j++){
+		    if(mh64->filetype != MH_DYLIB_STUB &&
+		       mh64->filetype != MH_DSYM &&
+		       s64->flags != S_ZEROFILL &&
+		       s64->flags != S_THREAD_LOCAL_ZEROFILL &&
+		       s64->offset > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+				"(offset field of section %u in LC_SEGMENT_64 "
+				"command %u extends past the end of the file)",
+				j, i);
+			goto return_bad;
+		    }
+		    if(mh64->filetype != MH_DYLIB_STUB &&
+		       mh64->filetype != MH_DSYM &&
+		       s64->flags != S_ZEROFILL &&
+		       s64->flags != S_THREAD_LOCAL_ZEROFILL &&
+		       sg64->fileoff == 0 && s64->offset < sizeofhdrs &&
+		       s64->size != 0){
+			Mach_O_error(ofile, "malformed object (offset field of "
+				"section %u in LC_SEGMENT command %u not "
+				"past the headers of the file)", j, i);
+			goto return_bad;
+		    }
+		    big_size = s64->offset;
+		    big_size += s64->size;
+		    if(mh64->filetype != MH_DYLIB_STUB &&
+		       mh64->filetype != MH_DSYM &&
+		       s64->flags != S_ZEROFILL &&
+		       s64->flags != S_THREAD_LOCAL_ZEROFILL &&
+		       big_size > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+				"(offset field plus size field of section %u "
+				"in LC_SEGMENT_64 command %u extends "
+				"past the end of the file)", j, i);
+			goto return_bad;
+		    }
+		    if(mh64->filetype != MH_DYLIB_STUB &&
+		       mh64->filetype != MH_DSYM &&
+		       s64->flags != S_ZEROFILL &&
+		       s64->flags != S_THREAD_LOCAL_ZEROFILL &&
+		       check_overlaping_element(ofile, &elements, s64->offset,
+			    s64->size, "section contents") == CHECK_BAD)
+			goto return_bad;
+		    if(s64->reloff > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+				"(reloff field of section %u in LC_SEGMENT_64 "
+				"command %u extends past the end of the file)",
+				j, i);
+			goto return_bad;
+		    }
+		    big_size = s64->nreloc;
+		    big_size *= sizeof(struct relocation_info);
+		    big_size += s64->reloff;
+		    if(big_size > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+				"(reloff field plus nreloc field times sizeof("
+				"struct relocation_info) of section %u in "
+				"LC_SEGMENT_64 command %u extends past the "
+				"end of the file)", j, i);
+			goto return_bad;
+		    }
+		    if(check_overlaping_element(ofile, &elements, s64->reloff,
+			    s64->nreloc * sizeof(struct relocation_info),
+			    "section relocation entries") == CHECK_BAD)
+			goto return_bad;
+		    s64++;
+		}
+		break;
+
+	    case LC_SYMTAB:
+		if(l.cmdsize < sizeof(struct symtab_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SYMTAB cmdsize "
+			         "too small) in command %u", i);
+		    goto return_bad;
+		}
+		if(st != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"LC_SYMTAB command)");
+		    goto return_bad;
+		}
+		st = (struct symtab_command *)lc;
+		if(swapped)
+		    swap_symtab_command(st, host_byte_sex);
+		if(st->cmdsize != sizeof(struct symtab_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SYMTAB command "
+			"%u has incorrect cmdsize)", i);
+		    goto return_bad;
+		}
+		if(st->symoff > size){
+		    Mach_O_error(ofile, "truncated or malformed object (symoff "
+			"field of LC_SYMTAB command %u extends past the end "
+			"of the file)", i);
+		    goto return_bad;
+		}
+		big_size = st->nsyms;
+		big_size *= sizeof_nlist;
+		big_size += st->symoff;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object (symoff "
+			"field plus nsyms field times sizeof(%s) of LC_SYMTAB "
+			"command %u extends past the end of the file)",
+			struct_nlist_name, i);
+		    goto return_bad;
+		}
+		if(check_overlaping_element(ofile, &elements, st->symoff,
+			st->nsyms * sizeof_nlist, "symbol table") == CHECK_BAD)
+		    goto return_bad;
+		if(st->stroff > size){
+		    Mach_O_error(ofile, "truncated or malformed object (stroff "
+			"field of LC_SYMTAB command %u extends past the end "
+			"of the file)", i);
+		    goto return_bad;
+		}
+		big_size = st->stroff;
+		big_size += st->strsize;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object (stroff "
+			"field plus strsize field of LC_SYMTAB command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(check_overlaping_element(ofile, &elements, st->stroff,
+			st->strsize, "string table") == CHECK_BAD)
+		    goto return_bad;
+		break;
+
+	    case LC_DYSYMTAB:
+		if(l.cmdsize < sizeof(struct dysymtab_command)){
+		    Mach_O_error(ofile, "malformed object (LC_DYSYMTAB cmdsize "
+			         "too small) in command %u", i);
+		    goto return_bad;
+		}
+		if(dyst != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"LC_DYSYMTAB command)");
+		    goto return_bad;
+		}
+		dyst = (struct dysymtab_command *)lc;
+		if(swapped)
+		    swap_dysymtab_command(dyst, host_byte_sex);
+		if(dyst->cmdsize != sizeof(struct dysymtab_command)){
+		    Mach_O_error(ofile, "malformed object (LC_DYSYMTAB command "
+			"%u has incorrect cmdsize)", i);
+		    goto return_bad;
+		}
+		if(dyst->tocoff > size){
+		    Mach_O_error(ofile, "truncated or malformed object (tocoff "
+			"field of LC_DYSYMTAB command %u extends past the end "
+			"of the file)", i);
+		    goto return_bad;
+		}
+		big_size = dyst->ntoc;
+		big_size *= sizeof(struct dylib_table_of_contents);
+		big_size += dyst->tocoff;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object (tocoff "
+			"field plus ntoc field times sizeof(struct dylib_table"
+			"_of_contents) of LC_DYSYMTAB command %u extends past "
+			"the end of the file)", i);
+		    goto return_bad;
+		}
+		if(check_overlaping_element(ofile, &elements, dyst->tocoff,
+			dyst->ntoc * sizeof(struct dylib_table_of_contents),
+			"table of contents") == CHECK_BAD)
+		    goto return_bad;
+		if(dyst->modtaboff > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(modtaboff field of LC_DYSYMTAB command %u extends "
+			"past the end of the file)", i);
+		    goto return_bad;
+		}
+		big_size = dyst->nmodtab;
+		big_size *= sizeof_dylib_module;
+		big_size += dyst->modtaboff;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(modtaboff field plus nmodtab field times sizeof(%s) "
+			"of LC_DYSYMTAB command %u extends past the end of "
+			"the file)", struct_dylib_module_name, i);
+		    goto return_bad;
+		}
+		if(check_overlaping_element(ofile, &elements, dyst->modtaboff,
+			dyst->nmodtab * sizeof_dylib_module, "module table") == 
+			CHECK_BAD)
+		    goto return_bad;
+		if(dyst->extrefsymoff > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(extrefsymoff field of LC_DYSYMTAB command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		big_size = dyst->nextrefsyms;
+		big_size *= sizeof(struct dylib_reference);
+		big_size += dyst->extrefsymoff;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(extrefsymoff field plus nextrefsyms field times "
+			"sizeof(struct dylib_reference) of LC_DYSYMTAB command "
+			"%u extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(check_overlaping_element(ofile, &elements,dyst->extrefsymoff,
+			dyst->nextrefsyms * sizeof(struct dylib_reference),
+			"reference table") == CHECK_BAD)
+		    goto return_bad;
+		if(dyst->indirectsymoff > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(indirectsymoff field of LC_DYSYMTAB command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		big_size = dyst->nindirectsyms;
+		big_size *= sizeof(uint32_t);
+		big_size += dyst->indirectsymoff;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(indirectsymoff field plus nindirectsyms field times "
+			"sizeof(uint32_t) of LC_DYSYMTAB command "
+			"%u extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(check_overlaping_element(ofile, &elements,
+			dyst->indirectsymoff, dyst->nindirectsyms *
+			sizeof(uint32_t), "indirect table") == CHECK_BAD)
+		    goto return_bad;
+		if(dyst->extreloff > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(extreloff field of LC_DYSYMTAB command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		big_size = dyst->nextrel;
+		big_size *= sizeof(struct relocation_info);
+		big_size += dyst->extreloff;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(extreloff field plus nextrel field times "
+			"sizeof(struct relocation_info) of LC_DYSYMTAB command "
+			"%u extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(check_overlaping_element(ofile, &elements, dyst->extreloff,
+			dyst->nextrel * sizeof(struct relocation_info),
+			"external relocation table") == CHECK_BAD)
+		    goto return_bad;
+		if(dyst->locreloff > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(locreloff field of LC_DYSYMTAB command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		big_size = dyst->nlocrel;
+		big_size *= sizeof(struct relocation_info);
+		big_size += dyst->locreloff;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(locreloff field plus nlocrel field times "
+			"sizeof(struct relocation_info) of LC_DYSYMTAB command "
+			"%u extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(check_overlaping_element(ofile, &elements, dyst->locreloff,
+			dyst->nlocrel * sizeof(struct relocation_info),
+			"local relocation table") == CHECK_BAD)
+		    goto return_bad;
+		break;
+
+	    case LC_ROUTINES:
+		if(l.cmdsize < sizeof(struct routines_command)){
+		    Mach_O_error(ofile, "malformed object (LC_ROUTINES cmdsize "
+			         "too small) in command %u", i);
+		    goto return_bad;
+		}
+		if(rc != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"LC_ROUTINES command)");
+		    goto return_bad;
+		}
+		rc = (struct routines_command *)lc;
+		if(swapped)
+		    swap_routines_command(rc, host_byte_sex);
+		if(rc->cmdsize != sizeof(struct routines_command)){
+		    Mach_O_error(ofile, "malformed object (LC_ROUTINES "
+			"command %u has incorrect cmdsize)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_ROUTINES_64:
+		if(l.cmdsize < sizeof(struct routines_command_64)){
+		    Mach_O_error(ofile, "malformed object (LC_ROUTINES_64 "
+				 "cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		if(rc64 != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"LC_ROUTINES_64 command)");
+		    goto return_bad;
+		}
+		rc64 = (struct routines_command_64 *)lc;
+		if(swapped)
+		    swap_routines_command_64(rc64, host_byte_sex);
+		if(rc64->cmdsize != sizeof(struct routines_command_64)){
+		    Mach_O_error(ofile, "malformed object (LC_ROUTINES_64 "
+			"command %u has incorrect cmdsize)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_TWOLEVEL_HINTS:
+		if(l.cmdsize < sizeof(struct twolevel_hints_command)){
+		    Mach_O_error(ofile, "malformed object (LC_TWOLEVEL_HINTS "
+				 "cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		if(hints != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"LC_TWOLEVEL_HINTS command)");
+		    goto return_bad;
+		}
+		hints = (struct twolevel_hints_command *)lc;
+		if(swapped)
+		    swap_twolevel_hints_command(hints, host_byte_sex);
+		if(hints->cmdsize != sizeof(struct twolevel_hints_command)){
+		    Mach_O_error(ofile, "malformed object (LC_TWOLEVEL_HINTS "
+			         "command %u has incorrect cmdsize)", i);
+		    goto return_bad;
+		}
+		if(hints->offset > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(offset field of LC_TWOLEVEL_HINTS command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		big_size = hints->nhints;
+		big_size *= sizeof(struct twolevel_hint);
+		big_size += hints->offset;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(offset field plus nhints field times "
+			"sizeof(struct twolevel_hint) of LC_TWOLEVEL_HINTS "
+			" command %u extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(check_overlaping_element(ofile, &elements, hints->offset,
+			hints->nhints * sizeof(struct twolevel_hint),
+			"two level hints") == CHECK_BAD)
+		    goto return_bad;
+		break;
+
+	    case LC_SEGMENT_SPLIT_INFO:
+		cmd_name = "LC_SEGMENT_SPLIT_INFO";
+		element_name = "split info data";
+		if(split_info != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"%s command)", cmd_name);
+		    goto return_bad;
+		}
+		split_info = (struct linkedit_data_command *)lc;
+		goto check_linkedit_data_command;
+
+	    case LC_CODE_SIGNATURE:
+		cmd_name = "LC_CODE_SIGNATURE";
+		element_name = "code signature data";
+		if(code_sig != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"%s command)", cmd_name);
+		    goto return_bad;
+		}
+		code_sig = (struct linkedit_data_command *)lc;
+		goto check_linkedit_data_command;
+
+	    case LC_FUNCTION_STARTS:
+		cmd_name = "LC_FUNCTION_STARTS";
+		element_name = "function starts data";
+		if(func_starts != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"%s command)", cmd_name);
+		    goto return_bad;
+		}
+		func_starts = (struct linkedit_data_command *)lc;
+		goto check_linkedit_data_command;
+
+	    case LC_DATA_IN_CODE:
+		cmd_name = "LC_DATA_IN_CODE";
+		element_name = "date in code info";
+		if(data_in_code != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"%s command)", cmd_name);
+		    goto return_bad;
+		}
+		data_in_code = (struct linkedit_data_command *)lc;
+		goto check_linkedit_data_command;
+
+	    case LC_DYLIB_CODE_SIGN_DRS:
+		cmd_name = "LC_DYLIB_CODE_SIGN_DRS";
+		element_name = "code signing RDs data";
+		if(code_sign_drs != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"%s command)", cmd_name);
+		    goto return_bad;
+		}
+		code_sign_drs = (struct linkedit_data_command *)lc;
+		goto check_linkedit_data_command;
+
+	    case LC_LINKER_OPTIMIZATION_HINT:
+		cmd_name = "LC_LINKER_OPTIMIZATION_HINT";
+		element_name = "linker optimization hint";
+		if(link_opt_hint != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"%s command)", cmd_name);
+		    goto return_bad;
+		}
+		link_opt_hint = (struct linkedit_data_command *)lc;
+		goto check_linkedit_data_command;
+
+check_linkedit_data_command:
+		if(l.cmdsize < sizeof(struct linkedit_data_command)){
+		    Mach_O_error(ofile, "malformed object (%s cmdsize too "
+				 "small) in command %u", cmd_name, i);
+		    goto return_bad;
+		}
+		linkedit_data = (struct linkedit_data_command *)lc;
+		if(swapped)
+		    swap_linkedit_data_command(linkedit_data, host_byte_sex);
+		if(linkedit_data->cmdsize !=
+		   sizeof(struct linkedit_data_command)){
+		    Mach_O_error(ofile, "malformed object (%s command %u has "
+				 "incorrect cmdsize)", cmd_name, i);
+		    goto return_bad;
+		}
+		if(linkedit_data->dataoff > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(dataoff field of %s command %u extends past the end "
+			"of the file)", cmd_name, i);
+		    goto return_bad;
+		}
+		big_size = linkedit_data->dataoff;
+		big_size += linkedit_data->datasize;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(dataoff field plus datasize field of "
+			"%s command %u extends past the end of "
+			"the file)", cmd_name, i);
+		    goto return_bad;
+		}
+		if(check_overlaping_element(ofile, &elements,
+			linkedit_data->dataoff, linkedit_data->datasize,
+			element_name) == CHECK_BAD)
+		    goto return_bad;
+		break;
+
+	    case LC_VERSION_MIN_MACOSX:
+		if(l.cmdsize < sizeof(struct version_min_command)){
+		    Mach_O_error(ofile, "malformed object (LC_VERSION_MIN_"
+				 "MACOSX cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		if(vers != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"LC_VERSION_MIN_IPHONEOS or LC_VERSION_MIN_MACOSX "
+			"command)");
+		    goto return_bad;
+		}
+		vers = (struct version_min_command *)lc;
+		if(swapped)
+		    swap_version_min_command(vers, host_byte_sex);
+		if(vers->cmdsize < sizeof(struct version_min_command)){
+		    Mach_O_error(ofile, "malformed object (LC_VERSION_MIN_"
+			"MACOSX command %u has too small cmdsize field)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_VERSION_MIN_IPHONEOS:
+		if(l.cmdsize < sizeof(struct version_min_command)){
+		    Mach_O_error(ofile, "malformed object (LC_VERSION_MIN_"
+				 "IPHONEOS cmdsize too small) in command %u",i);
+		    goto return_bad;
+		}
+		if(vers != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"LC_VERSION_MIN_IPHONEOS or LC_VERSION_MIN_MACOSX "
+			"command)");
+		    goto return_bad;
+		}
+		vers = (struct version_min_command *)lc;
+		if(swapped)
+		    swap_version_min_command(vers, host_byte_sex);
+		if(vers->cmdsize < sizeof(struct version_min_command)){
+		    Mach_O_error(ofile, "malformed object (LC_VERSION_MIN_"
+			"IPHONEOS command %u has too small cmdsize field)", i);
+		    goto return_bad;
+		}
+		break;
+
+
+	    case LC_VERSION_MIN_WATCHOS:
+		if(l.cmdsize < sizeof(struct version_min_command)){
+		    Mach_O_error(ofile, "malformed object (LC_VERSION_MIN_"
+				 "WATCHOS cmdsize too small) in command %u",i);
+		    goto return_bad;
+		}
+		if(vers != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"LC_VERSION_MIN_IPHONEOS, LC_VERSION_MIN_MACOSX or "
+			"LC_VERSION_MIN_WATCHOS command)");
+		    goto return_bad;
+		}
+		vers = (struct version_min_command *)lc;
+		if(swapped)
+		    swap_version_min_command(vers, host_byte_sex);
+		if(vers->cmdsize < sizeof(struct version_min_command)){
+		    Mach_O_error(ofile, "malformed object (LC_VERSION_MIN_"
+			"WATCHOS command %u has too small cmdsize field)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_ENCRYPTION_INFO:
+		if(l.cmdsize < sizeof(struct encryption_info_command)){
+		    Mach_O_error(ofile, "malformed object (LC_ENCRYPTION_INFO "
+				 "cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		encrypt_info = (struct encryption_info_command *)lc;
+		if(swapped) 
+		    swap_encryption_command(encrypt_info, host_byte_sex);
+		if(encrypt_info->cmdsize !=
+		   sizeof(struct encryption_info_command)){
+		    Mach_O_error(ofile, "malformed object (LC_ENCRYPTION_INFO"
+				 "command %u has incorrect cmdsize)", i);
+		    goto return_bad;
+		}
+		if(encrypt_info->cryptoff > size){
+		Mach_O_error(ofile, "truncated or malformed object (cryptoff "
+			     "field of LC_ENCRYPTION_INFO command %u extends "
+			     "past the end of the file)", i);
+		    goto return_bad;
+		}
+		big_size = encrypt_info->cryptoff;
+		big_size += encrypt_info->cryptsize;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+				 "(cryptoff field plus cryptsize field of "
+				 "LC_ENCRYPTION_INFO command %u extends past "
+				 "the end of the file)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_ENCRYPTION_INFO_64:
+		if(l.cmdsize < sizeof(struct encryption_info_command_64)){
+		    Mach_O_error(ofile, "malformed object (LC_ENCRYPTION_INFO"
+			         "_64 cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		encrypt_info64 = (struct encryption_info_command_64 *)lc;
+		if(swapped) 
+		    swap_encryption_command_64(encrypt_info64, host_byte_sex);
+		if(encrypt_info64->cmdsize !=
+		   sizeof(struct encryption_info_command_64)){
+		    Mach_O_error(ofile, "malformed object (LC_ENCRYPTION_INFO"
+				 "_64 command %u has incorrect cmdsize)", i);
+		    goto return_bad;
+		}
+		if(encrypt_info64->cryptoff > size){
+		Mach_O_error(ofile, "truncated or malformed object (cryptoff "
+			     "field of LC_ENCRYPTION_INFO_64 command %u extends"
+			     " past the end of the file)", i);
+		    goto return_bad;
+		}
+		big_size = encrypt_info64->cryptoff;
+		big_size += encrypt_info64->cryptsize;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+				 "(cryptoff field plus cryptsize field of "
+				 "LC_ENCRYPTION_INFO_64 command %u extends past"
+				 " the end of the file)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_LINKER_OPTION:
+		if(l.cmdsize < sizeof(struct linker_option_command)){
+		    Mach_O_error(ofile, "malformed object (LC_LINKER_OPTION "
+			         "cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		lo = (struct linker_option_command *)lc;
+		if(swapped) 
+		    swap_linker_option_command(lo, host_byte_sex);
+		if(lo->cmdsize <
+		   sizeof(struct linker_option_command)){
+		    Mach_O_error(ofile, "malformed object (LC_LINKER_OPTION "
+				 " command %u cmdsize too small)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_DYLD_INFO:
+	    case LC_DYLD_INFO_ONLY:
+		if(l.cmdsize < sizeof(struct dyld_info_command)){
+		    Mach_O_error(ofile, "malformed object (%s cmdsize "
+			         "too small) in command %u", l.cmd ==
+				 LC_DYLD_INFO ? "LC_DYLD_INFO" :
+				 "LC_DYLD_INFO_ONLY", i);
+		    goto return_bad;
+		}
+		dyld_info = (struct dyld_info_command *)lc;
+		if(swapped) 
+		    swap_dyld_info_command(dyld_info, host_byte_sex);
+		if(dyld_info->cmdsize !=
+		   sizeof(struct dyld_info_command)){
+		    Mach_O_error(ofile, "malformed object (LC_DYLD_INFO"
+				 "command %u has incorrect cmdsize)", i);
+		    goto return_bad;
+		}
+		if(dyld_info->rebase_off != 0 && dyld_info->rebase_off > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(rebase_off field of LC_DYLD_INFO command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(dyld_info->rebase_off != 0){
+		    big_size = dyld_info->rebase_off;
+		    big_size += dyld_info->rebase_size;
+		    if(big_size > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+			    "(rebase_off plus rebase_size of LC_DYLD_INFO "
+			    "command %u extends past the end of the file)", i);
+			goto return_bad;
+		    }
+		}
+		if(check_overlaping_element(ofile, &elements,
+			dyld_info->rebase_off, dyld_info->rebase_size,
+			"dyld rebase info") == CHECK_BAD)
+		    goto return_bad;
+		if(dyld_info->bind_off != 0 && dyld_info->bind_off > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(bind_off field of LC_DYLD_INFO command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(dyld_info->bind_off != 0){
+		    big_size = dyld_info->bind_off;
+		    big_size += dyld_info->bind_size;
+		    if(big_size > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+			    "(bind_off plus bind_size of LC_DYLD_INFO command "
+			    "%u extends past the end of the file)", i);
+			goto return_bad;
+		    }
+		}
+		if(check_overlaping_element(ofile, &elements,
+			dyld_info->bind_off, dyld_info->bind_size,
+			"dyld bind info") == CHECK_BAD)
+		    goto return_bad;
+		if(dyld_info->weak_bind_off != 0 &&
+		   dyld_info->weak_bind_off > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(weak_bind_off field of LC_DYLD_INFO command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(dyld_info->weak_bind_off != 0){
+		    big_size = dyld_info->weak_bind_off;
+		    big_size += dyld_info->weak_bind_size;
+		    if(big_size > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+			    "(weak_bind_off plus weak_bind_size of LC_DYLD_INFO"
+			    " command %u extends past the end of the file)", i);
+			goto return_bad;
+		    }
+		}
+		if(check_overlaping_element(ofile, &elements,
+			dyld_info->weak_bind_off, dyld_info->weak_bind_size,
+			"dyld bind info") == CHECK_BAD)
+		    goto return_bad;
+		if(dyld_info->lazy_bind_off != 0 &&
+		   dyld_info->lazy_bind_off > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(lazy_bind_off field of LC_DYLD_INFO command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(dyld_info->lazy_bind_off != 0){
+		    big_size = dyld_info->lazy_bind_off;
+		    big_size += dyld_info->lazy_bind_size;
+		    if(big_size > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+			    "(lazy_bind_off plus lazy_bind_size of LC_DYLD_INFO"
+			    " command %u extends past the end of the file)", i);
+			goto return_bad;
+		    }
+		}
+		if(check_overlaping_element(ofile, &elements,
+			dyld_info->lazy_bind_off, dyld_info->lazy_bind_size,
+			"dyld lazy bind info") == CHECK_BAD)
+		    goto return_bad;
+		if(dyld_info->export_off != 0 && dyld_info->export_off > size){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(export_off field of LC_DYLD_INFO command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(dyld_info->export_off != 0){
+		    big_size = dyld_info->export_off;
+		    big_size += dyld_info->export_size;
+		    if(big_size > size){
+			Mach_O_error(ofile, "truncated or malformed object "
+			    "(export_off plus export_size of LC_DYLD_INFO "
+			    "command %u extends past the end of the file)", i);
+			goto return_bad;
+		    }
+		}
+		if(check_overlaping_element(ofile, &elements,
+			dyld_info->export_off, dyld_info->export_size,
+			"dyld export info") == CHECK_BAD)
+		    goto return_bad;
+		break;
+		
+
+
+	    case LC_PREBIND_CKSUM:
+		if(l.cmdsize < sizeof(struct prebind_cksum_command)){
+		    Mach_O_error(ofile, "malformed object (LC_PREBIND_CKSUM "
+				 "cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		if(cs != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"LC_PREBIND_CKSUM command)");
+		    goto return_bad;
+		}
+		cs = (struct prebind_cksum_command *)lc;
+		if(swapped)
+		    swap_prebind_cksum_command(cs, host_byte_sex);
+		if(cs->cmdsize != sizeof(struct prebind_cksum_command)){
+		    Mach_O_error(ofile, "malformed object (LC_PREBIND_CKSUM "
+			"command %u has incorrect cmdsize)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_UUID:
+		if(l.cmdsize < sizeof(struct uuid_command)){
+		    Mach_O_error(ofile, "malformed object (LC_UUID cmdsize "
+			         "too small) in command %u", i);
+		    goto return_bad;
+		}
+		if(uuid != NULL){
+		    Mach_O_error(ofile, "malformed object (more than one "
+			"LC_UUID command)");
+		    goto return_bad;
+		}
+		uuid = (struct uuid_command *)lc;
+		if(swapped)
+		    swap_uuid_command(uuid, host_byte_sex);
+		if(uuid->cmdsize != sizeof(struct uuid_command)){
+		    Mach_O_error(ofile, "malformed object (LC_UUID command %u "			"has incorrect cmdsize)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_SYMSEG:
+		if(l.cmdsize < sizeof(struct symseg_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SYMSEG cmdsize "
+			         "too small) in command %u", i);
+		    goto return_bad;
+		}
+		ss = (struct symseg_command *)lc;
+		if(swapped)
+		    swap_symseg_command(ss, host_byte_sex);
+		if(ss->cmdsize != sizeof(struct symseg_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SYMSEG command "
+			"%u has incorrect cmdsize)", i);
+		    goto return_bad;
+		}
+		if(ss->offset > size){
+		    Mach_O_error(ofile, "truncated or malformed object (offset "
+			"field of LC_SYMSEG command %u extends past the end "
+			"of the file)", i);
+		    goto return_bad;
+		}
+		big_size = ss->offset;
+		big_size += ss->size;
+		if(big_size > size){
+		    Mach_O_error(ofile, "truncated or malformed object (offset "
+			"field plus size field of LC_SYMTAB command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(check_overlaping_element(ofile, &elements, ss->offset,
+			ss->size, "symseg info") == CHECK_BAD)
+		    goto return_bad;
+		break;
+
+	    case LC_IDFVMLIB:
+	    case LC_LOADFVMLIB:
+		if(l.cmdsize < sizeof(struct fvmlib_command)){
+		    Mach_O_error(ofile, "malformed object (%s cmdsize "
+			         "too small) in command %u", l.cmd ==
+				 LC_IDFVMLIB ? "LC_IDFVMLIB" :
+				 "LC_LOADFVMLIB", i);
+		    goto return_bad;
+		}
+		fl = (struct fvmlib_command *)lc;
+		if(swapped)
+		    swap_fvmlib_command(fl, host_byte_sex);
+		if(fl->cmdsize < sizeof(struct fvmlib_command)){
+		    Mach_O_error(ofile, "malformed object (%s command %u has "
+			"too small cmdsize field)", fl->cmd == LC_IDFVMLIB ? 
+			"LC_IDFVMLIB" : "LC_LOADFVMLIB", i);
+		    goto return_bad;
+		}
+		if(fl->fvmlib.name.offset >= fl->cmdsize){
+		    Mach_O_error(ofile, "truncated or malformed object (name."
+			"offset field of %s command %u extends past the end "
+			"of the file)", fl->cmd == LC_IDFVMLIB ? "LC_IDFVMLIB"
+			: "LC_LOADFVMLIB", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_ID_DYLIB:
+		cmd_name = "LC_ID_DYLIB";
+		goto check_dylib_command;
+	    case LC_LOAD_DYLIB:
+		cmd_name = "LC_LOAD_DYLIB";
+		goto check_dylib_command;
+	    case LC_LOAD_WEAK_DYLIB:
+		cmd_name = "LC_LOAD_WEAK_DYLIB";
+		goto check_dylib_command;
+	    case LC_REEXPORT_DYLIB:
+		cmd_name = "LC_REEXPORT_DYLIB";
+		goto check_dylib_command;
+	    case LC_LOAD_UPWARD_DYLIB:
+		cmd_name = "LC_LOAD_UPWARD_DYLIB";
+		goto check_dylib_command;
+	    case LC_LAZY_LOAD_DYLIB:
+		cmd_name = "LC_LAZY_LOAD_DYLIB";
+		goto check_dylib_command;
+check_dylib_command:
+		if(l.cmdsize < sizeof(struct dylib_command)){
+		    Mach_O_error(ofile, "malformed object (%s cmdsize too "
+				 "small) in command %u", cmd_name, i);
+		    goto return_bad;
+		}
+		dl = (struct dylib_command *)lc;
+		if(swapped)
+		    swap_dylib_command(dl, host_byte_sex);
+		if(dl->cmdsize < sizeof(struct dylib_command)){
+		    Mach_O_error(ofile, "malformed object (%s command %u has "
+			"too small cmdsize field)", cmd_name, i);
+		    goto return_bad;
+		}
+		if(dl->dylib.name.offset >= dl->cmdsize){
+		    Mach_O_error(ofile, "truncated or malformed object (name."
+			"offset field of %s command %u extends past the end "
+			"of the file)", cmd_name, i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_SUB_FRAMEWORK:
+		if(l.cmdsize < sizeof(struct sub_framework_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SUB_FRAMEWORK "
+				 "cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		sub = (struct sub_framework_command *)lc;
+		if(swapped)
+		    swap_sub_framework_command(sub, host_byte_sex);
+		if(sub->cmdsize < sizeof(struct sub_framework_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SUB_FRAMEWORK "
+			"command %u has too small cmdsize field)", i);
+		    goto return_bad;
+		}
+		if(sub->umbrella.offset >= sub->cmdsize){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(umbrella.offset field of LC_SUB_FRAMEWORK command "
+			"%u extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_SUB_UMBRELLA:
+		if(l.cmdsize < sizeof(struct sub_umbrella_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SUB_UMBRELLA "
+				 "cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		usub = (struct sub_umbrella_command *)lc;
+		if(swapped)
+		    swap_sub_umbrella_command(usub, host_byte_sex);
+		if(usub->cmdsize < sizeof(struct sub_umbrella_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SUB_UMBRELLA "
+			"command %u has too small cmdsize field)", i);
+		    goto return_bad;
+		}
+		if(usub->sub_umbrella.offset >= usub->cmdsize){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(sub_umbrella.offset field of LC_SUB_UMBRELLA command "
+			"%u extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_SUB_LIBRARY:
+		if(l.cmdsize < sizeof(struct sub_library_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SUB_LIBRARY "
+				 "cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		lsub = (struct sub_library_command *)lc;
+		if(swapped)
+		    swap_sub_library_command(lsub, host_byte_sex);
+		if(lsub->cmdsize < sizeof(struct sub_library_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SUB_LIBRARY "
+			"command %u has too small cmdsize field)", i);
+		    goto return_bad;
+		}
+		if(lsub->sub_library.offset >= lsub->cmdsize){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(sub_library.offset field of LC_SUB_LIBRARY command "
+			"%u extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_SUB_CLIENT:
+		if(l.cmdsize < sizeof(struct sub_client_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SUB_CLIENT "
+				 "cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		csub = (struct sub_client_command *)lc;
+		if(swapped)
+		    swap_sub_client_command(csub, host_byte_sex);
+		if(csub->cmdsize < sizeof(struct sub_client_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SUB_CLIENT "
+			"command %u has too small cmdsize field)", i);
+		    goto return_bad;
+		}
+		if(csub->client.offset >= csub->cmdsize){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(cleient.offset field of LC_SUB_CLIENT command "
+			"%u extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_PREBOUND_DYLIB:
+		if(l.cmdsize < sizeof(struct prebound_dylib_command)){
+		    Mach_O_error(ofile, "malformed object (LC_PREBOUND_DYLIB "
+				 "cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		pbdylib = (struct prebound_dylib_command *)lc;
+		if(swapped)
+		    swap_prebound_dylib_command(pbdylib, host_byte_sex);
+		if(pbdylib->cmdsize < sizeof(struct dylib_command)){
+		    Mach_O_error(ofile, "malformed object (LC_PREBIND_DYLIB "
+			"command %u has too small cmdsize field)", i);
+		    goto return_bad;
+		}
+		if(pbdylib->name.offset >= pbdylib->cmdsize){
+		    Mach_O_error(ofile, "truncated or malformed object (name."
+			"offset field of LC_PREBIND_DYLIB command %u extends "
+			"past the end of the file)", i);
+		    goto return_bad;
+		}
+		if(pbdylib->linked_modules.offset >= pbdylib->cmdsize){
+		    Mach_O_error(ofile, "truncated or malformed object (linked_"
+			"modules.offset field of LC_PREBIND_DYLIB command %u "
+			"extends past the end of the file)", i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_ID_DYLINKER:
+		cmd_name = "LC_ID_DYLINKER";
+		goto check_dylinker_command;
+	    case LC_LOAD_DYLINKER:
+		cmd_name = "LC_LOAD_DYLINKER";
+		goto check_dylinker_command;
+	    case LC_DYLD_ENVIRONMENT:
+		cmd_name = "LC_DYLD_ENVIRONMENT";
+		goto check_dylinker_command;
+check_dylinker_command:
+		if(l.cmdsize < sizeof(struct dylinker_command)){
+		    Mach_O_error(ofile, "malformed object (%s cmdsize "
+			         "too small) in command %u", cmd_name, i);
+		    goto return_bad;
+		}
+		dyld = (struct dylinker_command *)lc;
+		if(swapped)
+		    swap_dylinker_command(dyld, host_byte_sex);
+		if(dyld->cmdsize < sizeof(struct dylinker_command)){
+		    Mach_O_error(ofile, "malformed object (%s command %u has "
+			"too small cmdsize field)", cmd_name, i);
+		    goto return_bad;
+		}
+		if(dyld->name.offset >= dyld->cmdsize){
+		    Mach_O_error(ofile, "truncated or malformed object (name."
+			"offset field of %s command %u extends past the end "
+			"of the file)", cmd_name, i);
+		    goto return_bad;
+		}
+		break;
+
+	    case LC_UNIXTHREAD:
+	    case LC_THREAD:
+		if(l.cmdsize < sizeof(struct thread_command)){
+		    Mach_O_error(ofile, "malformed object (%s cmdsize "
+			         "too small) in command %u", l.cmd ==
+				 LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				 "LC_THREAD", i);
+		    goto return_bad;
+		}
+		ut = (struct thread_command *)lc;
+		if(swapped)
+		    swap_thread_command(ut, host_byte_sex);
+		state = (char *)ut + sizeof(struct thread_command);
+
+	    	if(cputype == CPU_TYPE_MC680x0){
+		    struct m68k_thread_state_regs *cpu;
+		    struct m68k_thread_state_68882 *fpu;
+		    struct m68k_thread_state_user_reg *user_reg;
+
+		    nflavor = 0;
+		    p = (char *)ut + ut->cmdsize;
+		    while(state < p){
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (flavor in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			flavor = *((uint32_t *)state);
+			if(swapped){
+			    flavor = SWAP_INT(flavor);
+			    *((uint32_t *)state) = flavor;
+			}
+			state += sizeof(uint32_t);
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (count in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			count = *((uint32_t *)state);
+			if(swapped){
+			    count = SWAP_INT(count);
+			    *((uint32_t *)state) = count;
+			}
+			state += sizeof(uint32_t);
+			switch(flavor){
+			case M68K_THREAD_STATE_REGS:
+			    if(count != M68K_THREAD_STATE_REGS_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not M68K_THREAD_STATE_REGS_COUNT for "
+				    "flavor number %u which is a M68K_THREAD_"
+				    "STATE_REGS flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    cpu = (struct m68k_thread_state_regs *)state;
+			    if(state + sizeof(struct m68k_thread_state_regs) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "M68K_THREAD_STATE_REGS in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_m68k_thread_state_regs(cpu, host_byte_sex);
+			    state += sizeof(struct m68k_thread_state_regs);
+			    break;
+			case M68K_THREAD_STATE_68882:
+			    if(count != M68K_THREAD_STATE_68882_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not M68K_THREAD_STATE_68882_COUNT for "
+				    "flavor number %u which is a M68K_THREAD_"
+				    "STATE_68882 flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    fpu = (struct m68k_thread_state_68882 *)state;
+			    if(state + sizeof(struct m68k_thread_state_68882) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "M68K_THREAD_STATE_68882 in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_m68k_thread_state_68882(fpu,host_byte_sex);
+			    state += sizeof(struct m68k_thread_state_68882);
+			    break;
+			case M68K_THREAD_STATE_USER_REG:
+			    if(count != M68K_THREAD_STATE_USER_REG_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not M68K_THREAD_STATE_USER_REG_COUNT for "
+				    "flavor number %u which is a M68K_THREAD_"
+				    "STATE_USER_REG flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    user_reg =
+				(struct m68k_thread_state_user_reg *)state;
+			    if(state+sizeof(struct m68k_thread_state_user_reg) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "M68K_THREAD_STATE_USER_REG in %s command "
+				    "%u extends past end of command)", ut->cmd==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_m68k_thread_state_user_reg(user_reg,
+								host_byte_sex);
+			    state += sizeof(struct m68k_thread_state_user_reg);
+			    break;
+			default:
+			    if(swapped){
+				Mach_O_error(ofile, "malformed object (unknown "
+				    "flavor for flavor number %u in %s command"
+				    " %u can't byte swap it)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    state += count * sizeof(uint32_t);
+			    break;
+			}
+			nflavor++;
+		    }
+		    break;
+		}
+	    	if(cputype == CPU_TYPE_POWERPC ||
+	    	   cputype == CPU_TYPE_VEO){
+		    ppc_thread_state_t *nrw_cpu;
+
+		    nflavor = 0;
+		    p = (char *)ut + ut->cmdsize;
+		    while(state < p){
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (flavor in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			flavor = *((uint32_t *)state);
+			if(swapped){
+			    flavor = SWAP_INT(flavor);
+			    *((uint32_t *)state) = flavor;
+			}
+			state += sizeof(uint32_t);
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (count in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			count = *((uint32_t *)state);
+			if(swapped){
+			    count = SWAP_INT(count);
+			    *((uint32_t *)state) = count;
+			}
+			state += sizeof(uint32_t);
+			switch(flavor){
+			case PPC_THREAD_STATE:
+			    if(count != PPC_THREAD_STATE_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not PPC_THREAD_STATE_COUNT for "
+				    "flavor number %u which is a PPC_THREAD_"
+				    "STATE flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    nrw_cpu = (ppc_thread_state_t *)state;
+			    if(state + sizeof(ppc_thread_state_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "PPC_THREAD_STATE in %s command %u extends"
+				    " past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_ppc_thread_state_t(nrw_cpu,
+							     host_byte_sex);
+			    state += sizeof(ppc_thread_state_t);
+			    break;
+			default:
+			    if(swapped){
+				Mach_O_error(ofile, "malformed object (unknown "
+				    "flavor for flavor number %u in %s command"
+				    " %u can't byte swap it)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    state += count * sizeof(uint32_t);
+			    break;
+			}
+			nflavor++;
+		    }
+		    break;
+		}
+#ifdef PPC_THREAD_STATE64_COUNT
+	    	if(cputype == CPU_TYPE_POWERPC64){
+		    ppc_thread_state64_t *cpu;
+
+		    nflavor = 0;
+		    p = (char *)ut + ut->cmdsize;
+		    while(state < p){
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (flavor in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			flavor = *((uint32_t *)state);
+			if(swapped){
+			    flavor = SWAP_INT(flavor);
+			    *((uint32_t *)state) = flavor;
+			}
+			state += sizeof(uint32_t);
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (count in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			count = *((uint32_t *)state);
+			if(swapped){
+			    count = SWAP_INT(count);
+			    *((uint32_t *)state) = count;
+			}
+			state += sizeof(uint32_t);
+			switch(flavor){
+			case PPC_THREAD_STATE64:
+			    if(count != PPC_THREAD_STATE64_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not PPC_THREAD_STATE64_COUNT for "
+				    "flavor number %u which is a PPC_THREAD_"
+				    "STATE64 flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    cpu = (ppc_thread_state64_t *)state;
+			    if(state + sizeof(ppc_thread_state64_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "PPC_THREAD_STATE64 in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_ppc_thread_state64_t(cpu, host_byte_sex);
+			    state += sizeof(ppc_thread_state64_t);
+			    break;
+			default:
+			    if(swapped){
+				Mach_O_error(ofile, "malformed object (unknown "
+				    "flavor for flavor number %u in %s command"
+				    " %u can't byte swap it)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    state += count * sizeof(uint32_t);
+			    break;
+			}
+			nflavor++;
+		    }
+		    break;
+		}
+#endif /* PPC_THREAD_STATE64_COUNT */
+	    	if(cputype == CPU_TYPE_MC88000){
+		    m88k_thread_state_grf_t *cpu;
+		    m88k_thread_state_xrf_t *fpu;
+		    m88k_thread_state_user_t *user;
+		    m88110_thread_state_impl_t *spu;
+
+		    nflavor = 0;
+		    p = (char *)ut + ut->cmdsize;
+		    while(state < p){
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (flavor in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			flavor = *((uint32_t *)state);
+			if(swapped){
+			    flavor = SWAP_INT(flavor);
+			    *((uint32_t *)state) = flavor;
+			}
+			state += sizeof(uint32_t);
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (count in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			count = *((uint32_t *)state);
+			if(swapped){
+			    count = SWAP_INT(count);
+			    *((uint32_t *)state) = count;
+			}
+			state += sizeof(uint32_t);
+			switch(flavor){
+			case M88K_THREAD_STATE_GRF:
+			    if(count != M88K_THREAD_STATE_GRF_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not M88K_THREAD_STATE_GRF_COUNT for "
+				    "flavor number %u which is a M88K_THREAD_"
+				    "STATE_GRF flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    cpu = (m88k_thread_state_grf_t *)state;
+			    if(state + sizeof(m88k_thread_state_grf_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "M88K_THREAD_STATE_GRF in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_m88k_thread_state_grf_t(cpu,
+							     host_byte_sex);
+			    state += sizeof(m88k_thread_state_grf_t);
+			    break;
+			case M88K_THREAD_STATE_XRF:
+			    if(count != M88K_THREAD_STATE_XRF_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not M88K_THREAD_STATE_XRF_COUNT for "
+				    "flavor number %u which is a M88K_THREAD_"
+				    "STATE_XRF flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    fpu = (m88k_thread_state_xrf_t *)state;
+			    if(state + sizeof(m88k_thread_state_xrf_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "M88K_THREAD_STATE_XRF in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_m88k_thread_state_xrf_t(fpu,
+							     host_byte_sex);
+			    state += sizeof(m88k_thread_state_xrf_t);
+			    break;
+			case M88K_THREAD_STATE_USER:
+			    if(count != M88K_THREAD_STATE_USER_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not M88K_THREAD_STATE_USER_COUNT for "
+				    "flavor number %u which is a M88K_THREAD_"
+				    "STATE_USER flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    user = (m88k_thread_state_user_t *)state;
+			    if(state + sizeof(m88k_thread_state_user_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "M88K_THREAD_STATE_USER in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_m88k_thread_state_user_t(user,
+							      host_byte_sex);
+			    state += sizeof(m88k_thread_state_user_t);
+			    break;
+			case M88110_THREAD_STATE_IMPL:
+			    if(count != M88110_THREAD_STATE_IMPL_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not M88110_THREAD_STATE_IMPL_COUNT for "
+				    "flavor number %u which is a M88110_THREAD"
+				    "_STATE_IMPL flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    spu = (m88110_thread_state_impl_t *)state;
+			    if(state + sizeof(m88110_thread_state_impl_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "M88110_THREAD_STATE_IMPL in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_m88110_thread_state_impl_t(spu,
+							      host_byte_sex);
+			    state += sizeof(m88110_thread_state_impl_t);
+			    break;
+			default:
+			    if(swapped){
+				Mach_O_error(ofile, "malformed object (unknown "
+				    "flavor for flavor number %u in %s command"
+				    " %u can't byte swap it)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    state += count * sizeof(uint32_t);
+			    break;
+			}
+			nflavor++;
+		    }
+		    break;
+		}
+	    	if(cputype == CPU_TYPE_I860){
+#ifdef m68k
+		    struct i860_thread_state_regs *cpu;
+#endif
+
+		    nflavor = 0;
+		    p = (char *)ut + ut->cmdsize;
+		    while(state < p){
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (flavor in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			flavor = *((uint32_t *)state);
+			if(swapped){
+			    flavor = SWAP_INT(flavor);
+			    *((uint32_t *)state) = flavor;
+			}
+			state += sizeof(uint32_t);
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (count in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    return(CHECK_BAD);
+			}
+			count = *((uint32_t *)state);
+			if(swapped){
+			    count = SWAP_INT(count);
+			    *((uint32_t *)state) = count;
+			}
+			state += sizeof(uint32_t);
+			switch(flavor){
+			case I860_THREAD_STATE_REGS:
+#ifdef m68k
+			    if(count != I860_THREAD_STATE_REGS_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not I860_THREAD_STATE_REGS_COUNT for "
+				    "flavor number %u which is a I860_THREAD_"
+				    "STATE_REGS flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    cpu = (struct i860_thread_state_regs *)state;
+			    if(state + sizeof(struct i860_thread_state_regs) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "I860_THREAD_STATE_REGS in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_i860_thread_state_regs(cpu, host_byte_sex);
+			    state += sizeof(struct i860_thread_state_regs);
+#else
+			    state += count * sizeof(int);
+#endif
+			    break;
+			default:
+			    if(swapped){
+				Mach_O_error(ofile, "malformed object (unknown "
+				    "flavor for flavor number %u in %s command"
+				    " %u can't byte swap it)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    state += count * sizeof(uint32_t);
+			    break;
+			}
+			nflavor++;
+		    }
+		    break;
+		}
+	    	if(cputype == CPU_TYPE_I386){
+		    i386_thread_state_t *cpu;
+/* current i386 thread states */
+#if i386_THREAD_STATE == 1
+		    struct i386_float_state *fpu;
+		    i386_exception_state_t *exc;
+#endif /* i386_THREAD_STATE == 1 */
+
+/* i386 thread states on older releases */
+#if i386_THREAD_STATE == -1
+		    i386_thread_fpstate_t *fpu;
+		    i386_thread_exceptstate_t *exc;
+		    i386_thread_cthreadstate_t *user;
+#endif /* i386_THREAD_STATE == -1 */
+
+		    nflavor = 0;
+		    p = (char *)ut + ut->cmdsize;
+		    while(state < p){
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (flavor in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			flavor = *((uint32_t *)state);
+			if(swapped){
+			    flavor = SWAP_INT(flavor);
+			    *((uint32_t *)state) = flavor;
+			}
+			state += sizeof(uint32_t);
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (count in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			count = *((uint32_t *)state);
+			if(swapped){
+			    count = SWAP_INT(count);
+			    *((uint32_t *)state) = count;
+			}
+			state += sizeof(uint32_t);
+			switch((int)flavor){
+			case i386_THREAD_STATE:
+#if i386_THREAD_STATE == 1
+			case -1:
+#endif /* i386_THREAD_STATE == 1 */
+/* i386 thread states on older releases */
+#if i386_THREAD_STATE == -1
+			case 1:
+#endif /* i386_THREAD_STATE == -1 */
+			    if(count != i386_THREAD_STATE_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not i386_THREAD_STATE_COUNT for flavor "
+				    "number %u which is a i386_THREAD_STATE "
+				    "flavor in %s command %u)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    cpu = (i386_thread_state_t *)state;
+			    if(state + sizeof(i386_thread_state_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "i386_THREAD_STATE in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_i386_thread_state(cpu, host_byte_sex);
+			    state += sizeof(i386_thread_state_t);
+			    break;
+/* current i386 thread states */
+#if i386_THREAD_STATE == 1
+			case i386_FLOAT_STATE:
+			    if(count != i386_FLOAT_STATE_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not i386_FLOAT_STATE_COUNT for flavor "
+				    "number %u which is a i386_FLOAT_STATE "
+				    "flavor in %s command %u)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    fpu = (struct i386_float_state *)state;
+			    if(state + sizeof(struct i386_float_state) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "i386_FLOAT_STATE in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_i386_float_state(fpu, host_byte_sex);
+			    state += sizeof(struct i386_float_state);
+			    break;
+			case i386_EXCEPTION_STATE:
+			    if(count != I386_EXCEPTION_STATE_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not I386_EXCEPTION_STATE_COUNT for "
+				    "flavor number %u which is a i386_"
+				    "EXCEPTION_STATE flavor in %s command %u)",
+				    nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    exc = (i386_exception_state_t *)state;
+			    if(state + sizeof(i386_exception_state_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "i386_EXCEPTION_STATE in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_i386_exception_state(exc,host_byte_sex);
+			    state += sizeof(i386_exception_state_t);
+			    break;
+#endif /* i386_THREAD_STATE == 1 */
+
+/* i386 thread states on older releases */
+#if i386_THREAD_STATE == -1
+			case i386_THREAD_FPSTATE:
+			    if(count != i386_THREAD_FPSTATE_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not i386_THREAD_FPSTATE_COUNT for flavor "
+				    "number %u which is a i386_THREAD_FPSTATE "
+				    "flavor in %s command %u)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    fpu = (i386_thread_fpstate_t *)state;
+			    if(state + sizeof(i386_thread_fpstate_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "i386_THREAD_FPSTATE in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_i386_thread_fpstate(fpu, host_byte_sex);
+			    state += sizeof(i386_thread_fpstate_t);
+			    break;
+			case i386_THREAD_EXCEPTSTATE:
+			    if(count != i386_THREAD_EXCEPTSTATE_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not i386_THREAD_EXCEPTSTATE_COUNT for "
+				    "flavor number %u which is a i386_THREAD_"
+				    "EXCEPTSTATE flavor in %s command %u)",
+				    nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    exc = (i386_thread_exceptstate_t *)state;
+			    if(state + sizeof(i386_thread_exceptstate_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "i386_THREAD_EXCEPTSTATE in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_i386_thread_exceptstate(exc,host_byte_sex);
+			    state += sizeof(i386_thread_exceptstate_t);
+			    break;
+			case i386_THREAD_CTHREADSTATE:
+			    if(count != i386_THREAD_CTHREADSTATE_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not i386_THREAD_CTHREADSTATE_COUNT for "
+				    "flavor number %u which is a i386_THREAD_"
+				    "CTHREADSTATE flavor in %s command %u)",
+				    nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    user = (i386_thread_cthreadstate_t *)state;
+			    if(state + sizeof(i386_thread_cthreadstate_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "i386_THREAD_CTHREADSTATE in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_i386_thread_cthreadstate(user,
+							      host_byte_sex);
+			    state += sizeof(i386_thread_cthreadstate_t);
+			    break;
+#endif /* i386_THREAD_STATE == -1 */
+			default:
+			    if(swapped){
+				Mach_O_error(ofile, "malformed object (unknown "
+				    "flavor for flavor number %u in %s command"
+				    " %u can't byte swap it)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    state += count * sizeof(uint32_t);
+			    break;
+			}
+			nflavor++;
+		    }
+		    break;
+		}
+#ifdef x86_THREAD_STATE64_COUNT
+	    	if(cputype == CPU_TYPE_X86_64){
+		    x86_thread_state64_t *cpu;
+
+		    nflavor = 0;
+		    p = (char *)ut + ut->cmdsize;
+		    while(state < p){
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (flavor in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			flavor = *((uint32_t *)state);
+			if(swapped){
+			    flavor = SWAP_INT(flavor);
+			    *((uint32_t *)state) = flavor;
+			}
+			state += sizeof(uint32_t);
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (count in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			count = *((uint32_t *)state);
+			if(swapped){
+			    count = SWAP_INT(count);
+			    *((uint32_t *)state) = count;
+			}
+			state += sizeof(uint32_t);
+			switch(flavor){
+			case x86_THREAD_STATE64:
+			    if(count != x86_THREAD_STATE64_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not x86_THREAD_STATE64_COUNT for "
+				    "flavor number %u which is a x86_THREAD_"
+				    "STATE64 flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    cpu = (x86_thread_state64_t *)state;
+			    if(state + sizeof(x86_thread_state64_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "x86_THREAD_STATE64 in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_x86_thread_state64(cpu, host_byte_sex);
+			    state += sizeof(x86_thread_state64_t);
+			    break;
+			default:
+			    if(swapped){
+				Mach_O_error(ofile, "malformed object (unknown "
+				    "flavor for flavor number %u in %s command"
+				    " %u can't byte swap it)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    state += count * sizeof(uint32_t);
+			    break;
+			}
+			nflavor++;
+		    }
+		    break;
+		}
+#endif /* x86_THREAD_STATE64_COUNT */
+	    	if(cputype == CPU_TYPE_HPPA){
+		    struct hp_pa_integer_thread_state *cpu;
+		    struct hp_pa_frame_thread_state *frame;
+		    struct hp_pa_fp_thread_state *fpu;
+
+		    nflavor = 0;
+		    p = (char *)ut + ut->cmdsize;
+		    while(state < p){
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (flavor in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			flavor = *((uint32_t *)state);
+			if(swapped){
+			    flavor = SWAP_INT(flavor);
+			    *((uint32_t *)state) = flavor;
+			}
+			state += sizeof(uint32_t);
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (count in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			count = *((uint32_t *)state);
+			if(swapped){
+			    count = SWAP_INT(count);
+			    *((uint32_t *)state) = count;
+			}
+			state += sizeof(uint32_t);
+			switch(flavor){
+			case HPPA_INTEGER_THREAD_STATE:
+			    if(count != HPPA_INTEGER_THREAD_STATE_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not HPPA_INTEGER_THREAD_STATE_COUNT for "
+				    "flavor number %u which is a "
+				    "HPPA_INTEGER_THREAD_STATE "
+				    "flavor in %s command %u)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    cpu = (struct hp_pa_integer_thread_state *)state;
+			    if(state+sizeof(struct hp_pa_integer_thread_state) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "HPPA_INTEGER_THREAD_STATE in %s command "
+				    "%u extends past end of command)",
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_hppa_integer_thread_state(cpu,
+							       host_byte_sex);
+			    state += sizeof(struct hp_pa_integer_thread_state);
+			    break;
+			case HPPA_FRAME_THREAD_STATE:
+			    if(count != HPPA_FRAME_THREAD_STATE_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not HPPA_FRAME_THREAD_STATE_COUNT for "
+				    "flavor number %u which is a HPPA_FRAME_"
+				    "THREAD_STATE flavor in %s command %u)",
+				    nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    frame = (struct hp_pa_frame_thread_state *)state;
+			    if(state + sizeof(struct hp_pa_frame_thread_state) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "HPPA_FRAME_THREAD_STATE in %s command "
+				    "%u extends past end of command)",
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_hppa_frame_thread_state(frame,host_byte_sex);
+			    state += sizeof(struct hp_pa_frame_thread_state);
+			    break;
+			case HPPA_FP_THREAD_STATE:
+			    if(count != HPPA_FP_THREAD_STATE_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not HPPA_FP_THREAD_STATE_COUNT for "
+				    "flavor number %u which is a HPPA_FP_"
+				    "THREAD_STATE flavor in %s command %u)",
+				    nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    fpu = (struct hp_pa_fp_thread_state *)state;
+			    if(state + sizeof(struct hp_pa_fp_thread_state) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "HPPA_FP_THREAD_STATE in %s command "
+				    "%u extends past end of command)",
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_hppa_fp_thread_state(fpu,host_byte_sex);
+			    state += sizeof(struct hp_pa_fp_thread_state);
+			    break;
+			default:
+			    if(swapped){
+				Mach_O_error(ofile, "malformed object (unknown "
+				    "flavor for flavor number %u in %s command"
+				    " %u can't byte swap it)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    state += count * sizeof(uint32_t);
+			    break;
+			}
+			nflavor++;
+		    }
+		    break;
+		}
+	    	if(cputype == CPU_TYPE_SPARC){
+		    struct sparc_thread_state_regs *cpu;
+		    struct sparc_thread_state_fpu *fpu;
+
+		    nflavor = 0;
+		    p = (char *)ut + ut->cmdsize;
+		    while(state < p){
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (flavor in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			flavor = *((uint32_t *)state);
+			if(swapped){
+			    flavor = SWAP_INT(flavor);
+			    *((uint32_t *)state) = flavor;
+			}
+			state += sizeof(uint32_t);
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (count in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			count = *((uint32_t *)state);
+			if(swapped){
+			    count = SWAP_INT(count);
+			    *((uint32_t *)state) = count;
+			}
+			state += sizeof(uint32_t);
+			switch(flavor){
+			case SPARC_THREAD_STATE_REGS:
+			    if(count != SPARC_THREAD_STATE_REGS_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not SPARC_THREAD_STATE_REGS_COUNT for "
+				    "flavor number %u which is a SPARC_THREAD_"
+				    "STATE_REGS flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    cpu = (struct sparc_thread_state_regs *)state;
+			    if(state + sizeof(struct sparc_thread_state_regs) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "SPARC_THREAD_STATE_REGS in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_sparc_thread_state_regs(cpu, host_byte_sex);
+			    state += sizeof(struct sparc_thread_state_regs);
+			    break;
+			  case SPARC_THREAD_STATE_FPU:
+			    if(count != SPARC_THREAD_STATE_FPU_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not SPARC_THREAD_STATE_FPU_COUNT for "
+				    "flavor number %u which is a SPARC_THREAD_"
+				    "STATE_FPU flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    fpu = (struct sparc_thread_state_fpu *)state;
+			    if(state + sizeof(struct sparc_thread_state_fpu) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "SPARC_THREAD_STATE_FPU in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_sparc_thread_state_fpu(fpu, host_byte_sex);
+			    state += sizeof(struct sparc_thread_state_fpu);
+			    break;
+			default:
+			    if(swapped){
+				Mach_O_error(ofile, "malformed object (unknown "
+				    "flavor for flavor number %u in %s command"
+				    " %u can't byte swap it)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    state += count * sizeof(uint32_t);
+			    break;
+			}
+			nflavor++;
+		    }
+		    break;
+		}
+	    	if(cputype == CPU_TYPE_ARM){
+		    arm_thread_state_t *cpu;
+
+		    nflavor = 0;
+		    p = (char *)ut + ut->cmdsize;
+		    while(state < p){
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (flavor in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			flavor = *((uint32_t *)state);
+			if(swapped){
+			    flavor = SWAP_INT(flavor);
+			    *((uint32_t *)state) = flavor;
+			}
+			state += sizeof(uint32_t);
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (count in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			count = *((uint32_t *)state);
+			if(swapped){
+			    count = SWAP_INT(count);
+			    *((uint32_t *)state) = count;
+			}
+			state += sizeof(uint32_t);
+			switch(flavor){
+			case ARM_THREAD_STATE:
+			    if(count != ARM_THREAD_STATE_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not ARM_THREAD_STATE_COUNT for "
+				    "flavor number %u which is a ARM_THREAD_"
+				    "STATE flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    cpu = (arm_thread_state_t *)state;
+			    if(state + sizeof(arm_thread_state_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "ARM_THREAD_STATE in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_arm_thread_state_t(cpu, host_byte_sex);
+			    state += sizeof(arm_thread_state_t);
+			    break;
+			default:
+			    if(swapped){
+				Mach_O_error(ofile, "malformed object (unknown "
+				    "flavor for flavor number %u in %s command"
+				    " %u can't byte swap it)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    state += count * sizeof(uint32_t);
+			    break;
+			}
+			nflavor++;
+		    }
+		    break;
+		}
+	    	if(cputype == CPU_TYPE_ARM64){
+		    arm_thread_state64_t *cpu;
+
+		    nflavor = 0;
+		    p = (char *)ut + ut->cmdsize;
+		    while(state < p){
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (flavor in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			flavor = *((uint32_t *)state);
+			if(swapped){
+			    flavor = SWAP_INT(flavor);
+			    *((uint32_t *)state) = flavor;
+			}
+			state += sizeof(uint32_t);
+			if(state +  sizeof(uint32_t) >
+			   (char *)ut + ut->cmdsize){
+			    Mach_O_error(ofile, "malformed object (count in "
+				"%s command %u extends past end of command)",
+				ut->cmd == LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				"LC_THREAD", i);
+			    goto return_bad;
+			}
+			count = *((uint32_t *)state);
+			if(swapped){
+			    count = SWAP_INT(count);
+			    *((uint32_t *)state) = count;
+			}
+			state += sizeof(uint32_t);
+			switch(flavor){
+			case ARM_THREAD_STATE64:
+			    if(count != ARM_THREAD_STATE64_COUNT){
+				Mach_O_error(ofile, "malformed object (count "
+				    "not ARM_THREAD_STATE64_COUNT for "
+				    "flavor number %u which is a ARM_THREAD_"
+				    "STATE64 flavor in %s command %u)",
+				    nflavor, ut->cmd == LC_UNIXTHREAD ? 
+				    "LC_UNIXTHREAD" : "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    cpu = (arm_thread_state64_t *)state;
+			    if(state + sizeof(arm_thread_state64_t) >
+			       (char *)ut + ut->cmdsize){
+				Mach_O_error(ofile, "malformed object ("
+				    "ARM_THREAD_STATE64 in %s command %u "
+				    "extends past end of command)", ut->cmd ==
+				    LC_UNIXTHREAD ?  "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    if(swapped)
+				swap_arm_thread_state64_t(cpu, host_byte_sex);
+			    state += sizeof(arm_thread_state64_t);
+			    break;
+			default:
+			    if(swapped){
+				Mach_O_error(ofile, "malformed object (unknown "
+				    "flavor for flavor number %u in %s command"
+				    " %u can't byte swap it)", nflavor,
+				    ut->cmd == LC_UNIXTHREAD ? "LC_UNIXTHREAD" :
+				    "LC_THREAD", i);
+				goto return_bad;
+			    }
+			    state += count * sizeof(uint32_t);
+			    break;
+			}
+			nflavor++;
+		    }
+		    break;
+		}
+		if(swapped){
+		    Mach_O_error(ofile, "malformed object (unknown cputype and "
+			"cpusubtype of object and can't byte swap and check %s "
+			"command %u)", ut->cmd == LC_UNIXTHREAD ?
+			"LC_UNIXTHREAD" : "LC_THREAD", i);
+		    goto return_bad;
+		}
+		break;
+	    case LC_MAIN:
+		if(l.cmdsize < sizeof(struct entry_point_command)){
+		    Mach_O_error(ofile, "malformed object (LC_MAIN cmdsize "
+			         "too small) in command %u", i);
+		    goto return_bad;
+		}
+		ep = (struct entry_point_command *)lc;
+		if(swapped)
+		    swap_entry_point_command(ep, host_byte_sex);
+		/*
+		 * If we really wanted we could check that the entryoff field
+		 * really is an offset into the __TEXT segment.  But since it
+		 * is not used here, we won't needlessly check it.
+		 */
+		break;
+	    case LC_SOURCE_VERSION:
+		if(l.cmdsize < sizeof(struct source_version_command)){
+		    Mach_O_error(ofile, "malformed object (LC_SOURCE_VERSION "
+				 "cmdsize too small) in command %u", i);
+		    goto return_bad;
+		}
+		sv = (struct source_version_command *)lc;
+		if(swapped)
+		    swap_source_version_command(sv, host_byte_sex);
+	    case LC_IDENT:
+		if(l.cmdsize < sizeof(struct ident_command)){
+		    Mach_O_error(ofile, "malformed object (LC_IDENT cmdsize "
+			         "too small) in command %u", i);
+		    goto return_bad;
+		}
+		id = (struct ident_command *)lc;
+		if(swapped)
+		    swap_ident_command(id, host_byte_sex);
+		/*
+		 * Note the cmdsize field if the LC_IDENT command was checked
+		 * as part of checking all load commands cmdsize field before
+		 * the switch statement on the cmd field of the load command.
+		 */
+		break;
+	    case LC_RPATH:
+		if(l.cmdsize < sizeof(struct rpath_command)){
+		    Mach_O_error(ofile, "malformed object (LC_RPATH: cmdsize "
+			         "too small) in command %u", i);
+		    goto return_bad;
+		}
+		rpath = (struct rpath_command *)lc;
+		if(swapped)
+		    swap_rpath_command(rpath, host_byte_sex);
+		if(rpath->cmdsize < sizeof(struct rpath_command)){
+		    Mach_O_error(ofile, "malformed object (LC_RPATH command "
+			"%u has too small cmdsize field)", i);
+		    goto return_bad;
+		}
+		if(rpath->path.offset >= rpath->cmdsize){
+		    Mach_O_error(ofile, "truncated or malformed object (path."
+			"offset field of LC_RPATH command %u extends past the "
+			"end of the file)", i);
+		    goto return_bad;
+		}
+		break;
+
+#ifndef OFI
+	    default:
+		Mach_O_error(ofile, "malformed object (unknown load command "
+			     "%u)", i);
+		goto return_bad;
+#endif /* !defined(OFI) */
+	    }
+
+	    lc = (struct load_command *)((char *)lc + l.cmdsize);
+	    /* check that next load command does not extends past the end */
+	    if((char *)lc > (char *)load_commands + sizeofcmds){
+		Mach_O_error(ofile, "truncated or malformed object (load "
+			     "command %u extends past the end of the file)",
+			     i + 1);
+		goto return_bad;
+	    }
+	}
+	if(st == NULL){
+	    if(dyst != NULL){
+		Mach_O_error(ofile, "truncated or malformed object (contains "
+		  "LC_DYSYMTAB load command without a LC_SYMTAB load command)");
+		goto return_bad;
+	    }
+	}
+	else{
+	    if(dyst != NULL){
+		if(dyst->nlocalsym != 0 &&
+		   dyst->ilocalsym > st->nsyms){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(ilocalsym in LC_DYSYMTAB load command extends past "
+			"the end of the symbol table)");
+		    goto return_bad;
+		}
+		big_size = dyst->ilocalsym;
+		big_size += dyst->nlocalsym;
+		if(dyst->nlocalsym != 0 && big_size > st->nsyms){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(ilocalsym plus nlocalsym in LC_DYSYMTAB load command "
+			"extends past the end of the symbol table)");
+		    goto return_bad;
+		}
+
+		if(dyst->nextdefsym != 0 &&
+		   dyst->iextdefsym > st->nsyms){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(iextdefsym in LC_DYSYMTAB load command extends past "
+			"the end of the symbol table)");
+		    goto return_bad;
+		}
+		big_size = dyst->iextdefsym;
+		big_size += dyst->nextdefsym;
+		if(dyst->nextdefsym != 0 && big_size > st->nsyms){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(iextdefsym plus nextdefsym in LC_DYSYMTAB load "
+			"command extends past the end of the symbol table)");
+		    goto return_bad;
+		}
+
+		if(dyst->nundefsym != 0 &&
+		   dyst->iundefsym > st->nsyms){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(iundefsym in LC_DYSYMTAB load command extends past "
+			"the end of the symbol table)");
+		    goto return_bad;
+		}
+		big_size = dyst->iundefsym;
+		big_size += dyst->nundefsym;
+		if(dyst->nundefsym != 0 && big_size > st->nsyms){
+		    Mach_O_error(ofile, "truncated or malformed object "
+			"(iundefsym plus nundefsym in LC_DYSYMTAB load command "
+			"extends past the end of the symbol table)");
+		    goto return_bad;
+		}
+		if(rc != NULL){
+		    if(rc->init_module > dyst->nmodtab){
+			Mach_O_error(ofile, "malformed object (init_module in "
+			    "LC_ROUTINES load command extends past the "
+			    "end of the module table)");
+			goto return_bad;
+		    }
+		}
+		if(rc64 != NULL){
+		    if(rc64->init_module > dyst->nmodtab){
+			Mach_O_error(ofile, "malformed object (init_module in "
+			    "LC_ROUTINES_64 load command extends past the "
+			    "end of the module table)");
+			goto return_bad;
+		    }
+		}
+		if(hints != NULL){
+		    if(hints->nhints != dyst->nundefsym){
+			Mach_O_error(ofile, "malformed object (nhints in "
+			    "LC_TWOLEVEL_HINTS load command not the same as "
+			    "nundefsym in LC_DYSYMTAB load command)");
+			goto return_bad;
+		    }
+		}
+	    }
+	}
+	/* check for an inconsistent size of the load commands */
+	if((char *)load_commands + sizeofcmds != (char *)lc){
+	    Mach_O_error(ofile, "malformed object (inconsistent sizeofcmds "
+			 "field in mach header)");
+	    goto return_bad;
+	}
+
+	/*
+	 * Mark this ofile so we know its headers have been swapped.  We do this
+	 * in case we don't process it the first time so we can swap them back
+	 * in case we loop back to it in a fat file to process it later.
+	 */
+	if(swapped == TRUE)
+	    ofile->headers_swapped = TRUE;
+
+	/* looks good return ok */
+	free_elements(&elements);
+	return(CHECK_GOOD);
+
+return_bad:
+	free_elements(&elements);
+	return(CHECK_BAD);
+#endif /* OTOOL */
+}
+
+/*
+ * swap_back_Mach_O() is called after the ofile has been processed to swap back
+ * the mach header and load commands if check_Mach_O() above swapped them.
+ */
+static
+void
+swap_back_Mach_O(
+struct ofile *ofile)
+{
+	if(ofile->headers_swapped == TRUE){
+	    ofile->headers_swapped = FALSE;
+	    if(ofile->mh != NULL)
+		swap_object_headers(ofile->mh, ofile->load_commands);
+	    else if(ofile->mh64 != NULL)
+		swap_object_headers(ofile->mh64, ofile->load_commands);
+	}
+}
+
+#ifndef OTOOL
+/*
+ * check_overlaping_element() checks that the element in the ofile described by
+ * offset, size and name does not overlap in list of elements in head.  If it
+ * does CHECK_BAD is returned and an error message is generated.  If it doesn't
+ * then an element is added in the ordered list and CHECK_GOOD is returned
+ */
+static
+enum check_type
+check_overlaping_element(
+struct ofile *ofile,
+struct element *head,
+uint32_t offset,
+uint32_t size,
+char *name)
+{
+    struct element *e, *p, *n;
+
+	if(size == 0)
+	    return(CHECK_GOOD);
+
+	if(head->next == NULL){
+	    n = allocate(sizeof(struct element));
+	    n->offset = offset;
+	    n->size = size;
+	    n->name = name;
+	    n->next = NULL;
+	    head->next = n;
+	    return(CHECK_GOOD);
+	}
+
+	p = NULL;
+	e = head;
+	while(e->next != NULL){
+	    p = e;
+	    e = e->next;
+        /* AnV - mtoc i386 fix */
+#if 0
+	    if((offset >= e->offset &&
+		offset < e->offset + e->size) ||
+	       (offset + size > e->offset &&
+		offset + size < e->offset + e->size) ||
+	       (offset <= e->offset &&
+		offset + size >= e->offset + e->size)){
+		Mach_O_error(ofile, "malformed object (%s at offset %u with a "
+		    "size of %u, overlaps %s at offset %u with a size of %u)",
+		    name, offset, size, e->name, e->offset, e->size);
+		return(CHECK_BAD);
+	    }
+#endif
+	    if(e->next != NULL && offset + size <= e->next->offset){
+		n = allocate(sizeof(struct element));
+		n->offset = offset;
+		n->size = size;
+		n->name = name;
+		n->next = e;
+		p->next = n;
+		return(CHECK_GOOD);
+	    }
+	}
+	n = allocate(sizeof(struct element));
+	n->offset = offset;
+	n->size = size;
+	n->name = name;
+	n->next = NULL;
+	e->next = n;
+	return(CHECK_GOOD);
+}
+
+/*
+ * free_elements() frees the list of elements on the list head.
+ */
+static
+void
+free_elements(
+struct element *head)
+{
+    struct element *e, *e_next;
+
+	e = head->next;
+	while(e != NULL){
+	    e_next = e->next;
+	    free(e);
+	    e = e_next;
+	}
+}
+#endif /* !defined(OTOOL) */
+
+/*
+ * check_dylib_module() checks the object file's dylib_module as referenced
+ * by the dylib_module field in the ofile for correctness.
+ */
+static
+enum check_type
+check_dylib_module(
+struct ofile *ofile,
+struct symtab_command *st,
+struct dysymtab_command *dyst,
+char *strings,
+uint32_t module_index)
+{
+#ifdef OTOOL
+	return(CHECK_GOOD);
+#else /* !defined OTOOL */
+    uint32_t i;
+    enum byte_sex host_byte_sex;
+    enum bool swapped;
+    struct dylib_module m;
+    struct dylib_module_64 m64;
+    uint32_t module_name, nextdefsym, iextdefsym, nlocalsym, ilocalsym, nrefsym;
+    uint32_t irefsym, nextrel, iextrel;
+
+	host_byte_sex = get_host_byte_sex();
+	swapped = (enum bool)(host_byte_sex != ofile->object_byte_sex);
+	if(ofile->mh != NULL){
+	    m = *ofile->dylib_module;
+	    if(swapped)
+		swap_dylib_module(&m, 1, host_byte_sex);
+	    module_name = m.module_name;
+	    nextdefsym = m.nextdefsym;
+	    iextdefsym = m.iextdefsym;
+	    nlocalsym = m.nlocalsym;
+	    ilocalsym = m.ilocalsym;
+	    nrefsym = m.nrefsym;
+	    irefsym = m.irefsym;
+	    nextrel = m.nextrel;
+	    iextrel = m.iextrel;
+	}
+	else{
+	    m64 = *ofile->dylib_module64;
+	    if(swapped)
+		swap_dylib_module_64(&m64, 1, host_byte_sex);
+	    module_name = m64.module_name;
+	    nextdefsym = m64.nextdefsym;
+	    iextdefsym = m64.iextdefsym;
+	    nlocalsym = m64.nlocalsym;
+	    ilocalsym = m64.ilocalsym;
+	    nrefsym = m64.nrefsym;
+	    irefsym = m64.irefsym;
+	    nextrel = m64.nextrel;
+	    iextrel = m64.iextrel;
+	}
+
+	if(module_name > st->strsize){
+	    Mach_O_error(ofile, "truncated or malformed object (module_name "
+		"of module table entry %u past the end of the string table)",
+		module_index);
+	    return(CHECK_BAD);
+	}
+	for(i = module_name; i < st->strsize && strings[i] != '\0'; i++)
+		;
+	if(i >= st->strsize){
+	    Mach_O_error(ofile, "truncated or malformed object (module_name "
+		"of module table entry %u extends past the end of the string "
+		"table)", module_index);
+	    return(CHECK_BAD);
+	}
+
+	if(nextdefsym != 0){
+	    if(iextdefsym > st->nsyms){
+		Mach_O_error(ofile, "truncated or malformed object (iextdefsym "
+		    "field of module table entry %u past the end of the "
+		    "symbol table", module_index);
+		return(CHECK_BAD);
+	    }
+	    if(iextdefsym + nextdefsym > st->nsyms){
+		Mach_O_error(ofile, "truncated or malformed object (iextdefsym "
+		    "field of module table entry %u plus nextdefsym field "
+		    "extends past the end of the symbol table", module_index);
+		return(CHECK_BAD);
+	    }
+	}
+	if(nlocalsym != 0){
+	    if(ilocalsym > st->nsyms){
+		Mach_O_error(ofile, "truncated or malformed object (ilocalsym "
+		    "field of module table entry %u past the end of the "
+		    "symbol table", module_index);
+		return(CHECK_BAD);
+	    }
+	    if(ilocalsym + nlocalsym > st->nsyms){
+		Mach_O_error(ofile, "truncated or malformed object (ilocalsym "
+		    "field of module table entry %u plus nlocalsym field "
+		    "extends past the end of the symbol table", module_index);
+		return(CHECK_BAD);
+	    }
+	}
+	if(nrefsym != 0){
+	    if(irefsym > dyst->nextrefsyms){
+		Mach_O_error(ofile, "truncated or malformed object (irefsym "
+		    "field of module table entry %u past the end of the "
+		    "reference table", module_index);
+		return(CHECK_BAD);
+	    }
+	    if(irefsym + nrefsym > dyst->nextrefsyms){
+		Mach_O_error(ofile, "truncated or malformed object (irefsym "
+		    "field of module table entry %u plus nrefsym field "
+		    "extends past the end of the reference table",module_index);
+		return(CHECK_BAD);
+	    }
+	}
+	if(nextrel != 0){
+	    if(iextrel > dyst->extreloff){
+		Mach_O_error(ofile, "truncated or malformed object (iextrel "
+		    "field of module table entry %u past the end of the "
+		    "external relocation enrties", module_index);
+		return(CHECK_BAD);
+	    }
+	    if(iextrel + nextrel > dyst->extreloff){
+		Mach_O_error(ofile, "truncated or malformed object (iextrel "
+		    "field of module table entry %u plus nextrel field "
+		    "extends past the end of the external relocation enrties",
+		    module_index);
+		return(CHECK_BAD);
+	    }
+	}
+	return(CHECK_GOOD);
+#endif /* OTOOL */
+}
+
+__private_extern__
+uint32_t
+size_ar_name(
+const struct ar_hdr *ar_hdr)
+{
+    int32_t i;
+
+	i = sizeof(ar_hdr->ar_name) - 1;
+	if(ar_hdr->ar_name[i] == ' '){
+	    do{
+		if(ar_hdr->ar_name[i] != ' ')
+		    break;
+		i--;
+	    }while(i > 0);
+	}
+	return(i + 1);
+}
+#endif /* !defined(RLD) */
diff -Nur cctools-877.5/libstuff/version_number.c cctools-877.5-AnV/libstuff/version_number.c
--- cctools-877.5/libstuff/version_number.c	1969-12-31 23:59:59 +0000
+++ cctools-877.5-AnV/libstuff/version_number.c	2015-11-19 09:03:10 +0000
@@ -47,7 +47,7 @@
 
 	*value = 0;
 	p = allocate(strlen(argument) + 1);
-	strcpy(p, argument);
+	strlcpy(p, argument, strlen(argument));
 
 	y = NULL;
 	z = NULL;
diff -Nur cctools-877.5/libstuff/vm_flush_cache.c cctools-877.5-AnV/libstuff/vm_flush_cache.c
--- cctools-877.5/libstuff/vm_flush_cache.c	1969-12-31 23:59:59 +0000
+++ cctools-877.5-AnV/libstuff/vm_flush_cache.c	2015-11-19 09:03:10 +0000
@@ -40,11 +40,11 @@
 vm_size_t size)
 {
 #ifdef __m68k__
-	asm("trap #2");
+	__asm__("trap #2");
 #endif
 #ifdef __i386__
-	asm("jmp 1f");
-	asm("1: nop");
+	__asm__("jmp 1f");
+	__asm__("1: nop");
 #endif
 #ifdef __m88k__
 	user_cache_flush(address, size);
@@ -79,12 +79,12 @@
 				    &value));
 #endif
 #ifdef __m68k__
-	asm("trap #2");
+	__asm__("trap #2");
 	return(KERN_SUCCESS);
 #endif
 #ifdef __i386__
-	asm("jmp 1f");
-	asm("1: nop");
+	__asm__("jmp 1f");
+	__asm__("1: nop");
 	return(KERN_SUCCESS);
 #endif
 }
diff -Nur cctools-877.5/man/gprof.1 cctools-877.5-AnV/man/gprof.1
--- cctools-877.5/man/gprof.1	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/man/gprof.1	2015-11-19 09:03:10 +0000
@@ -0,0 +1,284 @@
+.\"	$OpenBSD: gprof.1,v 1.4 1996/10/15 23:55:56 deraadt Exp $
+.\"	$NetBSD: gprof.1,v 1.6 1995/11/21 22:24:55 jtc Exp $
+.\"
+.\" Copyright (c) 1983, 1990, 1993
+.\"	The Regents of the University of California.  All rights reserved.
+.\"
+.\" Redistribution and use in source and binary forms, with or without
+.\" modification, are permitted provided that the following conditions
+.\" are met:
+.\" 1. Redistributions of source code must retain the above copyright
+.\"    notice, this list of conditions and the following disclaimer.
+.\" 2. Redistributions in binary form must reproduce the above copyright
+.\"    notice, this list of conditions and the following disclaimer in the
+.\"    documentation and/or other materials provided with the distribution.
+.\" 3. All advertising materials mentioning features or use of this software
+.\"    must display the following acknowledgement:
+.\"	This product includes software developed by the University of
+.\"	California, Berkeley and its contributors.
+.\" 4. Neither the name of the University nor the names of its contributors
+.\"    may be used to endorse or promote products derived from this software
+.\"    without specific prior written permission.
+.\"
+.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+.\" SUCH DAMAGE.
+.\"
+.\"	@(#)gprof.1	8.1 (Berkeley) 6/6/93
+.\"
+.TH GPROF 1 "July 28, 2005" "Apple Computer, Inc."
+.SH NAME
+gprof \- display call graph profile data
+.SH SYNOPSIS
+.B gprof
+[ \fIoptions\fR ] [ a.out [ gmon.out ... ] ]
+.SH DESCRIPTION
+.I gprof
+produces an execution profile of a C, Pascal, or Fortran77 program.
+The effect of called routines is incorporated in the profile of each caller.
+The profile data is taken from the call graph profile file
+.RI ( gmon.out
+by default), which is created by programs
+compiled with the 
+.B \-pg
+option of 
+.IR cc ,
+.IR pc ,
+and
+.IR f77 .
+The symbol table in the
+named object file
+.RI ( a.out
+by default)
+is read and correlated with the
+call graph profile file.
+If more than one profile file is specified,
+the
+.I gprof
+output shows the sum of the profile information in the given profile files.
+.PP
+First, a flat profile is given.
+This listing gives the total execution times
+and call counts for each of the functions
+in the program, sorted by decreasing time.
+.PP
+Next, these times are propagated along the edges of the call graph.
+Cycles are discovered, and calls into a cycle are made to share the time 
+of the cycle.
+A second listing shows the functions
+sorted according to the time they represent
+including the time of their call graph descendents.
+Below each function entry is shown its (direct) call graph children,
+and how their times are propagated to this function.
+A similar display above the function shows how this function's time and the
+time of its descendents is propagated to its (direct) call graph parents.
+.PP
+Cycles are also shown, with an entry for the cycle as a whole as well as a 
+listing of the members of the cycle and their contributions to the
+time and call counts of the cycle.
+.SH "UNIVERSAL FILE SUPPORT"
+.I gprof
+accepts a ``universal'' file for the
+.I a.out
+file, using the host architecture from the file.  (It is an error if the 
+``universal'' file does not contain the host architecture.)
+.SH OPTIONS
+.TP 
+The following options are available:
+.TP
+.B \-a
+suppresses the displaying of statically declared functions.
+If this option is given, all relevant information about the static function
+(such as time samples, calls to other functions, calls from other functions)
+belongs to the function loaded just before the static function in the
+.I a.out
+file.
+.TP
+.B \-b
+suppresses the displaying of a description of each field in the profile.
+.TP
+.B \-c
+the static call graph of the program is discovered by a heuristic
+which examines the text space of the object file.
+Static-only parents or children are indicated
+with call counts of 0.  (The 
+.B \-c
+option is currently not supported.)
+.TP
+.BI \-e " name"
+suppresses the displaying of the graph profile entry for routine
+.I name
+and all its descendants
+(unless they have other ancestors that aren't suppressed).
+More than one
+.B \-e
+option may be given.
+Only one
+.I name
+may be given with each
+.B \-e
+option.
+.TP
+.BI \-E " name"
+suppresses the displaying of the graph profile entry for routine
+.I name
+(and its descendants) as 
+.BR \-e ,
+above, and also excludes the time spent in
+.I name
+(and its descendants) from the total and percentage time computations.
+(For example,
+.B \-E
+.I mcount
+and all of the other
+.IR monitor (3)
+routines are excluded by default.)
+.TP
+.BI \-f " name"
+displays the graph profile entry of only the specified routine
+.I name
+and its descendants.
+More than one
+.B \-f
+option may be given.
+Only one
+.I name
+may be given with each
+.B \-f
+option.
+.TP
+.BI \-F " name"
+displays the graph profile entry of only the routine
+.I name
+and its descendants (as 
+.BR \-f,
+above) and also uses only the times of the displayed routines
+in total time and percentage computations.
+More than one
+.B \-F
+option may be given.
+Only one
+.I name
+may be given with each
+.B \-F
+option.
+The
+.B \-F
+option
+overrides
+the
+.B \-E
+option.
+.TP
+.B \-s
+a profile file
+.I gmon.sum
+is produced which represents
+the sum of the profile information in all the specified profile files.
+This summary profile file may be given to subsequent
+executions of gprof (probably also with a
+.BR \-s )
+to accumulate profile data across several runs of an
+.I a.out
+file.
+.TP
+.B \-S
+produces four order files suitable as input to 
+.IR ld (1):
+.I gmon.order
+is an ordering based on a closest is best algorithm,
+.I callf.order
+is based on call frequency,
+.I callo.order
+is based on call order and
+.I time.order
+is based on time.
+The order files contain only those functions which were called or
+sampled (including spontaneous functions). For library functions to
+appear correctly in the order file, a 
+.I whatsloaded
+file produced by
+.IR ld (1)
+should exist in the working directory. Filenames in the order file
+will be missing for: files compiled without the 
+.BR \-g
+option, assembly files, and stripped executables.
+This option does not work with executables that have already been scattered.
+The
+.I gmon.order
+file can take a long time to produce and can be suppressed with the
+.B \-x
+option.
+.TP
+.B \-z
+displays routines which have zero usage (as indicated by call counts
+and accumulated time).
+This is useful in conjunction with the 
+.B \-c
+option for discovering which routines were never called.
+.SH FILES
+.ta 1.5i
+a.out	
+the namelist and text space.
+.br
+gmon.out	
+dynamic call graph and profile.
+.br
+gmon.sum	
+summarized dynamic call graph and profile.
+.br
+gmon.order	
+ordering based on closest is best algorithm.
+.br
+callf.order	
+ordering based on call frequency.
+.br
+callo.order	
+ordering based on call order.
+.br
+time.order	
+ordering based on time.
+.SH "SEE ALSO"
+monitor(3), profil(2), cc(1)
+.br
+dyld(1) and the DYLD_IMAGE_SUFFIX environment variable
+.br
+``gprof: A Call Graph Execution Profiler'', by
+Graham, S.L., Kessler, P.B., McKusick, M.K.;
+.IR "Proceedings of the SIGPLAN '82 Symposium on Compiler Construction" ,
+SIGPLAN Notices, Vol. 17, No. 6, pp. 120-126, June 1982.
+.SH BUGS
+Beware of quantization errors.
+The granularity of the sampling is shown, but remains
+statistical at best.
+We assume that the time for each execution of a function
+can be expressed by the total time for the function divided
+by the number of times the function is called.
+Thus the time propagated along the call graph arcs to parents of that
+function is directly proportional to the number of times that
+arc is traversed.
+.PP
+Parents which are not themselves profiled will have the time of 
+their profiled children propagated to them, but they will appear
+to be spontaneously invoked in the call graph listing, and will
+not have their time propagated further.
+Similarly, signal catchers, even though profiled, will appear
+to be spontaneous (although for more obscure reasons).
+Any profiled children of signal catchers should have their times
+propagated properly, unless the signal catcher was invoked during 
+the execution of the profiling routine, in which case all is lost.
+.PP
+The profiled program must call 
+.IR exit (2)
+or return normally for the profiling information to be saved
+in the 
+.B gmon.out 
+file.
diff -Nur cctools-877.5/misc/Makefile cctools-877.5-AnV/misc/Makefile
--- cctools-877.5/misc/Makefile	2015-03-10 00:33:19 +0000
+++ cctools-877.5-AnV/misc/Makefile	2015-11-19 09:03:10 +0000
@@ -1,5 +1,7 @@
 export USE_APPLE_PB_SUPPORT = all
 
+CC=clang
+
 ifneq "" "$(SDKROOT)"
   SDK = -isysroot $(SDKROOT)
   CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
@@ -11,10 +13,10 @@
   LIBTOOL = libtool
 endif
 
-OFLAG = -Os
+OFLAG = -Ofast
 LTO = -DLTO_SUPPORT
 TRIE = -DTRIE_SUPPORT
-CFLAGS = $(OFLAG) $(LTO) $(TRIE) -g -Wall \
+CFLAGS = -arch i386 -arch x86_64 $(OFLAG) $(LTO) $(TRIE) -g0 -Wall \
 	 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK) \
 	 -I$(DT_TOOLCHAIN_DIR)/usr/local/include
 
@@ -36,8 +38,8 @@
 
 BINDIR = /bin
 USRBINDIR = /usr/bin
-LOCBINDIR = /usr/local/bin
-LOCLIBDIR = /usr/local/lib
+LOCBINDIR = $(USRBINDIR)
+LOCLIBDIR = /usr/lib
 
 CFILES1 = libtool.c
 CFILES2 = lipo.c size.c strings.c nm.c checksyms.c inout.c \
diff -Nur cctools-877.5/otool/Makefile cctools-877.5-AnV/otool/Makefile
--- cctools-877.5/otool/Makefile	2015-03-10 00:33:19 +0000
+++ cctools-877.5-AnV/otool/Makefile	2015-11-19 09:05:14 +0000
@@ -1,87 +1,137 @@
-export USE_APPLE_PB_SUPPORT = all
-
-ifeq "$(EFITOOLS)" "efitools"
-	EFI_SUPPORT = -DEFI_SUPPORT
-endif
-
-ifneq "" "$(SDKROOT)"
-  SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
-  CXX = $(shell xcrun -find -sdk $(SDKROOT) c++)
-  DSYMUTIL = $(shell xcrun -find -sdk ${SDKROOT} dsymutil)
-else
-  DSYMUTIL = dsymutil
-endif
-
-OFLAG = -Os
-LTO = -DLTO_SUPPORT
-LEGACY = -D_MACH_I386_THREAD_STATUS_FPSTATE_LEGACY_FIELD_NAMES_ \
-	 -D_ARCHITECTURE_I386_FPU_FPSTATE_LEGACY_FIELD_NAMES_
-CFLAGS = $(OFLAG) $(LTO) -g -Wall -I$(SRCROOT)/../include \
-	 -I$(SRCROOT) $(LEGACY) $(EFI_SUPPORT) $(SDK)
-
-LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
-CXXLIB = -stdlib=libc++
-
-MKDIRS = /bin/mkdir -p
-SRCROOT = .
-SYMROOT = .
-OBJROOT = .
-OFILE_DIR = $(OBJROOT)
-VPATH = $(OFILE_DIR)
-
-BINDIR = /bin
-USRBINDIR = /usr/bin
-
-CFILES = main.c ofile_print.c m68k_disasm.c i860_disasm.c \
-	 m88k_disasm.c i386_disasm.c ppc_disasm.c hppa_disasm.c \
-	 sparc_disasm.c print_objc.c notify.c arm_disasm.c \
-	 print_objc2_64bit.c print_objc2_32bit.c dyld_bind_info.c \
-	 arm64_disasm.c print_bitcode.c
-ifeq "$(EFITOOLS)" "efitools"
-	CFILES += coff_print.c
-endif
-HFILES = otool.h ofile_print.h m68k_disasm.h i860_disasm.h \
-	 sparc_disasm.h m88k_disasm.h i386_disasm.h ppc_disasm.h hppa_disasm.h \
-	 notify.h arm_disasm.h dyld_bind_info.h arm64_disasm.h cxa_demangle.h
-OBJS = $(CFILES:.c=.o) ofile.o
-INSTALL_FILES = $(CFILES) $(HFILES) Makefile notes
-
-PRODUCT = otool
-all: $(OFILE_DIR) $(SYMROOT) $(PRODUCT).NEW
-
-$(PRODUCT).NEW:	$(OFILE_DIR) $(SYMROOT) $(OBJS)
-	$(CC) $(RC_CFLAGS) -nostdlib -r -o $(OBJROOT)/private.o \
-		$(OBJS) $(LIBSTUFF)
-	$(CXX) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/$@ $(OBJROOT)/private.o \
-		$(LIBSTUFF) $(CXXLIB)
-	$(DSYMUTIL) $(SYMROOT)/$@
-
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o $<
-
-ofile.o: $(SRCROOT)/../libstuff/ofile.c
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o \
-		$(SRCROOT)/../libstuff/ofile.c -DOTOOL
-
-clean: shlib_clean
-	-rm -f $(SYMROOT)/$(PRODUCT).NEW
-	-rm -r -f *dSYM
-
-shlib_clean:
-	-cd $(OFILE_DIR); rm -f $(OBJS) private.o
-	-rm -f make.out
-
-install: all
-	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
-	install -c -s -m 555 $(SYMROOT)/$(PRODUCT).NEW \
-		$(DSTROOT)$(USRBINDIR)/$(PRODUCT)
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-$(OFILE_DIR) $(SYMROOT):
-	$(MKDIRS) $@
+export USE_APPLE_PB_SUPPORT = all
+
+CC = clang -arch x86_64
+CXX = clang -arch x86_64
+LD = clang -arch x86_64 
+STRIP = strip
+AR = ar cru
+RANLIB = ranlib
+
+LIBCFILES = ofile_print.c m68k_disasm.c i860_disasm.c \
+	 m88k_disasm.c i386_disasm.c ppc_disasm.c hppa_disasm.c \
+	 sparc_disasm.c print_objc.c notify.c arm_disasm.c \
+	 print_objc2_64bit.c print_objc2_32bit.c dyld_bind_info.c arm64_disasm.c \
+	../libstuff/SymLoc.c ../libstuff/allocate.c ../libstuff/arch.c \
+	../libstuff/arch_usage.c ../libstuff/best_arch.c ../libstuff/breakout.c \
+	../libstuff/bytesex.c ../libstuff/checkout.c ../libstuff/coff_bytesex.c \
+	../libstuff/crc32.c ../libstuff/dylib_roots.c ../libstuff/dylib_table.c \
+	../libstuff/dynamic_obj/apple_version.c ../libstuff/errors.c ../libstuff/execute.c \
+	../libstuff/fatal_arch.c ../libstuff/fatals.c ../libstuff/get_arch_from_host.c \
+	../libstuff/get_toc_byte_sex.c ../libstuff/guess_short_name.c ../libstuff/hash_string.c \
+	../libstuff/hppa.c ../libstuff/llvm.c ../libstuff/lto.c \
+	../libstuff/macosx_deployment_target.c ../libstuff/ofile.c ../libstuff/ofile_error.c \
+	../libstuff/ofile_get_word.c ../libstuff/print.c ../libstuff/profile_obj/apple_version.c \
+	../libstuff/reloc.c ../libstuff/rnd.c ../libstuff/seg_addr_table.c \
+	../libstuff/set_arch_flag_name.c ../libstuff/static_kld_obj/apple_version.c \
+	../libstuff/static_obj/apple_version.c ../libstuff/swap_headers.c ../libstuff/symbol_list.c \
+	../libstuff/unix_standard_mode.c ../libstuff/version_number.c ../libstuff/vm_flush_cache.c \
+	../libstuff/writeout.c
+
+EFITOOLS=efitools
+
+ifeq "$(EFITOOLS)" "efitools"
+	EFI_SUPPORT = -DEFI_SUPPORT
+endif
+
+ifneq "" "$(SDKROOT)"
+  SDK = -isysroot $(SDKROOT)
+  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
+  CXX = $(shell xcrun -find -sdk $(SDKROOT) c++)
+  DSYMUTIL = $(shell xcrun -find -sdk ${SDKROOT} dsymutil)
+else
+  DSYMUTIL = dsymutil
+endif
+
+OFLAG = -g0 -Ofast
+LTO = -DLTO_SUPPORT
+# apply otool-ng patches
+OTOOL_NG = -DOTOOL_NG_SUPPORT
+
+LEGACY = -D_MACH_I386_THREAD_STATUS_FPSTATE_LEGACY_FIELD_NAMES_ \
+	 -D_ARCHITECTURE_I386_FPU_FPSTATE_LEGACY_FIELD_NAMES_
+CFLAGS = $(OFLAG) $(LTO) $(OTOOL_NG) -g -Wall -I$(SRCROOT)/../include \
+	 -I$(SRCROOT) $(LEGACY) $(EFI_SUPPORT) $(SDK)
+
+CXXLIB = -stdlib=libc++ -lc++
+
+MKDIRS = /bin/mkdir -p
+SRCROOT = .
+SYMROOT = .
+OBJROOT = .
+OFILE_DIR = $(OBJROOT)
+VPATH = $(OFILE_DIR)
+
+LIBSTUFF = $(SRCROOT)/../libstuff/libstuff.a
+LIBSTUFFBIN = -L$(SRCROOT)/../libstuff -lstuff
+
+BINDIR = /bin
+USRBINDIR = /usr/bin
+
+CFILES = main.c ofile_print.c m68k_disasm.c i860_disasm.c \
+	 m88k_disasm.c i386_disasm.c ppc_disasm.c hppa_disasm.c \
+	 sparc_disasm.c print_objc.c notify.c arm_disasm.c \
+	 print_objc2_64bit.c print_objc2_32bit.c dyld_bind_info.c \
+	 arm64_disasm.c print_bitcode.c
+ifeq "$(EFITOOLS)" "efitools"
+	CFILES += coff_print.c
+endif
+HFILES = otool.h ofile_print.h m68k_disasm.h i860_disasm.h \
+	 sparc_disasm.h m88k_disasm.h i386_disasm.h ppc_disasm.h hppa_disasm.h \
+	 notify.h arm_disasm.h dyld_bind_info.h arm64_disasm.h cxa_demangle.h
+OBJS = $(CFILES:.c=.o) ofile.o
+LIBOBJS = $(LIBCFILES:.c=.o) libmain.o
+INSTALL_FILES = $(CFILES) $(HFILES) Makefile notes
+
+LIBRARY = libdisasm.a
+PRODUCT = otool
+all: $(OFILE_DIR) $(SYMROOT) $(PRODUCT).NEW $(LIBRARY)
+
+$(LIBRARY): $(OFILE_DIR) $(LIBOBJS)
+	$(AR) $@ $(LIBOBJS)
+	-rm -Rf stuff
+	$(RANLIB) $@
+
+$(PRODUCT).NEW:	$(OFILE_DIR) $(SYMROOT) $(OBJS)
+	$(CC) $(RC_CFLAGS) -nostdlib -r -o $(OBJROOT)/private.o \
+		$(OBJS) $(LIBSTUFFBIN)
+	$(CXX) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/$@ $(OBJROOT)/private.o \
+		$(LIBSTUFFBIN) $(CXXLIB)
+	$(STRIP) $(SYMROOT)/$@
+#	$(DSYMUTIL) $(SYMROOT)/$@
+
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o $<
+
+libmain.o: main.c
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -D_BUILD_LIB_=1 -c -o $(OFILE_DIR)/$@ $<
+
+ofile.o: $(SRCROOT)/../libstuff/ofile.c
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o \
+		$(SRCROOT)/../libstuff/ofile.c -DOTOOL
+
+llvm.o: $(SRCROOT)/../libstuff/llvm.c
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o \
+		$(SRCROOT)/../libstuff/ofile.c -DOTOOL -D_BUILD_LIB_
+
+clean: shlib_clean
+	-rm -f $(SYMROOT)/$(PRODUCT).NEW
+	-rm -f *.a
+	-rm -r -f *dSYM
+
+shlib_clean:
+	-cd $(OFILE_DIR); rm -f $(OBJS) *.o
+	-rm -f make.out
+
+install: all
+	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
+	install -c -s -m 555 $(SYMROOT)/$(PRODUCT).NEW \
+		$(DSTROOT)$(USRBINDIR)/$(PRODUCT)
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+$(OFILE_DIR) $(SYMROOT):
+	$(MKDIRS) $@
diff -Nur cctools-877.5/otool/combineobjs.sh cctools-877.5-AnV/otool/combineobjs.sh
--- cctools-877.5/otool/combineobjs.sh	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/otool/combineobjs.sh	2015-11-19 09:03:11 +0000
@@ -0,0 +1,38 @@
+#!/bin/sh
+
+mkdir -p stuff
+
+cd stuff32
+
+for i in *.o; do \
+export O64DIR=`ls -1d ../stuff64`
+export O64=`basename $O64DIR`
+if [ "$i" = "$O64" ]; then
+ lipo -create -output ../stuff/$i $i ../stuff64/$i
+else \
+  cp $i ../stuff/$i
+fi
+done
+
+cd ..
+
+cd stuff
+for i in *.o; do \
+export O32DIR=`ls -1d ../stuff32/$i`
+export O32=`basename $O32DIR`
+if [ "$i" = "$O32" ]; then \
+echo 0 > /dev/null
+else \
+cp $O32 .
+fi
+done
+
+export O32=
+export O64=
+export O32DIR=
+export O64DIR=
+
+-rm -Rf stuff32 stuff64 libstuffx86.a libstuffx64.a
+
+cd ..
+
diff -Nur cctools-877.5/otool/extra.txt cctools-877.5-AnV/otool/extra.txt
--- cctools-877.5/otool/extra.txt	1970-01-01 00:00:00 +0000
+++ cctools-877.5-AnV/otool/extra.txt	2015-11-19 09:03:11 +0000
@@ -0,0 +1,42 @@
+../libstuff/SymLoc.c
+../libstuff/allocate.c
+../libstuff/arch.c
+../libstuff/arch_usage.c
+../libstuff/best_arch.c
+../libstuff/breakout.c
+../libstuff/bytesex.c
+../libstuff/checkout.c
+../libstuff/coff_bytesex.c
+../libstuff/crc32.c
+../libstuff/dylib_roots.c
+../libstuff/dylib_table.c
+../libstuff/dynamic_obj/apple_version.c
+../libstuff/errors.c
+../libstuff/execute.c
+../libstuff/fatal_arch.c
+../libstuff/fatals.c
+../libstuff/get_arch_from_host.c
+../libstuff/get_toc_byte_sex.c
+../libstuff/guess_short_name.c
+../libstuff/hash_string.c
+../libstuff/hppa.c
+../libstuff/llvm.c
+../libstuff/lto.c
+../libstuff/macosx_deployment_target.c
+../libstuff/ofile.c
+../libstuff/ofile_error.c
+../libstuff/ofile_get_word.c
+../libstuff/print.c
+../libstuff/profile_obj/apple_version.c
+../libstuff/reloc.c
+../libstuff/rnd.c
+../libstuff/seg_addr_table.c
+../libstuff/set_arch_flag_name.c
+../libstuff/static_kld_obj/apple_version.c
+../libstuff/static_obj/apple_version.c
+../libstuff/swap_headers.c
+../libstuff/symbol_list.c
+../libstuff/unix_standard_mode.c
+../libstuff/version_number.c
+../libstuff/vm_flush_cache.c
+../libstuff/writeout.c
diff -Nur cctools-877.5/otool/main.c cctools-877.5-AnV/otool/main.c
--- cctools-877.5/otool/main.c	2015-09-15 01:35:14 +0000
+++ cctools-877.5-AnV/otool/main.c	2015-11-19 09:06:33 +0000
@@ -1,3895 +1,4054 @@
-/*
- * Copyright  2009 Apple Inc. All rights reserved.
- *
- * @APPLE_LICENSE_HEADER_START@
- * 
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions are met:
- * 
- * 1.  Redistributions of source code must retain the above copyright notice,
- * this list of conditions and the following disclaimer. 
- * 2.  Redistributions in binary form must reproduce the above copyright notice,
- * this list of conditions and the following disclaimer in the documentation
- * and/or other materials provided with the distribution. 
- * 3.  Neither the name of Apple Inc. ("Apple") nor the names of its
- * contributors may be used to endorse or promote products derived from this
- * software without specific prior written permission. 
- * 
- * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND ANY
- * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
- * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
- * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
- * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
- * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
- * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
- * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
- * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
- * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
- *
- * @APPLE_LICENSE_HEADER_END@
- */
-#include <stdio.h>
-#include <stdlib.h>
-#include <string.h>
-#include <limits.h>
-#include <ar.h>
-#include <mach-o/ranlib.h>
-#include <libc.h>
-#include "stuff/bool.h"
-#include "stuff/ofile.h"
-#include "stuff/errors.h"
-#include "stuff/allocate.h"
-#include "stuff/symbol.h"
-#include "stuff/symbol.h"
-#include "stuff/llvm.h"
-#include "stuff/guess_short_name.h"
-#include "otool.h"
-#include "dyld_bind_info.h"
-#include "ofile_print.h"
-#include "m68k_disasm.h"
-#include "i860_disasm.h"
-#include "i386_disasm.h"
-#include "m88k_disasm.h"
-#include "ppc_disasm.h"
-#include "hppa_disasm.h"
-#include "sparc_disasm.h"
-#include "arm_disasm.h"
-#include "arm64_disasm.h"
-#include "llvm-c/Disassembler.h"
-
-/* Name of this program for error messages (argv[0]) */
-char *progname = NULL;
-
-/*
- * The flags to indicate the actions to perform.
- */
-enum bool fflag = FALSE; /* print the fat headers */
-enum bool aflag = FALSE; /* print the archive header */
-enum bool hflag = FALSE; /* print the exec or mach header */
-enum bool lflag = FALSE; /* print the load commands */
-enum bool Lflag = FALSE; /* print the shared library names */
-enum bool Dflag = FALSE; /* print the shared library id name */
-enum bool tflag = FALSE; /* print the text */
-enum bool Uflag = FALSE; /* print the text symbol by symbol,
-			    for llvm-objdump testing must be used with -t */
-enum bool no_show_raw_insn = FALSE; /* no raw inst, for llvm-objdump testing
-				       with 32-bit arm */
-enum bool dflag = FALSE; /* print the data */
-enum bool oflag = FALSE; /* print the objctive-C info */
-enum bool Oflag = FALSE; /* print the objctive-C selector strings only */
-enum bool rflag = FALSE; /* print the relocation entries */
-enum bool Tflag = FALSE; /* print the dylib table of contents */
-enum bool Mflag = FALSE; /* print the dylib module table */
-enum bool Rflag = FALSE; /* print the dylib reference table */
-enum bool Iflag = FALSE; /* print the indirect symbol table entries */
-enum bool Hflag = FALSE; /* print the two-level hints table */
-enum bool Cflag = FALSE; /* print the linker optimization hints */
-enum bool Gflag = FALSE; /* print the data in code table */
-enum bool gflag = FALSE; /* group the disassembly */
-enum bool eflag = FALSE; /* print enhanced disassembly */
-enum bool Sflag = FALSE; /* print the contents of the __.SYMDEF file */
-enum bool vflag = FALSE; /* print verbosely (symbolically) when possible */
-enum bool Vflag = FALSE; /* print dissassembled operands verbosely */
-enum bool cflag = FALSE; /* print the argument and environ strings of a core */
-enum bool iflag = FALSE; /* print the shared library initialization table */
-enum bool Wflag = FALSE; /* print the mod time of an archive as a number */
-enum bool Xflag = FALSE; /* don't print leading address in disassembly */
-enum bool Zflag = FALSE; /* don't use simplified ppc mnemonics in disassembly */
-enum bool Bflag = FALSE; /* force Thumb disassembly (ARM objects only) */
-enum bool Qflag = FALSE; /* use otool's disassembler */
-enum bool qflag = FALSE; /* use 'C' Public llvm-mc disassembler */
-enum bool jflag = FALSE; /* print opcode bytes */
-enum bool Pflag = FALSE; /* print (__TEXT,__info_plist) section as strings */
-char *pflag = NULL; 	 /* procedure name to start disassembling from */
-char *segname = NULL;	 /* name of the section to print the contents of */
-char *sectname = NULL;
-enum bool llvm_mc = FALSE; /* disassemble as llvm-mc will assemble */
-char *mcpu = "";	/* the arg of the -mcpu=arg flag */
-/* Print function offsets when disassembling when TRUE. */
-enum bool function_offsets = FALSE;
-enum bool print_bind_info = FALSE;  /* print dyld bind information */
-
-/* this is set when any of the flags that process object files is set */
-enum bool object_processing = FALSE;
-
-static void usage(
-    void);
-
-static void processor(
-    struct ofile *ofile,
-    char *arch_name,
-    void *cookie);
-
-static void get_symbol_table_info(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    cpu_type_t cputype,
-    enum byte_sex load_commands_byte_sex,
-    char *object_addr,
-    uint32_t object_size,
-    struct nlist **symbols,
-    struct nlist_64 **symbols64,
-    uint32_t *nsymbols,
-    char **strings,
-    uint32_t *strings_size);
-
-static void get_toc_info(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum byte_sex load_commands_byte_sex,
-    char *object_addr,
-    uint32_t object_size,
-    struct dylib_table_of_contents **tocs,
-    uint32_t *ntocs);
-
-static void get_module_table_info(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    cpu_type_t cputype,
-    enum byte_sex load_commands_byte_sex,
-    char *object_addr,
-    uint32_t object_size,
-    struct dylib_module **mods,
-    struct dylib_module_64 **mods64,
-    uint32_t *nmods);
-
-static void get_ref_info(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum byte_sex load_commands_byte_sex,
-    char *object_addr,
-    uint32_t object_size,
-    struct dylib_reference **refs,
-    uint32_t *nrefs);
-
-static void get_indirect_symbol_table_info(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum byte_sex load_commands_byte_sex,
-    char *object_addr,
-    uint32_t object_size,
-    uint32_t **indirect_symbols,
-    uint32_t *nindirect_symbols);
-
-static enum bool get_dyst(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum byte_sex load_commands_byte_sex,
-    struct dysymtab_command *dyst);
-
-static void get_hints_table_info(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum byte_sex load_commands_byte_sex,
-    char *object_addr,
-    uint32_t object_size,
-    struct twolevel_hint **hints,
-    uint32_t *nhints);
-
-static enum bool get_hints_cmd(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum byte_sex load_commands_byte_sex,
-    struct twolevel_hints_command *hints_cmd);
-
-static void get_link_opt_hints(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum byte_sex load_commands_byte_sex,
-    char *object_addr,
-    uint32_t object_size,
-    char **loh,
-    uint32_t *nloh);
-
-static enum bool get_link_opt_hint_cmd(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum byte_sex load_commands_byte_sex,
-    struct linkedit_data_command *loh_cmd);
-
-static void get_data_in_code_info(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum byte_sex load_commands_byte_sex,
-    char *object_addr,
-    uint32_t object_size,
-    struct data_in_code_entry **dices,
-    uint32_t *ndices);
-
-static enum bool get_dices_cmd(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum byte_sex load_commands_byte_sex,
-    struct linkedit_data_command *dices_cmd);
-
-static int sym_compare(
-    struct symbol *sym1,
-    struct symbol *sym2);
-
-static int rel_compare(
-    struct relocation_info *rel1,
-    struct relocation_info *rel2);
-
-static void get_linked_reloc_info(
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum byte_sex load_commands_byte_sex,
-    char *object_addr,
-    uint32_t object_size,
-    struct relocation_info **ext_relocs,
-    uint32_t *next_relocs,
-    struct relocation_info **loc_relocs,
-    uint32_t *nloc_relocs);
-
-static void setup_dyld_bind_info(
-    struct load_command *load_commands, 	/* input */
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum byte_sex load_commands_byte_sex,
-    char *object_addr,
-    uint32_t object_size,
-    struct dyld_bind_info **dbi, /* output */
-    uint64_t *ndbi);
-
-static void print_text_by_symbols(
-    cpu_type_t cputype,
-    enum byte_sex object_byte_sex,
-    char *sect,
-    uint32_t size,
-    uint64_t addr,
-    uint32_t sect_flags,
-    struct symbol *sorted_symbols,
-    uint32_t nsorted_symbols,
-    struct nlist *symbols,
-    struct nlist_64 *symbols64,
-    uint32_t nsymbols,
-    char *strings,
-    uint32_t strings_size,
-    struct relocation_info *relocs,
-    uint32_t nrelocs,
-    struct relocation_info *ext_relocs,
-    uint32_t next_relocs,
-    struct relocation_info *loc_relocs,
-    uint32_t nloc_relocs,
-    struct dyld_bind_info *dbi,
-    uint64_t ndbi,
-    uint32_t *indirect_symbols,
-    uint32_t nindirect_symbols,
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum bool disassemble,
-    enum bool verbose,
-    cpu_subtype_t cpusubtype,
-    char *object_addr,
-    uint32_t object_size,
-    struct data_in_code_entry *dices,
-    uint32_t ndices,
-    uint64_t seg_addr);
-
-static void print_text(
-    cpu_type_t cputype,
-    enum byte_sex object_byte_sex,
-    char *sect,
-    uint32_t size,
-    uint64_t addr,
-    uint32_t sect_flags,
-    struct symbol *sorted_symbols,
-    uint32_t nsorted_symbols,
-    struct nlist *symbols,
-    struct nlist_64 *symbols64,
-    uint32_t nsymbols,
-    char *strings,
-    uint32_t strings_size,
-    struct relocation_info *relocs,
-    uint32_t nrelocs,
-    struct relocation_info *ext_relocs,
-    uint32_t next_relocs,
-    struct relocation_info *loc_relocs,
-    uint32_t nloc_relocs,
-    struct dyld_bind_info *dbi,
-    uint64_t ndbi,
-    uint32_t *indirect_symbols,
-    uint32_t nindirect_symbols,
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    enum bool disassemble,
-    enum bool verbose,
-    cpu_subtype_t cpusubtype,
-    char *object_addr,
-    uint32_t object_size,
-    struct data_in_code_entry *dices,
-    uint32_t ndices,
-    uint64_t seg_addr);
-
-static void print_argstrings(
-    uint32_t magic,
-    struct load_command *load_commands,
-    uint32_t ncmds,
-    uint32_t sizeofcmds,
-    cpu_type_t cputype,
-    cpu_subtype_t cpusubtype,
-    enum byte_sex load_commands_byte_sex,
-    char *object_addr,
-    uint32_t object_size);
-
-/* apple_version is created by the libstuff/Makefile */
-extern char apple_version[];
-char *version = apple_version;
-
-int
-main(
-int argc,
-char **argv,
-char **envp)
-{
-    int i;
-    uint32_t j, nfiles;
-    struct arch_flag *arch_flags;
-    uint32_t narch_flags;
-    enum bool all_archs, use_member_syntax, version;
-    char **files;
-    const char *disssembler_version;
-
-	progname = argv[0];
-	arch_flags = NULL;
-	narch_flags = 0;
-	all_archs = FALSE;
-	use_member_syntax = TRUE;
-	llvm_mc = FALSE;
-	version = FALSE;
-
-	if(argc <= 1)
-	    usage();
-
-	/*
-	 * Parse the arguments.
-	 */
-	nfiles = 0;
-        files = allocate(sizeof(char *) * argc);
-	for(i = 1; i < argc; i++){
-	    if(argv[i][0] == '-' && argv[i][1] == '\0'){
-		for(i += 1 ; i < argc; i++)
-		    files[nfiles++] = argv[i];
-		break;
-	    }
-	    if(argv[i][0] != '-'){
-		files[nfiles++] = argv[i];
-		continue;
-	    }
-	    if(strcmp(argv[i], "--version") == 0){
-		fprintf(stderr, "otool(1): Apple Inc. version %s\n",
-			apple_version);
-		disssembler_version = llvm_disasm_version_string();
-		if(disssembler_version != NULL)
-		    fprintf(stderr, "disassmbler: %s\n", disssembler_version);
-		version = TRUE;
-		continue;
-	    }
-	    if(strcmp(argv[i], "-arch") == 0){
-		if(i + 1 == argc){
-		    error("missing argument(s) to %s option", argv[i]);
-		    usage();
-		}
-		if(strcmp("all", argv[i+1]) == 0){
-		    all_archs = TRUE;
-		}
-		else{
-		    arch_flags = reallocate(arch_flags,
-			    (narch_flags + 1) * sizeof(struct arch_flag));
-		    if(get_arch_from_flag(argv[i+1],
-					  arch_flags + narch_flags) == 0){
-			error("unknown architecture specification flag: "
-			      "%s %s", argv[i], argv[i+1]);
-			arch_usage();
-			usage();
-		    }
-		    narch_flags++;
-		}
-		i++;
-		continue;
-	    }
-	    if(strcmp(argv[i], "-llvm-mc") == 0){
-		llvm_mc = TRUE;
-		continue;
-	    }
-	    if(strcmp(argv[i], "-function_offsets") == 0){
-		function_offsets = TRUE;
-		continue;
-	    }
-	    if(strcmp(argv[i], "-bind_info") == 0){
-		print_bind_info = TRUE;
-		object_processing = TRUE;
-		continue;
-	    }
-	    if(strncmp(argv[i], "-mcpu=", sizeof("-mcpu=")-1) == 0){
-		mcpu = argv[i] + sizeof("-mcpu=")-1;
-		if(*mcpu == '\0'){
-		    error("missing argument to -mcpu=");
-		    usage();
-		}
-		continue;
-	    }
-	    if(strcmp(argv[i], "-no-show-raw-insn") == 0){
-		no_show_raw_insn = TRUE;
-		continue;
-	    }
-	    if(argv[i][1] == 'p'){
-		if(argc <=  i + 1){
-		    error("-p requires an argument (a text symbol name)");
-		    usage();
-		}
-		if(pflag)
-		    error("only one -p flag can be specified");
-		pflag = argv[i + 1];
-		i++;
-		continue;
-	    }
-	    if(argv[i][1] == 's'){
-		if(argc <=  i + 2){
-		    error("-s requires two arguments (a segment name and a "
-			  "section name)");
-		    usage();
-		}
-		if(sectname != NULL){
-		    error("only one -s flag can be specified");
-		    usage();
-		}
-		segname  = argv[i + 1];
-		sectname = argv[i + 2];
-		i += 2;
-		object_processing = TRUE;
-		continue;
-	    }
-	    for(j = 1; argv[i][j] != '\0'; j++){
-		switch(argv[i][j]){
-		case 'V':
-		    Vflag = TRUE;
-		case 'v':
-		    vflag = TRUE;
-		    break;
-		case 'f':
-		    fflag = TRUE;
-		    break;
-		case 'a':
-		    aflag = TRUE;
-		    break;
-		case 'g':
-		    gflag = TRUE;
-		    break;
-		case 'e':
-		    eflag = TRUE;
-		    break;
-		case 'h':
-		    hflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'l':
-		    lflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'L':
-		    Lflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'D':
-		    Dflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 't':
-		    tflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'U':
-		    Uflag = TRUE;
-		    break;
-		case 'd':
-		    dflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'o':
-		    oflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'O':
-		    Oflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'r':
-		    rflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'T':
-		    Tflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'M':
-		    Mflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'R':
-		    Rflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'I':
-		    Iflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'H':
-		    Hflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'C':
-		    Cflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'G':
-		    Gflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'S':
-		    Sflag = TRUE;
-		    break;
-		case 'c':
-		    cflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'i':
-		    iflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		case 'W':
-		    Wflag = TRUE;
-		    break;
-		case 'X':
-		    Xflag = TRUE;
-		    break;
-		case 'Z':
-		    Zflag = TRUE;
-		    break;
-		case 'm':
-		    use_member_syntax = FALSE;
-		    break;
-		case 'B':
-		    Bflag = TRUE;
-		    break;
-		case 'Q':
-		    Qflag = TRUE;
-		    break;
-		case 'q':
-		    qflag = TRUE;
-		    break;
-		case 'j':
-		    jflag = TRUE;
-		    break;
-		case 'P':
-		    Pflag = TRUE;
-		    object_processing = TRUE;
-		    break;
-		default:
-		    error("unknown char `%c' in flag %s\n", argv[i][j],argv[i]);
-		    usage();
-		}
-	    }
-	}
-
-	/*
-	 * Check for correctness of arguments.
-	 */
-	if(!fflag && !aflag && !hflag && !lflag && !Lflag && !tflag && !dflag &&
-	   !oflag && !Oflag && !rflag && !Tflag && !Mflag && !Rflag && !Iflag &&
-	   !Cflag && !print_bind_info && !version && !Pflag &&
-	   !Hflag && !Gflag && !Sflag && !cflag && !iflag && !Dflag &&!segname){
-	    error("one of -fahlLtdoOrTMRIHCGScisP or --version must be "
-		  "specified");
-	    usage();
-	}
-	if(qflag && Qflag){
-	    error("can't specify both -q and -Q");
-	    usage();
-	}
-	/*
-	 * The default, without the -Q flag, is to use the llvm dissembler
-	 * instead of otool's internal disassemblers.
-	 */
-	if(!Qflag)
-	    qflag = TRUE;
-	if(nfiles == 0 && version == FALSE){
-	    error("at least one file must be specified");
-	    usage();
-	}
-	if(segname != NULL && sectname != NULL){
-	    /* treat "-s __TEXT __text" the same as -t */
-	    if(strcmp(segname, SEG_TEXT) == 0 &&
-	       strcmp(sectname, SECT_TEXT) == 0){
-		tflag = TRUE;
-		segname = NULL;
-		sectname = NULL;
-	    }
-	    /* treat "-s __TEXT __fvmlib0" the same as -i */
-	    else if(strcmp(segname, SEG_TEXT) == 0 &&
-	       strcmp(sectname, SECT_FVMLIB_INIT0) == 0){
-		iflag = TRUE;
-		segname = NULL;
-		sectname = NULL;
-	    }
-	    /* treat "-v -s __TEXT __info_plist" the same as -P */
-	    else if(vflag == TRUE && strcmp(segname, SEG_TEXT) == 0 &&
-	       strcmp(sectname, "__info_plist") == 0){
-		Pflag = TRUE;
-		segname = NULL;
-		sectname = NULL;
-	    }
-	}
-
-	for(j = 0; j < nfiles; j++){
-	    ofile_process(files[j], arch_flags, narch_flags, all_archs, TRUE,
-			  TRUE, use_member_syntax, processor, NULL);
-	}
-
-	if(errors)
-	    return(EXIT_FAILURE);
-	else
-	    return(EXIT_SUCCESS);
-}
-
-/*
- * Print the current usage message.
- */
-static
-void
-usage(
-void)
-{
-	fprintf(stderr,
-		"Usage: %s [-arch arch_type] [-fahlLDtdorSTMRIHGvVcXmqQjCP] "
-		"[-mcpu=arg] [--version] <object file> ...\n", progname);
-
-	fprintf(stderr, "\t-f print the fat headers\n");
-	fprintf(stderr, "\t-a print the archive header\n");
-	fprintf(stderr, "\t-h print the mach header\n");
-	fprintf(stderr, "\t-l print the load commands\n");
-	fprintf(stderr, "\t-L print shared libraries used\n");
-	fprintf(stderr, "\t-D print shared library id name\n");
-	fprintf(stderr, "\t-t print the text section (disassemble with -v)\n");
-	fprintf(stderr, "\t-p <routine name>  start dissassemble from routine "
-		"name\n");
-	fprintf(stderr, "\t-s <segname> <sectname> print contents of "
-		"section\n");
-	fprintf(stderr, "\t-d print the data section\n");
-	fprintf(stderr, "\t-o print the Objective-C segment\n");
-	fprintf(stderr, "\t-r print the relocation entries\n");
-	fprintf(stderr, "\t-S print the table of contents of a library\n");
-	fprintf(stderr, "\t-T print the table of contents of a dynamic "
-		"shared library\n");
-	fprintf(stderr, "\t-M print the module table of a dynamic shared "
-		"library\n");
-	fprintf(stderr, "\t-R print the reference table of a dynamic shared "
-		"library\n");
-	fprintf(stderr, "\t-I print the indirect symbol table\n");
-	fprintf(stderr, "\t-H print the two-level hints table\n");
-	fprintf(stderr, "\t-G print the data in code table\n");
-	fprintf(stderr, "\t-v print verbosely (symbolically) when possible\n");
-	fprintf(stderr, "\t-V print disassembled operands symbolically\n");
-	fprintf(stderr, "\t-c print argument strings of a core file\n");
-	fprintf(stderr, "\t-X print no leading addresses or headers\n");
-	fprintf(stderr, "\t-m don't use archive(member) syntax\n");
-	fprintf(stderr, "\t-B force Thumb disassembly (ARM objects only)\n");
-	fprintf(stderr, "\t-q use llvm's disassembler (the default)\n");
-	fprintf(stderr, "\t-Q use otool(1)'s disassembler\n");
-	fprintf(stderr, "\t-mcpu=arg use `arg' as the cpu for disassembly\n");
-	fprintf(stderr, "\t-j print opcode bytes\n");
-	fprintf(stderr, "\t-P print the info plist section as strings\n");
-	fprintf(stderr, "\t-C print linker optimization hints\n");
-	fprintf(stderr, "\t--version print the version of %s\n", progname);
-	exit(EXIT_FAILURE);
-}
-
-static
-void
-processor(
-struct ofile *ofile,
-char *arch_name,
-void *cookie) /* cookie is not used */
-{
-    char *addr;
-    uint32_t i, magic;
-    uint64_t size;
-    struct mach_header mh;
-    struct mach_header_64 mh64;
-    cpu_type_t mh_cputype;
-    cpu_subtype_t mh_cpusubtype;
-    uint32_t mh_magic, mh_filetype, mh_ncmds, mh_sizeofcmds, sizeof_mach_header;
-    struct load_command *load_commands;
-    uint32_t nsymbols, nsorted_symbols, strings_size, len;
-    struct nlist *symbols, *allocated_symbols;
-    struct nlist_64 *symbols64, *allocated_symbols64;
-    struct symbol *sorted_symbols;
-    char *strings, *p;
-    uint32_t n_strx;
-    uint8_t n_type;
-    uint16_t n_desc;
-    uint64_t n_value;
-    char *sect;
-    uint32_t sect_nrelocs, sect_flags, nrelocs, next_relocs, nloc_relocs;
-    uint64_t sect_addr, sect_size;
-    struct relocation_info *sect_relocs, *relocs, *ext_relocs, *loc_relocs;
-    uint32_t *indirect_symbols, *allocated_indirect_symbols;
-    uint32_t nindirect_symbols;
-    struct dylib_module *mods, *allocated_mods;
-    struct dylib_module_64 *mods64, *allocated_mods64;
-    struct dylib_table_of_contents *tocs, *allocated_tocs;
-    struct dylib_reference *refs, *allocated_refs;
-    uint32_t nmods, ntocs, nrefs;
-    struct twolevel_hint *hints, *allocated_hints;
-    struct data_in_code_entry *dices, *allocated_dices;
-    uint32_t nhints, ndices;
-    uint64_t seg_addr;
-    char *loh;
-    uint32_t nloh;
-    struct dyld_bind_info *dbi;
-    uint64_t ndbi;
-
-	sorted_symbols = NULL;
-	nsorted_symbols = 0;
-	indirect_symbols = NULL;
-	nindirect_symbols = 0;
-	hints = NULL;
-	nhints = 0;
-	dices = NULL;
-	ndices = 0;
-	symbols = NULL;
-	symbols64 = NULL;
-	nsymbols = 0;
-	strings = NULL;
-	nmods = 0;
-	mods64 = NULL;
-	mods = NULL;
-	/*
-	 * These may or may not be allocated.  If allocated they will not be
-	 * NULL and then free'ed before returning.
-	 */
-	load_commands = NULL;
-	allocated_symbols = NULL;
-	allocated_symbols64 = NULL;
-	sorted_symbols = NULL;
-	allocated_indirect_symbols = NULL;
-	allocated_tocs = NULL;
-	allocated_mods = NULL;
-	allocated_refs = NULL;
-	allocated_hints = NULL;
-	allocated_dices = NULL;
-	dbi = NULL;
-	ndbi = 0;
-
-	/*
-	 * The fat headers are printed in ofile_map() in ofile.c #ifdef'ed
-	 * OTOOL.
-	 */
-
-	/*
-	 * Archive headers.
-	 */
-	if(aflag && ofile->member_ar_hdr != NULL){
-	    uint32_t member_offset;
-
-	    member_offset = ofile->member_offset - sizeof(struct ar_hdr);
-	    if(strncmp(ofile->member_ar_hdr->ar_name, AR_EFMT1,
-		       sizeof(AR_EFMT1) - 1) == 0)
-		member_offset -= ofile->member_name_size;
-
-	    print_ar_hdr(ofile->member_ar_hdr, ofile->member_name,
-			 ofile->member_name_size, member_offset, vflag, Vflag);
-	}
-
-	/*
-	 * Archive table of contents.
-	 */
-	if(ofile->member_ar_hdr != NULL &&
-	   strncmp(ofile->member_name, SYMDEF, sizeof(SYMDEF)-1) == 0){
-	    if(Sflag == FALSE)
-		return;
-	    if(ofile->file_type == OFILE_FAT){
-		addr = ofile->file_addr + ofile->fat_archs[ofile->narch].offset;
-		size = ofile->fat_archs[ofile->narch].size;
-	    }
-	    else{
-		addr = ofile->file_addr;
-		size = ofile->file_size;
-	    }
-	    if(addr + size > ofile->file_addr + ofile->file_size)
-		size = (ofile->file_addr + ofile->file_size) - addr;
-	    print_library_toc(ofile->member_ar_hdr, /* toc_ar_hdr */
-			      ofile->member_name, /* toc_name */
-			      ofile->member_name_size, /* toc_name_size */
-			      ofile->member_addr, /* toc_addr */
-			      ofile->member_size, /* toc_size */
-			      get_toc_byte_sex(addr, size),
-			      ofile->file_name, /* library_name */
-			      addr, /* library_addr */
-			      size, /* library_size */
-			      arch_name,
-			      vflag);
-	    return;
-	}
-
-	if(object_processing == FALSE)
-	    return;
-
-	/*
-	 * Print header for the object name if in an archive or an architecture
-	 * name is passed in.
-	 */
-	if(Xflag == FALSE){
-	    printf("%s", ofile->file_name);
-	    if(ofile->member_ar_hdr != NULL){
-		printf("(%.*s)", (int)ofile->member_name_size,
-			ofile->member_name);
-	    }
-	    if(arch_name != NULL)
-		printf(" (architecture %s):", arch_name);
-	    else
-		printf(":");
-	    /*
-	     * If the mach_header pointer is NULL the file is not an object
-	     * file.  Truncated object file (where the file size is less
-	     * than sizeof(struct mach_header) also does not have it's
-	     * mach_header set.  So deal with both cases here and then
-	     * return as the rest of this routine deals only with things
-	     * in object files.
-	     */
-	    if(ofile->mh == NULL && ofile->mh64 == NULL){
-		if(ofile->file_type == OFILE_FAT){
-		    /*
-		     * This routine is not called on fat files where the
-		     * offset is past end of file.  An error message is
-		     * printed in ofile_specific_arch() in ofile.c.
-		     */
-		    if(ofile->arch_type == OFILE_ARCHIVE){
-			addr = ofile->member_addr;
-			size = ofile->member_size;
-		    }
-		    else{
-			addr = ofile->file_addr +
-			       ofile->fat_archs[ofile->narch].offset;
-			size = ofile->fat_archs[ofile->narch].size;
-		    }
-		    if(addr + size > ofile->file_addr + ofile->file_size)
-			size = (ofile->file_addr + ofile->file_size) - addr;
-		}
-		else if(ofile->file_type == OFILE_ARCHIVE){
-		    addr = ofile->member_addr;
-		    size = ofile->member_size;
-		}
-		else{ /* ofile->file_type == OFILE_UNKNOWN */
-		    addr = ofile->file_addr;
-		    size = ofile->file_size;
-		}
-		if(size > sizeof(int32_t)){
-		    memcpy(&magic, addr, sizeof(uint32_t));
-		    if(magic == MH_MAGIC ||
-		       magic == SWAP_INT(MH_MAGIC)){
-			printf(" is a truncated object file\n");
-			memset(&mh, '\0', sizeof(struct mach_header));
-			if(size > sizeof(struct mach_header))
-			    size = sizeof(struct mach_header);
-			memcpy(&mh, addr, size);
-			if(magic == SWAP_INT(MH_MAGIC))
-			    swap_mach_header(&mh, get_host_byte_sex());
-			if(hflag)
-			    print_mach_header(mh.magic, mh.cputype,
-				mh.cpusubtype, mh.filetype, mh.ncmds,
-				mh.sizeofcmds, mh.flags, vflag);
-			return;
-		    }
-		    else if(magic == MH_MAGIC_64 ||
-		            magic == SWAP_INT(MH_MAGIC_64)){
-			printf(" is a truncated object file\n");
-			memset(&mh64, '\0', sizeof(struct mach_header_64));
-			if(size > sizeof(struct mach_header_64))
-			    size = sizeof(struct mach_header_64);
-			memcpy(&mh64, addr, size);
-			if(magic == SWAP_INT(MH_MAGIC_64))
-			    swap_mach_header_64(&mh64, get_host_byte_sex());
-			if(hflag)
-			    print_mach_header(mh64.magic, mh64.cputype,
-				mh64.cpusubtype, mh64.filetype, mh64.ncmds,
-				mh64.sizeofcmds, mh64.flags, vflag);
-			return;
-		    }
-		}
-#ifdef LTO_SUPPORT
-		if(ofile->lto != NULL){
-		    printf(" is an LLVM bit-code file\n");
-		    return;
-		}
-#endif /* LTO_SUPPORT */
-		printf(" is not an object file\n");
-		return;
-	    }
-	}
-	if(ofile->mh != NULL){
-	    if((intptr_t)(ofile->mh) % sizeof(uint32_t)){
-		if(Xflag == FALSE)
-		    printf("(object file offset is not a multiple of sizeof("
-			   "uint32_t))");
-		memcpy(&mh, ofile->mh, sizeof(struct mach_header));
-		if(mh.magic == SWAP_INT(MH_MAGIC))
-		    swap_mach_header(&mh, get_host_byte_sex());
-		ofile->mh = &mh;
-	    }
-	    else if(ofile->mh->magic == SWAP_INT(MH_MAGIC)){
-		mh = *(ofile->mh);
-		swap_mach_header(&mh, get_host_byte_sex());
-		ofile->mh = &mh;
-	    }
-	}
-	else if(ofile->mh64 != NULL){
-	    if((intptr_t)(ofile->mh64) % sizeof(uint32_t)){
-		if(Xflag == FALSE)
-		    printf("(object file offset is not a multiple of sizeof("
-			   "uint32_t))");
-		memcpy(&mh64, ofile->mh64, sizeof(struct mach_header));
-		if(mh64.magic == SWAP_INT(MH_MAGIC_64))
-		    swap_mach_header_64(&mh64, get_host_byte_sex());
-		ofile->mh64 = &mh64;
-	    }
-	    else if(ofile->mh64->magic == SWAP_INT(MH_MAGIC_64)){
-		mh64 = *(ofile->mh64);
-		swap_mach_header_64(&mh64, get_host_byte_sex());
-		ofile->mh64 = &mh64;
-	    }
-	}
-	if(Xflag == FALSE)
-	    printf("\n");
-
-	/*
-	 * If this is not an object file then just return.
-	 */
-	if(ofile->mh == NULL && ofile->mh64 == NULL)
-	    return;
-
-	/*
-	 * Calculate the true number of bytes of the of the object file that
-	 * is in memory (in case this file is truncated).
-	 */
-	addr = ofile->object_addr;
-	size = ofile->object_size;
-	if(addr + size > ofile->file_addr + ofile->file_size)
-	    size = (ofile->file_addr + ofile->file_size) - addr;
-
-	/*
-	 * Assign some local variables to the values in the mach_header for this
-	 * ofile to make passing arguments to the print routines easier.
-	 */
-	if(ofile->mh != NULL){
-	    mh_magic = ofile->mh->magic;
-	    mh_cputype = ofile->mh->cputype;
-	    mh_cpusubtype = ofile->mh->cpusubtype;
-	    mh_filetype = ofile->mh->filetype;
-	    mh_ncmds = ofile->mh->ncmds;
-	    mh_sizeofcmds = ofile->mh->sizeofcmds;
-	    sizeof_mach_header = sizeof(struct mach_header);
-	}
-	else{
-	    mh_magic = ofile->mh64->magic;
-	    mh_cputype = ofile->mh64->cputype;
-	    mh_cpusubtype = ofile->mh64->cpusubtype;
-	    mh_filetype = ofile->mh64->filetype;
-	    mh_ncmds = ofile->mh64->ncmds;
-	    mh_sizeofcmds = ofile->mh64->sizeofcmds;
-	    sizeof_mach_header = sizeof(struct mach_header_64);
-	}
-
-	/*
-	 * Mach header.
-	 */
-	if(hflag){
-	    if(ofile->mh != NULL)
-		print_mach_header(ofile->mh->magic, ofile->mh->cputype,
-				  ofile->mh->cpusubtype, ofile->mh->filetype,
-				  ofile->mh->ncmds, ofile->mh->sizeofcmds,
-				  ofile->mh->flags, vflag);
-	    else
-		print_mach_header(ofile->mh64->magic, ofile->mh64->cputype,
-				  ofile->mh64->cpusubtype,ofile->mh64->filetype,
-				  ofile->mh64->ncmds, ofile->mh64->sizeofcmds,
-				  ofile->mh64->flags, vflag);
-	}
-
-	/*
-	 * Load commands.
-	 */
-	if(mh_sizeofcmds + sizeof_mach_header > size){
-	    load_commands = allocate(mh_sizeofcmds);
-	    memset(load_commands, '\0', mh_sizeofcmds);
-	    memcpy(load_commands, ofile->load_commands, 
-		   size - sizeof_mach_header);
-	    ofile->load_commands = load_commands;
-	}
-	if(lflag)
-	    print_loadcmds(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-			   mh_cputype, mh_filetype, ofile->object_byte_sex,
-			   size, vflag, Vflag);
-
-	if(Lflag || Dflag)
-	    print_libraries(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-			    ofile->object_byte_sex, (Dflag && !Lflag), vflag);
-
-	/*
-	 * If the indicated operation needs the symbol table get it.
-	 */
-	sect_flags = 0;
-	if(segname != NULL && sectname != NULL){
-	    (void)get_sect_info(segname, sectname, ofile->load_commands,
-			mh_ncmds, mh_sizeofcmds, mh_filetype,
-			ofile->object_byte_sex,
-			addr, size, &sect, &sect_size, &sect_addr,
-			&sect_relocs, &sect_nrelocs, &sect_flags, &seg_addr);
-	    /*
-	     * The MH_DYLIB_STUB format has all section sizes set to zero 
-	     * except sections with indirect symbol table entries (so that the
-	     * indirect symbol table table entries can be printed, which are
-	     * based on the section size).  So if we are being asked to print
-	     * the section contents of one of these sections in a MH_DYLIB_STUB
-	     * we assume it has been stripped and set the section size to zero.
-	     */
-	    if(mh_filetype == MH_DYLIB_STUB &&
-	       ((sect_flags & SECTION_TYPE) == S_NON_LAZY_SYMBOL_POINTERS ||
-	        (sect_flags & SECTION_TYPE) == S_LAZY_SYMBOL_POINTERS ||
-		(sect_flags & SECTION_TYPE) == S_LAZY_DYLIB_SYMBOL_POINTERS ||
-	        (sect_flags & SECTION_TYPE) == S_SYMBOL_STUBS))
-		sect_size = 0;
-	}
-	if(Rflag || Mflag)
-	    get_symbol_table_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-		mh_cputype, ofile->object_byte_sex, addr, size, &symbols,
-		&symbols64, &nsymbols, &strings, &strings_size);
-	if(vflag && (rflag || Tflag || Mflag || Rflag || Iflag || Hflag || tflag
-	   || iflag || oflag ||
-	   (sect_flags & SECTION_TYPE) == S_LITERAL_POINTERS ||
-	   (sect_flags & SECTION_TYPE) == S_MOD_INIT_FUNC_POINTERS ||
-	   (sect_flags & SECTION_TYPE) == S_MOD_TERM_FUNC_POINTERS ||
-	   (sect_flags & S_ATTR_PURE_INSTRUCTIONS) ==
-		S_ATTR_PURE_INSTRUCTIONS ||
-	   (sect_flags & S_ATTR_SOME_INSTRUCTIONS) ==
-		S_ATTR_SOME_INSTRUCTIONS ||
-	   segname != NULL)){
-	    get_symbol_table_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-	        mh_cputype, ofile->object_byte_sex, addr, size, &symbols, 
-		&symbols64, &nsymbols, &strings, &strings_size);
-
-	    if(symbols != NULL){
-		if((uintptr_t)symbols % sizeof(uint32_t) ||
-		   ofile->object_byte_sex != get_host_byte_sex()){
-		    allocated_symbols =
-			allocate(nsymbols * sizeof(struct nlist));
-		    memcpy(allocated_symbols, symbols,
-			   nsymbols * sizeof(struct nlist));
-		    symbols = allocated_symbols;
-		}
-		if(ofile->object_byte_sex != get_host_byte_sex())
-		    swap_nlist(symbols, nsymbols, get_host_byte_sex());
-	    }
-	    else{
-		if((uintptr_t)symbols64 % sizeof(uint32_t) ||
-		   ofile->object_byte_sex != get_host_byte_sex()){
-		    allocated_symbols64 =
-			allocate(nsymbols * sizeof(struct nlist_64));
-		    memcpy(allocated_symbols64, symbols64,
-			   nsymbols * sizeof(struct nlist_64));
-		    symbols64 = allocated_symbols64;
-		}
-		if(ofile->object_byte_sex != get_host_byte_sex())
-		    swap_nlist_64(symbols64, nsymbols, get_host_byte_sex());
-	    }
-
-	    /*
-	     * If the operation needs a sorted symbol table create it.
-	     */
-	    if(tflag || iflag || oflag || 
-	       (((sect_flags & SECTION_TYPE) == S_MOD_INIT_FUNC_POINTERS ||
-	         (sect_flags & SECTION_TYPE) == S_MOD_TERM_FUNC_POINTERS) &&
-		  Vflag) ||
-	       (sect_flags & S_ATTR_PURE_INSTRUCTIONS) ==
-		    S_ATTR_PURE_INSTRUCTIONS ||
-	       (sect_flags & S_ATTR_SOME_INSTRUCTIONS) ==
-		    S_ATTR_SOME_INSTRUCTIONS){
-		sorted_symbols = allocate(nsymbols * sizeof(struct symbol));
-		nsorted_symbols = 0;
-		for(i = 0; i < nsymbols; i++){
-		    if(symbols != NULL){
-			n_strx = symbols[i].n_un.n_strx;
-			n_type = symbols[i].n_type;
-			n_desc = symbols[i].n_desc;
-			n_value = symbols[i].n_value;
-		    }
-		    else{
-			n_strx = symbols64[i].n_un.n_strx;
-			n_type = symbols64[i].n_type;
-			n_desc = symbols64[i].n_desc;
-			n_value = symbols64[i].n_value;
-		    }
-		    if(n_strx > 0 && n_strx < strings_size)
-			p = strings + n_strx;
-		    else
-			p = "symbol with bad string index";
-		    if(n_type & ~(N_TYPE|N_EXT|N_PEXT))
-			continue;
-		    n_type = n_type & N_TYPE;
-		    if(n_type == N_ABS || n_type == N_SECT){
-			len = strlen(p);
-			if(len > sizeof(".o") - 1 &&
-			   strcmp(p + (len - (sizeof(".o") - 1)), ".o") == 0)
-			    continue;
-			if(strcmp(p, "gcc_compiled.") == 0)
-			    continue;
-			if(strncmp(p, "ltmp", sizeof("ltmp") - 1) == 0)
-			    continue;
-			if(n_type == N_ABS && n_value == 0 && *p == '.')
-			    continue;
-			sorted_symbols[nsorted_symbols].n_value = n_value;
-			sorted_symbols[nsorted_symbols].name = p;
-			sorted_symbols[nsorted_symbols].is_thumb =
-			    n_desc & N_ARM_THUMB_DEF;
-			nsorted_symbols++;
-		    }
-		}
-		qsort(sorted_symbols, nsorted_symbols, sizeof(struct symbol),
-		      (int (*)(const void *, const void *))sym_compare);
-	    }
-	}
-
-	if(Mflag || Tflag || Rflag){
-	    get_module_table_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-		mh_cputype, ofile->object_byte_sex, addr, size, &mods, &mods64,
-		&nmods);
-	    if(mods != NULL){
-		if((intptr_t)mods % sizeof(uint32_t) ||
-		   ofile->object_byte_sex != get_host_byte_sex()){
-		    allocated_mods = allocate(nmods *
-					      sizeof(struct dylib_module));
-		    memcpy(allocated_mods, mods,
-			   nmods * sizeof(struct dylib_module));
-		    mods = allocated_mods;
-		}
-		if(ofile->object_byte_sex != get_host_byte_sex())
-		    swap_dylib_module(mods, nmods, get_host_byte_sex());
-	    }
-	    if(mods64 != NULL){
-		if((intptr_t)mods64 % sizeof(uint64_t) ||
-		   ofile->object_byte_sex != get_host_byte_sex()){
-		    allocated_mods64 = allocate(nmods *
-					        sizeof(struct dylib_module_64));
-		    memcpy(allocated_mods64, mods64,
-			   nmods * sizeof(struct dylib_module_64));
-		    mods64 = allocated_mods64;
-		}
-		if(ofile->object_byte_sex != get_host_byte_sex())
-		    swap_dylib_module_64(mods64, nmods, get_host_byte_sex());
-	    }
-	}
-
-	if(Tflag){
-	    get_toc_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-		ofile->object_byte_sex, addr, size, &tocs, &ntocs);
-	    if((intptr_t)tocs % sizeof(uint32_t) ||
-	       ofile->object_byte_sex != get_host_byte_sex()){
-		allocated_tocs = allocate(ntocs *
-					sizeof(struct dylib_table_of_contents));
-		memcpy(allocated_tocs, tocs,
-		       ntocs * sizeof(struct dylib_table_of_contents));
-		tocs = allocated_tocs;
-	    }
-	    if(ofile->object_byte_sex != get_host_byte_sex())
-		swap_dylib_table_of_contents(tocs, ntocs, get_host_byte_sex());
-	    print_toc(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-		ofile->object_byte_sex, addr, size, tocs, ntocs, mods, mods64,
-		nmods, symbols, symbols64, nsymbols, strings, strings_size,
-		vflag);
-	}
-
-	if(Mflag){
-	    if(mods != NULL)
-		print_module_table(mods, nmods, strings, strings_size, vflag);
-	    else
-		print_module_table_64(mods64, nmods, strings, strings_size,
-				      vflag);
-	}
-
-	if(Rflag){
-	    get_ref_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-		ofile->object_byte_sex, addr, size, &refs, &nrefs);
-	    if((intptr_t)refs % sizeof(uint32_t) ||
-	       ofile->object_byte_sex != get_host_byte_sex()){
-		allocated_refs = allocate(nrefs *
-					sizeof(struct dylib_reference));
-		memcpy(allocated_refs, refs,
-		       nrefs * sizeof(struct dylib_reference));
-		refs = allocated_refs;
-	    }
-	    if(ofile->object_byte_sex != get_host_byte_sex())
-		swap_dylib_reference(refs, nrefs, get_host_byte_sex());
-	    print_refs(refs, nrefs, mods, mods64, nmods, symbols, symbols64,
-		       nsymbols, strings, strings_size, vflag);
-	}
-
-	if(Iflag || (tflag && vflag)){
-	    get_indirect_symbol_table_info(ofile->load_commands, mh_ncmds,
-		mh_sizeofcmds, ofile->object_byte_sex, addr, size,
-		&indirect_symbols, &nindirect_symbols);
-	    if((intptr_t)indirect_symbols % sizeof(uint32_t) ||
-	       ofile->object_byte_sex != get_host_byte_sex()){
-		allocated_indirect_symbols = allocate(nindirect_symbols *
-						     sizeof(uint32_t));
-		memcpy(allocated_indirect_symbols, indirect_symbols,
-		       nindirect_symbols * sizeof(uint32_t));
-		indirect_symbols = allocated_indirect_symbols;
-	    }
-	    if(ofile->object_byte_sex != get_host_byte_sex())
-		swap_indirect_symbols(indirect_symbols, nindirect_symbols,
-				      get_host_byte_sex());
-	}
-	if(Hflag){
-	    get_hints_table_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-		ofile->object_byte_sex, addr, size, &hints, &nhints);
-	    if((intptr_t)hints % sizeof(uint32_t) ||
-	       ofile->object_byte_sex != get_host_byte_sex()){
-		allocated_hints = allocate(nhints *
-					   sizeof(struct twolevel_hint));
-		memcpy(allocated_hints, hints,
-		       nhints * sizeof(struct twolevel_hint));
-		hints = allocated_hints;
-	    }
-	    if(ofile->object_byte_sex != get_host_byte_sex())
-		swap_twolevel_hint(hints, nhints, get_host_byte_sex());
-	    print_hints(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-		ofile->object_byte_sex, hints, nhints, symbols, symbols64,
-		nsymbols, strings, strings_size, vflag);
-	}
-	if(Cflag){
-	    get_link_opt_hints(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-		ofile->object_byte_sex, addr, size, &loh, &nloh);
-	    print_link_opt_hints(loh, nloh);
-	}
-	if(Gflag || (tflag && vflag)){
-	    get_data_in_code_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-		ofile->object_byte_sex, addr, size, &dices, &ndices);
-	    if((intptr_t)dices % sizeof(uint32_t) ||
-	       ofile->object_byte_sex != get_host_byte_sex()){
-		allocated_dices = allocate(ndices *
-					   sizeof(struct data_in_code_entry));
-		memcpy(allocated_dices, dices,
-		       ndices * sizeof(struct data_in_code_entry));
-		dices = allocated_dices;
-	    }
-	    if(ofile->object_byte_sex != get_host_byte_sex())
-		swap_data_in_code_entry(dices, ndices, get_host_byte_sex());
-	    if(Gflag)
-		print_dices(dices, ndices, vflag);
-	}
-	if(Iflag)
-	    print_indirect_symbols(ofile->load_commands, mh_ncmds,mh_sizeofcmds,
-		mh_cputype, ofile->object_byte_sex, indirect_symbols,
-		nindirect_symbols, symbols, symbols64, nsymbols, strings,
-		strings_size, vflag);
-
-	if(rflag)
-	    print_reloc(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-			mh_cputype, ofile->object_byte_sex, addr, size, symbols,
-		        symbols64, nsymbols, strings, strings_size, vflag);
-	if(print_bind_info){
-	    setup_dyld_bind_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-		ofile->object_byte_sex, ofile->object_addr, ofile->object_size,
-		&dbi, &ndbi);
-	    print_dyld_bind_info(dbi, ndbi);
-	}
-
-	if(tflag ||
-	   (sect_flags & S_ATTR_PURE_INSTRUCTIONS) ==
-		S_ATTR_PURE_INSTRUCTIONS ||
-	   (sect_flags & S_ATTR_SOME_INSTRUCTIONS) ==
-		S_ATTR_SOME_INSTRUCTIONS){
-	    if(tflag)
-		(void)get_sect_info(SEG_TEXT, SECT_TEXT, ofile->load_commands,
-		    mh_ncmds, mh_sizeofcmds, mh_filetype,
-		    ofile->object_byte_sex,
-		    addr, size, &sect, &sect_size, &sect_addr,
-		    &sect_relocs, &sect_nrelocs, &sect_flags, &seg_addr);
-
-	    /* create aligned relocations entries as needed */
-	    relocs = NULL;
-	    nrelocs = 0;
-	    ext_relocs = NULL;
-	    next_relocs = 0;
-	    loc_relocs = NULL;
-	    nloc_relocs = 0;
-	    if(Vflag){
-		if(mh_filetype == MH_KEXT_BUNDLE){
-		    get_linked_reloc_info(ofile->load_commands, mh_ncmds,
-			    mh_sizeofcmds, ofile->object_byte_sex,
-			    ofile->object_addr, ofile->object_size, &ext_relocs,
-			    &next_relocs, &loc_relocs, &nloc_relocs);
-		    /* create aligned relocations entries as needed */
-		    if((intptr_t)ext_relocs % sizeof(int32_t) != 0 ||
-		       ofile->object_byte_sex != get_host_byte_sex()){
-			relocs = allocate(next_relocs *
-					  sizeof(struct relocation_info));
-			memcpy(relocs, ext_relocs, next_relocs *
-			       sizeof(struct relocation_info));
-			ext_relocs = relocs;
-		    }
-		    if((intptr_t)loc_relocs % sizeof(int32_t) != 0 ||
-		       ofile->object_byte_sex != get_host_byte_sex()){
-			relocs = allocate(nloc_relocs *
-					  sizeof(struct relocation_info));
-			memcpy(relocs, loc_relocs, nloc_relocs *
-			       sizeof(struct relocation_info));
-			loc_relocs = relocs;
-		    }
-		    if(ofile->object_byte_sex != get_host_byte_sex()){
-			swap_relocation_info(ext_relocs, next_relocs,
-					     get_host_byte_sex());
-			swap_relocation_info(loc_relocs, nloc_relocs,
-					     get_host_byte_sex());
-		    }
-		    relocs = NULL;
-		}
-		if((intptr_t)sect_relocs % sizeof(int32_t) != 0 ||
-		   ofile->object_byte_sex != get_host_byte_sex()){
-		    nrelocs = sect_nrelocs;
-		    relocs = allocate(nrelocs *
-				      sizeof(struct relocation_info));
-		    memcpy(relocs, sect_relocs, nrelocs *
-			   sizeof(struct relocation_info));
-		}
-		else{
-		    nrelocs = sect_nrelocs;
-		    relocs = sect_relocs;
-		}
-		if(ofile->object_byte_sex != get_host_byte_sex())
-		    swap_relocation_info(relocs, nrelocs,
-					 get_host_byte_sex());
-		setup_dyld_bind_info(ofile->load_commands, mh_ncmds,
-				     mh_sizeofcmds, ofile->object_byte_sex,
-				     ofile->object_addr, ofile->object_size,
-				     &dbi, &ndbi);
-	    }
-	    if(Xflag == FALSE){
-		if(tflag)
-		    printf("(%s,%s) section\n", SEG_TEXT, SECT_TEXT);
-		else
-		    printf("Contents of (%.16s,%.16s) section\n", segname,
-			   sectname);
-	    }
-	    if(Uflag)
-		print_text_by_symbols(mh_cputype, ofile->object_byte_sex, sect,
-		       sect_size, sect_addr, sect_flags, sorted_symbols,
-		       nsorted_symbols, symbols, symbols64, nsymbols, strings,
-		       strings_size, relocs, nrelocs, ext_relocs, next_relocs,
-		       loc_relocs, nloc_relocs, dbi, ndbi, indirect_symbols,
-		       nindirect_symbols, ofile->load_commands, mh_ncmds,
-		       mh_sizeofcmds, vflag, Vflag, mh_cpusubtype,
-		       ofile->object_addr, ofile->object_size, dices, ndices,
-		       seg_addr);
-	    else
-		print_text(mh_cputype, ofile->object_byte_sex, sect, sect_size,
-		       sect_addr, sect_flags, sorted_symbols,
-		       nsorted_symbols, symbols, symbols64, nsymbols, strings,
-		       strings_size, relocs, nrelocs, ext_relocs, next_relocs,
-		       loc_relocs, nloc_relocs, dbi, ndbi, indirect_symbols,
-		       nindirect_symbols, ofile->load_commands, mh_ncmds,
-		       mh_sizeofcmds, vflag, Vflag, mh_cpusubtype,
-		       ofile->object_addr, ofile->object_size, dices, ndices,
-                       seg_addr);
-
-	    if(relocs != NULL && relocs != sect_relocs)
-		free(relocs);
-	}
-
-	if(iflag){
-	    if(get_sect_info(SEG_TEXT, SECT_FVMLIB_INIT0, ofile->load_commands,
-		mh_ncmds, mh_sizeofcmds, mh_filetype, ofile->object_byte_sex,
-		addr, size, &sect, &sect_size, &sect_addr,
-		&sect_relocs, &sect_nrelocs, &sect_flags, &seg_addr) == TRUE){
-
-		/* create aligned, sorted relocations entries */
-		nrelocs = sect_nrelocs;
-		relocs = allocate(nrelocs * sizeof(struct relocation_info));
-		memcpy(relocs, sect_relocs, nrelocs *
-		       sizeof(struct relocation_info));
-		if(ofile->object_byte_sex != get_host_byte_sex())
-		    swap_relocation_info(relocs, nrelocs, get_host_byte_sex());
-		qsort(relocs, nrelocs, sizeof(struct relocation_info),
-		      (int (*)(const void *, const void *))rel_compare);
-
-		if(Xflag == FALSE)
-		    printf("Shared library initialization (%s,%s) section\n",
-			   SEG_TEXT, SECT_FVMLIB_INIT0);
-		print_shlib_init(ofile->object_byte_sex, sect, sect_size,
-			sect_addr, sorted_symbols, nsorted_symbols, symbols,
-			symbols64, nsymbols, strings, strings_size, relocs,
-			nrelocs, vflag);
-		free(relocs);
-	    }
-	}
-
-	if(dflag){
-	    if(get_sect_info(SEG_DATA, SECT_DATA, ofile->load_commands,
-		mh_ncmds, mh_sizeofcmds, mh_filetype, ofile->object_byte_sex,
-		addr, size, &sect, &sect_size, &sect_addr,
-		&sect_relocs, &sect_nrelocs, &sect_flags, &seg_addr) == TRUE){
-
-		if(Xflag == FALSE)
-		    printf("(%s,%s) section\n", SEG_DATA, SECT_DATA);
-		print_sect(mh_cputype, ofile->object_byte_sex, sect, sect_size,
-			   sect_addr);
-	    }
-	}
-
-	if(Pflag){
-	    if(get_sect_info(SEG_TEXT, "__info_plist", ofile->load_commands,
-		mh_ncmds, mh_sizeofcmds, mh_filetype, ofile->object_byte_sex,
-		addr, size, &sect, &sect_size, &sect_addr,
-		&sect_relocs, &sect_nrelocs, &sect_flags, &seg_addr) == TRUE){
-
-		if(Xflag == FALSE)
-		    printf("(%s,%s) section\n", SEG_TEXT, "__info_plist");
-		printf("%.*s\n", (int)sect_size, sect);
-	    }
-	}
-
-	if(segname != NULL && sectname != NULL &&
-	   (sect_flags & S_ATTR_PURE_INSTRUCTIONS) !=
-		S_ATTR_PURE_INSTRUCTIONS &&
-	   (sect_flags & S_ATTR_SOME_INSTRUCTIONS) !=
-		S_ATTR_SOME_INSTRUCTIONS){
-	    if(strcmp(segname, SEG_OBJC) == 0 &&
-	       strcmp(sectname, "__protocol") == 0 && vflag == TRUE){
-		print_objc_protocol_section(ofile->load_commands, mh_ncmds,
-		   mh_sizeofcmds, ofile->object_byte_sex, ofile->object_addr,
-		   ofile->object_size, vflag);
-	    }
-	    else if(strcmp(segname, SEG_OBJC) == 0 &&
-	            (strcmp(sectname, "__string_object") == 0 ||
-	             strcmp(sectname, "__cstring_object") == 0) &&
-		    vflag == TRUE){
-		if(mh_cputype & CPU_ARCH_ABI64)
-		    print_objc_string_object_section_64(sectname,
-			ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-			ofile->object_byte_sex, ofile->object_addr,
-			ofile->object_size, mh_cputype, symbols64, nsymbols,
-			strings, strings_size, sorted_symbols, nsorted_symbols,
-			vflag);
-		else
-		    print_objc_string_object_section(sectname,
-			ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-			ofile->object_byte_sex, ofile->object_addr,
-			ofile->object_size, vflag);
-	    }
-	    else if(strcmp(segname, SEG_OBJC) == 0 &&
-	       strcmp(sectname, "__runtime_setup") == 0 && vflag == TRUE){
-		print_objc_runtime_setup_section(ofile->load_commands, mh_ncmds,
-		   mh_sizeofcmds, ofile->object_byte_sex, ofile->object_addr,
-		   ofile->object_size, vflag);
-	    }
-	    else if(strcmp(segname, "__LLVM") == 0 &&
-	       strcmp(sectname, "__bundle") == 0 &&
-	       (vflag == TRUE || Vflag == TRUE) &&
-	       get_sect_info(segname, sectname, ofile->load_commands,
-                   mh_ncmds, mh_sizeofcmds, mh_filetype, ofile->object_byte_sex,
-                   addr, size, &sect, &sect_size, &sect_addr, &sect_relocs,
-		   &sect_nrelocs, &sect_flags, &seg_addr) == TRUE){
-		print_bitcode_section(sect, sect_size, vflag, Vflag);
-	    }
-#ifdef EFI_SUPPORT
-	    else if(strcmp(segname, "__RELOC") == 0 &&
-	       strcmp(sectname, "__reloc") == 0 && vflag == TRUE){
-		print_coff_reloc_section(ofile->load_commands, mh_ncmds,
-		   mh_sizeofcmds, mh_filetype, ofile->object_byte_sex,
-		   ofile->object_addr, ofile->object_size, vflag);
-	    }
-#endif
-	    else if(get_sect_info(segname, sectname, ofile->load_commands,
-		mh_ncmds, mh_sizeofcmds, mh_filetype, ofile->object_byte_sex,
-		addr, size, &sect, &sect_size, &sect_addr,
-		&sect_relocs, &sect_nrelocs, &sect_flags, &seg_addr) == TRUE){
-
-		if(Xflag == FALSE)
-		    printf("Contents of (%.16s,%.16s) section\n", segname,
-			   sectname);
-
-		if(vflag){
-		    switch((sect_flags & SECTION_TYPE)){
-		    case 0:
-			print_sect(mh_cputype, ofile->object_byte_sex,
-				   sect, sect_size, sect_addr);
-			break;
-		    case S_ZEROFILL:
-			printf("zerofill section and has no contents in the "
-			       "file\n");
-			break;
-		    case S_CSTRING_LITERALS:
-			print_cstring_section(mh_cputype, sect, sect_size,
-					      sect_addr,
-					      Xflag == TRUE ? FALSE : TRUE);
-			break;
-		    case S_4BYTE_LITERALS:
-			print_literal4_section(mh_cputype, sect, sect_size,
-					       sect_addr,
-					       ofile->object_byte_sex,
-					       Xflag == TRUE ? FALSE : TRUE);
-			break;
-		    case S_8BYTE_LITERALS:
-			print_literal8_section(mh_cputype, sect, sect_size,
-					       sect_addr,
-					       ofile->object_byte_sex,
-					       Xflag == TRUE ? FALSE : TRUE);
-			break;
-		    case S_16BYTE_LITERALS:
-			print_literal16_section(mh_cputype, sect, sect_size,
-						sect_addr,
-					        ofile->object_byte_sex,
-					        Xflag == TRUE ? FALSE : TRUE);
-			break;
-		    case S_LITERAL_POINTERS:
-			/* create aligned, sorted relocations entries */
-			nrelocs = sect_nrelocs;
-			relocs = allocate(nrelocs *
-					  sizeof(struct relocation_info));
-			memcpy(relocs, sect_relocs, nrelocs *
-			       sizeof(struct relocation_info));
-			if(ofile->object_byte_sex != get_host_byte_sex())
-			    swap_relocation_info(relocs, nrelocs,
-					         get_host_byte_sex());
-			qsort(relocs, nrelocs, sizeof(struct relocation_info),
-			      (int (*)(const void *, const void *))rel_compare);
-			print_literal_pointer_section(mh_cputype,
-				ofile->load_commands, mh_ncmds, mh_sizeofcmds,
-				ofile->object_byte_sex, addr, size, sect,
-				sect_size, sect_addr, symbols, symbols64,
-				nsymbols, strings, strings_size, relocs,
-				nrelocs, Xflag == TRUE ? FALSE : TRUE);
-			free(relocs);
-
-			break;
-
-		    case S_MOD_INIT_FUNC_POINTERS:
-		    case S_MOD_TERM_FUNC_POINTERS:
-			print_init_term_pointer_section(mh_cputype, sect,
-			    sect_size, sect_addr, ofile->object_byte_sex,
-			    sorted_symbols, nsorted_symbols, Vflag);
-			break;
-
-		    default:
-			printf("Unknown section type (0x%x)\n",
-			       (unsigned int)(sect_flags & SECTION_TYPE));
-			print_sect(mh_cputype, ofile->object_byte_sex, sect,
-				   sect_size, sect_addr);
-			break;
-		    }
-		}
-		else{
-		    if((sect_flags & SECTION_TYPE) == S_ZEROFILL)
-			printf("zerofill section and has no contents in the "
-			       "file\n");
-		    else
-			print_sect(mh_cputype, ofile->object_byte_sex, sect,
-				   sect_size, sect_addr);
-		}
-	    }
-	}
-
-	if(cflag)
-	    print_argstrings(mh_magic, ofile->load_commands, mh_ncmds,
-			     mh_sizeofcmds, mh_cputype, mh_cpusubtype,
-			     ofile->object_byte_sex, ofile->object_addr,
-			     ofile->object_size);
-
-	if(oflag){
-	    if(mh_cputype & CPU_ARCH_ABI64){
-		get_linked_reloc_info(ofile->load_commands, mh_ncmds,
-			mh_sizeofcmds, ofile->object_byte_sex,
-			ofile->object_addr, ofile->object_size, &ext_relocs,
-			&next_relocs, &loc_relocs, &nloc_relocs);
-		/* create aligned relocations entries as needed */
-		relocs = NULL;
-		nrelocs = 0;
-		if((intptr_t)ext_relocs % sizeof(int32_t) != 0 ||
-		   ofile->object_byte_sex != get_host_byte_sex()){
-		    relocs = allocate(next_relocs *
-				      sizeof(struct relocation_info));
-		    memcpy(relocs, ext_relocs, next_relocs *
-			   sizeof(struct relocation_info));
-		    ext_relocs = relocs;
-		}
-		if((intptr_t)loc_relocs % sizeof(int32_t) != 0 ||
-		   ofile->object_byte_sex != get_host_byte_sex()){
-		    relocs = allocate(nloc_relocs *
-				      sizeof(struct relocation_info));
-		    memcpy(relocs, loc_relocs, nloc_relocs *
-			   sizeof(struct relocation_info));
-		    loc_relocs = relocs;
-		}
-		if(ofile->object_byte_sex != get_host_byte_sex()){
-		    swap_relocation_info(ext_relocs, next_relocs,
-					 get_host_byte_sex());
-		    swap_relocation_info(loc_relocs, nloc_relocs,
-					 get_host_byte_sex());
-		}
-		setup_dyld_bind_info(ofile->load_commands, mh_ncmds,
-				     mh_sizeofcmds, ofile->object_byte_sex,
-				     ofile->object_addr, ofile->object_size,
-				     &dbi, &ndbi);
-		print_objc2_64bit(mh_cputype, ofile->load_commands, mh_ncmds,
-			    mh_sizeofcmds, ofile->object_byte_sex,
-			    ofile->object_addr, ofile->object_size, symbols64,
-			    nsymbols, strings, strings_size, sorted_symbols,
-			    nsorted_symbols, ext_relocs, next_relocs,
-			    loc_relocs, nloc_relocs, dbi, ndbi, vflag, Vflag);
-	    }
-	    else if(mh_cputype == CPU_TYPE_ARM){
-		get_linked_reloc_info(ofile->load_commands, mh_ncmds,
-			mh_sizeofcmds, ofile->object_byte_sex,
-			ofile->object_addr, ofile->object_size, &ext_relocs,
-			&next_relocs, &loc_relocs, &nloc_relocs);
-		/* create aligned relocations entries as needed */
-		relocs = NULL;
-		nrelocs = 0;
-		if((intptr_t)ext_relocs % sizeof(int32_t) != 0 ||
-		   ofile->object_byte_sex != get_host_byte_sex()){
-		    relocs = allocate(next_relocs *
-				      sizeof(struct relocation_info));
-		    memcpy(relocs, ext_relocs, next_relocs *
-			   sizeof(struct relocation_info));
-		    ext_relocs = relocs;
-		}
-		if((intptr_t)loc_relocs % sizeof(int32_t) != 0 ||
-		   ofile->object_byte_sex != get_host_byte_sex()){
-		    relocs = allocate(nloc_relocs *
-				      sizeof(struct relocation_info));
-		    memcpy(relocs, loc_relocs, nloc_relocs *
-			   sizeof(struct relocation_info));
-		    loc_relocs = relocs;
-		}
-		if(ofile->object_byte_sex != get_host_byte_sex()){
-		    swap_relocation_info(ext_relocs, next_relocs,
-					 get_host_byte_sex());
-		    swap_relocation_info(loc_relocs, nloc_relocs,
-					 get_host_byte_sex());
-		}
-		print_objc2_32bit(mh_cputype, ofile->load_commands, mh_ncmds,
-			    mh_sizeofcmds, ofile->object_byte_sex,
-			    ofile->object_addr, ofile->object_size, symbols,
-			    nsymbols, strings, strings_size, sorted_symbols,
-			    nsorted_symbols, ext_relocs, next_relocs,
-			    loc_relocs, nloc_relocs, vflag);
-	    }
-	    else{
-		 /*
-		  * This is the 32-bit non-arm cputype case.  Which is normally
-		  * the first Objective-C ABI.  But it may be the case of a
-		  * binary for the iOS simulator which is the second Objective-C
-		  * ABI.  In that case print_objc_segment() will determine that
-		  * and return FALSE.
-		  */
-		 if(print_objc_segment(mh_cputype, ofile->load_commands,
-			mh_ncmds, mh_sizeofcmds, ofile->object_byte_sex,
-			ofile->object_addr, ofile->object_size, sorted_symbols,
-			nsorted_symbols, vflag) == FALSE){
-		    get_linked_reloc_info(ofile->load_commands, mh_ncmds,
-			    mh_sizeofcmds, ofile->object_byte_sex,
-			    ofile->object_addr, ofile->object_size, &ext_relocs,
-			    &next_relocs, &loc_relocs, &nloc_relocs);
-		    /* create aligned relocations entries as needed */
-		    relocs = NULL;
-		    nrelocs = 0;
-		    if((intptr_t)ext_relocs % sizeof(int32_t) != 0 ||
-		       ofile->object_byte_sex != get_host_byte_sex()){
-			relocs = allocate(next_relocs *
-					  sizeof(struct relocation_info));
-			memcpy(relocs, ext_relocs, next_relocs *
-			       sizeof(struct relocation_info));
-			ext_relocs = relocs;
-		    }
-		    if((intptr_t)loc_relocs % sizeof(int32_t) != 0 ||
-		       ofile->object_byte_sex != get_host_byte_sex()){
-			relocs = allocate(nloc_relocs *
-					  sizeof(struct relocation_info));
-			memcpy(relocs, loc_relocs, nloc_relocs *
-			       sizeof(struct relocation_info));
-			loc_relocs = relocs;
-		    }
-		    if(ofile->object_byte_sex != get_host_byte_sex()){
-			swap_relocation_info(ext_relocs, next_relocs,
-					     get_host_byte_sex());
-			swap_relocation_info(loc_relocs, nloc_relocs,
-					     get_host_byte_sex());
-		    }
-		    print_objc2_32bit(mh_cputype, ofile->load_commands,
-			    mh_ncmds, mh_sizeofcmds, ofile->object_byte_sex,
-			    ofile->object_addr, ofile->object_size, symbols,
-			    nsymbols, strings, strings_size, sorted_symbols,
-			    nsorted_symbols, ext_relocs, next_relocs,
-			    loc_relocs, nloc_relocs, vflag);
-		}
-	    }
-	}
-
-	if(load_commands != NULL)
-	    free(load_commands);
-	if(allocated_symbols != NULL)
-	    free(allocated_symbols);
-	if(sorted_symbols != NULL)
-	    free(sorted_symbols);
-	if(allocated_indirect_symbols != NULL)
-	    free(allocated_indirect_symbols);
-	if(allocated_hints != NULL)
-	    free(allocated_hints);
-	if(allocated_dices != NULL)
-	    free(allocated_dices);
-	if(allocated_tocs != NULL)
-	    free(allocated_tocs);
-	if(allocated_mods != NULL)
-	    free(allocated_mods);
-	if(allocated_refs != NULL)
-	    free(allocated_refs);
-	if(dbi != NULL)
-	    free(dbi);
-}
-
-/*
- * get_symbol_table_info() returns pointers to the symbol table and string
- * table as well as the number of symbols and size of the string table.
- * This routine handles the problems related to the file being truncated and
- * only returns valid pointers and sizes that can be used.  This routine will
- * return pointers that are misaligned and it is up to the caller to deal with
- * alignment issues.  It is also up to the caller to deal with byte sex of the
- * the symbol table.
- */
-static
-void
-get_symbol_table_info(
-struct load_command *load_commands,	/* input */
-uint32_t ncmds,
-uint32_t sizeofcmds,
-cpu_type_t cputype,
-enum byte_sex load_commands_byte_sex,
-char *object_addr,
-uint32_t object_size,
-struct nlist **symbols,			/* output */
-struct nlist_64 **symbols64,
-uint32_t *nsymbols,
-char **strings,
-uint32_t *strings_size)
-{
-    enum byte_sex host_byte_sex;
-    enum bool swapped;
-    uint32_t i, left, size, st_cmd;
-    struct load_command *lc, l;
-    struct symtab_command st;
-    uint64_t bigsize;
-
-	*symbols = NULL;
-	*symbols64 = NULL;
-	*nsymbols = 0;
-	*strings = NULL;
-	*strings_size = 0;
-
-	host_byte_sex = get_host_byte_sex();
-	swapped = host_byte_sex != load_commands_byte_sex;
-
-	st_cmd = UINT_MAX;
-	lc = load_commands;
-	memset((char *)&st, '\0', sizeof(struct symtab_command));
-	for(i = 0 ; i < ncmds; i++){
-	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
-	    if(swapped)
-		swap_load_command(&l, host_byte_sex);
-	    if(l.cmdsize % sizeof(int32_t) != 0)
-		printf("load command %u size not a multiple of "
-		       "sizeof(int32_t)\n", i);
-	    if((char *)lc + l.cmdsize >
-	       (char *)load_commands + sizeofcmds)
-		printf("load command %u extends past end of load "
-		       "commands\n", i);
-	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
-
-	    switch(l.cmd){
-	    case LC_SYMTAB:
-		if(st_cmd != UINT_MAX){
-		    printf("more than one LC_SYMTAB command (using command %u)"
-			   "\n", st_cmd);
-		    break;
-		}
-		size = left < sizeof(struct symtab_command) ?
-		       left : sizeof(struct symtab_command);
-		memcpy((char *)&st, (char *)lc, size);
-		if(swapped)
-		    swap_symtab_command(&st, host_byte_sex);
-		st_cmd = i;
-	    }
-	    if(l.cmdsize == 0){
-		printf("load command %u size zero (can't advance to other "
-		       "load commands)\n", i);
-		break;
-	    }
-	    lc = (struct load_command *)((char *)lc + l.cmdsize);
-	    if((char *)lc > (char *)load_commands + sizeofcmds)
-		break;
-	}
-	if((char *)load_commands + sizeofcmds != (char *)lc)
-	    printf("Inconsistent sizeofcmds\n");
-
-	if(st_cmd == UINT_MAX){
-	    return;
-	}
-
-	if(st.symoff >= object_size){
-	    printf("symbol table offset is past end of file\n");
-	}
-	else{
-	    if(cputype & CPU_ARCH_ABI64){
-		*symbols64 = (struct nlist_64 *)(object_addr + st.symoff);
-		bigsize = st.nsyms;
-		bigsize *= sizeof(struct nlist_64);
-		bigsize += st.symoff; 
-		if(bigsize > object_size){
-		    printf("symbol table extends past end of file\n");
-		    *nsymbols = (object_size - st.symoff) /
-			        sizeof(struct nlist_64);
-		}
-		else
-		    *nsymbols = st.nsyms;
-	    }
-	    else{
-		*symbols = (struct nlist *)(object_addr + st.symoff);
-		bigsize = st.nsyms;
-		bigsize *= sizeof(struct nlist);
-		bigsize += st.symoff; 
-		if(bigsize > object_size){
-		    printf("symbol table extends past end of file\n");
-		    *nsymbols = (object_size - st.symoff) /
-			        sizeof(struct nlist);
-		}
-		else
-		    *nsymbols = st.nsyms;
-	    }
-	}
-
-	if(st.stroff >= object_size){
-	    printf("string table offset is past end of file\n");
-	}
-	else{
-	    *strings = object_addr + st.stroff;
-	    if(st.stroff + st.strsize > object_size){
-		printf("string table extends past end of file\n");
-	    }
-	    else
-		*strings_size = st.strsize;
-	}
-}
-
-/*
- * get_toc_info() returns a pointer and the size of the table of contents.
- * This routine handles the problems related to the file being truncated and
- * only returns valid pointers and sizes that can be used.  This routine will
- * return pointers that are misaligned and it is up to the caller to deal with
- * alignment issues.  It is also up to the caller to deal with byte sex of the
- * table.
- */
-static
-void
-get_toc_info(
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum byte_sex load_commands_byte_sex,
-char *object_addr,
-uint32_t object_size,
-struct dylib_table_of_contents **tocs,	/* output */
-uint32_t *ntocs)
-{
-    struct dysymtab_command dyst;
-    uint64_t bigsize;
-
-	*tocs = NULL;
-	*ntocs = 0;
-
-	if(get_dyst(load_commands, ncmds, sizeofcmds, load_commands_byte_sex,
-		    &dyst) == FALSE)
-	    return;
-
-	if(dyst.tocoff >= object_size){
-	    printf("table of contents offset is past end of file\n");
-	}
-	else{
-	    *tocs = (struct dylib_table_of_contents *)(object_addr +
-						       dyst.tocoff);
-	    bigsize = dyst.ntoc;
-	    bigsize *= sizeof(struct dylib_table_of_contents);
-	    bigsize += dyst.tocoff;
-	    if(bigsize > object_size){
-		printf("table of contents extends past end of file\n");
-		*ntocs = (object_size - dyst.tocoff) /
-				     sizeof(struct dylib_table_of_contents);
-	    }
-	    else
-		*ntocs = dyst.ntoc;
-	}
-}
-
-/*
- * get_module_table_info() returns a pointer and the size of the
- * module table.  This routine handles the problems related to the file being
- * truncated and only returns valid pointers and sizes that can be used.  This
- * routine will return pointers that are misaligned and it is up to the caller
- * to deal with alignment issues.  It is also up to the caller to deal with
- * byte sex of the table.
- */
-static
-void
-get_module_table_info(
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-cpu_type_t cputype,
-enum byte_sex load_commands_byte_sex,
-char *object_addr,
-uint32_t object_size,
-struct dylib_module **mods,			/* output */
-struct dylib_module_64 **mods64,
-uint32_t *nmods)
-{
-    struct dysymtab_command dyst;
-    uint64_t bigsize;
-
-	*mods = NULL;
-	*mods64 = NULL;
-	*nmods = 0;
-
-	if(get_dyst(load_commands, ncmds, sizeofcmds, load_commands_byte_sex,
-		    &dyst) == FALSE)
-	    return;
-
-	if(dyst.modtaboff >= object_size){
-	    printf("module table offset is past end of file\n");
-	}
-	else{
-	    if(cputype & CPU_ARCH_ABI64){
-		*mods64 = (struct dylib_module_64 *)(object_addr +
-						     dyst.modtaboff);
-		bigsize = dyst.nmodtab;
-		bigsize *= sizeof(struct dylib_module_64);
-		bigsize += dyst.modtaboff;
-		if(bigsize > object_size){
-		    printf("module table extends past end of file\n");
-		    *nmods = (object_size - dyst.modtaboff) /
-					 sizeof(struct dylib_module_64);
-		}
-		else
-		    *nmods = dyst.nmodtab;
-	    }
-	    else{
-		*mods = (struct dylib_module *)(object_addr + dyst.modtaboff);
-		if(dyst.modtaboff +
-		   dyst.nmodtab * sizeof(struct dylib_module) > object_size){
-		    printf("module table extends past end of file\n");
-		    *nmods = (object_size - dyst.modtaboff) /
-					 sizeof(struct dylib_module);
-		}
-		else
-		    *nmods = dyst.nmodtab;
-	    }
-	}
-}
-
-/*
- * get_ref_info() returns a pointer and the size of the reference table.
- * This routine handles the problems related to the file being truncated and
- * only returns valid pointers and sizes that can be used.  This routine will
- * return pointers that are misaligned and it is up to the caller to deal with
- * alignment issues.  It is also up to the caller to deal with byte sex of the
- * table.
- */
-static
-void
-get_ref_info(
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum byte_sex load_commands_byte_sex,
-char *object_addr,
-uint32_t object_size,
-struct dylib_reference **refs,		/* output */
-uint32_t *nrefs)
-{
-    struct dysymtab_command dyst;
-    uint64_t bigsize;
-
-	*refs = NULL;
-	*nrefs = 0;
-
-	if(get_dyst(load_commands, ncmds, sizeofcmds, load_commands_byte_sex,
-		    &dyst) == FALSE)
-	    return;
-
-	if(dyst.extrefsymoff >= object_size){
-	    printf("reference table offset is past end of file\n");
-	}
-	else{
-	    *refs = (struct dylib_reference *)(object_addr + dyst.extrefsymoff);
-	    bigsize = dyst.nextrefsyms;
-	    bigsize *= sizeof(struct dylib_reference);
-	    bigsize += dyst.extrefsymoff;
-	    if(bigsize > object_size){
-		printf("reference table extends past end of file\n");
-		*nrefs = (object_size - dyst.extrefsymoff) /
-				     sizeof(struct dylib_reference);
-	    }
-	    else
-		*nrefs = dyst.nextrefsyms;
-	}
-}
-
-/*
- * get_indirect_symbol_table_info() returns a pointer and the size of the
- * indirect symbol table.  This routine handles the problems related to the
- * file being truncated and only returns valid pointers and sizes that can be
- * used.  This routine will return pointers that are misaligned and it is up to
- * the caller to deal with alignment issues.  It is also up to the caller to
- * deal with byte sex of the table.
- */
-static
-void
-get_indirect_symbol_table_info(
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum byte_sex load_commands_byte_sex,
-char *object_addr,
-uint32_t object_size,
-uint32_t **indirect_symbols,	/* output */
-uint32_t *nindirect_symbols)
-{
-    struct dysymtab_command dyst;
-    uint64_t bigsize;
-
-	*indirect_symbols = NULL;
-	*nindirect_symbols = 0;
-
-	if(get_dyst(load_commands, ncmds, sizeofcmds, load_commands_byte_sex,
-		    &dyst) == FALSE)
-	    return;
-
-	if(dyst.indirectsymoff >= object_size){
-	    printf("indirect symbol table offset is past end of file\n");
-	}
-	else{
-	    *indirect_symbols = (uint32_t *)(object_addr + dyst.indirectsymoff);
-	    bigsize = dyst.nindirectsyms;
-	    bigsize *= sizeof(uint32_t);
-	    bigsize += dyst.indirectsymoff;
-	    if(bigsize > object_size){
-		printf("indirect symbol table extends past end of file\n");
-		*nindirect_symbols = (object_size - dyst.indirectsymoff) /
-				     sizeof(uint32_t);
-	    }
-	    else
-		*nindirect_symbols = dyst.nindirectsyms;
-	}
-}
-
-/*
- * get_dyst() gets the dysymtab_command from the mach header and load commands
- * passed to it and copys it into dyst.  It if doesn't find one it returns FALSE
- * else it returns TRUE.
- */
-static
-enum bool
-get_dyst(
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum byte_sex load_commands_byte_sex,
-struct dysymtab_command *dyst)
-{
-    enum byte_sex host_byte_sex;
-    enum bool swapped;
-    uint32_t i, left, size, dyst_cmd;
-    struct load_command *lc, l;
-
-	host_byte_sex = get_host_byte_sex();
-	swapped = host_byte_sex != load_commands_byte_sex;
-
-	dyst_cmd = UINT_MAX;
-	lc = load_commands;
-	for(i = 0 ; i < ncmds; i++){
-	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
-	    if(swapped)
-		swap_load_command(&l, host_byte_sex);
-	    if(l.cmdsize % sizeof(int32_t) != 0)
-		printf("load command %u size not a multiple of "
-		       "sizeof(int32_t)\n", i);
-	    if((char *)lc + l.cmdsize >
-	       (char *)load_commands + sizeofcmds)
-		printf("load command %u extends past end of load "
-		       "commands\n", i);
-	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
-
-	    switch(l.cmd){
-	    case LC_DYSYMTAB:
-		if(dyst_cmd != UINT_MAX){
-		    printf("more than one LC_DYSYMTAB command (using command "
-			   "%u)\n", dyst_cmd);
-		    break;
-		}
-		memset((char *)dyst, '\0', sizeof(struct dysymtab_command));
-		size = left < sizeof(struct dysymtab_command) ?
-		       left : sizeof(struct dysymtab_command);
-		memcpy((char *)dyst, (char *)lc, size);
-		if(swapped)
-		    swap_dysymtab_command(dyst, host_byte_sex);
-		dyst_cmd = i;
-	    }
-	    if(l.cmdsize == 0){
-		printf("load command %u size zero (can't advance to other "
-		       "load commands)\n", i);
-		break;
-	    }
-	    lc = (struct load_command *)((char *)lc + l.cmdsize);
-	    if((char *)lc > (char *)load_commands + sizeofcmds)
-		break;
-	}
-	if((char *)load_commands + sizeofcmds != (char *)lc)
-	    printf("Inconsistent sizeofcmds\n");
-
-	if(dyst_cmd == UINT_MAX){
-	    return(FALSE);
-	}
-	return(TRUE);
-}
-
-/*
- * get_hints_table_info() returns a pointer and the size of the two-level hints
- * table.  This routine handles the problems related to the file being truncated
- * and only returns valid pointers and sizes that can be used.  This routine
- * will return pointers that are misaligned and it is up to the caller to deal
- * with alignment issues.  It is also up to the caller to deal with byte sex of
- * the table.
- */
-static
-void
-get_hints_table_info(
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum byte_sex load_commands_byte_sex,
-char *object_addr,
-uint32_t object_size,
-struct twolevel_hint **hints,	/* output */
-uint32_t *nhints)
-{
-    struct twolevel_hints_command hints_cmd;
-    uint64_t bigsize;
-
-	*hints = NULL;
-	*nhints = 0;
-
-	memset(&hints_cmd, '\0', sizeof(struct twolevel_hints_command));
-	if(get_hints_cmd(load_commands, ncmds, sizeofcmds,
-		         load_commands_byte_sex, &hints_cmd) == FALSE)
-	    return;
-
-	if(hints_cmd.offset >= object_size){
-	    printf("two-level hints offset is past end of file\n");
-	}
-	else{
-	    *hints = (struct twolevel_hint *)(object_addr + hints_cmd.offset);
-	    bigsize = hints_cmd.nhints;
-	    bigsize *= sizeof(struct twolevel_hint);
-	    bigsize += hints_cmd.offset;
-	    if(bigsize > object_size){
-		printf("two-level hints table extends past end of file\n");
-		*nhints = (object_size - hints_cmd.offset) /
-			  sizeof(struct twolevel_hint);
-	    }
-	    else
-		*nhints = hints_cmd.nhints;
-	}
-}
-
-/*
- * get_hints_cmd() gets the twolevel_hints_command from the mach header and
- * load commands passed to it and copys it into hints_cmd.  It if doesn't find
- * one it returns FALSE else it returns TRUE.
- */
-static
-enum bool
-get_hints_cmd(
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum byte_sex load_commands_byte_sex,
-struct twolevel_hints_command *hints_cmd)
-{
-    enum byte_sex host_byte_sex;
-    enum bool swapped;
-    uint32_t i, left, size, cmd;
-    struct load_command *lc, l;
-
-	host_byte_sex = get_host_byte_sex();
-	swapped = host_byte_sex != load_commands_byte_sex;
-
-	cmd = UINT_MAX;
-	lc = load_commands;
-	for(i = 0 ; i < ncmds; i++){
-	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
-	    if(swapped)
-		swap_load_command(&l, host_byte_sex);
-	    if(l.cmdsize % sizeof(int32_t) != 0)
-		printf("load command %u size not a multiple of "
-		       "sizeof(int32_t)\n", i);
-	    if((char *)lc + l.cmdsize >
-	       (char *)load_commands + sizeofcmds)
-		printf("load command %u extends past end of load "
-		       "commands\n", i);
-	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
-
-	    switch(l.cmd){
-	    case LC_TWOLEVEL_HINTS:
-		if(cmd != UINT_MAX){
-		    printf("more than one LC_TWOLEVEL_HINTS command (using "
-			   "command %u)\n", cmd);
-		    break;
-		}
-		memset((char *)hints_cmd, '\0',
-		       sizeof(struct twolevel_hints_command));
-		size = left < sizeof(struct twolevel_hints_command) ?
-		       left : sizeof(struct twolevel_hints_command);
-		memcpy((char *)hints_cmd, (char *)lc, size);
-		if(swapped)
-		    swap_twolevel_hints_command(hints_cmd, host_byte_sex);
-		cmd = i;
-	    }
-	    if(l.cmdsize == 0){
-		printf("load command %u size zero (can't advance to other "
-		       "load commands)\n", i);
-		break;
-	    }
-	    lc = (struct load_command *)((char *)lc + l.cmdsize);
-	    if((char *)lc > (char *)load_commands + sizeofcmds)
-		break;
-	}
-	if((char *)load_commands + sizeofcmds != (char *)lc)
-	    printf("Inconsistent sizeofcmds\n");
-
-	if(cmd == UINT_MAX){
-	    return(FALSE);
-	}
-	return(TRUE);
-}
-
-/*
- * get_link_opt_hints() returns a pointer and the size of the linker
- * optimization hints table.  This routine handles the problems related to the
- * file being truncated and only returns valid pointers and sizes that can be
- * used.  
- */
-static
-void
-get_link_opt_hints(
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum byte_sex load_commands_byte_sex,
-char *object_addr,
-uint32_t object_size,
-char **loh,
-uint32_t *nloh)
-{
-    struct linkedit_data_command loh_cmd;
-    uint64_t bigsize;
-
-	*loh = NULL;
-	*nloh = 0;
-
-	memset(&loh_cmd, '\0', sizeof(struct linkedit_data_command));
-	if(get_link_opt_hint_cmd(load_commands, ncmds, sizeofcmds,
-		                 load_commands_byte_sex, &loh_cmd) == FALSE)
-	    return;
-
-	if(loh_cmd.dataoff >= object_size){
-	    printf("linker optimization hints offset is past end of file\n");
-	}
-	else{
-	    *loh = object_addr + loh_cmd.dataoff;
-	    bigsize = loh_cmd.dataoff;
-	    bigsize += loh_cmd.datasize;
-	    if(bigsize > object_size){
-		printf("linker optimization hints extends past end of file\n");
-		*nloh = object_size - loh_cmd.dataoff;
-	    }
-	    else
-	    *nloh = loh_cmd.datasize;
-	}
-}
-
-/*
- * get_link_opt_hint_cmd() gets the linker optimization hint command from the
- * mach header and load commands passed to it and copys it into loh_cmd.  It if
- * doesn't find one it returns FALSE else it returns TRUE.
- */
-static
-enum bool
-get_link_opt_hint_cmd(
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum byte_sex load_commands_byte_sex,
-struct linkedit_data_command *loh_cmd)
-{
-    enum byte_sex host_byte_sex;
-    enum bool swapped;
-    uint32_t i, left, size, cmd;
-    struct load_command *lc, l;
-
-	host_byte_sex = get_host_byte_sex();
-	swapped = host_byte_sex != load_commands_byte_sex;
-
-	cmd = UINT_MAX;
-	lc = load_commands;
-	for(i = 0 ; i < ncmds; i++){
-	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
-	    if(swapped)
-		swap_load_command(&l, host_byte_sex);
-	    if(l.cmdsize % sizeof(int32_t) != 0)
-		printf("load command %u size not a multiple of "
-		       "sizeof(int32_t)\n", i);
-	    if((char *)lc + l.cmdsize >
-	       (char *)load_commands + sizeofcmds)
-		printf("load command %u extends past end of load "
-		       "commands\n", i);
-	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
-
-	    switch(l.cmd){
-	    case LC_LINKER_OPTIMIZATION_HINT:
-		if(cmd != UINT_MAX){
-		    printf("more than one LC_LINKER_OPTIMIZATION_HINT command "
-			   "(using command %u)\n", cmd);
-		    break;
-		}
-		memset((char *)loh_cmd, '\0',
-		       sizeof(struct linkedit_data_command));
-		size = left < sizeof(struct linkedit_data_command) ?
-		       left : sizeof(struct linkedit_data_command);
-		memcpy((char *)loh_cmd, (char *)lc, size);
-		if(swapped)
-		    swap_linkedit_data_command(loh_cmd, host_byte_sex);
-		cmd = i;
-	    }
-	    if(l.cmdsize == 0){
-		printf("load command %u size zero (can't advance to other "
-		       "load commands)\n", i);
-		break;
-	    }
-	    lc = (struct load_command *)((char *)lc + l.cmdsize);
-	    if((char *)lc > (char *)load_commands + sizeofcmds)
-		break;
-	}
-	if((char *)load_commands + sizeofcmds != (char *)lc)
-	    printf("Inconsistent sizeofcmds\n");
-
-	if(cmd == UINT_MAX){
-	    return(FALSE);
-	}
-	return(TRUE);
-}
-
-/*
- * get_data_in_code_info() returns a pointer and the size of the data in code
- * table.  This routine handles the problems related to the file being truncated
- * and only returns valid pointers and sizes that can be used.  This routine
- * will return pointers that are misaligned and it is up to the caller to deal
- * with alignment issues.  It is also up to the caller to deal with byte sex of
- * the table.
- */
-static
-void
-get_data_in_code_info(
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum byte_sex load_commands_byte_sex,
-char *object_addr,
-uint32_t object_size,
-struct data_in_code_entry **dices,	/* output */
-uint32_t *ndices)
-{
-    struct linkedit_data_command dices_cmd;
-    uint64_t bigsize;
-
-	*dices = NULL;
-	*ndices = 0;
-
-	memset(&dices_cmd, '\0', sizeof(struct linkedit_data_command));
-	if(get_dices_cmd(load_commands, ncmds, sizeofcmds,
-		         load_commands_byte_sex, &dices_cmd) == FALSE)
-	    return;
-
-	if(dices_cmd.dataoff >= object_size){
-	    printf("data in code offset is past end of file\n");
-	}
-	else{
-	    *dices = (struct data_in_code_entry *)
-		     (object_addr + dices_cmd.dataoff);
-	    bigsize = dices_cmd.datasize;
-	    bigsize += dices_cmd.dataoff;
-	    if(bigsize > object_size){
-		printf("data in code table extends past end of file\n");
-		*ndices = (object_size - dices_cmd.dataoff) /
-			  sizeof(struct data_in_code_entry);
-	    }
-	    else
-		*ndices = dices_cmd.datasize /
-			  sizeof(struct data_in_code_entry);
-	}
-}
-
-/*
- * get_dices_cmd() gets the linkedit_data_command for the data in code from the
- * mach header and load commands passed to it and copys it into dices_cmd.  It
- * if doesn't find one it returns FALSE else it returns TRUE.
- */
-static
-enum bool
-get_dices_cmd(
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum byte_sex load_commands_byte_sex,
-struct linkedit_data_command *dices_cmd)
-{
-    enum byte_sex host_byte_sex;
-    enum bool swapped;
-    uint32_t i, left, size, cmd;
-    struct load_command *lc, l;
-
-	host_byte_sex = get_host_byte_sex();
-	swapped = host_byte_sex != load_commands_byte_sex;
-
-	cmd = UINT_MAX;
-	lc = load_commands;
-	for(i = 0 ; i < ncmds; i++){
-	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
-	    if(swapped)
-		swap_load_command(&l, host_byte_sex);
-	    if(l.cmdsize % sizeof(int32_t) != 0)
-		printf("load command %u size not a multiple of "
-		       "sizeof(int32_t)\n", i);
-	    if((char *)lc + l.cmdsize >
-	       (char *)load_commands + sizeofcmds)
-		printf("load command %u extends past end of load "
-		       "commands\n", i);
-	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
-
-	    switch(l.cmd){
-	    case LC_DATA_IN_CODE:
-		if(cmd != UINT_MAX){
-		    printf("more than one LC_DATA_IN_CODE command (using "
-			   "command %u)\n", cmd);
-		    break;
-		}
-		memset((char *)dices_cmd, '\0',
-		       sizeof(struct linkedit_data_command));
-		size = left < sizeof(struct linkedit_data_command) ?
-		       left : sizeof(struct linkedit_data_command);
-		memcpy((char *)dices_cmd, (char *)lc, size);
-		if(swapped)
-		    swap_linkedit_data_command(dices_cmd, host_byte_sex);
-		cmd = i;
-	    }
-	    if(l.cmdsize == 0){
-		printf("load command %u size zero (can't advance to other "
-		       "load commands)\n", i);
-		break;
-	    }
-	    lc = (struct load_command *)((char *)lc + l.cmdsize);
-	    if((char *)lc > (char *)load_commands + sizeofcmds)
-		break;
-	}
-	if((char *)load_commands + sizeofcmds != (char *)lc)
-	    printf("Inconsistent sizeofcmds\n");
-
-	if(cmd == UINT_MAX){
-	    return(FALSE);
-	}
-	return(TRUE);
-}
-
-/*
- * Function for qsort for comparing symbols.
- */
-static
-int
-sym_compare(
-struct symbol *sym1,
-struct symbol *sym2)
-{
-	if(sym1->n_value == sym2->n_value)
-	    return(0);
-	if(sym1->n_value < sym2->n_value)
-	    return(-1);
-	else
-	    return(1);
-}
-
-/*
- * Function for qsort for comparing relocation entries.
- */
-static
-int
-rel_compare(
-struct relocation_info *rel1,
-struct relocation_info *rel2)
-{
-    struct scattered_relocation_info *srel;
-    uint32_t r_address1, r_address2;
-
-	if((rel1->r_address & R_SCATTERED) != 0){
-	    srel = (struct scattered_relocation_info *)rel1;
-	    r_address1 = srel->r_address;
-	}
-	else
-	    r_address1 = rel1->r_address;
-	if((rel2->r_address & R_SCATTERED) != 0){
-	    srel = (struct scattered_relocation_info *)rel2;
-	    r_address2 = srel->r_address;
-	}
-	else
-	    r_address2 = rel2->r_address;
-
-	if(r_address1 == r_address2)
-	    return(0);
-	if(r_address1 < r_address2)
-	    return(-1);
-	else
-	    return(1);
-}
-
-enum bool
-get_sect_info(
-char *segname,				/* input */
-char *sectname,
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-uint32_t filetype,
-enum byte_sex load_commands_byte_sex,
-char *object_addr,
-uint32_t object_size,
-char **sect_pointer,			/* output */
-uint64_t *sect_size,
-uint64_t *sect_addr,
-struct relocation_info **sect_relocs,
-uint32_t *sect_nrelocs,
-uint32_t *sect_flags,
-uint64_t *seg_addr)
-{
-    enum byte_sex host_byte_sex;
-    enum bool found, swapped;
-    uint32_t i, j, left, size;
-    struct load_command *lc, l;
-    uint32_t cmd;
-    struct segment_command sg;
-    struct segment_command_64 sg64;
-    struct section s;
-    struct section_64 s64;
-    char *p;
-
-	*sect_pointer = NULL;
-	*sect_size = 0;
-	*sect_addr = 0;
-	*sect_relocs = NULL;
-	*sect_nrelocs = 0;
-	*sect_flags = 0;
-
-	found = FALSE;
-	cmd = 0;
-	host_byte_sex = get_host_byte_sex();
-	swapped = host_byte_sex != load_commands_byte_sex;
-
-	lc = load_commands;
-	for(i = 0 ; found == FALSE && i < ncmds; i++){
-	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
-	    if(swapped)
-		swap_load_command(&l, host_byte_sex);
-	    if(l.cmdsize % sizeof(int32_t) != 0)
-		printf("load command %u size not a multiple of "
-		       "sizeof(int32_t)\n", i);
-	    if((char *)lc + l.cmdsize >
-	       (char *)load_commands + sizeofcmds)
-		printf("load command %u extends past end of load "
-		       "commands\n", i);
-	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
-
-	    switch(l.cmd){
-	    case LC_SEGMENT:
-		memset((char *)&sg, '\0', sizeof(struct segment_command));
-		size = left < sizeof(struct segment_command) ?
-		       left : sizeof(struct segment_command);
-		memcpy((char *)&sg, (char *)lc, size);
-		if(swapped)
-		    swap_segment_command(&sg, host_byte_sex);
-
-		if((filetype == MH_OBJECT && sg.segname[0] == '\0') ||
-		   strncmp(sg.segname, segname, sizeof(sg.segname)) == 0){
-                    *seg_addr = sg.vmaddr;
-		    p = (char *)lc + sizeof(struct segment_command);
-		    for(j = 0 ; found == FALSE && j < sg.nsects ; j++){
-			if(p + sizeof(struct section) >
-			   (char *)load_commands + sizeofcmds){
-			    printf("section structure command extends past "
-				   "end of load commands\n");
-			}
-			left = sizeofcmds - (p - (char *)load_commands);
-			memset((char *)&s, '\0', sizeof(struct section));
-			size = left < sizeof(struct section) ?
-			       left : sizeof(struct section);
-			memcpy((char *)&s, p, size);
-			if(swapped)
-			    swap_section(&s, 1, host_byte_sex);
-
-			if(strncmp(s.sectname, sectname,
-				   sizeof(s.sectname)) == 0 &&
-			   strncmp(s.segname, segname,
-				   sizeof(s.segname)) == 0){
-			    found = TRUE;
-			    cmd = LC_SEGMENT;
-			    break;
-			}
-
-			if(p + sizeof(struct section) >
-			   (char *)load_commands + sizeofcmds)
-			    return(FALSE);
-			p += size;
-		    }
-		}
-		break;
-	    case LC_SEGMENT_64:
-		memset((char *)&sg64, '\0', sizeof(struct segment_command_64));
-		size = left < sizeof(struct segment_command_64) ?
-		       left : sizeof(struct segment_command_64);
-		memcpy((char *)&sg64, (char *)lc, size);
-		if(swapped)
-		    swap_segment_command_64(&sg64, host_byte_sex);
-
-		if((filetype == MH_OBJECT && sg64.segname[0] == '\0') ||
-		   strncmp(sg64.segname, segname, sizeof(sg64.segname)) == 0){
-                    *seg_addr = sg.vmaddr;
-		    p = (char *)lc + sizeof(struct segment_command_64);
-		    for(j = 0 ; found == FALSE && j < sg64.nsects ; j++){
-			if(p + sizeof(struct section_64) >
-			   (char *)load_commands + sizeofcmds){
-			    printf("section structure command extends past "
-				   "end of load commands\n");
-			}
-			left = sizeofcmds - (p - (char *)load_commands);
-			memset((char *)&s64, '\0', sizeof(struct section_64));
-			size = left < sizeof(struct section_64) ?
-			       left : sizeof(struct section_64);
-			memcpy((char *)&s64, p, size);
-			if(swapped)
-			    swap_section_64(&s64, 1, host_byte_sex);
-
-			if(strncmp(s64.sectname, sectname,
-				   sizeof(s64.sectname)) == 0 &&
-			   strncmp(s64.segname, segname,
-				   sizeof(s64.segname)) == 0){
-			    found = TRUE;
-			    cmd = LC_SEGMENT_64;
-			    break;
-			}
-
-			if(p + sizeof(struct section_64) >
-			   (char *)load_commands + sizeofcmds)
-			    return(FALSE);
-			p += size;
-		    }
-		}
-		break;
-	    }
-	    if(l.cmdsize == 0){
-		printf("load command %u size zero (can't advance to other "
-		       "load commands)\n", i);
-		break;
-	    }
-	    lc = (struct load_command *)((char *)lc + l.cmdsize);
-	    if((char *)lc > (char *)load_commands + sizeofcmds)
-		break;
-	}
-	if(found == FALSE)
-	    return(FALSE);
-
-	if(cmd == LC_SEGMENT){
-	    if((s.flags & SECTION_TYPE) == S_ZEROFILL){
-		*sect_pointer = NULL;
-		*sect_size = s.size;
-	    }
-	    else{
-		if(s.offset > object_size){
-		    printf("section offset for section (%.16s,%.16s) is past "
-			   "end of file\n", s.segname, s.sectname);
-		}
-		else{
-		    *sect_pointer = object_addr + s.offset;
-		    if(s.size > object_size ||
-		       s.offset + s.size > object_size){
-			printf("section (%.16s,%.16s) extends past end of "
-			       "file\n", s.segname, s.sectname);
-			*sect_size = object_size - s.offset;
-		    }
-		    else
-			*sect_size = s.size;
-		}
-	    }
-	    if(s.reloff >= object_size){
-		printf("relocation entries offset for (%.16s,%.16s): is past "
-		       "end of file\n", s.segname, s.sectname);
-	    }
-	    else{
-		*sect_relocs = (struct relocation_info *)(object_addr +
-							  s.reloff);
-		if(s.reloff + s.nreloc * sizeof(struct relocation_info) >
-								object_size){
-		    printf("relocation entries for section (%.16s,%.16s) "
-			   "extends past end of file\n", s.segname, s.sectname);
-		    *sect_nrelocs = (object_size - s.reloff) /
-				    sizeof(struct relocation_info);
-		}
-		else
-		    *sect_nrelocs = s.nreloc;
-	    }
-	    *sect_addr = s.addr;
-	    *sect_flags = s.flags;
-	}
-	else{
-	    if((s64.flags & SECTION_TYPE) == S_ZEROFILL){
-		*sect_pointer = NULL;
-		*sect_size = s64.size;
-	    }
-	    else{
-		if(s64.offset > object_size){
-		    printf("section offset for section (%.16s,%.16s) is past "
-			   "end of file\n", s64.segname, s64.sectname);
-		}
-		else{
-		    *sect_pointer = object_addr + s64.offset;
-		    if(s64.size > object_size ||
-                       s64.offset + s64.size > object_size){
-			printf("section (%.16s,%.16s) extends past end of "
-			       "file\n", s64.segname, s64.sectname);
-		    }
-		    else
-			*sect_size = s64.size;
-		}
-	    }
-	    if(s64.reloff >= object_size){
-		printf("relocation entries offset for (%.16s,%.16s): is past "
-		       "end of file\n", s64.segname, s64.sectname);
-	    }
-	    else{
-		*sect_relocs = (struct relocation_info *)(object_addr +
-							  s64.reloff);
-		if(s64.reloff + s64.nreloc * sizeof(struct relocation_info) >
-								object_size){
-		    printf("relocation entries for section (%.16s,%.16s) "
-			   "extends past end of file\n", s64.segname,
-			   s64.sectname);
-		    *sect_nrelocs = (object_size - s64.reloff) /
-				    sizeof(struct relocation_info);
-		}
-		else
-		    *sect_nrelocs = s64.nreloc;
-	    }
-	    *sect_addr = s64.addr;
-	    *sect_flags = s64.flags;
-	}
-	return(TRUE);
-}
-
-static
-void
-get_linked_reloc_info(
-struct load_command *load_commands, 	/* input */
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum byte_sex load_commands_byte_sex,
-char *object_addr,
-uint32_t object_size,
-struct relocation_info **ext_relocs,	/* output */
-uint32_t *next_relocs,
-struct relocation_info **loc_relocs,
-uint32_t *nloc_relocs)
-{
-    struct dysymtab_command dyst;
-    uint64_t bigsize;
-
-	*ext_relocs = NULL;
-	*next_relocs = 0;
-	*loc_relocs = NULL;
-	*nloc_relocs = 0;
-
-	if(get_dyst(load_commands, ncmds, sizeofcmds, load_commands_byte_sex,
-		    &dyst) == FALSE)
-	    return;
-
-	if(dyst.extreloff >= object_size){
-	    printf("external relocation entries offset is past end of file\n");
-	}
-	else{
-	    *ext_relocs = (struct relocation_info *)(object_addr +
-			   dyst.extreloff);
-	    bigsize = dyst.nextrel;
-	    bigsize *= sizeof(struct relocation_info);
-	    bigsize += dyst.extreloff;
-	    if(bigsize > object_size){
-		printf("external relocation entries extend past end of file\n");
-		*next_relocs = (object_size - dyst.extreloff) /
-				     sizeof(struct relocation_info);
-	    }
-	    else
-		*next_relocs = dyst.nextrel;
-	}
-	if(dyst.locreloff >= object_size){
-	    printf("local relocation entries offset is past end of file\n");
-	}
-	else{
-	    *loc_relocs = (struct relocation_info *)(object_addr +
-			   dyst.locreloff);
-	    bigsize = dyst.nlocrel;
-	    bigsize *= sizeof(struct relocation_info);
-	    bigsize += dyst.locreloff;
-	    if(bigsize > object_size){
-		printf("local relocation entries extend past end of file\n");
-		*nloc_relocs = (object_size - dyst.locreloff) /
-				     sizeof(struct relocation_info);
-	    }
-	    else
-		*nloc_relocs = dyst.nlocrel;
-	}
-}
-
-/*
- * setup_dyld_bind_info() looks for a LC_DYLD_INFO load command and if it has
- * bind info unpacks it and returns it in dbi and ndbi values for the internal
- * expanded structs.
- */
-static
-void
-setup_dyld_bind_info(
-struct load_command *load_commands, 	/* input */
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum byte_sex load_commands_byte_sex,
-char *object_addr,
-uint32_t object_size,
-struct dyld_bind_info **dbi, /* output */
-uint64_t *ndbi)
-{
-    enum byte_sex host_byte_sex;
-    enum bool swapped, found_bind;
-    uint32_t pass, i, j, left, size, nsegs, nsegs64, ndylibs;
-    uint64_t big_size;
-    struct load_command *lc, l;
-    struct dyld_info_command dyld_info;
-    struct dylib_command dl;
-    struct segment_command sg, **segs;
-    struct segment_command_64 sg64, **segs64;
-    struct section s;
-    struct section_64 s64;
-    char *short_name, *has_suffix;
-    enum bool is_framework;
-    char *p, *a;
-    uint8_t *start, *end;
-    const char **dylibs;
-
-	/* If already setup just return. */
-	if(*dbi != NULL)
-	    return;
-
-	found_bind = FALSE;
-	*dbi = NULL;
-	*ndbi = 0;
-
-	host_byte_sex = get_host_byte_sex();
-	swapped = host_byte_sex != load_commands_byte_sex;
-
-	nsegs = 0;
-	nsegs64 = 0;
-	ndylibs = 0;
-
-	dylibs = NULL;
-	segs = NULL;
-	segs64 = NULL;
-	/*
-	 * Make two passes over the load commands. On the first pass count the
-	 * number of load commands for dylibs and segments and look for an
-	 * LC_DYLD_INFO load commands  If we find the bind info allocate space
-	 * arrays of pointers to dylibs and segments and fill them in on the
-	 * second pass.
-	 */
-	for(pass = 1; pass <= 2; pass++){
-	    ndylibs = 0;
-	    nsegs = 0;
-	    nsegs64 = 0;
-	    lc = load_commands;
-	    for(i = 0 ; i < ncmds; i++){
-		memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
-		if(swapped)
-		    swap_load_command(&l, host_byte_sex);
-		if(l.cmdsize % sizeof(int32_t) != 0)
-		    printf("load command %u size not a multiple of "
-			   "sizeof(int32_t)\n", i);
-		if((char *)lc + l.cmdsize >
-		   (char *)load_commands + sizeofcmds)
-		    printf("load command %u extends past end of load "
-			   "commands\n", i);
-		left = sizeofcmds - ((char *)lc - (char *)load_commands);
-
-		switch(l.cmd){
-
-		case LC_DYLD_INFO:
-		case LC_DYLD_INFO_ONLY:
-		    if(pass == 1){
-			memset((char *)&dyld_info, '\0',
-			       sizeof(struct dyld_info_command));
-			size = left < sizeof(struct dyld_info_command) ?
-			       left : sizeof(struct dyld_info_command);
-			memcpy((char *)&dyld_info, (char *)lc, size);
-			if(swapped)
-			    swap_dyld_info_command(&dyld_info, host_byte_sex);
-			if(dyld_info.bind_off > object_size){
-			    printf("bind_off in LC_DYLD_INFO load command %u "
-				   "past end of file\n", i);
-			    return;
-			}
-			big_size = dyld_info.bind_off;
-			big_size += dyld_info.bind_size;
-        		if(big_size > object_size){
-			    printf("bind_off plus bind_size in LC_DYLD_INFO "
-				   "load command %u past end of file\n", i);
-			    return;
-			}
-			if(found_bind == TRUE){
-			    printf("more than one LC_DYLD_INFO load command\n");
-			    return;
-			}
-			found_bind = TRUE;
-		    }
-		    break;
-
-		case LC_LOAD_DYLIB:
-		case LC_LOAD_WEAK_DYLIB:
-		case LC_REEXPORT_DYLIB:
-		case LC_LOAD_UPWARD_DYLIB:
-		case LC_LAZY_LOAD_DYLIB:
-		    if(pass == 1){
-			ndylibs++;
-		    }
-		    else{
-			memset((char *)&dl, '\0', sizeof(struct dylib_command));
-			size = left < sizeof(struct dylib_command) ?
-			       left : sizeof(struct dylib_command);
-			memcpy((char *)&dl, (char *)lc, size);
-			if(swapped)
-			    swap_dylib_command(&dl, host_byte_sex);
-			if(dl.dylib.name.offset < dl.cmdsize)
-			    p = (char *)lc + dl.dylib.name.offset;
-			else
-			    p = "(bad offset for dylib.name.offset)";
-		        short_name = guess_short_name(p,
-						  &is_framework, &has_suffix);
-			if(short_name != NULL)
-			    dylibs[ndylibs++] = short_name;
-			else
-			    dylibs[ndylibs++] = p;
-		    }
-		    break;
-
-		case LC_SEGMENT:
-		    memset((char *)&sg, '\0', sizeof(struct segment_command));
-		    size = left < sizeof(struct segment_command) ?
-			   left : sizeof(struct segment_command);
-		    memcpy((char *)&sg, (char *)lc, size);
-		    if(swapped)
-			swap_segment_command(&sg, host_byte_sex);
-		    if(pass == 2){
-			a = allocate(sizeof(struct segment_command) +
-				     sg.nsects * sizeof(struct section));
-			memcpy(a, (char *)&sg,
-			       sizeof(struct segment_command));
-			segs[nsegs++] =
-			    (struct segment_command *)a;
-			a += sizeof(struct segment_command);
-		    }
-
-		    p = (char *)lc + sizeof(struct segment_command);
-		    for(j = 0 ; j < sg.nsects ; j++){
-			if(p + sizeof(struct section) >
-			   (char *)load_commands + sizeofcmds){
-			    printf("section structure command extends past "
-				   "end of load commands\n");
-			    return;
-			}
-			left = sizeofcmds - (p - (char *)load_commands);
-			memset((char *)&s, '\0', sizeof(struct section));
-			size = left < sizeof(struct section) ?
-			       left : sizeof(struct section);
-			memcpy((char *)&s, p, size);
-			if(swapped)
-			    swap_section(&s, 1, host_byte_sex);
-			if(pass == 2){
-			    memcpy(a, (char *)&s, sizeof(struct section));
-			    a += sizeof(struct section);
-			}
-			if(p + sizeof(struct section) >
-			   (char *)load_commands + sizeofcmds)
-			    return;
-			p += size;
-		    }
-		    if(pass == 1)
-			nsegs++;
-		    break;
-		case LC_SEGMENT_64:
-		    memset((char *)&sg64, '\0',
-			   sizeof(struct segment_command_64));
-		    size = left < sizeof(struct segment_command_64) ?
-			   left : sizeof(struct segment_command_64);
-		    memcpy((char *)&sg64, (char *)lc, size);
-		    if(swapped)
-			swap_segment_command_64(&sg64, host_byte_sex);
-		    if(pass == 2){
-			a = allocate(sizeof(struct segment_command_64) +
-				     sg64.nsects * sizeof(struct section_64));
-			memcpy(a, (char *)&sg64,
-			       sizeof(struct segment_command_64));
-			segs64[nsegs64++] =
-			    (struct segment_command_64 *)a;
-			a += sizeof(struct segment_command_64);
-		    }
-
-		    p = (char *)lc + sizeof(struct segment_command_64);
-		    for(j = 0 ; j < sg64.nsects ; j++){
-			if(p + sizeof(struct section_64) >
-			   (char *)load_commands + sizeofcmds){
-			    printf("section structure command extends past "
-				   "end of load commands\n");
-			}
-			left = sizeofcmds - (p - (char *)load_commands);
-			memset((char *)&s64, '\0', sizeof(struct section_64));
-			size = left < sizeof(struct section_64) ?
-			       left : sizeof(struct section_64);
-			memcpy((char *)&s64, p, size);
-			if(swapped)
-			    swap_section_64(&s64, 1, host_byte_sex);
-			if(pass == 2){
-			    memcpy(a, (char *)&s64, sizeof(struct section_64));
-			    a += sizeof(struct section_64);
-			}
-			if(p + sizeof(struct section_64) >
-			   (char *)load_commands + sizeofcmds)
-			    return;
-			p += size;
-		    }
-		    if(pass == 1)
-			nsegs64++;
-		    break;
-		}
-		if(l.cmdsize == 0){
-		    printf("load command %u size zero (can't advance to other "
-			   "load commands)\n", i);
-		    break;
-		}
-		lc = (struct load_command *)((char *)lc + l.cmdsize);
-		if((char *)lc > (char *)load_commands + sizeofcmds)
-		    break;
-	    }
-	    if(found_bind == FALSE)
-		return;
-	    if(pass == 1){
-		dylibs = (const char **)allocate(ndylibs * sizeof(char *));
-		segs = (struct segment_command **)allocate(
-				nsegs * sizeof(struct segment_command *));
-		segs64 = (struct segment_command_64 **)allocate(
-				nsegs64 * sizeof(struct segment_command_64 *));
-	    }
-	}
-
-	start = (uint8_t *)(object_addr + dyld_info.bind_off);
-	end = start + dyld_info.bind_size;
-	get_dyld_bind_info(start, end, dylibs, ndylibs, segs, nsegs,
-			   segs64, nsegs64, dbi, ndbi);
-
-	if(dylibs != NULL)
-	    free(dylibs);
-	if(segs != NULL){
-	    for(i = 0; i < nsegs; i++)
-		free(segs[i]);
-	    free(segs);
-	}
-	if(segs64 != NULL){
-	    for(i = 0; i < nsegs64; i++)
-		free(segs64[i]);
-	    free(segs64);
-	}
-}
-
-static
-void
-print_text_by_symbols(
-cpu_type_t cputype,
-enum byte_sex object_byte_sex,
-char *sect,
-uint32_t size,
-uint64_t addr,
-uint32_t sect_flags,
-struct symbol *sorted_symbols,
-uint32_t nsorted_symbols,
-struct nlist *symbols,
-struct nlist_64 *symbols64,
-uint32_t nsymbols,
-char *strings,
-uint32_t strings_size,
-struct relocation_info *relocs,
-uint32_t nrelocs,
-struct relocation_info *ext_relocs,
-uint32_t next_relocs,
-struct relocation_info *loc_relocs,
-uint32_t nloc_relocs,
-struct dyld_bind_info *dbi,
-uint64_t ndbi,
-uint32_t *indirect_symbols,
-uint32_t nindirect_symbols,
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum bool disassemble,
-enum bool verbose,
-cpu_subtype_t cpusubtype,
-char *object_addr,
-uint32_t object_size,
-struct data_in_code_entry *dices,
-uint32_t ndices,
-uint64_t seg_addr)
-{
-    uint32_t i, symbol_size;
-    uint64_t symbol_addr, symbol_offset;
-
-	for(i = 0; i < nsorted_symbols; i++){
-	    symbol_addr = sorted_symbols[i].n_value;
-	    if(symbol_addr < addr || symbol_addr >= addr + size)
-		continue;
-	    symbol_offset = symbol_addr - addr;
-	    if(i+1 < nsorted_symbols &&
-               sorted_symbols[i+1].n_value < addr + size)
-		symbol_size = sorted_symbols[i+1].n_value - symbol_addr;
-	    else
-		symbol_size = (addr + size) - symbol_addr;
-	    print_text(cputype, object_byte_sex, sect + symbol_offset,
-		       symbol_size, symbol_addr, sect_flags, sorted_symbols,
-		       nsorted_symbols, symbols, symbols64, nsymbols, strings,
-		       strings_size, relocs, nrelocs, ext_relocs, next_relocs,
-		       loc_relocs, nloc_relocs, dbi, ndbi, indirect_symbols,
-		       nindirect_symbols, load_commands, ncmds, sizeofcmds,
-		       disassemble, verbose, cpusubtype, object_addr,
-                       object_size, dices, ndices, seg_addr);
-	}
-}
-
-static
-void
-print_text(
-cpu_type_t cputype,
-enum byte_sex object_byte_sex,
-char *sect,
-uint32_t size,
-uint64_t addr,
-uint32_t sect_flags,
-struct symbol *sorted_symbols,
-uint32_t nsorted_symbols,
-struct nlist *symbols,
-struct nlist_64 *symbols64,
-uint32_t nsymbols,
-char *strings,
-uint32_t strings_size,
-struct relocation_info *relocs,
-uint32_t nrelocs,
-struct relocation_info *ext_relocs,
-uint32_t next_relocs,
-struct relocation_info *loc_relocs,
-uint32_t nloc_relocs,
-struct dyld_bind_info *dbi,
-uint64_t ndbi,
-uint32_t *indirect_symbols,
-uint32_t nindirect_symbols,
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-enum bool disassemble,
-enum bool verbose,
-cpu_subtype_t cpusubtype,
-char *object_addr,
-uint32_t object_size,
-struct data_in_code_entry *dices,
-uint32_t ndices,
-uint64_t seg_addr)
-{
-    enum byte_sex host_byte_sex;
-    enum bool swapped;
-    uint32_t i, j, offset, long_word, label_offset;
-    uint64_t cur_addr;
-    unsigned short short_word;
-    unsigned char byte_word;
-    LLVMDisasmContextRef arm64_dc;
-    LLVMDisasmContextRef arm_dc, thumb_dc, i386_dc, x86_64_dc;
-    uint32_t n, ninsts;
-    struct inst *insts;
-    char *sect_start;
-
-	host_byte_sex = get_host_byte_sex();
-	swapped = host_byte_sex != object_byte_sex;
-	arm_dc = NULL;
-	thumb_dc = NULL;
-	i386_dc = NULL;
-	x86_64_dc = NULL;
-	arm64_dc = NULL;
-	n = 0;
-	ninsts = 0;
-	insts = NULL;
-
-	/*
-	 * If the section has a type of S_ZEROFILL then its section contents
-         * pointer is NULL, so in this case just do nothing.
-	 */
-	if(sect == NULL)
-	    return;
-
-	if(disassemble == TRUE){
-	    if(pflag){
-		for(i = 0; i < nsorted_symbols; i++){
-		    if(strcmp(sorted_symbols[i].name, pflag) == 0)
-			break;
-		}
-		if(i == nsorted_symbols){
-		    printf("Can't find -p symbol: %s\n", pflag);
-		    return;
-		}
-		if(sorted_symbols[i].n_value < addr ||
-		   sorted_symbols[i].n_value >= addr + size){
-		    printf("-p symbol: %s not in text section\n", pflag);
-		    return;
-		}
-		offset = sorted_symbols[i].n_value - addr;
-		sect += offset;
-		cur_addr = sorted_symbols[i].n_value;
-		sect_start = sect;
-	    }
-	    else{
-		offset = 0;
-		cur_addr = addr;
-		sect_start = sect;
-	    }
-	    if(cputype == CPU_TYPE_ARM &&
-	       (cpusubtype == CPU_SUBTYPE_ARM_V7 ||
-	        cpusubtype == CPU_SUBTYPE_ARM_V7F ||
-	        cpusubtype == CPU_SUBTYPE_ARM_V7S ||
-	        cpusubtype == CPU_SUBTYPE_ARM_V7K)){
-		if(sect_flags & S_SYMBOL_STUBS)
-		    in_thumb = FALSE;
-		else
-		    in_thumb = TRUE;
-	    }
-	    else
-		in_thumb = FALSE;
-	    if((qflag || gflag) && cputype == CPU_TYPE_ARM){
-		arm_dc = create_arm_llvm_disassembler(cpusubtype);
-		if(arm_dc == NULL){
-		    printf("can't create arm llvm disassembler\n");
-		    return;
-		}
-		thumb_dc = create_thumb_llvm_disassembler(cpusubtype);
-		if(thumb_dc == NULL){
-		    printf("can't create thumb llvm disassembler\n");
-		    return;
-		}
-		llvm_disasm_set_options(arm_dc,
-		    LLVMDisassembler_Option_PrintImmHex);
-		llvm_disasm_set_options(thumb_dc,
-		    LLVMDisassembler_Option_PrintImmHex);
-		if(eflag){
-		    llvm_disasm_set_options(arm_dc,
-			LLVMDisassembler_Option_UseMarkup);
-		    llvm_disasm_set_options(thumb_dc,
-			LLVMDisassembler_Option_UseMarkup);
-		}
-	    }
-	    if((qflag || gflag) && cputype == CPU_TYPE_I386){
-		i386_dc = create_i386_llvm_disassembler();
-		if(i386_dc == NULL){
-		    printf("can't create i386 llvm disassembler\n");
-		    return;
-		}
-		llvm_disasm_set_options(i386_dc,
-		    LLVMDisassembler_Option_PrintImmHex);
-		llvm_disasm_set_options(i386_dc,
-		    LLVMDisassembler_Option_SetInstrComments);
-		if(eflag)
-		    llvm_disasm_set_options(i386_dc,
-			LLVMDisassembler_Option_UseMarkup);
-	    }
-	    if((qflag || gflag) && cputype == CPU_TYPE_X86_64){
-		x86_64_dc = create_x86_64_llvm_disassembler();
-		if(x86_64_dc == NULL){
-		    printf("can't create x86_64 llvm disassembler\n");
-		    return;
-		}
-		llvm_disasm_set_options(x86_64_dc,
-		    LLVMDisassembler_Option_PrintImmHex);
-		llvm_disasm_set_options(x86_64_dc,
-		    LLVMDisassembler_Option_SetInstrComments);
-		if(eflag)
-		    llvm_disasm_set_options(x86_64_dc,
-			LLVMDisassembler_Option_UseMarkup);
-	    }
-	    if(cputype == CPU_TYPE_ARM64){
-		arm64_dc = create_arm64_llvm_disassembler();
-		if(arm64_dc == NULL){
-		    printf("can't create arm64 llvm disassembler\n");
-		    return;
-		}
-		llvm_disasm_set_options(arm64_dc,
-		    LLVMDisassembler_Option_PrintImmHex);
-	    }
-	    if(gflag){
-		ninsts = 100;
-		insts = allocate(sizeof(struct inst) * ninsts);
-	    }
-	    label_offset = 0;
-	    for(i = offset ; i < size ; ){
-		if(gflag &&
-		   (cputype == CPU_TYPE_X86_64 ||
-		    cputype == CPU_TYPE_I386 ||
-		    cputype == CPU_TYPE_ARM)){
-		    if(n > ninsts){
-			ninsts += ninsts;
-			insts = reallocate(insts, sizeof(struct inst) * ninsts);
-		    }
-		    memset(&(insts[n]), '\0', sizeof(struct inst));
-		    insts[n].address = cur_addr;
-		    insts[n].label = get_label(cur_addr, sorted_symbols,
-					       nsorted_symbols);;
-		}
-		else{
-		    if(print_label(cur_addr, TRUE, sorted_symbols,
-				   nsorted_symbols) == TRUE)
-			label_offset = i;
-		    if(function_offsets)
-			printf("%+6d ", (int)(i - label_offset));
-		    if(Xflag == FALSE){
-			if(cputype & CPU_ARCH_ABI64)
-			    printf("%016llx", cur_addr);
-			else
-			    printf("%08x", (uint32_t)cur_addr);
-			if((qflag == FALSE ||
-			    (cputype == CPU_TYPE_POWERPC)) &&
-			    cputype != CPU_TYPE_ARM64)
-			    printf("\t");
-		    }
-		}
-		if(cputype == CPU_TYPE_POWERPC64)
-		    j = ppc_disassemble(sect, size - i, cur_addr, addr,
-				object_byte_sex, relocs, nrelocs, symbols,
-				symbols64, nsymbols, sorted_symbols,
-				nsorted_symbols, strings, strings_size,
-				indirect_symbols, nindirect_symbols,
-				load_commands, ncmds, sizeofcmds, verbose);
-		else if(cputype == CPU_TYPE_X86_64)
-		    j = i386_disassemble(sect, size - i, cur_addr, addr,
-				object_byte_sex, relocs, nrelocs, ext_relocs,
-				next_relocs, loc_relocs, nloc_relocs, dbi, ndbi,
-				NULL, symbols64, nsymbols, sorted_symbols,
-				nsorted_symbols, strings, strings_size,
-				indirect_symbols, nindirect_symbols, cputype,
-				load_commands, ncmds, sizeofcmds, verbose,
-				llvm_mc, i386_dc, x86_64_dc , object_addr,
-				object_size, &(insts[n]), NULL, 0);
-	 	else if(cputype == CPU_TYPE_MC680x0)
-		    j = m68k_disassemble(sect, size - i, cur_addr, addr,
-				object_byte_sex, relocs, nrelocs, symbols,
-				nsymbols, sorted_symbols, nsorted_symbols,
-				strings, strings_size, indirect_symbols,
-				nindirect_symbols, load_commands, ncmds,
-				sizeofcmds, verbose);
-		else if(cputype == CPU_TYPE_I860)
-		    j = i860_disassemble(sect, size - i, cur_addr, addr,
-				object_byte_sex, relocs, nrelocs, symbols,
-				nsymbols, sorted_symbols, nsorted_symbols,
-				strings, strings_size, verbose);
-		else if(cputype == CPU_TYPE_I386)
-		    j = i386_disassemble(sect, size - i, cur_addr, addr,
-				object_byte_sex, relocs, nrelocs, ext_relocs,
-				next_relocs, loc_relocs, nloc_relocs, dbi, ndbi,
-				symbols, NULL, nsymbols, sorted_symbols,
-				nsorted_symbols, strings, strings_size,
-				indirect_symbols, nindirect_symbols, cputype,
-				load_commands, ncmds, sizeofcmds, verbose,
-				llvm_mc, i386_dc, x86_64_dc, object_addr,
-				object_size, &(insts[n]), NULL, 0);
-		else if(cputype == CPU_TYPE_MC88000)
-		    j = m88k_disassemble(sect, size - i, cur_addr, addr,
-				object_byte_sex, relocs, nrelocs, symbols,
-				nsymbols, sorted_symbols, nsorted_symbols,
-				strings, strings_size, verbose);
-		else if(cputype == CPU_TYPE_POWERPC ||
-			cputype == CPU_TYPE_VEO)
-		    j = ppc_disassemble(sect, size - i, cur_addr, addr,
-				object_byte_sex, relocs, nrelocs, symbols,
-				symbols64, nsymbols, sorted_symbols,
-				nsorted_symbols, strings, strings_size,
-				indirect_symbols, nindirect_symbols,
-				load_commands, ncmds, sizeofcmds, verbose);
-		else if(cputype == CPU_TYPE_HPPA)
-		    j = hppa_disassemble(sect, size - i, cur_addr, addr,
-				object_byte_sex, relocs, nrelocs, symbols,
-				nsymbols, sorted_symbols, nsorted_symbols,
-				strings, strings_size, verbose);
-		else if(cputype == CPU_TYPE_SPARC)
-		    j = sparc_disassemble(sect, size - i, cur_addr, addr,
-				object_byte_sex, relocs, nrelocs, symbols,
-				nsymbols, sorted_symbols, nsorted_symbols,
-				strings, strings_size, indirect_symbols,
-				nindirect_symbols, load_commands, ncmds,
-				sizeofcmds, verbose);
-		else if(cputype == CPU_TYPE_ARM)
-		    j = arm_disassemble(sect, size - i, cur_addr, addr,
-				object_byte_sex, relocs, nrelocs, symbols,
-				nsymbols, sorted_symbols, nsorted_symbols,
-				strings, strings_size, indirect_symbols,
-				nindirect_symbols, load_commands, ncmds,
-				sizeofcmds, cpusubtype, verbose, arm_dc,
-				thumb_dc, object_addr, object_size, dices,
-				ndices, seg_addr, &(insts[n]), NULL, 0);
-		else if(cputype == CPU_TYPE_ARM64)
-		    j = arm64_disassemble(sect, size - i, cur_addr, addr,
-				object_byte_sex, relocs, nrelocs, ext_relocs,
-				next_relocs, loc_relocs, nloc_relocs, dbi, ndbi,
-				symbols64, nsymbols, sorted_symbols,
-				nsorted_symbols, strings, strings_size,
-				indirect_symbols, nindirect_symbols,
-				load_commands, ncmds, sizeofcmds, object_addr,
-				object_size, verbose, arm64_dc);
-		
-		else{
-		    printf("Can't disassemble unknown cputype %d\n", cputype);
-		    return;
-		}
-		sect += j;
-		cur_addr += j;
-		i += j;
-		if(gflag)
-		    n++;
-	    }
-	    if(gflag &&
-	       (cputype == CPU_TYPE_X86_64 ||
-		cputype == CPU_TYPE_I386 ||
-		cputype == CPU_TYPE_ARM)){
-		char dst[4096];
-		dst[4095] = '\0';
-
-		/* Look for inits that need tmp labels. */
-		for(i = 0 ; i < n ; i++){
-		    if(insts[i].has_raw_target_address){
-			for(j = 0; j < n; j++){
-			    if(insts[i].raw_target_address == insts[j].address)
-				insts[j].needs_tmp_label = TRUE;
-			}
-		    }
-		}
-
-		/* Create the needed tmp labels. */
-		j = 1;
-		for(i = 0 ; i < n ; i++){
-		    if(insts[i].needs_tmp_label == TRUE){
-			insts[i].tmp_label = allocate(20);
-			sprintf(insts[i].tmp_label, "L%d", j++);
-		    }
-		}
-
-		/* Now finally print the inits. */
-		for(i = 0 ; i < n ; i++){
-		    if(insts[i].label != NULL)
-			printf("%s:\n", insts[i].label);
-		    else if(insts[i].tmp_label != NULL)
-			printf("%s:", insts[i].tmp_label);
-		    insts[i].print = TRUE;
-		    cur_addr = insts[i].address;
-		    offset = cur_addr - addr;
-		    sect = sect_start + offset;
-		    if(cputype == CPU_TYPE_X86_64 || cputype == CPU_TYPE_I386)
-			j = i386_disassemble(sect, size - offset, cur_addr,
-				addr, object_byte_sex, relocs, nrelocs,
-				ext_relocs, next_relocs, loc_relocs,
-				nloc_relocs, dbi, ndbi, symbols, NULL,
-				nsymbols, sorted_symbols, nsorted_symbols,
-				strings, strings_size, indirect_symbols,
-				nindirect_symbols, cputype, load_commands, 
-				ncmds, sizeofcmds, verbose, llvm_mc, i386_dc,
-				x86_64_dc, object_addr, object_size,
-				&(insts[i]), insts, n);
-		    else if(cputype == CPU_TYPE_ARM)
-			j = arm_disassemble(sect, size - offset, cur_addr, addr,
-				    object_byte_sex, relocs, nrelocs, symbols,
-				    nsymbols, sorted_symbols, nsorted_symbols,
-				    strings, strings_size, indirect_symbols,
-				    nindirect_symbols, load_commands, ncmds,
-				    sizeofcmds, cpusubtype, verbose, arm_dc,
-				    thumb_dc, object_addr, object_size, dices,
-				    ndices, seg_addr, &(insts[i]), insts, n);
-		}
-
-		/* Free up allocated space */
-		for(i = 0 ; i < n ; i++){
-		    if(insts[i].tmp_label != NULL)
-			free(insts[i].tmp_label);
-		}
-		free(insts);
-	    }
-	    if(i386_dc != NULL)
-		delete_arm_llvm_disassembler(i386_dc);
-	    if(x86_64_dc != NULL)
-		delete_arm_llvm_disassembler(x86_64_dc);
-	    if(arm_dc != NULL)
-		delete_arm_llvm_disassembler(arm_dc);
-	    if(thumb_dc != NULL)
-		delete_arm_llvm_disassembler(thumb_dc);
-	    if(arm64_dc != NULL)
-		delete_arm64_llvm_disassembler(arm64_dc);
-	}
-	else{
-	    if(cputype == CPU_TYPE_I386 || cputype == CPU_TYPE_X86_64){
-		for(i = 0 ; i < size ; i += j , addr += j){
-		    if(cputype & CPU_ARCH_ABI64)
-			printf("%016llx ", addr);
-		    else
-			printf("%08x ", (uint32_t)addr);
-		    for(j = 0;
-			j < 16 * sizeof(char) && i + j < size;
-			j += sizeof(char)){
-			byte_word = *(sect + i + j);
-			printf("%02x ", (unsigned int)byte_word);
-		    }
-		    printf("\n");
-		}
-	    }
-	    else if(cputype == CPU_TYPE_MC680x0){
-		for(i = 0 ; i < size ; i += j , addr += j){
-		    printf("%08x ", (unsigned int)addr);
-		    for(j = 0;
-			j < 8 * sizeof(short) && i + j < size;
-			j += sizeof(short)){
-			memcpy(&short_word, sect + i + j, sizeof(short));
-			if(swapped)
-			    short_word = SWAP_SHORT(short_word);
-			printf("%04x ", (unsigned int)short_word);
-		    }
-		    printf("\n");
-		}
-	    }
-	    else{
-		for(i = 0 ; i < size ; i += j , addr += j){
-		    if(cputype & CPU_ARCH_ABI64)
-			printf("%016llx ", addr);
-		    else
-			printf("%08x ", (uint32_t)addr);
-		    for(j = 0;
-			j < 4 * sizeof(int32_t) && i + j < size;
-			j += sizeof(int32_t)){
-			memcpy(&long_word, sect + i + j, sizeof(int32_t));
-			if(swapped)
-			    long_word = SWAP_INT(long_word);
-			printf("%08x ", (unsigned int)long_word);
-		    }
-		    printf("\n");
-		}
-	    }
-	}
-}
-
-static
-void
-print_argstrings(
-uint32_t magic,
-struct load_command *load_commands,
-uint32_t ncmds,
-uint32_t sizeofcmds,
-cpu_type_t cputype,
-cpu_subtype_t cpusubtype,
-enum byte_sex load_commands_byte_sex,
-char *object_addr,
-uint32_t object_size)
-{
-    enum byte_sex host_byte_sex;
-    enum bool swapped;
-    uint32_t i, len, left, size, arg;
-    uint64_t usrstack;
-    struct load_command *lc, l;
-    struct segment_command sg;
-    struct segment_command_64 sg64;
-    char *stack, *stack_top, *p, *q, *argv;
-    struct arch_flag arch_flags;
-
-	host_byte_sex = get_host_byte_sex();
-	swapped = host_byte_sex != load_commands_byte_sex;
-
-	arch_flags.cputype = cputype;
-	if(magic == MH_MAGIC_64)
-	    arch_flags.cputype |= CPU_ARCH_ABI64;
-	arch_flags.cpusubtype = cpusubtype;
-	usrstack = get_stack_addr_from_flag(&arch_flags);
-	if(usrstack == 0){
-	    printf("Don't know the value of USRSTACK for unknown cputype "
-		   "(%d)\n", cputype);
-	    return;
-	}
-	printf("Argument strings on the stack at: ");
-	if(cputype & CPU_ARCH_ABI64 || magic == MH_MAGIC_64)
-	    printf("%016llx\n", usrstack);
-	else
-	    printf("%08x\n", (uint32_t)usrstack);
-	lc = load_commands;
-	for(i = 0 ; i < ncmds; i++){
-	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
-	    if(swapped)
-		swap_load_command(&l, host_byte_sex);
-	    if(cputype & CPU_ARCH_ABI64 || magic == MH_MAGIC_64){
-		if(l.cmdsize % 8 != 0)
-		    printf("load command %u size not a multiple of 8\n", i);
-	    }
-	    else{
-		if(l.cmdsize % 4 != 0)
-		    printf("load command %u size not a multiple of 4\n", i);
-	    }
-	    if((char *)lc + l.cmdsize >
-	       (char *)load_commands + sizeofcmds)
-		printf("load command %u extends past end of load "
-		       "commands\n", i);
-	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
-
-	    switch(l.cmd){
-	    case LC_SEGMENT:
-		memset((char *)&sg, '\0', sizeof(struct segment_command));
-		size = left < sizeof(struct segment_command) ?
-		       left : sizeof(struct segment_command);
-		memcpy((char *)&sg, (char *)lc, size);
-		if(swapped)
-		    swap_segment_command(&sg, host_byte_sex);
-
-		if(cputype == CPU_TYPE_HPPA){
-		    if(sg.vmaddr == usrstack &&
-		       sg.fileoff + sg.filesize <= object_size){
-			stack = object_addr + sg.fileoff;
-			stack_top = stack + sg.filesize;
-			/*
-			 * There appears to be some pointer then argc at the
-			 * bottom of the stack first before argv[].
-			 */
-			argv = stack + 2 * sizeof(uint32_t);
-			memcpy(&arg, argv, sizeof(uint32_t));
-			if(swapped)
-			    arg = SWAP_INT(arg);
-			while(argv < stack_top &&
-			      arg != 0 &&
-			      arg >= usrstack && arg < usrstack + sg.filesize){
-			    p = stack + (arg - usrstack);
-			    printf("\t");
-			    while(p < stack_top && *p != '\0'){
-				printf("%c", *p);
-				p++;
-			    }
-			    printf("\n");
-			    argv += sizeof(uint32_t);
-			    memcpy(&arg, argv, sizeof(uint32_t));
-			    if(swapped)
-				arg = SWAP_INT(arg);
-			}
-			/* after argv[] then there is envp[] */
-			argv += sizeof(uint32_t);
-			memcpy(&arg, argv, sizeof(uint32_t));
-			if(swapped)
-			    arg = SWAP_INT(arg);
-			while(argv < stack_top &&
-			      arg != 0 &&
-			      arg >= usrstack && arg < usrstack + sg.filesize){
-			    p = stack + (arg - usrstack);
-			    printf("\t");
-			    while(p < stack_top && *p != '\0'){
-				printf("%c", *p);
-				p++;
-			    }
-			    printf("\n");
-			    argv += sizeof(uint32_t);
-			    memcpy(&arg, argv, sizeof(uint32_t));
-			    if(swapped)
-				arg = SWAP_INT(arg);
-			}
-		    }
-		}
-		else{
-		    if(sg.vmaddr + sg.vmsize == usrstack &&
-		       sg.fileoff + sg.filesize <= object_size){
-			stack = object_addr + sg.fileoff;
-			stack_top = stack + sg.filesize;
-
-			/* the first thing on the stack is a long 0 */
-			stack_top -= 4;
-			p = (char *)stack_top;
-
-			/* find the first non-null character before the long 0*/
-			while(p > stack && *p == '\0')
-			    p--;
-			if(p != (char *)stack_top)
-			    p++;
-
-			q = p;
-			/* Stop when we find another long 0 */
-			while(p > stack && (*p != '\0' || *(p-1) != '\0' ||
-			      *(p-2) != '\0' || *(p-3) != '\0')){
-			    p--;
-			    /* step back over the string to its start */
-			    while(p > stack && *p != '\0')
-				p--;
-			}
-
-			p++; /* step forward to the start of the first string */
-			while(p < q){
-			    printf("\t");
-			    len = 0;
-			    while(p + len < q && p[len] != '\0'){
-				printf("%c", p[len]);
-				len++;
-			    }
-			    printf("\n");
-			    p += len + 1;
-			}
-			return;
-		    }
-		}
-		break;
-	    case LC_SEGMENT_64:
-		memset((char *)&sg64, '\0', sizeof(struct segment_command_64));
-		size = left < sizeof(struct segment_command_64) ?
-		       left : sizeof(struct segment_command_64);
-		memcpy((char *)&sg64, (char *)lc, size);
-		if(swapped)
-		    swap_segment_command_64(&sg64, host_byte_sex);
-		if(sg64.vmaddr + sg64.vmsize == usrstack &&
-		   sg64.fileoff + sg64.filesize <= object_size){
-		    stack = object_addr + sg64.fileoff;
-		    stack_top = stack + sg64.filesize;
-
-		    /* the first thing on the stack is a uint64_t 0 */
-		    stack_top -= 8;
-		    p = (char *)stack_top;
-
-		    /* find the first non-null character before the uint64_t 0*/
-		    while(p > stack && *p == '\0')
-			p--;
-		    if(p != (char *)stack_top)
-			p++;
-
-		    q = p;
-		    /* Stop when we find another uint64_t 0 */
-		    while(p > stack && (*p != '\0' || *(p-1) != '\0' ||
-			  *(p-2) != '\0' || *(p-3) != '\0' || *(p-4) != '\0' ||
-			  *(p-5) != '\0' || *(p-6) != '\0' || *(p-7) != '\0')){
-			p--;
-			/* step back over the string to its start */
-			while(p > stack && *p != '\0')
-			    p--;
-		    }
-
-		    p++; /* step forward to the start of the first string */
-		    while(p < q){
-			printf("\t");
-			len = 0;
-			while(p + len < q && p[len] != '\0'){
-			    printf("%c", p[len]);
-			    len++;
-			}
-			printf("\n");
-			p += len + 1;
-		    }
-		    return;
-		}
-		break;
-	    }
-
-	    if(l.cmdsize == 0){
-		printf("load command %u size zero (can't advance to other "
-		       "load commands)\n", i);
-		break;
-	    }
-	    lc = (struct load_command *)((char *)lc + l.cmdsize);
-	    if((char *)lc > (char *)load_commands + sizeofcmds)
-		break;
-	}
-}
-
-#ifndef __DYNAMIC__
-/*
- * To avoid linking in libm.  These variables are defined as they are used in
- * pthread_init() to put in place a fast sqrt().
- */
-size_t hw_sqrt_len = 0;
-
-double
-sqrt(double x)
-{
-	return(0.0);
-}
-double
-hw_sqrt(double x)
-{
-	return(0.0);
-}
-
-/*
- * More stubs to avoid linking in libm.  This works as along as we don't use
- * long doubles.
- */
-int32_t
-__fpclassifyd(double x)
-{
-	return(0);
-}
-int32_t
-__fpclassify(long double x)
-{
-	return(0);
-}
-#endif /* !defined(__DYNAMIC__) */
+/*
+ * Copyright  2009 Apple Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions are met:
+ * 
+ * 1.  Redistributions of source code must retain the above copyright notice,
+ * this list of conditions and the following disclaimer. 
+ * 2.  Redistributions in binary form must reproduce the above copyright notice,
+ * this list of conditions and the following disclaimer in the documentation
+ * and/or other materials provided with the distribution. 
+ * 3.  Neither the name of Apple Inc. ("Apple") nor the names of its
+ * contributors may be used to endorse or promote products derived from this
+ * software without specific prior written permission. 
+ * 
+ * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND ANY
+ * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+ * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
+ * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
+ * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ *
+ * @APPLE_LICENSE_HEADER_END@
+ */
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <limits.h>
+#include <ar.h>
+#include <mach-o/ranlib.h>
+#include <libc.h>
+#include "stuff/bool.h"
+#include "stuff/ofile.h"
+#include "stuff/errors.h"
+#include "stuff/allocate.h"
+#include "stuff/symbol.h"
+#include "stuff/symbol.h"
+#include "stuff/llvm.h"
+#include "stuff/guess_short_name.h"
+#include "otool.h"
+#include "dyld_bind_info.h"
+#include "ofile_print.h"
+#include "m68k_disasm.h"
+#include "i860_disasm.h"
+#include "i386_disasm.h"
+#include "m88k_disasm.h"
+#include "ppc_disasm.h"
+#include "hppa_disasm.h"
+#include "sparc_disasm.h"
+#include "arm_disasm.h"
+#include "arm64_disasm.h"
+#include "llvm-c/Disassembler.h"
+
+#ifdef _BUILD_LIB_
+#undef static
+#define static
+#endif
+
+/* Name of this program for error messages (argv[0]) */
+char *progname = NULL;
+
+/*
+ * The flags to indicate the actions to perform.
+ */
+enum bool fflag = FALSE; /* print the fat headers */
+enum bool aflag = FALSE; /* print the archive header */
+enum bool hflag = FALSE; /* print the exec or mach header */
+enum bool lflag = FALSE; /* print the load commands */
+enum bool Lflag = FALSE; /* print the shared library names */
+enum bool Dflag = FALSE; /* print the shared library id name */
+enum bool tflag = FALSE; /* print the text */
+enum bool Uflag = FALSE; /* print the text symbol by symbol,
+			    for llvm-objdump testing must be used with -t */
+enum bool no_show_raw_insn = FALSE; /* no raw inst, for llvm-objdump testing
+				       with 32-bit arm */
+enum bool dflag = FALSE; /* print the data */
+enum bool oflag = FALSE; /* print the objctive-C info */
+enum bool Oflag = FALSE; /* print the objctive-C selector strings only */
+enum bool rflag = FALSE; /* print the relocation entries */
+enum bool Tflag = FALSE; /* print the dylib table of contents */
+enum bool Mflag = FALSE; /* print the dylib module table */
+enum bool Rflag = FALSE; /* print the dylib reference table */
+enum bool Iflag = FALSE; /* print the indirect symbol table entries */
+enum bool Hflag = FALSE; /* print the two-level hints table */
+enum bool Cflag = FALSE; /* print the linker optimization hints */
+enum bool Gflag = FALSE; /* print the data in code table */
+enum bool gflag = FALSE; /* group the disassembly */
+enum bool eflag = FALSE; /* print enhanced disassembly */
+enum bool Sflag = FALSE; /* print the contents of the __.SYMDEF file */
+enum bool vflag = FALSE; /* print verbosely (symbolically) when possible */
+enum bool Vflag = FALSE; /* print dissassembled operands verbosely */
+enum bool cflag = FALSE; /* print the argument and environ strings of a core */
+enum bool iflag = FALSE; /* print the shared library initialization table */
+enum bool Wflag = FALSE; /* print the mod time of an archive as a number */
+enum bool Xflag = FALSE; /* don't print leading address in disassembly */
+enum bool Zflag = FALSE; /* don't use simplified ppc mnemonics in disassembly */
+enum bool Bflag = FALSE; /* force Thumb disassembly (ARM objects only) */
+enum bool Qflag = FALSE; /* use otool's disassembler */
+enum bool qflag = FALSE; /* use 'C' Public llvm-mc disassembler */
+enum bool jflag = FALSE; /* print opcode bytes */
+enum bool Pflag = FALSE; /* print (__TEXT,__info_plist) section as strings */
+char *pflag = NULL; 	 /* procedure name to start disassembling from */
+char *segname = NULL;	 /* name of the section to print the contents of */
+char *sectname = NULL;
+enum bool llvm_mc = FALSE; /* disassemble as llvm-mc will assemble */
+char *mcpu = "";	/* the arg of the -mcpu=arg flag */
+/* Print function offsets when disassembling when TRUE. */
+enum bool function_offsets = FALSE;
+enum bool print_bind_info = FALSE;  /* print dyld bind information */
+
+/* this is set when any of the flags that process object files is set */
+enum bool object_processing = FALSE;
+
+static void usage(
+    void);
+
+static void processor(
+    struct ofile *ofile,
+    char *arch_name,
+    void *cookie);
+
+static void get_symbol_table_info(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    cpu_type_t cputype,
+    enum byte_sex load_commands_byte_sex,
+    char *object_addr,
+    uint32_t object_size,
+    struct nlist **symbols,
+    struct nlist_64 **symbols64,
+    uint32_t *nsymbols,
+    char **strings,
+    uint32_t *strings_size);
+
+static void get_toc_info(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum byte_sex load_commands_byte_sex,
+    char *object_addr,
+    uint32_t object_size,
+    struct dylib_table_of_contents **tocs,
+    uint32_t *ntocs);
+
+static void get_module_table_info(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    cpu_type_t cputype,
+    enum byte_sex load_commands_byte_sex,
+    char *object_addr,
+    uint32_t object_size,
+    struct dylib_module **mods,
+    struct dylib_module_64 **mods64,
+    uint32_t *nmods);
+
+static void get_ref_info(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum byte_sex load_commands_byte_sex,
+    char *object_addr,
+    uint32_t object_size,
+    struct dylib_reference **refs,
+    uint32_t *nrefs);
+
+static void get_indirect_symbol_table_info(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum byte_sex load_commands_byte_sex,
+    char *object_addr,
+    uint32_t object_size,
+    uint32_t **indirect_symbols,
+    uint32_t *nindirect_symbols);
+
+static enum bool get_dyst(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum byte_sex load_commands_byte_sex,
+    struct dysymtab_command *dyst);
+
+static void get_hints_table_info(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum byte_sex load_commands_byte_sex,
+    char *object_addr,
+    uint32_t object_size,
+    struct twolevel_hint **hints,
+    uint32_t *nhints);
+
+static enum bool get_hints_cmd(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum byte_sex load_commands_byte_sex,
+    struct twolevel_hints_command *hints_cmd);
+
+static void get_link_opt_hints(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum byte_sex load_commands_byte_sex,
+    char *object_addr,
+    uint32_t object_size,
+    char **loh,
+    uint32_t *nloh);
+
+static enum bool get_link_opt_hint_cmd(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum byte_sex load_commands_byte_sex,
+    struct linkedit_data_command *loh_cmd);
+
+static void get_data_in_code_info(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum byte_sex load_commands_byte_sex,
+    char *object_addr,
+    uint32_t object_size,
+    struct data_in_code_entry **dices,
+    uint32_t *ndices);
+
+static enum bool get_dices_cmd(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum byte_sex load_commands_byte_sex,
+    struct linkedit_data_command *dices_cmd);
+
+static int sym_compare(
+    struct symbol *sym1,
+    struct symbol *sym2);
+
+static int rel_compare(
+    struct relocation_info *rel1,
+    struct relocation_info *rel2);
+
+static void get_linked_reloc_info(
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum byte_sex load_commands_byte_sex,
+    char *object_addr,
+    uint32_t object_size,
+    struct relocation_info **ext_relocs,
+    uint32_t *next_relocs,
+    struct relocation_info **loc_relocs,
+    uint32_t *nloc_relocs);
+
+static void setup_dyld_bind_info(
+    struct load_command *load_commands, 	/* input */
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum byte_sex load_commands_byte_sex,
+    char *object_addr,
+    uint32_t object_size,
+    struct dyld_bind_info **dbi, /* output */
+    uint64_t *ndbi);
+
+static void print_text_by_symbols(
+    cpu_type_t cputype,
+    enum byte_sex object_byte_sex,
+    char *sect,
+    uint32_t size,
+    uint64_t addr,
+    uint32_t sect_flags,
+    struct symbol *sorted_symbols,
+    uint32_t nsorted_symbols,
+    struct nlist *symbols,
+    struct nlist_64 *symbols64,
+    uint32_t nsymbols,
+    char *strings,
+    uint32_t strings_size,
+    struct relocation_info *relocs,
+    uint32_t nrelocs,
+    struct relocation_info *ext_relocs,
+    uint32_t next_relocs,
+    struct relocation_info *loc_relocs,
+    uint32_t nloc_relocs,
+    struct dyld_bind_info *dbi,
+    uint64_t ndbi,
+    uint32_t *indirect_symbols,
+    uint32_t nindirect_symbols,
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum bool disassemble,
+    enum bool verbose,
+    cpu_subtype_t cpusubtype,
+    char *object_addr,
+    uint32_t object_size,
+    struct data_in_code_entry *dices,
+    uint32_t ndices,
+    uint64_t seg_addr);
+
+static void print_text(
+    cpu_type_t cputype,
+    enum byte_sex object_byte_sex,
+    char *sect,
+    uint32_t size,
+    uint64_t addr,
+    uint32_t sect_flags,
+    struct symbol *sorted_symbols,
+    uint32_t nsorted_symbols,
+    struct nlist *symbols,
+    struct nlist_64 *symbols64,
+    uint32_t nsymbols,
+    char *strings,
+    uint32_t strings_size,
+    struct relocation_info *relocs,
+    uint32_t nrelocs,
+    struct relocation_info *ext_relocs,
+    uint32_t next_relocs,
+    struct relocation_info *loc_relocs,
+    uint32_t nloc_relocs,
+    struct dyld_bind_info *dbi,
+    uint64_t ndbi,
+    uint32_t *indirect_symbols,
+    uint32_t nindirect_symbols,
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    enum bool disassemble,
+    enum bool verbose,
+    cpu_subtype_t cpusubtype,
+    char *object_addr,
+    uint32_t object_size,
+    struct data_in_code_entry *dices,
+    uint32_t ndices,
+    uint64_t seg_addr);
+
+static void print_argstrings(
+    uint32_t magic,
+    struct load_command *load_commands,
+    uint32_t ncmds,
+    uint32_t sizeofcmds,
+    cpu_type_t cputype,
+    cpu_subtype_t cpusubtype,
+    enum byte_sex load_commands_byte_sex,
+    char *object_addr,
+    uint32_t object_size);
+
+#ifdef OTOOL_NG_SUPPORT
+static void modify_pie_flag(struct ofile *ofile);
+static void modify_pie_flag_aux(char *start);
+#endif
+
+/* apple_version is created by the libstuff/Makefile */
+extern char apple_version[];
+char *version = apple_version;
+
+#ifndef _BUILD_LIB_
+int
+main(
+int argc,
+char **argv,
+char **envp)
+{
+    int i;
+    uint32_t j, nfiles;
+    struct arch_flag *arch_flags;
+    uint32_t narch_flags;
+    enum bool all_archs, use_member_syntax, version;
+    char **files;
+    const char *disssembler_version;
+
+	progname = argv[0];
+	arch_flags = NULL;
+	narch_flags = 0;
+	all_archs = FALSE;
+	use_member_syntax = TRUE;
+	llvm_mc = FALSE;
+	version = FALSE;
+
+	if(argc <= 1)
+	    usage();
+
+	/*
+	 * Parse the arguments.
+	 */
+	nfiles = 0;
+        files = allocate(sizeof(char *) * argc);
+	for(i = 1; i < argc; i++){
+	    if(argv[i][0] == '-' && argv[i][1] == '\0'){
+		for(i += 1 ; i < argc; i++)
+		    files[nfiles++] = argv[i];
+		break;
+	    }
+	    if(argv[i][0] != '-'){
+		files[nfiles++] = argv[i];
+		continue;
+	    }
+	    if(strcmp(argv[i], "--version") == 0){
+		fprintf(stderr, "otool(1): Apple Inc. version %s\n",
+			apple_version);
+		disssembler_version = llvm_disasm_version_string();
+		if(disssembler_version != NULL)
+		    fprintf(stderr, "disassmbler: %s\n", disssembler_version);
+		version = TRUE;
+		continue;
+	    }
+	    if(strcmp(argv[i], "-arch") == 0){
+		if(i + 1 == argc){
+		    error("missing argument(s) to %s option", argv[i]);
+		    usage();
+		}
+		if(strcmp("all", argv[i+1]) == 0){
+		    all_archs = TRUE;
+		}
+		else{
+		    arch_flags = reallocate(arch_flags,
+			    (narch_flags + 1) * sizeof(struct arch_flag));
+		    if(get_arch_from_flag(argv[i+1],
+					  arch_flags + narch_flags) == 0){
+			error("unknown architecture specification flag: "
+			      "%s %s", argv[i], argv[i+1]);
+			arch_usage();
+			usage();
+		    }
+		    narch_flags++;
+		}
+		i++;
+		continue;
+	    }
+	    if(strcmp(argv[i], "-llvm-mc") == 0){
+		llvm_mc = TRUE;
+		continue;
+	    }
+	    if(strcmp(argv[i], "-function_offsets") == 0){
+		function_offsets = TRUE;
+		continue;
+	    }
+	    if(strcmp(argv[i], "-bind_info") == 0){
+		print_bind_info = TRUE;
+		object_processing = TRUE;
+		continue;
+	    }
+	    if(strncmp(argv[i], "-mcpu=", sizeof("-mcpu=")-1) == 0){
+		mcpu = argv[i] + sizeof("-mcpu=")-1;
+		if(*mcpu == '\0'){
+		    error("missing argument to -mcpu=");
+		    usage();
+		}
+		continue;
+	    }
+	    if(strcmp(argv[i], "-no-show-raw-insn") == 0){
+		no_show_raw_insn = TRUE;
+		continue;
+	    }
+	    if(argv[i][1] == 'p'){
+		if(argc <=  i + 1){
+		    error("-p requires an argument (a text symbol name)");
+		    usage();
+		}
+		if(pflag)
+		    error("only one -p flag can be specified");
+		pflag = argv[i + 1];
+		i++;
+		continue;
+	    }
+	    if(argv[i][1] == 's'){
+		if(argc <=  i + 2){
+		    error("-s requires two arguments (a segment name and a "
+			  "section name)");
+		    usage();
+		}
+		if(sectname != NULL){
+		    error("only one -s flag can be specified");
+		    usage();
+		}
+		segname  = argv[i + 1];
+		sectname = argv[i + 2];
+		i += 2;
+		object_processing = TRUE;
+		continue;
+	    }
+#ifdef OTOOL_NG_SUPPORT	   
+	    if (argv[i][1] == 'O')
+	    {
+	    	if (argc <= i + 1)
+	    	{
+	    		error("-O requires and argument (offset value)");
+	    		usage();
+	    	}
+	    	start_offset = strtoul(argv[i + 1], NULL, 0);
+	    	i++;
+	    	continue;
+	    }	    	
+#endif	    	
+	    for(j = 1; argv[i][j] != '\0'; j++){
+		switch(argv[i][j]){
+		case 'V':
+		    Vflag = TRUE;
+		case 'v':
+		    vflag = TRUE;
+		    break;
+		case 'f':
+		    fflag = TRUE;
+		    break;
+		case 'a':
+		    aflag = TRUE;
+		    break;
+		case 'g':
+		    gflag = TRUE;
+		    break;
+		case 'e':
+		    eflag = TRUE;
+		    break;
+		case 'h':
+		    hflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'l':
+		    lflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'L':
+		    Lflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'D':
+		    Dflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 't':
+		    tflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'U':
+		    Uflag = TRUE;
+		    break;
+		case 'd':
+		    dflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'o':
+		    oflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'O':
+		    Oflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'r':
+		    rflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'T':
+		    Tflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'M':
+		    Mflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'R':
+		    Rflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'I':
+		    Iflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'H':
+		    Hflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'C':
+		    Cflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'G':
+		    Gflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'S':
+		    Sflag = TRUE;
+		    break;
+		case 'c':
+		    cflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'i':
+		    iflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		case 'W':
+		    Wflag = TRUE;
+		    break;
+		case 'X':
+		    Xflag = TRUE;
+		    break;
+		case 'Z':
+		    Zflag = TRUE;
+		    break;
+#ifdef OTOOL_NG_SUPPORT
+		case 'z':
+			zflag = TRUE;
+			object_processing = TRUE;
+			break;
+#endif
+		case 'm':
+		    use_member_syntax = FALSE;
+		    break;
+		case 'B':
+		    Bflag = TRUE;
+		    break;
+		case 'Q':
+		    Qflag = TRUE;
+		    break;
+		case 'q':
+		    qflag = TRUE;
+		    break;
+		case 'j':
+		    jflag = TRUE;
+		    break;
+		case 'P':
+		    Pflag = TRUE;
+		    object_processing = TRUE;
+		    break;
+		default:
+		    error("unknown char `%c' in flag %s\n", argv[i][j],argv[i]);
+		    usage();
+		}
+	    }
+	}
+
+	/*
+	 * Check for correctness of arguments.
+	 */
+#ifdef OTOOL_NG_SUPPORT
+	if(!fflag && !aflag && !hflag && !lflag && !Lflag && !tflag && !dflag &&
+	   !oflag && !Oflag && !rflag && !Tflag && !Mflag && !Rflag && !Iflag &&
+	   !Cflag && !print_bind_info &&
+	   !Hflag && !Gflag && !Sflag && !cflag && !iflag && !Dflag &&!segname &&
+	   !zflag){
+	    error("one of -fahlLtdoOrTMRIHCGScisz must be specified");
+	    usage();
+	}
+#else
+	if(!fflag && !aflag && !hflag && !lflag && !Lflag && !tflag && !dflag &&
+	   !oflag && !Oflag && !rflag && !Tflag && !Mflag && !Rflag && !Iflag &&
+	   !Cflag && !print_bind_info && !version && !Pflag &&
+	   !Hflag && !Gflag && !Sflag && !cflag && !iflag && !Dflag &&!segname){
+	    error("one of -fahlLtdoOrTMRIHCGScisP or --version must be "
+		  "specified");
+	    usage();
+	}
+#endif
+	if(qflag && Qflag){
+	    error("can't specify both -q and -Q");
+	    usage();
+	}
+	/*
+	 * The default, without the -Q flag, is to use the llvm dissembler
+	 * instead of otool's internal disassemblers.
+	 */
+	if(!Qflag)
+	    qflag = TRUE;
+	if(nfiles == 0 && version == FALSE){
+	    error("at least one file must be specified");
+	    usage();
+	}
+	if(segname != NULL && sectname != NULL){
+	    /* treat "-s __TEXT __text" the same as -t */
+	    if(strcmp(segname, SEG_TEXT) == 0 &&
+	       strcmp(sectname, SECT_TEXT) == 0){
+		tflag = TRUE;
+		segname = NULL;
+		sectname = NULL;
+	    }
+	    /* treat "-s __TEXT __fvmlib0" the same as -i */
+	    else if(strcmp(segname, SEG_TEXT) == 0 &&
+	       strcmp(sectname, SECT_FVMLIB_INIT0) == 0){
+		iflag = TRUE;
+		segname = NULL;
+		sectname = NULL;
+	    }
+	    /* treat "-v -s __TEXT __info_plist" the same as -P */
+	    else if(vflag == TRUE && strcmp(segname, SEG_TEXT) == 0 &&
+	       strcmp(sectname, "__info_plist") == 0){
+		Pflag = TRUE;
+		segname = NULL;
+		sectname = NULL;
+	    }
+	}
+
+	for(j = 0; j < nfiles; j++){
+#ifdef OTOOL_NG_SUPPORT		
+	    ofile_process(files[j], arch_flags, narch_flags, all_archs, TRUE,
+			  TRUE, use_member_syntax, processor, NULL, start_offset);
+#else
+	    ofile_process(files[j], arch_flags, narch_flags, all_archs, TRUE,
+			  TRUE, use_member_syntax, processor, NULL);
+#endif	    
+	}
+
+	if(errors)
+	    return(EXIT_FAILURE);
+	else
+	    return(EXIT_SUCCESS);
+}
+
+/*
+ * Print the current usage message.
+ */
+static
+void
+usage(
+void)
+{
+#ifdef OTOOL_NG_SUPPORT
+	fprintf(stderr,
+		"Usage: %s [-arch arch_type] [-fahlLDtdorSTMRIHGvVcXmqQjCPzO] "
+		"[-mcpu=arg] [--version] <object file> ...\n", progname);
+#else
+	fprintf(stderr,
+		"Usage: %s [-arch arch_type] [-fahlLDtdorSTMRIHGvVcXmqQjCP] "
+		"[-mcpu=arg] [--version] <object file> ...\n", progname);
+#endif
+
+	fprintf(stderr, "\t-f print the fat headers\n");
+	fprintf(stderr, "\t-a print the archive header\n");
+	fprintf(stderr, "\t-h print the mach header\n");
+	fprintf(stderr, "\t-l print the load commands\n");
+	fprintf(stderr, "\t-L print shared libraries used\n");
+	fprintf(stderr, "\t-D print shared library id name\n");
+	fprintf(stderr, "\t-t print the text section (disassemble with -v)\n");
+	fprintf(stderr, "\t-p <routine name>  start dissassemble from routine "
+		"name\n");
+	fprintf(stderr, "\t-s <segname> <sectname> print contents of "
+		"section\n");
+	fprintf(stderr, "\t-d print the data section\n");
+	fprintf(stderr, "\t-o print the Objective-C segment\n");
+	fprintf(stderr, "\t-r print the relocation entries\n");
+	fprintf(stderr, "\t-S print the table of contents of a library\n");
+	fprintf(stderr, "\t-T print the table of contents of a dynamic "
+		"shared library\n");
+	fprintf(stderr, "\t-M print the module table of a dynamic shared "
+		"library\n");
+	fprintf(stderr, "\t-R print the reference table of a dynamic shared "
+		"library\n");
+	fprintf(stderr, "\t-I print the indirect symbol table\n");
+	fprintf(stderr, "\t-H print the two-level hints table\n");
+	fprintf(stderr, "\t-G print the data in code table\n");
+	fprintf(stderr, "\t-v print verbosely (symbolically) when possible\n");
+	fprintf(stderr, "\t-V print disassembled operands symbolically\n");
+	fprintf(stderr, "\t-c print argument strings of a core file\n");
+	fprintf(stderr, "\t-X print no leading addresses or headers\n");
+	fprintf(stderr, "\t-m don't use archive(member) syntax\n");
+	fprintf(stderr, "\t-B force Thumb disassembly (ARM objects only)\n");
+	fprintf(stderr, "\t-q use llvm's disassembler (the default)\n");
+	fprintf(stderr, "\t-Q use otool(1)'s disassembler\n");
+	fprintf(stderr, "\t-mcpu=arg use `arg' as the cpu for disassembly\n");
+	fprintf(stderr, "\t-j print opcode bytes\n");
+	fprintf(stderr, "\t-P print the info plist section as strings\n");
+	fprintf(stderr, "\t-C print linker optimization hints\n");
+#ifdef OTOOL_NG_SUPPORT	
+	fprintf(stderr, "\t-z modify current PIE flag\n");
+	fprintf(stderr, "\t-O <offset> file offset where to start reading Mach-O header from (default is 0)\n");
+#endif
+	fprintf(stderr, "\t--version print the version of %s\n", progname);
+	exit(EXIT_FAILURE);
+}
+#endif
+
+static
+void
+processor(
+struct ofile *ofile,
+char *arch_name,
+void *cookie) /* cookie is not used */
+{
+    char *addr;
+    uint32_t i, magic;
+    uint64_t size;
+    struct mach_header mh;
+    struct mach_header_64 mh64;
+    cpu_type_t mh_cputype;
+    cpu_subtype_t mh_cpusubtype;
+    uint32_t mh_magic, mh_filetype, mh_ncmds, mh_sizeofcmds, sizeof_mach_header;
+    struct load_command *load_commands;
+    uint32_t nsymbols, nsorted_symbols, strings_size, len;
+    struct nlist *symbols, *allocated_symbols;
+    struct nlist_64 *symbols64, *allocated_symbols64;
+    struct symbol *sorted_symbols;
+    char *strings, *p;
+    uint32_t n_strx;
+    uint8_t n_type;
+    uint16_t n_desc;
+    uint64_t n_value;
+    char *sect;
+    uint32_t sect_nrelocs, sect_flags, nrelocs, next_relocs, nloc_relocs;
+    uint64_t sect_addr, sect_size;
+    struct relocation_info *sect_relocs, *relocs, *ext_relocs, *loc_relocs;
+    uint32_t *indirect_symbols, *allocated_indirect_symbols;
+    uint32_t nindirect_symbols;
+    struct dylib_module *mods, *allocated_mods;
+    struct dylib_module_64 *mods64, *allocated_mods64;
+    struct dylib_table_of_contents *tocs, *allocated_tocs;
+    struct dylib_reference *refs, *allocated_refs;
+    uint32_t nmods, ntocs, nrefs;
+    struct twolevel_hint *hints, *allocated_hints;
+    struct data_in_code_entry *dices, *allocated_dices;
+    uint32_t nhints, ndices;
+    uint64_t seg_addr;
+    char *loh;
+    uint32_t nloh;
+    struct dyld_bind_info *dbi;
+    uint64_t ndbi;
+
+	sorted_symbols = NULL;
+	nsorted_symbols = 0;
+	indirect_symbols = NULL;
+	nindirect_symbols = 0;
+	hints = NULL;
+	nhints = 0;
+	dices = NULL;
+	ndices = 0;
+	symbols = NULL;
+	symbols64 = NULL;
+	nsymbols = 0;
+	strings = NULL;
+	nmods = 0;
+	mods64 = NULL;
+	mods = NULL;
+	/*
+	 * These may or may not be allocated.  If allocated they will not be
+	 * NULL and then free'ed before returning.
+	 */
+	load_commands = NULL;
+	allocated_symbols = NULL;
+	allocated_symbols64 = NULL;
+	sorted_symbols = NULL;
+	allocated_indirect_symbols = NULL;
+	allocated_tocs = NULL;
+	allocated_mods = NULL;
+	allocated_refs = NULL;
+	allocated_hints = NULL;
+	allocated_dices = NULL;
+	dbi = NULL;
+	ndbi = 0;
+
+	/*
+	 * The fat headers are printed in ofile_map() in ofile.c #ifdef'ed
+	 * OTOOL.
+	 */
+
+	/*
+	 * Archive headers.
+	 */
+	if(aflag && ofile->member_ar_hdr != NULL){
+	    uint32_t member_offset;
+
+	    member_offset = ofile->member_offset - sizeof(struct ar_hdr);
+	    if(strncmp(ofile->member_ar_hdr->ar_name, AR_EFMT1,
+		       sizeof(AR_EFMT1) - 1) == 0)
+		member_offset -= ofile->member_name_size;
+
+	    print_ar_hdr(ofile->member_ar_hdr, ofile->member_name,
+			 ofile->member_name_size, member_offset, vflag, Vflag);
+	}
+
+	/*
+	 * Archive table of contents.
+	 */
+	if(ofile->member_ar_hdr != NULL &&
+	   strncmp(ofile->member_name, SYMDEF, sizeof(SYMDEF)-1) == 0){
+	    if(Sflag == FALSE)
+		return;
+	    if(ofile->file_type == OFILE_FAT){
+		addr = ofile->file_addr + ofile->fat_archs[ofile->narch].offset;
+		size = ofile->fat_archs[ofile->narch].size;
+	    }
+	    else{
+		addr = ofile->file_addr;
+		size = ofile->file_size;
+	    }
+	    if(addr + size > ofile->file_addr + ofile->file_size)
+		size = (ofile->file_addr + ofile->file_size) - addr;
+	    print_library_toc(ofile->member_ar_hdr, /* toc_ar_hdr */
+			      ofile->member_name, /* toc_name */
+			      ofile->member_name_size, /* toc_name_size */
+			      ofile->member_addr, /* toc_addr */
+			      ofile->member_size, /* toc_size */
+			      get_toc_byte_sex(addr, size),
+			      ofile->file_name, /* library_name */
+			      addr, /* library_addr */
+			      size, /* library_size */
+			      arch_name,
+			      vflag);
+	    return;
+	}
+
+	if(object_processing == FALSE)
+	    return;
+
+	/*
+	 * Print header for the object name if in an archive or an architecture
+	 * name is passed in.
+	 */
+	if(Xflag == FALSE){
+	    printf("%s", ofile->file_name);
+	    if(ofile->member_ar_hdr != NULL){
+		printf("(%.*s)", (int)ofile->member_name_size,
+			ofile->member_name);
+	    }
+	    if(arch_name != NULL)
+		printf(" (architecture %s):", arch_name);
+	    else
+		printf(":");
+	    /*
+	     * If the mach_header pointer is NULL the file is not an object
+	     * file.  Truncated object file (where the file size is less
+	     * than sizeof(struct mach_header) also does not have it's
+	     * mach_header set.  So deal with both cases here and then
+	     * return as the rest of this routine deals only with things
+	     * in object files.
+	     */
+	    if(ofile->mh == NULL && ofile->mh64 == NULL){
+		if(ofile->file_type == OFILE_FAT){
+		    /*
+		     * This routine is not called on fat files where the
+		     * offset is past end of file.  An error message is
+		     * printed in ofile_specific_arch() in ofile.c.
+		     */
+		    if(ofile->arch_type == OFILE_ARCHIVE){
+			addr = ofile->member_addr;
+			size = ofile->member_size;
+		    }
+		    else{
+			addr = ofile->file_addr +
+			       ofile->fat_archs[ofile->narch].offset;
+			size = ofile->fat_archs[ofile->narch].size;
+		    }
+		    if(addr + size > ofile->file_addr + ofile->file_size)
+			size = (ofile->file_addr + ofile->file_size) - addr;
+		}
+		else if(ofile->file_type == OFILE_ARCHIVE){
+		    addr = ofile->member_addr;
+		    size = ofile->member_size;
+		}
+		else{ /* ofile->file_type == OFILE_UNKNOWN */
+		    addr = ofile->file_addr;
+		    size = ofile->file_size;
+		}
+		if(size > sizeof(int32_t)){
+		    memcpy(&magic, addr, sizeof(uint32_t));
+		    if(magic == MH_MAGIC ||
+		       magic == SWAP_INT(MH_MAGIC)){
+			printf(" is a truncated object file\n");
+			memset(&mh, '\0', sizeof(struct mach_header));
+			if(size > sizeof(struct mach_header))
+			    size = sizeof(struct mach_header);
+			memcpy(&mh, addr, size);
+			if(magic == SWAP_INT(MH_MAGIC))
+			    swap_mach_header(&mh, get_host_byte_sex());
+			if(hflag)
+			    print_mach_header(mh.magic, mh.cputype,
+				mh.cpusubtype, mh.filetype, mh.ncmds,
+				mh.sizeofcmds, mh.flags, vflag);
+			return;
+		    }
+		    else if(magic == MH_MAGIC_64 ||
+		            magic == SWAP_INT(MH_MAGIC_64)){
+			printf(" is a truncated object file\n");
+			memset(&mh64, '\0', sizeof(struct mach_header_64));
+			if(size > sizeof(struct mach_header_64))
+			    size = sizeof(struct mach_header_64);
+			memcpy(&mh64, addr, size);
+			if(magic == SWAP_INT(MH_MAGIC_64))
+			    swap_mach_header_64(&mh64, get_host_byte_sex());
+			if(hflag)
+			    print_mach_header(mh64.magic, mh64.cputype,
+				mh64.cpusubtype, mh64.filetype, mh64.ncmds,
+				mh64.sizeofcmds, mh64.flags, vflag);
+			return;
+		    }
+		}
+#ifdef LTO_SUPPORT
+		if(ofile->lto != NULL){
+		    printf(" is an LLVM bit-code file\n");
+		    return;
+		}
+#endif /* LTO_SUPPORT */
+		printf(" is not an object file\n");
+		return;
+	    }
+	}
+	if(ofile->mh != NULL){
+	    if((intptr_t)(ofile->mh) % sizeof(uint32_t)){
+		if(Xflag == FALSE)
+		    printf("(object file offset is not a multiple of sizeof("
+			   "uint32_t))");
+		memcpy(&mh, ofile->mh, sizeof(struct mach_header));
+		if(mh.magic == SWAP_INT(MH_MAGIC))
+		    swap_mach_header(&mh, get_host_byte_sex());
+		ofile->mh = &mh;
+	    }
+	    else if(ofile->mh->magic == SWAP_INT(MH_MAGIC)){
+		mh = *(ofile->mh);
+		swap_mach_header(&mh, get_host_byte_sex());
+		ofile->mh = &mh;
+	    }
+	}
+	else if(ofile->mh64 != NULL){
+	    if((intptr_t)(ofile->mh64) % sizeof(uint32_t)){
+		if(Xflag == FALSE)
+		    printf("(object file offset is not a multiple of sizeof("
+			   "uint32_t))");
+		memcpy(&mh64, ofile->mh64, sizeof(struct mach_header));
+		if(mh64.magic == SWAP_INT(MH_MAGIC_64))
+		    swap_mach_header_64(&mh64, get_host_byte_sex());
+		ofile->mh64 = &mh64;
+	    }
+	    else if(ofile->mh64->magic == SWAP_INT(MH_MAGIC_64)){
+		mh64 = *(ofile->mh64);
+		swap_mach_header_64(&mh64, get_host_byte_sex());
+		ofile->mh64 = &mh64;
+	    }
+	}
+	if(Xflag == FALSE)
+	    printf("\n");
+
+	/*
+	 * If this is not an object file then just return.
+	 */
+	if(ofile->mh == NULL && ofile->mh64 == NULL)
+	    return;
+
+	/*
+	 * Calculate the true number of bytes of the of the object file that
+	 * is in memory (in case this file is truncated).
+	 */
+	addr = ofile->object_addr;
+	size = ofile->object_size;
+	if(addr + size > ofile->file_addr + ofile->file_size)
+	    size = (ofile->file_addr + ofile->file_size) - addr;
+
+	/*
+	 * Assign some local variables to the values in the mach_header for this
+	 * ofile to make passing arguments to the print routines easier.
+	 */
+	if(ofile->mh != NULL){
+	    mh_magic = ofile->mh->magic;
+	    mh_cputype = ofile->mh->cputype;
+	    mh_cpusubtype = ofile->mh->cpusubtype;
+	    mh_filetype = ofile->mh->filetype;
+	    mh_ncmds = ofile->mh->ncmds;
+	    mh_sizeofcmds = ofile->mh->sizeofcmds;
+	    sizeof_mach_header = sizeof(struct mach_header);
+	}
+	else{
+	    mh_magic = ofile->mh64->magic;
+	    mh_cputype = ofile->mh64->cputype;
+	    mh_cpusubtype = ofile->mh64->cpusubtype;
+	    mh_filetype = ofile->mh64->filetype;
+	    mh_ncmds = ofile->mh64->ncmds;
+	    mh_sizeofcmds = ofile->mh64->sizeofcmds;
+	    sizeof_mach_header = sizeof(struct mach_header_64);
+	}
+
+	/*
+	 * Mach header.
+	 */
+	if(hflag){
+	    if(ofile->mh != NULL)
+		print_mach_header(ofile->mh->magic, ofile->mh->cputype,
+				  ofile->mh->cpusubtype, ofile->mh->filetype,
+				  ofile->mh->ncmds, ofile->mh->sizeofcmds,
+				  ofile->mh->flags, vflag);
+	    else
+		print_mach_header(ofile->mh64->magic, ofile->mh64->cputype,
+				  ofile->mh64->cpusubtype,ofile->mh64->filetype,
+				  ofile->mh64->ncmds, ofile->mh64->sizeofcmds,
+				  ofile->mh64->flags, vflag);
+	}
+
+#ifdef OTOOL_NG_SUPPORT
+	if (zflag)
+	{
+		modify_pie_flag(ofile);
+	}
+#endif	
+	/*
+	 * Load commands.
+	 */
+	if(mh_sizeofcmds + sizeof_mach_header > size){
+	    load_commands = allocate(mh_sizeofcmds);
+	    memset(load_commands, '\0', mh_sizeofcmds);
+	    memcpy(load_commands, ofile->load_commands, 
+		   size - sizeof_mach_header);
+	    ofile->load_commands = load_commands;
+	}
+	if(lflag)
+	    print_loadcmds(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+			   mh_cputype, mh_filetype, ofile->object_byte_sex,
+			   size, vflag, Vflag);
+
+	if(Lflag || Dflag)
+	    print_libraries(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+			    ofile->object_byte_sex, (Dflag && !Lflag), vflag);
+
+	/*
+	 * If the indicated operation needs the symbol table get it.
+	 */
+	sect_flags = 0;
+	if(segname != NULL && sectname != NULL){
+	    (void)get_sect_info(segname, sectname, ofile->load_commands,
+			mh_ncmds, mh_sizeofcmds, mh_filetype,
+			ofile->object_byte_sex,
+			addr, size, &sect, &sect_size, &sect_addr,
+			&sect_relocs, &sect_nrelocs, &sect_flags, &seg_addr);
+	    /*
+	     * The MH_DYLIB_STUB format has all section sizes set to zero 
+	     * except sections with indirect symbol table entries (so that the
+	     * indirect symbol table table entries can be printed, which are
+	     * based on the section size).  So if we are being asked to print
+	     * the section contents of one of these sections in a MH_DYLIB_STUB
+	     * we assume it has been stripped and set the section size to zero.
+	     */
+	    if(mh_filetype == MH_DYLIB_STUB &&
+	       ((sect_flags & SECTION_TYPE) == S_NON_LAZY_SYMBOL_POINTERS ||
+	        (sect_flags & SECTION_TYPE) == S_LAZY_SYMBOL_POINTERS ||
+		(sect_flags & SECTION_TYPE) == S_LAZY_DYLIB_SYMBOL_POINTERS ||
+	        (sect_flags & SECTION_TYPE) == S_SYMBOL_STUBS))
+		sect_size = 0;
+	}
+	if(Rflag || Mflag)
+	    get_symbol_table_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+		mh_cputype, ofile->object_byte_sex, addr, size, &symbols,
+		&symbols64, &nsymbols, &strings, &strings_size);
+	if(vflag && (rflag || Tflag || Mflag || Rflag || Iflag || Hflag || tflag
+	   || iflag || oflag ||
+	   (sect_flags & SECTION_TYPE) == S_LITERAL_POINTERS ||
+	   (sect_flags & SECTION_TYPE) == S_MOD_INIT_FUNC_POINTERS ||
+	   (sect_flags & SECTION_TYPE) == S_MOD_TERM_FUNC_POINTERS ||
+	   (sect_flags & S_ATTR_PURE_INSTRUCTIONS) ==
+		S_ATTR_PURE_INSTRUCTIONS ||
+	   (sect_flags & S_ATTR_SOME_INSTRUCTIONS) ==
+		S_ATTR_SOME_INSTRUCTIONS ||
+	   segname != NULL)){
+	    get_symbol_table_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+	        mh_cputype, ofile->object_byte_sex, addr, size, &symbols, 
+		&symbols64, &nsymbols, &strings, &strings_size);
+
+	    if(symbols != NULL){
+		if((uintptr_t)symbols % sizeof(uint32_t) ||
+		   ofile->object_byte_sex != get_host_byte_sex()){
+		    allocated_symbols =
+			allocate(nsymbols * sizeof(struct nlist));
+		    memcpy(allocated_symbols, symbols,
+			   nsymbols * sizeof(struct nlist));
+		    symbols = allocated_symbols;
+		}
+		if(ofile->object_byte_sex != get_host_byte_sex())
+		    swap_nlist(symbols, nsymbols, get_host_byte_sex());
+	    }
+	    else{
+		if((uintptr_t)symbols64 % sizeof(uint32_t) ||
+		   ofile->object_byte_sex != get_host_byte_sex()){
+		    allocated_symbols64 =
+			allocate(nsymbols * sizeof(struct nlist_64));
+		    memcpy(allocated_symbols64, symbols64,
+			   nsymbols * sizeof(struct nlist_64));
+		    symbols64 = allocated_symbols64;
+		}
+		if(ofile->object_byte_sex != get_host_byte_sex())
+		    swap_nlist_64(symbols64, nsymbols, get_host_byte_sex());
+	    }
+
+	    /*
+	     * If the operation needs a sorted symbol table create it.
+	     */
+	    if(tflag || iflag || oflag || 
+	       (((sect_flags & SECTION_TYPE) == S_MOD_INIT_FUNC_POINTERS ||
+	         (sect_flags & SECTION_TYPE) == S_MOD_TERM_FUNC_POINTERS) &&
+		  Vflag) ||
+	       (sect_flags & S_ATTR_PURE_INSTRUCTIONS) ==
+		    S_ATTR_PURE_INSTRUCTIONS ||
+	       (sect_flags & S_ATTR_SOME_INSTRUCTIONS) ==
+		    S_ATTR_SOME_INSTRUCTIONS){
+		sorted_symbols = allocate(nsymbols * sizeof(struct symbol));
+		nsorted_symbols = 0;
+		for(i = 0; i < nsymbols; i++){
+		    if(symbols != NULL){
+			n_strx = symbols[i].n_un.n_strx;
+			n_type = symbols[i].n_type;
+			n_desc = symbols[i].n_desc;
+			n_value = symbols[i].n_value;
+		    }
+		    else{
+			n_strx = symbols64[i].n_un.n_strx;
+			n_type = symbols64[i].n_type;
+			n_desc = symbols64[i].n_desc;
+			n_value = symbols64[i].n_value;
+		    }
+		    if(n_strx > 0 && n_strx < strings_size)
+			p = strings + n_strx;
+		    else
+			p = "symbol with bad string index";
+		    if(n_type & ~(N_TYPE|N_EXT|N_PEXT))
+			continue;
+		    n_type = n_type & N_TYPE;
+		    if(n_type == N_ABS || n_type == N_SECT){
+			len = strlen(p);
+			if(len > sizeof(".o") - 1 &&
+			   strcmp(p + (len - (sizeof(".o") - 1)), ".o") == 0)
+			    continue;
+			if(strcmp(p, "gcc_compiled.") == 0)
+			    continue;
+			if(strncmp(p, "ltmp", sizeof("ltmp") - 1) == 0)
+			    continue;
+			if(n_type == N_ABS && n_value == 0 && *p == '.')
+			    continue;
+			sorted_symbols[nsorted_symbols].n_value = n_value;
+			sorted_symbols[nsorted_symbols].name = p;
+			sorted_symbols[nsorted_symbols].is_thumb =
+			    n_desc & N_ARM_THUMB_DEF;
+			nsorted_symbols++;
+		    }
+		}
+		qsort(sorted_symbols, nsorted_symbols, sizeof(struct symbol),
+		      (int (*)(const void *, const void *))sym_compare);
+	    }
+	}
+
+	if(Mflag || Tflag || Rflag){
+	    get_module_table_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+		mh_cputype, ofile->object_byte_sex, addr, size, &mods, &mods64,
+		&nmods);
+	    if(mods != NULL){
+		if((intptr_t)mods % sizeof(uint32_t) ||
+		   ofile->object_byte_sex != get_host_byte_sex()){
+		    allocated_mods = allocate(nmods *
+					      sizeof(struct dylib_module));
+		    memcpy(allocated_mods, mods,
+			   nmods * sizeof(struct dylib_module));
+		    mods = allocated_mods;
+		}
+		if(ofile->object_byte_sex != get_host_byte_sex())
+		    swap_dylib_module(mods, nmods, get_host_byte_sex());
+	    }
+	    if(mods64 != NULL){
+		if((intptr_t)mods64 % sizeof(uint64_t) ||
+		   ofile->object_byte_sex != get_host_byte_sex()){
+		    allocated_mods64 = allocate(nmods *
+					        sizeof(struct dylib_module_64));
+		    memcpy(allocated_mods64, mods64,
+			   nmods * sizeof(struct dylib_module_64));
+		    mods64 = allocated_mods64;
+		}
+		if(ofile->object_byte_sex != get_host_byte_sex())
+		    swap_dylib_module_64(mods64, nmods, get_host_byte_sex());
+	    }
+	}
+
+	if(Tflag){
+	    get_toc_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+		ofile->object_byte_sex, addr, size, &tocs, &ntocs);
+	    if((intptr_t)tocs % sizeof(uint32_t) ||
+	       ofile->object_byte_sex != get_host_byte_sex()){
+		allocated_tocs = allocate(ntocs *
+					sizeof(struct dylib_table_of_contents));
+		memcpy(allocated_tocs, tocs,
+		       ntocs * sizeof(struct dylib_table_of_contents));
+		tocs = allocated_tocs;
+	    }
+	    if(ofile->object_byte_sex != get_host_byte_sex())
+		swap_dylib_table_of_contents(tocs, ntocs, get_host_byte_sex());
+	    print_toc(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+		ofile->object_byte_sex, addr, size, tocs, ntocs, mods, mods64,
+		nmods, symbols, symbols64, nsymbols, strings, strings_size,
+		vflag);
+	}
+
+	if(Mflag){
+	    if(mods != NULL)
+		print_module_table(mods, nmods, strings, strings_size, vflag);
+	    else
+		print_module_table_64(mods64, nmods, strings, strings_size,
+				      vflag);
+	}
+
+	if(Rflag){
+	    get_ref_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+		ofile->object_byte_sex, addr, size, &refs, &nrefs);
+	    if((intptr_t)refs % sizeof(uint32_t) ||
+	       ofile->object_byte_sex != get_host_byte_sex()){
+		allocated_refs = allocate(nrefs *
+					sizeof(struct dylib_reference));
+		memcpy(allocated_refs, refs,
+		       nrefs * sizeof(struct dylib_reference));
+		refs = allocated_refs;
+	    }
+	    if(ofile->object_byte_sex != get_host_byte_sex())
+		swap_dylib_reference(refs, nrefs, get_host_byte_sex());
+	    print_refs(refs, nrefs, mods, mods64, nmods, symbols, symbols64,
+		       nsymbols, strings, strings_size, vflag);
+	}
+
+	if(Iflag || (tflag && vflag)){
+	    get_indirect_symbol_table_info(ofile->load_commands, mh_ncmds,
+		mh_sizeofcmds, ofile->object_byte_sex, addr, size,
+		&indirect_symbols, &nindirect_symbols);
+	    if((intptr_t)indirect_symbols % sizeof(uint32_t) ||
+	       ofile->object_byte_sex != get_host_byte_sex()){
+		allocated_indirect_symbols = allocate(nindirect_symbols *
+						     sizeof(uint32_t));
+		memcpy(allocated_indirect_symbols, indirect_symbols,
+		       nindirect_symbols * sizeof(uint32_t));
+		indirect_symbols = allocated_indirect_symbols;
+	    }
+	    if(ofile->object_byte_sex != get_host_byte_sex())
+		swap_indirect_symbols(indirect_symbols, nindirect_symbols,
+				      get_host_byte_sex());
+	}
+	if(Hflag){
+	    get_hints_table_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+		ofile->object_byte_sex, addr, size, &hints, &nhints);
+	    if((intptr_t)hints % sizeof(uint32_t) ||
+	       ofile->object_byte_sex != get_host_byte_sex()){
+		allocated_hints = allocate(nhints *
+					   sizeof(struct twolevel_hint));
+		memcpy(allocated_hints, hints,
+		       nhints * sizeof(struct twolevel_hint));
+		hints = allocated_hints;
+	    }
+	    if(ofile->object_byte_sex != get_host_byte_sex())
+		swap_twolevel_hint(hints, nhints, get_host_byte_sex());
+	    print_hints(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+		ofile->object_byte_sex, hints, nhints, symbols, symbols64,
+		nsymbols, strings, strings_size, vflag);
+	}
+	if(Cflag){
+	    get_link_opt_hints(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+		ofile->object_byte_sex, addr, size, &loh, &nloh);
+	    print_link_opt_hints(loh, nloh);
+	}
+	if(Gflag || (tflag && vflag)){
+	    get_data_in_code_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+		ofile->object_byte_sex, addr, size, &dices, &ndices);
+	    if((intptr_t)dices % sizeof(uint32_t) ||
+	       ofile->object_byte_sex != get_host_byte_sex()){
+		allocated_dices = allocate(ndices *
+					   sizeof(struct data_in_code_entry));
+		memcpy(allocated_dices, dices,
+		       ndices * sizeof(struct data_in_code_entry));
+		dices = allocated_dices;
+	    }
+	    if(ofile->object_byte_sex != get_host_byte_sex())
+		swap_data_in_code_entry(dices, ndices, get_host_byte_sex());
+	    if(Gflag)
+		print_dices(dices, ndices, vflag);
+	}
+	if(Iflag)
+	    print_indirect_symbols(ofile->load_commands, mh_ncmds,mh_sizeofcmds,
+		mh_cputype, ofile->object_byte_sex, indirect_symbols,
+		nindirect_symbols, symbols, symbols64, nsymbols, strings,
+		strings_size, vflag);
+
+	if(rflag)
+	    print_reloc(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+			mh_cputype, ofile->object_byte_sex, addr, size, symbols,
+		        symbols64, nsymbols, strings, strings_size, vflag);
+	if(print_bind_info){
+	    setup_dyld_bind_info(ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+		ofile->object_byte_sex, ofile->object_addr, ofile->object_size,
+		&dbi, &ndbi);
+	    print_dyld_bind_info(dbi, ndbi);
+	}
+
+	if(tflag ||
+	   (sect_flags & S_ATTR_PURE_INSTRUCTIONS) ==
+		S_ATTR_PURE_INSTRUCTIONS ||
+	   (sect_flags & S_ATTR_SOME_INSTRUCTIONS) ==
+		S_ATTR_SOME_INSTRUCTIONS){
+	    if(tflag)
+		(void)get_sect_info(SEG_TEXT, SECT_TEXT, ofile->load_commands,
+		    mh_ncmds, mh_sizeofcmds, mh_filetype,
+		    ofile->object_byte_sex,
+		    addr, size, &sect, &sect_size, &sect_addr,
+		    &sect_relocs, &sect_nrelocs, &sect_flags, &seg_addr);
+
+	    /* create aligned relocations entries as needed */
+	    relocs = NULL;
+	    nrelocs = 0;
+	    ext_relocs = NULL;
+	    next_relocs = 0;
+	    loc_relocs = NULL;
+	    nloc_relocs = 0;
+	    if(Vflag){
+		if(mh_filetype == MH_KEXT_BUNDLE){
+		    get_linked_reloc_info(ofile->load_commands, mh_ncmds,
+			    mh_sizeofcmds, ofile->object_byte_sex,
+			    ofile->object_addr, ofile->object_size, &ext_relocs,
+			    &next_relocs, &loc_relocs, &nloc_relocs);
+		    /* create aligned relocations entries as needed */
+		    if((intptr_t)ext_relocs % sizeof(int32_t) != 0 ||
+		       ofile->object_byte_sex != get_host_byte_sex()){
+			relocs = allocate(next_relocs *
+					  sizeof(struct relocation_info));
+			memcpy(relocs, ext_relocs, next_relocs *
+			       sizeof(struct relocation_info));
+			ext_relocs = relocs;
+		    }
+		    if((intptr_t)loc_relocs % sizeof(int32_t) != 0 ||
+		       ofile->object_byte_sex != get_host_byte_sex()){
+			relocs = allocate(nloc_relocs *
+					  sizeof(struct relocation_info));
+			memcpy(relocs, loc_relocs, nloc_relocs *
+			       sizeof(struct relocation_info));
+			loc_relocs = relocs;
+		    }
+		    if(ofile->object_byte_sex != get_host_byte_sex()){
+			swap_relocation_info(ext_relocs, next_relocs,
+					     get_host_byte_sex());
+			swap_relocation_info(loc_relocs, nloc_relocs,
+					     get_host_byte_sex());
+		    }
+		    relocs = NULL;
+		}
+		if((intptr_t)sect_relocs % sizeof(int32_t) != 0 ||
+		   ofile->object_byte_sex != get_host_byte_sex()){
+		    nrelocs = sect_nrelocs;
+		    relocs = allocate(nrelocs *
+				      sizeof(struct relocation_info));
+		    memcpy(relocs, sect_relocs, nrelocs *
+			   sizeof(struct relocation_info));
+		}
+		else{
+		    nrelocs = sect_nrelocs;
+		    relocs = sect_relocs;
+		}
+		if(ofile->object_byte_sex != get_host_byte_sex())
+		    swap_relocation_info(relocs, nrelocs,
+					 get_host_byte_sex());
+		setup_dyld_bind_info(ofile->load_commands, mh_ncmds,
+				     mh_sizeofcmds, ofile->object_byte_sex,
+				     ofile->object_addr, ofile->object_size,
+				     &dbi, &ndbi);
+	    }
+	    if(Xflag == FALSE){
+		if(tflag)
+		    printf("(%s,%s) section\n", SEG_TEXT, SECT_TEXT);
+		else
+		    printf("Contents of (%.16s,%.16s) section\n", segname,
+			   sectname);
+	    }
+	    if(Uflag)
+		print_text_by_symbols(mh_cputype, ofile->object_byte_sex, sect,
+		       sect_size, sect_addr, sect_flags, sorted_symbols,
+		       nsorted_symbols, symbols, symbols64, nsymbols, strings,
+		       strings_size, relocs, nrelocs, ext_relocs, next_relocs,
+		       loc_relocs, nloc_relocs, dbi, ndbi, indirect_symbols,
+		       nindirect_symbols, ofile->load_commands, mh_ncmds,
+		       mh_sizeofcmds, vflag, Vflag, mh_cpusubtype,
+		       ofile->object_addr, ofile->object_size, dices, ndices,
+		       seg_addr);
+	    else
+		print_text(mh_cputype, ofile->object_byte_sex, sect, sect_size,
+		       sect_addr, sect_flags, sorted_symbols,
+		       nsorted_symbols, symbols, symbols64, nsymbols, strings,
+		       strings_size, relocs, nrelocs, ext_relocs, next_relocs,
+		       loc_relocs, nloc_relocs, dbi, ndbi, indirect_symbols,
+		       nindirect_symbols, ofile->load_commands, mh_ncmds,
+		       mh_sizeofcmds, vflag, Vflag, mh_cpusubtype,
+		       ofile->object_addr, ofile->object_size, dices, ndices,
+                       seg_addr);
+
+	    if(relocs != NULL && relocs != sect_relocs)
+		free(relocs);
+	}
+
+	if(iflag){
+	    if(get_sect_info(SEG_TEXT, SECT_FVMLIB_INIT0, ofile->load_commands,
+		mh_ncmds, mh_sizeofcmds, mh_filetype, ofile->object_byte_sex,
+		addr, size, &sect, &sect_size, &sect_addr,
+		&sect_relocs, &sect_nrelocs, &sect_flags, &seg_addr) == TRUE){
+
+		/* create aligned, sorted relocations entries */
+		nrelocs = sect_nrelocs;
+		relocs = allocate(nrelocs * sizeof(struct relocation_info));
+		memcpy(relocs, sect_relocs, nrelocs *
+		       sizeof(struct relocation_info));
+		if(ofile->object_byte_sex != get_host_byte_sex())
+		    swap_relocation_info(relocs, nrelocs, get_host_byte_sex());
+		qsort(relocs, nrelocs, sizeof(struct relocation_info),
+		      (int (*)(const void *, const void *))rel_compare);
+
+		if(Xflag == FALSE)
+		    printf("Shared library initialization (%s,%s) section\n",
+			   SEG_TEXT, SECT_FVMLIB_INIT0);
+		print_shlib_init(ofile->object_byte_sex, sect, sect_size,
+			sect_addr, sorted_symbols, nsorted_symbols, symbols,
+			symbols64, nsymbols, strings, strings_size, relocs,
+			nrelocs, vflag);
+		free(relocs);
+	    }
+	}
+
+	if(dflag){
+	    if(get_sect_info(SEG_DATA, SECT_DATA, ofile->load_commands,
+		mh_ncmds, mh_sizeofcmds, mh_filetype, ofile->object_byte_sex,
+		addr, size, &sect, &sect_size, &sect_addr,
+		&sect_relocs, &sect_nrelocs, &sect_flags, &seg_addr) == TRUE){
+
+		if(Xflag == FALSE)
+		    printf("(%s,%s) section\n", SEG_DATA, SECT_DATA);
+		print_sect(mh_cputype, ofile->object_byte_sex, sect, sect_size,
+			   sect_addr);
+	    }
+	}
+
+	if(Pflag){
+	    if(get_sect_info(SEG_TEXT, "__info_plist", ofile->load_commands,
+		mh_ncmds, mh_sizeofcmds, mh_filetype, ofile->object_byte_sex,
+		addr, size, &sect, &sect_size, &sect_addr,
+		&sect_relocs, &sect_nrelocs, &sect_flags, &seg_addr) == TRUE){
+
+		if(Xflag == FALSE)
+		    printf("(%s,%s) section\n", SEG_TEXT, "__info_plist");
+		printf("%.*s\n", (int)sect_size, sect);
+	    }
+	}
+
+	if(segname != NULL && sectname != NULL &&
+	   (sect_flags & S_ATTR_PURE_INSTRUCTIONS) !=
+		S_ATTR_PURE_INSTRUCTIONS &&
+	   (sect_flags & S_ATTR_SOME_INSTRUCTIONS) !=
+		S_ATTR_SOME_INSTRUCTIONS){
+	    if(strcmp(segname, SEG_OBJC) == 0 &&
+	       strcmp(sectname, "__protocol") == 0 && vflag == TRUE){
+		print_objc_protocol_section(ofile->load_commands, mh_ncmds,
+		   mh_sizeofcmds, ofile->object_byte_sex, ofile->object_addr,
+		   ofile->object_size, vflag);
+	    }
+	    else if(strcmp(segname, SEG_OBJC) == 0 &&
+	            (strcmp(sectname, "__string_object") == 0 ||
+	             strcmp(sectname, "__cstring_object") == 0) &&
+		    vflag == TRUE){
+		if(mh_cputype & CPU_ARCH_ABI64)
+		    print_objc_string_object_section_64(sectname,
+			ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+			ofile->object_byte_sex, ofile->object_addr,
+			ofile->object_size, mh_cputype, symbols64, nsymbols,
+			strings, strings_size, sorted_symbols, nsorted_symbols,
+			vflag);
+		else
+		    print_objc_string_object_section(sectname,
+			ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+			ofile->object_byte_sex, ofile->object_addr,
+			ofile->object_size, vflag);
+	    }
+	    else if(strcmp(segname, SEG_OBJC) == 0 &&
+	       strcmp(sectname, "__runtime_setup") == 0 && vflag == TRUE){
+		print_objc_runtime_setup_section(ofile->load_commands, mh_ncmds,
+		   mh_sizeofcmds, ofile->object_byte_sex, ofile->object_addr,
+		   ofile->object_size, vflag);
+	    }
+	    else if(strcmp(segname, "__LLVM") == 0 &&
+	       strcmp(sectname, "__bundle") == 0 &&
+	       (vflag == TRUE || Vflag == TRUE) &&
+	       get_sect_info(segname, sectname, ofile->load_commands,
+                   mh_ncmds, mh_sizeofcmds, mh_filetype, ofile->object_byte_sex,
+                   addr, size, &sect, &sect_size, &sect_addr, &sect_relocs,
+		   &sect_nrelocs, &sect_flags, &seg_addr) == TRUE){
+		print_bitcode_section(sect, sect_size, vflag, Vflag);
+	    }
+#ifdef EFI_SUPPORT
+	    else if(strcmp(segname, "__RELOC") == 0 &&
+	       strcmp(sectname, "__reloc") == 0 && vflag == TRUE){
+		print_coff_reloc_section(ofile->load_commands, mh_ncmds,
+		   mh_sizeofcmds, mh_filetype, ofile->object_byte_sex,
+		   ofile->object_addr, ofile->object_size, vflag);
+	    }
+#endif
+	    else if(get_sect_info(segname, sectname, ofile->load_commands,
+		mh_ncmds, mh_sizeofcmds, mh_filetype, ofile->object_byte_sex,
+		addr, size, &sect, &sect_size, &sect_addr,
+		&sect_relocs, &sect_nrelocs, &sect_flags, &seg_addr) == TRUE){
+
+		if(Xflag == FALSE)
+		    printf("Contents of (%.16s,%.16s) section\n", segname,
+			   sectname);
+
+		if(vflag){
+		    switch((sect_flags & SECTION_TYPE)){
+		    case 0:
+			print_sect(mh_cputype, ofile->object_byte_sex,
+				   sect, sect_size, sect_addr);
+			break;
+		    case S_ZEROFILL:
+			printf("zerofill section and has no contents in the "
+			       "file\n");
+			break;
+		    case S_CSTRING_LITERALS:
+			print_cstring_section(mh_cputype, sect, sect_size,
+					      sect_addr,
+					      Xflag == TRUE ? FALSE : TRUE);
+			break;
+		    case S_4BYTE_LITERALS:
+			print_literal4_section(mh_cputype, sect, sect_size,
+					       sect_addr,
+					       ofile->object_byte_sex,
+					       Xflag == TRUE ? FALSE : TRUE);
+			break;
+		    case S_8BYTE_LITERALS:
+			print_literal8_section(mh_cputype, sect, sect_size,
+					       sect_addr,
+					       ofile->object_byte_sex,
+					       Xflag == TRUE ? FALSE : TRUE);
+			break;
+		    case S_16BYTE_LITERALS:
+			print_literal16_section(mh_cputype, sect, sect_size,
+						sect_addr,
+					        ofile->object_byte_sex,
+					        Xflag == TRUE ? FALSE : TRUE);
+			break;
+		    case S_LITERAL_POINTERS:
+			/* create aligned, sorted relocations entries */
+			nrelocs = sect_nrelocs;
+			relocs = allocate(nrelocs *
+					  sizeof(struct relocation_info));
+			memcpy(relocs, sect_relocs, nrelocs *
+			       sizeof(struct relocation_info));
+			if(ofile->object_byte_sex != get_host_byte_sex())
+			    swap_relocation_info(relocs, nrelocs,
+					         get_host_byte_sex());
+			qsort(relocs, nrelocs, sizeof(struct relocation_info),
+			      (int (*)(const void *, const void *))rel_compare);
+			print_literal_pointer_section(mh_cputype,
+				ofile->load_commands, mh_ncmds, mh_sizeofcmds,
+				ofile->object_byte_sex, addr, size, sect,
+				sect_size, sect_addr, symbols, symbols64,
+				nsymbols, strings, strings_size, relocs,
+				nrelocs, Xflag == TRUE ? FALSE : TRUE);
+			free(relocs);
+
+			break;
+
+		    case S_MOD_INIT_FUNC_POINTERS:
+		    case S_MOD_TERM_FUNC_POINTERS:
+			print_init_term_pointer_section(mh_cputype, sect,
+			    sect_size, sect_addr, ofile->object_byte_sex,
+			    sorted_symbols, nsorted_symbols, Vflag);
+			break;
+
+		    default:
+			printf("Unknown section type (0x%x)\n",
+			       (unsigned int)(sect_flags & SECTION_TYPE));
+			print_sect(mh_cputype, ofile->object_byte_sex, sect,
+				   sect_size, sect_addr);
+			break;
+		    }
+		}
+		else{
+		    if((sect_flags & SECTION_TYPE) == S_ZEROFILL)
+			printf("zerofill section and has no contents in the "
+			       "file\n");
+		    else
+			print_sect(mh_cputype, ofile->object_byte_sex, sect,
+				   sect_size, sect_addr);
+		}
+	    }
+	}
+
+	if(cflag)
+	    print_argstrings(mh_magic, ofile->load_commands, mh_ncmds,
+			     mh_sizeofcmds, mh_cputype, mh_cpusubtype,
+			     ofile->object_byte_sex, ofile->object_addr,
+			     ofile->object_size);
+
+	if(oflag){
+	    if(mh_cputype & CPU_ARCH_ABI64){
+		get_linked_reloc_info(ofile->load_commands, mh_ncmds,
+			mh_sizeofcmds, ofile->object_byte_sex,
+			ofile->object_addr, ofile->object_size, &ext_relocs,
+			&next_relocs, &loc_relocs, &nloc_relocs);
+		/* create aligned relocations entries as needed */
+		relocs = NULL;
+		nrelocs = 0;
+		if((intptr_t)ext_relocs % sizeof(int32_t) != 0 ||
+		   ofile->object_byte_sex != get_host_byte_sex()){
+		    relocs = allocate(next_relocs *
+				      sizeof(struct relocation_info));
+		    memcpy(relocs, ext_relocs, next_relocs *
+			   sizeof(struct relocation_info));
+		    ext_relocs = relocs;
+		}
+		if((intptr_t)loc_relocs % sizeof(int32_t) != 0 ||
+		   ofile->object_byte_sex != get_host_byte_sex()){
+		    relocs = allocate(nloc_relocs *
+				      sizeof(struct relocation_info));
+		    memcpy(relocs, loc_relocs, nloc_relocs *
+			   sizeof(struct relocation_info));
+		    loc_relocs = relocs;
+		}
+		if(ofile->object_byte_sex != get_host_byte_sex()){
+		    swap_relocation_info(ext_relocs, next_relocs,
+					 get_host_byte_sex());
+		    swap_relocation_info(loc_relocs, nloc_relocs,
+					 get_host_byte_sex());
+		}
+		setup_dyld_bind_info(ofile->load_commands, mh_ncmds,
+				     mh_sizeofcmds, ofile->object_byte_sex,
+				     ofile->object_addr, ofile->object_size,
+				     &dbi, &ndbi);
+		print_objc2_64bit(mh_cputype, ofile->load_commands, mh_ncmds,
+			    mh_sizeofcmds, ofile->object_byte_sex,
+			    ofile->object_addr, ofile->object_size, symbols64,
+			    nsymbols, strings, strings_size, sorted_symbols,
+			    nsorted_symbols, ext_relocs, next_relocs,
+			    loc_relocs, nloc_relocs, dbi, ndbi, vflag, Vflag);
+	    }
+	    else if(mh_cputype == CPU_TYPE_ARM){
+		get_linked_reloc_info(ofile->load_commands, mh_ncmds,
+			mh_sizeofcmds, ofile->object_byte_sex,
+			ofile->object_addr, ofile->object_size, &ext_relocs,
+			&next_relocs, &loc_relocs, &nloc_relocs);
+		/* create aligned relocations entries as needed */
+		relocs = NULL;
+		nrelocs = 0;
+		if((intptr_t)ext_relocs % sizeof(int32_t) != 0 ||
+		   ofile->object_byte_sex != get_host_byte_sex()){
+		    relocs = allocate(next_relocs *
+				      sizeof(struct relocation_info));
+		    memcpy(relocs, ext_relocs, next_relocs *
+			   sizeof(struct relocation_info));
+		    ext_relocs = relocs;
+		}
+		if((intptr_t)loc_relocs % sizeof(int32_t) != 0 ||
+		   ofile->object_byte_sex != get_host_byte_sex()){
+		    relocs = allocate(nloc_relocs *
+				      sizeof(struct relocation_info));
+		    memcpy(relocs, loc_relocs, nloc_relocs *
+			   sizeof(struct relocation_info));
+		    loc_relocs = relocs;
+		}
+		if(ofile->object_byte_sex != get_host_byte_sex()){
+		    swap_relocation_info(ext_relocs, next_relocs,
+					 get_host_byte_sex());
+		    swap_relocation_info(loc_relocs, nloc_relocs,
+					 get_host_byte_sex());
+		}
+		print_objc2_32bit(mh_cputype, ofile->load_commands, mh_ncmds,
+			    mh_sizeofcmds, ofile->object_byte_sex,
+			    ofile->object_addr, ofile->object_size, symbols,
+			    nsymbols, strings, strings_size, sorted_symbols,
+			    nsorted_symbols, ext_relocs, next_relocs,
+			    loc_relocs, nloc_relocs, vflag);
+	    }
+	    else{
+		 /*
+		  * This is the 32-bit non-arm cputype case.  Which is normally
+		  * the first Objective-C ABI.  But it may be the case of a
+		  * binary for the iOS simulator which is the second Objective-C
+		  * ABI.  In that case print_objc_segment() will determine that
+		  * and return FALSE.
+		  */
+		 if(print_objc_segment(mh_cputype, ofile->load_commands,
+			mh_ncmds, mh_sizeofcmds, ofile->object_byte_sex,
+			ofile->object_addr, ofile->object_size, sorted_symbols,
+			nsorted_symbols, vflag) == FALSE){
+		    get_linked_reloc_info(ofile->load_commands, mh_ncmds,
+			    mh_sizeofcmds, ofile->object_byte_sex,
+			    ofile->object_addr, ofile->object_size, &ext_relocs,
+			    &next_relocs, &loc_relocs, &nloc_relocs);
+		    /* create aligned relocations entries as needed */
+		    relocs = NULL;
+		    nrelocs = 0;
+		    if((intptr_t)ext_relocs % sizeof(int32_t) != 0 ||
+		       ofile->object_byte_sex != get_host_byte_sex()){
+			relocs = allocate(next_relocs *
+					  sizeof(struct relocation_info));
+			memcpy(relocs, ext_relocs, next_relocs *
+			       sizeof(struct relocation_info));
+			ext_relocs = relocs;
+		    }
+		    if((intptr_t)loc_relocs % sizeof(int32_t) != 0 ||
+		       ofile->object_byte_sex != get_host_byte_sex()){
+			relocs = allocate(nloc_relocs *
+					  sizeof(struct relocation_info));
+			memcpy(relocs, loc_relocs, nloc_relocs *
+			       sizeof(struct relocation_info));
+			loc_relocs = relocs;
+		    }
+		    if(ofile->object_byte_sex != get_host_byte_sex()){
+			swap_relocation_info(ext_relocs, next_relocs,
+					     get_host_byte_sex());
+			swap_relocation_info(loc_relocs, nloc_relocs,
+					     get_host_byte_sex());
+		    }
+		    print_objc2_32bit(mh_cputype, ofile->load_commands,
+			    mh_ncmds, mh_sizeofcmds, ofile->object_byte_sex,
+			    ofile->object_addr, ofile->object_size, symbols,
+			    nsymbols, strings, strings_size, sorted_symbols,
+			    nsorted_symbols, ext_relocs, next_relocs,
+			    loc_relocs, nloc_relocs, vflag);
+		}
+	    }
+	}
+
+	if(load_commands != NULL)
+	    free(load_commands);
+	if(allocated_symbols != NULL)
+	    free(allocated_symbols);
+	if(sorted_symbols != NULL)
+	    free(sorted_symbols);
+	if(allocated_indirect_symbols != NULL)
+	    free(allocated_indirect_symbols);
+	if(allocated_hints != NULL)
+	    free(allocated_hints);
+	if(allocated_dices != NULL)
+	    free(allocated_dices);
+	if(allocated_tocs != NULL)
+	    free(allocated_tocs);
+	if(allocated_mods != NULL)
+	    free(allocated_mods);
+	if(allocated_refs != NULL)
+	    free(allocated_refs);
+	if(dbi != NULL)
+	    free(dbi);
+}
+
+/*
+ * get_symbol_table_info() returns pointers to the symbol table and string
+ * table as well as the number of symbols and size of the string table.
+ * This routine handles the problems related to the file being truncated and
+ * only returns valid pointers and sizes that can be used.  This routine will
+ * return pointers that are misaligned and it is up to the caller to deal with
+ * alignment issues.  It is also up to the caller to deal with byte sex of the
+ * the symbol table.
+ */
+static
+void
+get_symbol_table_info(
+struct load_command *load_commands,	/* input */
+uint32_t ncmds,
+uint32_t sizeofcmds,
+cpu_type_t cputype,
+enum byte_sex load_commands_byte_sex,
+char *object_addr,
+uint32_t object_size,
+struct nlist **symbols,			/* output */
+struct nlist_64 **symbols64,
+uint32_t *nsymbols,
+char **strings,
+uint32_t *strings_size)
+{
+    enum byte_sex host_byte_sex;
+    enum bool swapped;
+    uint32_t i, left, size, st_cmd;
+    struct load_command *lc, l;
+    struct symtab_command st;
+    uint64_t bigsize;
+
+	*symbols = NULL;
+	*symbols64 = NULL;
+	*nsymbols = 0;
+	*strings = NULL;
+	*strings_size = 0;
+
+	host_byte_sex = get_host_byte_sex();
+	swapped = host_byte_sex != load_commands_byte_sex;
+
+	st_cmd = UINT_MAX;
+	lc = load_commands;
+	memset((char *)&st, '\0', sizeof(struct symtab_command));
+	for(i = 0 ; i < ncmds; i++){
+	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
+	    if(swapped)
+		swap_load_command(&l, host_byte_sex);
+	    if(l.cmdsize % sizeof(int32_t) != 0)
+		printf("load command %u size not a multiple of "
+		       "sizeof(int32_t)\n", i);
+	    if((char *)lc + l.cmdsize >
+	       (char *)load_commands + sizeofcmds)
+		printf("load command %u extends past end of load "
+		       "commands\n", i);
+	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
+
+	    switch(l.cmd){
+	    case LC_SYMTAB:
+		if(st_cmd != UINT_MAX){
+		    printf("more than one LC_SYMTAB command (using command %u)"
+			   "\n", st_cmd);
+		    break;
+		}
+		size = left < sizeof(struct symtab_command) ?
+		       left : sizeof(struct symtab_command);
+		memcpy((char *)&st, (char *)lc, size);
+		if(swapped)
+		    swap_symtab_command(&st, host_byte_sex);
+		st_cmd = i;
+	    }
+	    if(l.cmdsize == 0){
+		printf("load command %u size zero (can't advance to other "
+		       "load commands)\n", i);
+		break;
+	    }
+	    lc = (struct load_command *)((char *)lc + l.cmdsize);
+	    if((char *)lc > (char *)load_commands + sizeofcmds)
+		break;
+	}
+	if((char *)load_commands + sizeofcmds != (char *)lc)
+	    printf("Inconsistent sizeofcmds\n");
+
+	if(st_cmd == UINT_MAX){
+	    return;
+	}
+
+	if(st.symoff >= object_size){
+	    printf("symbol table offset is past end of file\n");
+	}
+	else{
+	    if(cputype & CPU_ARCH_ABI64){
+		*symbols64 = (struct nlist_64 *)(object_addr + st.symoff);
+		bigsize = st.nsyms;
+		bigsize *= sizeof(struct nlist_64);
+		bigsize += st.symoff; 
+		if(bigsize > object_size){
+		    printf("symbol table extends past end of file\n");
+		    *nsymbols = (object_size - st.symoff) /
+			        sizeof(struct nlist_64);
+		}
+		else
+		    *nsymbols = st.nsyms;
+	    }
+	    else{
+		*symbols = (struct nlist *)(object_addr + st.symoff);
+		bigsize = st.nsyms;
+		bigsize *= sizeof(struct nlist);
+		bigsize += st.symoff; 
+		if(bigsize > object_size){
+		    printf("symbol table extends past end of file\n");
+		    *nsymbols = (object_size - st.symoff) /
+			        sizeof(struct nlist);
+		}
+		else
+		    *nsymbols = st.nsyms;
+	    }
+	}
+
+	if(st.stroff >= object_size){
+	    printf("string table offset is past end of file\n");
+	}
+	else{
+	    *strings = object_addr + st.stroff;
+	    if(st.stroff + st.strsize > object_size){
+		printf("string table extends past end of file\n");
+	    }
+	    else
+		*strings_size = st.strsize;
+	}
+}
+
+/*
+ * get_toc_info() returns a pointer and the size of the table of contents.
+ * This routine handles the problems related to the file being truncated and
+ * only returns valid pointers and sizes that can be used.  This routine will
+ * return pointers that are misaligned and it is up to the caller to deal with
+ * alignment issues.  It is also up to the caller to deal with byte sex of the
+ * table.
+ */
+static
+void
+get_toc_info(
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum byte_sex load_commands_byte_sex,
+char *object_addr,
+uint32_t object_size,
+struct dylib_table_of_contents **tocs,	/* output */
+uint32_t *ntocs)
+{
+    struct dysymtab_command dyst;
+    uint64_t bigsize;
+
+	*tocs = NULL;
+	*ntocs = 0;
+
+	if(get_dyst(load_commands, ncmds, sizeofcmds, load_commands_byte_sex,
+		    &dyst) == FALSE)
+	    return;
+
+	if(dyst.tocoff >= object_size){
+	    printf("table of contents offset is past end of file\n");
+	}
+	else{
+	    *tocs = (struct dylib_table_of_contents *)(object_addr +
+						       dyst.tocoff);
+	    bigsize = dyst.ntoc;
+	    bigsize *= sizeof(struct dylib_table_of_contents);
+	    bigsize += dyst.tocoff;
+	    if(bigsize > object_size){
+		printf("table of contents extends past end of file\n");
+		*ntocs = (object_size - dyst.tocoff) /
+				     sizeof(struct dylib_table_of_contents);
+	    }
+	    else
+		*ntocs = dyst.ntoc;
+	}
+}
+
+/*
+ * get_module_table_info() returns a pointer and the size of the
+ * module table.  This routine handles the problems related to the file being
+ * truncated and only returns valid pointers and sizes that can be used.  This
+ * routine will return pointers that are misaligned and it is up to the caller
+ * to deal with alignment issues.  It is also up to the caller to deal with
+ * byte sex of the table.
+ */
+static
+void
+get_module_table_info(
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+cpu_type_t cputype,
+enum byte_sex load_commands_byte_sex,
+char *object_addr,
+uint32_t object_size,
+struct dylib_module **mods,			/* output */
+struct dylib_module_64 **mods64,
+uint32_t *nmods)
+{
+    struct dysymtab_command dyst;
+    uint64_t bigsize;
+
+	*mods = NULL;
+	*mods64 = NULL;
+	*nmods = 0;
+
+	if(get_dyst(load_commands, ncmds, sizeofcmds, load_commands_byte_sex,
+		    &dyst) == FALSE)
+	    return;
+
+	if(dyst.modtaboff >= object_size){
+	    printf("module table offset is past end of file\n");
+	}
+	else{
+	    if(cputype & CPU_ARCH_ABI64){
+		*mods64 = (struct dylib_module_64 *)(object_addr +
+						     dyst.modtaboff);
+		bigsize = dyst.nmodtab;
+		bigsize *= sizeof(struct dylib_module_64);
+		bigsize += dyst.modtaboff;
+		if(bigsize > object_size){
+		    printf("module table extends past end of file\n");
+		    *nmods = (object_size - dyst.modtaboff) /
+					 sizeof(struct dylib_module_64);
+		}
+		else
+		    *nmods = dyst.nmodtab;
+	    }
+	    else{
+		*mods = (struct dylib_module *)(object_addr + dyst.modtaboff);
+		if(dyst.modtaboff +
+		   dyst.nmodtab * sizeof(struct dylib_module) > object_size){
+		    printf("module table extends past end of file\n");
+		    *nmods = (object_size - dyst.modtaboff) /
+					 sizeof(struct dylib_module);
+		}
+		else
+		    *nmods = dyst.nmodtab;
+	    }
+	}
+}
+
+/*
+ * get_ref_info() returns a pointer and the size of the reference table.
+ * This routine handles the problems related to the file being truncated and
+ * only returns valid pointers and sizes that can be used.  This routine will
+ * return pointers that are misaligned and it is up to the caller to deal with
+ * alignment issues.  It is also up to the caller to deal with byte sex of the
+ * table.
+ */
+static
+void
+get_ref_info(
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum byte_sex load_commands_byte_sex,
+char *object_addr,
+uint32_t object_size,
+struct dylib_reference **refs,		/* output */
+uint32_t *nrefs)
+{
+    struct dysymtab_command dyst;
+    uint64_t bigsize;
+
+	*refs = NULL;
+	*nrefs = 0;
+
+	if(get_dyst(load_commands, ncmds, sizeofcmds, load_commands_byte_sex,
+		    &dyst) == FALSE)
+	    return;
+
+	if(dyst.extrefsymoff >= object_size){
+	    printf("reference table offset is past end of file\n");
+	}
+	else{
+	    *refs = (struct dylib_reference *)(object_addr + dyst.extrefsymoff);
+	    bigsize = dyst.nextrefsyms;
+	    bigsize *= sizeof(struct dylib_reference);
+	    bigsize += dyst.extrefsymoff;
+	    if(bigsize > object_size){
+		printf("reference table extends past end of file\n");
+		*nrefs = (object_size - dyst.extrefsymoff) /
+				     sizeof(struct dylib_reference);
+	    }
+	    else
+		*nrefs = dyst.nextrefsyms;
+	}
+}
+
+/*
+ * get_indirect_symbol_table_info() returns a pointer and the size of the
+ * indirect symbol table.  This routine handles the problems related to the
+ * file being truncated and only returns valid pointers and sizes that can be
+ * used.  This routine will return pointers that are misaligned and it is up to
+ * the caller to deal with alignment issues.  It is also up to the caller to
+ * deal with byte sex of the table.
+ */
+static
+void
+get_indirect_symbol_table_info(
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum byte_sex load_commands_byte_sex,
+char *object_addr,
+uint32_t object_size,
+uint32_t **indirect_symbols,	/* output */
+uint32_t *nindirect_symbols)
+{
+    struct dysymtab_command dyst;
+    uint64_t bigsize;
+
+	*indirect_symbols = NULL;
+	*nindirect_symbols = 0;
+
+	if(get_dyst(load_commands, ncmds, sizeofcmds, load_commands_byte_sex,
+		    &dyst) == FALSE)
+	    return;
+
+	if(dyst.indirectsymoff >= object_size){
+	    printf("indirect symbol table offset is past end of file\n");
+	}
+	else{
+	    *indirect_symbols = (uint32_t *)(object_addr + dyst.indirectsymoff);
+	    bigsize = dyst.nindirectsyms;
+	    bigsize *= sizeof(uint32_t);
+	    bigsize += dyst.indirectsymoff;
+	    if(bigsize > object_size){
+		printf("indirect symbol table extends past end of file\n");
+		*nindirect_symbols = (object_size - dyst.indirectsymoff) /
+				     sizeof(uint32_t);
+	    }
+	    else
+		*nindirect_symbols = dyst.nindirectsyms;
+	}
+}
+
+/*
+ * get_dyst() gets the dysymtab_command from the mach header and load commands
+ * passed to it and copys it into dyst.  It if doesn't find one it returns FALSE
+ * else it returns TRUE.
+ */
+static
+enum bool
+get_dyst(
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum byte_sex load_commands_byte_sex,
+struct dysymtab_command *dyst)
+{
+    enum byte_sex host_byte_sex;
+    enum bool swapped;
+    uint32_t i, left, size, dyst_cmd;
+    struct load_command *lc, l;
+
+	host_byte_sex = get_host_byte_sex();
+	swapped = host_byte_sex != load_commands_byte_sex;
+
+	dyst_cmd = UINT_MAX;
+	lc = load_commands;
+	for(i = 0 ; i < ncmds; i++){
+	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
+	    if(swapped)
+		swap_load_command(&l, host_byte_sex);
+	    if(l.cmdsize % sizeof(int32_t) != 0)
+		printf("load command %u size not a multiple of "
+		       "sizeof(int32_t)\n", i);
+	    if((char *)lc + l.cmdsize >
+	       (char *)load_commands + sizeofcmds)
+		printf("load command %u extends past end of load "
+		       "commands\n", i);
+	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
+
+	    switch(l.cmd){
+	    case LC_DYSYMTAB:
+		if(dyst_cmd != UINT_MAX){
+		    printf("more than one LC_DYSYMTAB command (using command "
+			   "%u)\n", dyst_cmd);
+		    break;
+		}
+		memset((char *)dyst, '\0', sizeof(struct dysymtab_command));
+		size = left < sizeof(struct dysymtab_command) ?
+		       left : sizeof(struct dysymtab_command);
+		memcpy((char *)dyst, (char *)lc, size);
+		if(swapped)
+		    swap_dysymtab_command(dyst, host_byte_sex);
+		dyst_cmd = i;
+	    }
+	    if(l.cmdsize == 0){
+		printf("load command %u size zero (can't advance to other "
+		       "load commands)\n", i);
+		break;
+	    }
+	    lc = (struct load_command *)((char *)lc + l.cmdsize);
+	    if((char *)lc > (char *)load_commands + sizeofcmds)
+		break;
+	}
+	if((char *)load_commands + sizeofcmds != (char *)lc)
+	    printf("Inconsistent sizeofcmds\n");
+
+	if(dyst_cmd == UINT_MAX){
+	    return(FALSE);
+	}
+	return(TRUE);
+}
+
+/*
+ * get_hints_table_info() returns a pointer and the size of the two-level hints
+ * table.  This routine handles the problems related to the file being truncated
+ * and only returns valid pointers and sizes that can be used.  This routine
+ * will return pointers that are misaligned and it is up to the caller to deal
+ * with alignment issues.  It is also up to the caller to deal with byte sex of
+ * the table.
+ */
+static
+void
+get_hints_table_info(
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum byte_sex load_commands_byte_sex,
+char *object_addr,
+uint32_t object_size,
+struct twolevel_hint **hints,	/* output */
+uint32_t *nhints)
+{
+    struct twolevel_hints_command hints_cmd;
+    uint64_t bigsize;
+
+	*hints = NULL;
+	*nhints = 0;
+
+	memset(&hints_cmd, '\0', sizeof(struct twolevel_hints_command));
+	if(get_hints_cmd(load_commands, ncmds, sizeofcmds,
+		         load_commands_byte_sex, &hints_cmd) == FALSE)
+	    return;
+
+	if(hints_cmd.offset >= object_size){
+	    printf("two-level hints offset is past end of file\n");
+	}
+	else{
+	    *hints = (struct twolevel_hint *)(object_addr + hints_cmd.offset);
+	    bigsize = hints_cmd.nhints;
+	    bigsize *= sizeof(struct twolevel_hint);
+	    bigsize += hints_cmd.offset;
+	    if(bigsize > object_size){
+		printf("two-level hints table extends past end of file\n");
+		*nhints = (object_size - hints_cmd.offset) /
+			  sizeof(struct twolevel_hint);
+	    }
+	    else
+		*nhints = hints_cmd.nhints;
+	}
+}
+
+/*
+ * get_hints_cmd() gets the twolevel_hints_command from the mach header and
+ * load commands passed to it and copys it into hints_cmd.  It if doesn't find
+ * one it returns FALSE else it returns TRUE.
+ */
+static
+enum bool
+get_hints_cmd(
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum byte_sex load_commands_byte_sex,
+struct twolevel_hints_command *hints_cmd)
+{
+    enum byte_sex host_byte_sex;
+    enum bool swapped;
+    uint32_t i, left, size, cmd;
+    struct load_command *lc, l;
+
+	host_byte_sex = get_host_byte_sex();
+	swapped = host_byte_sex != load_commands_byte_sex;
+
+	cmd = UINT_MAX;
+	lc = load_commands;
+	for(i = 0 ; i < ncmds; i++){
+	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
+	    if(swapped)
+		swap_load_command(&l, host_byte_sex);
+	    if(l.cmdsize % sizeof(int32_t) != 0)
+		printf("load command %u size not a multiple of "
+		       "sizeof(int32_t)\n", i);
+	    if((char *)lc + l.cmdsize >
+	       (char *)load_commands + sizeofcmds)
+		printf("load command %u extends past end of load "
+		       "commands\n", i);
+	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
+
+	    switch(l.cmd){
+	    case LC_TWOLEVEL_HINTS:
+		if(cmd != UINT_MAX){
+		    printf("more than one LC_TWOLEVEL_HINTS command (using "
+			   "command %u)\n", cmd);
+		    break;
+		}
+		memset((char *)hints_cmd, '\0',
+		       sizeof(struct twolevel_hints_command));
+		size = left < sizeof(struct twolevel_hints_command) ?
+		       left : sizeof(struct twolevel_hints_command);
+		memcpy((char *)hints_cmd, (char *)lc, size);
+		if(swapped)
+		    swap_twolevel_hints_command(hints_cmd, host_byte_sex);
+		cmd = i;
+	    }
+	    if(l.cmdsize == 0){
+		printf("load command %u size zero (can't advance to other "
+		       "load commands)\n", i);
+		break;
+	    }
+	    lc = (struct load_command *)((char *)lc + l.cmdsize);
+	    if((char *)lc > (char *)load_commands + sizeofcmds)
+		break;
+	}
+	if((char *)load_commands + sizeofcmds != (char *)lc)
+	    printf("Inconsistent sizeofcmds\n");
+
+	if(cmd == UINT_MAX){
+	    return(FALSE);
+	}
+	return(TRUE);
+}
+
+/*
+ * get_link_opt_hints() returns a pointer and the size of the linker
+ * optimization hints table.  This routine handles the problems related to the
+ * file being truncated and only returns valid pointers and sizes that can be
+ * used.  
+ */
+static
+void
+get_link_opt_hints(
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum byte_sex load_commands_byte_sex,
+char *object_addr,
+uint32_t object_size,
+char **loh,
+uint32_t *nloh)
+{
+    struct linkedit_data_command loh_cmd;
+    uint64_t bigsize;
+
+	*loh = NULL;
+	*nloh = 0;
+
+	memset(&loh_cmd, '\0', sizeof(struct linkedit_data_command));
+	if(get_link_opt_hint_cmd(load_commands, ncmds, sizeofcmds,
+		                 load_commands_byte_sex, &loh_cmd) == FALSE)
+	    return;
+
+	if(loh_cmd.dataoff >= object_size){
+	    printf("linker optimization hints offset is past end of file\n");
+	}
+	else{
+	    *loh = object_addr + loh_cmd.dataoff;
+	    bigsize = loh_cmd.dataoff;
+	    bigsize += loh_cmd.datasize;
+	    if(bigsize > object_size){
+		printf("linker optimization hints extends past end of file\n");
+		*nloh = object_size - loh_cmd.dataoff;
+	    }
+	    else
+	    *nloh = loh_cmd.datasize;
+	}
+}
+
+/*
+ * get_link_opt_hint_cmd() gets the linker optimization hint command from the
+ * mach header and load commands passed to it and copys it into loh_cmd.  It if
+ * doesn't find one it returns FALSE else it returns TRUE.
+ */
+static
+enum bool
+get_link_opt_hint_cmd(
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum byte_sex load_commands_byte_sex,
+struct linkedit_data_command *loh_cmd)
+{
+    enum byte_sex host_byte_sex;
+    enum bool swapped;
+    uint32_t i, left, size, cmd;
+    struct load_command *lc, l;
+
+	host_byte_sex = get_host_byte_sex();
+	swapped = host_byte_sex != load_commands_byte_sex;
+
+	cmd = UINT_MAX;
+	lc = load_commands;
+	for(i = 0 ; i < ncmds; i++){
+	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
+	    if(swapped)
+		swap_load_command(&l, host_byte_sex);
+	    if(l.cmdsize % sizeof(int32_t) != 0)
+		printf("load command %u size not a multiple of "
+		       "sizeof(int32_t)\n", i);
+	    if((char *)lc + l.cmdsize >
+	       (char *)load_commands + sizeofcmds)
+		printf("load command %u extends past end of load "
+		       "commands\n", i);
+	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
+
+	    switch(l.cmd){
+	    case LC_LINKER_OPTIMIZATION_HINT:
+		if(cmd != UINT_MAX){
+		    printf("more than one LC_LINKER_OPTIMIZATION_HINT command "
+			   "(using command %u)\n", cmd);
+		    break;
+		}
+		memset((char *)loh_cmd, '\0',
+		       sizeof(struct linkedit_data_command));
+		size = left < sizeof(struct linkedit_data_command) ?
+		       left : sizeof(struct linkedit_data_command);
+		memcpy((char *)loh_cmd, (char *)lc, size);
+		if(swapped)
+		    swap_linkedit_data_command(loh_cmd, host_byte_sex);
+		cmd = i;
+	    }
+	    if(l.cmdsize == 0){
+		printf("load command %u size zero (can't advance to other "
+		       "load commands)\n", i);
+		break;
+	    }
+	    lc = (struct load_command *)((char *)lc + l.cmdsize);
+	    if((char *)lc > (char *)load_commands + sizeofcmds)
+		break;
+	}
+	if((char *)load_commands + sizeofcmds != (char *)lc)
+	    printf("Inconsistent sizeofcmds\n");
+
+	if(cmd == UINT_MAX){
+	    return(FALSE);
+	}
+	return(TRUE);
+}
+
+/*
+ * get_data_in_code_info() returns a pointer and the size of the data in code
+ * table.  This routine handles the problems related to the file being truncated
+ * and only returns valid pointers and sizes that can be used.  This routine
+ * will return pointers that are misaligned and it is up to the caller to deal
+ * with alignment issues.  It is also up to the caller to deal with byte sex of
+ * the table.
+ */
+static
+void
+get_data_in_code_info(
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum byte_sex load_commands_byte_sex,
+char *object_addr,
+uint32_t object_size,
+struct data_in_code_entry **dices,	/* output */
+uint32_t *ndices)
+{
+    struct linkedit_data_command dices_cmd;
+    uint64_t bigsize;
+
+	*dices = NULL;
+	*ndices = 0;
+
+	memset(&dices_cmd, '\0', sizeof(struct linkedit_data_command));
+	if(get_dices_cmd(load_commands, ncmds, sizeofcmds,
+		         load_commands_byte_sex, &dices_cmd) == FALSE)
+	    return;
+
+	if(dices_cmd.dataoff >= object_size){
+	    printf("data in code offset is past end of file\n");
+	}
+	else{
+	    *dices = (struct data_in_code_entry *)
+		     (object_addr + dices_cmd.dataoff);
+	    bigsize = dices_cmd.datasize;
+	    bigsize += dices_cmd.dataoff;
+	    if(bigsize > object_size){
+		printf("data in code table extends past end of file\n");
+		*ndices = (object_size - dices_cmd.dataoff) /
+			  sizeof(struct data_in_code_entry);
+	    }
+	    else
+		*ndices = dices_cmd.datasize /
+			  sizeof(struct data_in_code_entry);
+	}
+}
+
+/*
+ * get_dices_cmd() gets the linkedit_data_command for the data in code from the
+ * mach header and load commands passed to it and copys it into dices_cmd.  It
+ * if doesn't find one it returns FALSE else it returns TRUE.
+ */
+static
+enum bool
+get_dices_cmd(
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum byte_sex load_commands_byte_sex,
+struct linkedit_data_command *dices_cmd)
+{
+    enum byte_sex host_byte_sex;
+    enum bool swapped;
+    uint32_t i, left, size, cmd;
+    struct load_command *lc, l;
+
+	host_byte_sex = get_host_byte_sex();
+	swapped = host_byte_sex != load_commands_byte_sex;
+
+	cmd = UINT_MAX;
+	lc = load_commands;
+	for(i = 0 ; i < ncmds; i++){
+	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
+	    if(swapped)
+		swap_load_command(&l, host_byte_sex);
+	    if(l.cmdsize % sizeof(int32_t) != 0)
+		printf("load command %u size not a multiple of "
+		       "sizeof(int32_t)\n", i);
+	    if((char *)lc + l.cmdsize >
+	       (char *)load_commands + sizeofcmds)
+		printf("load command %u extends past end of load "
+		       "commands\n", i);
+	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
+
+	    switch(l.cmd){
+	    case LC_DATA_IN_CODE:
+		if(cmd != UINT_MAX){
+		    printf("more than one LC_DATA_IN_CODE command (using "
+			   "command %u)\n", cmd);
+		    break;
+		}
+		memset((char *)dices_cmd, '\0',
+		       sizeof(struct linkedit_data_command));
+		size = left < sizeof(struct linkedit_data_command) ?
+		       left : sizeof(struct linkedit_data_command);
+		memcpy((char *)dices_cmd, (char *)lc, size);
+		if(swapped)
+		    swap_linkedit_data_command(dices_cmd, host_byte_sex);
+		cmd = i;
+	    }
+	    if(l.cmdsize == 0){
+		printf("load command %u size zero (can't advance to other "
+		       "load commands)\n", i);
+		break;
+	    }
+	    lc = (struct load_command *)((char *)lc + l.cmdsize);
+	    if((char *)lc > (char *)load_commands + sizeofcmds)
+		break;
+	}
+	if((char *)load_commands + sizeofcmds != (char *)lc)
+	    printf("Inconsistent sizeofcmds\n");
+
+	if(cmd == UINT_MAX){
+	    return(FALSE);
+	}
+	return(TRUE);
+}
+
+/*
+ * Function for qsort for comparing symbols.
+ */
+static
+int
+sym_compare(
+struct symbol *sym1,
+struct symbol *sym2)
+{
+	if(sym1->n_value == sym2->n_value)
+	    return(0);
+	if(sym1->n_value < sym2->n_value)
+	    return(-1);
+	else
+	    return(1);
+}
+
+/*
+ * Function for qsort for comparing relocation entries.
+ */
+static
+int
+rel_compare(
+struct relocation_info *rel1,
+struct relocation_info *rel2)
+{
+    struct scattered_relocation_info *srel;
+    uint32_t r_address1, r_address2;
+
+	if((rel1->r_address & R_SCATTERED) != 0){
+	    srel = (struct scattered_relocation_info *)rel1;
+	    r_address1 = srel->r_address;
+	}
+	else
+	    r_address1 = rel1->r_address;
+	if((rel2->r_address & R_SCATTERED) != 0){
+	    srel = (struct scattered_relocation_info *)rel2;
+	    r_address2 = srel->r_address;
+	}
+	else
+	    r_address2 = rel2->r_address;
+
+	if(r_address1 == r_address2)
+	    return(0);
+	if(r_address1 < r_address2)
+	    return(-1);
+	else
+	    return(1);
+}
+
+enum bool
+get_sect_info(
+char *segname,				/* input */
+char *sectname,
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+uint32_t filetype,
+enum byte_sex load_commands_byte_sex,
+char *object_addr,
+uint32_t object_size,
+char **sect_pointer,			/* output */
+uint64_t *sect_size,
+uint64_t *sect_addr,
+struct relocation_info **sect_relocs,
+uint32_t *sect_nrelocs,
+uint32_t *sect_flags,
+uint64_t *seg_addr)
+{
+    enum byte_sex host_byte_sex;
+    enum bool found, swapped;
+    uint32_t i, j, left, size;
+    struct load_command *lc, l;
+    uint32_t cmd;
+    struct segment_command sg;
+    struct segment_command_64 sg64;
+    struct section s;
+    struct section_64 s64;
+    char *p;
+
+	*sect_pointer = NULL;
+	*sect_size = 0;
+	*sect_addr = 0;
+	*sect_relocs = NULL;
+	*sect_nrelocs = 0;
+	*sect_flags = 0;
+
+	found = FALSE;
+	cmd = 0;
+	host_byte_sex = get_host_byte_sex();
+	swapped = host_byte_sex != load_commands_byte_sex;
+
+	lc = load_commands;
+	for(i = 0 ; found == FALSE && i < ncmds; i++){
+	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
+	    if(swapped)
+		swap_load_command(&l, host_byte_sex);
+	    if(l.cmdsize % sizeof(int32_t) != 0)
+		printf("load command %u size not a multiple of "
+		       "sizeof(int32_t)\n", i);
+	    if((char *)lc + l.cmdsize >
+	       (char *)load_commands + sizeofcmds)
+		printf("load command %u extends past end of load "
+		       "commands\n", i);
+	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
+
+	    switch(l.cmd){
+	    case LC_SEGMENT:
+		memset((char *)&sg, '\0', sizeof(struct segment_command));
+		size = left < sizeof(struct segment_command) ?
+		       left : sizeof(struct segment_command);
+		memcpy((char *)&sg, (char *)lc, size);
+		if(swapped)
+		    swap_segment_command(&sg, host_byte_sex);
+
+		if((filetype == MH_OBJECT && sg.segname[0] == '\0') ||
+		   strncmp(sg.segname, segname, sizeof(sg.segname)) == 0){
+                    *seg_addr = sg.vmaddr;
+		    p = (char *)lc + sizeof(struct segment_command);
+		    for(j = 0 ; found == FALSE && j < sg.nsects ; j++){
+			if(p + sizeof(struct section) >
+			   (char *)load_commands + sizeofcmds){
+			    printf("section structure command extends past "
+				   "end of load commands\n");
+			}
+			left = sizeofcmds - (p - (char *)load_commands);
+			memset((char *)&s, '\0', sizeof(struct section));
+			size = left < sizeof(struct section) ?
+			       left : sizeof(struct section);
+			memcpy((char *)&s, p, size);
+			if(swapped)
+			    swap_section(&s, 1, host_byte_sex);
+
+			if(strncmp(s.sectname, sectname,
+				   sizeof(s.sectname)) == 0 &&
+			   strncmp(s.segname, segname,
+				   sizeof(s.segname)) == 0){
+			    found = TRUE;
+			    cmd = LC_SEGMENT;
+			    break;
+			}
+
+			if(p + sizeof(struct section) >
+			   (char *)load_commands + sizeofcmds)
+			    return(FALSE);
+			p += size;
+		    }
+		}
+		break;
+	    case LC_SEGMENT_64:
+		memset((char *)&sg64, '\0', sizeof(struct segment_command_64));
+		size = left < sizeof(struct segment_command_64) ?
+		       left : sizeof(struct segment_command_64);
+		memcpy((char *)&sg64, (char *)lc, size);
+		if(swapped)
+		    swap_segment_command_64(&sg64, host_byte_sex);
+
+		if((filetype == MH_OBJECT && sg64.segname[0] == '\0') ||
+		   strncmp(sg64.segname, segname, sizeof(sg64.segname)) == 0){
+                    *seg_addr = sg.vmaddr;
+		    p = (char *)lc + sizeof(struct segment_command_64);
+		    for(j = 0 ; found == FALSE && j < sg64.nsects ; j++){
+			if(p + sizeof(struct section_64) >
+			   (char *)load_commands + sizeofcmds){
+			    printf("section structure command extends past "
+				   "end of load commands\n");
+			}
+			left = sizeofcmds - (p - (char *)load_commands);
+			memset((char *)&s64, '\0', sizeof(struct section_64));
+			size = left < sizeof(struct section_64) ?
+			       left : sizeof(struct section_64);
+			memcpy((char *)&s64, p, size);
+			if(swapped)
+			    swap_section_64(&s64, 1, host_byte_sex);
+
+			if(strncmp(s64.sectname, sectname,
+				   sizeof(s64.sectname)) == 0 &&
+			   strncmp(s64.segname, segname,
+				   sizeof(s64.segname)) == 0){
+			    found = TRUE;
+			    cmd = LC_SEGMENT_64;
+			    break;
+			}
+
+			if(p + sizeof(struct section_64) >
+			   (char *)load_commands + sizeofcmds)
+			    return(FALSE);
+			p += size;
+		    }
+		}
+		break;
+	    }
+	    if(l.cmdsize == 0){
+		printf("load command %u size zero (can't advance to other "
+		       "load commands)\n", i);
+		break;
+	    }
+	    lc = (struct load_command *)((char *)lc + l.cmdsize);
+	    if((char *)lc > (char *)load_commands + sizeofcmds)
+		break;
+	}
+	if(found == FALSE)
+	    return(FALSE);
+
+	if(cmd == LC_SEGMENT){
+	    if((s.flags & SECTION_TYPE) == S_ZEROFILL){
+		*sect_pointer = NULL;
+		*sect_size = s.size;
+	    }
+	    else{
+		if(s.offset > object_size){
+		    printf("section offset for section (%.16s,%.16s) is past "
+			   "end of file\n", s.segname, s.sectname);
+		}
+		else{
+		    *sect_pointer = object_addr + s.offset;
+		    if(s.size > object_size ||
+		       s.offset + s.size > object_size){
+			printf("section (%.16s,%.16s) extends past end of "
+			       "file\n", s.segname, s.sectname);
+			*sect_size = object_size - s.offset;
+		    }
+		    else
+			*sect_size = s.size;
+		}
+	    }
+	    if(s.reloff >= object_size){
+		printf("relocation entries offset for (%.16s,%.16s): is past "
+		       "end of file\n", s.segname, s.sectname);
+	    }
+	    else{
+		*sect_relocs = (struct relocation_info *)(object_addr +
+							  s.reloff);
+		if(s.reloff + s.nreloc * sizeof(struct relocation_info) >
+								object_size){
+		    printf("relocation entries for section (%.16s,%.16s) "
+			   "extends past end of file\n", s.segname, s.sectname);
+		    *sect_nrelocs = (object_size - s.reloff) /
+				    sizeof(struct relocation_info);
+		}
+		else
+		    *sect_nrelocs = s.nreloc;
+	    }
+	    *sect_addr = s.addr;
+	    *sect_flags = s.flags;
+	}
+	else{
+	    if((s64.flags & SECTION_TYPE) == S_ZEROFILL){
+		*sect_pointer = NULL;
+		*sect_size = s64.size;
+	    }
+	    else{
+		if(s64.offset > object_size){
+		    printf("section offset for section (%.16s,%.16s) is past "
+			   "end of file\n", s64.segname, s64.sectname);
+		}
+		else{
+		    *sect_pointer = object_addr + s64.offset;
+		    if(s64.size > object_size ||
+                       s64.offset + s64.size > object_size){
+			printf("section (%.16s,%.16s) extends past end of "
+			       "file\n", s64.segname, s64.sectname);
+		    }
+		    else
+			*sect_size = s64.size;
+		}
+	    }
+	    if(s64.reloff >= object_size){
+		printf("relocation entries offset for (%.16s,%.16s): is past "
+		       "end of file\n", s64.segname, s64.sectname);
+	    }
+	    else{
+		*sect_relocs = (struct relocation_info *)(object_addr +
+							  s64.reloff);
+		if(s64.reloff + s64.nreloc * sizeof(struct relocation_info) >
+								object_size){
+		    printf("relocation entries for section (%.16s,%.16s) "
+			   "extends past end of file\n", s64.segname,
+			   s64.sectname);
+		    *sect_nrelocs = (object_size - s64.reloff) /
+				    sizeof(struct relocation_info);
+		}
+		else
+		    *sect_nrelocs = s64.nreloc;
+	    }
+	    *sect_addr = s64.addr;
+	    *sect_flags = s64.flags;
+	}
+	return(TRUE);
+}
+
+static
+void
+get_linked_reloc_info(
+struct load_command *load_commands, 	/* input */
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum byte_sex load_commands_byte_sex,
+char *object_addr,
+uint32_t object_size,
+struct relocation_info **ext_relocs,	/* output */
+uint32_t *next_relocs,
+struct relocation_info **loc_relocs,
+uint32_t *nloc_relocs)
+{
+    struct dysymtab_command dyst;
+    uint64_t bigsize;
+
+	*ext_relocs = NULL;
+	*next_relocs = 0;
+	*loc_relocs = NULL;
+	*nloc_relocs = 0;
+
+	if(get_dyst(load_commands, ncmds, sizeofcmds, load_commands_byte_sex,
+		    &dyst) == FALSE)
+	    return;
+
+	if(dyst.extreloff >= object_size){
+	    printf("external relocation entries offset is past end of file\n");
+	}
+	else{
+	    *ext_relocs = (struct relocation_info *)(object_addr +
+			   dyst.extreloff);
+	    bigsize = dyst.nextrel;
+	    bigsize *= sizeof(struct relocation_info);
+	    bigsize += dyst.extreloff;
+	    if(bigsize > object_size){
+		printf("external relocation entries extend past end of file\n");
+		*next_relocs = (object_size - dyst.extreloff) /
+				     sizeof(struct relocation_info);
+	    }
+	    else
+		*next_relocs = dyst.nextrel;
+	}
+	if(dyst.locreloff >= object_size){
+	    printf("local relocation entries offset is past end of file\n");
+	}
+	else{
+	    *loc_relocs = (struct relocation_info *)(object_addr +
+			   dyst.locreloff);
+	    bigsize = dyst.nlocrel;
+	    bigsize *= sizeof(struct relocation_info);
+	    bigsize += dyst.locreloff;
+	    if(bigsize > object_size){
+		printf("local relocation entries extend past end of file\n");
+		*nloc_relocs = (object_size - dyst.locreloff) /
+				     sizeof(struct relocation_info);
+	    }
+	    else
+		*nloc_relocs = dyst.nlocrel;
+	}
+}
+
+/*
+ * setup_dyld_bind_info() looks for a LC_DYLD_INFO load command and if it has
+ * bind info unpacks it and returns it in dbi and ndbi values for the internal
+ * expanded structs.
+ */
+static
+void
+setup_dyld_bind_info(
+struct load_command *load_commands, 	/* input */
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum byte_sex load_commands_byte_sex,
+char *object_addr,
+uint32_t object_size,
+struct dyld_bind_info **dbi, /* output */
+uint64_t *ndbi)
+{
+    enum byte_sex host_byte_sex;
+    enum bool swapped, found_bind;
+    uint32_t pass, i, j, left, size, nsegs, nsegs64, ndylibs;
+    uint64_t big_size;
+    struct load_command *lc, l;
+    struct dyld_info_command dyld_info;
+    struct dylib_command dl;
+    struct segment_command sg, **segs;
+    struct segment_command_64 sg64, **segs64;
+    struct section s;
+    struct section_64 s64;
+    char *short_name, *has_suffix;
+    enum bool is_framework;
+    char *p, *a;
+    uint8_t *start, *end;
+    const char **dylibs;
+
+	/* If already setup just return. */
+	if(*dbi != NULL)
+	    return;
+
+	found_bind = FALSE;
+	*dbi = NULL;
+	*ndbi = 0;
+
+	host_byte_sex = get_host_byte_sex();
+	swapped = host_byte_sex != load_commands_byte_sex;
+
+	nsegs = 0;
+	nsegs64 = 0;
+	ndylibs = 0;
+
+	dylibs = NULL;
+	segs = NULL;
+	segs64 = NULL;
+	/*
+	 * Make two passes over the load commands. On the first pass count the
+	 * number of load commands for dylibs and segments and look for an
+	 * LC_DYLD_INFO load commands  If we find the bind info allocate space
+	 * arrays of pointers to dylibs and segments and fill them in on the
+	 * second pass.
+	 */
+	for(pass = 1; pass <= 2; pass++){
+	    ndylibs = 0;
+	    nsegs = 0;
+	    nsegs64 = 0;
+	    lc = load_commands;
+	    for(i = 0 ; i < ncmds; i++){
+		memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
+		if(swapped)
+		    swap_load_command(&l, host_byte_sex);
+		if(l.cmdsize % sizeof(int32_t) != 0)
+		    printf("load command %u size not a multiple of "
+			   "sizeof(int32_t)\n", i);
+		if((char *)lc + l.cmdsize >
+		   (char *)load_commands + sizeofcmds)
+		    printf("load command %u extends past end of load "
+			   "commands\n", i);
+		left = sizeofcmds - ((char *)lc - (char *)load_commands);
+
+		switch(l.cmd){
+
+		case LC_DYLD_INFO:
+		case LC_DYLD_INFO_ONLY:
+		    if(pass == 1){
+			memset((char *)&dyld_info, '\0',
+			       sizeof(struct dyld_info_command));
+			size = left < sizeof(struct dyld_info_command) ?
+			       left : sizeof(struct dyld_info_command);
+			memcpy((char *)&dyld_info, (char *)lc, size);
+			if(swapped)
+			    swap_dyld_info_command(&dyld_info, host_byte_sex);
+			if(dyld_info.bind_off > object_size){
+			    printf("bind_off in LC_DYLD_INFO load command %u "
+				   "past end of file\n", i);
+			    return;
+			}
+			big_size = dyld_info.bind_off;
+			big_size += dyld_info.bind_size;
+        		if(big_size > object_size){
+			    printf("bind_off plus bind_size in LC_DYLD_INFO "
+				   "load command %u past end of file\n", i);
+			    return;
+			}
+			if(found_bind == TRUE){
+			    printf("more than one LC_DYLD_INFO load command\n");
+			    return;
+			}
+			found_bind = TRUE;
+		    }
+		    break;
+
+		case LC_LOAD_DYLIB:
+		case LC_LOAD_WEAK_DYLIB:
+		case LC_REEXPORT_DYLIB:
+		case LC_LOAD_UPWARD_DYLIB:
+		case LC_LAZY_LOAD_DYLIB:
+		    if(pass == 1){
+			ndylibs++;
+		    }
+		    else{
+			memset((char *)&dl, '\0', sizeof(struct dylib_command));
+			size = left < sizeof(struct dylib_command) ?
+			       left : sizeof(struct dylib_command);
+			memcpy((char *)&dl, (char *)lc, size);
+			if(swapped)
+			    swap_dylib_command(&dl, host_byte_sex);
+			if(dl.dylib.name.offset < dl.cmdsize)
+			    p = (char *)lc + dl.dylib.name.offset;
+			else
+			    p = "(bad offset for dylib.name.offset)";
+		        short_name = guess_short_name(p,
+						  &is_framework, &has_suffix);
+			if(short_name != NULL)
+			    dylibs[ndylibs++] = short_name;
+			else
+			    dylibs[ndylibs++] = p;
+		    }
+		    break;
+
+		case LC_SEGMENT:
+		    memset((char *)&sg, '\0', sizeof(struct segment_command));
+		    size = left < sizeof(struct segment_command) ?
+			   left : sizeof(struct segment_command);
+		    memcpy((char *)&sg, (char *)lc, size);
+		    if(swapped)
+			swap_segment_command(&sg, host_byte_sex);
+		    if(pass == 2){
+			a = allocate(sizeof(struct segment_command) +
+				     sg.nsects * sizeof(struct section));
+			memcpy(a, (char *)&sg,
+			       sizeof(struct segment_command));
+			segs[nsegs++] =
+			    (struct segment_command *)a;
+			a += sizeof(struct segment_command);
+		    }
+
+		    p = (char *)lc + sizeof(struct segment_command);
+		    for(j = 0 ; j < sg.nsects ; j++){
+			if(p + sizeof(struct section) >
+			   (char *)load_commands + sizeofcmds){
+			    printf("section structure command extends past "
+				   "end of load commands\n");
+			    return;
+			}
+			left = sizeofcmds - (p - (char *)load_commands);
+			memset((char *)&s, '\0', sizeof(struct section));
+			size = left < sizeof(struct section) ?
+			       left : sizeof(struct section);
+			memcpy((char *)&s, p, size);
+			if(swapped)
+			    swap_section(&s, 1, host_byte_sex);
+			if(pass == 2){
+			    memcpy(a, (char *)&s, sizeof(struct section));
+			    a += sizeof(struct section);
+			}
+			if(p + sizeof(struct section) >
+			   (char *)load_commands + sizeofcmds)
+			    return;
+			p += size;
+		    }
+		    if(pass == 1)
+			nsegs++;
+		    break;
+		case LC_SEGMENT_64:
+		    memset((char *)&sg64, '\0',
+			   sizeof(struct segment_command_64));
+		    size = left < sizeof(struct segment_command_64) ?
+			   left : sizeof(struct segment_command_64);
+		    memcpy((char *)&sg64, (char *)lc, size);
+		    if(swapped)
+			swap_segment_command_64(&sg64, host_byte_sex);
+		    if(pass == 2){
+			a = allocate(sizeof(struct segment_command_64) +
+				     sg64.nsects * sizeof(struct section_64));
+			memcpy(a, (char *)&sg64,
+			       sizeof(struct segment_command_64));
+			segs64[nsegs64++] =
+			    (struct segment_command_64 *)a;
+			a += sizeof(struct segment_command_64);
+		    }
+
+		    p = (char *)lc + sizeof(struct segment_command_64);
+		    for(j = 0 ; j < sg64.nsects ; j++){
+			if(p + sizeof(struct section_64) >
+			   (char *)load_commands + sizeofcmds){
+			    printf("section structure command extends past "
+				   "end of load commands\n");
+			}
+			left = sizeofcmds - (p - (char *)load_commands);
+			memset((char *)&s64, '\0', sizeof(struct section_64));
+			size = left < sizeof(struct section_64) ?
+			       left : sizeof(struct section_64);
+			memcpy((char *)&s64, p, size);
+			if(swapped)
+			    swap_section_64(&s64, 1, host_byte_sex);
+			if(pass == 2){
+			    memcpy(a, (char *)&s64, sizeof(struct section_64));
+			    a += sizeof(struct section_64);
+			}
+			if(p + sizeof(struct section_64) >
+			   (char *)load_commands + sizeofcmds)
+			    return;
+			p += size;
+		    }
+		    if(pass == 1)
+			nsegs64++;
+		    break;
+		}
+		if(l.cmdsize == 0){
+		    printf("load command %u size zero (can't advance to other "
+			   "load commands)\n", i);
+		    break;
+		}
+		lc = (struct load_command *)((char *)lc + l.cmdsize);
+		if((char *)lc > (char *)load_commands + sizeofcmds)
+		    break;
+	    }
+	    if(found_bind == FALSE)
+		return;
+	    if(pass == 1){
+		dylibs = (const char **)allocate(ndylibs * sizeof(char *));
+		segs = (struct segment_command **)allocate(
+				nsegs * sizeof(struct segment_command *));
+		segs64 = (struct segment_command_64 **)allocate(
+				nsegs64 * sizeof(struct segment_command_64 *));
+	    }
+	}
+
+	start = (uint8_t *)(object_addr + dyld_info.bind_off);
+	end = start + dyld_info.bind_size;
+	get_dyld_bind_info(start, end, dylibs, ndylibs, segs, nsegs,
+			   segs64, nsegs64, dbi, ndbi);
+
+	if(dylibs != NULL)
+	    free(dylibs);
+	if(segs != NULL){
+	    for(i = 0; i < nsegs; i++)
+		free(segs[i]);
+	    free(segs);
+	}
+	if(segs64 != NULL){
+	    for(i = 0; i < nsegs64; i++)
+		free(segs64[i]);
+	    free(segs64);
+	}
+}
+
+static
+void
+print_text_by_symbols(
+cpu_type_t cputype,
+enum byte_sex object_byte_sex,
+char *sect,
+uint32_t size,
+uint64_t addr,
+uint32_t sect_flags,
+struct symbol *sorted_symbols,
+uint32_t nsorted_symbols,
+struct nlist *symbols,
+struct nlist_64 *symbols64,
+uint32_t nsymbols,
+char *strings,
+uint32_t strings_size,
+struct relocation_info *relocs,
+uint32_t nrelocs,
+struct relocation_info *ext_relocs,
+uint32_t next_relocs,
+struct relocation_info *loc_relocs,
+uint32_t nloc_relocs,
+struct dyld_bind_info *dbi,
+uint64_t ndbi,
+uint32_t *indirect_symbols,
+uint32_t nindirect_symbols,
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum bool disassemble,
+enum bool verbose,
+cpu_subtype_t cpusubtype,
+char *object_addr,
+uint32_t object_size,
+struct data_in_code_entry *dices,
+uint32_t ndices,
+uint64_t seg_addr)
+{
+    uint32_t i, symbol_size;
+    uint64_t symbol_addr, symbol_offset;
+
+	for(i = 0; i < nsorted_symbols; i++){
+	    symbol_addr = sorted_symbols[i].n_value;
+	    if(symbol_addr < addr || symbol_addr >= addr + size)
+		continue;
+	    symbol_offset = symbol_addr - addr;
+	    if(i+1 < nsorted_symbols &&
+               sorted_symbols[i+1].n_value < addr + size)
+		symbol_size = sorted_symbols[i+1].n_value - symbol_addr;
+	    else
+		symbol_size = (addr + size) - symbol_addr;
+	    print_text(cputype, object_byte_sex, sect + symbol_offset,
+		       symbol_size, symbol_addr, sect_flags, sorted_symbols,
+		       nsorted_symbols, symbols, symbols64, nsymbols, strings,
+		       strings_size, relocs, nrelocs, ext_relocs, next_relocs,
+		       loc_relocs, nloc_relocs, dbi, ndbi, indirect_symbols,
+		       nindirect_symbols, load_commands, ncmds, sizeofcmds,
+		       disassemble, verbose, cpusubtype, object_addr,
+                       object_size, dices, ndices, seg_addr);
+	}
+}
+
+static
+void
+print_text(
+cpu_type_t cputype,
+enum byte_sex object_byte_sex,
+char *sect,
+uint32_t size,
+uint64_t addr,
+uint32_t sect_flags,
+struct symbol *sorted_symbols,
+uint32_t nsorted_symbols,
+struct nlist *symbols,
+struct nlist_64 *symbols64,
+uint32_t nsymbols,
+char *strings,
+uint32_t strings_size,
+struct relocation_info *relocs,
+uint32_t nrelocs,
+struct relocation_info *ext_relocs,
+uint32_t next_relocs,
+struct relocation_info *loc_relocs,
+uint32_t nloc_relocs,
+struct dyld_bind_info *dbi,
+uint64_t ndbi,
+uint32_t *indirect_symbols,
+uint32_t nindirect_symbols,
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+enum bool disassemble,
+enum bool verbose,
+cpu_subtype_t cpusubtype,
+char *object_addr,
+uint32_t object_size,
+struct data_in_code_entry *dices,
+uint32_t ndices,
+uint64_t seg_addr)
+{
+    enum byte_sex host_byte_sex;
+    enum bool swapped;
+    uint32_t i, j, offset, long_word, label_offset;
+    uint64_t cur_addr;
+    unsigned short short_word;
+    unsigned char byte_word;
+    LLVMDisasmContextRef arm64_dc;
+    LLVMDisasmContextRef arm_dc, thumb_dc, i386_dc, x86_64_dc;
+    uint32_t n, ninsts;
+    struct inst *insts;
+    char *sect_start;
+
+	host_byte_sex = get_host_byte_sex();
+	swapped = host_byte_sex != object_byte_sex;
+	arm_dc = NULL;
+	thumb_dc = NULL;
+	i386_dc = NULL;
+	x86_64_dc = NULL;
+	arm64_dc = NULL;
+	n = 0;
+	ninsts = 0;
+	insts = NULL;
+
+	/*
+	 * If the section has a type of S_ZEROFILL then its section contents
+         * pointer is NULL, so in this case just do nothing.
+	 */
+	if(sect == NULL)
+	    return;
+
+	if(disassemble == TRUE){
+	    if(pflag){
+		for(i = 0; i < nsorted_symbols; i++){
+		    if(strcmp(sorted_symbols[i].name, pflag) == 0)
+			break;
+		}
+		if(i == nsorted_symbols){
+		    printf("Can't find -p symbol: %s\n", pflag);
+		    return;
+		}
+		if(sorted_symbols[i].n_value < addr ||
+		   sorted_symbols[i].n_value >= addr + size){
+		    printf("-p symbol: %s not in text section\n", pflag);
+		    return;
+		}
+		offset = sorted_symbols[i].n_value - addr;
+		sect += offset;
+		cur_addr = sorted_symbols[i].n_value;
+		sect_start = sect;
+	    }
+	    else{
+		offset = 0;
+		cur_addr = addr;
+		sect_start = sect;
+	    }
+	    if(cputype == CPU_TYPE_ARM &&
+	       (cpusubtype == CPU_SUBTYPE_ARM_V7 ||
+	        cpusubtype == CPU_SUBTYPE_ARM_V7F ||
+	        cpusubtype == CPU_SUBTYPE_ARM_V7S ||
+	        cpusubtype == CPU_SUBTYPE_ARM_V7K)){
+		if(sect_flags & S_SYMBOL_STUBS)
+		    in_thumb = FALSE;
+		else
+		    in_thumb = TRUE;
+	    }
+	    else
+		in_thumb = FALSE;
+	    if((qflag || gflag) && cputype == CPU_TYPE_ARM){
+		arm_dc = create_arm_llvm_disassembler(cpusubtype);
+		if(arm_dc == NULL){
+		    printf("can't create arm llvm disassembler\n");
+		    return;
+		}
+		thumb_dc = create_thumb_llvm_disassembler(cpusubtype);
+		if(thumb_dc == NULL){
+		    printf("can't create thumb llvm disassembler\n");
+		    return;
+		}
+		llvm_disasm_set_options(arm_dc,
+		    LLVMDisassembler_Option_PrintImmHex);
+		llvm_disasm_set_options(thumb_dc,
+		    LLVMDisassembler_Option_PrintImmHex);
+		if(eflag){
+		    llvm_disasm_set_options(arm_dc,
+			LLVMDisassembler_Option_UseMarkup);
+		    llvm_disasm_set_options(thumb_dc,
+			LLVMDisassembler_Option_UseMarkup);
+		}
+	    }
+	    if((qflag || gflag) && cputype == CPU_TYPE_I386){
+		i386_dc = create_i386_llvm_disassembler();
+		if(i386_dc == NULL){
+		    printf("can't create i386 llvm disassembler\n");
+		    return;
+		}
+		llvm_disasm_set_options(i386_dc,
+		    LLVMDisassembler_Option_PrintImmHex);
+		llvm_disasm_set_options(i386_dc,
+		    LLVMDisassembler_Option_SetInstrComments);
+		if(eflag)
+		    llvm_disasm_set_options(i386_dc,
+			LLVMDisassembler_Option_UseMarkup);
+	    }
+	    if((qflag || gflag) && cputype == CPU_TYPE_X86_64){
+		x86_64_dc = create_x86_64_llvm_disassembler();
+		if(x86_64_dc == NULL){
+		    printf("can't create x86_64 llvm disassembler\n");
+		    return;
+		}
+		llvm_disasm_set_options(x86_64_dc,
+		    LLVMDisassembler_Option_PrintImmHex);
+		llvm_disasm_set_options(x86_64_dc,
+		    LLVMDisassembler_Option_SetInstrComments);
+		if(eflag)
+		    llvm_disasm_set_options(x86_64_dc,
+			LLVMDisassembler_Option_UseMarkup);
+	    }
+	    if(cputype == CPU_TYPE_ARM64){
+		arm64_dc = create_arm64_llvm_disassembler();
+		if(arm64_dc == NULL){
+		    printf("can't create arm64 llvm disassembler\n");
+		    return;
+		}
+		llvm_disasm_set_options(arm64_dc,
+		    LLVMDisassembler_Option_PrintImmHex);
+	    }
+	    if(gflag){
+		ninsts = 100;
+		insts = allocate(sizeof(struct inst) * ninsts);
+	    }
+	    label_offset = 0;
+	    for(i = offset ; i < size ; ){
+		if(gflag &&
+		   (cputype == CPU_TYPE_X86_64 ||
+		    cputype == CPU_TYPE_I386 ||
+		    cputype == CPU_TYPE_ARM)){
+		    if(n > ninsts){
+			ninsts += ninsts;
+			insts = reallocate(insts, sizeof(struct inst) * ninsts);
+		    }
+		    memset(&(insts[n]), '\0', sizeof(struct inst));
+		    insts[n].address = cur_addr;
+		    insts[n].label = get_label(cur_addr, sorted_symbols,
+					       nsorted_symbols);;
+		}
+		else{
+		    if(print_label(cur_addr, TRUE, sorted_symbols,
+				   nsorted_symbols) == TRUE)
+			label_offset = i;
+		    if(function_offsets)
+			printf("%+6d ", (int)(i - label_offset));
+		    if(Xflag == FALSE){
+			if(cputype & CPU_ARCH_ABI64)
+			    printf("%016llx", cur_addr);
+			else
+			    printf("%08x", (uint32_t)cur_addr);
+			if((qflag == FALSE ||
+			    (cputype == CPU_TYPE_POWERPC)) &&
+			    cputype != CPU_TYPE_ARM64)
+			    printf("\t");
+		    }
+		}
+		if(cputype == CPU_TYPE_POWERPC64)
+		    j = ppc_disassemble(sect, size - i, cur_addr, addr,
+				object_byte_sex, relocs, nrelocs, symbols,
+				symbols64, nsymbols, sorted_symbols,
+				nsorted_symbols, strings, strings_size,
+				indirect_symbols, nindirect_symbols,
+				load_commands, ncmds, sizeofcmds, verbose);
+		else if(cputype == CPU_TYPE_X86_64)
+		    j = i386_disassemble(sect, size - i, cur_addr, addr,
+				object_byte_sex, relocs, nrelocs, ext_relocs,
+				next_relocs, loc_relocs, nloc_relocs, dbi, ndbi,
+				NULL, symbols64, nsymbols, sorted_symbols,
+				nsorted_symbols, strings, strings_size,
+				indirect_symbols, nindirect_symbols, cputype,
+				load_commands, ncmds, sizeofcmds, verbose,
+				llvm_mc, i386_dc, x86_64_dc , object_addr,
+				object_size, &(insts[n]), NULL, 0);
+	 	else if(cputype == CPU_TYPE_MC680x0)
+		    j = m68k_disassemble(sect, size - i, cur_addr, addr,
+				object_byte_sex, relocs, nrelocs, symbols,
+				nsymbols, sorted_symbols, nsorted_symbols,
+				strings, strings_size, indirect_symbols,
+				nindirect_symbols, load_commands, ncmds,
+				sizeofcmds, verbose);
+		else if(cputype == CPU_TYPE_I860)
+		    j = i860_disassemble(sect, size - i, cur_addr, addr,
+				object_byte_sex, relocs, nrelocs, symbols,
+				nsymbols, sorted_symbols, nsorted_symbols,
+				strings, strings_size, verbose);
+		else if(cputype == CPU_TYPE_I386)
+		    j = i386_disassemble(sect, size - i, cur_addr, addr,
+				object_byte_sex, relocs, nrelocs, ext_relocs,
+				next_relocs, loc_relocs, nloc_relocs, dbi, ndbi,
+				symbols, NULL, nsymbols, sorted_symbols,
+				nsorted_symbols, strings, strings_size,
+				indirect_symbols, nindirect_symbols, cputype,
+				load_commands, ncmds, sizeofcmds, verbose,
+				llvm_mc, i386_dc, x86_64_dc, object_addr,
+				object_size, &(insts[n]), NULL, 0);
+		else if(cputype == CPU_TYPE_MC88000)
+		    j = m88k_disassemble(sect, size - i, cur_addr, addr,
+				object_byte_sex, relocs, nrelocs, symbols,
+				nsymbols, sorted_symbols, nsorted_symbols,
+				strings, strings_size, verbose);
+		else if(cputype == CPU_TYPE_POWERPC ||
+			cputype == CPU_TYPE_VEO)
+		    j = ppc_disassemble(sect, size - i, cur_addr, addr,
+				object_byte_sex, relocs, nrelocs, symbols,
+				symbols64, nsymbols, sorted_symbols,
+				nsorted_symbols, strings, strings_size,
+				indirect_symbols, nindirect_symbols,
+				load_commands, ncmds, sizeofcmds, verbose);
+		else if(cputype == CPU_TYPE_HPPA)
+		    j = hppa_disassemble(sect, size - i, cur_addr, addr,
+				object_byte_sex, relocs, nrelocs, symbols,
+				nsymbols, sorted_symbols, nsorted_symbols,
+				strings, strings_size, verbose);
+		else if(cputype == CPU_TYPE_SPARC)
+		    j = sparc_disassemble(sect, size - i, cur_addr, addr,
+				object_byte_sex, relocs, nrelocs, symbols,
+				nsymbols, sorted_symbols, nsorted_symbols,
+				strings, strings_size, indirect_symbols,
+				nindirect_symbols, load_commands, ncmds,
+				sizeofcmds, verbose);
+		else if(cputype == CPU_TYPE_ARM)
+		    j = arm_disassemble(sect, size - i, cur_addr, addr,
+				object_byte_sex, relocs, nrelocs, symbols,
+				nsymbols, sorted_symbols, nsorted_symbols,
+				strings, strings_size, indirect_symbols,
+				nindirect_symbols, load_commands, ncmds,
+				sizeofcmds, cpusubtype, verbose, arm_dc,
+				thumb_dc, object_addr, object_size, dices,
+				ndices, seg_addr, &(insts[n]), NULL, 0);
+		else if(cputype == CPU_TYPE_ARM64)
+		    j = arm64_disassemble(sect, size - i, cur_addr, addr,
+				object_byte_sex, relocs, nrelocs, ext_relocs,
+				next_relocs, loc_relocs, nloc_relocs, dbi, ndbi,
+				symbols64, nsymbols, sorted_symbols,
+				nsorted_symbols, strings, strings_size,
+				indirect_symbols, nindirect_symbols,
+				load_commands, ncmds, sizeofcmds, object_addr,
+				object_size, verbose, arm64_dc);
+		
+		else{
+		    printf("Can't disassemble unknown cputype %d\n", cputype);
+		    return;
+		}
+		sect += j;
+		cur_addr += j;
+		i += j;
+		if(gflag)
+		    n++;
+	    }
+	    if(gflag &&
+	       (cputype == CPU_TYPE_X86_64 ||
+		cputype == CPU_TYPE_I386 ||
+		cputype == CPU_TYPE_ARM)){
+		char dst[4096];
+		dst[4095] = '\0';
+
+		/* Look for inits that need tmp labels. */
+		for(i = 0 ; i < n ; i++){
+		    if(insts[i].has_raw_target_address){
+			for(j = 0; j < n; j++){
+			    if(insts[i].raw_target_address == insts[j].address)
+				insts[j].needs_tmp_label = TRUE;
+			}
+		    }
+		}
+
+		/* Create the needed tmp labels. */
+		j = 1;
+		for(i = 0 ; i < n ; i++){
+		    if(insts[i].needs_tmp_label == TRUE){
+			insts[i].tmp_label = allocate(20);
+			sprintf(insts[i].tmp_label, "L%d", j++);
+		    }
+		}
+
+		/* Now finally print the inits. */
+		for(i = 0 ; i < n ; i++){
+		    if(insts[i].label != NULL)
+			printf("%s:\n", insts[i].label);
+		    else if(insts[i].tmp_label != NULL)
+			printf("%s:", insts[i].tmp_label);
+		    insts[i].print = TRUE;
+		    cur_addr = insts[i].address;
+		    offset = cur_addr - addr;
+		    sect = sect_start + offset;
+		    if(cputype == CPU_TYPE_X86_64 || cputype == CPU_TYPE_I386)
+			j = i386_disassemble(sect, size - offset, cur_addr,
+				addr, object_byte_sex, relocs, nrelocs,
+				ext_relocs, next_relocs, loc_relocs,
+				nloc_relocs, dbi, ndbi, symbols, NULL,
+				nsymbols, sorted_symbols, nsorted_symbols,
+				strings, strings_size, indirect_symbols,
+				nindirect_symbols, cputype, load_commands, 
+				ncmds, sizeofcmds, verbose, llvm_mc, i386_dc,
+				x86_64_dc, object_addr, object_size,
+				&(insts[i]), insts, n);
+		    else if(cputype == CPU_TYPE_ARM)
+			j = arm_disassemble(sect, size - offset, cur_addr, addr,
+				    object_byte_sex, relocs, nrelocs, symbols,
+				    nsymbols, sorted_symbols, nsorted_symbols,
+				    strings, strings_size, indirect_symbols,
+				    nindirect_symbols, load_commands, ncmds,
+				    sizeofcmds, cpusubtype, verbose, arm_dc,
+				    thumb_dc, object_addr, object_size, dices,
+				    ndices, seg_addr, &(insts[i]), insts, n);
+		}
+
+		/* Free up allocated space */
+		for(i = 0 ; i < n ; i++){
+		    if(insts[i].tmp_label != NULL)
+			free(insts[i].tmp_label);
+		}
+		free(insts);
+	    }
+	    if(i386_dc != NULL)
+		delete_arm_llvm_disassembler(i386_dc);
+	    if(x86_64_dc != NULL)
+		delete_arm_llvm_disassembler(x86_64_dc);
+	    if(arm_dc != NULL)
+		delete_arm_llvm_disassembler(arm_dc);
+	    if(thumb_dc != NULL)
+		delete_arm_llvm_disassembler(thumb_dc);
+	    if(arm64_dc != NULL)
+		delete_arm64_llvm_disassembler(arm64_dc);
+	}
+	else{
+	    if(cputype == CPU_TYPE_I386 || cputype == CPU_TYPE_X86_64){
+		for(i = 0 ; i < size ; i += j , addr += j){
+		    if(cputype & CPU_ARCH_ABI64)
+			printf("%016llx ", addr);
+		    else
+			printf("%08x ", (uint32_t)addr);
+		    for(j = 0;
+			j < 16 * sizeof(char) && i + j < size;
+			j += sizeof(char)){
+			byte_word = *(sect + i + j);
+			printf("%02x ", (unsigned int)byte_word);
+		    }
+		    printf("\n");
+		}
+	    }
+	    else if(cputype == CPU_TYPE_MC680x0){
+		for(i = 0 ; i < size ; i += j , addr += j){
+		    printf("%08x ", (unsigned int)addr);
+		    for(j = 0;
+			j < 8 * sizeof(short) && i + j < size;
+			j += sizeof(short)){
+			memcpy(&short_word, sect + i + j, sizeof(short));
+			if(swapped)
+			    short_word = SWAP_SHORT(short_word);
+			printf("%04x ", (unsigned int)short_word);
+		    }
+		    printf("\n");
+		}
+	    }
+	    else{
+		for(i = 0 ; i < size ; i += j , addr += j){
+		    if(cputype & CPU_ARCH_ABI64)
+			printf("%016llx ", addr);
+		    else
+			printf("%08x ", (uint32_t)addr);
+		    for(j = 0;
+			j < 4 * sizeof(int32_t) && i + j < size;
+			j += sizeof(int32_t)){
+			memcpy(&long_word, sect + i + j, sizeof(int32_t));
+			if(swapped)
+			    long_word = SWAP_INT(long_word);
+			printf("%08x ", (unsigned int)long_word);
+		    }
+		    printf("\n");
+		}
+	    }
+	}
+}
+
+static
+void
+print_argstrings(
+uint32_t magic,
+struct load_command *load_commands,
+uint32_t ncmds,
+uint32_t sizeofcmds,
+cpu_type_t cputype,
+cpu_subtype_t cpusubtype,
+enum byte_sex load_commands_byte_sex,
+char *object_addr,
+uint32_t object_size)
+{
+    enum byte_sex host_byte_sex;
+    enum bool swapped;
+    uint32_t i, len, left, size, arg;
+    uint64_t usrstack;
+    struct load_command *lc, l;
+    struct segment_command sg;
+    struct segment_command_64 sg64;
+    char *stack, *stack_top, *p, *q, *argv;
+    struct arch_flag arch_flags;
+
+	host_byte_sex = get_host_byte_sex();
+	swapped = host_byte_sex != load_commands_byte_sex;
+
+	arch_flags.cputype = cputype;
+	if(magic == MH_MAGIC_64)
+	    arch_flags.cputype |= CPU_ARCH_ABI64;
+	arch_flags.cpusubtype = cpusubtype;
+	usrstack = get_stack_addr_from_flag(&arch_flags);
+	if(usrstack == 0){
+	    printf("Don't know the value of USRSTACK for unknown cputype "
+		   "(%d)\n", cputype);
+	    return;
+	}
+	printf("Argument strings on the stack at: ");
+	if(cputype & CPU_ARCH_ABI64 || magic == MH_MAGIC_64)
+	    printf("%016llx\n", usrstack);
+	else
+	    printf("%08x\n", (uint32_t)usrstack);
+	lc = load_commands;
+	for(i = 0 ; i < ncmds; i++){
+	    memcpy((char *)&l, (char *)lc, sizeof(struct load_command));
+	    if(swapped)
+		swap_load_command(&l, host_byte_sex);
+	    if(cputype & CPU_ARCH_ABI64 || magic == MH_MAGIC_64){
+		if(l.cmdsize % 8 != 0)
+		    printf("load command %u size not a multiple of 8\n", i);
+	    }
+	    else{
+		if(l.cmdsize % 4 != 0)
+		    printf("load command %u size not a multiple of 4\n", i);
+	    }
+	    if((char *)lc + l.cmdsize >
+	       (char *)load_commands + sizeofcmds)
+		printf("load command %u extends past end of load "
+		       "commands\n", i);
+	    left = sizeofcmds - ((char *)lc - (char *)load_commands);
+
+	    switch(l.cmd){
+	    case LC_SEGMENT:
+		memset((char *)&sg, '\0', sizeof(struct segment_command));
+		size = left < sizeof(struct segment_command) ?
+		       left : sizeof(struct segment_command);
+		memcpy((char *)&sg, (char *)lc, size);
+		if(swapped)
+		    swap_segment_command(&sg, host_byte_sex);
+
+		if(cputype == CPU_TYPE_HPPA){
+		    if(sg.vmaddr == usrstack &&
+		       sg.fileoff + sg.filesize <= object_size){
+			stack = object_addr + sg.fileoff;
+			stack_top = stack + sg.filesize;
+			/*
+			 * There appears to be some pointer then argc at the
+			 * bottom of the stack first before argv[].
+			 */
+			argv = stack + 2 * sizeof(uint32_t);
+			memcpy(&arg, argv, sizeof(uint32_t));
+			if(swapped)
+			    arg = SWAP_INT(arg);
+			while(argv < stack_top &&
+			      arg != 0 &&
+			      arg >= usrstack && arg < usrstack + sg.filesize){
+			    p = stack + (arg - usrstack);
+			    printf("\t");
+			    while(p < stack_top && *p != '\0'){
+				printf("%c", *p);
+				p++;
+			    }
+			    printf("\n");
+			    argv += sizeof(uint32_t);
+			    memcpy(&arg, argv, sizeof(uint32_t));
+			    if(swapped)
+				arg = SWAP_INT(arg);
+			}
+			/* after argv[] then there is envp[] */
+			argv += sizeof(uint32_t);
+			memcpy(&arg, argv, sizeof(uint32_t));
+			if(swapped)
+			    arg = SWAP_INT(arg);
+			while(argv < stack_top &&
+			      arg != 0 &&
+			      arg >= usrstack && arg < usrstack + sg.filesize){
+			    p = stack + (arg - usrstack);
+			    printf("\t");
+			    while(p < stack_top && *p != '\0'){
+				printf("%c", *p);
+				p++;
+			    }
+			    printf("\n");
+			    argv += sizeof(uint32_t);
+			    memcpy(&arg, argv, sizeof(uint32_t));
+			    if(swapped)
+				arg = SWAP_INT(arg);
+			}
+		    }
+		}
+		else{
+		    if(sg.vmaddr + sg.vmsize == usrstack &&
+		       sg.fileoff + sg.filesize <= object_size){
+			stack = object_addr + sg.fileoff;
+			stack_top = stack + sg.filesize;
+
+			/* the first thing on the stack is a long 0 */
+			stack_top -= 4;
+			p = (char *)stack_top;
+
+			/* find the first non-null character before the long 0*/
+			while(p > stack && *p == '\0')
+			    p--;
+			if(p != (char *)stack_top)
+			    p++;
+
+			q = p;
+			/* Stop when we find another long 0 */
+			while(p > stack && (*p != '\0' || *(p-1) != '\0' ||
+			      *(p-2) != '\0' || *(p-3) != '\0')){
+			    p--;
+			    /* step back over the string to its start */
+			    while(p > stack && *p != '\0')
+				p--;
+			}
+
+			p++; /* step forward to the start of the first string */
+			while(p < q){
+			    printf("\t");
+			    len = 0;
+			    while(p + len < q && p[len] != '\0'){
+				printf("%c", p[len]);
+				len++;
+			    }
+			    printf("\n");
+			    p += len + 1;
+			}
+			return;
+		    }
+		}
+		break;
+	    case LC_SEGMENT_64:
+		memset((char *)&sg64, '\0', sizeof(struct segment_command_64));
+		size = left < sizeof(struct segment_command_64) ?
+		       left : sizeof(struct segment_command_64);
+		memcpy((char *)&sg64, (char *)lc, size);
+		if(swapped)
+		    swap_segment_command_64(&sg64, host_byte_sex);
+		if(sg64.vmaddr + sg64.vmsize == usrstack &&
+		   sg64.fileoff + sg64.filesize <= object_size){
+		    stack = object_addr + sg64.fileoff;
+		    stack_top = stack + sg64.filesize;
+
+		    /* the first thing on the stack is a uint64_t 0 */
+		    stack_top -= 8;
+		    p = (char *)stack_top;
+
+		    /* find the first non-null character before the uint64_t 0*/
+		    while(p > stack && *p == '\0')
+			p--;
+		    if(p != (char *)stack_top)
+			p++;
+
+		    q = p;
+		    /* Stop when we find another uint64_t 0 */
+		    while(p > stack && (*p != '\0' || *(p-1) != '\0' ||
+			  *(p-2) != '\0' || *(p-3) != '\0' || *(p-4) != '\0' ||
+			  *(p-5) != '\0' || *(p-6) != '\0' || *(p-7) != '\0')){
+			p--;
+			/* step back over the string to its start */
+			while(p > stack && *p != '\0')
+			    p--;
+		    }
+
+		    p++; /* step forward to the start of the first string */
+		    while(p < q){
+			printf("\t");
+			len = 0;
+			while(p + len < q && p[len] != '\0'){
+			    printf("%c", p[len]);
+			    len++;
+			}
+			printf("\n");
+			p += len + 1;
+		    }
+		    return;
+		}
+		break;
+	    }
+
+	    if(l.cmdsize == 0){
+		printf("load command %u size zero (can't advance to other "
+		       "load commands)\n", i);
+		break;
+	    }
+	    lc = (struct load_command *)((char *)lc + l.cmdsize);
+	    if((char *)lc > (char *)load_commands + sizeofcmds)
+		break;
+	}
+}
+
+#ifndef __DYNAMIC__
+/*
+ * To avoid linking in libm.  These variables are defined as they are used in
+ * pthread_init() to put in place a fast sqrt().
+ */
+size_t hw_sqrt_len = 0;
+
+double
+sqrt(double x)
+{
+	return(0.0);
+}
+double
+hw_sqrt(double x)
+{
+	return(0.0);
+}
+
+/*
+ * More stubs to avoid linking in libm.  This works as along as we don't use
+ * long doubles.
+ */
+int32_t
+__fpclassifyd(double x)
+{
+	return(0);
+}
+int32_t
+__fpclassify(long double x)
+{
+	return(0);
+}
+#endif /* !defined(__DYNAMIC__) */
+
+#ifdef OTOOL_NG_SUPPORT
+/* invert the PIE flag at fat and non-fat binaries */
+static void
+modify_pie_flag(struct ofile *ofile)
+{
+	if (ofile == NULL)
+	{
+		fprintf(stderr, "ERROR: ofile argument is NULL\n");
+		return;
+	}
+	/* the ofile struct contains the filename and pointer to alloc'ed memory with target contents */
+	uint32_t magic = *(uint32_t*)(ofile->file_addr);
+	if (magic == FAT_MAGIC) // byte order is little endian on internal buffer
+	{
+		printf("Target is a fat archive, modifying PIE flag for each arch...\n");
+		/* ofile structure already contains the all the FAT related information */
+		for (int i = 0 ; i < ofile->fat_header->nfat_arch; i++)
+		{
+			/* ofile also contains an array of struct fat_arch */
+			modify_pie_flag_aux((char*)(ofile->file_addr+ofile->fat_archs[i].offset));
+		}
+		/* otool swaps internally the byte order so we need to swap it back */
+		enum byte_sex host_byte_sex;
+		host_byte_sex = get_host_byte_sex();
+		swap_fat_arch(ofile->fat_archs, ofile->fat_header->nfat_arch, host_byte_sex);
+		swap_fat_header(ofile->fat_header, host_byte_sex);
+	}
+	else
+	{
+		modify_pie_flag_aux((char*)(ofile->file_addr));
+	}	
+
+	/* and now overwrite the modified file */
+	FILE *patched_file;
+	patched_file = fopen(ofile->file_name, "wb+");
+	if (patched_file == NULL) 
+	{
+		system_fatal("Can't open file %s", ofile->file_name);
+	}
+	
+	/* let's go command style! nothing can go wrong right ? :-) */
+	size_t bytes_written = fwrite(ofile->file_addr, sizeof(char), ofile->file_size, patched_file);
+	if (bytes_written != ofile->file_size)
+	{
+	 system_fatal("Write failed to %s", ofile->file_name);
+	}
+	
+	fclose(patched_file);
+}
+
+static void
+modify_pie_flag_aux(char *start)
+{
+	if (start == NULL)
+	{
+		fprintf(stderr, "ERROR: start argument is NULL\n");
+		return;
+	}
+	uint32_t magic = *(uint32_t*)(start);
+	if (magic == MH_MAGIC)
+	{
+		struct mach_header *mh = (struct mach_header*)(start);
+		uint32_t flags = mh->flags;
+		if (flags & MH_PIE)
+		{
+			printf("PIE flag is currently set. Removing...\n");
+			flags &= ~MH_PIE;
+		}
+		else
+		{
+			printf("PIE flag is currently not set. Setting up...\n");
+			flags |= MH_PIE;
+		}
+		/* update flag */
+		mh->flags = flags;
+	}
+	else if (magic == MH_MAGIC_64)
+	{
+		struct mach_header_64 *mh64 = (struct mach_header_64*)(start);
+		uint32_t flags = mh64->flags;
+		if (flags & MH_PIE)
+		{
+			printf("PIE flag is currently set. Removing...\n");
+			flags &= ~MH_PIE;
+		}
+		else
+		{
+			printf("PIE flag is currently not set. Setting up...\n");
+			flags |= MH_PIE;
+		}
+		/* update flag */
+		mh64->flags = flags;
+	}
+}
+#endif
diff -Nur cctools-877.5/otool/ofile_print.c cctools-877.5-AnV/otool/ofile_print.c
--- cctools-877.5/otool/ofile_print.c	2015-09-15 01:35:14 +0000
+++ cctools-877.5-AnV/otool/ofile_print.c	2015-11-19 09:03:11 +0000
@@ -1887,6 +1887,10 @@
     struct entry_point_command ep;
     struct source_version_command sv;
     uint64_t big_load_end;
+#ifdef OTOOL_NG_SUPPORT
+    /* store __TEXT segment vmaddr so we can compute the entrypoint in LC_MAIN */
+    uint64_t text_vmaddr = 0;
+#endif
 
 	host_byte_sex = get_host_byte_sex();
 	swapped = host_byte_sex != load_commands_byte_sex;
@@ -1921,6 +1925,14 @@
 		    sg.vmaddr, sg.vmsize, sg.fileoff, sg.filesize,
 		    sg.maxprot, sg.initprot, sg.nsects, sg.flags,
 		    object_size, verbose);
+#ifdef OTOOL_NG_SUPPORT
+		/* copy the value of vmaddr into our variable to use later */
+		/* this is because LC_MAIN offset is from the __TEXT segment */
+		if (strncmp(sg.segname, "__TEXT", 16) == 0)
+		{
+			text_vmaddr = sg.vmaddr;
+		}
+#endif
 		p = (char *)lc + sizeof(struct segment_command);
 		for(j = 0 ; j < sg.nsects ; j++){
 		    if(p + sizeof(struct section) >
@@ -1957,6 +1969,14 @@
 		    sg64.vmaddr, sg64.vmsize, sg64.fileoff, sg64.filesize,
 		    sg64.maxprot, sg64.initprot, sg64.nsects, sg64.flags,
 		    object_size, verbose);
+#ifdef OTOOL_NG_SUPPORT
+		/* copy the value of vmaddr into our variable to use later */
+		/* this is because LC_MAIN offset is from the __TEXT segment */
+		if (strncmp(sg64.segname, "__TEXT", 16) == 0)
+		{
+			text_vmaddr = sg64.vmaddr;
+		}
+#endif
 		p = (char *)lc + sizeof(struct segment_command_64);
 		for(j = 0 ; j < sg64.nsects ; j++){
 		    if(p + sizeof(struct section_64) >
@@ -2309,7 +2329,11 @@
 		memcpy((char *)&ep, (char *)lc, size);
 		if(swapped)
 		    swap_entry_point_command(&ep, host_byte_sex);
+#ifdef OTOOL_NG_SUPPORT
+		print_entry_point_command(&ep, text_vmaddr);
+#else
 		print_entry_point_command(&ep);
+#endif
 		break;
 
 	    default:
@@ -2521,7 +2545,11 @@
 	    printf("   vmaddr 0x%08x\n", (uint32_t)vmaddr);
 	    printf("   vmsize 0x%08x\n", (uint32_t)vmsize);
 	}
+#ifdef OTOOL_NG_SUPPORT
+	printf("  fileoff 0x%llx", fileoff);
+#else
 	printf("  fileoff %llu", fileoff);
+#endif
 	if(fileoff > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -2648,13 +2676,21 @@
 	    printf(" (past end of file)\n");
 	else
 	    printf("\n");
+#ifdef OTOOL_NG_SUPPORT
+	printf("    offset 0x%x", offset);
+#else
 	printf("    offset %u", offset);
+#endif
 	if(offset > object_size)
 	    printf(" (past end of file)\n");
 	else
 	    printf("\n");
 	printf("     align 2^%u (%d)\n", align, 1 << align);
+#ifdef OTOOL_NG_SUPPORT
+	printf("    reloff 0x%x", reloff);
+#else
 	printf("    reloff %u", reloff);
+#endif
 	if(reloff > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -2774,7 +2810,11 @@
 	    printf(" Incorrect size\n");
 	else
 	    printf("\n");
+#ifdef OTOOL_NG_SUPPORT
+	printf("  symoff 0x%x", st->symoff);
+#else
 	printf("  symoff %u", st->symoff);
+#endif
 	if(st->symoff > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -2798,7 +2838,11 @@
 	    else
 		printf("\n");
 	}
+#ifdef OTOOL_NG_SUPPORT
+	printf("  stroff 0x%x", st->stroff);
+#else
 	printf("  stroff %u", st->stroff);
+#endif
 	if(st->stroff > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -2868,7 +2912,11 @@
 	    printf(" (past the end of the symbol table)\n");
 	else
 	    printf("\n");
+#ifdef OTOOL_NG_SUPPORT
+	printf("         tocoff 0x%x", dyst->tocoff);
+#else
 	printf("         tocoff %u", dyst->tocoff);
+#endif
 	if(dyst->tocoff > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -2881,7 +2929,11 @@
 	    printf(" (past end of file)\n");
 	else
 	    printf("\n");
+#ifdef OTOOL_NG_SUPPORT
+	printf("      modtaboff 0x%x", dyst->modtaboff);
+#else
 	printf("      modtaboff %u", dyst->modtaboff);
+#endif
 	if(dyst->modtaboff > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -2901,7 +2953,11 @@
 	    printf(" (past end of file)\n");
 	else
 	    printf("\n");
+#ifdef OTOOL_NG_SUPPORT
+	printf("   extrefsymoff 0x%x", dyst->extrefsymoff);
+#else
 	printf("   extrefsymoff %u", dyst->extrefsymoff);
+#endif
 	if(dyst->extrefsymoff > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -2914,7 +2970,11 @@
 	    printf(" (past end of file)\n");
 	else
 	    printf("\n");
+#ifdef OTOOL_NG_SUPPORT
+	printf(" indirectsymoff 0x%x", dyst->indirectsymoff);
+#else
 	printf(" indirectsymoff %u", dyst->indirectsymoff);
+#endif
 	if(dyst->indirectsymoff > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -2927,7 +2987,11 @@
 	    printf(" (past end of file)\n");
 	else
 	    printf("\n");
+#ifdef OTOOL_NG_SUPPORT
+	printf("      extreloff 0x%x", dyst->extreloff);
+#else
 	printf("      extreloff %u", dyst->extreloff);
+#endif
 	if(dyst->extreloff > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -2940,7 +3004,11 @@
 	    printf(" (past end of file)\n");
 	else
 	    printf("\n");
+#ifdef OTOOL_NG_SUPPORT
+	printf("      locreloff 0x%x", dyst->locreloff);
+#else
 	printf("      locreloff %u", dyst->locreloff);
+#endif
 	if(dyst->locreloff > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -2972,7 +3040,11 @@
 	    printf(" Incorrect size\n");
 	else
 	    printf("\n");
+#ifdef OTOOL_NG_SUPPORT
+	printf("  offset 0x%x", ss->offset);
+#else
 	printf("  offset %u", ss->offset);
+#endif
 	if(ss->offset > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -3008,11 +3080,19 @@
 	    printf("\n");
 	if(fl->fvmlib.name.offset < fl->cmdsize){
 	    p = (char *)lc + fl->fvmlib.name.offset;
+#ifdef OTOOL_NG_SUPPORT
+	    printf("          name %s (offset 0x%x)\n",
+#else
 	    printf("          name %s (offset %u)\n",
+#endif
 		   p, fl->fvmlib.name.offset);
 	}
 	else{
+#ifdef OTOOL_NG_SUPPORT
+	    printf("          name ?(bad offset 0x%x)\n",
+#else
 	    printf("          name ?(bad offset %u)\n",
+#endif
 		   fl->fvmlib.name.offset);
 	}
 	printf(" minor version %u\n", fl->fvmlib.minor_version);
@@ -3053,11 +3133,19 @@
 	    printf("\n");
 	if(dl->dylib.name.offset < dl->cmdsize){
 	    p = (char *)lc + dl->dylib.name.offset;
+#ifdef OTOOL_NG_SUPPORT
+	    printf("         name %s (offset 0x%x)\n",
+#else
 	    printf("         name %s (offset %u)\n",
+#endif
 		   p, dl->dylib.name.offset);
 	}
 	else{
+#ifdef OTOOL_NG_SUPPORT
+	    printf("         name ?(bad offset 0x%x)\n",
+#else
 	    printf("         name ?(bad offset %u)\n",
+#endif
 		   dl->dylib.name.offset);
 	}
 	printf("   time stamp %u ", dl->dylib.timestamp);
@@ -3214,11 +3302,19 @@
 	    printf("\n");
 	if(pbdylib->name.offset < pbdylib->cmdsize){
 	    p = (char *)lc + pbdylib->name.offset;
+#ifdef OTOOL_NG_SUPPORT
+	    printf("           name %s (offset 0x%x)\n",
+#else
 	    printf("           name %s (offset %u)\n",
+#endif
 		   p, pbdylib->name.offset);
 	}
 	else{
+#ifdef OTOOL_NG_SUPPORT
+		printf("           name ?(bad offset 0x%x)\n",
+#else
 	    printf("           name ?(bad offset %u)\n",
+#endif
 		   pbdylib->name.offset);
 	}
 	printf("       nmodules %u\n", pbdylib->nmodules);
@@ -3226,7 +3322,11 @@
 	if(pbdylib->linked_modules.offset < pbdylib->cmdsize){
 	    p = (char *)lc + pbdylib->linked_modules.offset;
 	    if(verbose == TRUE){
+#ifdef OTOOL_NG_SUPPORT
+		printf(" linked_modules (offset 0x%x)\n",	    	
+#else
 		printf(" linked_modules (offset %u)\n",
+#endif
 			pbdylib->linked_modules.offset);
 		for(i = 0; i < pbdylib->nmodules; i++){
 		    if(((p[i/8] >> (i%8)) & 1) == 1)
@@ -3243,11 +3343,19 @@
 		}
 		if(i <= pbdylib->nmodules)
 		    printf("...");
+#ifdef OTOOL_NG_SUPPORT		
+		printf(" (offset 0x%x)\n", pbdylib->linked_modules.offset);
+#else
 		printf(" (offset %u)\n", pbdylib->linked_modules.offset);
+#endif
 	    }
 	}
 	else{
+#ifdef OTOOL_NG_SUPPORT		
+		printf(" linked_modules ?(bad offset 0x%x)\n",
+#else			
 	    printf(" linked_modules ?(bad offset %u)\n",
+#endif	    	
 		   pbdylib->linked_modules.offset);
 	}
 }
@@ -3279,10 +3387,18 @@
 	    printf("\n");
 	if(dyld->name.offset < dyld->cmdsize){
 	    p = (char *)lc + dyld->name.offset;
+#ifdef OTOOL_NG_SUPPORT	    
+	    printf("         name %s (offset 0x%x)\n", p, dyld->name.offset);
+#else	    
 	    printf("         name %s (offset %u)\n", p, dyld->name.offset);
+#endif	    
 	}
 	else{
+#ifdef OTOOL_NG_SUPPORT		
+		printf("         name ?(bad offset 0x%x)\n", dyld->name.offset);
+#else
 	    printf("         name ?(bad offset %u)\n", dyld->name.offset);
+#endif	    
 	}
 }
 
@@ -3305,10 +3421,18 @@
 	    printf("\n");
 	if(ff->name.offset < ff->cmdsize){
 	    p = (char *)lc + ff->name.offset;
+#ifdef OTOOL_NG_SUPPORT	    
+	    printf("          name %s (offset 0x%x)\n", p, ff->name.offset);
+#else	    
 	    printf("          name %s (offset %u)\n", p, ff->name.offset);
+#endif	    
 	}
 	else{
+#ifdef OTOOL_NG_SUPPORT
+		printf("          name ?(bad offset 0x%x)\n", ff->name.offset);
+#else		
 	    printf("          name ?(bad offset %u)\n", ff->name.offset);
+#endif	    
 	}
 	printf("   header addr 0x%08x\n", (unsigned int)ff->header_addr);
 }
@@ -3378,7 +3502,11 @@
 	    printf(" Incorrect size\n");
 	else
 	    printf("\n");
+#ifdef OTOOL_NG_SUPPORT	
+	printf("  offset 0x%x", hints->offset);
+#else	
 	printf("  offset %u", hints->offset);
+#endif	
 	if(hints->offset > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -3466,7 +3594,11 @@
 	    printf(" Incorrect size\n");
 	else
 	    printf("\n");
+#ifdef OTOOL_NG_SUPPORT	
+	printf("  dataoff 0x%x", ld->dataoff);
+#else	
 	printf("  dataoff %u", ld->dataoff);
+#endif	
 	if(ld->dataoff > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -3562,7 +3694,11 @@
  */
 void
 print_entry_point_command(
+#ifdef OTOOL_NG_SUPPORT
+struct entry_point_command *ep, uint64_t text_vmaddr)
+#else
 struct entry_point_command *ep)
+#endif
 {
 	printf("       cmd LC_MAIN\n");
 	printf("   cmdsize %u", ep->cmdsize);
@@ -3570,8 +3706,15 @@
 	    printf(" Incorrect size\n");
 	else
 	    printf("\n");
+#ifdef OTOOL_NG_SUPPORT	
+	printf("  entryoff 0x%llx\n", ep->entryoff);
+#else	
 	printf("  entryoff %llu\n", ep->entryoff);
+#endif	
 	printf(" stacksize %llu\n", ep->stacksize);
+#ifdef OTOOL_NG_SUPPORT
+	printf("entrypoint %p\n", (void*)(text_vmaddr + ep->entryoff));
+#endif
 }
 
 /*
@@ -3593,10 +3736,18 @@
 	    printf("\n");
 	if(rpath->path.offset < rpath->cmdsize){
 	    p = (char *)lc + rpath->path.offset;
+#ifdef OTOOL_NG_SUPPORT	    
+	    printf("         path %s (offset 0x%x)\n", p, rpath->path.offset);
+#else	    
 	    printf("         path %s (offset %u)\n", p, rpath->path.offset);
+#endif	    
 	}
 	else{
+#ifdef OTOOL_NG_SUPPORT		
+		printf("         path ?(bad offset 0x%x)\n", rpath->path.offset);
+#else		
 	    printf("         path ?(bad offset %u)\n", rpath->path.offset);
+#endif	    
 	}
 }
 
@@ -3728,8 +3879,11 @@
 	    printf(" Incorrect size\n");
 	else
 	    printf("\n");
-
+#ifdef OTOOL_NG_SUPPORT
+	printf("     rebase_off 0x%x", dc->rebase_off);
+#else
 	printf("     rebase_off %u", dc->rebase_off);
+#endif
 	if(dc->rebase_off > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -3741,8 +3895,11 @@
 	    printf(" (past end of file)\n");
 	else
 	    printf("\n");
-
+#ifdef OTOOL_NG_SUPPORT
+	printf("       bind_off 0x%x", dc->bind_off);
+#else
 	printf("       bind_off %u", dc->bind_off);
+#endif
 	if(dc->bind_off > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -3755,7 +3912,11 @@
 	else
 	    printf("\n");
 	    
+#ifdef OTOOL_NG_SUPPORT
+	printf("  weak_bind_off 0x%x", dc->weak_bind_off);
+#else
 	printf("  weak_bind_off %u", dc->weak_bind_off);
+#endif
 	if(dc->weak_bind_off > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -3768,7 +3929,11 @@
 	else
 	    printf("\n");
 
+#ifdef OTOOL_NG_SUPPORT
+	printf("  lazy_bind_off 0x%x", dc->lazy_bind_off);
+#else
 	printf("  lazy_bind_off %u", dc->lazy_bind_off);
+#endif
 	if(dc->lazy_bind_off > object_size)
 	    printf(" (past end of file)\n");
 	else
@@ -3781,7 +3946,11 @@
 	else
 	    printf("\n");
 	    
+#ifdef OTOOL_NG_SUPPORT
+	printf("     export_off 0x%x", dc->export_off);
+#else
 	printf("     export_off %u", dc->export_off);
+#endif
 	if(dc->export_off > object_size)
 	    printf(" (past end of file)\n");
 	else
diff -Nur cctools-877.5/otool/ofile_print.h cctools-877.5-AnV/otool/ofile_print.h
--- cctools-877.5/otool/ofile_print.h	2015-03-10 00:33:19 +0000
+++ cctools-877.5-AnV/otool/ofile_print.h	2015-11-19 09:03:11 +0000
@@ -304,7 +304,11 @@
     struct source_version_command *sv);
 
 extern void print_entry_point_command(
+#ifdef OTOOL_NG_SUPPORT
+    struct entry_point_command *ep, uint64_t text_vmaddr);
+#else
     struct entry_point_command *ep);
+#endif
 
 extern void print_rpath_command(
     struct rpath_command *rpath,
diff -Nur cctools-877.5/otool/otool.h cctools-877.5-AnV/otool/otool.h
--- cctools-877.5/otool/otool.h	2014-11-11 02:04:09 +0000
+++ cctools-877.5-AnV/otool/otool.h	2015-11-19 09:03:11 +0000
@@ -61,6 +61,10 @@
 extern enum bool qflag; /* use 'C' Public llvm-mc disassembler */
 extern enum bool gflag; /* group the disassembly */
 extern enum bool jflag; /* print opcode bytes */
+#ifdef OTOOL_NG_SUPPORT
+extern enum bool zflag; /* change PIE flag */
+extern uint64_t start_offset; /* offset to start reading mach-o header from */
+#endif
 extern char *pflag; 	/* procedure name to start disassembling from */
 extern char *segname,
      *sectname;	    /* name of the section to print the contents of */
